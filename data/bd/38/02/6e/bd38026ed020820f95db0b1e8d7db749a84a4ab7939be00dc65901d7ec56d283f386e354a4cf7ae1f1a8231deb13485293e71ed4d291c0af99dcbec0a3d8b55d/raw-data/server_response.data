<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/swift/+bug/1196932/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1196932 “[OSSA 2013-022] Possibly DoS attack using object t...” : Bugs : OpenStack Object Storage (swift)</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1196932" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1196932/bug.atom" title="Bug 1196932 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="Is it possible for an attacker can fill a disk with old tombstones, slowing down object servers in the least with DELETE requests?  I am not entirely sure I understand all of the DELETE behavior.

See the following patch which is a unit test which details the behavior (this currently fails on the last check because no metadata is pulled from the tombstone, so the container update is always performed).

diff --git a/test/unit/obj/test_server.py b/test/unit/obj/test_server.py
index e3f24d6..27f..." />
      <meta property="og:description" content="Is it possible for an attacker can fill a disk with old tombstones, slowing down object servers in the least with DELETE requests?  I am not entirely sure I understand all of the DELETE behavior.

See the following patch which is a unit test which details the behavior (this currently fails on the last check because no metadata is pulled from the tombstone, so the container update is always performed).

diff --git a/test/unit/obj/test_server.py b/test/unit/obj/test_server.py
index e3f24d6..27f..." />
    

    
    
      <meta property="og:title" content="Bug #1196932 “[OSSA 2013-022] Possibly DoS attack using object t...” : Bugs : OpenStack Object Storage (swift)" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1196932" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["account-server", "consistency-engine", "container-server", "documentation", "ec-erasure-coding", "flakey-test", "i18n", "low-hanging-fruit", "middleware", "object-server", "ops", "proxy-server", "python3", "security", "test"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/swift/+bug/1196932/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/swift"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/52141984/os64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/swift">OpenStack Object Storage (swift)</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/swift">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/swift">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/swift">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/swift">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/swift">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/swift">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1196932 reported by
      <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante</a>
      <time title="2013-07-02 12:16:11 UTC" datetime="2013-07-02T12:16:11.994606+00:00">on 2013-07-02</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">264</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1427135">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/swift/+bug/1196932/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1427135">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/swift">OpenStack Object Storage (swift)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/swift/+bug/1196932/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/swift/+bug/1196932/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1427135">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~peter-a-portante">Peter Portante</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/swift/+milestone/1.9.1">OpenStack Object Storage (swift) 1.9.1</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1427135">
     <td colspan="7"><form action="/swift/+bug/1196932/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/swift">OpenStack Object Storage (swift)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-07-02 12:16:11 UTC" datetime="2013-07-02T12:16:11.994606+00:00">2013-07-02</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-07-08 23:42:30 UTC" datetime="2013-07-08T23:42:30.835203+00:00">2013-07-08</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2013-07-02 12:16:12 UTC" datetime="2013-07-02T12:16:12.462887+00:00">2013-07-02</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-08-07 15:13:34 UTC" datetime="2013-08-07T15:13:34.337971+00:00">2013-08-07</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2013-08-07 16:52:37 UTC" datetime="2013-08-07T16:52:37.941177+00:00">2013-08-07</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="swift.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="swift.target.option.package" name="swift.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="swift.target.distribution" name="swift.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="swift.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="swift.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="swift.target.package"
                         name="swift.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;swift.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('swift.target.package');
              var select_menu = Y.DOM.byId('swift.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-swift-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "swift.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-swift-target-package", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-swift-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="swift.target.option.product" name="swift.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="swift" id="swift.target.product"
                         name="swift.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;swift.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('swift.target.product');
              var select_menu = Y.DOM.byId('swift.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-swift-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "swift.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-swift-target-product", "selected_value": "swift", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-swift-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="swift.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="swift.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="swift.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="swift.status" name="swift.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="swift.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceCRITICAL">Critical</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Object Storage (swift) 1.9.1
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="swift.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="swift.assignee.assign_to_me" name="swift.assignee.option" value="swift.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="swift.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="swift.assignee.assigned_to" name="swift.assignee.option" value="swift.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="swift.assignee.assigned_to">
              Peter Portante (peter-a-portante)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="swift.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="swift.comment_on_change" name="swift.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1442219">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/swift/folsom/+bug/1196932/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/swift/folsom">Folsom</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/swift/folsom/+bug/1196932/+editstatus" style="float: left" class="value statusFIXCOMMITTED">Fix Committed</a>
          <a href="https://bugs.launchpad.net/swift/folsom/+bug/1196932/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1442219">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1442219">
     <td colspan="7"><form action="/swift/folsom/+bug/1196932/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/swift/folsom">OpenStack Object Storage (swift) folsom</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-08-05 13:12:21 UTC" datetime="2013-08-05T13:12:21.201926+00:00">2013-08-05</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-08-05 13:12:31 UTC" datetime="2013-08-05T13:12:31.401329+00:00">2013-08-05</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-08-07 15:13:20 UTC" datetime="2013-08-07T15:13:20.062490+00:00">2013-08-07</time>
      </td>
    </tr>
    
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="swift_folsom.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="swift_folsom.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="swift_folsom.status" name="swift_folsom.status" size="1" >
<option selected="selected" value="Fix Committed">Fix Committed</option>
</select>
</div>
<input name="swift_folsom.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="swift_folsom.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="swift_folsom.assignee.assign_to_nobody" name="swift_folsom.assignee.option" value="swift_folsom.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="swift_folsom.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="swift_folsom.assignee.assign_to_me" name="swift_folsom.assignee.option" value="swift_folsom.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="swift_folsom.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="swift_folsom.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="swift_folsom.comment_on_change" name="swift_folsom.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1430426">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/swift/grizzly/+bug/1196932/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/swift/grizzly">Grizzly</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/swift/grizzly/+bug/1196932/+editstatus" style="float: left" class="value statusFIXCOMMITTED">Fix Committed</a>
          <a href="https://bugs.launchpad.net/swift/grizzly/+bug/1196932/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1430426">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1430426">
     <td colspan="7"><form action="/swift/grizzly/+bug/1196932/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/swift/grizzly">OpenStack Object Storage (swift) grizzly</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-07-09 13:03:11 UTC" datetime="2013-07-09T13:03:11.212280+00:00">2013-07-09</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-08-05 13:12:33 UTC" datetime="2013-08-05T13:12:33.856198+00:00">2013-08-05</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-08-07 15:13:30 UTC" datetime="2013-08-07T15:13:30.873555+00:00">2013-08-07</time>
      </td>
    </tr>
    
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="swift_grizzly.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="swift_grizzly.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="swift_grizzly.status" name="swift_grizzly.status" size="1" >
<option selected="selected" value="Fix Committed">Fix Committed</option>
</select>
</div>
<input name="swift_grizzly.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="swift_grizzly.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="swift_grizzly.assignee.assign_to_nobody" name="swift_grizzly.assignee.option" value="swift_grizzly.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="swift_grizzly.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="swift_grizzly.assignee.assign_to_me" name="swift_grizzly.assignee.option" value="swift_grizzly.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="swift_grizzly.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="swift_grizzly.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="swift_grizzly.comment_on_change" name="swift_grizzly.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1427198">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1196932/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1427198">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1196932/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1196932/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceMEDIUM">Medium</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1427198">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ttx">Thierry Carrez</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1427198">
     <td colspan="7"><form action="/ossa/+bug/1196932/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-07-02 14:14:31 UTC" datetime="2013-07-02T14:14:31.862873+00:00">2013-07-02</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-07-09 13:02:53 UTC" datetime="2013-07-09T13:02:53.803444+00:00">2013-07-09</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2013-07-10 14:07:05 UTC" datetime="2013-07-10T14:07:05.856833+00:00">2013-07-10</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-07-19 10:25:38 UTC" datetime="2013-07-19T10:25:38.444110+00:00">2013-07-19</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2013-08-07 16:18:44 UTC" datetime="2013-08-07T16:18:44.415315+00:00">2013-08-07</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "ossa.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-ossa-target-package", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "ossa.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-ossa-target-product", "selected_value": "ossa", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceMEDIUM">Medium</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Thierry Carrez (ttx)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/swift/+bug/1196932/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/swift/+bug/1196932/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/swift/+bug/1196932/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>Is it possible for an attacker can fill a disk with old tombstones, slowing down object servers in the least with DELETE requests?  I am not entirely sure I understand all of the DELETE behavior.</p>
<p>See the following patch which is a unit test which details the behavior (this currently fails on the last check because no metadata is pulled from the tombstone, so the container update is always performed).</p>
<p>diff --git a/test/<wbr />unit/obj/<wbr />test_server.<wbr />py b/test/<wbr />unit/obj/<wbr />test_server.<wbr />py<br />
index e3f24d6..27f75d9 100755<br />
--- a/test/<wbr />unit/obj/<wbr />test_server.<wbr />py<br />
+++ b/test/<wbr />unit/obj/<wbr />test_server.<wbr />py<br />
@@ -1410,6 +1410,115 @@ class TestObjectContr<wbr />oller(unittest.<wbr />TestCase)<wbr />:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timestamp + &#x27;.ts&#x27;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;self.<wbr />assert_<wbr />(os.path.<wbr />isfile(<wbr />objfile)<wbr />)</p>
<p>+    def test_DELETE_<wbr />container_<wbr />updates(<wbr />self):<br />
+        # Test swift.object_<wbr />server.<wbr />ObjectControlle<wbr />r.DELETE and container<br />
+        # updates, making sure container update is called in the correct<br />
+        # state.<br />
+        timestamp = normalize_<wbr />timestamp(<wbr />time())<br />
+        req = Request.<wbr />blank(&#x27;<wbr />/sda1/p/<wbr />a/c/o&#x27;, environ=<wbr />{&#x27;REQUEST_<wbr />METHOD&#x27;<wbr />: &#x27;PUT&#x27;},<br />
+                            headers={<br />
+                                &#x27;X-Timestamp&#x27;: timestamp,<br />
+                                &#x27;Content-Type&#x27;: &#x27;application/<wbr />octet-stream&#x27;<wbr />,<br />
+                                &#x27;Content-Length&#x27;: &#x27;4&#x27;,<br />
+                                })<br />
+        req.body = &#x27;test&#x27;<br />
+        resp = self.object_<wbr />controller.<wbr />PUT(req)<br />
+        self.assertEqua<wbr />ls(resp.<wbr />status_<wbr />int, 201)<br />
+<br />
+        calls_made = [0]<br />
+<br />
+        def our_container_<wbr />update(<wbr />*args, **kwargs):<br />
+            calls_made[0] += 1<br />
+<br />
+        orig_cu = self.object_<wbr />controller.<wbr />container_<wbr />update<br />
+        self.object_<wbr />controller.<wbr />container_<wbr />update = our_container_<wbr />update<br />
+        try:<br />
+            # The following request should return 204, but the object won&#x27;t be<br />
+            # truly deleted (container update is not performed) because the<br />
+            # timestamp is old. A tombstone file should have been created with<br />
+            # this timestamp.<br />
+            #<br />
+            # FIXME - When we know a newer file exists, should this not return<br />
+            # HTTPConflict, and a tombstone not be created?<br />
+            timestamp = normalize_<wbr />timestamp(<wbr />float(timestamp<wbr />) - 1)<br />
+            req = Request.<wbr />blank(&#x27;<wbr />/sda1/p/<wbr />a/c/o&#x27;,<br />
+                                environ=<wbr />{&#x27;REQUEST_<wbr />METHOD&#x27;<wbr />: &#x27;DELETE&#x27;},<br />
+                                headers=<wbr />{&#x27;X-Timestamp&#x27;<wbr />: timestamp})<br />
+            resp = self.object_<wbr />controller.<wbr />DELETE(<wbr />req)<br />
+            self.assertEqua<wbr />ls(resp.<wbr />status_<wbr />int, 204)<br />
+            objfile = os.path.<wbr />join(self.<wbr />testdir, &#x27;sda1&#x27;,<br />
+                storage_<wbr />directory(<wbr />object_<wbr />server.<wbr />DATADIR, &#x27;p&#x27;,<br />
+                                  hash_path(&#x27;a&#x27;, &#x27;c&#x27;, &#x27;o&#x27;)),<br />
+                timestamp + &#x27;.ts&#x27;)<br />
+            self.assert_<wbr />(os.path.<wbr />isfile(<wbr />objfile)<wbr />)<br />
+            self.assertEqua<wbr />ls(0, calls_made[0])<br />
+<br />
+            # The following request should return 204, and the object should<br />
+            # be truly deleted (container update is performed) because this<br />
+            # timestamp is newer. A tombstone file should have been created<br />
+            # with this timestamp.<br />
+            sleep(.00001)<br />
+            timestamp = normalize_<wbr />timestamp(<wbr />time())<br />
+            req = Request.<wbr />blank(&#x27;<wbr />/sda1/p/<wbr />a/c/o&#x27;,<br />
+                                environ=<wbr />{&#x27;REQUEST_<wbr />METHOD&#x27;<wbr />: &#x27;DELETE&#x27;},<br />
+                                headers=<wbr />{&#x27;X-Timestamp&#x27;<wbr />: timestamp})<br />
+            resp = self.object_<wbr />controller.<wbr />DELETE(<wbr />req)<br />
+            self.assertEqua<wbr />ls(resp.<wbr />status_<wbr />int, 204)<br />
+            objfile = os.path.<wbr />join(self.<wbr />testdir, &#x27;sda1&#x27;,<br />
+                storage_<wbr />directory(<wbr />object_<wbr />server.<wbr />DATADIR, &#x27;p&#x27;,<br />
+                                  hash_path(&#x27;a&#x27;, &#x27;c&#x27;, &#x27;o&#x27;)),<br />
+                timestamp + &#x27;.ts&#x27;)<br />
+            self.assert_<wbr />(os.path.<wbr />isfile(<wbr />objfile)<wbr />)<br />
+            self.assertEqua<wbr />ls(1, calls_made[0])<br />
+<br />
+            # The following request should return a 404, as the object should<br />
+            # already have been deleted, but it should have also performed a<br />
+            # container update because the timestamp is newer, and a tombstone<br />
+            # file should also exist for this timestamp.<br />
+            #<br />
+            # FIXME - A malicious client can cause a set of object servers to<br />
+            # update containers and fill the volume with .ts files as the code<br />
+            # stands: if the file is already deleted, should this not just<br />
+            # return a 404 and avoid all the updates and tombstones?<br />
+            sleep(.00001)<br />
+            timestamp = normalize_<wbr />timestamp(<wbr />time())<br />
+            req = Request.<wbr />blank(&#x27;<wbr />/sda1/p/<wbr />a/c/o&#x27;,<br />
+                                environ=<wbr />{&#x27;REQUEST_<wbr />METHOD&#x27;<wbr />: &#x27;DELETE&#x27;},<br />
+                                headers=<wbr />{&#x27;X-Timestamp&#x27;<wbr />: timestamp})<br />
+            resp = self.object_<wbr />controller.<wbr />DELETE(<wbr />req)<br />
+            self.assertEqua<wbr />ls(resp.<wbr />status_<wbr />int, 404)<br />
+            objfile = os.path.<wbr />join(self.<wbr />testdir, &#x27;sda1&#x27;,<br />
+                storage_<wbr />directory(<wbr />object_<wbr />server.<wbr />DATADIR, &#x27;p&#x27;,<br />
+                                  hash_path(&#x27;a&#x27;, &#x27;c&#x27;, &#x27;o&#x27;)),<br />
+                timestamp + &#x27;.ts&#x27;)<br />
+            self.assert_<wbr />(os.path.<wbr />isfile(<wbr />objfile)<wbr />)<br />
+            self.assertEqua<wbr />ls(2, calls_made[0])<br />
+<br />
+<br />
+            # The following request should return a 404, as the object should<br />
+            # already have been deleted, and it should not have performed a<br />
+            # container update because the timestamp is oler, though a<br />
+            # tombstone file should also have been created with this<br />
+            # timestamp.<br />
+            #<br />
+            # FIXME - A malicious client can cause an object server to fill up<br />
+            # the volume with .ts files as the code stands: should we not<br />
+            # allow new tombstone files to be create without older timestamps?<br />
+            timestamp = normalize_<wbr />timestamp(<wbr />float(timestamp<wbr />) - 1)<br />
+            req = Request.<wbr />blank(&#x27;<wbr />/sda1/p/<wbr />a/c/o&#x27;,<br />
+                                environ=<wbr />{&#x27;REQUEST_<wbr />METHOD&#x27;<wbr />: &#x27;DELETE&#x27;},<br />
+                                headers=<wbr />{&#x27;X-Timestamp&#x27;<wbr />: timestamp})<br />
+            resp = self.object_<wbr />controller.<wbr />DELETE(<wbr />req)<br />
+            self.assertEqua<wbr />ls(resp.<wbr />status_<wbr />int, 404)<br />
+            objfile = os.path.<wbr />join(self.<wbr />testdir, &#x27;sda1&#x27;,<br />
+                storage_<wbr />directory(<wbr />object_<wbr />server.<wbr />DATADIR, &#x27;p&#x27;,<br />
+                                  hash_path(&#x27;a&#x27;, &#x27;c&#x27;, &#x27;o&#x27;)),<br />
+                timestamp + &#x27;.ts&#x27;)<br />
+            self.assert_<wbr />(os.path.<wbr />isfile(<wbr />objfile)<wbr />)<br />
+            self.assertEqua<wbr />ls(2, calls_made[0])<br />
+        finally:<br />
+            self.object_<wbr />controller.<wbr />container_<wbr />update = orig_cu<br />
+<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def test_call(self):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot; Test swift.object_<wbr />server.<wbr />ObjectControlle<wbr />r.__call_<wbr />_ &quot;&quot;&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inbuf = StringIO()</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          

            <div id="bug-branches">
              <h2>Related branches</h2>

              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/precise/swift/precise-security" class="sprite branch">lp:ubuntu/precise-security/swift</a>
  
  
</div>



              
              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/quantal/swift/quantal-security" class="sprite branch">lp:ubuntu/quantal-security/swift</a>
  
  
</div>



              
              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/raring/swift/raring-security" class="sprite branch">lp:ubuntu/raring-security/swift</a>
  
  
</div>



              
            </div>
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2013-4155" title="OpenStack Swift before 1.9.1 in Folso...">2013-4155</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
    
    <time title="2013-07-02 14:14:48 UTC" datetime="2013-07-02T14:14:48.104455+00:00">on 2013-07-02</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-02T16:01:57.849702+00:00" title="2013-07-02 16:01:57 UTC">on 2013-07-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3721993/+files/0002-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">0002-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3721993">Edit</a>
        (14.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is a stab at a patch. I can run this through gerrit if appropriate.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is a stab at a patch. I can run this through gerrit if appropriate.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-02T16:27:04.556129+00:00" title="2013-07-02 16:27:04 UTC">on 2013-07-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Peter, please don&#x27;t submit a patch to gerrit until the bug has been confirmed and the patch reviewed in here. That way, once the patch has been submitted, we can very quickly merge it.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Peter, please don't submit a patch to gerrit until the bug has been confirmed and the patch reviewed in here. That way, once the patch has been submitted, we can very quickly merge it.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-02T16:40:36.869736+00:00" title="2013-07-02 16:40:36 UTC">on 2013-07-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yes, I won&#x27;t submit the patch until given the go-ahead.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yes, I won't submit the patch until given the go-ahead.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-03T19:00:35.386968+00:00" title="2013-07-03 19:00:35 UTC">on 2013-07-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m going to try to paraphrase what goes on here in order to help me understand what&#x27;s going on. Please correct me if I&#x27;m wrong.</p>
<p>Step 1: PUT object, X-Timestamp: t    # works<br />
Step 2: DELETE object, X-Timestamp: t+1    # deletes object, creates tombstone w/timestamp at t+1<br />
Step 3: DELETE object, X-Timestamp: t-1     # creates tombstone w/timestamp at t-1</p>
<p>The bug is that Swift will create a tombstone with timestamp t-1 even though there&#x27;s already a tombstone with a newer time, and so by spamming DELETE requests with timestamps (t-1, t-2, t-3, ...), a user can cause the creation of tons of 0-byte files.</p>
<p>Is that a reasonable restatement of this bug, or am I way off base here?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm going to try to paraphrase what goes on here in order to help me understand what's going on. Please correct me if I'm wrong.

Step 1: PUT object, X-Timestamp: t    # works
Step 2: DELETE object, X-Timestamp: t+1    # deletes object, creates tombstone w/timestamp at t+1
Step 3: DELETE object, X-Timestamp: t-1     # creates tombstone w/timestamp at t-1

The bug is that Swift will create a tombstone with timestamp t-1 even though there's already a tombstone with a newer time, and so by spamming DELETE requests with timestamps (t-1, t-2, t-3, ...), a user can cause the creation of tons of 0-byte files.

Is that a reasonable restatement of this bug, or am I way off base here?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-03T19:11:13.054011+00:00" title="2013-07-03 19:11:13 UTC">on 2013-07-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think that is a reasonable statement here.</p>
<p>I believe the X-timestamp header is passed through by the proxy server, such that this is possible.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think that is a reasonable statement here.

I believe the X-timestamp header is passed through by the proxy server, such that this is possible.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-03T20:05:32.432205+00:00" title="2013-07-03 20:05:32 UTC">on 2013-07-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>And note that when many files get created in the directory, the directory listing will required a lot of memory to perform os.listdir(), and such an operation on a large directory will starve out other requests (currently not wrapped in threadpool if I remember correctly).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">And note that when many files get created in the directory, the directory listing will required a lot of memory to perform os.listdir(), and such an operation on a large directory will starve out other requests (currently not wrapped in threadpool if I remember correctly).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~clay-gerrard" class="sprite person">clayg (clay-gerrard)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-03T20:20:24.990928+00:00" title="2013-07-03 20:20:24 UTC">on 2013-07-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3723586/+files/unlink.patch">unlinkold on largest timestamp</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3723586">Edit</a>
        (1.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yeah X-Timestamp comes through the proxy in part for container sync, it&#x27;s useful and weird, but there it is.</p>
<p>So the risk is using up inodes on a single file system?  If you can get this going on more objects than your estimate there are disks in the cluster you could ruin some poor ops day.</p>
<p>Won&#x27;t a replication pass clear them out once you get the attacking account cut off?</p>
<p>I tried to write a patch in the object server&#x27;s DELETE method that would only create the new timestamp if the object was deleted already and the already deleted object&#x27;s orig_timestamp was larger than the requests timestamp - but all the branching made it look ugly to me.</p>
<p>I&#x27;m sort of inclined to just say:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;diff --git a/swift/<wbr />obj/server.<wbr />py b/swift/<wbr />obj/server.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;index 4bbbb4e..f1f486e 100644<br />
&nbsp;&nbsp;&nbsp;&nbsp;--- a/swift/<wbr />obj/server.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;+++ b/swift/<wbr />obj/server.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;@@ -996,7 +996,7 @@ class ObjectControlle<wbr />r(object)<wbr />:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;return HTTPPreconditio<wbr />nFailed(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />request=<wbr />request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />body=&#x27;X-<wbr />If-Delete-<wbr />At and X-Delete-At do not match&#x27;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;-        orig_timestamp = disk_file.<wbr />metadata.<wbr />get(&#x27;X-<wbr />Timestamp&#x27;<wbr />)<br />
&nbsp;&nbsp;&nbsp;&nbsp;+        orig_timestamp = int(disk_<wbr />file.metadata.<wbr />get(&#x27;X-<wbr />Timestamp&#x27;<wbr />, 0))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if disk_file.<wbr />is_deleted(<wbr />) or disk_file.<wbr />is_expired(<wbr />):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;response_<wbr />class = HTTPNotFound<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metadata = {<br />
&nbsp;&nbsp;&nbsp;&nbsp;@@ -1007,7 +1007,7 @@ class ObjectControlle<wbr />r(object)<wbr />:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;self.<wbr />delete_<wbr />at_update(<wbr />&#x27;DELETE&#x27;<wbr />, old_delete_at, account,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;container, obj, request, device)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disk_<wbr />file.put_<wbr />metadata(<wbr />metadata, tombstone=True)<br />
&nbsp;&nbsp;&nbsp;&nbsp;-        disk_file.<wbr />unlinkold(<wbr />metadata[<wbr />&#x27;X-Timestamp&#x27;<wbr />])<br />
&nbsp;&nbsp;&nbsp;&nbsp;+        disk_file.<wbr />unlinkold(<wbr />max(int(<wbr />metadata[<wbr />&#x27;X-Timestamp&#x27;<wbr />]), orig_timestamp)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if not orig_timestamp or \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />orig_timestamp &lt; request.<wbr />headers[<wbr />&#x27;x-timestamp&#x27;<wbr />]:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;self.<wbr />container_<wbr />update(</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yeah X-Timestamp comes through the proxy in part for container sync, it's useful and weird, but there it is.

So the risk is using up inodes on a single file system?  If you can get this going on more objects than your estimate there are disks in the cluster you could ruin some poor ops day.

Won't a replication pass clear them out once you get the attacking account cut off?

I tried to write a patch in the object server's DELETE method that would only create the new timestamp if the object was deleted already and the already deleted object's orig_timestamp was larger than the requests timestamp - but all the branching made it look ugly to me.

I'm sort of inclined to just say:

    diff --git a/swift/obj/server.py b/swift/obj/server.py
    index 4bbbb4e..f1f486e 100644
    --- a/swift/obj/server.py
    +++ b/swift/obj/server.py
    @@ -996,7 +996,7 @@ class ObjectController(object):
                 return HTTPPreconditionFailed(
                     request=request,
                     body='X-If-Delete-At and X-Delete-At do not match')
    -        orig_timestamp = disk_file.metadata.get('X-Timestamp')
    +        orig_timestamp = int(disk_file.metadata.get('X-Timestamp', 0))
             if disk_file.is_deleted() or disk_file.is_expired():
                 response_class = HTTPNotFound
             metadata = {
    @@ -1007,7 +1007,7 @@ class ObjectController(object):
                 self.delete_at_update('DELETE', old_delete_at, account,
                                       container, obj, request, device)
             disk_file.put_metadata(metadata, tombstone=True)
    -        disk_file.unlinkold(metadata['X-Timestamp'])
    +        disk_file.unlinkold(max(int(metadata['X-Timestamp']), orig_timestamp)
             if not orig_timestamp or \
                     orig_timestamp &lt; request.headers['x-timestamp']:
                 self.container_update(


</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-03T20:42:40.242766+00:00" title="2013-07-03 20:42:40 UTC">on 2013-07-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>First, can we confirm that this is an issue? I think it is, but I would like to have someone else go on record as agreeing that it is a problem. ;)</p>
<p>Second, the patch I posted above solves this problem. I am not sure Clay&#x27;s is sufficient, because we still issue a container update when we don&#x27;t have to, no?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">First, can we confirm that this is an issue? I think it is, but I would like to have someone else go on record as agreeing that it is a problem. ;)

Second, the patch I posted above solves this problem. I am not sure Clay's is sufficient, because we still issue a container update when we don't have to, no?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~redbo" class="sprite person">Mike Barton (redbo)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-04T03:13:31.859639+00:00" title="2013-07-04 03:13:31 UTC">on 2013-07-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>It might be good for the object server and replicator to just share the code to remove old files, since there&#x27;s a repetition of logic.  Also, does anyone else think it&#x27;s kind of gross to allow anyone to set X-Timestamp through the API just to allow container sync?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">It might be good for the object server and replicator to just share the code to remove old files, since there's a repetition of logic.  Also, does anyone else think it's kind of gross to allow anyone to set X-Timestamp through the API just to allow container sync?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-04T12:21:40.260841+00:00" title="2013-07-04 12:21:40 UTC">on 2013-07-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Swift experts: do you see this as a practical vulnerability ? I.e. are vulnerable configurations likely ? If yes, we&#x27;ll probably have to bless the fix on this bug first, then run through the embargoed disclosure process (<a rel="nofollow" href="https://wiki.openstack.org/wiki/VulnerabilityManagement">https:/<wbr />/wiki.openstack<wbr />.org/wiki/<wbr />VulnerabilityMa<wbr />nagement</a>) before pushing it publicly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Swift experts: do you see this as a practical vulnerability ? I.e. are vulnerable configurations likely ? If yes, we'll probably have to bless the fix on this bug first, then run through the embargoed disclosure process (https://wiki.openstack.org/wiki/VulnerabilityManagement) before pushing it publicly.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~clay-gerrard" class="sprite person">clayg (clay-gerrard)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T17:47:27.132834+00:00" title="2013-07-08 17:47:27 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yeah my patch was stupid, ignore my patch.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yeah my patch was stupid, ignore my patch.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T20:18:40.518043+00:00" title="2013-07-08 20:18:40 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So, a few things:</p>
<p>First: after a replication pass, all the superfluous tombstones are cleaned up.</p>
<p>Second, I can pretty easily reproduce this with these commands:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X PUT -H &quot;X-Timestamp: 1373004425&quot; --data-binary &quot;helloworld&quot; -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X DELETE -H &quot;X-Timestamp: 1373004424&quot; -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X DELETE -H &quot;X-Timestamp: 1373004423&quot; -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X DELETE -H &quot;X-Timestamp: 1373004422&quot; -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X DELETE -H &quot;X-Timestamp: 1373004421&quot; -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X DELETE -H &quot;X-Timestamp: 1373004420&quot; -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;curl -v -X GET -H &quot;X-Auth-Token: $TOKEN&quot; <a rel="nofollow" href="http://192.168.22.2:8080/v1.0/AUTH_test/con/obj">http://<wbr />192.168.<wbr />22.2:8080/<wbr />v1.0/AUTH_<wbr />test/con/<wbr />obj</a>   # gets &quot;helloworld&quot; as it should</p>
<p>Obviously, fill in your own Swift cluster&#x27;s IP and auth token.</p>
<p>So, the bug is real. Is it a security vulnerability? I don&#x27;t know.</p>
<p>Let&#x27;s do some napkin math here. Let&#x27;s say you can create bogus tombstones at a rate of 10 per second, and that a replication pass takes two days. That means you can get 86400 * 2 * 10  = 1728000 tombstones before they get cleaned up. Assuming that an os.listdir() returns strings that take 100 bytes of memory each (for reference counting, overhead, and whatever) and you get that an os.listdir() will require ~165 MiB to return its results. That&#x27;s bad, but not the end of the world on decently-sized hardware, so I don&#x27;t think that counts as a DoS attack. And that&#x27;s worst-case, too... if your req/s is lower, or your replicators are faster, or whatever, then the memory usage goes down.</p>
<p>I&#x27;m not enough of an XFS expert to comment on the inode exhaustion problem.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So, a few things:

First: after a replication pass, all the superfluous tombstones are cleaned up.

Second, I can pretty easily reproduce this with these commands:


    curl -v -X PUT -H "X-Timestamp: 1373004425" --data-binary "helloworld" -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj
    curl -v -X DELETE -H "X-Timestamp: 1373004424" -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj
    curl -v -X DELETE -H "X-Timestamp: 1373004423" -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj
    curl -v -X DELETE -H "X-Timestamp: 1373004422" -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj
    curl -v -X DELETE -H "X-Timestamp: 1373004421" -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj
    curl -v -X DELETE -H "X-Timestamp: 1373004420" -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj
    curl -v -X GET -H "X-Auth-Token: $TOKEN" http://192.168.22.2:8080/v1.0/AUTH_test/con/obj   # gets "helloworld" as it should

Obviously, fill in your own Swift cluster's IP and auth token.


So, the bug is real. Is it a security vulnerability? I don't know.

Let's do some napkin math here. Let's say you can create bogus tombstones at a rate of 10 per second, and that a replication pass takes two days. That means you can get 86400 * 2 * 10  = 1728000 tombstones before they get cleaned up. Assuming that an os.listdir() returns strings that take 100 bytes of memory each (for reference counting, overhead, and whatever) and you get that an os.listdir() will require ~165 MiB to return its results. That's bad, but not the end of the world on decently-sized hardware, so I don't think that counts as a DoS attack. And that's worst-case, too... if your req/s is lower, or your replicators are faster, or whatever, then the memory usage goes down.

I'm not enough of an XFS expert to comment on the inode exhaustion problem.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~zaitcev" class="sprite person">Pete Zaitcev (zaitcev)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T21:10:27.378413+00:00" title="2013-07-08 21:10:27 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I was more afraid that enormous directories would boggle everything down. I know on ext4 we have &quot;hashed&quot; directories just for cases like these, not sure about XFS.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I was more afraid that enormous directories would boggle everything down. I know on ext4 we have "hashed" directories just for cases like these, not sure about XFS.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T21:40:12.407286+00:00" title="2013-07-08 21:40:12 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think the memory usage is not the only consideration, but how long it takes to read and parse that many tombstones for os.listdir() and mind you, one has to sort them all as well.</p>
<p>I don&#x27;t mind declassifying this as a security issue, I just did not want to do that without other folks input.</p>
<p>Who makes the call here?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think the memory usage is not the only consideration, but how long it takes to read and parse that many tombstones for os.listdir() and mind you, one has to sort them all as well.

I don't mind declassifying this as a security issue, I just did not want to do that without other folks input.

Who makes the call here?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T21:41:44.691023+00:00" title="2013-07-08 21:41:44 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>And also consider that an attacker could fill just one object&#x27;s directory, and then flood the system with GET requests, which will cause all servers to do that listdir/sort operation at the same time (starving out other requests, etc.).</p>
<p>Am I being paranoid or unrealistic?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">And also consider that an attacker could fill just one object's directory, and then flood the system with GET requests, which will cause all servers to do that listdir/sort operation at the same time (starving out other requests, etc.).

Am I being paranoid or unrealistic?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T22:13:18.604858+00:00" title="2013-07-08 22:13:18 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>We make the call together on if this a security issue or not. (So &quot;everybody and nobody&quot;, and that leaves me to make the final call).</p>
<p>On the one hand, this does seem like something that could be an issue for existing clusters (+1 to security issue)</p>
<p>One the other, threadpools completely mitigate this issue (-1 to security)</p>
<p>One the other other, threadpools aren&#x27;t on by default (+0 for security?)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">We make the call together on if this a security issue or not. (So "everybody and nobody", and that leaves me to make the final call).

On the one hand, this does seem like something that could be an issue for existing clusters (+1 to security issue)

One the other, threadpools completely mitigate this issue (-1 to security)

One the other other, threadpools aren't on by default (+0 for security?)

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T22:26:26.970984+00:00" title="2013-07-08 22:26:26 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Whoops. Further discovery has revealed that the listdir that matters (line 216 of obj/server.py) is not in a threadpool. This means threadpools don&#x27;t help.</p>
<p>I vote for keeping this a security issue because it would allow an attacker to hang a storage node (as Peter described with DELETEs and GETs) or to cause replication and general cluster performance issues by creating so many filesystem objects.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Whoops. Further discovery has revealed that the listdir that matters (line 216 of obj/server.py) is not in a threadpool. This means threadpools don't help.

I vote for keeping this a security issue because it would allow an attacker to hang a storage node (as Peter described with DELETEs and GETs) or to cause replication and general cluster performance issues by creating so many filesystem objects.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-08T22:50:19.458647+00:00" title="2013-07-08 22:50:19 UTC">on 2013-07-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So my first thought is that PUTs would be vulnerable to this as well (create a lot of empty objects with older and older timestamps). However it&#x27;s not. When given a PUT request, the proxy will first to a HEAD if x-timestamp was given on the request. And if the HEAD response is newer than the PUT x-timestamp value, the proxy short-circuits the response (line 865 in the object controller).</p>
<p>This check is not done on a DELETE. Adding it may make a better patch (????)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So my first thought is that PUTs would be vulnerable to this as well (create a lot of empty objects with older and older timestamps). However it's not. When given a PUT request, the proxy will first to a HEAD if x-timestamp was given on the request. And if the HEAD response is newer than the PUT x-timestamp value, the proxy short-circuits the response (line 865 in the object controller).

This check is not done on a DELETE. Adding it may make a better patch (????)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
    
    <time title="2013-07-08 23:42:30 UTC" datetime="2013-07-08T23:42:30.457730+00:00">on 2013-07-08</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-09T00:26:24.185402+00:00" title="2013-07-09 00:26:24 UTC">on 2013-07-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Okay, so this seems like it actually constitutes a DoS attack. Ugh.</p>
<p>How&#x27;s this sound for a proposed fix:</p>
<p>Make it so the object server returns 409 Conflict if you try to make something with an X-Timestamp older than the new thingy on disk. Strictly speaking, this is probably the only bit that has to be done to fix the hole. That&#x27;s DELETE, PUT, and POST.</p>
<p>This is basically what Peter&#x27;s patch does, only for more verbs.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Okay, so this seems like it actually constitutes a DoS attack. Ugh.

How's this sound for a proposed fix:

Make it so the object server returns 409 Conflict if you try to make something with an X-Timestamp older than the new thingy on disk. Strictly speaking, this is probably the only bit that has to be done to fix the hole. That's DELETE, PUT, and POST.

This is basically what Peter's patch does, only for more verbs.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-09T00:51:53.741122+00:00" title="2013-07-09 00:51:53 UTC">on 2013-07-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sounds good. I&#x27;ll add those verbs to the patch, and repost the patch here for review.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sounds good. I'll add those verbs to the patch, and repost the patch here for review.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-09T01:43:49.596485+00:00" title="2013-07-09 01:43:49 UTC">on 2013-07-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3729922/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">Fix handling of DELETE obj reqs with old timestamp (and PUT &amp; POST)</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3729922">Edit</a>
        (22.4 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Patch commit message:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fix handling of DELETE obj reqs with old timestamp</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The DELETE object REST API was creating tombstone files with old<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamps, potentially filling up the disk, as well as sending<br />
&nbsp;&nbsp;&nbsp;&nbsp;container updates.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Here we now make DELETEs with a request timestamp return a 409 (HTTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;Conflict) if a data file exists with a newer timestamp, only creating<br />
&nbsp;&nbsp;&nbsp;&nbsp;tombstones if they have a newer timestamp.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The key fix is to actually read the timestamp metadata from an<br />
&nbsp;&nbsp;&nbsp;&nbsp;existing tombstone file (thanks to Pete Zaitcev for catching this),<br />
&nbsp;&nbsp;&nbsp;&nbsp;and then only create tombstone files with newer timestamps.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;We also prevent PUT and POST operations using old timestamps as well.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Patch commit message:

    Fix handling of DELETE obj reqs with old timestamp
    
    The DELETE object REST API was creating tombstone files with old
    timestamps, potentially filling up the disk, as well as sending
    container updates.
    
    Here we now make DELETEs with a request timestamp return a 409 (HTTP
    Conflict) if a data file exists with a newer timestamp, only creating
    tombstones if they have a newer timestamp.
    
    The key fix is to actually read the timestamp metadata from an
    existing tombstone file (thanks to Pete Zaitcev for catching this),
    and then only create tombstone files with newer timestamps.
    
    We also prevent PUT and POST operations using old timestamps as well.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-09T13:02:52.761010+00:00" title="2013-07-09 13:02:52 UTC">on 2013-07-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I agree if there is a practical attack scenario we should issue an OSSA about this. The next steps are:<br />
- review the attached patch on the bug, so that we can fast-track its approvals when we make everything public (swift-core team)<br />
- propose and review a backport of the fix for Swift 1.8.0 (grizzly release), which I assume is affected as well (swift-core)<br />
- produce an impact description (VMT team)<br />
- review proposed impact description (everyone)<br />
- request CVE (VMT team)<br />
- coordinate public advisory release and patch merging (VMT team)</p>
<p>John: Will the advisory with the patch be enough, or are you going to want to do a 1.9.1 over this ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I agree if there is a practical attack scenario we should issue an OSSA about this. The next steps are:
- review the attached patch on the bug, so that we can fast-track its approvals when we make everything public (swift-core team)
- propose and review a backport of the fix for Swift 1.8.0 (grizzly release), which I assume is affected as well (swift-core)
- produce an impact description (VMT team)
- review proposed impact description (everyone)
- request CVE (VMT team)
- coordinate public advisory release and patch merging (VMT team)

John: Will the advisory with the patch be enough, or are you going to want to do a 1.9.1 over this ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Medium
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~redbo" class="sprite person">Mike Barton (redbo)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-10T03:54:59.997746+00:00" title="2013-07-10 03:54:59 UTC">on 2013-07-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3731357/+files/unify_cleanup.patch">unify_cleanup.patch</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3731357">Edit</a>
        (10.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>re-use get_hashes cleanup logic when writing new files in object server</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">re-use get_hashes cleanup logic when writing new files in object server</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-10T14:07:04.977946+00:00" title="2013-07-10 14:07:04 UTC">on 2013-07-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Proposed impact description (will be used in CVE request and public advisory):</p>
<p>-------<wbr />-------<wbr />-------<wbr />-------<wbr />------<br />
Title: Swift Denial of Service using superfluous object tombstones<br />
Reporter: Peter Portante<br />
Products: Swift<br />
Affects: All versions</p>
<p>Description:<br />
Peter Portante reported a vulnerability in Swift. By issuing a lot of DELETE requests an authenticated attacker can fill an object server with superfluous object tombstones, which may significantly slow down subsequent requests to that object server, facilitating a Denial of Service attack against Swift clusters.<br />
-------<wbr />-------<wbr />-------<wbr />-------<wbr />------</p>
<p>@all: please check that the description is accurate.<br />
@Peter: do you want us to additionally credit the company you work for, if any ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Proposed impact description (will be used in CVE request and public advisory):

----------------------------------
Title: Swift Denial of Service using superfluous object tombstones
Reporter: Peter Portante
Products: Swift
Affects: All versions

Description:
Peter Portante reported a vulnerability in Swift. By issuing a lot of DELETE requests an authenticated attacker can fill an object server with superfluous object tombstones, which may significantly slow down subsequent requests to that object server, facilitating a Denial of Service attack against Swift clusters.
----------------------------------

@all: please check that the description is accurate.
@Peter: do you want us to additionally credit the company you work for, if any ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Thierry Carrez (ttx)
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-10T18:25:59.951530+00:00" title="2013-07-10 18:25:59 UTC">on 2013-07-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Thierry: yes, please, Red Hat, Inc.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Thierry: yes, please, Red Hat, Inc.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-11T14:44:01.480547+00:00" title="2013-07-11 14:44:01 UTC">on 2013-07-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Peter, please compare your work against that which Mike proposed</p>
<p>@Thierry, yes, we should roll a 1.9.1 with this patch when it lands.</p>
<p>I&#x27;d update the CVE description to the following (I&#x27;m sure it could be improved):</p>
<p>Peter Portante at Red Hat, Inc. reported a vulnerability in Swift. By issuing requests with an old X-Timestamp value, an authenticated attacker can fill an object server with superfluous object tombstones, which may significantly slow down subsequent requests to that object server, facilitating a Denial of Service attack against Swift clusters. The patch prevents this behavior by rejecting requests that would add older objects on disk.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Peter, please compare your work against that which Mike proposed

@Thierry, yes, we should roll a 1.9.1 with this patch when it lands.

I'd update the CVE description to the following (I'm sure it could be improved):

Peter Portante at Red Hat, Inc. reported a vulnerability in Swift. By issuing requests with an old X-Timestamp value, an authenticated attacker can fill an object server with superfluous object tombstones, which may significantly slow down subsequent requests to that object server, facilitating a Denial of Service attack against Swift clusters. The patch prevents this behavior by rejecting requests that would add older objects on disk.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-11T15:04:02.936160+00:00" title="2013-07-11 15:04:02 UTC">on 2013-07-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@John, yes, I&#x27;ll review and compare Mike&#x27;s proposed patch today.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@John, yes, I'll review and compare Mike's proposed patch today.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~redbo" class="sprite person">Mike Barton (redbo)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-11T22:38:53.247332+00:00" title="2013-07-11 22:38:53 UTC">on 2013-07-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>They&#x27;re not mutually exclusive, and I can do mine as a regular change later.  I&#x27;m good with Peter&#x27;s idea of rejecting requests that have no effect.  It&#x27;d probably be good from a end-user perspective as well.</p>
<p>But it&#x27;s silly that we have a good version of &quot;cleanup object directory&quot; used mostly by the replicator and a shitty version in the object server.  Just using the one good version would prevent these kinds of problems.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">They're not mutually exclusive, and I can do mine as a regular change later.  I'm good with Peter's idea of rejecting requests that have no effect.  It'd probably be good from a end-user perspective as well.

But it's silly that we have a good version of "cleanup object directory" used mostly by the replicator and a shitty version in the object server.  Just using the one good version would prevent these kinds of problems.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-12T04:07:17.119680+00:00" title="2013-07-12 04:07:17 UTC">on 2013-07-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@John: I agree with Mike, it is not mutually exclusive, and can be applied later.</p>
<p>@Mike: have you thought about the implication that every PUT, POST and DELETE operation will list the directory twice with your patch? Once at DiskFile instantiation, and then again in the final_put() method?  This might cause a general slow-down we should consider and measure. Let me know if I am not understanding the patch correctly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@John: I agree with Mike, it is not mutually exclusive, and can be applied later.

@Mike: have you thought about the implication that every PUT, POST and DELETE operation will list the directory twice with your patch? Once at DiskFile instantiation, and then again in the final_put() method?  This might cause a general slow-down we should consider and measure. Let me know if I am not understanding the patch correctly.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~redbo" class="sprite person">Mike Barton (redbo)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-12T06:20:39.633825+00:00" title="2013-07-12 06:20:39 UTC">on 2013-07-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I replaced the unlinkold call for PUT and DELETE, which was already doing the same listdir.</p>
<p>I&#x27;m adding cleanup logic to POST where it didn&#x27;t exist before, but that might actually fix another DoS attack in this category, if it&#x27;s writing new .meta files without checking for existing ones.  I&#x27;ll have to read through the code to see if that&#x27;s the case.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I replaced the unlinkold call for PUT and DELETE, which was already doing the same listdir.

I'm adding cleanup logic to POST where it didn't exist before, but that might actually fix another DoS attack in this category, if it's writing new .meta files without checking for existing ones.  I'll have to read through the code to see if that's the case.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-12T10:05:37.328921+00:00" title="2013-07-12 10:05:37 UTC">on 2013-07-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Mike: Isn&#x27;t there still the os.listdir() call in the DiskFile constructor still?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Mike: Isn't there still the os.listdir() call in the DiskFile constructor still?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-12T12:11:18.781838+00:00" title="2013-07-12 12:11:18 UTC">on 2013-07-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>CVE descriptions talk about the vulnerability, not the patch. Proposed final wording:</p>
<p>-------<wbr />-------<wbr />-------<wbr />-------<wbr />------<br />
Title: Swift Denial of Service using superfluous object tombstones<br />
Reporter: Peter Portante (Red Hat)<br />
Products: Swift<br />
Affects: All versions</p>
<p>Description:<br />
Peter Portante from Red Hat reported a vulnerability in Swift. By issuing requests with an old X-Timestamp value, an authenticated attacker can fill an object server with superfluous object tombstones, which may significantly slow down subsequent requests to that object server, facilitating a Denial of Service attack against Swift clusters.<br />
-------<wbr />-------<wbr />-------<wbr />-------<wbr />------</p>
<p>I&#x27;ll request the CVE once we get nearer to an acceptable patch.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">CVE descriptions talk about the vulnerability, not the patch. Proposed final wording:

----------------------------------
Title: Swift Denial of Service using superfluous object tombstones
Reporter: Peter Portante (Red Hat)
Products: Swift
Affects: All versions

Description:
Peter Portante from Red Hat reported a vulnerability in Swift. By issuing requests with an old X-Timestamp value, an authenticated attacker can fill an object server with superfluous object tombstones, which may significantly slow down subsequent requests to that object server, facilitating a Denial of Service attack against Swift clusters.
----------------------------------

I'll request the CVE once we get nearer to an acceptable patch.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~redbo" class="sprite person">Mike Barton (redbo)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-14T09:39:05.882735+00:00" title="2013-07-14 09:39:05 UTC">on 2013-07-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yeah, we listdir the hash directory twice.</p>
<p>We probably don&#x27;t need to do the first listdir for PUTs, POSTs and DELETEs, since we could just write the new file then do a cleanup op.  But then I don&#x27;t think we can do the other patch to reject operations that have no effect.</p>
<p>Or we could re-use the results of the first listdir to clean up, but that could leave multiple .data files laying around for concurrent PUTs.</p>
<p>Really, I&#x27;m not that excited about putting a lot of work into it, since the second listdir should generally be serviced by the page cache.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yeah, we listdir the hash directory twice.

We probably don't need to do the first listdir for PUTs, POSTs and DELETEs, since we could just write the new file then do a cleanup op.  But then I don't think we can do the other patch to reject operations that have no effect.

Or we could re-use the results of the first listdir to clean up, but that could leave multiple .data files laying around for concurrent PUTs.

Really, I'm not that excited about putting a lot of work into it, since the second listdir should generally be serviced by the page cache.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-15T20:42:54.484020+00:00" title="2013-07-15 20:42:54 UTC">on 2013-07-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So can we confirm that we have an acceptable propose patch and follow-on work to cleanup a set of usage patterns?</p>
<p>Has anybody taken the proposed patch and verified it themselves?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So can we confirm that we have an acceptable propose patch and follow-on work to cleanup a set of usage patterns?

Has anybody taken the proposed patch and verified it themselves?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-18T19:23:23.261074+00:00" title="2013-07-18 19:23:23 UTC">on 2013-07-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Are we going to get this moving?  Rebasing patches consumes developer time.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Are we going to get this moving?  Rebasing patches consumes developer time.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-18T19:29:51.897439+00:00" title="2013-07-18 19:29:51 UTC">on 2013-07-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>FWIW: I have a branch with the propose patch in one commit, with Mike&#x27;s patch layered on top, and have been rebasing them as the tree moves forward.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">FWIW: I have a branch with the propose patch in one commit, with Mike's patch layered on top, and have been rebasing them as the tree moves forward.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-18T19:51:05.613943+00:00" title="2013-07-18 19:51:05 UTC">on 2013-07-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Since it looks like there hasn&#x27;t been any subsequent feedback on Thierry&#x27;s updated impact description in comment #32, just going on record to state that it seems accurate to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Since it looks like there hasn't been any subsequent feedback on Thierry's updated impact description in comment #32, just going on record to state that it seems accurate to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-18T21:04:34.077744+00:00" title="2013-07-18 21:04:34 UTC">on 2013-07-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thierry&#x27;s description seems accurate to me, too.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thierry's description seems accurate to me, too.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-18T21:27:55.061735+00:00" title="2013-07-18 21:27:55 UTC">on 2013-07-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3741659/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">A final update ... perhaps?</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3741659">Edit</a>
        (22.7 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Vanilla patch rebased to c9de9f2b8da2353<wbr />8b82f23c724b482<wbr />404d0ea916.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Vanilla patch rebased to c9de9f2b8da23538b82f23c724b482404d0ea916.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-18T21:29:10.581058+00:00" title="2013-07-18 21:29:10 UTC">on 2013-07-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3741664/+files/0001-Mike-Barton-s-suggested-patch-for-bug-1196932.patch">Mike Barton's follow code rebased on top of the proposed patch</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3741664">Edit</a>
        (11.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T10:25:37.412407+00:00" title="2013-07-19 10:25:37 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>CVE requested</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">CVE requested</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T14:32:32.235566+00:00" title="2013-07-19 14:32:32 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Peter&#x27;s patch in #39 lgtm</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Peter's patch in #39 lgtm</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T22:25:46.480322+00:00" title="2013-07-19 22:25:46 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>after we get a second core-dev approval on peter&#x27;s patch, thierry and I will work together to get the swift 1.9.1 release out with this patch included</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">after we get a second core-dev approval on peter's patch, thierry and I will work together to get the swift 1.9.1 release out with this patch included</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-26T19:38:20.278437+00:00" title="2013-07-26 19:38:20 UTC">on 2013-07-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3750254/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.folsom.patch">Latest patch applied to Folsom</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3750254">Edit</a>
        (20.9 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-26T19:38:50.503791+00:00" title="2013-07-26 19:38:50 UTC">on 2013-07-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3750255/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.grizzly.patch">Latest patch applied to Grizzly</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3750255">Edit</a>
        (20.1 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-26T19:40:45.542386+00:00" title="2013-07-26 19:40:45 UTC">on 2013-07-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3750256/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.havana.patch">Latest patch applied to Havana</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3750256">Edit</a>
        (22.3 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Latest patch applied to Master (Havana)</p>
<p>$ git log --oneline --decorate -10<br />
e7bb33b (HEAD, <a href="/bugs/1196932" class="bug-link">bug-1196932</a>) Fix handling of DELETE obj reqs with old timestamp<br />
db2a478 (gerrit/master, master) Unify _commit_puts for accounts and containers<br />
76f12c8 Merge &quot;Ignore coverage HTML directory and MANIFEST.&quot;<br />
898e344 Merge &quot;remove assert syntax&quot;<br />
934cd9d Ignore coverage HTML directory and MANIFEST.<br />
3e82858 Merge &quot;Catch swob responses that are raised.&quot;<br />
741c316 fix name &#x27;recon_container&#x27; to &#x27;rcache&#x27;<br />
ac6ff8d Merge &quot;Tempurl md use of split_path in _get_account&quot;<br />
bf95bb0 Merge &quot;Corrected many style violations in the tests.&quot;<br />
df7fc96 Catch swob responses that are raised.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Latest patch applied to Master (Havana)

$ git log --oneline --decorate -10
e7bb33b (HEAD, bug-1196932) Fix handling of DELETE obj reqs with old timestamp
db2a478 (gerrit/master, master) Unify _commit_puts for accounts and containers
76f12c8 Merge "Ignore coverage HTML directory and MANIFEST."
898e344 Merge "remove assert syntax"
934cd9d Ignore coverage HTML directory and MANIFEST.
3e82858 Merge "Catch swob responses that are raised."
741c316 fix name 'recon_container' to 'rcache'
ac6ff8d Merge "Tempurl md use of split_path in _get_account"
bf95bb0 Merge "Corrected many style violations in the tests."
df7fc96 Catch swob responses that are raised.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/47" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-29T09:59:03.448061+00:00" title="2013-07-29 09:59:03 UTC">on 2013-07-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/47"> #47</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Please get another +2 on the proposed patches.</p>
<p>Then the plan we agreed with John is to:<br />
- define a public disclosure date<br />
- send the patches as an embargoed disclosure to the distros and public cloud providers so that they coordinate fixes<br />
- on public disclosure date, push the patch to the branches and cut a 1.9.1 RC (milestone-proposed branch)<br />
- Publish 1.9.1 when you&#x27;re all good with it</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Please get another +2 on the proposed patches.

Then the plan we agreed with John is to:
- define a public disclosure date
- send the patches as an embargoed disclosure to the distros and public cloud providers so that they coordinate fixes
- on public disclosure date, push the patch to the branches and cut a 1.9.1 RC (milestone-proposed branch)
- Publish 1.9.1 when you're all good with it</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/48" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-29T20:37:45.840192+00:00" title="2013-07-29 20:37:45 UTC">on 2013-07-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/48"> #48</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Code looks good; both unit and functional tests pass, and I can&#x27;t make superfluous tombstones any more.</p>
<p>+2 from me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Code looks good; both unit and functional tests pass, and I can't make superfluous tombstones any more.

+2 from me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/49" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-01T17:49:53.469895+00:00" title="2013-08-01 17:49:53 UTC">on 2013-08-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/49"> #49</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3757231/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">Latest patch merged up to b7907f3 of master</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3757231">Edit</a>
        (22.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>$ git log --oneline --decorate -3<br />
2e7de1a (HEAD, <a href="/bugs/1196932" class="bug-link">bug-1196932</a>-redbo) *** Mike Barton&#x27;s suggested patch for <a href="/bugs/1196932" class="bug-link">bug-1196932</a> ***<br />
c248bd1 (<a href="/bugs/1196932" class="bug-link">bug-1196932</a>) Fix handling of DELETE obj reqs with old timestamp<br />
b7907f3 (gerrit/master, master) Merge &quot;give value [] if disallowed_<wbr />metadata_<wbr />keys is None&quot;<br />
$</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">$ git log --oneline --decorate -3
2e7de1a (HEAD, bug-1196932-redbo) *** Mike Barton's suggested patch for bug-1196932 ***
c248bd1 (bug-1196932) Fix handling of DELETE obj reqs with old timestamp
b7907f3 (gerrit/master, master) Merge "give value [] if disallowed_metadata_keys is None"
$</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/50" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-01T17:51:18.693441+00:00" title="2013-08-01 17:51:18 UTC">on 2013-08-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/50"> #50</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3757232/+files/0002-Mike-Barton-s-suggested-patch-for-bug-1196932.patch">Mike Barton's follow code rebased on top of the proposed patch</a>
        <a class="sprite edit action-icon" href="/swift/+bug/1196932/+attachment/3757232">Edit</a>
        (11.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>And here is MIke Barton&#x27;s (redbo) additional patch which does not have to go downstream, but we should apply immediately as well.</p>
<p>$ git log --oneline --decorate -3<br />
2e7de1a (HEAD, <a href="/bugs/1196932" class="bug-link">bug-1196932</a>-redbo) *** Mike Barton&#x27;s suggested patch for <a href="/bugs/1196932" class="bug-link">bug-1196932</a> ***<br />
c248bd1 (<a href="/bugs/1196932" class="bug-link">bug-1196932</a>) Fix handling of DELETE obj reqs with old timestamp<br />
b7907f3 (gerrit/master, master) Merge &quot;give value [] if disallowed_<wbr />metadata_<wbr />keys is None&quot;<br />
$</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">And here is MIke Barton's (redbo) additional patch which does not have to go downstream, but we should apply immediately as well.

$ git log --oneline --decorate -3
2e7de1a (HEAD, bug-1196932-redbo) *** Mike Barton's suggested patch for bug-1196932 ***
c248bd1 (bug-1196932) Fix handling of DELETE obj reqs with old timestamp
b7907f3 (gerrit/master, master) Merge "give value [] if disallowed_metadata_keys is None"
$</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/51" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-01T18:17:10.590697+00:00" title="2013-08-01 18:17:10 UTC">on 2013-08-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/51"> #51</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>lgtm.</p>
<p>@ttx, leooks good to go for downstream release</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">lgtm.

@ttx, leooks good to go for downstream release</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/52" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-02T09:36:03.752577+00:00" title="2013-08-02 09:36:03 UTC">on 2013-08-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/52"> #52</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Patches sent to downstream stakeholders.<br />
Proposed public disclosure date/time: Wednesday, August 7, 1500UTC.<br />
We&#x27;ll push public patches then and cut a 1.9.1 RC1 shortly after.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Patches sent to downstream stakeholders.
Proposed public disclosure date/time: Wednesday, August 7, 1500UTC.
We'll push public patches then and cut a 1.9.1 RC1 shortly after.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/53" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~cthier" class="sprite person">Chuck Thier (cthier)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-02T16:21:17.611247+00:00" title="2013-08-02 16:21:17 UTC">on 2013-08-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/53"> #53</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Did the CVE email include the patch for Havana?  I was just asked by a package maintainer that said that the email sent didn&#x27;t include a patch for that.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Did the CVE email include the patch for Havana?  I was just asked by a package maintainer that said that the email sent didn't include a patch for that.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/54" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-02T22:29:14.110301+00:00" title="2013-08-02 22:29:14 UTC">on 2013-08-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/54"> #54</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The &quot;havana&quot; patch was attached as swift-master.patch (keep in mind that the havana stable release is still a couple months away).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The "havana" patch was attached as swift-master.patch (keep in mind that the havana stable release is still a couple months away).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/55" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~cthier" class="sprite person">Chuck Thier (cthier)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-06T16:04:22.834127+00:00" title="2013-08-06 16:04:22 UTC">on 2013-08-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/55"> #55</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Do we have a planned date for when the patch will land in Master?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Do we have a planned date for when the patch will land in Master?  </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/56" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-06T16:18:52.562776+00:00" title="2013-08-06 16:18:52 UTC">on 2013-08-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/56"> #56</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Chuck: the patch will be proposed on review.o.o at the public disclosure date: Wednesday, August 7, 1500UTC</p>
<p>Then we&#x27;ll need a swift-core member to fast-track it through review (based on the pre-approvals we&#x27;ve gathered on this bug) and it will land in master shortly afterwards.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Chuck: the patch will be proposed on review.o.o at the public disclosure date: Wednesday, August 7, 1500UTC

Then we'll need a swift-core member to fast-track it through review (based on the pre-approvals we've gathered on this bug) and it will land in master shortly afterwards.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/57" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peter-a-portante" class="sprite person">Peter Portante (peter-a-portante)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-06T16:30:19.970675+00:00" title="2013-08-06 16:30:19 UTC">on 2013-08-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/57"> #57</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Being 4 hours behind on the East Coast, I plan to be submitting the patch for review at 1100EDT. Just would like one other core member to double check the rebase that will have to occur.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Being 4 hours behind on the East Coast, I plan to be submitting the patch for review at 1100EDT. Just would like one other core member to double check the rebase that will have to occur.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-08-07 15:04:00 UTC" datetime="2013-08-07T15:04:00.324421+00:00">on 2013-08-07</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/58" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-07T15:14:32.133765+00:00" title="2013-08-07 15:14:32 UTC">on 2013-08-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/58"> #58</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>master @ <a rel="nofollow" href="https://review.openstack.org/#/c/40643/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />40643/</a><br />
grizzly @ <a rel="nofollow" href="https://review.openstack.org/#/c/40645/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />40645/</a><br />
folsom @ <a rel="nofollow" href="https://review.openstack.org/#/c/40646/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />40646/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">master @ https://review.openstack.org/#/c/40643/
grizzly @ https://review.openstack.org/#/c/40645/
folsom @ https://review.openstack.org/#/c/40646/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/59" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-07T15:50:24.480867+00:00" title="2013-08-07 15:50:24 UTC">on 2013-08-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/59"> #59</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>OSSA 2013-022 is out, just waiting for final patch landing before closing the OSSA task</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">OSSA 2013-022 is out, just waiting for final patch landing before closing the OSSA task</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Possibly DoS attack using object tombstones<br />+ [OSSA 2013-022] Possibly DoS attack using object tombstones<br />+ (CVE-2013-4155)
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Released &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-08-07 16:05:03 UTC" datetime="2013-08-07T16:05:03.439014+00:00">on 2013-08-07</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/swift/+bug/1196932/comments/60" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-07T16:18:57.330403+00:00" title="2013-08-07 16:18:57 UTC">on 2013-08-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/swift/+bug/1196932/comments/60"> #60</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>All patches in, thx everyone!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">All patches in, thx everyone!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-08-07 16:52:36 UTC" datetime="2013-08-07T16:52:36.979354+00:00">on 2013-08-07</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/swift/+bug/1196932/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/swift/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/swift/+bug/1196932/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/swift/+bug/1196932/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/swift/+bug/1196932/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/swift/+bug/1196932/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/swift/+bug/1196932/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/swift/+bug/1196932/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/swift/+bug/1196932/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/swift/+bug/1196932/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/swift/+bug/1196932/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3721993/+files/0002-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">0002-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3721993">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3723586/+files/unlink.patch">unlinkold on largest timestamp</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3723586">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3729922/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">Fix handling of DELETE obj reqs with old timestamp (and PUT &amp; POST)</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3729922">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3731357/+files/unify_cleanup.patch">unify_cleanup.patch</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3731357">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3741659/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">A final update ... perhaps?</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3741659">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3741664/+files/0001-Mike-Barton-s-suggested-patch-for-bug-1196932.patch">Mike Barton's follow code rebased on top of the proposed patch</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3741664">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3750254/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.folsom.patch">Latest patch applied to Folsom</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3750254">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3750255/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.grizzly.patch">Latest patch applied to Grizzly</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3750255">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3750256/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.havana.patch">Latest patch applied to Havana</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3750256">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3757231/+files/0001-Fix-handling-of-DELETE-obj-reqs-with-old-timestamp.patch">Latest patch merged up to b7907f3 of master</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3757231">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/swift/+bug/1196932/+attachment/3757232/+files/0002-Mike-Barton-s-suggested-patch-for-bug-1196932.patch">Mike Barton's follow code rebased on top of the proposed patch</a>
        <small>
          (<a href="/swift/+bug/1196932/+attachment/3757232">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/swift/+bug/1196932/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "information_type_data": {"PUBLICSECURITY": {"name": "Public Security", "description_css_class": "choice-description", "is_private": false, "value": "PUBLICSECURITY", "description": "Everyone can see this security related information.\n", "order": 1}, "PRIVATESECURITY": {"name": "Private Security", "description_css_class": "choice-description", "is_private": true, "value": "PRIVATESECURITY", "description": "Only the security group can see this information.\n ", "order": 2}, "PUBLIC": {"name": "Public", "description_css_class": "choice-description", "is_private": false, "value": "PUBLIC", "description": "Everyone can see this information.\n", "order": 0}, "USERDATA": {"name": "Private", "description_css_class": "choice-description", "is_private": true, "value": "USERDATA", "description": "Only shared with users permitted to see private user information.\n", "order": 3}}, "initial_comment_batch_offset": 41, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1196932", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1196932"}, "first visible_recent_comment": 20, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1196932", "web_link": "https://bugs.launchpad.net/bugs/1196932", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1196932, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)", "description": "Is it possible for an attacker can fill a disk with old tombstones, slowing down object servers in the least with DELETE requests?  I am not entirely sure I understand all of the DELETE behavior.\n\nSee the following patch which is a unit test which details the behavior (this currently fails on the last check because no metadata is pulled from the tombstone, so the container update is always performed).\n\ndiff --git a/test/unit/obj/test_server.py b/test/unit/obj/test_server.py\nindex e3f24d6..27f75d9 100755\n--- a/test/unit/obj/test_server.py\n+++ b/test/unit/obj/test_server.py\n@@ -1410,6 +1410,115 @@ class TestObjectController(unittest.TestCase):\n             timestamp + '.ts')\n         self.assert_(os.path.isfile(objfile))\n \n+    def test_DELETE_container_updates(self):\n+        # Test swift.object_server.ObjectController.DELETE and container\n+        # updates, making sure container update is called in the correct\n+        # state.\n+        timestamp = normalize_timestamp(time())\n+        req = Request.blank('/sda1/p/a/c/o', environ={'REQUEST_METHOD': 'PUT'},\n+                            headers={\n+                                'X-Timestamp': timestamp,\n+                                'Content-Type': 'application/octet-stream',\n+                                'Content-Length': '4',\n+                                })\n+        req.body = 'test'\n+        resp = self.object_controller.PUT(req)\n+        self.assertEquals(resp.status_int, 201)\n+\n+        calls_made = [0]\n+\n+        def our_container_update(*args, **kwargs):\n+            calls_made[0] += 1\n+\n+        orig_cu = self.object_controller.container_update\n+        self.object_controller.container_update = our_container_update\n+        try:\n+            # The following request should return 204, but the object won't be\n+            # truly deleted (container update is not performed) because the\n+            # timestamp is old. A tombstone file should have been created with\n+            # this timestamp.\n+            #\n+            # FIXME - When we know a newer file exists, should this not return\n+            # HTTPConflict, and a tombstone not be created?\n+            timestamp = normalize_timestamp(float(timestamp) - 1)\n+            req = Request.blank('/sda1/p/a/c/o',\n+                                environ={'REQUEST_METHOD': 'DELETE'},\n+                                headers={'X-Timestamp': timestamp})\n+            resp = self.object_controller.DELETE(req)\n+            self.assertEquals(resp.status_int, 204)\n+            objfile = os.path.join(self.testdir, 'sda1',\n+                storage_directory(object_server.DATADIR, 'p',\n+                                  hash_path('a', 'c', 'o')),\n+                timestamp + '.ts')\n+            self.assert_(os.path.isfile(objfile))\n+            self.assertEquals(0, calls_made[0])\n+\n+            # The following request should return 204, and the object should\n+            # be truly deleted (container update is performed) because this\n+            # timestamp is newer. A tombstone file should have been created\n+            # with this timestamp.\n+            sleep(.00001)\n+            timestamp = normalize_timestamp(time())\n+            req = Request.blank('/sda1/p/a/c/o',\n+                                environ={'REQUEST_METHOD': 'DELETE'},\n+                                headers={'X-Timestamp': timestamp})\n+            resp = self.object_controller.DELETE(req)\n+            self.assertEquals(resp.status_int, 204)\n+            objfile = os.path.join(self.testdir, 'sda1',\n+                storage_directory(object_server.DATADIR, 'p',\n+                                  hash_path('a', 'c', 'o')),\n+                timestamp + '.ts')\n+            self.assert_(os.path.isfile(objfile))\n+            self.assertEquals(1, calls_made[0])\n+\n+            # The following request should return a 404, as the object should\n+            # already have been deleted, but it should have also performed a\n+            # container update because the timestamp is newer, and a tombstone\n+            # file should also exist for this timestamp.\n+            #\n+            # FIXME - A malicious client can cause a set of object servers to\n+            # update containers and fill the volume with .ts files as the code\n+            # stands: if the file is already deleted, should this not just\n+            # return a 404 and avoid all the updates and tombstones?\n+            sleep(.00001)\n+            timestamp = normalize_timestamp(time())\n+            req = Request.blank('/sda1/p/a/c/o',\n+                                environ={'REQUEST_METHOD': 'DELETE'},\n+                                headers={'X-Timestamp': timestamp})\n+            resp = self.object_controller.DELETE(req)\n+            self.assertEquals(resp.status_int, 404)\n+            objfile = os.path.join(self.testdir, 'sda1',\n+                storage_directory(object_server.DATADIR, 'p',\n+                                  hash_path('a', 'c', 'o')),\n+                timestamp + '.ts')\n+            self.assert_(os.path.isfile(objfile))\n+            self.assertEquals(2, calls_made[0])\n+\n+\n+            # The following request should return a 404, as the object should\n+            # already have been deleted, and it should not have performed a\n+            # container update because the timestamp is oler, though a\n+            # tombstone file should also have been created with this\n+            # timestamp.\n+            #\n+            # FIXME - A malicious client can cause an object server to fill up\n+            # the volume with .ts files as the code stands: should we not\n+            # allow new tombstone files to be create without older timestamps?\n+            timestamp = normalize_timestamp(float(timestamp) - 1)\n+            req = Request.blank('/sda1/p/a/c/o',\n+                                environ={'REQUEST_METHOD': 'DELETE'},\n+                                headers={'X-Timestamp': timestamp})\n+            resp = self.object_controller.DELETE(req)\n+            self.assertEquals(resp.status_int, 404)\n+            objfile = os.path.join(self.testdir, 'sda1',\n+                storage_directory(object_server.DATADIR, 'p',\n+                                  hash_path('a', 'c', 'o')),\n+                timestamp + '.ts')\n+            self.assert_(os.path.isfile(objfile))\n+            self.assertEquals(2, calls_made[0])\n+        finally:\n+            self.object_controller.container_update = orig_cu\n+\n     def test_call(self):\n         \"\"\" Test swift.object_server.ObjectController.__call__ \"\"\"\n         inbuf = StringIO()", "owner_link": "https://bugs.launchpad.net/api/devel/~peter-a-portante", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/bug_tasks", "duplicate_of_link": null, "date_created": "2013-07-02T12:16:11.994606+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/subscriptions", "date_last_updated": "2013-10-24T04:49:08.887472+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 264, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/attachments", "security_related": true, "latest_patch_uploaded": "2013-08-01T17:51:18.693441+00:00", "tags": [], "date_last_message": "2013-08-07T16:18:57.330403+00:00", "number_of_duplicates": 0, "message_count": 61, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1196932/linked_merge_proposals", "http_etag": "\"9f9426584c951eee6ece90f6406624dea49494aa-66c223256e7c1ba876ac072dd877cdcae3f0c3c4\""}, "total_comments_and_activity": 108, "related_features": {}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/swift/+bug/1196932", "web_link": "https://bugs.launchpad.net/swift/+bug/1196932", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1196932", "milestone_link": "https://bugs.launchpad.net/api/devel/swift/+milestone/1.9.1", "status": "Fix Released", "importance": "Critical", "assignee_link": "https://bugs.launchpad.net/api/devel/~peter-a-portante", "bug_target_display_name": "OpenStack Object Storage (swift)", "bug_target_name": "swift", "bug_watch_link": null, "date_assigned": "2013-07-02T12:16:12.462887+00:00", "date_created": "2013-07-02T12:16:11.994606+00:00", "date_confirmed": "2013-07-08T23:42:30.835203+00:00", "date_incomplete": null, "date_in_progress": "2013-08-07T15:13:34.337971+00:00", "date_closed": "2013-08-07T16:52:37.941177+00:00", "date_left_new": "2013-07-08T23:42:30.835203+00:00", "date_triaged": "2013-08-07T15:13:34.337971+00:00", "date_fix_committed": "2013-08-07T16:05:04.120114+00:00", "date_fix_released": "2013-08-07T16:52:37.941177+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~peter-a-portante", "target_link": "https://bugs.launchpad.net/api/devel/swift", "title": "Bug #1196932 in OpenStack Object Storage (swift): \"[OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/swift/+bug/1196932/related_tasks", "is_complete": true, "http_etag": "\"676762c13279605b63d5aa85954ffa1d185f0a64-1c53ae20f4386f99db3ddd305d12e7fedc554469\""}, "bugtask_data": {"1430426": {"bugtask_path": "/swift/grizzly/+bug/1196932", "bug_title": "[OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "OpenStack Object Storage (swift) grizzly", "hide_assignee_team_selection": true, "assignee_is_team": null, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/swift/grizzly/+bug/1196932/+delete", "row_id": "tasksummary1430426", "target_is_product": false, "id": 1430426, "form_row_id": "task1430426", "assignee_vocabulary_filters": [], "prefix": "swift_grizzly", "importance_value": "Undecided", "status_value": "Fix Committed", "assignee_value": null, "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}, "1442219": {"bugtask_path": "/swift/folsom/+bug/1196932", "bug_title": "[OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "OpenStack Object Storage (swift) folsom", "hide_assignee_team_selection": true, "assignee_is_team": null, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/swift/folsom/+bug/1196932/+delete", "row_id": "tasksummary1442219", "target_is_product": false, "id": 1442219, "form_row_id": "task1442219", "assignee_vocabulary_filters": [], "prefix": "swift_folsom", "importance_value": "Undecided", "status_value": "Fix Committed", "assignee_value": null, "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}, "1427198": {"bugtask_path": "/ossa/+bug/1196932", "bug_title": "[OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "OpenStack Security Advisory", "hide_assignee_team_selection": true, "assignee_is_team": false, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ossa/+bug/1196932/+delete", "row_id": "tasksummary1427198", "target_is_product": true, "id": 1427198, "form_row_id": "task1427198", "assignee_vocabulary_filters": [], "prefix": "ossa", "importance_value": "Medium", "status_value": "Fix Released", "assignee_value": "ttx", "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}, "1427135": {"bugtask_path": "/swift/+bug/1196932", "bug_title": "[OSSA 2013-022] Possibly DoS attack using object tombstones (CVE-2013-4155)", "user_can_delete": false, "milestone_value": "https://bugs.launchpad.net/api/devel/swift/+milestone/1.9.1", "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "OpenStack Object Storage (swift)", "hide_assignee_team_selection": true, "assignee_is_team": false, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/swift/+bug/1196932/+delete", "row_id": "tasksummary1427135", "target_is_product": true, "id": 1427135, "form_row_id": "task1427135", "assignee_vocabulary_filters": [], "prefix": "swift", "importance_value": "Critical", "status_value": "Fix Released", "assignee_value": "peter-a-portante", "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}}};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 77 queries/external actions issued in 1.08 seconds

    Features: {'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'bugs.affected_count_includes_dupes.disabled': None, 'baselayout.careers_link.disabled': None, 'js.yui_version': None, 'profiling.enabled': None, 'visible_render_time': None, 'hard_timeout': '9000', 'bugs.nominations.bug_supervisors_can_target': 'on', 'app.maintenance_message': None}

    r0d8de2b

    -->

</html>

