<!DOCTYPE html>
















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Microsoft Security Bulletin MS01-059 - Critical" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2001/ms01-059" />

	<meta name="twitter:card" content="summary" />

	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="BetaFred" />
<meta name="breadcrumb_path" content="/security-updates/breadcrumb/toc.json" />
<meta name="depot_name" content="Security.security-updates" />
<meta name="document_id" content="54814128-fd16-ff6f-44f6-06e86cb26426" />
<meta name="document_version_independent_id" content="a062c3ea-0b54-f8fe-ac50-2d7cd07f04a6" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/security-updates/blob/df90e84771fe2a477f4e352e78bc7c2899ef1116/security-updates/SecurityBulletins/2001/ms01-059.md" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="BetaFred" />
<meta name="ms.date" content="10/11/2017" />
<meta name="ms.service" content="security-updates" />
<meta name="ms.topic" content="article" />
<meta name="ms:assetid" content="ms01-059" />
<meta name="ms:contentKeyID" content="61221893" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/en-us/library/ms01-059(v=Security.10)" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2001/ms01-059.md" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="Title" content="Microsoft Security Bulletin MS01-059 - Critical" />
<meta name="TOCTitle" content="MS01-059" />
<meta name="updated_at" content="2019-12-03 01:16 AM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="../../toc.json" />
<meta name="word_count" content="5579" />


<link href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2001/ms01-059" rel="canonical">
	<title>Microsoft Security Bulletin MS01-059 - Critical | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/46dad2a9.site-ltr.css ">

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2001/ms01-059.md',
			extendBreadcrumb: true,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
			contributors: [
						{ name: "BetaFred", url: "https://github.com/BetaFred" },
						{ name: "mdressman", url: "https://github.com/mdressman" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>

	<script src="/_themes/docs.theme/master/en-us/_themes/global/5cce29c0.deprecation.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/bb2ae21c.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div hidden id="cookie-consent-holder"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">
Download Microsoft Edge					</a>
					<a href="https://docs.microsoft.com/en-US/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">
More info					</a>
				</div>
			</div>

		</div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="is-hidden"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet padding-xs font-size-sm display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button button button-clear button-sm" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button button-clear button-sm has-inner-focus" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
								<li id="contenteditbtn" hidden>
									<a href="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2001/ms01-059.md"  class=" button button-clear button-sm has-inner-focus" title="Edit This Document" data-bi-name="edit">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button button-clear button-sm button-block justify-content-flex-start has-inner-focus" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button  button button-clear button-sm is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button  button button-clear button-sm is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



							

								<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
									<li>
										<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2019-12-03T01:16:00Z" data-article-date-source="git">12/03/2019</time>
									</li>
											<li class="readingTime">27 minutes to read</li>
										<li class="contributors-holder">
											<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
																<li class="facepile-item">
																	<a href="https://github.com/BetaFred" title="BetaFred" aria-label="BetaFredGithub profile" data-src="https://github.com/BetaFred.png?size=32" data-contributor-name="BetaFred" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/BetaFred.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">B</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/mdressman" title="mdressman" aria-label="mdressmanGithub profile" data-src="https://github.com/mdressman.png?size=32" data-contributor-name="mdressman" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/mdressman.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">m</span>
																	</a>
																</li>
											</ul>
										</li>
								</ul>

								<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>


							<!-- <content> -->
								<p>Security Bulletin</p>
<h1 id="microsoft-security-bulletin-ms01-059---critical">Microsoft Security Bulletin MS01-059 - Critical</h1>
<h2 id="unchecked-buffer-in-universal-plug-and-play-can-lead-to-system-compromise">Unchecked Buffer in Universal Plug and Play can Lead to System Compromise</h2>
<p>Published: December 20, 2001 | Updated: May 09, 2003</p>
<p><strong>Version:</strong> 1.3</p>
<p><strong>Originally posted:</strong> December 20, 2001<br/>
<strong>Updated:</strong> May 09, 2003</p>
<h4 id="summary">Summary</h4>
<p><strong>Who should read this bulletin:</strong><br/>
Customers using Microsoft® Windows® ME or XP, or who have installed the Windows XP Internet Connection Sharing client on Windows 98 or 98SE.</p>
<p><strong>Impact of vulnerability:</strong><br/>
Run code of attacker's choice.</p>
<p><strong>Maximum Severity Rating:</strong><br/>
Critical</p>
<p><strong>Recommendation:</strong><br/>
Microsoft strongly urges all Windows XP customers to apply the patch immediately. Customers using Windows 98, 98SE or ME should apply the patch if Universal Plug and Play support is installed and running.</p>
<p><strong>Affected Software:</strong></p>
<ul>
<li>Microsoft Windows 98</li>
<li>Microsoft Windows 98SE</li>
<li>Microsoft Windows ME</li>
<li>Microsoft Windows XP</li>
</ul>
<h3 id="general-information">General Information</h3>
<h2 id="technical-details">Technical details</h2>
<p><strong>Technical description:</strong></p>
<p>Universal Plug and Play (UPnP) allows computers to discover and use network-based devices. Windows ME and XP include native UPnP support; Windows 98 and 98SE do not include native UPnP support, but it can be installed via the Internet Connection Sharing client that ships with Windows XP. This bulletin discusses two vulnerabilities affecting these UPnP implementations. Although the vulnerabilities are unrelated, both involve how UPnP-capable computers handle the discovery of new devices on the network.</p>
<p>The first vulnerability is a buffer overrun vulnerability. There is an unchecked buffer in one of the components that handle NOTIFY directives - messages that advertise the availability of UPnP-capable devices on the network. By sending a specially malformed NOTIFY directive, it would be possible for an attacker to cause code to run in the context of the UPnP subsystem, which runs with System privileges on Windows XP. (On Windows 98 and Windows ME, all code executes as part of the operating system). This would enable the attacker to gain complete control over the system.</p>
<p>The second vulnerability results because the UPnP implementations don't sufficiently limit the steps to which they will go to obtain information on using a newly discovered device. Within the NOTIFY directive that a new UPnP device sends is information telling interested computers where to obtain its device description, which lists the services the device offers and instructions for using them. By design, the device description may reside on a third-party server rather than on the device itself. However, the UPnP implementations don't adequately regulate how it performs this operation, and this gives rise to two different denial of service scenarios:</p>
<ul>
<li>An attacker could send a NOTIFY directive to a UPnP-capable computer, specifying that the device description should be downloaded from a particular port on a particular server. If the server was configured to simply echo the download requests back to the UPnP service (e.g., by having the echo service running on the port that the computer was directed to), the computer could be made to enter an endless download cycle that could consume some or all of the system's availability. An attacker could craft and send this directive to a victim's machine directly, by using the machine's IP address. Or, he could send this same directive to a broadcast and multicast domain and attack all affected machines within earshot, consuming some or all of those systems' availability.</li>
<li>An attacker could specify a third-party server as the host for the device description in the NOTIFY directive. If enough machines responded to the directive, it could have the effect of flooding the third-party server with bogus requests, in a distributed denial of service attack. As with the first scenario, an attacker could either send the directives to the victim directly, or to a broadcast or multicast domain.</li>
</ul>
<p>System administrators should be aware that the patch introduces new functionality that enables them to tailor how patched systems undertake device discovery. As discussed in Microsoft Knowledge Base article <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;q315056" data-linktype="external">Q315056</a>, the patch introduces the ability to configure the UPnP service to download device descriptions only from the local subnet, the subnet or private network, the private network only, or from any IP address. By default, patched systems will only check the subnet or private network for device descriptions.</p>
<p>Customers who cannot install the patch can protect their systems by disabling UPnP support, as discussed in the FAQ.</p>
<p><strong>Mitigating factors:</strong></p>
<p>General:</p>
<ul>
<li>Corporate networks could be protected against Internet-based attacks by following standard firewalling practices (specifically, blocking ports 1900 and 5000).</li>
<li>Home networks that use Internet Connection Sharing would be protected against Internet-based attacks, because the Internet Gateway would not forward the packets. Only the gateway machine would be at risk.</li>
</ul>
<p>Windows 98 and 98SE:</p>
<ul>
<li>There is no native UPnP support for these systems. Windows 98 and 98SE systems would only be affected if the Internet Connection Sharing Client from Windows XP had been installed on the system.</li>
<li>Windows 98 and 98SE machines that have installed the Internet Connection Sharing client from a Windows XP system that has already applied this patch are not vulnerable.</li>
</ul>
<p>Windows ME:</p>
<ul>
<li>Windows ME provides native UPnP support, but it is neither installed nor running by default. (However, some OEMs do configure pre-built systems with the service installed and running).</li>
</ul>
<p>Windows XP:</p>
<ul>
<li>Internet Connection Firewall, which is turned on by default whenever a networking connection to the Internet is configured via one of the system wizards, would protect against attacks using unicast messages. This would make attacks possible only via broadcast or multicast, which would typically require the attacker to be located on the same network segment as the vulnerable system.</li>
</ul>
<p><strong>Severity Rating:</strong></p>
<p>Buffer Overrun:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Windows 98, 98SE</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Windows ME</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Windows XP</strong></td>
<td>None</td>
<td>None</td>
<td>Critical</td>
</tr>
</tbody>
</table>
<p>Denial of Service Vulnerability:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Windows 98, 98SE</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Windows ME</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Windows XP</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
</tbody>
</table>
<p>Aggregate severity of all vulnerabilities eliminated by patch:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Windows 98, 98SE</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Windows ME</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Windows XP</strong></td>
<td>None</td>
<td>None</td>
<td>Critical</td>
</tr>
</tbody>
</table>
<p>The above <a href="http://technet.microsoft.com/security/bulletin/rating" data-linktype="external">assessment</a> is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. The criticality for Windows XP is rated higher than for Windows 98, 98SE and ME, because only Windows XP is vulnerable in its default condition.</p>
<p><strong>Vulnerability identifier:</strong></p>
<ul>
<li>Buffer Overun:<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0876" data-linktype="external">CAN-2001-0876</a></li>
<li>Denial of Service:<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0877" data-linktype="external">CAN-2001-0877</a></li>
</ul>
<p><strong>Tested Versions:</strong></p>
<p>Microsoft tested Windows ME, Windows NT 4.0, Windows 2000 and Windows XP, and the UPnP service that can be installed on Windows 98 and 98SE, to assess whether they are affected by these vulnerabilities. Previous versions are no longer supported and may or may not be affected by this vulnerability</p>
<h2 id="frequently-asked-questions">Frequently asked questions</h2>
<p><strong>What vulnerabilities are discussed in this bulletin?</strong><br/>
This bulletin discusses two vulnerabilities, both affecting the Universal Plug and Play subsystem in Windows 98, Windows 98SE, Windows ME and Windows XP.</p>
<p><strong>What is Universal Plug and Play?</strong><br/>
<a href="http://www.microsoft.com/technet/prodtechnol/winxppro/evaluate/upnpxp.mspx" data-linktype="external">Universal Plug and Play</a> (UPnP) is a capability that allows devices on a network to discover other devices and determine how to work with them. UPnP is most easily understood by comparison to plug-and-play (PnP) capability that most Windows users already are familiar with. PnP allows the operating system to detect new hardware when you install it on a system. For instance, if you install a new mouse onto your computer, PnP allows Windows to detect it, load the needed drivers, and begin using it. UPnP extends this concept to devices on a network, rather than on the local system itself. UPnP lets computers learn about other devices on the network, and determine how to use them. For instance, a computer could use UPnP to detect whether there are printers on the network that it can use and learn how to use them.</p>
<p><strong>What operating systems support UPnP?</strong></p>
<ul>
<li>Neither Windows 98 nor Windows 98SE include a native UPnP capability. It can only be added by installing the client software for Internet Connection Sharing (ICS) provided in Windows XP.</li>
<li>Windows ME includes a native UPnP capability, but it is neither installed nor running by default.</li>
<li>Neither Windows NT 4.0 nor Windows 2000 support UPnP.</li>
<li>Windows XP includes a native UPnP capability. It is installed and running by default.</li>
</ul>
<p><strong>Do the vulnerabilities have anything in common other than the fact that they involve UPnP?</strong><br/>
Yes. Both involve problems in the way the UPnP subsystem performs device discovery.</p>
<p><strong>What is UPnP device discovery, and how does it work?</strong><br/>
Device discovery is the process through which UPnP-capable computers become aware of the availability of devices they can use, and learn how to request services from them.
When a UPnP-capable computer boots, there may already be devices on the network that it can use. To determine whether this is the case, the computer sends a broadcast request (called an M-SEARCH directive), asking that any UPnP-capable device within earshot respond directly to it and provide information about using it.
Similarly, when a device that supports UPnP (for instance, a UPnP-capable printer) boots, there may already be UPnP-capable computers on the network that would like to use it. The device broadcasts a message (called a NOTIFY directive) to all computers within earshot, announcing its presence on the network and inviting computers to make use of its services.</p>
<p><strong>Suppose a UPnP-capable computer learns that a particular device is available. How does it learn how to use it?</strong><br/>
The computer checks to see whether any applications have registered an interest in the type of device that it's learned of. If one has, the computer consults the information sent by the device, which will contain an URL from which the device description - the list of services offered by the device and instructions on how to request them - can be downloaded. The computer then downloads the device description and can begin using the device.</p>
<p><strong>What are the vulnerabilities affecting the UPnP service?</strong><br/>
There are two vulnerabilities:</p>
<ul>
<li>The first vulnerability could enable an attacker to gain complete control over an affected system.</li>
<li>The second vulnerability could enable an attacker to either prevent an affected system from providing useful service or utilize multiple users' systems in a distributed denial of service attack against a single target.</li>
</ul>
<p><strong>What's the scope of the first vulnerability?</strong><br/>
This a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">buffer overrun</a> vulnerability. An attacker who successfully exploited this vulnerability could gain complete control over an affected system. Clearly, this is a serious vulnerability, and we strongly encourage customers to immediately apply the patch.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because one of the components of the Windows XP, Windows ME, Windows 98, and Windows 98SE UPnP implementations contains an unchecked buffer that could be overrun via a specially malformed UPnP NOTIFY directive.</p>
<p><strong>What's wrong with how the UPnP subsystem handles NOTIFY directives?</strong><br/>
One of the components in these implementations involved in processing NOTIFY directives contains an unchecked buffer. If the UPnP subsystem received a NOTIFY directive that's malformed in a particular way, the effect would be to overrun the buffer with data from the NOTIFY directive. If this data were carefully chosen, it would have the effect of altering the operation of the UPnP subsystem while it was running.</p>
<p><strong>What would this enable an attacker to do?</strong><br/>
An attacker who successfully exploited this vulnerability could change the UPnP subsystem to perform any desired task. Because the UPnP subsystem runs as part of the operating system, this would give the attacker complete control over the system.</p>
<p><strong>How might an attacker exploit the vulnerability?</strong><br/>
An attacker could exploit the vulnerability by crafting a NOTIFY directive with the needed malformation and sending it to other computers on the network.</p>
<p><strong>How would the attacker send the NOTIFY directive to the other computers?</strong><br/>
A NOTIFY directive can be sent either as a unicast message (i.e., one that's sent directly to a specific computer) or as a multicast or broadcast (i.e., one that's broadcast to a group of computers). The specific type chosen by the attacker would be important. The unicast form would enable the attacker greater reach, but at the cost of needing to know more information about the target. In contrast, the multicast form would enable the attacker to compromise multiple machines without knowing much about them, but at the cost of limiting the scope of the attack to computers on the same network segment as the attacker.</p>
<p><strong>How would an attack via a unicast NOTIFY message work?</strong><br/>
In the unicast scenario, the attacker would send a NOTIFY message directly to another computer, as though in reply to an M-SEARCH directive from the computer. The advantage of using a unicast message is that the attacker would be able to attack any machine he could deliver the NOTIFY message to. An attacker could potentially compromise machines over great distances by using unicast messages.
The disadvantage is that the attacker would need to know the IP address of the target. Most networks use Dynamic Host Configuration Protocol (DHCP) to manage their pool of IP addresses and, as a result, a particular machine's IP address may change fairly frequently. While it's certainly possible to learn a machine's IP address, it could require substantial work depending on the circumstances.</p>
<p><strong>How would an attack via a multicast or broadcast NOTIFY message work?</strong><br/>
In the multicast or broadcast scenarios, the attacker would send a NOTIFY message to a multicast or broadcast address, as though from a new UPnP-capable device. The advantage of using these messages is that the attacker wouldn't need to know the IP address of any other machine, and could potentially compromise a large number of machines with a single attack.
The disadvantage for the attacker is that most routers and firewalls do not forward multicast and broadcast messages. (To understand why, consider what would happen if they did forward them - every multicast or broadcast from any computer in the world would be delivered to every other computer in the world, and the Internet would quickly become swamped with data). As a result, attacks via multicast or broadcast would generally only be effective within the attacker's network segment, or subnet.</p>
<p><strong>Does this mean that the vulnerability isn't serious?</strong><br/>
On the contrary, it's very serious. There can be hundreds of computers on a subnet, and this vulnerability would enable an attacker to gain complete control over all of them with a single NOTIFY directive. We strongly urge customers to immediately apply the patch.</p>
<p><strong>Would a corporate firewall protect against attacks from the Internet?</strong><br/>
Yes. Most corporate firewalls block both multicast messages and unsolicited unicast messages. In addition, blocking ports 1900 and 5000 helps to protect against Internet based attacks.</p>
<p><strong>Would Internet Connection Firewall protect Windows XP machines against this vulnerability?</strong><br/>
Internet Connection Firewall (ICF) blocks unsolicited unicast messages, so it would protect a Windows XP system against an attack mounted using unicast. This wouldn't provide total protection - ICF doesn't block multicast or broadcast - but it would significantly reduce the risk to Windows XP users. As we discussed above, unicast messages can be sent over great distances, where multicast and broadcast typically cannot. This means that, for Windows XP users, the attacker would likely need to be located on the same network segment in order to exploit the vulnerability.</p>
<p><strong>Is ICF enabled by default in Windows XP?</strong><br/>
In general, ICF is automatically enabled anytime a wizard is used to create a networking connection to the Internet. For instance, ICF is turned on in all of the following scenarios:</p>
<ul>
<li>When a Windows XP system is used an Internet Connection Sharing host.</li>
<li>When a connection to the Internet is created via the New Connection Wizard.</li>
<li>When a connection to the Internet is identified in the Network Setup Wizard.</li>
<li>When an Internet connection is created or identified in the Welcome to Windows wizard.</li>
</ul>
<p>ICF is not enabled by default in cases like the following:</p>
<ul>
<li>If the user chooses to manually create a networking connection. In such a case, all networking options - including ICF - must be <a href="http://www.microsoft.com/windowsxp/using/networking/security/winfirewall.mspx" data-linktype="external">enabled</a> or disabled manually.</li>
<li>If the connection doesn't directly connect to the Internet - for instance, if it's a connection to a LAN. In such cases, there is generally already a firewall protecting the entire network.</li>
<li>If the system was upgraded from a previous version of Windows and already had an existing connection to the Internet. In this case, ICF can be <a href="http://www.microsoft.com/windowsxp/using/networking/security/winfirewall.mspx" data-linktype="external">enabled</a> manually.</li>
</ul>
<p>For more information on the operation of ICF and the conditions under which it's enabled by default, please refer to <a href="http://www.microsoft.com/technet/prodtechnol/winxppro/plan/default.mspx" data-linktype="external">&quot;Internet Connection Firewall Feature Overview&quot;</a>.</p>
<p><strong>I have a home network that uses Internet Connection Sharing to connect to the Internet. Could someone on the Internet attack the machines on the interior of my network?</strong><br/>
No. The Internet Connection Sharing gateway would not forward the NOTIFY messages, regardless of whether they're sent by unicast, multicast or broadcast. This means that an Internet-based attacker could not exploit the vulnerability against systems on the interior of the network. He could, though, exploit the vulnerability against the gateway system.</p>
<p><strong>How can I tell if I need the patch?</strong><br/>
For Windows XP, 98 and 98SE, it's fairly easy to tell whether you need the patch:</p>
<ul>
<li>If you're running Windows XP, you need the patch. All Windows XP systems are vulnerable in their default configurations.</li>
<li>If you're using Windows 98 or Windows 98SE, you only need the patch if you've installed the client software for Internet Connection Sharing.</li>
</ul>
<p>For Windows ME, it's a little more difficult. Windows ME does contain a UPnP subsystem, but by default it is not running. However, some hardware manufacturers do turn it on in their pre-configured systems. To determine whether the UPnP subsystem is running, follow these steps:</p>
<ol>
<li>Click Start, Settings, then select Control Panel.</li>
<li>Select Add/Remove Programs.</li>
<li>Select the tab titled Windows Set-up.</li>
<li>In the Components field, select Communications, then Details.</li>
<li>Scroll down and see whether the box to the left of Universal Plug and Play is checked. If it is, you need the patch; if it's not, you don't.</li>
</ol>
<p><strong>What does the patch do?</strong><br/>
The patch eliminates the vulnerability by instituting proper buffer handling in the Windows XP, Windows ME, Windows 98 and Windows 98SE UPnP implementations.</p>
<p><strong>If I can't install the patch, is there any other way to protect my system?</strong><br/>
Yes. You can protect your system by disabling the UPnP capability. However, before doing so, you should understand that this will effect how certain system functions operate. Most notably, disabling UPnP in Windows XP will affect the operation of Internet Connection Sharing (ICS) feature, which enables multiple Windows machines to share a single connection through a Windows XP system to the Internet. If the UPnP capability is disabled, ICS clients will be unable to automatically detect the Internet gateway, and you will need to configure the gateway information manually on every client system. Here's how to disable the UPnP capability:
<strong>Windows XP:</strong></p>
<ol>
<li>Log on using an account that has administrative privileges.</li>
<li>Click Start, then right-click on My Computer and select Manage.</li>
<li>In the left-hand pane, click the &quot;+&quot; next to Services and Applications, then click on Services.</li>
<li>In the right-hand pane, right-click on SSDP Discovery Service and select Properties.</li>
<li>In the pull-down list titled Startup Type, select Disabled.</li>
<li>In the Service Status section of the dialogue, click on Stop.</li>
<li>Click OK to exit the dialogue, then close the Computer Management window.</li>
</ol>
<p><strong>Windows ME:</strong></p>
<ol>
<li>Click Start, Settings, then select Control Panel.</li>
<li>Select Add/Remove Programs.</li>
<li>Select the tab titled Windows Set-up.</li>
<li>In the Components field, select Communications, then Details.</li>
<li>Uncheck the box for Universal Plug and Play.</li>
<li>Click OK to exit the dialogue, then close the Windows Set-up dialogue.</li>
<li>Reboot the machine.</li>
</ol>
<p><strong>Windows 98 or 98SE:</strong></p>
<ol>
<li>Click Start, Settings, then select Control Panel.</li>
<li>Select Add/Remove Programs.</li>
<li>Select the tab titled Windows Set-up.</li>
<li>In the Components field, select Communications, then Details.</li>
<li>Uncheck the box for Universal Plug and Play.</li>
<li>Click OK to exit the dialogue, then close the Windows Set-up dialogue.</li>
<li>Reboot the machine.</li>
</ol>
<p><strong>In the Windows XP instructions above, you said to disable the SSDP Discovery service, but I see a service called &quot;UPnP Device Host&quot;. Should I disable this service as well?</strong><br/>
No. Despite its name, the UPnP Device Host service is not related in any way to this vulnerability, and there is no need to disable it. The UPnP Device Host service enables other services on Windows XP to advertise themselves as though they were UPnP devices, and isn't involved in any way with how a system handles actual UPnP devices.</p>
<p><strong>If I install the patch on a Windows XP system, and then subsequently use that system to install the client software for Internet Connection Sharing on a Windows 98, 98SE or ME system, do I need to apply the patch to it?</strong><br/>
There are two ways to install the Internet Connection Sharing (ICS) client, and the answer depends on which method you choose.
One way is to create a Network Setup Wizard floppy disk on a Windows XP system, then use the floppy to install the ICS client on a so-called downlevel system (i.e., one running Windows 98, 98SE or ME). If you use this method, and the Windows XP system on which you create the floppy disk already has the patch, you don't need to patch the downlevel system -- the Network Setup Wizard will install a version of ICS that already has the fix. On the other hand, if you create the floppy on a Windows XP system doesn't have the patch, you'll need to patch the downlevel system after installing ICS. (Of course, you should also patch the Windows XP system).
The other way to install the ICS client on a downlevel system is by installing it directly from the Windows XP CD. If you use this method, you will need to install the patch on the downlevel system.</p>
<p><strong>I tried to install the patch on my Windows 98 system, but the patch displayed a message saying that it wasn't intended for my version of Windows. What happened? I've double-checked that I did install the Windows 98 version of the patch.</strong>
The patch for Windows 98 and 98SE will only install if the ICS client is present on the system, since that's the only means by which a UPnP capability can be added to on the system. The message you saw means that the ICS client isn't present on the system, and the patch is therefore not needed.</p>
<p><strong>What's the scope of the second vulnerability?</strong><br/>
The second vulnerability is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">denial of service attacks</a> vulnerability. It could be used in either of two ways - it could either be used in an attack that would involve only a single machine, and would slow or stop its performance, or it could be used in a distributed denial of service attack, in which the attacker would direct multiple machines to join forces against a different computer and swamp it with data.
This vulnerability could not be used to gain any administrative control over the system - its sole use would be to interfere with the legitimate user's efforts to use it.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because the UPnP implementations in Windows 98, Windows 98SE, Windows ME, and Windows XP don't apply enough constraints to the process they follow when downloading a device description for a UPnP-capable device.</p>
<p><strong>What's the process by which computers locate and download device descriptions?</strong><br/>
When a UPnP-capable computer receives a NOTIFY directive, it checks to see whether an application has registered an interest in the type of device that sent the NOTIFY. If one has, the computer consults the NOTIFY directive, which contains the machine address and port number from which the device description can be downloaded. The computer then contacts the specified machine and requests the device description from it.</p>
<p><strong>What's wrong with the way the UPnP subsystem handles device descriptions?</strong><br/>
There are two problems. First, the subsystem doesn't limit the size of the device descriptions it downloads, nor does it check to see whether the data that's purportedly a device description is actually valid. Second, the subsystem doesn't take proper steps to ensure that the machine it's been directed to is actually a download site for device descriptions.</p>
<p><strong>What would the first problem enable an attacker to do?</strong><br/>
The first problem could enable an attacker to send a user's system to a bogus download site solely for the purpose of slowing or stopping the user's system.</p>
<p><strong>How would an attacker carry out such an attack?</strong><br/>
There are many variations that could be used, but here's a fairly straightforward scenario that illustrates one possible attack. Suppose the attacker knew of a server that had the Chargen service running. <a href="http://www.ietf.org/rfc/rfc0864.txt?number=864" data-linktype="external">Chargen</a> is a standard TCP/IP service that simply generates a stream of data whenever a system connects to it, and it's not uncommon to find servers with Chargen running. Of course, if there weren't such a server handy, the attacker could set one up.
The attacker could send a NOTIFY directive to a user's system, advertising a new UPnP-capable device and directing the system to connect to the Chargen server. The user's system would send a download request to the server, which would generate random data in response to the request. The UPnP service would interpret this as being part of the device description, and allow the download to continue endlessly, consuming processing resources and disk space on the user's system.</p>
<p><strong>Would the attack cause the user's system to come to a complete halt?</strong><br/>
The effect of the attack would be highly dependent on the particulars of the scenario, including the relative processing power and availability of the two systems, the network bandwidth between them, and other factors. In the best case, the attack might only slow the system's performance; in the worst case, it might consume virtually all of the resources on the system, preventing any useful work from being done.</p>
<p><strong>How could the user resume normal service?</strong><br/>
The user could restore normal service by stopping and restarting the service that controls the handling of device descriptions, the SSDP Discovery Service</p>
<p><strong>What would the second problem enable the attacker to do?</strong><br/>
The second problem would enable an attack that is essentially the reverse of the attack described above. Instead of targeting a user's system for the purpose of slowing it down, the second problem could enable the attacker to cause multiple UPnP-capable systems to join forces in a distributed denial of service attack that would consume all the resources in a single, third-party system.</p>
<p><strong>How would this attack work?</strong><br/>
As in the case above, there are many ways to effect an attack, but one straightforward attack would involve sending NOTIFY commands to many UPnP-capable computers, directing them all to contact a third-party server for the device description. If enough machines were involved, the sheer volume of download requests could potentially slow the performance of the third party server, or potentially swamp it altogether.</p>
<p><strong>Would either attack enable the attacker to do anything more than deny service to someone?</strong><br/>
No. Neither of these attacks would enable the attacker to gain any form of administrative control over the machines, or to compromise data on them. Both could be used only for denial of service attacks.</p>
<p><strong>Could these attacks, like those in the first vulnerability, be initiated via unicast, multicast, and broadcast?</strong><br/>
Yes. As in the vulnerability discussed above, the attacks here could be initiated via unicast, multicast or broadcast NOTIFY directives. All of the same pros and cons would apply in this case: an attacker could use unicast messages to gain greater reach, but at the cost of needing to know the IP address of the target machine; or could use multicast or broadcast messages to attack multiple machines without needing to know their IP addresses, at the cost of limiting the attack to machines on the same network segment as the attacker.</p>
<p><strong>How does the patch prevent the first problem?</strong><br/>
The patch prevents the first problem by limiting the data that will be accepted as a device description. The patch establishes a maximum size of device descriptions; if a device description exceeds that size, the UPnP subsystem stops the download. It also causes the subsystem to check the data as it's arriving, and stop the download if the data isn't valid for a device description.</p>
<p><strong>How does the patch prevent the second problem?</strong><br/>
The patch eliminates the second problem by limiting where the UPnP subsystem will search for device descriptions. The patch causes it to check the location provided within a NOTIFY message for a device description, and to only proceed with the download if that location passes several tests.
The UPnP subsystem checks the download location before trying to download a device description. By default, a patched system will only download a device description that's located on a computer in the same subnet or private address range. The subsystem also checks to see how many router hops are required to reach the location, and only proceeds if this number is sufficiently small. By default, a patched system will only download a device description if the machine hosting it is located four or fewer hops away. Both of these settings are configurable, as discussed in Microsoft Knowledge Base article <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;q315056" data-linktype="external">Q315056</a>.
In addition, the patch introduces a delay mechanism to ease network usage. Patched systems will download device descriptions at different rates, depending on how far away the download location is. Download locations that are on public network such as the Internet are downloaded more slowly, in order to limit the demands placed on them. Likewise, each time a system encounters errors when downloading a device description, it increases the length of time it waits before retrying.</p>
<p><strong>If I can't install the patch, can I protect against this vulnerability by disabling UPnP support?</strong><br/>
Yes. Instructions for disabling UPnP support are provided above.</p>
<h2 id="patch-availability">Patch availability</h2>
<p><strong>Download locations for this patch</strong></p>
<ul>
<li><p>Microsoft Windows 98/98SE:<br/>
<a href="http://www.windowsupdate.com/" data-linktype="external">http://www.windowsupdate.com</a></p>
<p>Or</p>
<p><a href="https://www.microsoft.com/download/details.aspx?familyid=4f1c2546-9cf8-413d-866f-dd1e5a2d7454&amp;displaylang=en" data-linktype="external">https://www.microsoft.com/download/details.aspx?FamilyId=4F1C2546-9CF8-413D-866F-DD1E5A2D7454&amp;displaylang=en</a></p>
</li>
<li><p>Microsoft Windows ME:<br/>
<a href="http://www.windowsupdate.com/" data-linktype="external">http://www.windowsupdate.com</a></p>
<p>Or</p>
<p><a href="http://download.microsoft.com/download/winme/update/22940/winme/en-us/314757usam.exe" data-linktype="external">http://download.microsoft.com/download/winme/Update/22940/WinMe/EN-US/314757USAM.EXE</a></p>
</li>
<li><p>Microsoft Windows XP:<br/>
<a href="http://www.windowsupdate.com/" data-linktype="external">http://www.windowsupdate.com</a></p>
<p>Or</p>
<p><a href="https://www.microsoft.com/download/details.aspx?familyid=d17cbeb5-7478-4147-b4ba-e6cf686a352b&amp;displaylang=en" data-linktype="external">https://www.microsoft.com/download/details.aspx?FamilyId=D17CBEB5-7478-4147-B4BA-E6CF686A352B&amp;displaylang=en</a></p>
</li>
</ul>
<h4 id="additional-information-about-this-patch">Additional information about this patch</h4>
<p><strong>Installation platforms:</strong></p>
<ul>
<li>The patch for Windows 98 and 98SE can be installed on any Windows 98 or 98SE system on which the Windows XP Internet Connection Sharing client has been installed.</li>
<li>The patch for Windows ME can be installed on systems running Windows ME Gold.</li>
<li>The patch for Windows XP can be installed on systems running Windows XP Gold.</li>
</ul>
<p><strong>Inclusion in future service packs:</strong></p>
<ul>
<li>No future service packs are planned for Windows 98, 98SE or ME.</li>
<li>The fix for this issue will be included in Windows XP Service Pack 1.</li>
</ul>
<p><strong>Reboot needed:</strong> Yes</p>
<p><strong>Superseded patches:</strong> <a href="http://technet.microsoft.com/security/bulletin/ms01-054" data-linktype="external">MS01-054</a></p>
<p><strong>Verifying patch installation:</strong></p>
<p>Windows 98 and 98SE:</p>
<ul>
<li>To verify that the patch has been installed on the machine, select Start, then Run, then run the QFECheck utility. If the patch is installed, &quot;Windows 98 Q314941 Update&quot; will be listed among the installed patches.</li>
<li>To verify the individual files, use the file manifest provided in Knowledge Base article Q314941.</li>
</ul>
<p>Windows ME:</p>
<ul>
<li>To verify that the patch has been installed on the machine, select Start, then Run, then run the QFECheck utility. If the patch is installed, &quot;Windows Millennium Edition Q314757 Update&quot; will be listed among the installed patches.</li>
<li>To verify the individual files, use the file manifest provided in Knowledge Base article Q314757.</li>
</ul>
<p>Windows XP:</p>
<ul>
<li>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:<br/>
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q315000.</li>
<li>To verify the individual files, use the date/time and version information provided in the following registry key:<br/>
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q315000\Filelist.</li>
</ul>
<p><strong>Caveats:</strong></p>
<p>None</p>
<p><strong>Localization:</strong></p>
<p>Localized versions of this patch are under development. When completed, they will be available at the locations discussed in &quot;Obtaining other security patches&quot;.</p>
<p><strong>Obtaining other security patches:</strong></p>
<p>Patches for other security issues are available from the following locations:</p>
<ul>
<li>Security patches are available from the <a href="http://go.microsoft.com/fwlink/?linkid=21129" data-linktype="external">Microsoft Download Center</a>, and can be most easily found by doing a keyword search for &quot;security_patch&quot;.</li>
<li>Patches for consumer platforms are available from the <a href="http://windowsupdate.microsoft.com/" data-linktype="external">WindowsUpdate</a> web site.</li>
</ul>
<h4 id="other-information">Other information:</h4>
<p><strong>Acknowledgments</strong></p>
<p>Microsoft <a href="http://technet.microsoft.com/security/bulletin/policy" data-linktype="external">thanks</a> eEye Digital Security (<a href="http://www.eeye.com/" data-linktype="external">http://www.eeye.com</a>) for reporting this issue to us and working with us to protect customers.</p>
<p><strong>Support:</strong></p>
<ul>
<li>Microsoft Knowledge Base articles Q314757, Q314941, Q315000 and Q315056 discuss this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the <a href="http://support.microsoft.com/?scid=fh;en-us;kbhowto" data-linktype="external">Microsoft Online Support</a> web site.</li>
<li>Technical support is available from <a href="http://support.microsoft.com/directory/question.asp?sd=gn&amp;fr=0" data-linktype="external">Microsoft Product Support Services</a>. There is no charge for support calls associated with security patches.</li>
</ul>
<p><strong>Security Resources:</strong> The <a href="http://www.microsoft.com/technet/security/default.mspx" data-linktype="external">Microsoft TechNet Security</a> Web Site provides additional information about security in Microsoft products.</p>
<p><strong>Disclaimer:</strong></p>
<p>The information provided in the Microsoft Knowledge Base is provided &quot;as is&quot; without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.</p>
<p><strong>Revisions:</strong></p>
<ul>
<li>V1.0 (December 20, 2001): Bulletin Created.</li>
<li>V1.1 (December 26, 2001): Additional detail added regarding how the patch eliminates the denial of service scenarios.</li>
<li>V1.2 (December 31, 2001): Bulletin updated to provide additional mitigating factors (ICF is effective against unicast attacks, and ICS protects machines on the interior of home networks), and to provide information on disabling UPnP support.</li>
<li>V1.3 (May 09, 2003): Updated download links to Windows Update.</li>
</ul>
<p><em>Built at 2014-04-18T13:49:36Z-07:00</em></p>

							<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none font-size-h4 margin-bottom-xs">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->



						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>

						<div
							class="font-size-sm right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Page Actions">

							<div id="affixed-right-container" class="doc-outline is-vertically-scrollable">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
