<!doctype html>
<html lang="en-US" style="margin:0px !important">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
  
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110011290-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110011290-1');
</script>
  
<!-- Global site tag (gtag.js) - Google Ads: 749377018 --> 
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-749377018"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'AW-749377018'); </script>  
	
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

	
<!-- Bootstrap Latest compiled and minified CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  
  	<title>Mother of All Drivers - New Vulnerabilities Found in Windows Drivers - Eclypsium </title>
<link rel="alternate" hreflang="en" href="/2019/11/12/mother-of-all-drivers/">
<meta name="description" content="Research from Eclypsium reveals how Windows kernel security mode enables attacks and identifies vulnerable drivers that can provide an attacker with near-limitless control over a victim device. ">
<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<link rel="canonical" href="/2019/11/12/mother-of-all-drivers/">
<meta name="author" content="Eclypsium">
<meta property="og:url" content="/2019/11/12/mother-of-all-drivers/">
<meta property="og:site_name" content="Eclypsium">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Mother of All Drivers - New Vulnerabilities Found in Windows Drivers - Eclypsium ">
<meta property="og:description" content="Research from Eclypsium reveals how Windows kernel security mode enables attacks and identifies vulnerable drivers that can provide an attacker with near-limitless control over a victim device. ">
<meta property="og:image" content="/wp-content/uploads/2019/11/feature-image-drivers-2.jpg">
<meta property="og:image:secure_url" content="/wp-content/uploads/2019/11/feature-image-drivers-2.jpg">
<meta property="og:image:width" content="1520">
<meta property="og:image:height" content="1000">
<meta property="og:image:alt" content="Screwed Drivers 2 Featured Image">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Mother of All Drivers - New Vulnerabilities Found in Windows Drivers - Eclypsium ">
<meta name="twitter:description" content="Research from Eclypsium reveals how Windows kernel security mode enables attacks and identifies vulnerable drivers that can provide an attacker with near-limitless control over a victim device. ">
<meta name="twitter:image:src" content="/wp-content/uploads/2019/11/feature-image-drivers-2-1024x674.jpg">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Mother of All Drivers &#8211; New Vulnerabilities Found in Windows Drivers Comments Feed" href="/2019/11/12/mother-of-all-drivers/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=5.8.1" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-horizontal-list-0-css" href="/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.min.css?ver=1" type="text/css" media="all">
<link rel="stylesheet" id="eclypsium-style-css" href="/wp-content/themes/eclypsium-10-28-21a/style.css?ver=5.8.1" type="text/css" media="all">
<script type="text/javascript" id="wpml-browser-redirect-js-extra">
/* <![CDATA[ */
var wpml_browser_redirect_params = {"pageLanguage":"en","languageUrls":{"en_us":"\/2019\/11\/12\/mother-of-all-drivers\/","en":"\/2019\/11\/12\/mother-of-all-drivers\/","us":"\/2019\/11\/12\/mother-of-all-drivers\/"},"cookie":{"name":"_icl_visitor_lang_js","domain":"wp.eclypsium.io","path":"\/","expiration":24}};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/sitepress-multilingual-cms/dist/js/browser-redirect/app.js?ver=4.4.12" id="wpml-browser-redirect-js"></script>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/3757"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.1">
<link rel="shortlink" href="/?p=3757">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2019%2F11%2F12%2Fmother-of-all-drivers%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2019%2F11%2F12%2Fmother-of-all-drivers%2F&#038;format=xml">
<meta name="generator" content="WPML ver:4.4.12 stt:1,28;">
<link rel="pingback" href="/xmlrpc.php"><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><link rel="preload" as="style" href="/wp-content/plugins/code-prettify/prettify/prettify.css"><link rel="icon" href="/wp-content/uploads/2018/12/e-150x150.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2018/12/e-300x300.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/12/e-300x300.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/12/e-300x300.png">
  
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>	
	
	

	
	
<script src="/wp-content/themes/eclypsium-10-28-21a/js/eclypsium-main.js"></script>

	
<!-- Google Roboto Font -->
<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400;700;900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:100,300,400,700,900&amp;display=swap" rel="stylesheet">
	
	

</head>

<body class="post-template-default single single-post postid-3757 single-format-standard">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">
		<div class="site-branding">

		
		
		</div><!-- .site-branding -->

		<nav id="site-navigation" class="main-navigation">
		</nav><!-- #site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">


<div id="single-post">
<div class="nav-padding"></div>

	


<div id="main-nav" class="container-fluid no-pm d-none d-md-block">
	<div class="container">
		<div class="row no-pm justify-content-center">
			<div id="menu-top" class="col-lg-10 no-pm">
				
				<div id="nav-logo-container">
					<a href="/"><img id="nav-logo" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-ps.svg"></a>
				</div>
				<div id="nav-links-container">
					<div id="nav-links-top">
						<a class="nav-link-small" href="/blog/">BLOG</a>
						<a class="nav-link-small" href="/contact/">CONTACT US</a>						
					</div>
					<div id="nav-links-bottom-container">
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/enterprise-firmware-security/">PRODUCT</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/enterprise-firmware-security/endpoints/">ENDPOINTS</a>
                <a class="nav-link-sub" href="/enterprise-firmware-security/servers/">SERVERS<br></a>
								<a class="nav-link-sub" href="/enterprise-firmware-security/network/">NETWORK <br>DEVICES</a>
								<a class="nav-link-sub" href="/enterprise-firmware-security/platform/">PLATFORM &amp; <br>INTEGRATIONS</a>								
							</div>
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/solutions/">SOLUTIONS</a>
							<div class="nav-sub-pages">
                
                
								<a class="nav-link-sub" href="/solutions/identify/">IDENTIFY</a>
								<a class="nav-link-sub" href="/solutions/verify/">VERIFY</a>
								<a class="nav-link-sub" href="/solutions/fortify/">FORTIFY</a>
								<a class="nav-link-sub" href="/solutions/zero-trust/">ZERO TRUST</a>  
								<a class="nav-link-sub" href="/solutions/supply-chain-risk-management/">SUPPLY CHAIN</a>
                
								<a class="nav-link-sub" href="/risk-assessment/">DEVICE HEALTH</a>								
								<a class="nav-link-sub" href="/remote-work/">REMOTE WORK</a>
								<a class="nav-link-sub" href="/travel/">HIGH-RISK <br>TRAVEL</a>

							</div>
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/resources/">RESOURCES</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/know-your-own-device/">KNOW YOUR <br>OWN DEVICE</a>	                
								<a class="nav-link-sub" href="/firmware-threat-report/">THREAT REPORT</a> 
								<a class="nav-link-sub" href="/resources/#solutionbriefs">SOLUTION BRIEFS</a>								
								<a class="nav-link-sub" href="/resources/#productbriefs">PRODUCT BRIEFS</a>								
								<a class="nav-link-sub" href="/resources/#whitepapers">WHITE PAPERS</a>	
								<a class="nav-link-sub" href="/resources/#videos">VIDEOS</a>
								<a class="nav-link-sub" href="/resources/#bestpractices">BEST PRACTICES</a>
							</div>
							
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/company/">COMPANY</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/events/">EVENTS</a>
								<a class="nav-link-sub" href="/news/">NEWS ROOM</a>
								<a class="nav-link-sub" href="/news#pressreleases">PRESS RELEASES</a>
								<a class="nav-link-sub" href="/careers/">CAREERS</a>
								<a class="nav-link-sub" href="/company#contact">CONTACT US</a>
								
							</div>
						</div>
					</div>
				</div>
        
        <div class="nav-request-btn-container">
						<a class="nav-request-btn" href="/demo/">REQUEST A DEMO</a>						
        </div>
				<!--
				<div class="nav-search-container">
					<img id="search-icon" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-search.svg">
					<input id="search-input" class=""  placeholder="Search ..." />
				</div>
				-->
				
			</div>
		</div>
	</div>	
</div>


<div id="mobile-nav" class="container-fluid no-pm">
	<div class="container">
		<div class="row no-pm">
			<div class="col-3 no-pm">

				<div id="mobile-nav-logo-container">
					<a href="/"><img id="nav-logo-mobile" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-ps.svg"></a>
				</div>
			
			
			</div>
      
      <div class="col-6 no-pm wrapper-center">
					<a class="nav-request-btn" href="/demo/">REQUEST A DEMO</a>						
	    </div>	
        
      <div class="col-3 no-pm ">

				<div class="mobile-nav-dot-container ">
					<div class="mobile-dots" tabIndex="1"></div>				
				</div>
			</div>

		</div>
		
		<div class="mobile-nav-bottom">
			<div class="row no-pm">
				<div class="col-12">
					<a class="nav-link-small" href="/blog/">BLOG</a>
					<a class="nav-link-small" href="/contact/">CONTACT US</a>                    
        </div>
			</div>	


			<div class="row no-pm divider-20 nav-link-big-container">
				<div class="col-6 col-md-3">
					<a class="nav-link-big-mobile" href="/enterprise-firmware-security/">PRODUCT</a>
					<div class="nav-sub-pages">
          
						<a class="nav-link-sub" href="/enterprise-firmware-security/endpoints/">ENDPOINTS</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/servers/">SERVERS</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/network/">NETWORK <br>DEVICES</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/platform/">PLATFORM &amp; <br>INTEGRATIONS</a>
          
          </div>
					<br><br>
					<a class="nav-link-big-mobile" href="/solutions/">SOLUTIONS</a>
					<div class="nav-sub-pages">
            
								<a class="nav-link-sub" href="/solutions/identify/">IDENTIFY</a>
								<a class="nav-link-sub" href="/solutions/verify/">VERIFY</a>
								<a class="nav-link-sub" href="/solutions/fortify/">FORTIFY</a>
								<a class="nav-link-sub" href="/solutions/zero-trust/">ZERO TRUST</a>  
								<a class="nav-link-sub" href="/solutions/supply-chain-risk-management/">SUPPLY CHAIN</a>
                
								<a class="nav-link-sub" href="/risk-assessment/">DEVICE HEALTH</a>								
								<a class="nav-link-sub" href="/remote-work/">REMOTE WORK</a>
								<a class="nav-link-sub" href="/travel/">HIGH-RISK <br>TRAVEL</a>
            
					</div>
					<br>


				</div>
				<div class="col-6 col-md-3 inline">
					<a class="nav-link-big-mobile" href="/company/">COMPANY</a>
					
					<div class="nav-sub-pages">
						<a class="nav-link-sub" href="/events/">EVENTS</a>						
						<a class="nav-link-sub" href="/news/">NEWS ROOM</a>
						<a class="nav-link-sub" href="/news#pressreleases">PRESS RELEASES</a>
						<a class="nav-link-sub" href="/careers/">CAREERS</a>
						<a class="nav-link-sub" href="/company/#contact">CONTACT US</a>
					</div>
					<br>
					<a class="nav-link-big-mobile" href="/resources/">RESOURCES</a>
					<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/know-your-own-device/">KNOW YOUR <br>OWN DEVICE</a>
            
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/firmware-threat-report/">THREAT REPORT</a>            							
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#solutionbriefs">SOLUTION BRIEFS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#productbriefs">PRODUCT BRIEFS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#whitepapers">WHITE PAPERS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#videos">VIDEOS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#bestpractices">BEST PRACTICES</a>						
						
					</div>
          
          <div class="divider-40"></div>
          

				</div>			
			</div>	
		</div>
	</div>
</div>	







	

<div class="container-fluid  no-pm">
	<div class="row no-pm">
		<div class="col-lg-12">

			<div class="container">
				<div class="row">
					<div class="col-lg-12 wrapper-center">




					</div>
				</div>
			</div>	
			
			
		</div>
	</div>
	

	</div>

			
		
	
	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		


  



<article id="post-3757" class="post-3757 post type-post status-publish format-standard has-post-thumbnail hentry category-research">
	<header class="entry-header bkgd-ltgrey">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 wrapper-center">

					<h1 class="entry-title">Mother of All Drivers &#8211; New Vulnerabilities Found in Windows Drivers</h1>						<div class="entry-meta">
							<span class="posted-on"><time class="entry-date published navy" datetime="2019-11-12T10:00:54-05:00">November 12, 2019</time><time class="updated" datetime="2019-11-14T21:37:29-05:00">November 14, 2019</time></span>&nbsp&nbsp&nbsp/&nbsp&nbsp&nbsp<span class="byline"> <span class="author vcard navy">Eclypsium</span></span>						</div><!-- .entry-meta -->
										</div>
				</div>
			</div>	

	</header><!-- .entry-header -->

	
	<div class="container-fluid no-pm bkgd-ltgrey wrapper-thumbnail"><div class="row no-pm"><div class="col-lg-12 no-pm"><div class="container"><div class="row"><div class="col-lg-12 wrapper-center no-pm">
			<div class="post-thumbnail">
				<img width="1520" height="1000" src="/wp-content/uploads/2019/11/feature-image-drivers-2.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Screwed Drivers 2 Featured Image" loading="lazy" srcset="/wp-content/uploads/2019/11/feature-image-drivers-2.jpg 1520w, /wp-content/uploads/2019/11/feature-image-drivers-2-300x197.jpg 300w, /wp-content/uploads/2019/11/feature-image-drivers-2-768x505.jpg 768w, /wp-content/uploads/2019/11/feature-image-drivers-2-1024x674.jpg 1024w" sizes="(max-width: 1520px) 100vw, 1520px">			</div><!-- .post-thumbnail -->

		<img class="img-fluid" src="/wp-content/themes/eclypsium-10-28-21a/img/feature-image-shadow.png">  
                  <div class="bkgd-navy blog-email-sub-container">    
                    <div class="blog-email-wrapper cta">
                      <span class="white bold">Subscribe to Eclypsium’s Threat Report</span> 
                    </div>

                    <div class="blog-email-wrapper subbtn">
                        <!--[if lte IE 8]>
                      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
                      <![endif]-->
                      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
                      <script>
                        hbspt.forms.create({
                        portalId: "5610435",
                        formId: "8c6fcf7e-8993-484e-aebd-eedf458d6c21"
                      });
                      </script>
                    </div>
                  </div>
  
                </div></div></div></div></div></div>	
	
	
	<div class="entry-content">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
		
		
<p><a class="bold" href="/wp-content/uploads/2019/11/Mother-of-All-Drivers.pdf">Download the PDF &gt;</a></p>



<p>Watch Eclypsium researchers Jesse Michael and Mickey Shkatov describe  this research in detail in this <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.brighttalk.com/webcast/17865/372680?utm_source=Eclypsium&amp;utm_medium=brighttalk&amp;utm_campaign=372680" target="_blank">recorded webinar</a>.</p>



<h2>Windows Kernel Security Mode Enables Attacks</h2>



<div style="height:23px" aria-hidden="true" class="wp-block-spacer"></div>



<p>As part of our <a href="/2019/08/10/screwed-drivers-signed-sealed-delivered/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">previous research</a>, released in August 2019, Eclypsium researchers detailed how simple design flaws in widely distributed drivers can be abused by attackers to gain control over Windows-based systems including the underlying system and component firmware of the device. We originally named 17 vendors affected by these vulnerable drivers. Now, as part of our ongoing analysis, we have discovered additional vulnerable drivers that are some of the most feature-rich we have seen to date, and which directly affect Intel-based devices. In this update, we detail the latest findings on these drivers and share ongoing industry response to our previous disclosures.<br></p>



<h2>A Quick Recap of Screwed Drivers Vulnerabilities</h2>



<p>At the heart of the issue are drivers that allow users to modify the Windows kernel or device firmware. Abuse of such capability can enable an attacker to gain incredible privileges over a machine while also avoiding traditional security controls. More specifically, an attacker or malware in user space of a device (ring 3) can use a vulnerable driver to read and write data to kernel space (ring 0) and even lower-level firmware components which can sometimes be referred to as negative rings. This low-level control provides an ideal position to steal data, damage the system, and persist on the system outside the view of security controls running at the operating system level. </p>



<p>Notably, these drivers are valid tools released by vendors to help manage or update devices, and as such were properly signed and would be trusted on almost any machine. Worse still, there is no universal mechanism to prevent a Microsoft OS from loading one of these bad drivers.&nbsp;</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="210" src="/wp-content/uploads/2019/11/drivers-interlude-2-1024x210.png" alt class="wp-image-3920" srcset="/wp-content/uploads/2019/11/drivers-interlude-2-1024x210.png 1024w, /wp-content/uploads/2019/11/drivers-interlude-2-300x61.png 300w, /wp-content/uploads/2019/11/drivers-interlude-2-768x157.png 768w, /wp-content/uploads/2019/11/drivers-interlude-2.png 1520w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h2>Intel PMx Driver</h2>



<p>In our previous research, we identified a variety of drivers, each with their own capabilities and potential impacts to a system. Although many of the vulnerable drivers were disclosed at the time of our previous publication, two drivers from Intel were held under embargo until the fix and security advisory was available. These are now public at <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00281.html" target="_blank">Intel Processor Identification Utility for Windows Advisory</a> and <a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00283.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Intel Computing Improvement Program Advisory</a> as of August 13th. Another driver that was held under embargo due to the complexity of the issue was the Intel PMx Driver (also named PMxDrv). During our analysis of the Intel PMx driver, we found it to be incredibly capable, containing a superset of all the capabilities that we had seen previously. For example, the driver has the ability to:</p>



<ul><li>Read/Write to physical memory</li><li>Read/Write to Model Specific Registers (MSR)</li><li>Read/Write to control registers</li><li>Read/Write to the interrupt descriptor table (IDT) and the global descriptor table (GDT)</li><li>Read/write to debug registers</li><li>Arbitrarily gain I/O access</li><li>Arbitrarily gain PCI access</li></ul>



<p>This level of access can provide an attacker with near-omnipotent control over a victim device. Just as importantly, this capability has been included as a staple component of many Intel ME and BIOS related toolsets going back to 1999. Ironically, the very <a href="https://downloadcenter.intel.com/download/27826/Intel-SA-00125-Detection-Tool" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">tool</a> released by Intel to detect and mitigate a recent AMT vulnerability included the vulnerable driver as part of the toolset used to solve the AMT issue. Intel likewise uses the vulnerable driver as part of the Flash Programming Tool, which is provided to OEM vendors and their customers to update Intel-based BIOS. This makes the Intel PMx/PMxDrv one of the most capable, feature-rich, and most common drivers we have seen to date.&nbsp;</p>



<p>Eclypsium researchers have been working closely with the Intel PSIRT team on the issue, and would like to thank them for their prompt and positive response. As of November 12th, Intel has released updated versions of pmxdrvx64.sys and pmxdrv.sys to mitigate this vulnerability.</p>



<h2>Administrator to Kernel or Hardware</h2>



<p>The vast majority of drivers we examined in our research could be exploited by an unprivileged user to attack the running kernel or modify device firmware via unfiltered IO, PCI, or MMIO access, however a few drivers had additional restrictions and only allowed use by a process running with Administrator privileges.</p>



<p>Microsoft’s <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/driversecurity/windows-security-model" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Windows security model for driver developers</a> discusses various security boundaries in how drivers operate within the Windows operating system and characterizes the path between an admin process and a kernel driver as a “noteworthy trust boundary”:</p>



<figure class="wp-block-image"><img loading="lazy" width="712" height="378" src="/wp-content/uploads/2019/11/driver-security-attack-surface.png" alt class="wp-image-3805" srcset="/wp-content/uploads/2019/11/driver-security-attack-surface.png 712w, /wp-content/uploads/2019/11/driver-security-attack-surface-300x159.png 300w" sizes="(max-width: 712px) 100vw, 712px"></figure>



<p><em>“Path (2) is a lower risk path, as the app is running with admin rights and is calling directly into the kernel driver. Admin is already a fairly high privilege on the system so the attack surface from admin to kernel is less of an interesting target to attackers, but still a noteworthy trust boundary.”</em></p>



<p style="font-size:75%">Source:  <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/driversecurity/windows-security-model " target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/windows-hardware/drivers/driversecurity/windows-security-model</a></p>



<p>However, Microsoft’s <a href="https://www.microsoft.com/en-us/msrc/windows-security-servicing-criteria" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Security Servicing Criteria for Windows</a> currently treats processes running in userspace with Administrator privileges effectively the same as the Windows kernel and there’s no security boundary there. Superficially, that makes sense because the Administrator is intended to have administrative control over the system which necessarily includes security configuration of the device. However, under deeper analysis, some significant flaws in that justification become apparent.&nbsp;</p>



<p>Although the Administrator has control of the device, there are many security-sensitive operations that are additionally restricted even from the Administrator. Once Secure Boot is enabled,&nbsp; a reboot and a process intended to verify physical presence should be required to disable it. Likewise, the Administrator cannot load unsigned kernel modules without rebooting and performing physically-present operations during the boot process. There are many security controls which cannot be disabled at runtime without a reboot.</p>



<p>Allowing a compromised Administrator process to read and write kernel memory and otherwise launch attacks against the kernel renders these controls ineffective and leaves a gaping security hole. Alex Ionescu <a href="https://twitter.com/aionescu/status/1178353010109321216" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">characterized</a> the situation as <em>“Windows 10: Kernel arbitrary writes from Admin are not bugs, there’s a party in ring0 and the bouncer is off duty”</em>.</p>



<p>In contrast, Apple’s <a href="https://support.apple.com/en-us/HT204899" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">System Integrity Protection</a> is specifically intended to protect critical parts of the Mac operating system against malicious software even running as root with full administrator privileges. System Integrity Protection can be disabled by the Administrator if necessary, but it cannot be done at runtime and they must turn the system off and boot into the Recovery OS to disable this protection.</p>



<p>Likewise, within the Linux ecosystem, the <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.zdnet.com/article/linux-to-get-kernel-lockdown-feature/" target="_blank">Kernel Lockdown</a> feature also prevents the root user from performing operations which can compromise the integrity of the kernel. This is an important security control and the majority of Linux distributions have been shipping versions of this protection mechanism for years and the patch has now been <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=aefcf2f4b58155d27340ba5f9ddbe9513da8286d" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">accepted into the mainline Linux kernel</a>.</p>



<p>In addition, the <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://kernsec.org/wiki/index.php/Kernel_Self_Protection_Project" target="_blank">Linux Self Protection Project</a> has been working to strengthen the protections for this important security boundary. Kees Cook, one of the founders of LSPP, <a href="https://www.linuxjournal.com/content/good-lockdown-vs-bad" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">described</a> their goals as <em>“It&#8217;s about creating a bright line between uid-0 and ring-0. The most powerful of these distinctions was made long ago with signed modules. It hasn&#8217;t been enough, though, since there have been many ways for uid-0 to read or write kernel memory. My expectation for this was to reasonably fill all the remaining gaps.”</em></p>



<p>It&#8217;s certainly a very hard task to defend this security boundary, but attackers are exploiting this in real-world malware campaigns such as <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.eset.com/us/business/resources/white-papers/lojax/" target="_blank">Lojax </a>and <a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/09133534/The-Slingshot-APT_report_ENG_final.pdf" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Slingshot</a>. Ignoring the problem doesn’t make it go away.</p>



<h3>Updates on WinRing0</h3>



<p>As part of our previous research, we posted a list of vulnerable drivers, available <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://github.com/eclypsium/Screwed-Drivers/" target="_blank">here</a>. One of the most significant was a driver often referred to as “<strong>WinRing0”</strong>. Recently, researchers at SafeBreach provided a thorough proof-of-concept analysis of an <a href="https://safebreach.com/Post/HP-Touchpoint-Analytics-DLL-Search-Order-Hijacking-Potential-Abuses-CVE-2019-6333" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">attack against HP Touchpoint Analytics</a>, which utilizes the WinRing0 driver which was included as part of the OEM-installed software. SafeBreach demonstrated how the driver could be used to read arbitrary kernel memory and discussed how it could be misused in a variety of additional ways including bypassing application whitelisting, signature validation, and driver signature enforcement.</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="534" src="/wp-content/uploads/2019/11/rings-2-1024x534.png" alt class="wp-image-3911" srcset="/wp-content/uploads/2019/11/rings-2-1024x534.png 1024w, /wp-content/uploads/2019/11/rings-2-300x157.png 300w, /wp-content/uploads/2019/11/rings-2-768x401.png 768w, /wp-content/uploads/2019/11/rings-2.png 1520w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>WinRing0 is also notable in that it is part of the OpenHardwareMonitor library and is readily accessible to anyone. As such, it can easily be used and signed by multiple vendors, and can potentially be found under a variety of names and hashes. For example, a check of VirusTotal reveals that the original WinRing0 driver analyzed as part of our research has been identified under a variety of names including:</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="583" src="/wp-content/uploads/2019/11/driver-list-1024x583.png" alt class="wp-image-3907" srcset="/wp-content/uploads/2019/11/driver-list-1024x583.png 1024w, /wp-content/uploads/2019/11/driver-list-300x171.png 300w, /wp-content/uploads/2019/11/driver-list-768x437.png 768w, /wp-content/uploads/2019/11/driver-list.png 1520w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Currently, our research into vulnerable drivers is ongoing and we are actively working with additional vendors as part of our responsible disclosure process. Users and organizations should consider enabling Hypervisor-protected Code Integrity (HVCI) for devices that support the feature. A list of requirements and instructions for enabling HVCI is available <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-guard/enable-virtualization-based-protection-of-code-integrity" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">here</a>. We will continue to analyze this important area and provide updates in coordination with affected vendors.&nbsp;</p>



<h3>Short-Term and Long-Term Fixes</h3>



<p>One of the key issues noted above is that there is no universally applicable way to prevent Windows from loading any of the bad drivers that have been identified thus far. Going forward, Microsoft is addressing the issue through their HVCI technology. This will allow Microsoft to act as their own virtual firewall to protect the operating system kernel.&nbsp;</p>



<p>However this approach will not be available universally for some time. HVCI requires a 7th generation or newer processor, new processor features such as mode-based execution control, and is not supported by many 3rd party drivers. As a result, many devices in use today will not be able to enable HVCI and will not be protected.</p>



<p>The only universally available option possible today is to block or blacklist old, known-bad drivers. To this end, we would like to specifically commend the response of Insyde Software, a UEFI firmware vendor. Of the 19 vendors we notified early this summer, Insyde is the only vendor to date to proactively contact Microsoft and ask that the old version of the driver be blocked. Due to this request, Windows Defender will proactively <a href="https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=Program%3aWin32%2fVulnInsydeDriver.A&amp;threatid=258247" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">quarantine the vulnerable version of the driver</a> so it can’t cause damage to the system.</p>
				</div>
			</div>
		</div>	
					
	</div><!-- .entry-content -->
	

	<footer class="entry-footer section">
		
		
		<div class="container-fluid no-pm  wrapper-thumbnail"><div class="row no-pm"><div class="col-lg-12 no-pm"><div class="container"><div class="row"><div class="col-lg-12 wrapper-center "><span class="cat-links">Posted in <a href="/category/research/" rel="category tag">Research</a></span></div></div></div></div></div></div>
		
		
		
		
	</footer><!-- .entry-footer -->
</article><!-- #post-3757 -->
<div class="container-fluid no-pm bkgd-ltgrey post-nav"><div class="row no-pm"><div style="text-align:right" class="col-5">&laquo;&nbsp;<a href="/2019/10/23/protecting-system-firmware-storage/" rel="prev">Protecting System Firmware Storage</a></div><div class="col-2 wrapper-center">|</div><div class="col-5"><a href="/2020/01/30/direct-memory-access-attacks/" rel="next">Direct Memory Access Attacks &#8211; A Walk Down Memory Lane</a>&nbsp;&raquo;</div></div></div>
			
			

			
			
		</main><!-- #main -->
	</div><!-- #primary -->
</div>

	</div><!-- #content -->

	<footer id="colophon" class="site-footer">
		<div class="site-info">

			<div class="footer container-fluid">
				
				
				<div class="row no-pm">
					<div class="col-lg-12 wrapper-center">
							<div id="backtotop" class="navy"><img width="16" height="10" class="footer-arrow" src="/wp-content/themes/eclypsium-10-28-21a/img/arrow-up-blue.svg"><br>
						<b>Back to Top</b></div>
					</div>
				</div>	
				
				
				<div class="row no-pm divider-30">
					<div class="col-lg-12">
						<a class="orange bold" href="https://info.eclypsium.com/subscribe">Subscribe to Below the Surface</a><br><span style="color:#c4c4c4">A firmware and hardware threat report from our research team.</span>
						
					</div>
				</div>	
				
				<div class="row no-pm divider-40">
					<div class="col-lg-12">

						<a href="https://www.linkedin.com/company/eclypsium" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-li.svg"><img< a>
						<a href="https://twitter.com/eclypsium" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-tw.svg"><img< a>
						<a href="https://www.facebook.com/Eclypsium/" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-fb.svg"><img< a>

							
						
					</img<></a></img<></a></img<></a></div>
				</div>	
				
			<div class="row no-pm divider-10">
					<div class="col-lg-12">
					<a class href="/privacy/">Privacy Policy</a><br><br>					
				</div>
				</div>	
							
				<div class="row no-pm">
					<div class="col-lg-12">
						<div id="copyright">&copy;<script type="text/javascript">document.write(new Date().getFullYear())</script> Eclypsium, Inc.</div>
					</div>
				</div>	
				<div class="row no-pm">
					<div class="col-lg-12">
							<a href="/"><img class="footer-logo" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-grey.svg"></a>
					</div>
				</div>	
				

			</div>
		
		
		</div><!-- .site-info -->
	</footer><!-- #colophon -->


</div><!-- #page -->

<script type="text/javascript" id="code-prettify-js-extra">
/* <![CDATA[ */
var codePrettifyLoaderBaseUrl = "\/wp-content\/plugins\/code-prettify\/prettify";
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/code-prettify/prettify/run_prettify.js?ver=1.4.0" id="code-prettify-js"></script>
<script type="text/javascript" src="/wp-content/themes/eclypsium-10-28-21a/js/navigation.js?ver=20151215" id="eclypsium-navigation-js"></script>
<script type="text/javascript" src="/wp-content/themes/eclypsium-10-28-21a/js/skip-link-focus-fix.js?ver=20151215" id="eclypsium-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="/wp-includes/js/wp-embed.min.js?ver=5.8.1" id="wp-embed-js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
<script type="text/javascript" language="javascript">
  var sf14gv = 32633;
  (function() {
    var sf14g = document.createElement('script');
    sf14g.src = 'https://tracking.leadlander.com/lt.min.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sf14g, s);
  })();
</script>		
	
<script> (function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://lftracker.leadfeeder.com/lftracker_v1_DzLR5a5nBBW8BoQ2.js'); })(); </script>
	
<!-- Start of HubSpot Embed Code
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5610435.js"></script>
<!-- End of HubSpot Embed Code -->

		
</body>
</html>
