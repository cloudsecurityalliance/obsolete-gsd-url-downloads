
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>
Issue 39603: [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method - Python tracker

</title>
<link rel="shortcut icon" href="@@file/favicon.ico" />
<link rel="stylesheet" type="text/css" href="@@file/main.css" />
<link rel="stylesheet" type="text/css" href="@@file/style.css" />
<link rel="search" type="application/opensearchdescription+xml" href="@@file/osd.xml" title="Python bug tracker search" />
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script nonce="856dd7b421007930f5128f430cd061dea35ea9bcbc3503833f8c3e5d03ea8746" type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        return false;
    }
    submitted = true;
    return true;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://bugs.python.org/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
    HelpWin.focus ()
}
</script>


<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.js"></script>
<script type="text/javascript" src="@@file/issue.item.js"></script>
<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" />


</head>
<body>
  <!--  Logo  -->
  <h1 id="logoheader">
    <a accesskey="1" href="." id="logolink">
       <img src="@@file/python-logo.gif" alt="homepage" border="0" id="logo" /></a>
  </h1>

<div id="utility-menu">
<!-- Search Box -->
<div id="searchbox">
    <form name="searchform" method="get" action="issue" id="searchform">
      <div id="search">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignee,status,type" />
       <input type="hidden" name="@sort" value="-activity" />
       <input type="hidden" name="@filter" value="status" />
       <input type="hidden" name="@action" value="searchid" />
       <input type="hidden" name="ignore" value="file:content" />
       <input class="input-text" id="search-text"
              name="@search_text" size="10" />
       <input type="submit" id="submit" value="search" name="submit" class="input-button" />
       <input type="radio" name="status"
              id="status_notresolved" value="-1,1,3" />
       <label for="status_notresolved">open</label>
       <input type="radio" name="status" checked="checked"
              id="status_all" value="-1,1,2,3" />
       <label for="status_all">all</label>
      </div>
     </form>
</div>
</div>


<div id="left-hand-navigation">
<!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
<div id="menu">
  <ul class="level-one">
    <li><a href="https://www.python.org/" title="Go to the Python homepage">Python Home</a></li>
    <li><a href="https://www.python.org/about/" title="About The Python Language">About</a></li>
    <li><a href="https://www.python.org/blogs/" title="">News</a></li>
    <li><a href="https://www.python.org/doc/" title="">Documentation</a></li>
    <li><a href="https://www.python.org/downloads/" title="">Downloads</a></li>
    <li><a href="https://www.python.org/community/" title="">Community</a></li>
    <li><a href="https://www.python.org/psf/" title="Python Software Foundation">Foundation</a></li>
    <li><a href="https://devguide.python.org/" title="Python Developer's Guide">Developer's Guide</a></li>
    <li class="selected"><a href="." class="selected" title="Python Issue Tracker">Issue Tracker</a>
      <ul class="level-two">
        <li>
          <strong>Issues</strong>
          <ul class="level-three">
            
            <li><a href="issue?@template=search&amp;status=1">Search</a></li>
            <li><a href="issue?@action=random">Random Issue</a></li>
            <li>
              <form method="post" action="issue39603">
                <input type="submit" class="form-small"
                       value="Show issue:" />
                <input class="form-small" size="4" type="text" name="@number" />
                <input type="hidden" name="@type" value="issue" />
                <input type="hidden" name="@action" value="show" />
              </form>
            </li>
          </ul>
        </li>


        <li>
          <strong>Summaries</strong>
          <ul class="level-three">
            

            

            

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Issues%20with%20patch&amp;@startwith=0&amp;@group=priority&amp;keywords=2&amp;@action=search&amp;@filter=&amp;@pagesize=50">Issues with patch</a>
            </li>

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Easy%20issues&amp;@startwith=0&amp;@group=priority&amp;keywords=6&amp;@action=search&amp;@filter=&amp;@pagesize=50">Easy issues</a>
            </li>

            <li>
              <a href="issue?@template=stats">Stats</a>
            </li>

          </ul>
        </li>


        <li>
          <strong>User</strong>
          <form method="post" action="issue39603">
          <ul class="level-three">
            <li>
                Login&nbsp;(OpenID&nbsp;possible)<br />
	         <a style="display:inline;width:0;margin:0"
             href="issue39603?@action=oic_login&amp;provider=Google">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.google.com/favicon.ico"
                       alt="Google" title="Google" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue39603?@action=oic_login&amp;provider=GitHub">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.github.com/favicon.ico"
                       alt="GitHub" title="GitHub" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue39603?@action=openid_login&amp;provider=Launchpad">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://launchpad.net/favicon.ico"
                       alt="Launchpad" title="Launchpad" /></a>
                <input size="10" name="openid_identifier" style="background:url(@@file/openid-16x16.gif)
                  center left no-repeat;padding-left:16px" /><br />
                <input size="10" type="password" name="__login_password" /><br />
                <input type="hidden" name="@action" value="Login" />
                <input type="checkbox" name="remember" id="remember" />
                <label for="remember">Remember me?</label><br />
                <input class="form-small" type="submit"
                       value="Login" /><br />
                <input type="hidden" name="__came_from"
                       value="https://bugs.python.org/issue39603?">
                
                <input type="hidden" name="@sort" value=""/>
<input type="hidden" name="@group" value=""/>
<input type="hidden" name="@pagesize" value="50"/>
<input type="hidden" name="@startwith" value="0"/>
            </li>
            <li>
                <a href="user?@template=register">Register</a>
            </li>
            <li><a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a></li>
          </ul>
          </form>
        </li>

        

        

        <li>
          <strong>Administration</strong>
          <ul class="level-three">
            
            <li>
                <a href="user?@sort=username">User List</a></li>
            <li>
                <a href="user?iscommitter=1&amp;@action=search&amp;@sort=username&amp;@pagesize=300">Committer List</a></li>
            
            
            
          </ul>
        </li>

        <li>
          <strong>Help</strong>
          <ul class="level-three">
            <li><a href="http://docs.python.org/devguide/triaging.html">
                Tracker Documentation</a></li>
            <li><a href="http://wiki.python.org/moin/TrackerDevelopment">
                Tracker Development</a></li>
            <li><a href="https://github.com/python/psf-infra-meta/issues">
                Report Tracker Problem</a></li>
          </ul>
        </li>

      </ul>
    </li>
  </ul>
</div> <!-- menu -->
</div> <!-- left-hand-navigation -->

<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb">
 
 
 Issue39603
 
</div>
 
 





<div>

<form method="post" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue39603">

<fieldset><legend>classification</legend>
<table class="form">
<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#title" target="_blank">Title</a>:</th>
 
 <td colspan="3">
  <span>[security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method</span>
  <input type="hidden" name="title"
         value="[security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method">
 </td>
</tr>

<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#type" target="_blank">Type</a>:</th>
 <td>security</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#stage" target="_blank">Stage</a>:</th>
 <td>resolved</td>
</tr>

<tr>
 <th><a href="http://docs.python.org/devguide/triaging.html#components" target="_blank">Components</a>:</th>
 <td>Library (Lib), SSL</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#versions" target="_blank">Versions</a>:</th>
 <td>Python 3.10, Python 3.9, Python 3.8, Python 3.7, Python 3.6, Python 3.5</td>
</tr>
</table>
</fieldset>

<fieldset><legend>process</legend>
<table class="form">
<tr>
  <th><a href="http://docs.python.org/devguide/triaging.html#status" target="_blank">Status</a>:</th>
  <td>closed</td>
  <th><a href="http://docs.python.org/devguide/triaging.html#resolution" target="_blank">Resolution</a>:</th>
  <td>fixed</td>
</tr>

<tr>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#dependencies"
       target="_blank">Dependencies</a>:
 </th>
 <td>
  
  
 </td>
 <th><a href="http://docs.python.org/devguide/triaging.html#superseder" target="_blank">Superseder</a>:</th>
 <td>
  
 
 </td>
 </tr>
 <tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#assigned-to"
      target="_blank">Assigned To</a>:
 </th>
 
 <td>
  christian.heimes
 </td>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#nosy-list"
      target="_blank">Nosy List</a><!--
        <span tal:condition="context/nosy_count" tal:replace="python: ' (%d)' % context.nosy_count" /> -->:
 </th>
 <td>
     Amir, M W2, christian.heimes, gvanrossum, kmaork, larry, lukasz.langa, maxpl0it, mcascella, miss-islington, ned.deily, orsenthil, vstinner, xtreak
     
 </td>
</tr>
<tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#priority"
      target="_blank">Priority</a>:
 </th>
 <td>normal</td>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#keywords"
       target="_blank">Keywords</a>:
 </th>
 <td>patch</td>


</tr>









</table>
</fieldset>

</form>

<p>Created on <strong>2020-02-10 19:29</strong> by <strong>maxpl0it</strong>, last changed <strong>2020-09-28 22:42</strong> by <strong>vstinner</strong>. This issue is now <strong style="color:#00F; background-color:inherit;">closed</strong>.</p>



<table class="files">
 <tr><th class="header" colspan="4">Pull Requests</th></tr>
 <tr>
  <th>URL</th>
  <th>Status</th>
  <th>Linked</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/18480" title="bpo-39603: Prevent header injection in http methods">PR 18480</a></td>
  <td>closed</td>
  <td>
   <span>Amir</span>,
   <span>2020-02-12 11:05</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/18485" title="bpo-39603: Prevent header injection in http methods">PR 18485</a></td>
  <td>merged</td>
  <td>
   <span>Amir</span>,
   <span>2020-02-12 13:54</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/21536" title="[3.9] bpo-39603: Prevent header injection in http methods (GH-18485)">PR 21536</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-07-18 20:16</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/21537" title="[3.8] bpo-39603: Prevent header injection in http methods (GH-18485)">PR 21537</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-07-18 20:16</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/21538" title="[3.7] bpo-39603: Prevent header injection in http methods (GH-18485)">PR 21538</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-07-18 20:16</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/21539" title="[3.6] bpo-39603: Prevent header injection in http methods (GH-18485)">PR 21539</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-07-18 20:17</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/21946" title="[3.5] bpo-39603: Prevent header injection in http methods (GH-18485)">PR 21946</a></td>
  <td>merged</td>
  <td>
   <span>vstinner</span>,
   <span>2020-08-24 15:52</span>
  </td>
  <td>
    
  </td>
 </tr>
</table>





<table class="messages">
 <tr><th colspan="4" class="header">Messages (21)</th></tr>
 
  <tr>
    <th>
     <a href="#msg361710" id="msg361710">msg361710</a> - <a
    href="msg361710">(view)</a></th>
   <th>Author: Max (maxpl0it)</th>
   <th>Date: 2020-02-10 19:29</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I recently came across a bug during a pentest that's allowed me to perform some really interesting attacks on a target. While originally discovered in requests, I had been forwarded to one of the urllib3 developers after agreeing that fixing it at it's lowest level would be preferable. I was informed that the vulnerability is also present in http.client and that I should report it here as well.

The 'method' parameter is not filtered to prevent the injection from altering the entire request.

For example:
&gt;&gt;&gt; conn = http.client.HTTPConnection("localhost", 80)
&gt;&gt;&gt; conn.request(method="GET / HTTP/1.1\r\nHost: abc\r\nRemainder:", url="/index.html")

This will result in the following request being generated:
GET / HTTP/1.1
Host: abc
Remainder: /index.html HTTP/1.1
Host: localhost
Accept-Encoding: identity

This was originally found in an HTTP proxy that was utilising Requests. It allowed me to manipulate the original path to access different files from an internal server since the developers had assumed that the method would filter out non-standard HTTP methods.

The recommended solution is to only allow the standard HTTP methods of GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, and PATCH.

An alternate solution that would allow programmers to use non-standard methods would be to only support characters [a-z] and stop reading at any special characters (especially newlines and spaces).</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361808" id="msg361808">msg361808</a> - <a
    href="msg361808">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-02-11 12:29</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>&gt; The recommended solution is to only allow the standard HTTP methods of GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, and PATCH.

I don't think that we have to be so strict. We can maybe restrict the HTTP method to ASCII letters, or just reject control characters (U+0000-U+001f).

Similar issues (fixed):

* <a href="https://python-security.readthedocs.io/vuln/http-header-injection2.html">https://python-security.readthedocs.io/vuln/http-header-injection2.html</a>
* <a href="https://python-security.readthedocs.io/vuln/http-header-injection.html">https://python-security.readthedocs.io/vuln/http-header-injection.html</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361818" id="msg361818">msg361818</a> - <a
    href="msg361818">(view)</a></th>
   <th>Author: Max (maxpl0it)</th>
   <th>Date: 2020-02-11 14:13</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I agree that the solution is quite restrictive.
Restricting to ASCII characters alone would certainly work.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361828" id="msg361828">msg361828</a> - <a
    href="msg361828">(view)</a></th>
   <th>Author: Amir Mohamadi (Amir) <span title="Contributor form received">*</span></th>
   <th>Date: 2020-02-11 18:34</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>can I work on it?!</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361865" id="msg361865">msg361865</a> - <a
    href="msg361865">(view)</a></th>
   <th>Author: Amir Mohamadi (Amir) <span title="Contributor form received">*</span></th>
   <th>Date: 2020-02-12 07:09</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>@vstinner sorry to bother you, I have a quick question.

the request(...) method is like this:

def request(self, method, url, body=None, headers={}, *,          
            encode_chunked=False):                                
    """Send a complete request to the server."""                  
    self._send_request(method, url, body, headers, encode_chunked)

'request' calls '_send_request' method and '_send_request' calls 'putrequest' inside itself.

So is it good if I encode 'method' parameter to ASCII inside 'putrequest'??!</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361896" id="msg361896">msg361896</a> - <a
    href="msg361896">(view)</a></th>
   <th>Author: Senthil Kumaran (orsenthil) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-02-12 14:35</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Welcome to work on the patch, Amir.

* We shouldn't be encoding anything.
* Create reject for Unicode control characters and reject the request if the request contains any control character. Write tests for this.

It will similar to one of the examples Victor has shared.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg362239" id="msg362239">msg362239</a> - <a
    href="msg362239">(view)</a></th>
   <th>Author: Maor Kleinberger (kmaork) <span title="Contributor form received">*</span></th>
   <th>Date: 2020-02-18 23:17</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Hey, it's been a week since the last activity here...
Amir, if you are not working on it I'd be glad to work on it as well :)</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373915" id="msg373915">msg373915</a> - <a
    href="msg373915">(view)</a></th>
   <th>Author: miss-islington (miss-islington)</th>
   <th>Date: 2020-07-18 20:16</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/8ca8a2e8fb068863c1138f07e3098478ef8be12e">8ca8a2e8fb068863c1138f07e3098478ef8be12e</a> by AMIR in branch 'master':
<a class="closed" title="[closed] [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method" href="issue39603">bpo-39603</a>: Prevent header injection in http methods (<a href="https://github.com/python/cpython/pull/18485" class="closed" title="GitHub PR 18485: [merged] bpo-39603: Prevent header injection in http methods">GH-18485</a>)
<a href="https://github.com/python/cpython/commit/8ca8a2e8fb068863c1138f07e3098478ef8be12e">https://github.com/python/cpython/commit/8ca8a2e8fb068863c1138f07e3098478ef8be12e</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373916" id="msg373916">msg373916</a> - <a
    href="msg373916">(view)</a></th>
   <th>Author: Guido van Rossum (gvanrossum) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-07-18 20:23</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>The 3.9 and 3.8 backports are waiting for tests to complete. The 3.7 and 3.6 backports need to be merged by the RM (Ned). Then someone can close this issue.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373917" id="msg373917">msg373917</a> - <a
    href="msg373917">(view)</a></th>
   <th>Author: miss-islington (miss-islington)</th>
   <th>Date: 2020-07-18 20:39</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/668d321476d974c4f51476b33aaca870272523bf">668d321476d974c4f51476b33aaca870272523bf</a> by Miss Islington (bot) in branch '3.8':
<a class="closed" title="[closed] [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method" href="issue39603">bpo-39603</a>: Prevent header injection in http methods (<a href="https://github.com/python/cpython/pull/18485" class="closed" title="GitHub PR 18485: [merged] bpo-39603: Prevent header injection in http methods">GH-18485</a>)
<a href="https://github.com/python/cpython/commit/668d321476d974c4f51476b33aaca870272523bf">https://github.com/python/cpython/commit/668d321476d974c4f51476b33aaca870272523bf</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373918" id="msg373918">msg373918</a> - <a
    href="msg373918">(view)</a></th>
   <th>Author: miss-islington (miss-islington)</th>
   <th>Date: 2020-07-18 20:41</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/27b811057ff5e93b68798e278c88358123efdc71">27b811057ff5e93b68798e278c88358123efdc71</a> by Miss Islington (bot) in branch '3.9':
<a class="closed" title="[closed] [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method" href="issue39603">bpo-39603</a>: Prevent header injection in http methods (<a href="https://github.com/python/cpython/pull/18485" class="closed" title="GitHub PR 18485: [merged] bpo-39603: Prevent header injection in http methods">GH-18485</a>)
<a href="https://github.com/python/cpython/commit/27b811057ff5e93b68798e278c88358123efdc71">https://github.com/python/cpython/commit/27b811057ff5e93b68798e278c88358123efdc71</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373944" id="msg373944">msg373944</a> - <a
    href="msg373944">(view)</a></th>
   <th>Author: Ned Deily (ned.deily) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-07-19 09:27</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/ca75fec1ed358f7324272608ca952b2d8226d11a">ca75fec1ed358f7324272608ca952b2d8226d11a</a> by Miss Islington (bot) in branch '3.7':
<a class="closed" title="[closed] [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method" href="issue39603">bpo-39603</a>: Prevent header injection in http methods (<a href="https://github.com/python/cpython/pull/18485" class="closed" title="GitHub PR 18485: [merged] bpo-39603: Prevent header injection in http methods">GH-18485</a>) (<a href="https://github.com/python/cpython/pull/21538" class="closed" title="GitHub PR 21538: [merged] [3.7] bpo-39603: Prevent header injection in http methods (GH-18485)">GH-21538</a>)
<a href="https://github.com/python/cpython/commit/ca75fec1ed358f7324272608ca952b2d8226d11a">https://github.com/python/cpython/commit/ca75fec1ed358f7324272608ca952b2d8226d11a</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373945" id="msg373945">msg373945</a> - <a
    href="msg373945">(view)</a></th>
   <th>Author: Ned Deily (ned.deily) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-07-19 09:28</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/f02de961b9f19a5db0ead56305fe0057a78787ae">f02de961b9f19a5db0ead56305fe0057a78787ae</a> by Miss Islington (bot) in branch '3.6':
<a class="closed" title="[closed] [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method" href="issue39603">bpo-39603</a>: Prevent header injection in http methods (<a href="https://github.com/python/cpython/pull/18485" class="closed" title="GitHub PR 18485: [merged] bpo-39603: Prevent header injection in http methods">GH-18485</a>) (<a href="https://github.com/python/cpython/pull/21539" class="closed" title="GitHub PR 21539: [merged] [3.6] bpo-39603: Prevent header injection in http methods (GH-18485)">GH-21539</a>)
<a href="https://github.com/python/cpython/commit/f02de961b9f19a5db0ead56305fe0057a78787ae">https://github.com/python/cpython/commit/f02de961b9f19a5db0ead56305fe0057a78787ae</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg373946" id="msg373946">msg373946</a> - <a
    href="msg373946">(view)</a></th>
   <th>Author: Ned Deily (ned.deily) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-07-19 09:32</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Merged for release in 3.9.0b5, 3.8.5, 3.7.9, and 3.6.12. Thanks, everyone!</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg374020" id="msg374020">msg374020</a> - <a
    href="msg374020">(view)</a></th>
   <th>Author: Łukasz Langa (lukasz.langa) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-07-20 17:24</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/580fbb018fd0844806119614d752b41fc69660f9">580fbb018fd0844806119614d752b41fc69660f9</a> by Łukasz Langa in branch '3.8':
Python 3.8.5
<a href="https://github.com/python/cpython/commit/580fbb018fd0844806119614d752b41fc69660f9">https://github.com/python/cpython/commit/580fbb018fd0844806119614d752b41fc69660f9</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg374093" id="msg374093">msg374093</a> - <a
    href="msg374093">(view)</a></th>
   <th>Author: Max (maxpl0it)</th>
   <th>Date: 2020-07-22 15:33</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I've just noticed an issue with the current version of the patch. It should also include 0x20 (space) since that can also be used to manipulate the request.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg374095" id="msg374095">msg374095</a> - <a
    href="msg374095">(view)</a></th>
   <th>Author: Guido van Rossum (gvanrossum) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-07-22 16:01</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>&gt; It should also include 0x20 (space) since that can also be used to manipulate the request.

Can you indicate how to use a space in the HTTP verb as part of an attack?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg376335" id="msg376335">msg376335</a> - <a
    href="msg376335">(view)</a></th>
   <th>Author: Larry Hastings (larry) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-09-04 00:54</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/524b8de630036a29ca340bc2ae6fd6dc7dda8f40">524b8de630036a29ca340bc2ae6fd6dc7dda8f40</a> by Victor Stinner in branch '3.5':
<a class="closed" title="[closed] [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method" href="issue39603">bpo-39603</a>: Prevent header injection in http methods (<a href="https://github.com/python/cpython/pull/18485" class="closed" title="GitHub PR 18485: [merged] bpo-39603: Prevent header injection in http methods">GH-18485</a>) (<a class="closed" title="[closed] 'python -u' yields trailing carriage return '\r'  (Python2 for Windows)" href="issue21946">#21946</a>)
<a href="https://github.com/python/cpython/commit/524b8de630036a29ca340bc2ae6fd6dc7dda8f40">https://github.com/python/cpython/commit/524b8de630036a29ca340bc2ae6fd6dc7dda8f40</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg377586" id="msg377586">msg377586</a> - <a
    href="msg377586">(view)</a></th>
   <th>Author: Mauro Matteo Cascella (mcascella)</th>
   <th>Date: 2020-09-28 07:05</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Hello,

CVE-2020-26116 has been requested/assigned for this flaw via MITRE form: <a href="https://cveform.mitre.org/">https://cveform.mitre.org/</a>

I suggest mentioning it in the related vulnerability page: <a href="https://python-security.readthedocs.io/vuln/http-header-injection-method.html">https://python-security.readthedocs.io/vuln/http-header-injection-method.html</a>

Also note that httplib (python-2.7.18) seems to be affected too. Any particular reason for it not to be listed in the same vulnerability page?

Thank you,</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg377607" id="msg377607">msg377607</a> - <a
    href="msg377607">(view)</a></th>
   <th>Author: Larry Hastings (larry) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-09-28 16:20</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>&gt; Also note that httplib (python-2.7.18) seems to be affected too. Any particular reason for it not to be listed in the same vulnerability page?

Yes: 2.7 has been end-of-lifed and is no longer supported.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg377643" id="msg377643">msg377643</a> - <a
    href="msg377643">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-09-28 22:42</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Mauro Matteo Cascella: "CVE-2020-26116 has been requested/assigned for this flaw via MITRE form: <a href="https://cveform.mitre.org/">https://cveform.mitre.org/</a> I suggest mentioning it in the related vulnerability page: <a href="https://python-security.readthedocs.io/vuln/http-header-injection-method.html">https://python-security.readthedocs.io/vuln/http-header-injection-method.html</a>"

Thanks, done.</pre>
   </td>
  </tr>
 
</table>

<table class="history table table-condensed table-striped"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2020-09-28&nbsp;22:42:24</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg377643">msg377643</a><br />title: [security] http.client: HTTP Header Injection in the HTTP method -> [security][ CVE-2020-26116] http.client: HTTP Header Injection in the HTTP method</td></tr>
<tr><td>2020-09-28&nbsp;16:20:00</td><td>larry</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg377607">msg377607</a></td></tr>
<tr><td>2020-09-28&nbsp;07:05:14</td><td>mcascella</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user35963">mcascella</a><br />messages:
  + <a rel="nofollow" href="msg377586">msg377586</a><br /></td></tr>
<tr><td>2020-09-04&nbsp;00:54:24</td><td>larry</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user2731">larry</a><br />messages:
  + <a rel="nofollow" href="msg376335">msg376335</a><br /></td></tr>
<tr><td>2020-08-24&nbsp;15:52:33</td><td>vstinner</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request21056">pull_request21056</a></td></tr>
<tr><td>2020-07-22&nbsp;16:01:52</td><td>gvanrossum</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg374095">msg374095</a></td></tr>
<tr><td>2020-07-22&nbsp;15:33:33</td><td>maxpl0it</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg374093">msg374093</a></td></tr>
<tr><td>2020-07-20&nbsp;17:24:33</td><td>lukasz.langa</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user12704">lukasz.langa</a><br />messages:
  + <a rel="nofollow" href="msg374020">msg374020</a><br /></td></tr>
<tr><td>2020-07-19&nbsp;09:32:11</td><td>ned.deily</td><td>set</td><td>status: open -> closed<br />versions:
  + Python 3.10, - Python 2.7<br />messages:
  + <a rel="nofollow" href="msg373946">msg373946</a><br /><br />resolution: fixed<br />stage: patch review -> resolved</td></tr>
<tr><td>2020-07-19&nbsp;09:28:48</td><td>ned.deily</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg373945">msg373945</a></td></tr>
<tr><td>2020-07-19&nbsp;09:27:39</td><td>ned.deily</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user5248">ned.deily</a><br />messages:
  + <a rel="nofollow" href="msg373944">msg373944</a><br /></td></tr>
<tr><td>2020-07-18&nbsp;22:33:16</td><td>M W2</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user3108">christian.heimes</a>, <a rel="nofollow" href="user35287">M W2</a><br /><br />components:
  + SSL<br />assignee: <a rel="nofollow" href="user3108">christian.heimes</a></td></tr>
<tr><td>2020-07-18&nbsp;20:41:59</td><td>miss-islington</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg373918">msg373918</a></td></tr>
<tr><td>2020-07-18&nbsp;20:39:19</td><td>miss-islington</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg373917">msg373917</a></td></tr>
<tr><td>2020-07-18&nbsp;20:23:27</td><td>gvanrossum</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user5">gvanrossum</a><br />messages:
  + <a rel="nofollow" href="msg373916">msg373916</a><br /></td></tr>
<tr><td>2020-07-18&nbsp;20:17:00</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request20681">pull_request20681</a></td></tr>
<tr><td>2020-07-18&nbsp;20:16:51</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request20680">pull_request20680</a></td></tr>
<tr><td>2020-07-18&nbsp;20:16:45</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request20679">pull_request20679</a></td></tr>
<tr><td>2020-07-18&nbsp;20:16:37</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request20678">pull_request20678</a></td></tr>
<tr><td>2020-07-18&nbsp;20:16:18</td><td>miss-islington</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user27838">miss-islington</a><br />messages:
  + <a rel="nofollow" href="msg373915">msg373915</a><br /></td></tr>
<tr><td>2020-02-18&nbsp;23:17:06</td><td>kmaork</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user30851">kmaork</a><br />messages:
  + <a rel="nofollow" href="msg362239">msg362239</a><br /></td></tr>
<tr><td>2020-02-12&nbsp;14:35:43</td><td>orsenthil</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg361896">msg361896</a></td></tr>
<tr><td>2020-02-12&nbsp;13:54:56</td><td>Amir</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request17858">pull_request17858</a></td></tr>
<tr><td>2020-02-12&nbsp;11:05:08</td><td>Amir</td><td>set</td><td>keywords:
  + <a rel="nofollow" href="keyword2">patch</a><br />stage: patch review<br />pull_requests:
  + <a rel="nofollow" href="pull_request17850">pull_request17850</a></td></tr>
<tr><td>2020-02-12&nbsp;07:09:21</td><td>Amir</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg361865">msg361865</a></td></tr>
<tr><td>2020-02-11&nbsp;18:34:30</td><td>Amir</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user32369">Amir</a><br />messages:
  + <a rel="nofollow" href="msg361828">msg361828</a><br /></td></tr>
<tr><td>2020-02-11&nbsp;14:13:39</td><td>maxpl0it</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg361818">msg361818</a></td></tr>
<tr><td>2020-02-11&nbsp;12:54:59</td><td>xtreak</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user28746">xtreak</a><br /></td></tr>
<tr><td>2020-02-11&nbsp;12:29:20</td><td>vstinner</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user2377">vstinner</a>, <a rel="nofollow" href="user1741">orsenthil</a><br />messages:
  + <a rel="nofollow" href="msg361808">msg361808</a><br /></td></tr>
<tr><td>2020-02-11&nbsp;12:27:34</td><td>vstinner</td><td>set</td><td>title: Injection in http.client -> [security] http.client: HTTP Header Injection in the HTTP method</td></tr>
<tr><td>2020-02-10&nbsp;19:29:35</td><td>maxpl0it</td><td>create</td><td></td></tr>
</table>

</div>


</div> <!-- content-body -->
<div id="footer">
<div id="credits">
  Hosted on <a href="https://m.do.co/c/783434964889" title="Hosted on DigitalOcean">DigitalOcean</a>,
  <br>
  Supported by <a href="https://python.org/psf-landing/" title="The Python Software Foundation">The Python Software Foundation</a>,
  <br>
  Powered by <a href="http://roundup.sourceforge.net" title="Powered by the Roundup Issue Tracker">Roundup</a>
</div> <!-- credits -->
Copyright &copy; 1990-2020, <a href="http://python.org/psf">Python Software Foundation</a><br />
<a href="http://python.org/about/legal">Legal Statements</a>
</div> <!-- footer -->
</div> <!-- body-main -->
</div> <!-- content -->



</body>
</html>

