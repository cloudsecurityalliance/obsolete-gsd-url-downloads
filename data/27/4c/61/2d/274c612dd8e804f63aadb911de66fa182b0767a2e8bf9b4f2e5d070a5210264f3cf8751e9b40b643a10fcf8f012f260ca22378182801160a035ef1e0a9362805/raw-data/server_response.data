<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - TFTP sends more than buffer size - CVE-2017-1000100</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="STYLESHEET" type="text/css" href="https://curl.se/manpage.css">
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">Web Site Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/hsts.html">HSTS</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http2.html">HTTP/2</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/changes.html">Changelog</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/security.html">Security Problems</a>
    <a href="/docs/versions.html">Version Nums</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/manual.html">Tutorial</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">Security Problems</a> / <b>TFTP sends more than buffer size</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/changes.html">Changelog</a>
<br><a href="/donation.html">Donate</a>
<br><a href="faq.html">FAQ</a>
<br><a href="security.html">Security Problems</a>
<br><a href="/dev/secprocess.html">Security Process</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<h1 id="tftp-sends-more-than-buffer-size">TFTP sends more than buffer size</h1>
<p>Project curl Security Advisory, August 9th 2017 - <a href="https://curl.se/docs/CVE-2017-1000100.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>When doing a TFTP transfer and curl/libcurl is given a URL that contains a very long file name (longer than about 515 bytes), the file name is truncated to fit within the buffer boundaries, but the buffer size is still wrongly updated to use the untruncated length. This too large value is then used in the <code>sendto()</code> call, making curl attempt to send more data than what is actually put into the buffer. The <code>sendto()</code> function will then read beyond the end of the heap based buffer.</p>
<p>A malicious HTTP(S) server could redirect a vulnerable libcurl-using client to a crafted TFTP URL (if the client hasn't restricted which protocols it allows redirects to) and trick it to send private memory contents to a remote server over UDP. Limit curl's redirect protocols with <code>--proto-redir</code> and libcurl's with <code><a href="https://curl.se/libcurl/c/CURLOPT_REDIR_PROTOCOLS.html">CURLOPT_REDIR_PROTOCOLS</a></code>.</p>
<p>We are not aware of any exploit of this flaw.</p>
<h2 id="info">INFO</h2>
<p>This flaw also affects the curl command line tool.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2017-1000100 to this issue.</p>
<p>CWE-126: Buffer Over-read</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<p>This bug has been present in curl since TFTP support was added, in September 2005 (commit <a href="https://github.com/curl/curl/commit/56d9624b566">56d9624b566</a>).</p>
<ul>
<li>Affected versions: libcurl <a href="vuln-7.15.0.html">7.15.0</a> to and including <a href="vuln-7.54.1.html">7.54.1</a></li>
<li>Not affected versions: libcurl &lt; <a href="vuln-7.15.0.html">7.15.0</a> and &gt;= <a href="vuln-7.55.0.html">7.55.0</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as such.</p>
<h2 id="the-solution">THE SOLUTION</h2>
<p>The function now returns error if attempting to send a file name that is too long to fit in the TFTP packet.</p>
<p>A <a href="https://curl.se/CVE-2017-1000100.patch">patch for CVE-2017-1000100</a> is available.</p>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in order of preference:</p>
<p>A - Upgrade curl and libcurl to version <a href="vuln-7.55.0.html">7.55.0</a></p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Disable TFTP or otherwise restrict TFTP transfers</p>
<h2 id="time-line">TIME LINE</h2>
<p>It was reported to the curl project on July 11, 2017. We contacted distros@openwall on August 1.</p>
<p>libcurl <a href="vuln-7.55.0.html">7.55.0</a> was released on August 9 2017, coordinated with the publication of this advisory.</p>
<h2 id="credits">CREDITS</h2>
<p>Reported by Even Rouault. Discovery: credit to OSS-Fuzz. Patch by Daniel Stenberg.</p>
<p>Thanks a lot!</p>
</div>
</div>
<script defer src="https://www.fastly-insights.com/insights.js?k=8cb1247c-87c2-4af9-9229-768b1990f90b" type="text/javascript"></script>
</body> </html>
