<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<title>ares_create_query single byte out of buffer write</title>
<link rel="STYLESHEET" type="text/css" href="/cares.css">
</head>
<body>
<div class="menu">
<a href="/">c-ares home</a> &middot;
<a href="/docs.html">docs</a> &middot;
<a href="/license.html">license</a> &middot;
<a href="/daily-snapshot/">daily snapshots</a> &middot;
<a href="/mail.cgi">mail archive</a> &middot;
<a href="/why.html">why</a> &middot;
<a href="/otherlibs.html">other libs</a> &middot;
<a href="https://github.com/c-ares/c-ares">github</a>

</div>
<div class=title align=left> CVE-2016-5180 </div>
<div class="box">
<h1><code>ares_create_query</code> single byte out of buffer write</h1>
<p>Project c-ares Security Advisory, September 29, 2016 -
<a href="https://c-ares.org/adv_20160929.html">Permalink</a></p>

<h2>VULNERABILITY</h2>
<p>When a string is passed in to <code>ares_create_query</code> or <code>ares_mkquery</code> and uses
an escaped trailing dot, like <code>"hello\."</code>, c-ares calculates the string length
wrong and subsequently writes outside of the allocated buffer with one byte.
The wrongly written byte is the least significant byte of the 'dnsclass'
argument; most commonly 1.</p>
<p>Proof of concept code have showed how this can be exploited in a real-world
system, but we are not aware of any exploits having actually happened in the
wild.</p>
<h2>INFO</h2>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2016-5180 to this issue.</p>
<h2>AFFECTED VERSIONS</h2>
<p>This flaw exists in the following c-ares versions.</p>
<ul>
<li>Affected versions: c-ares 1.0.0 to and including 1.11.0</li>
<li>Not affected versions: c-ares >= 1.12.0</li>
</ul>
<h2>THE SOLUTION</h2>
<p>In version 1.12.0, the function has been corrected and a test case have been
added to verify.</p>
<p>A <a href="https://c-ares.org/CVE-2016-5180.patch">patch for CVE-2016-5180</a> is

available.</p>
<h2>RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in order of
preference:</p>
<p>A - Upgrade c-ares to version 1.12.0</p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Make <em>really</em> sure you don't pass in strings to either of these functions
     that use escaped trailing dots.</p>
<h2>TIME LINE</h2>
<p>It was reported to the c-ares project on September 22 by Gzob Qq.</p>
<p>c-ares 1.12.0 was released on September 29 2016, coordinated with the
publication of this advisory.</p>
<h2>CREDITS</h2>
<p>Thanks to Gzob Qq for the report and to Mattias Nissler for code reviews of
the patch.</p>
</div>
</body></html>
