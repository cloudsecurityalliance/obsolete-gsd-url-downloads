<!DOCTYPE html>
<html lang="en">
  <head>
    <title>217464 &ndash; (CVE-2010-2536) Universal XSS</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/23ebf435e712b8c1688f186151fcc60c.css?1626941475" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1626941475"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 5
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "217464 – (CVE-2010-2536) Universal XSS",
                             "show_bug.cgi?id=217464" );
        document.title = "217464 – (CVE-2010-2536) Universal XSS";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "217464 – (CVE-2010-2536) Universal XSS", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1626941475"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="KDE Bugtracking System" href="./search_plugin.cgi">
    <link rel="apple-touch-icon" sizes="180x180" href="https://kde.org/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://kde.org/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://kde.org/favicon-16x16.png">
    <link rel="mask-icon" href="https://kde.org/safari-pinned-tab.svg" color="#1f99f3">
  </head>

  <body 
        class="bugs-kde-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_rekonq
                 bz_component_general
                 bz_bug_217464 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">KDE Bugtracking System &ndash; Bug&nbsp;217464</span>

        <span id="subtitle" class="subheader">Universal XSS</span>

        <span id="information" class="header_addl_info">Last modified: 2011-11-02 16:47:27 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=217464&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=217464" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=217464&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619429-6Hg5LBSNM6gPZ34r3LG2DcJWB5DL5rt4fHfXCbIMm-Q">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2011-11-02 16:47:27">
  <input type="hidden" name="id" value="217464">
  <input type="hidden" name="token" value="1635619429-Ae5V-HVCDqPUMsC4jftBj_HyyvYG13KMYXC6CTGkAzc">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=217464"><b>Bug&nbsp;217464</b></a> <span id="summary_container" class="bz_default_hidden">
        (<span id="alias_nonedit_display">CVE-2010-2536</span>)
      - <span id="short_desc_nonedit_display">Universal XSS</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>Universal XSS
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'Universal XSS' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>CVE-2010-2536
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >rekonq

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=rekonq"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >general

  (<a href="buglist.cgi?component=general&amp;product=rekonq&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>0.4.0
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Platform:</a>

</th>
      <td class="field_value">unspecified
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>NOR
       crash<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=217464#vote_217464">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th><td>---
  </td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Andrea Diamantini</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'adjam7\x40gmail.com',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2009-12-05 17:52 UTC by <span class="vcard"><span class="fn">Tim Brown</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2011-11-02 16:47 UTC
      (<a href="show_activity.cgi?id=217464">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>4 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="fedora">fedora</option>
                <option value="pano_90">pano_90</option>
                <option value="tampakrap">tampakrap</option>
                <option value="webkit-devel">webkit-devel</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_commitlink">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_commitlink"
  >Latest Commit:</a>

</th>
  <td class="field_value "
      id="field_container_cf_commitlink" >

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_versionfixedin">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_versionfixedin"
  >Version Fixed In:</a>

</th>
  <td class="field_value "
      id="field_container_cf_versionfixedin" >

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=49437"
               title="View the content of the attachment">
          <b>Removes path from URL on error page</b></a>

          <span class="bz_attach_extra_info">
              (778 bytes,
                patch)

            <br>
            <a href="#attach_49437"
               title="Go to the comment associated with the attachment">2010-07-23 16:27 UTC</a>,

            <span class="vcard"><span class="fn">Eelko Berkenpies</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=49437&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=217464&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=217464&amp;action=enter">Add an attachment</a>
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=217464&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1477425084" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-05 17:52:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">Version:           0.2.90 (using 4.3.2 (KDE 4.3.2), Debian packages)
Compiler:          cc
OS:                Linux (x86_64) release 2.6.31-1-amd64

Rekonq is affected by a universal XSS and / or crash.  Opening a fresh instance of Rekonq and entering the following URL causes a crash:

<a href="http://thisdomainwillnotresolveandrekonqerrorpagewillbeshownwithfullurlembedded.twitter.com/">http://thisdomainwillnotresolveandrekonqerrorpagewillbeshownwithfullurlembedded.twitter.com/</a>&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;

However, if you enter this into a new tab on an existing instance of Rekonq then it will first try and resolve the hostname and then when that fails it will display an error message.  The error message output by Rekonq includes the full URL, including the &lt;script&gt; tags.  Since Rekonq see that the requested URL is part of *.twitter.com and since twitter.com sets wildcard domain'd cookies, the error page will be able to access any cookies that have been set.  Note that this is not unique to twitter.com, cookies can be stole for any site that sets wildcard domain'd cookies.

There are therefore 3 issues:

1) Crash on fresh instance
2) Injection of malicious content into error message
3) Access to cookies when the hostname under which the cookies have been set was not accessible

I believe the root cause of 2 is:

rekonq-mainline/src/webpage.cpp:    msg += &quot;&lt;h2&gt;&quot; + i18nc(&quot;%1=an URL, e.g.'kde.org'&quot;, &quot;When connecting to: %1&quot;, reply-&gt;url().toString()) + &quot;&lt;/h2&gt;&quot;;

Note that there is no sanitisation of reply-&gt;url().toString()!  I haven't investigated the others in any depth but I will update the bug with a stack trace for 1 shortly.</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-05 17:58:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Application: rekonq (rekonq), signal: Segmentation fault
[Current thread is 1 (Thread 0x7f2b122b6750 (LWP 3613))]

Thread 3 (Thread 0x7f2af75e1910 (LWP 3614)):
#0  pthread_cond_wait&#64;&#64;GLIBC_2.3.2 () at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S:261
#1  0x00007f2b0ec29499 in QWaitCondition::wait(QMutex*, unsigned long) () from /usr/lib/libQtCore.so.4
#2  0x00007f2b113e54ce in ?? () from /usr/lib/libQtWebKit.so.4
#3  0x00007f2b113e5647 in ?? () from /usr/lib/libQtWebKit.so.4
#4  0x00007f2b10ef489b in ?? () from /usr/lib/libQtWebKit.so.4
#5  0x00007f2b0ec284a5 in ?? () from /usr/lib/libQtCore.so.4
#6  0x00007f2b0d08673a in start_thread (arg=&lt;value optimized out&gt;) at pthread_create.c:300
#7  0x00007f2b0d57e69d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#8  0x0000000000000000 in ?? ()

Thread 2 (Thread 0x7f2af6de0910 (LWP 3618)):
#0  pthread_cond_timedwait&#64;&#64;GLIBC_2.3.2 () at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_timedwait.S:220
#1  0x00007f2b0ec29477 in QWaitCondition::wait(QMutex*, unsigned long) () from /usr/lib/libQtCore.so.4
#2  0x00007f2b0ec1f2d1 in ?? () from /usr/lib/libQtCore.so.4
#3  0x00007f2b0ec284a5 in ?? () from /usr/lib/libQtCore.so.4
#4  0x00007f2b0d08673a in start_thread (arg=&lt;value optimized out&gt;) at pthread_create.c:300
#5  0x00007f2b0d57e69d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#6  0x0000000000000000 in ?? ()
The current source language is &quot;auto; currently asm&quot;.

Thread 1 (Thread 0x7f2b122b6750 (LWP 3613)):
[KCrash Handler]
#5  0x00007f2b112be094 in ?? () from /usr/lib/libQtWebKit.so.4
#6  0x00007f2b112be952 in ?? () from /usr/lib/libQtWebKit.so.4
#7  0x00007f2b1100b26f in ?? () from /usr/lib/libQtWebKit.so.4
#8  0x00007f2b11000db0 in ?? () from /usr/lib/libQtWebKit.so.4
#9  0x00007f2b1100360a in ?? () from /usr/lib/libQtWebKit.so.4
#10 0x00007f2b11003dc8 in ?? () from /usr/lib/libQtWebKit.so.4
#11 0x00007f2b111e78dd in ?? () from /usr/lib/libQtWebKit.so.4
#12 0x00007f2b111e9836 in ?? () from /usr/lib/libQtWebKit.so.4
#13 0x00007f2b111e9fc7 in ?? () from /usr/lib/libQtWebKit.so.4
#14 0x00007f2b111ea0e9 in ?? () from /usr/lib/libQtWebKit.so.4
#15 0x00007f2b11397d7f in ?? () from /usr/lib/libQtWebKit.so.4
#16 0x00007f2b1139dd39 in QWebPage::event(QEvent*) () from /usr/lib/libQtWebKit.so.4
#17 0x00007f2b1139fc18 in QWebView::mouseMoveEvent(QMouseEvent*) () from /usr/lib/libQtWebKit.so.4
#18 0x00007f2b0e1d7218 in QWidget::event(QEvent*) () from /usr/lib/libQtGui.so.4
#19 0x00007f2b113a01ff in QWebView::event(QEvent*) () from /usr/lib/libQtWebKit.so.4
#20 0x00007f2b0e18701d in QApplicationPrivate::notify_helper(QObject*, QEvent*) () from /usr/lib/libQtGui.so.4
#21 0x00007f2b0e18f7ca in QApplication::notify(QObject*, QEvent*) () from /usr/lib/libQtGui.so.4
#22 0x00007f2b104d60db in KApplication::notify(QObject*, QEvent*) () from /usr/lib/libkdeui.so.5
#23 0x00007f2b0ed0dc9c in QCoreApplication::notifyInternal(QObject*, QEvent*) () from /usr/lib/libQtCore.so.4
#24 0x00007f2b0e18ea78 in QApplicationPrivate::sendMouseEvent(QWidget*, QMouseEvent*, QWidget*, QWidget*, QWidget**, QPointer&lt;QWidget&gt;&amp;) () from /usr/lib/libQtGui.so.4
#25 0x00007f2b0e18ef9b in QApplicationPrivate::sendSyntheticEnterLeave(QWidget*) () from /usr/lib/libQtGui.so.4
#26 0x00007f2b0e1d57ae in QWidgetPrivate::hideChildren(bool) () from /usr/lib/libQtGui.so.4
#27 0x00007f2b0e1d5771 in QWidgetPrivate::hideChildren(bool) () from /usr/lib/libQtGui.so.4
#28 0x00007f2b0e1d5771 in QWidgetPrivate::hideChildren(bool) () from /usr/lib/libQtGui.so.4
#29 0x00007f2b0e1d5915 in QWidgetPrivate::hide_helper() () from /usr/lib/libQtGui.so.4
#30 0x00007f2b0e1dc860 in QWidget::setVisible(bool) () from /usr/lib/libQtGui.so.4
#31 0x00007f2b1130e028 in ?? () from /usr/lib/libQtWebKit.so.4
#32 0x00007f2b1100fad5 in ?? () from /usr/lib/libQtWebKit.so.4
#33 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#34 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#35 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#36 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#37 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#38 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#39 0x00007f2b10fcd5a4 in ?? () from /usr/lib/libQtWebKit.so.4
#40 0x00007f2b10fdd503 in ?? () from /usr/lib/libQtWebKit.so.4
#41 0x00007f2b111ef06d in ?? () from /usr/lib/libQtWebKit.so.4
#42 0x00007f2b1118cfc2 in ?? () from /usr/lib/libQtWebKit.so.4
#43 0x00007f2b11389011 in ?? () from /usr/lib/libQtWebKit.so.4
#44 0x00007f2b11184adc in ?? () from /usr/lib/libQtWebKit.so.4
#45 0x00007f2b11188311 in ?? () from /usr/lib/libQtWebKit.so.4
#46 0x00007f2b1116aacf in ?? () from /usr/lib/libQtWebKit.so.4
#47 0x00007f2b1116af30 in ?? () from /usr/lib/libQtWebKit.so.4
#48 0x00007f2b111a3339 in ?? () from /usr/lib/libQtWebKit.so.4
#49 0x00007f2b1119b52e in ?? () from /usr/lib/libQtWebKit.so.4
#50 0x00007f2b1119d9e7 in ?? () from /usr/lib/libQtWebKit.so.4
#51 0x00007f2b1119dd76 in ?? () from /usr/lib/libQtWebKit.so.4
#52 0x00007f2b1119d1ba in ?? () from /usr/lib/libQtWebKit.so.4
#53 0x00007f2b1119bde9 in ?? () from /usr/lib/libQtWebKit.so.4
#54 0x00007f2b1119c5af in ?? () from /usr/lib/libQtWebKit.so.4
#55 0x00007f2b1119c795 in ?? () from /usr/lib/libQtWebKit.so.4
#56 0x00007f2b1119e1de in ?? () from /usr/lib/libQtWebKit.so.4
#57 0x00007f2b1116b2ff in ?? () from /usr/lib/libQtWebKit.so.4
#58 0x00007f2b11173530 in ?? () from /usr/lib/libQtWebKit.so.4
#59 0x00007f2b1117ed95 in ?? () from /usr/lib/libQtWebKit.so.4
#60 0x00007f2b1117edde in ?? () from /usr/lib/libQtWebKit.so.4
#61 0x00007f2b11177701 in ?? () from /usr/lib/libQtWebKit.so.4
#62 0x00007f2b1117d7b3 in ?? () from /usr/lib/libQtWebKit.so.4
#63 0x00007f2b1117d963 in ?? () from /usr/lib/libQtWebKit.so.4
#64 0x00007f2b1117da29 in ?? () from /usr/lib/libQtWebKit.so.4
#65 0x00007f2b11395da0 in QWebFrame::setHtml(QString const&amp;, QUrl const&amp;) () from /usr/lib/libQtWebKit.so.4
#66 0x000000000047caa7 in _start ()
The current source language is &quot;auto; currently c&quot;.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-05 22:18:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Looks like QtDemoBrowser is also affected and is more than likely the original source of the bug:

demos/browser/webview.cpp:

    QFile file(QLatin1String(&quot;:/notfound.html&quot;));
    bool isOpened = file.open(QIODevice::ReadOnly);
    Q_ASSERT(isOpened);
    Q_UNUSED(isOpened)

    QString title = tr(&quot;Error loading page: %1&quot;).arg(reply-&gt;url().toString());
    QString html = QString(QLatin1String(file.readAll()))
                        .arg(title)
                        .arg(reply-&gt;errorString())
                        .arg(reply-&gt;url().toString());</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dawit Alemayehu</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-05 22:40:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">SVN commit 1059140 by adawit:

Do not fall for XSS tricks when loading error pages.
Escaping the output of KUrl::prettyUrl might be sufficient for
khtml, but it does not work for webkit.

NOTE: This only fixes the issue in kwebkitpart, no where else.

CCBUG: 217464


 M  +1 -1      webkitpart.cpp  


WebSVN link: <a href="http://websvn.kde.org/?view=rev&amp;revision=1059140">http://websvn.kde.org/?view=rev&amp;revision=1059140</a></pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-06 13:36:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">This line from Rekonq's webview.cpp is also problematic:

msg += &quot;&lt;input type=\&quot;button\&quot; id=\&quot;reloadButton\&quot; onClick=\&quot;document.location.href='&quot; + reply-&gt;url().path() + &quot;';\&quot; value=\&quot;&quot;;</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrea Diamantini</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-07 13:17:14 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=217464#c0">comment #0</a>)
<span class="quote">&gt; Rekonq is affected by a universal XSS and / or crash.  Opening a fresh instance
&gt; of Rekonq and entering the following URL causes a crash:
&gt; 
&gt; <a href="http://thisdomainwillnotresolveandrekonqerrorpagewillbeshownwithfullurlembedded.twitter.com/">http://thisdomainwillnotresolveandrekonqerrorpagewillbeshownwithfullurlembedded.twitter.com/</a>&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
&gt; 
&gt; However, if you enter this into a new tab on an existing instance of Rekonq
&gt; then it will first try and resolve the hostname and then when that fails it
&gt; will display an error message.  The error message output by Rekonq includes the
&gt; full URL, including the &lt;script&gt; tags.  Since Rekonq see that the requested URL
&gt; is part of *.twitter.com and since twitter.com sets wildcard domain'd cookies,
&gt; the error page will be able to access any cookies that have been set.  Note
&gt; that this is not unique to twitter.com, cookies can be stole for any site that
&gt; sets wildcard domain'd cookies.
&gt; 
&gt; There are therefore 3 issues:
&gt; 
&gt; 1) Crash on fresh instance
&gt; 2) Injection of malicious content into error message
&gt; 3) Access to cookies when the hostname under which the cookies have been set
&gt; was not accessible</span >

First of all, thanks for pointing out the issue :)
I'm having here some different behaviour, anyway.
1) rekonq no more crashes (master, rekonq 0.3.19)
2) present
3) uhm... &quot;quite present&quot;

I'm following your suggestions to fix #2 and investigating about #3.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-07 13:25:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">Qt specific elements of this bug are being tracked at:

<a href="http://bugreports.qt.nokia.com/browse/QTWEBKIT-22">http://bugreports.qt.nokia.com/browse/QTWEBKIT-22</a></pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-08 00:48:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">At the Trolls request, tracking of Qt specific elements of this bug have been moved to:

<a href="https://bugs.webkit.org/show_bug.cgi?id=32252">https://bugs.webkit.org/show_bug.cgi?id=32252</a></pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Panagiotis Papadopoulos</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-05 16:55:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">no crash here with Qt 4.6.1. Entering the URL above throws me an error dialog, telling me that the URL is not valid. Should we close this bug?</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 11:44:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">Possibly, I would need to build rekonq from git to confirm.  I've seen the changes but I don't know Qt well enough to give you a guaranteed answer without checking.  Unfortunately, Qt in Debian hasn't quite caught up with where Rekonq is at, so for now I can't build it :(.

I have also found further cases of XSS.  When you open a new tab you get a tool bar with favourites, bookmarks, closed tabs and history.  These &quot;about:&quot; views are rendered using webkit's HTML rendering engine and can therefore be used to execute injected Javascript.  For example any HTML including script tags in the title of the page, or the URL will be rendered.  Luckily document.domain for these is not set, so the associated risk is less severe, but still.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrea Diamantini</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-04-13 12:09:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Seems fixed now.
rekonq 0.4.60
kde 4.4 compiled from branches
qtwebkit 2.0</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-14 18:02:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Still a problem even on 0.5.  Enter:

<a href="http://wwwmail.google.com/">http://wwwmail.google.com/</a>&quot;&gt;&lt;script&gt;document.body.innerHTML='&lt;h1&gt;Welcome to Google.com&lt;/h1&gt;Username: &lt;input type=&quot;username&quot; name=&quot;text&quot;&gt;Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;'&lt;/script&gt;

into your URL bar and hit enter.  The full URL submitted is used as part of the error page for the &quot;Try again&quot; button.  The good news is that this time, I don't appear to have access to the cookies for the domain this time but as you can see it's still possible to spoof up legitimate loooking URLs.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tim Brown</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-21 20:20:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">As discussed in #rekonq, a CVE has been requested and assigned: CVE-2010-2536</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eelko Berkenpies</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-23 16:27:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=49437" name="attach_49437" title="Removes path from URL on error page">attachment 49437</a> <a href="attachment.cgi?id=49437&amp;action=edit" title="Removes path from URL on error page">[details]</a></span>
Removes path from URL on error page

The attached (simple) patch produces a more firefox-like error page and removes the path from the URL, preventing any (XSS) code into being included into the error page.

Please correct me if I'm wrong. :)</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrea Diamantini</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-02 00:53:52 UTC
        </span>

      </div>




<pre class="bz_comment_text">commit 1fd48c700abb6d7ff56fded1e39a1418cc573216
Author: Andrea Diamantini &lt;<a href="mailto:adjam7&#64;gmail.com">adjam7&#64;gmail.com</a>&gt;
Date:   Sat Jul 31 01:08:41 2010 +0200

    Applying Eelko's patch against XSS vulnerability
    
    Are we yet vulnerable?
    
    CCBUG:217464

diff --git a/src/webpage.cpp b/src/webpage.cpp
index a63940b..ea2add6 100644
--- a/src/webpage.cpp
+++ b/src/webpage.cpp
&#64;&#64; -577,8 +577,8 &#64;&#64; QString WebPage::errorPage(QNetworkReply *reply)
         return QString(&quot;Couldn't open the rekonqinfo.html file&quot;);
     }
 
-    QString title = i18n(&quot;Error loading: %1&quot;, reply-&gt;url().toString());
-    QString urlString = reply-&gt;url().toString(QUrl::RemoveUserInfo | QUrl::RemoveQuery);
+    QString title = i18n(&quot;There was a problem while loading the page&quot;);
+    QString urlString = reply-&gt;url().toString(QUrl::RemoveUserInfo | QUrl::RemoveQuery | QUrl::RemovePath);
 
     QString iconPath = QString(&quot;file://&quot;) + KIconLoader::global()-&gt;iconPath(&quot;dialog-warning&quot; , KIconLoader::Small);
     iconPath.replace(QL1S(&quot;16&quot;), QL1S(&quot;128&quot;));</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Panagiotis Papadopoulos</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-31 14:11:17 UTC
        </span>

      </div>




<pre class="bz_comment_text"><a href="http://packetstormsecurity.org/filedesc/NDSA20100810.txt.html">http://packetstormsecurity.org/filedesc/NDSA20100810.txt.html</a>
<a href="http://packetstormsecurity.org/1008-exploits/NDSA20100810.txt">http://packetstormsecurity.org/1008-exploits/NDSA20100810.txt</a>

What’s the status of this bug?</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrea Diamantini</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-10-12 18:06:01 UTC
        </span>

      </div>




<pre class="bz_comment_text">commit 68330c38941be0246716c8035a010d082cf16a9d
Author: Andrea Diamantini &lt;<a href="mailto:adjam7&#64;gmail.com">adjam7&#64;gmail.com</a>&gt;
Date:   Tue Oct 12 18:08:03 2010 +0200

    This change to be sure universal XSS bug has been fixed.
    Anyway, from Eelko's patch on, this was no more reproducible, so... :)
    
    Does the CVE request need to be updated??
    
    CCBUG:217464
    CCMAIL:<a href="mailto:tampakrap&#64;gmail.com">tampakrap&#64;gmail.com</a>

diff --git a/src/webpage.cpp b/src/webpage.cpp
index d481567..61c6a32 100644
--- a/src/webpage.cpp
+++ b/src/webpage.cpp
&#64;&#64; -68,6 +68,9 &#64;&#64;
 
 // Qt Includes
 #include &lt;QtCore/QFileInfo&gt;
+
+#include &lt;QtGui/QTextDocument&gt;
+
 #include &lt;QtDBus/QDBusConnection&gt;
 #include &lt;QtDBus/QDBusConnectionInterface&gt;
 #include &lt;QtDBus/QDBusInterface&gt;
&#64;&#64; -599,7 +602,10 &#64;&#64; QString WebPage::errorPage(QNetworkReply *reply)
     }
 
     QString title = i18n(&quot;There was a problem while loading the page&quot;);
-    QString urlString = reply-&gt;url().toString(QUrl::RemoveUserInfo | QUrl::RemoveQuery | QUrl::RemovePath);
+    
+    // NOTE: 
+    // this, to be sure <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Universal XSS"
   href="show_bug.cgi?id=217464">BUG 217464</a> (Universal XSS) has been fixed..
+    QString urlString = Qt::escape(reply-&gt;url().toString(QUrl::RemoveUserInfo | QUrl::RemoveQuery | QUrl::RemovePath));
 
     QString iconPath = QString(&quot;file://&quot;) + KIconLoader::global()-&gt;iconPath(&quot;dialog-warning&quot; , KIconLoader::Small);
     iconPath.replace(QL1S(&quot;16&quot;), QL1S(&quot;128&quot;));</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=217464#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrea Diamantini</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-24 22:44:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">Git commit 1d83ce109628cf28269a849abec9786b9e920c39 by Andrea Diamantini.
Pushed by adjam into branch 'master'.

This evening I started working again on this bug. I did all the tests against XSS
and it seems ok. Hope it's true.

CCBUG:217464
CCBUG:246355

M  +7    -4    src/webpage.cpp     

<a href="http://commits.kde.org/rekonq/1d83ce109628cf28269a849abec9786b9e920c39">http://commits.kde.org/rekonq/1d83ce109628cf28269a849abec9786b9e920c39</a></pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=217464">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=217464">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=217464">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=217464&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=217464" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=217464&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619429-6Hg5LBSNM6gPZ34r3LG2DcJWB5DL5rt4fHfXCbIMm-Q">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>