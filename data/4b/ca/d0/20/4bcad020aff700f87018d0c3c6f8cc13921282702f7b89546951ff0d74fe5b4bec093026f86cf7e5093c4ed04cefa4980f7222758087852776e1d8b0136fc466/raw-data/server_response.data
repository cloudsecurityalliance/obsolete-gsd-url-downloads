-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Tue Mar  2 09:31:41 CST 2010
| Updated: Mon Mar 29 13:09:51 CDT 2010
| Added VIOS information
| Fixed prerequisite levels

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/xntpd_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX xntpd denial-of-service vulnerability

PLATFORMS:       AIX 5.3, 6.1, and earlier releases
|                VIOS 1.5, 2.1, and earlier releases

SOLUTION:        Apply the fix or workaround as described below.

THREAT:          A remote, unauthenticated attacker may be able to
                 cause a denial-of-service condition on a vulnerable
                 NTP server.

CERT VU Number:  568372
CVE Number:      CVE-2009-3563

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   NO
Protected by SED?   NO

                           DETAILED INFORMATION

I. DESCRIPTION (from US-CERT)

    "NTP mode 7 (MODE_PRIVATE) is used by the ntpdc query and control
    utility. In contrast, ntpq uses NTP mode 6 (MODE_CONTROL), while
    routine NTP time transfers use modes 1 through 5. Upon receipt of
    an incorrect mode 7 request or a mode 7 error response from an
    address that is not listed in a "restrict ... noquery" or
    "restrict ... ignore" segment, ntpd will reply with a mode 7 error
    response and log a message."

    "If an attacker spoofs the source address of ntpd host A in a mode
    7 response packet sent to ntpd host B, both A and B will
    continuously send each other error responses, for as long as those
    packets get through."

    "If an attacker spoofs an address of ntpd host A in a mode 7
    response packet sent to ntpd host A, then host A will respond to
    itself endlessly, consuming CPU and logging excessively."

    Please see the following for more information:

    http://www.kb.cert.org/vuls/id/568372
    http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3563

II. PLATFORM VULNERABILITY ASSESSMENT

|   Note: To use the following commands on VIOS you must first
|   execute:

|   oem_setup_env

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.net.tcp.client

    The following fileset levels are vulnerable:

    AIX Fileset        Lower Level       Upper Level
    ------------------------------------------------
|   bos.net.tcp.client 5.3.8.0           5.3.8.11
|   bos.net.tcp.client 5.3.9.0           5.3.9.7
|   bos.net.tcp.client 5.3.10.0          5.3.10.2
|   bos.net.tcp.client 5.3.11.0          5.3.11.2
|   bos.net.tcp.client 6.1.4.0           6.1.4.3
|   bos.net.tcp.client 6.1.1.0           6.1.1.7
|   bos.net.tcp.client 6.1.2.0           6.1.2.6
|   bos.net.tcp.client 6.1.3.0           6.1.3.3

III. SOLUTION

    A. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/xntpd_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

|       AIX Level    VIOS Level       Fix
        -------------------------------------------------------------------
|       5.3.8        1.5.2            IZ68659_08.100329.epkg.Z
|       5.3.9                         IZ71093_09.100329.epkg.Z
|       5.3.10                        IZ71608_10.100329.epkg.Z
|       5.3.11                        IZ71610_11.100329.epkg.Z
        6.1.1                         IZ71611_01.100302.epkg.Z
|       6.1.2        2.1.0            IZ71613_02.100302.epkg.Z
|       6.1.3        2.1.1            IZ71614_03.100302.epkg.Z
|       6.1.4        2.1.2            IZ71071_04.100302.epkg.Z

        To extract the fixes from the tar file:

        tar xvf xntpd_fix.tar
        cd xntpd_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
|       91840ff2428fbec53effd26b200ae51a312dea5f  IZ68659_08.100329.epkg.Z
        d1e7d116d3e94c4e6927e42021fa251ae48cf579  IZ71071_04.100302.epkg.Z
|       9f353343cc3a12eb5e87826ca4622c5babb40903  IZ71093_09.100329.epkg.Z
|       d71db135676b701ad87d3c3954bf6656e47fffba  IZ71608_10.100329.epkg.Z
|       58bef50778cf5c4d3b7b39dfdaf11d0d7706894b  IZ71610_11.100329.epkg.Z
        688bf77366a0662461c9ce6de779c2632370274f  IZ71611_01.100302.epkg.Z
        8826b6f6d788ab5f79dd40935297b4dba2c483d8  IZ71613_02.100302.epkg.Z
        30a25237fcc64a4a7f3f734ed72faedad41c2097  IZ71614_03.100302.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following address:

            security-alert@austin.ibm.com

     B. FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        Fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview fix installation:

        emgr -e fix_name -p         # where fix_name is the name of the  
                                    # fix being previewed.

        To install fix package:

        emgr -e fix_name -X         # where fix_name is the name of the  
                                    # fix being installed.

        IMPORTANT: The fix will not take affect until any running xntpd
        servers have been stopped and restarted with the following
        commands:
 
        stopsrc -s xntpd
        startsrc -s xntpd

    C. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Service pack date
        --------------------------------------------------------
        5.3.8               IZ68659            5/19/10 sp10
        5.3.9               IZ71093            5/19/10 sp7
        5.3.10              IZ71608            5/19/10 sp4
        5.3.11              IZ71610            5/19/10 sp4
        6.1.1               IZ71611            4/21/10 sp8
        6.1.2               IZ71613            4/21/10 sp7
        6.1.3               IZ71614            4/21/10 sp4
        6.1.4               IZ71071            4/21/10 sp4

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ68659
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71093
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71608
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71610
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71611
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71613
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71614
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71071

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the service
        pack when it becomes available.

IV. WORKAROUND

    Remove the entry for xntpd from /etc/rc.tcpip and stop the current
    instance of xntpd.  This can be done by running the following
    command:

    /usr/sbin/chrctcp -S -d xntpd

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:

        A. Send an email with "get key" in the subject line to:

            security-alert@austin.ibm.com

        B. Download the key from our web page:

  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt

        C. Download the key from a PGP Public Key Server. The key ID is:

            0xF3807ECD
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    This vulnerability was reported by Harlan Stenn.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFLsO55xvGNyvOAfs0RAhZGAJ9EXq8DmYANQNZCimDl5r8ANP1p0QCfRf8F
RrWm6uxP1vVOQIfZ6kV6/vU=
=wTDb
-----END PGP SIGNATURE-----
