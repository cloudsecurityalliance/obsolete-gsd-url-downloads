<!DOCTYPE html>
<html lang="en">
<head>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92665328-1"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'UA-92665328-1');
    </script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>[CVE-2016-10370] OnePlus OTA Lack of TLS Vulnerability</title>
<meta name="name" content="CVE-2016-10370">
<meta name="description" content="OnePlus OTA Lack of TLS Vulnerability">
<meta name="image" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@alephsecurity">
<meta name="twitter:creator" content="@alephsecurity">
<meta name="twitter:title" content="CVE-2016-10370">
<meta name="twitter:url" content="https://alephsecurity.com/vulns/aleph-2017022">
<meta name="twitter:description" content="OnePlus OTA Lack of TLS Vulnerability">
<meta name="twitter:image:src" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta property="og:site_name" content="">
<meta property="og:title" content="CVE-2016-10370">
<meta property="og:type" content="article">
<meta property="og:description" content="OnePlus OTA Lack of TLS Vulnerability">
<meta property="og:url" content="https://alephsecurity.com/vulns/aleph-2017022">
<meta property="article:published_time" content="2017-05-11T00:00:00+00:00">
<meta property="article:author" content="https://alephsecurity.com">
<meta property="og:image" content="https://alephsecurity.com/assets/img/logo-black.png">
<link rel="icon" href="/favicon.png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
<link rel="stylesheet" type="text/css" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      messageStyle: "none",
      tex2jax: {preview: "none"},
      CommonHTML: { linebreaks: { automatic: true } },
      "HTML-CSS": { linebreaks: { automatic: true } },
      SVG: { linebreaks: { automatic: true } }
    });
    </script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
<div class="wrapper">
<div class="page__back">
<a href="/">&lt;-- <span class="smallogo">◊ê</span></a>
</div>
<div class="page">
<div class="advisory">
<div class="advisory__title">
<h1>OnePlus OTA Lack of TLS Vulnerability</h1>
</div>
<div class="advisory__subtitle">
Aleph Research Advisory
</div>
<div class="advisory__meta">
<p></p>
</div>
<h2>Identifier</h2>
<div class="cve-high"><span class="" title="OnePlus OTA Lack of TLS Vulnerability"><a href="/vulns/aleph-2017022">CVE-2016-10370</a></span></div>
<h2>Severity</h2>
High
<h2>Summary</h2>
<div class="advisory__content" ?>
<p>The OnePlus OTA Updater pushes the signed-OTA image over HTTP without TLS. While it does not allow for installation of arbitrary OTAs (due to the digital signature), it unnecessarily increases the attack surface, and allows for remote exploitation of other vulnerabilities such as <span class="cve-critical" title="OnePlus OTA Downgrade Vulnerability"><a href="/vulns/aleph-2017008">CVE-2017-5948</a></span>, <span class="cve-critical" title="OnePlus OTA OxygenOS/HydrogenOS Crossover Vulnerability"><a href="/vulns/aleph-2017020">CVE-2017-8850</a></span> &amp; <span class="cve-high" title="OnePlus OTA One/X Crossover Vulnerability"><a href="/vulns/aleph-2017021">CVE-2017-8851</a></span>.</p>
</div>
<h2>Technical Details</h2>
<div class="advisory__content" ?>
<p>OxygenOS &amp; HydrogenOS send the following JSON request to <code class="language-plaintext highlighter-rouge">http://otac.h2os.com/post/Query_Update</code> or to <code class="language-plaintext highlighter-rouge">http://i.ota.coloros.com/post/Query_Update</code> in order to check if a new OTA is available:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"beta"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"imei"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;IMEI&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"isOnePlus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ONEPLUS A3010"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ota_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;CURRENT_VERSION&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>For example, on a OnePlus 3T device running OxygenOS 4.1.1 this results in the following response, announcing that a 4.1.3 OTA is available:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"active_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://otafsc1.h2os.com/patch/amazone2/GLO/OnePlus3TOxygen/OnePlus3TOxygen_28.A.51_GLO_051_1704112011/OnePlus3TOxygen_28_OTA_051_all_1704112011_d6f79637e1c.zip"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://otafsc.h2os.com/html/GLO/OnePlus3TOxygen/OnePlus3TOxygen_28.A.51_GLO_051_1704112011_version_EN_1492072442240.html"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"down_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://otafsc.h2os.com/patch/amazone2/GLO/OnePlus3TOxygen/OnePlus3TOxygen_28.A.51_GLO_051_1704112011/OnePlus3TOxygen_28_OTA_051_all_1704112011_d6f79637e1c.zip"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"extract"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#OS Version: OnePlus3TOxygen_28_170411</span><span class="se">\n</span><span class="s2">##WHAT'S NEW</span><span class="se">\n\\\n\u</span><span class="s2">2022 Upgraded Android 7.1.1 </span><span class="se">\n\\\n\u</span><span class="s2">2022 Added expanded screenshots </span><span class="se">\n\\\n\u</span><span class="s2">2022 Improved picture taking of moving objects</span><span class="se">\n</span><span class="s2">  with blur reduction </span><span class="se">\n\\\n\u</span><span class="s2">2022
Improved video stability when recording</span><span class="se">\n\\\n\u</span><span class="s2">2022 Improved WiFI connectivity </span><span class="se">\u</span><span class="s2">00a0</span><span class="se">\n\\\n\u</span><span class="s2">2022 Improved bluetooth connectivity </span><span class="se">\n\\\n\u</span><span class="s2">2022 Fixed Instagram swiping bug</span><span class="se">\n\\\n\u</span><span class="s2">2022 Fixed hardware
buttons</span><span class="se">\u</span><span class="s2">00a0malfunction</span><span class="se">\u</span><span class="s2">00a0bug</span><span class="se">\n\\\n\u</span><span class="s2">2022 Increased system stability</span><span class="se">\n\\\n\u</span><span class="s2">2022 General bug fixes</span><span class="se">\n</span><span class="s2">  [www.oneplus.net](http://www.oneplus.net/)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"new_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OnePlus3TOxygen_28.A.51_GLO_051_1704112011"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"patchFilePath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/patch/amazone2/GLO/OnePlus3TOxygen/OnePlus3TOxygen_28.A.51_GLO_051_1704112011/OnePlus3TOxygen_28_OTA_051_all_1704112011_d6f79637e1c.zip"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"patch_md5"</span><span class="p">:</span><span class="w"> </span><span class="s2">"031507863135b7008c2651ea461d0e9e"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"patch_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OnePlus3TOxygen_28_OTA_051_all_1704112011_d6f79637e1c.zip"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"patch_size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1461187808"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"recommend"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"share"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">8bf7</span><span class="se">\u</span><span class="s2">7528</span><span class="se">\u</span><span class="s2">82f1</span><span class="se">\u</span><span class="s2">8bed</span><span class="se">\u</span><span class="s2">8bbe</span><span class="se">\u</span><span class="s2">7f6e</span><span class="se">\u</span><span class="s2">5206</span><span class="se">\u</span><span class="s2">4eab</span><span class="se">\u</span><span class="s2">5185</span><span class="se">\u</span><span class="s2">5bb9"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"version_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OnePlus3TOxygen_28_1704112011"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"wipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Man-in-the-Middle attackers can therefore spoof this response in order to exploit <span class="cve-critical" title="OnePlus OTA Downgrade Vulnerability"><a href="/vulns/aleph-2017008">CVE-2017-5948</a></span>, <span class="cve-critical" title="OnePlus OTA OxygenOS/HydrogenOS Crossover Vulnerability"><a href="/vulns/aleph-2017020">CVE-2017-8850</a></span> &amp; <span class="cve-high" title="OnePlus OTA One/X Crossover Vulnerability"><a href="/vulns/aleph-2017021">CVE-2017-8851</a></span>.</p>
<p>PoC can be found <a href="https://github.com/alephsecurity/research/tree/master/OnePlusOTA">here</a>.</p>
</div>
<h2>Timeline</h2>
<div class="list"><ul><li><div class="list__date"><span>11-May-17<span></div>: Public disclosure.</li><li><div class="list__date"><span>10-May-17<span></div>: Deadline Extension.</li><li><div class="list__date"><span>08-May-17<span></div>: <span class="cve-high" title="OnePlus OTA Lack of TLS Vulnerability"><a href="/vulns/aleph-2017022">CVE-2016-10370</a></span> assigned.</li><li><div class="list__date"><span>08-May-17<span></div>: CVE ID requested.</li><li><div class="list__date"><span>08-May-17<span></div>: Added as <span class="cve-high" title="OnePlus OTA Lack of TLS Vulnerability"><a href="/vulns/aleph-2017022">ALEPH-2017022</a></span>.</li><li><div class="list__date"><span>26-Apr-17<span></div>: Deadline.</li><li><div class="list__date"><span>09-Apr-17<span></div>: 14-day Deadline Extension Offered (no reply).</li><li><div class="list__date"><span>26-Jan-17<span></div>: Reported.</li></ul></div>
<h2>Posts</h2>
<div class="pagelist__narrow"><ul> <li onclick="javscript:document.location.href='/2017/05/11/oneplus-ota/'"> <a href="/2017/05/11/oneplus-ota/">OnePlus OTAs: Analysis & Exploitation </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a>, <div class="pagelist__date"><span>11-May 2017</span></div></div></li> </ul></div>
<h2>Credit</h2>
<div class="list">
<ul>

<li>
<a href="https://sagi.io/">Sagi Kedmi</a> (<a href="https://twitter.com/sagikedmi">@sagikedmi</a>)
</li>
</ul>
</div>
<h2>External References</h2>
<div class="numberedlist">
<ol>
<li>
<a href="https://forums.oneplus.net/threads/ota-and-imei-over-http.453992/">OTA and IMEI over HTTP</a>
</li>
</ol>
</div>
</div>
</div>
</div>
</body>
</html>
