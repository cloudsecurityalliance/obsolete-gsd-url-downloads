<!DOCTYPE html>
<html lang="en">
  <head>
    <title>721570 &ndash; net-vpn/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/1dee87cdc229fb032852e53a39a3c8b5.css?1635279638" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1635279638"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "721570 – net-vpn\/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so",
                             "show_bug.cgi?id=721570" );
        document.title = "721570 – net-vpn\/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "721570 – net-vpn\/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1635279638"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Gentoo's Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico"><script language="JavaScript" src="extensions/Gentoo/web/gentoo.js"></script>
  </head>

  <body 
        class="bugs-gentoo-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Gentoo_Linux
                 bz_component_Current_packages
                 bz_bug_721570 yui-skin-sam">
<div id="gentoo-bar">
	<a href="/" title="Go to the Gentoo Bugzilla homepage" class="home-link">
		<img src="extensions/Gentoo/web/gentoo_org.png" alt="Gentoo Websites Logo" />
	</a>

	<div>
		Go to: 
		<a href="https://www.gentoo.org/">Gentoo Home</a>
		<a href="https://www.gentoo.org/support/documentation/">Documentation</a>
		<a href="https://forums.gentoo.org/">Forums</a>
		<a href="https://www.gentoo.org/get-involved/mailing-lists/">Lists</a>
		<a href="/" class="active">Bugs</a>
		<a href="https://planet.gentoo.org/">Planet</a>
		<a href="https://www.gentoo.org/inside-gentoo/stores/">Store</a>
		<a href="https://wiki.gentoo.org/">Wiki</a>
		<strong><a href="https://www.gentoo.org/downloads/">Get Gentoo!</a></strong>
	</div>
</div>

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Gentoo's Bugzilla &ndash; Bug&nbsp;721570</span>

        <span id="subtitle" class="subheader">net-vpn/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so</span>

        <span id="information" class="header_addl_info">Last modified: 2020-05-12 17:29:38 UTC node [gannet]</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?format=guided">New</a>&ndash;<a href="enter_bug.cgi">[Ex]</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>
  <li><span class="separator">| </span><a href="https://wiki.gentoo.org/wiki/Foundation:Privacy_Policy">Privacy Policy</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=721570&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=721570" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=721570&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619197-p1cjlQ848bqiLvNgyvdqxS6KvLnPaJhTtoWV6qDLUI8">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body"><!--<div style="border: 1px solid #ebccd1; background-color: #f2dede; color: #a94442; padding: 0.4em; margin-bottom: 0.4em;">critical goes here ...</div>-->
<!--<div id="message">
Bugzilla DB migration completed. Please report issues to Infra team via email via infra@gentoo.org or IRC
</div>-->


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2020-05-12 17:29:38">
  <input type="hidden" name="id" value="721570">
  <input type="hidden" name="token" value="1635619197-paNuH4OFa3E8h9gQCRuPwxPbmdq8Fll2C4ct0WsBZ18">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=721570"><b>Bug&nbsp;721570</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">net-vpn/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span><span title="net-vpn/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so">net-vpn/ocserv-1.0.1: test failures on arm64 due to stack smashing detection ...
        </span>
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'net-vpn\/ocserv-1.0.1: test failures on arm64 due to stack smashing detection with LD_PRELOAD=libsocket_wrapper.so' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Gentoo Linux

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Gentoo Linux"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Current packages

  (<a href="buglist.cgi?component=Current%20packages&amp;product=Gentoo%20Linux&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">ARM64
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>Normal
       normal<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=721570#vote_721570">vote</a>)
  </span>
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Mike Gilbert</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'bug-wranglers\x40gentoo.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >TESTFAILURE

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
<a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - &lt;net-vpn/openconnect-8.09: MITM by mishandling of X509_check return values (CVE-2020-12105)"
   href="show_bug.cgi?id=719108">CVE-2020-12105</a> 
  </td>
  </tr>

    <tr>
      <th>&nbsp;</th>

      <td id="show_dependency_tree_or_graph">
        Show dependency <a href="showdependencytree.cgi?id=721570&amp;hide_resolved=1">tree</a>

      </td>
    </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2020-05-08 00:51 UTC by <span class="vcard"><span class="fn">Sam James</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2020-05-12 17:29 UTC
      (<a href="show_activity.cgi?id=721570">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>3 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="samba">samba</option>
                <option value="toolchain">toolchain</option>
                <option value="williamh">williamh</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ><ul class="bug_urls">
          <li><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - &lt;net-vpn/openconnect-8.09-r1: Buffer overflow in get_cert_name (CVE-2020-12823)"
   href="show_bug.cgi?id=722740">CVE-2020-12823</a>
          </li></ul>

</td>
    </tr> 
<tr>
      <th class="field_label  bz_hidden_field"
    id="field_label_cf_stabilisation_atoms">


  <a 
      title="Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_stabilisation_atoms"
  >Package list:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_stabilisation_atoms" >
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    <tr>
      <th class="field_label  bz_hidden_field"
    id="field_label_cf_runtime_testing_required">


  <a 
      title="Indicate if runtime testing is required for this stabilisation request, or if it is sufficient to stabilised with a build/tests/qa test."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_runtime_testing_required"
  >Runtime testing required:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_runtime_testing_required" >---

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=636780"
               title="View the content of the attachment">
          <b>test-suite.log</b></a>

          <span class="bz_attach_extra_info">
              (file_721570.txt,1.66 KB,
                text/plain)

            <br>
            <a href="#attach_636780"
               title="Go to the comment associated with the attachment">2020-05-08 00:51 UTC</a>,

            <span class="vcard"><span class="fn">Sam James</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=636780&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=636782"
               title="View the content of the attachment">
          <b>build.log</b></a>

          <span class="bz_attach_extra_info">
              (file_721570.txt,106.17 KB,
                text/plain)

            <br>
            <a href="#attach_636782"
               title="Go to the comment associated with the attachment">2020-05-08 00:52 UTC</a>,

            <span class="vcard"><span class="fn">Sam James</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=636782&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=636836"
               title="View the content of the attachment">
          <b>openconnect-8.06-get_cert_name-overflow.patch</b></a>

          <span class="bz_attach_extra_info">
              (openconnect-8.06-get_cert_name-overflow.patch,686 bytes,
                patch)

            <br>
            <a href="#attach_636836"
               title="Go to the comment associated with the attachment">2020-05-08 14:02 UTC</a>,

            <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=636836&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=636836&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=721570&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=721570&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=721570&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1635279621" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sam James</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-05-08 00:51:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=636780" name="attach_636780" title="test-suite.log">attachment 636780</a> [<a href="attachment.cgi?id=636780&amp;action=edit" title="test-suite.log">details</a>]</span>
test-suite.log

FAIL: test-pass-group-cert
==========================

Testing local backend with username-password and certificate...
Connecting to obtain cookie (without certificate)... ok
Connecting to obtain cookie - group1 (with certificate)... Failure: Could not connect with certificate!
FAIL test-pass-group-cert (exit status: 1)

FAIL: test-pass-group-cert-no-pass
==================================

Testing local backend with username-password and certificate...
Connecting to obtain cookie (without certificate)... ok
Connecting to obtain cookie - group1 (with certificate)... Failure: Could not connect with certificate!
FAIL test-pass-group-cert-no-pass (exit status: 1)


----
Portage 2.3.99 (python 3.7.7-final-0, default/linux/arm64/17.0, gcc-9.3.0, glibc-2.30-r8, 4.9.0-4-arm64 aarch64)
=================================================================
System uname: Linux-4.9.0-4-arm64-aarch64-with-gentoo-2.6
KiB Mem:   131544964 total, 115445756 free
KiB Swap:    3321056 total,   3321056 free
Timestamp of repository gentoo: Thu, 07 May 2020 22:35:12 +0000
sh bash 5.0_p17
ld GNU ld (Gentoo 2.33.1 p2) 2.33.1
ccache version 3.7.7 [disabled]
app-shells/bash:          5.0_p17::gentoo
dev-lang/perl:            5.30.1::gentoo
dev-lang/python:          2.7.18::gentoo, 3.6.10-r2::gentoo, 3.7.7-r2::gentoo, 3.8.2-r2::gentoo
dev-util/ccache:          3.7.7-r1::gentoo
dev-util/cmake:           3.14.6::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/openrc:          0.42.1::gentoo
sys-apps/sandbox:         2.13::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.16.1-r1::gentoo
sys-devel/binutils:       2.33.1-r1::gentoo
sys-devel/gcc:            9.3.0::gentoo
sys-devel/gcc-config:     2.2.1::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 5.4::gentoo (virtual/os-headers)
sys-libs/glibc:           2.30-r8::gentoo
Repositories:

gentoo
    location: /bound/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-metamanifest: yes
    sync-rsync-extra-opts:
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1

ACCEPT_KEYWORDS=&quot;arm64&quot;
ACCEPT_LICENSE=&quot;&#64;FREE&quot;
CBUILD=&quot;aarch64-unknown-linux-gnu&quot;
CFLAGS=&quot;-O2 -pipe -march=native -fdiagnostics-show-option -frecord-gcc-switches&quot;
CHOST=&quot;aarch64-unknown-linux-gnu&quot;
CONFIG_PROTECT=&quot;/etc /usr/share/config /usr/share/gnupg/qualified.txt /var/bind&quot;
CONFIG_PROTECT_MASK=&quot;/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.4/ext-active/ /etc/php/cgi-php7.4/ext-active/ /etc/php/cli-php7.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c&quot;
CXXFLAGS=&quot;-O2 -pipe -march=native&quot;
DISTDIR=&quot;/bound/distfiles&quot;
EMERGE_DEFAULT_OPTS=&quot;--keep-going --jobs=3&quot;
ENV_UNSET=&quot;DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR&quot;
FCFLAGS=&quot;-O2 -pipe -march=native&quot;
FEATURES=&quot;assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr&quot;
FFLAGS=&quot;-O2 -pipe -march=native&quot;
GENTOO_MIRRORS=&quot;<a href="http://distfiles.gentoo.org">http://distfiles.gentoo.org</a>&quot;
INSTALL_MASK=&quot;/usr/share/doc/*/*.pdf /usr/share/man/*/*&quot;
LANG=&quot;en_US.UTF-8&quot;
LDFLAGS=&quot;-Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu&quot;
MAKEOPTS=&quot;-j40&quot;
PKGDIR=&quot;/usr/portage/packages&quot;
PORTAGE_CONFIGROOT=&quot;/&quot;
PORTAGE_RSYNC_OPTS=&quot;--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git&quot;
PORTAGE_TMPDIR=&quot;/var/tmp&quot;
USE=&quot;acl arm64 berkdb bzip2 cli crypt dri fortran gdbm iconv ipv6 libtirpc ncurses nls nptl openmp pam pcre readline seccomp split-usr ssl tcpd unicode xattr zlib&quot; ADA_TARGET=&quot;gnat_2018&quot; APACHE2_MODULES=&quot;authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias&quot; CALLIGRA_FEATURES=&quot;karbon sheets words&quot; COLLECTD_PLUGINS=&quot;df interface irq load memory rrdtool swap syslog&quot; CPU_FLAGS_ARM=&quot;edsp thumb vfp vfpv3 vfpv4 vfp-d32 aes sha1 sha2 crc32 v4 v5 v6 v7 v8 thumb2&quot; ELIBC=&quot;glibc&quot; GPSD_PROTOCOLS=&quot;ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx&quot; INPUT_DEVICES=&quot;libinput&quot; KERNEL=&quot;linux&quot; LCD_DEVICES=&quot;bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text&quot; LIBREOFFICE_EXTENSIONS=&quot;presenter-console presenter-minimizer&quot; OFFICE_IMPLEMENTATION=&quot;libreoffice&quot; PHP_TARGETS=&quot;php7-2&quot; POSTGRES_TARGETS=&quot;postgres10 postgres11&quot; PYTHON_SINGLE_TARGET=&quot;python3_7&quot; PYTHON_TARGETS=&quot;python2_7 python3_7&quot; RUBY_TARGETS=&quot;ruby24 ruby25&quot; USERLAND=&quot;GNU&quot; VIDEO_CARDS=&quot;fbdev dummy v4l&quot; XTABLES_ADDONS=&quot;quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account&quot;
Unset:  CC, CPPFLAGS, CTARGET, CXX, LC_ALL, LINGUAS, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sam James</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-05-08 00:52:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=636782" name="attach_636782" title="build.log">attachment 636782</a> [<a href="attachment.cgi?id=636782&amp;action=edit" title="build.log">details</a>]</span>
build.log</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mike Gilbert</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 02:09:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">I cannot reproduce this.

Please edit tests/test-pass-group-cert, and remove the redirection(s) to /dev/null. Then run the test script manually and post the output.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sam James</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-05-08 02:27:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Mike Gilbert from <a href="show_bug.cgi?id=721570#c2">comment #2</a>)
<span class="quote">&gt; I cannot reproduce this.
&gt; 
&gt; Please edit tests/test-pass-group-cert, and remove the redirection(s) to
&gt; /dev/null. Then run the test script manually and post the output.</span >

# ./test-pass-group-cert
Testing local backend with username-password and certificate...
Connecting to obtain cookie (without certificate)... Server '127.0.0.2' requested Basic authentication which is disabled by default
Failed to obtain WebVPN cookie
ok
Connecting to obtain cookie - group1 (with certificate)... *** stack smashing detected ***: &lt;unknown&gt; terminated
./test-pass-group-cert: line 40: 70583 Aborted                 LD_PRELOAD=libsocket_wrapper.so /usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6551 --sslkey ./certs/user-group-key.pem -c ./certs/user-group-cert.pem -u test --servercert=d66b507ae074d03b02eafca40d35f87dd81049d3 --cookieonly
Failure: Could not connect with certificate!

# ./test-pass-group-cert-no-pass
Testing local backend with username-password and certificate...
Connecting to obtain cookie (without certificate)... Server '127.0.0.2' requested Basic authentication which is disabled by default
Failed to obtain WebVPN cookie
ok
Connecting to obtain cookie - group1 (with certificate)... *** stack smashing detected ***: &lt;unknown&gt; terminated
./test-pass-group-cert-no-pass: line 41: 70603 Aborted                 LD_PRELOAD=libsocket_wrapper.so /usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6555 --sslkey ./certs/user-group-key.pem -c ./certs/user-group-cert.pem -u test --servercert=d66b507ae074d03b02eafca40d35f87dd81049d3 --cookieonly
Failure: Could not connect with certificate!

----
Note that running w/o LD_PRELOAD runs without crashing

# /usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6555 --sslkey ./certs/user-group-key.pem -c ./certs/user-group-cert.pem -u test --servercert=d66b507ae074d03b02eafca40d35f87dd81049d3 --cookieonly
Failed to connect to host 127.0.0.2
Failed to open HTTPS connection to 127.0.0.2
Failed to obtain WebVPN cookie</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mike Gilbert</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 02:43:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">This is probably not a bug in openconnect or ocserv, so I am unblocking the stable request.

Copying samba for net-libs/socket_wrapper, and toolchain for the stack smashing error. Can you provide any insight?</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 08:58:25 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Sam James (sec padawan) from <a href="show_bug.cgi?id=721570#c3">comment #3</a>)
<span class="quote">&gt; Connecting to obtain cookie - group1 (with certificate)... *** stack
&gt; smashing detected ***: &lt;unknown&gt; terminated</span >

Do you have a backtrace for that crash?</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 11:13:48 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Sergei Trofimovich from <a href="show_bug.cgi?id=721570#c5">comment #5</a>)
<span class="quote">&gt; (In reply to Sam James (sec padawan) from <a href="show_bug.cgi?id=721570#c3">comment #3</a>)
&gt; &gt; Connecting to obtain cookie - group1 (with certificate)... *** stack
&gt; &gt; smashing detected ***: &lt;unknown&gt; terminated
&gt; 
&gt; Do you have a backtrace for that crash?</span >

Got it on arm64-build.arm.dev.gentoo.org:

# ulimit -c unlimited
# ./test-pass-group-cert-no-pass
Testing local backend with username-password and certificate...
Connecting to obtain cookie (without certificate)... Server '127.0.0.2' requested Basic authentication which is disabled by default
Failed to obtain WebVPN cookie
ok
Connecting to obtain cookie - group1 (with certificate)... *** stack smashing detected ***: &lt;unknown&gt; terminated
./test-pass-group-cert-no-pass: line 41: 13204 Aborted                 (core dumped) LD_PRELOAD=libsocket_wrapper.so /usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6555 --sslkey ./certs/user-group-key.pem -c ./certs/user-group-cert.pem -u test --servercert=d66b507ae074d03b02eafca40d35f87dd81049d3 --cookieonly
Failure: Could not connect with certificate!

# file core
core: ELF 64-bit LSB core file, ARM aarch64, version 1 (SYSV), SVR4-style, from '/usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6555 --sslkey ./certs/use', real uid: 0, effective uid: 0, real gid: 0, effective gid: 0, execfn: '/usr/sbin/openconnect', platform: 'aarch64'

# qfile /usr/sbin/openconnect
net-vpn/openconnect: /usr/sbin/openconnect

# gdb --quiet /usr/sbin/openconnect core
Reading symbols from /usr/sbin/openconnect...
Reading symbols from /usr/lib/debug//usr/sbin/openconnect.debug...
[New LWP 13204]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib64/libthread_db.so.1&quot;.
Core was generated by `/usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6555 --sslkey ./certs/use'.
Program terminated with signal SIGABRT, Aborted.
#0  __GI_raise (sig=sig&#64;entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50
50	../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
(gdb) bt
#0  __GI_raise (sig=sig&#64;entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50
#1  0x0000ffff95a19728 in __GI_abort () at abort.c:79
#2  0x0000ffff95a65b6c in __libc_message (action=&lt;optimized out&gt;, fmt=fmt&#64;entry=0xffff95b1bce8 &quot;*** %s ***: %s terminated\n&quot;)
    at ../sysdeps/posix/libc_fatal.c:181
#3  0x0000ffff95ad526c in __GI___fortify_fail_abort (need_backtrace=need_backtrace&#64;entry=false, msg=msg&#64;entry=0xffff95b1bcc0 &quot;stack smashing detected&quot;)
    at fortify_fail.c:33
#4  0x0000ffff95ad5220 in __stack_chk_fail () at stack_chk_fail.c:29
#5  0x0000ffff95ed7a40 in load_certificate (vpninfo=vpninfo&#64;entry=0xaaaaffb09140) at gnutls.c:1356
#6  0x0000ffff95ed92e0 in openconnect_open_https (vpninfo=vpninfo&#64;entry=0xaaaaffb09140) at gnutls.c:2158
#7  0x0000ffff95eb2258 in do_https_request (vpninfo=vpninfo&#64;entry=0xaaaaffb09140, method=method&#64;entry=0xffff95ede8a8 &quot;POST&quot;,
    request_body_type=request_body_type&#64;entry=0xffff95edfeb8 &quot;application/xml; charset=utf-8&quot;, request_body=request_body&#64;entry=0xaaaaffb02eb0,
    form_buf=form_buf&#64;entry=0xffffe36cbf58, fetch_redirect=fetch_redirect&#64;entry=0) at http.c:1056
#8  0x0000ffff95ec3734 in cstp_obtain_cookie (vpninfo=0xaaaaffb09140) at auth.c:1312
#9  0x0000aaaadc89eda4 in main (argc=13, argv=0xffffe36cc408) at main.c:1599</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 13:49:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">valgrind did not find any problems. asan refused to work with LD_PRELOADED libraries that manually load libc.so.6.

Resorting to tracking who stack canary on stack.

Before looking at the specifics here is how stack canary usually looks like on arm64:

  // cat a.c
  void g(const char *);
  void f(void)
  {
     char b[128];
     g(b);
  }

$ aarch64-unknown-linux-gnu-gcc -O2 -c -S a.c; cat a.s
  ...
  f:
	stp	x29, x30, [sp, -176]!
	mov	x29, sp
	str	x19, [sp, 16]
	adrp	x19, :got:__stack_chk_guard
	add	x0, sp, 40
	ldr	x19, [x19, #:got_lo12:__stack_chk_guard]
	ldr	x1, [x19]
	str	x1, [sp, 168]
	mov	x1,0

	bl	g

	ldr	x1, [sp, 168]
	ldr	x0, [x19]
	eor	x0, x1, x0
	cbnz	x0, .L5
	ldr	x19, [sp, 16]
	ldp	x29, x30, [sp], 176
	ret
.L5:
	bl	__stack_chk_fail

It's a very verbose way to:
- load value by '__stack_chk_guard' absolute address into 'x19' register
- store canary copy on stack at '[sp +168]' address
- restore canary from stack and from address at 'x19' and compare it back.

A good hint here is that right after the store 'x1' value is zeroed out with 'mov x1,0'.

Let's track life of a canary in 'load_certificate' and see where it gets corrupted:

I added 'gdb --args' to openconnect call in test-pass-group-cert-no-pass and removed a few unused evals.

    LD_PRELOAD=&quot;libsocket_wrapper.so&quot; gdb --args $OPENCONNECT --authgroup group1 ...

  # bash -x ./test-pass-group-cert-no-pass
  ...
  Connecting to obtain cookie - group1 (with certificate)... + LD_PRELOAD=libsocket_wrapper.so
  + gdb --args /usr/sbin/openconnect --authgroup group1 -q 127.0.0.2:6555 --sslkey ./certs/user-group-key.pem -c ./certs/user-group-cert.pem -u test --servercert=d66b507ae074d03b02eafca40d35f87dd81049d3 --cookieonly

  (gdb) start
  (gdb) break load_certificate
  (gdb) continue
  Breakpoint 2, load_certificate (vpninfo=vpninfo&#64;entry=0xaaaaaaae5140) at gnutls.c:916
  Dump of assembler code for function load_certificate:
=&gt; 0x0000ffffb7f88d08 &lt;+0&gt;:	sub	sp, sp, #0x200
   0x0000ffffb7f88d0c &lt;+4&gt;:	mov	x3, #0x14                  	// #20
   0x0000ffffb7f88d10 &lt;+8&gt;:	mov	x2, #0x7                   	// #7
   0x0000ffffb7f88d14 &lt;+12&gt;:	stp	x29, x30, [sp, #16]
   0x0000ffffb7f88d18 &lt;+16&gt;:	add	x29, sp, #0x10
   0x0000ffffb7f88d1c &lt;+20&gt;:	stp	x21, x22, [sp, #48]
   0x0000ffffb7f88d20 &lt;+24&gt;:	adrp	x21, 0xffffb7faf000
   0x0000ffffb7f88d24 &lt;+28&gt;:	stp	x19, x20, [sp, #32]
   0x0000ffffb7f88d28 &lt;+32&gt;:	mov	x19, x0
   0x0000ffffb7f88d2c &lt;+36&gt;:	adrp	x20, 0xffffb7f97000
   0x0000ffffb7f88d30 &lt;+40&gt;:	ldr	x0, [x21, #3992]
   0x0000ffffb7f88d34 &lt;+44&gt;:	stp	x23, x24, [sp, #64]
   0x0000ffffb7f88d38 &lt;+48&gt;:	add	x20, x20, #0x918
   0x0000ffffb7f88d3c &lt;+52&gt;:	ldr	x24, [x19, #1128]
   0x0000ffffb7f88d40 &lt;+56&gt;:	ldr	x1, [x0]
   0x0000ffffb7f88d44 &lt;+60&gt;:	str	x1, [sp, #504]
   0x0000ffffb7f88d48 &lt;+64&gt;:	mov	x1, #0x0                   	// #0
   0x0000ffffb7f88d4c &lt;+68&gt;:	ldr	x23, [x19, #1120]
   0x0000ffffb7f88d50 &lt;+72&gt;:	mov	x1, x20
   0x0000ffffb7f88d54 &lt;+76&gt;:	mov	x0, x24
   0x0000ffffb7f88d58 &lt;+80&gt;:	stp	x25, x26, [sp, #80]
   0x0000ffffb7f88d5c &lt;+84&gt;:	mov	w26, #0x0                   	// #0

Here is our canary store:

   0x0000ffffb7f88d40 &lt;+56&gt;:	ldr	x1, [x0]
   0x0000ffffb7f88d44 &lt;+60&gt;:	str	x1, [sp, #504]
   0x0000ffffb7f88d48 &lt;+64&gt;:	mov	x1, #0x0                   	// #0

Absolute address of canary copy on stack is '[sp, #504]'. Let's find it out and trace it's life:

  (gdb) break *0x0000ffffb7f88d48
  Breakpoint 3 at 0xffffb7f88d48: file gnutls.c, line 916.
  (gdb) continue
  Continuing.
  Breakpoint 3, 0x0000ffffb7f88d48 in load_certificate (vpninfo=vpninfo&#64;entry=0xaaaaaaae5140) at gnutls.c:916

Looks like a valid canary in register, stack and global variable:

  (gdb) print (void*)$x1
  $3 = (void *) 0xb9b1883f29832000
  (gdb) print *(void**)($sp+504)
  $4 = (void *) 0xb9b1883f29832000
  (gdb) print *(void**)&amp;__stack_chk_guard
  $6 = (void *) 0xb9b1883f2983200

Print stack address and add a watch point on it:

  (gdb) print (void*)($sp+504)
  $7 = (void *) 0xffffffffea
  (gdb) watch *(void**)0xffffffffeaa8
  Hardware watchpoint 3: *(void**)0xffffffffeaa8
  (gdb) continue
  Continuing.

  Hardware watchpoint 3: *(void**)0xffffffffeaa8

  Old value = (void *) 0xffffb7f8c2b4 &lt;openconnect_open_https+572&gt;
  New value = (void *) 0xc9d1f41373228800
  0x0000ffffb7f88d48 in load_certificate (vpninfo=vpninfo&#64;entry=0xaaaaaaae5140) at gnutls.c:916
  916	in gnutls.c
  
  (gdb) bt
  #0  0x0000ffffb7f88d48 in load_certificate (vpninfo=vpninfo&#64;entry=0xaaaaaaae5140) at gnutls.c:916
  #1  0x0000ffffb7f8c2e0 in openconnect_open_https (vpninfo=vpninfo&#64;entry=0xaaaaaaae5140) at gnutls.c:2158

  (gdb) bt
  #0  get_cert_name (cert=0xaaaaaaaea2f0, name=name&#64;entry=0xffffffffea58 &quot;&quot;, namelen=&lt;optimized out&gt;) at gnutls.c:563
  #1  0x0000ffffb7f89408 in load_certificate (vpninfo=vpninfo&#64;entry=0xaaaaaaae5140) at gnutls.c:1545
  ...


   557	static int get_cert_name(gnutls_x509_crt_t cert, char *name, size_t namelen)
   558	{
   559		if (gnutls_x509_crt_get_dn_by_oid(cert, GNUTLS_OID_X520_COMMON_NAME,
   560						  0, 0, name, &amp;namelen) &amp;&amp;
   561		    gnutls_x509_crt_get_dn(cert, name, &amp;namelen)) {
   562			name[namelen-1] = 0;
   563			snprintf(name, namelen-1, &quot;&lt;unknown&gt;&quot;);
   564			return -EINVAL;
   565		}
   566		return 0;
   567	}

  (gdb) disassemble
   0x0000ffffb7f88ab8 &lt;+160&gt;:	sub	x1, x1, #0x1
   0x0000ffffb7f88abc &lt;+164&gt;:	strb	wzr, [x20, x1]
=&gt; 0x0000ffffb7f88ac0 &lt;+168&gt;:	bl	0xffffb7f5f590 &lt;snprintf&#64;plt&gt;

I think it tells us that 'name[namelen-1] = 0;' corrupted the stack. 

Probably 'name' value:
  (gdb) printf &quot;%#x\n&quot;, (void*)$x20
  0xffffea58

Probably 'namelen-1' value:
  (gdb) printf &quot;%#x\n&quot;, (void*)$x1
  0x54 # 84

But get_cert_name is ever called against 'name' with namelen=80.

Let's see if I can find if 'namelen' is inflated by 'gnutls_x509_crt_get_dn' when it fails or somewhere else.</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 14:02:17 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=636836" name="attach_636836" title="openconnect-8.06-get_cert_name-overflow.patch">attachment 636836</a> [<a href="attachment.cgi?id=636836&amp;action=edit" title="openconnect-8.06-get_cert_name-overflow.patch">details</a>, <a href="attachment.cgi?id=636836&amp;action=diff" title="openconnect-8.06-get_cert_name-overflow.patch">diff</a>]</span>
openconnect-8.06-get_cert_name-overflow.patch

openconnect-8.06-get_cert_name-overflow.patch shoud fix the overflow in net-vpn/openconnect</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-08 14:04:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">From <a href="http://man7.org/linux/man-pages/man3/gnutls_x509_crt_get_dn_by_oid.3.html">http://man7.org/linux/man-pages/man3/gnutls_x509_crt_get_dn_by_oid.3.html</a> : 
&quot;&quot;&quot;
RETURNS
       GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not long
       enough, and in that case the  buf_size will be updated with the
       required size. GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE if there are no
       data in the current index. On success 0 is returned.
&quot;&quot;&quot;

In our case 'namelen' is extended from 80 to 84 chars. Then corrupts one byte with 'name[namelen-1] = 0;'.

   557	static int get_cert_name(gnutls_x509_crt_t cert, char *name, size_t namelen)
   558	{
   559		if (gnutls_x509_crt_get_dn_by_oid(cert, GNUTLS_OID_X520_COMMON_NAME,
   560						  0, 0, name, &amp;namelen) &amp;&amp;
   561		    gnutls_x509_crt_get_dn(cert, name, &amp;namelen)) {
   562			name[namelen-1] = 0;
   563			snprintf(name, namelen-1, &quot;&lt;unknown&gt;&quot;);
   564			return -EINVAL;
   565		}
   566		return 0;
   567	}</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Larry the Git Cow</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-05-12 16:02:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">The bug has been closed via the following commit(s):

<a href="https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=27513d77015771f8604d9a21f388e9846c8c650a">https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=27513d77015771f8604d9a21f388e9846c8c650a</a>

commit 27513d77015771f8604d9a21f388e9846c8c650a
Author:     Mike Gilbert &lt;<a href="mailto:floppym&#64;gentoo.org">floppym&#64;gentoo.org</a>&gt;
AuthorDate: 2020-05-12 16:01:57 +0000
Commit:     Mike Gilbert &lt;<a href="mailto:floppym&#64;gentoo.org">floppym&#64;gentoo.org</a>&gt;
CommitDate: 2020-05-12 16:02:48 +0000

    net-vpn/openconnect: fix buffer overflow in get_cert_name
    
    Closes: <a href="https://bugs.gentoo.org/721570">https://bugs.gentoo.org/721570</a>
    Signed-off-by: Mike Gilbert &lt;<a href="mailto:floppym&#64;gentoo.org">floppym&#64;gentoo.org</a>&gt;

 .../files/8.09-gnutls-buffer-overflow.patch        | 62 ++++++++++++++++++++++
 ...nect-8.09.ebuild =&gt; openconnect-8.09-r1.ebuild} |  3 ++
 2 files changed, 65 insertions(+)</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=721570">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=721570">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=721570">Clone This Bug</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=721570&product=Gentoo%20Linux">Clone In The Same 
                        Product</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?format=guided">New</a>&ndash;<a href="enter_bug.cgi">[Ex]</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>
  <li><span class="separator">| </span><a href="https://wiki.gentoo.org/wiki/Foundation:Privacy_Policy">Privacy Policy</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=721570&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=721570" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=721570&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619197-p1cjlQ848bqiLvNgyvdqxS6KvLnPaJhTtoWV6qDLUI8">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>