<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1641487 - (CVE-2020-15677) Firefox Browser - Download Site Obscured from User">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1641487">
<meta property="og:description"
      content="VERIFIED (gijskruitbosch+bugs) in Firefox - Downloads Panel. Last updated 2020-12-18.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1641487 - (CVE-2020-15677) Firefox Browser - Download Site Obscured from User</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1641487&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1641487">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1641487">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/yui.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/global.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/util.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\"},\"tracking\":{\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr68\":\"wontfix\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"fixed\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox81\":\"verified\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox_esr78\":\"81+\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox80\":\"wontfix\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox79\":\"wontfix\",\"cf_status_firefox94\":\"---\"}},\"comments\":{\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1641487;
  BUGZILLA.bug_title = '1641487 - (CVE-2020-15677) Firefox Browser - Download Site Obscured from User';
  BUGZILLA.bug_summary = 'Firefox Browser - Download Site Obscured from User';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1641487';
  BUGZILLA.bug_keywords = 'csectype-spoof, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/field.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/comments.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1641487">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1641487"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1641487 - (CVE-2020-15677) Firefox Browser - Download Site Obscured from User">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="DTnNdjFxGZTRVpjjO3bU2RNnXfQnBxiIpYfpqXueyphMAv8McuhqBWv3fTV4FUWCuXaeWqTRch3pnHZAxxpcqKs6Tx7pU1yeIWzIcnD2TTPBiOEgpRY9HwyeCgzwwYOKKImvUqiPU3auohSXirMhY1yUxw61EVqpk7EeNIgkueLhkq55aM2SVrSO2praRN1MgBq7ZCFIWCzipYpJlQOfN446TFQFaTQPjDct3VYo3Lo3m728JPCGJqbEf7qSYBnF">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1641487" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623519-08W055-JAZKiljfAmUa20Ymt_c1pHeL_uZ1SUjY1iz4">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1641487" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1641487" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1641487">Bug 1641487</a>
          <span class="edit-hide">(CVE-2020-15677)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2020-05-28 01:53 PDT" data-time="1590655989">1 year ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2020-08-13 08:51 PDT" data-time="1597333918">1 year ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Firefox Browser - Download Site Obscured from User</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Firefox Browser - Download Site Obscured from User

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Firefox :: Downloads Panel, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Firefox
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Firefox</div>
            <div class="description">For bugs in  Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Core">Core</a> product. Bugs for developer tools (F12) should be filed in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools">DevTools</a> product.  (<a href="https://wiki.mozilla.org/Modules/All#Firefox">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox&component=Downloads%20Panel#Downloads%20Panel" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Downloads Panel
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Firefox :: Downloads Panel</div>
            <div class="description">For issues with the Downloads Panel, the new download manager of Firefox that lives in the navigation toolbar.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Downloads%20Panel&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Downloads%20Panel&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox&amp;component=Downloads%20Panel"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox" data-component="Downloads Panel"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            S3

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;81 Branch&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;fixed&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr68&quot;:&quot;wontfix&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox79&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-spoof&quot;,&quot;sec-moderate&quot;],&quot;flags&quot;:[{&quot;status&quot;:&quot;?&quot;,&quot;name&quot;:&quot;needinfo&quot;},{&quot;name&quot;:&quot;sec-bounty&quot;,&quot;status&quot;:&quot;+&quot;}],&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_status_firefox81&quot;:&quot;verified&quot;,&quot;id&quot;:1641487,&quot;priority&quot;:&quot;P1&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_status_firefox80&quot;:&quot;wontfix&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;81+&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            81 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr68</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr78</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr78&amp;o1=equals&amp;v1=81%2B">81+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox79</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox79&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox80</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox80&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox81</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox81&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr68</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr68-dirty">
  <select id="cf_status_firefox_esr68" name="cf_status_firefox_esr68">
        <option value="wontfix"
          id="v4417_cf_status_firefox_esr68" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="81+"
          id="v4882_cf_tracking_firefox_esr78" selected
        >81+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="fixed"
          id="v4818_cf_status_firefox_esr78" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox79</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox79-dirty">
  <select id="cf_status_firefox79" name="cf_status_firefox79">
        <option value="wontfix"
          id="v4802_cf_status_firefox79" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox80</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox80-dirty">
  <select id="cf_status_firefox80" name="cf_status_firefox80">
        <option value="wontfix"
          id="v4861_cf_status_firefox80" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox81</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox81-dirty">
  <select id="cf_status_firefox81" name="cf_status_firefox81">
        <option value="verified"
          id="v4895_cf_status_firefox81" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: r.j.thomas, Assigned: Gijs, NeedInfo)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=159069" > <span class="fna">Gijs</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_663870" ><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=663870" > <span class="fna">r.j.thomas</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_240353" ><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=240353" > <span class="fna">mak</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-hide"
>
    <div class="name">NeedInfo From:
    </div>


  
    <div class=" container"><div class="flags edit-hide">
        <div class="flag"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
            <a href="#c31"
            class=" activity-ref"
          ><span class="rel-time" title="2020-08-25 13:44 PDT" data-time="1598388269">1 year ago</span></a>
        </div>
  </div>
    </div>

  
</div><div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo" id="-help-link" class="help">NeedInfo:
        </a>
    </div>


  
    <div class=" container">
        <button type="button" id="needinfo-scroll" class="secondary">Update</button>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="8">8 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-spoof, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main81+][adv-esr78.3+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2020-15677

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[reporter-external] [client-bounty-form] [verif?][adv-main81+][adv-esr78.3+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c30"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1590655989"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1976022">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1976022-dirty">
      <select id="flag-1976022" name="flag-1976022"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug must be fixed for Firefox Sync 1.7" for="flag_type-708">blocking-fx-sync1.7</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-708-dirty">
      <select id="flag_type-708" name="flag_type-708"
        title="This bug must be fixed for Firefox Sync 1.7"
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (6 files, 2 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9152352">xattr-firefox.txt</a>
        </div>
        <div>
            <a href="#c2" class="attach-time activity-ref"><span class="rel-time" title="2020-05-28 03:15 PDT" data-time="1590660951">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_663870" ><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div></span>
        </div>
        <div class="attach-info">1.55 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9152352&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9152353">xattr-safari.txt</a>
        </div>
        <div>
            <a href="#c3" class="attach-time activity-ref"><span class="rel-time" title="2020-05-28 03:16 PDT" data-time="1590660986">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_663870" ><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div></span>
        </div>
        <div class="attach-info">2.01 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9152353&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9152354"
              title="Safari-Gatekeeper.png"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Safari-Gatekeeper.png
            </a>
        </div>
        <div>
            <a href="#c4" class="attach-time activity-ref"><span class="rel-time" title="2020-05-28 03:21 PDT" data-time="1590661284">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_663870" ><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div></span>
        </div>
        <div class="attach-info">233.62 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9152354&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9152355"
              title="Firefox-Gatekeeper.png"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Firefox-Gatekeeper.png
            </a>
        </div>
        <div>
            <a href="#c5" class="attach-time activity-ref"><span class="rel-time" title="2020-05-28 03:21 PDT" data-time="1590661303">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_663870" ><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div></span>
        </div>
        <div class="attach-info">239.34 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9152355&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9169497">Bug 1641487, r?jaws</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2020-08-11 13:47 PDT" data-time="1597178840">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_580382" ><span class="fn">jcristau</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1599599164"
            >
              approval-mozilla-esr78+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9169497&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9169497">Review</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9175901">advisory.txt</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2020-09-15 14:16 PDT" data-time="1600204567">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">405 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9175901&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9176112">advisory.txt</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2020-09-16 10:36 PDT" data-time="1600277769">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">405 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9176112&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9176804">advisory.txt</a>
        </div>
        <div>
            <a href="#c38" class="attach-time activity-ref"><span class="rel-time" title="2020-09-20 21:13 PDT" data-time="1600661639">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">367 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9176804&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="YVGXy1XzhPsm7QwZM3yMQ4YXVBo0n0dUXtKPfXlQdh42InA7">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="14848880" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" ><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" ><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 01:53 PDT" data-time="1590655989">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-0" data-comment-id="14848880" data-ismarkdown="true" ><p>University of Birmingham Vulnerability Report - Firefox Browser - Download Site Obscured from User</p>
<h2>About this Document</h2>
<p>This document details a vulnerability identified by the University of Birmingham in the Firefox Web Browser.</p>
<h2>University of Birmingham Contact Information</h2>
<p>The researchers, Richard Thomas and Tom Chothia can be contacted at {r.j.thomas,t.p.chothia}@cs.bham.ac.uk. Please contact us for our PGP key.</p>
<h2>Crediting the University of Birmingham</h2>
<p>The University of Birmingham would appreciate credit to the researchers and the University for any advisories which you may publish about this issue.</p>
<p>Please inform the researchers via their contact email addresses should you:</p>
<ul>
<li>confirm that this is a security issue</li>
<li>allocate the issue a CVE identifier</li>
<li>determine a date to release a patch</li>
<li>determine a date to publish advisories</li>
</ul>
<h2>University of Birmingham Disclosure Policy</h2>
<p>The University of Birmingham follows a responsible, coordinated disclosure approach with affected parties. We do not publicly disclose vulnerabilities without consulting the vendor.</p>
<p>The University of Birmingham recognises that vendors need a reasonable amount of time to mitigate a vulnerability, understand the impact to customers, triage other vulnerability reports and implement resolutions in coordination with others and its customers. The researchers are happy to discuss how such disclosures may take place.</p>
<p>If the researchers believe a vendor is not making appropriate progress with the resolution of this vulnerability, we may, following discussion with the vendor, choose to share details with the UK National Cyber Security Centre to protect UK interests.</p>
<h2>Summary</h2>
<p>A User Interface (UI) Misrepresentation of Critical Information issue exists on the Download UI process on the Firefox browser, and has been tested on Firefox 76.0.1 for Windows, MacOS and Linux (Kali Repositories). This can be exploited by an adversary exploiting an Open Redirect (CWE-601) on a trusted device to display the source of the download in the Download List UI as the trusted device, and not the true download site.</p>
<p>If a user is tricked into downloading and running a malicious file by making the trusted host appear in the downloads list, they will be more likely to run the malware.</p>
<p>These vulnerabilities have a Severity Score of 7.1 and a High Severity rating (based on the Common Vulnerability Scoring System v3.1).</p>
<h2>CVSS</h2>
<p>This vulnerability has a Severity Score of 7.1 and a High Severity rating (the CVSS Vector is AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L).<br>
The Common Weakness Enumeration ID is CWE-451: User Interface (UI) Misrepresentation of Critical Information.</p>
<h2>Details</h2>
<p>The Firefox browser is one of a number of cross-platform browsers which commonly used by end-users. Where an Open Redirect vulnerability (CWE-601) exists on a device that is trusted by the user, the response to a user request may redirect the user to untrusted content which was not initially requested. In Firefox, given an Open Redirect using the HTTP POST method, upon receipt of the HTTP 302 Redirect from the trusted device, the browser may start a download of a malicious file from the adversary. Where Firefox displays a dialog box for the user to select whether to Open or Save the file, the adversary host is displayed as the source, however, upon completion of the download, the Download UI on Firefox displays the trusted device as the source of the download in the list. Where the user has previously configured Firefox to automatically save files of a particular type, the user would see the trusted device as the download host, not the adversary&#39;s host.</p>
<p>On MacOS, if the user attempts to execute an installer downloaded via the Open Redirect, MacOS Gatekeeper will confirm that Firefox downloaded the file from the trusted device, and not the true download site.</p>
<p>This issue has been tested on Firefox 76.0.1. on Windows 10 Enterprise N (Version 1709), MacOS 10.15 Catalina and Kali Linux 2019.4.</p>
<p>Steps to reproduce:</p>
<ul>
<li>Submit a HTTP POST request to a trusted device, which will issue a HTTP 302 Redirect to another site, hosting a download.</li>
<li>If a download prompt is displayed, the site should be shown as the one indicated in the 302 Redirect. Click Save.</li>
<li>Once the download has completed, click the Download UI Button, and the file should show there. No host is displayed. Click &#39;Show All Downloads&#39; and the downloaded file will show in the list with the host shown as the trusted device, not the true download site.</li>
</ul>
<p>PoC code is given at the bottom of this report.</p>
<h2>Mitigation</h2>
<p>Firefox should display the name of the host that the file was downloaded from in teh download list (i.e. the host stated in the download dialog), not the name of the host that issued the redirect.</p>
<h2>Note</h2>
<p>This issue was identified during the assessment of an Open Redirect Vulnerability using POST, which is undergoing responsible disclosure with the Vendor.</p>
<p>A minimal example demonstrating this behaviour is given below:</p>
<ol>
<li>Trusted Page simulating Open Redirect form behaviour (test.html)<br>
&lt;!DOCTYPE html&gt;<br>
&lt;html&gt;<br>
&lt;body&gt;<br>
&lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt;<br>
&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;<br>
&lt;/form&gt;</li>
</ol>
<p>&lt;p&gt;If you click the &quot;Submit&quot; button, the form-data will be sent to a page called &quot;/index.php&quot;.&lt;/p&gt;</p>
<p>&lt;/body&gt;<br>
&lt;/html&gt;</p>
<ol start="2">
<li>PHP (on server) to trigger the download and force this behaviour<br>
&lt;?php<br>
Header(&quot;HTTP/1.1 302 Object Moved&quot; );<br>
Header(&quot;Content-Type: text/html; charset=UTF-8&quot;);<br>
Header(&quot;Cache-Control: no-cache&quot;);<br>
Header(&quot;Pragma: no-cache&quot;);<br>
Header(&quot;Expires: 0&quot;);<br>
Header(&quot;Location: //&lt;Download Page&gt;&quot;);<br>
Header(&quot;Content-Length: 0&quot;);<br>
Header(&quot;Connection: close&quot;);<br>
exit();<br>
?&gt;</li>
</ol>
</div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="14848932" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 02:35 PDT" data-time="1590658557">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-1" data-comment-id="14848932" data-ismarkdown="true" ><p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c0" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #0</a>)</p>
<blockquote>
<p>Steps to reproduce:</p>
<ul>
<li>Submit a HTTP POST request to a trusted device, which will issue a HTTP 302 Redirect to another site, hosting a download.</li>
</ul>
</blockquote>
<p>Is the POST part significant here, ie does it not happen with a 302 on a GET request?</p>
<blockquote>
<ul>
<li>If a download prompt is displayed, the site should be shown as the one indicated in the 302 Redirect. Click Save.</li>
</ul>
</blockquote>
<p>Which of the 2 sites is &quot;the site&quot; referring to, and when this says &quot;should&quot;, does it mean that&#39;s the desired behaviour or that&#39;s what you&#39;re seeing as actual behaviour?</p>
<blockquote>
<ul>
<li>Once the download has completed, click the Download UI Button, and the file should show there. No host is displayed. Click &#39;Show All Downloads&#39; and the downloaded file will show in the list with the host shown as the trusted device, not the true download site.</li>
</ul>
</blockquote>
<p>FWIW, I suspect the current behaviour is intentional... Showing the final origin of the file would mean always showing CDN domains, rather than the domain from which the user believes they downloaded something (because they clicked a link on that domain). Marco, thoughts?</p>
<blockquote>
<p>On MacOS, if the user attempts to execute an installer downloaded via the Open Redirect, MacOS Gatekeeper will confirm that Firefox downloaded the file from the trusted device, and not the true download site.</p>
</blockquote>
<p>What happens for this case in Safari? From some naive checks with other downloads (e.g. downloading the windows migration tool off of <a href="https://support.apple.com/en_GB/downloads" rel="nofollow">https://support.apple.com/en_GB/downloads</a> , or downloading the Firefox dmg from mozilla.org ) and checking file info, it appears Safari registers both the page URL and the final, post-redirect URL, in the &quot;where from&quot; section shown by Get Info. I don&#39;t get a gatekeeper warning when expanding a Firefox dmg (maybe I&#39;ve already told macOS I trust mozilla.org?) so I&#39;m unsure which metadata attributes gatekeeper is using in your case - but are they different from what happens in Safari? In terms of the metadata I&#39;m familiar with, I&#39;m seeing exactly the same behaviour in Firefox (checking with <code>xattr -lp com.apple.metadata:kMDItemWhereFroms path/to/file</code> ) for the aforementioned download examples (the mozilla.org case redirects from <a href="https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=osx&amp;lang=en-GB" rel="nofollow">https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=osx&amp;lang=en-GB</a> ).</p>
</div><div class="activity"><div class="change">Flags: needinfo?(r.j.thomas)</div><div class="change">Flags: needinfo?(mak)</div></div></div><div class="change-set" id="a2681_159069"><div class="change" id="aa2681_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a2681_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2681_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2681_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a2681_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 02:37 PDT" data-time="1590658670">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Type: task &rarr; defect</div><div class="change">Component: Security &rarr; Downloads Panel</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="14848994" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a2681_159069"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 03:15 PDT" data-time="1590660951">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9152352"
         class="attachment"
         data-id="9152352" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="xattr-firefox.txt">
      <meta itemprop="contentSize" content="1591">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9152352" itemprop="contentUrl">
        <span id="att-9152352-description" itemprop="description">xattr-firefox.txt</span></a>
        — <a href="attachment.cgi?id=9152352&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-2" data-comment-id="14848994" data-ismarkdown="true" ><p>xattr output for Firefox downloaded DMGs</p>
</div></div><div class="change-set" id="c3"><div class="comment" data-id="14848997" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a2681_159069"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 03:16 PDT" data-time="1590660986">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9152353"
         class="attachment"
         data-id="9152353" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="xattr-safari.txt">
      <meta itemprop="contentSize" content="2058">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9152353" itemprop="contentUrl">
        <span id="att-9152353-description" itemprop="description">xattr-safari.txt</span></a>
        — <a href="attachment.cgi?id=9152353&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-3" data-comment-id="14848997" data-ismarkdown="true" ><p>xattr output for Safari</p>
</div></div><div class="change-set" id="c4"><div class="comment" data-id="14848999" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a2681_159069"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 03:21 PDT" data-time="1590661284">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9152354"
         class="attachment"
         data-id="9152354" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Safari-Gatekeeper.png">
      <meta itemprop="contentSize" content="239227">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=9152354" itemprop="contentUrl">
        <span id="att-9152354-description" itemprop="description">Safari-Gatekeeper.png</span></a>
        — <a href="attachment.cgi?id=9152354&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-4" data-comment-id="14848999" data-ismarkdown="true" ><p>Safari Gatekeeper dialog</p>
</div></div><div class="change-set" id="c5"><div class="comment" data-id="14849000" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a2681_159069"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 03:21 PDT" data-time="1590661303">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9152355"
         class="attachment"
         data-id="9152355" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Firefox-Gatekeeper.png">
      <meta itemprop="contentSize" content="245081">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=9152355" itemprop="contentUrl">
        <span id="att-9152355-description" itemprop="description">Firefox-Gatekeeper.png</span></a>
        — <a href="attachment.cgi?id=9152355&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="14849000" data-ismarkdown="true" ><p>Firefox Gatekeeper Dialog</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="14849002" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a2681_159069"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 03:23 PDT" data-time="1590661400">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="14849002" data-ismarkdown="true" ><p>Hi,<br>
Thanks for the quick actioning on this.</p>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c1" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #1</a>)</p>
<blockquote>
<p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c0" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #0</a>)</p>
<blockquote>
<p>Steps to reproduce:</p>
<ul>
<li>Submit a HTTP POST request to a trusted device, which will issue a HTTP 302 Redirect to another site, hosting a download.</li>
</ul>
</blockquote>
<p>Is the POST part significant here, ie does it not happen with a 302 on a GET request?</p>
</blockquote>
<p>Yes - the download list shows the actual download site for GET requests, but POST triggers this disparity between the download dialog box (if shown) which has the real download site, and the download list showing the trusted device as the host.</p>
<blockquote>
<blockquote>
<ul>
<li>If a download prompt is displayed, the site should be shown as the one indicated in the 302 Redirect. Click Save.</li>
</ul>
</blockquote>
<p>Which of the 2 sites is &quot;the site&quot; referring to, and when this says &quot;should&quot;, does it mean that&#39;s the desired behaviour or that&#39;s what you&#39;re seeing as actual behaviour?</p>
</blockquote>
<p>In the Download dialog (if shown to the user), it shows the real download site, not the trusted device as the &#39;from:&#39; field.</p>
<blockquote>
<blockquote>
<ul>
<li>Once the download has completed, click the Download UI Button, and the file should show there. No host is displayed. Click &#39;Show All Downloads&#39; and the downloaded file will show in the list with the host shown as the trusted device, not the true download site.</li>
</ul>
</blockquote>
<p>FWIW, I suspect the current behaviour is intentional... Showing the final origin of the file would mean always showing CDN domains, rather than the domain from which the user believes they downloaded something (because they clicked a link on that domain). Marco, thoughts?</p>
</blockquote>
<p>I trust the two previous clarifications clear this point up too - in a GET (i.e. a user clicking onto or navigating directly to a URL), the final origin matches the dialog, but in POST, the dialog &#39;from:&#39; does not match the download host in the Download List.</p>
<blockquote>
<blockquote>
<p>On MacOS, if the user attempts to execute an installer downloaded via the Open Redirect, MacOS Gatekeeper will confirm that Firefox downloaded the file from the trusted device, and not the true download site.</p>
</blockquote>
<p>What happens for this case in Safari? From some naive checks with other downloads (e.g. downloading the windows migration tool off of <a href="https://support.apple.com/en_GB/downloads" rel="nofollow">https://support.apple.com/en_GB/downloads</a> , or downloading the Firefox dmg from mozilla.org ) and checking file info, it appears Safari registers both the page URL and the final, post-redirect URL, in the &quot;where from&quot; section shown by Get Info. I don&#39;t get a gatekeeper warning when expanding a Firefox dmg (maybe I&#39;ve already told macOS I trust mozilla.org?) so I&#39;m unsure which metadata attributes gatekeeper is using in your case - but are they different from what happens in Safari? In terms of the metadata I&#39;m familiar with, I&#39;m seeing exactly the same behaviour in Firefox (checking with <code>xattr -lp com.apple.metadata:kMDItemWhereFroms path/to/file</code> ) for the aforementioned download examples (the mozilla.org case redirects from <a href="https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=osx&amp;lang=en-GB" rel="nofollow">https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=osx&amp;lang=en-GB</a> ).</p>
</blockquote>
<p>In testing, we used Burp Suite Community as the example DMG, which is not signed, and triggers the Gatekeeper popup which displays where the file came from, where the user would have to press Ctrl and click to run the installer. The xattr outputs for Firefox and Safari are attached, as well as the Gatekeeper UI screengrabs. A quick look over the hex for the xattr output on the kMDItemWhereFroms between Safari and Firefox looks to be no different.</p>
<p>Best regards,<br>
Richard</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(r.j.thomas)</span></div></div></div><div class="change-set" id="c7"><div class="comment" data-id="14849085" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a2681_159069"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 04:23 PDT" data-time="1590665019">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1641487&amp;comment_id=14849085"
     title="3 revisions">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="14849085" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c1" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #1</a>)</p>
<blockquote>
<blockquote>
<ul>
<li>Once the download has completed, click the Download UI Button, and the file should show there. No host is displayed. Click &#39;Show All Downloads&#39; and the downloaded file will show in the list with the host shown as the trusted device, not the true download site.</li>
</ul>
</blockquote>
<p>FWIW, I suspect the current behaviour is intentional... Showing the final origin of the file would mean always showing CDN domains, rather than the domain from which the user believes they downloaded something (because they clicked a link on that domain). Marco, thoughts?</p>
</blockquote>
<p>From a user point of view, showing the page they clicked seems to make more sense. The CDN case is a very good fit, it could completely differ from where the user downloaded the file, and then they could be confused.<br>
On the other side, it seems to make sense to show the right origin of the file. Other browsers (I checked Chrome) show the complete final url, nothing about the originating page.<br>
Omitting one of the two information seems a loss to me. Maybe we should show both, like &quot;trusted -&gt; actual&quot;? Would users undestand that?</p>
<p>I&#39;m not sure whether the Downloads Panel itself should show origin information, it may be handy to show it once a download is complete, but  there are space limits that don&#39;t work well with a long origin string (the origin would end up being cut, that&#39;d be bad for spoofing, but we could provide a tooltip with the full text). I also checked what Chrome does here, and it doesn&#39;t show an origin in their quick downloads UI. That seems unfortunate. I wonder if we assume, since those are just downloads for the session, the user knows where they came from? Though redirects are turning the table.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mak)</span></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="14849156" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a2681_159069"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 05:08 PDT" data-time="1590667734">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="14849156" data-ismarkdown="true" ><p>(In reply to Marco Bonardo [:mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c7" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #7</a>)</p>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c1" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #1</a>)</p>
<blockquote>
<blockquote>
<ul>
<li>Once the download has completed, click the Download UI Button, and the file should show there. No host is displayed. Click &#39;Show All Downloads&#39; and the downloaded file will show in the list with the host shown as the trusted device, not the true download site.</li>
</ul>
</blockquote>
<p>FWIW, I suspect the current behaviour is intentional... Showing the final origin of the file would mean always showing CDN domains, rather than the domain from which the user believes they downloaded something (because they clicked a link on that domain). Marco, thoughts?</p>
</blockquote>
<p>From a user point of view, showing the page they clicked seems to make more sense. The CDN case is a very good fit, it could completely differ from where the user downloaded the file, and then they could be confused.<br>
On the other side, it seems to make sense to show the right origin of the file. Other browsers (I checked Chrome) show the complete final url, nothing about the originating page.<br>
Omitting one of the two information seems a loss to me. Maybe we should show both, like &quot;trusted -&gt; actual&quot;? Would users undestand that?</p>
</blockquote>
<p>What&#39;s worth noting is that Firefox, in our opinion, correctly handles the UI Behaviour for HTTP GET requests - in our testing with the PoC given in the report, we set the redirect to the Burp Suite Community download, the dialog showed portswigger.net as the &#39;from:&#39; before saving/opening the file, and also showed portswigger.net as the host in the Download List panel. For POST requests, however, the &#39;from:&#39; correctly was displayed as portswigger.net, but the Download list panel listed cs.bham.ac.uk as the host (I ran the PoC on an internal server on our network).</p>
<p>If a user has developed trust in the Firefox download mechanism and its behaviour for GET requests, it is reasonable to assume they&#39;ll demonstrate the same behaviour on a POST request (if the dialog is not shown). If the dialog isn&#39;t shown, they are shown the host is the trusted device, in which case, most users would happily double click to launch, as they see the host as the trusted system. This then has a serious impact on trust, as a user trusts the device, and if it is exploited by an Open Redirect they will be very likely to run the file if the Download List panel states it came from an endpoint trusted by the user, and not the true download host.</p>
<blockquote>
<p>I&#39;m not sure whether the Downloads Panel itself should show origin information, it may be handy to show it once a download is complete, but  there are space limits that don&#39;t work well with a long origin string (the origin would end up being cut, that&#39;d be bad for spoofing, but we could provide a tooltip with the full text). I also checked what Chrome does here, and it doesn&#39;t show an origin in their quick downloads UI. That seems unfortunate. I wonder if we assume, since those are just downloads for the session, the user knows where they came from? Though redirects are turning the table.</p>
</blockquote>
<p>Re: a user knowing where the download came from, my comment above should shed light on this - a user is not being told where the download really comes from, especially if the &#39;always save&#39; checkbox has been checked at some point in time, where the first time they see the host would be through the download list panel.</p>
<p>You raise an interesting point. From testing just now, if you close Firefox fully down, reopen it and go to Library &gt; Downloads, the host in the Download List panel for the download reverts to the true download host, where, in the previous session, it would have had the host issuing the redirect. This issue therefore doesn&#39;t persist across sessions, in which case it&#39;s too late as a user will typically immediately open the file they downloaded, rather than revisit the download via the Download panel, after restarting a session with Firefox. There&#39;s a definite disparity in the handling of the host between download and restarting a session.</p>
<p>I think that showing trusted -&gt; actual would introduce some confusion to the user - however, telling the user the host that served the file is more worthwhile, since it a) reinforces a user decision if they knowingly saved/selected open via the download dialog, as they know the &#39;from&#39; from that dialog and it would correspond to the download panel, and is the exact behaviour shown in GET requests, b) if they see a host they do not expect, they can apply reasonable judgement, (i.e. why did a Firefox download come from evil.com, not *.mozilla.com for example), and c) Firefox offers to give the user the download link page for the download.</p>
<p>a) is weakened somewhat if the &#39;always save&#39; checkbox has been ticked at some point in time before the POST is followed, as the first time they see the download host is in the Download List panel.</p>
</div></div><div class="change-set" id="c9"><div class="comment" data-id="14849252" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a2681_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a2681_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 05:53 PDT" data-time="1590670410">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="14849252" data-ismarkdown="true" ><p>OK, clearly I need to set this up to try and reproduce, and because it&#39;s crunch time for 78 (which will be an esr) branching to beta I can&#39;t do it literally right now, setting needinfo so I don&#39;t forget - I should still get to this by the end of the week at the latest.</p>
</div><div class="activity"><div class="change">Severity: normal &rarr; --</div><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="a29930_1689"><div class="change" id="aa29930_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a29930_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a29930_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a29930_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a29930_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-28 10:11 PDT" data-time="1590685919">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          
            <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a></div></div></div><div class="change-set" id="c10"><div class="comment" data-id="14856904" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-01 15:30 PDT" data-time="1591050647">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1641487&amp;comment_id=14856904"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="14856904" data-ismarkdown="true" ><p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c6" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #6</a>)</p>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c1" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #1</a>)</p>
<blockquote>
<p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c0" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #0</a>)</p>
<blockquote>
<ul>
<li>Submit a HTTP POST request to a trusted device, which will issue a HTTP 302 Redirect to another site, hosting a download.</li>
</ul>
</blockquote>
<p>Is the POST part significant here, ie does it not happen with a 302 on a GET request?</p>
</blockquote>
<p>Yes - the download list shows the actual download site for GET requests, but POST triggers this disparity between the download dialog box (if shown) which has the real download site, and the download list showing the trusted device as the host.</p>
</blockquote>
<p>[snip]</p>
<blockquote>
<blockquote>
<p>FWIW, I suspect the current behaviour is intentional... Showing the final origin of the file would mean always showing CDN domains, rather than the domain from which the user believes they downloaded something (because they clicked a link on that domain). Marco, thoughts?</p>
</blockquote>
<p>I trust the two previous clarifications clear this point up too - in a GET (i.e. a user clicking onto or navigating directly to a URL), the final origin matches the dialog, but in POST, the dialog &#39;from:&#39; does not match the download host in the Download List.</p>
</blockquote>
<p>Sorry, this has taken me a while to get back to. But already early into my trying to dig into this, I&#39;m a bit surprised. Because I figured, based on this comment, that there&#39;s a trivial good/bad difference - the form from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c0" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #0</a> with a &quot;GET&quot; request to index.php should work (so shows portswigger in the downloads UI), and a form with a &quot;POST&quot; request doesn&#39;t (and shows the testcase host, <code>localhost</code> in my case). But that&#39;s not what I&#39;m seeing, I&#39;m seeing <code>localhost</code> everywhere, from a testcase that looks like this adaptation from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c0" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #0</a>:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;
&lt;form action=&quot;index.php&quot; method=&quot;GET&quot;&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
&lt;/form&gt;

&lt;p&gt;If you click the &quot;Submit&quot; button, the form-data will be sent to a page called &quot;/index.php&quot;.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>(OK, I actually created an <code>&lt;input type=radio&gt;</code> set of controls that lets me easily switch between POST and GET, but the effect is the same)</p>
<p>Does that match what you&#39;re seeing? Maybe I&#39;m misunderstanding where you think the POST/GET difference comes into it? Were you comparing to clicking a link that points to <code>index.php</code> , maybe?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(r.j.thomas)</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="14856914" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-01 15:38 PDT" data-time="1591051103">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="14856914" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c10" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #10</a>)</p>
<blockquote>
<p>Were you comparing to clicking a link that points to <code>index.php</code> , maybe?</p>
</blockquote>
<p>I just tried this, too, and this too displays <code>localhost</code>.</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="14857184" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a29930_1689"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-01 19:18 PDT" data-time="1591064325">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="14857184" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c11" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #11</a>)</p>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c10" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #10</a>)</p>
<blockquote>
<p>Were you comparing to clicking a link that points to <code>index.php</code> , maybe?</p>
</blockquote>
<p>I just tried this, too, and this too displays <code>localhost</code>.</p>
</blockquote>
<p>I hadn&#39;t tried serving the pages locally, but can confirm the behaviour you&#39;re seeing if <code>localhost</code> is serving the redirect side, I am seeing <code>localhost</code> named as the host in the download list.</p>
<p>On an external host, however, Firefox demonstrates this behaviour (your bad difference to GET) - I&#39;ve done a screen capture which I trust makes it clearer what is going on. This can be downloaded from <a href="https://www.dropbox.com/s/60onncb1a7jrpfv/firefox-download-ui.mov?dl=0" rel="nofollow">https://www.dropbox.com/s/60onncb1a7jrpfv/firefox-download-ui.mov?dl=0</a></p>
<p>In this video, I run a cURL request using POST and GET to show the server is returning the same response, then connect to an external host serving that simple HTML form, and show that Firefox correctly tells you the host in the save/open dialog as portswigger.net, but the Download List shows bham.ac.uk as the host, and if you navigate directly to index.php, i.e. a GET, the save/open dialog host matches what it says in the download list. I also include what Gatekeeper reports for both downloads.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(r.j.thomas)</span></div></div></div><div class="change-set" id="c13"><div class="comment" data-id="14857186" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a29930_1689"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-01 19:29 PDT" data-time="1591064963">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="14857186" data-ismarkdown="true" ><p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c12" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #12</a>)</p>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c11" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #11</a>)</p>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c10" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #10</a>)</p>
<blockquote>
<p>Were you comparing to clicking a link that points to <code>index.php</code> , maybe?</p>
</blockquote>
<p>I just tried this, too, and this too displays <code>localhost</code>.</p>
</blockquote>
<p>I hadn&#39;t tried serving the pages locally, but can confirm the behaviour you&#39;re seeing if <code>localhost</code> is serving the redirect side, I am seeing <code>localhost</code> named as the host in the download list.</p>
<p>On an external host, however, Firefox demonstrates this behaviour (your bad difference to GET) - I&#39;ve done a screen capture which I trust makes it clearer what is going on. This can be downloaded from <a href="https://www.dropbox.com/s/60onncb1a7jrpfv/firefox-download-ui.mov?dl=0" rel="nofollow">https://www.dropbox.com/s/60onncb1a7jrpfv/firefox-download-ui.mov?dl=0</a></p>
<p>In this video, I run a cURL request using POST and GET to show the server is returning the same response, then connect to an external host serving that simple HTML form, and show that Firefox correctly tells you the host in the save/open dialog as portswigger.net, but the Download List shows bham.ac.uk as the host, and if you navigate directly to index.php, i.e. a GET, the save/open dialog host matches what it says in the download list. I also include what Gatekeeper reports for both downloads.</p>
</blockquote>
<p>I&#39;ve also tested this by storing the HTML locally on my laptop and opening it in Firefox (via file:///..../test.html), hosting the PHP part on an external server and testing with POST - Firefox will show <code>local file</code> as the &#39;host&#39; in the Download List.</p>
</div></div><div class="change-set" id="c14"><div class="comment" data-id="14857603" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-02 03:03 PDT" data-time="1591092226">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-14" data-comment-id="14857603" data-ismarkdown="true" ><p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c12" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #12</a>)</p>
<blockquote>
<p>if you navigate directly to index.php, i.e. a GET, the save/open dialog host matches what it says in the download list. I also include what Gatekeeper reports for both downloads.</p>
</blockquote>
<p>OK, so (based on the video) you&#39;re comparing to navigating to index.php from the URL bar. Thanks!</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="14859462" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-02 16:40 PDT" data-time="1591141254">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-15" data-comment-id="14859462" data-ismarkdown="true" ><p>It would appear to be that the issue is caused by whether there is a referrer for the download. When submitting a form or clicking a link, a referrer is sent. When navigating directly to the URL that returns the 302 from the address bar, no referrer information is sent as part of that request, so no referrer info is available. <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=675902" title="RESOLVED FIXED - New Downloads view for Places Library">Bug 675902</a> (!) which originally implemented the view, implemented the status text to include the referrer, falling back to the source URL if there was no referrer info available. That behaviour has been kept all these years over various refactors.</p>
<p>It&#39;s possible that after the ReferrerInfo work (where we potentially keep the completely referrer info internally even when it is not sent (or restricted to origin info only) as an actual header, e.g. due to referrer policy or other restrictions), we now have a referrer more often than before, and that this issue wasn&#39;t as noticeable before.</p>
<p>I don&#39;t really understand why we&#39;d use the referrer at all here, unless it&#39;s for the reasons I outlined in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c1" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #1</a>. Marco, it&#39;s been a long time, but perhaps you remember?</p>
<p>(the difference after a restart is due to <a class="bz_bug_link
          bz_status_NEW" href="/show_bug.cgi?id=829201" title="NEW - History downloads lack referrer support">bug 829201</a> - we do not store the referrer info in the places DB that keeps the download records.)</p>
<p>I&#39;m a little skeptical about exploitation here though - presumably it&#39;d require user action on the trusted target page to submit the form, and this cannot be automated away, because loading <code>index.php</code> directly from the attacker page will use the attacker&#39;s referrer instead, which defeats the point (we&#39;ll show <code>evil.com</code> as the source of the download, instead of <code>cs.bham.ac.uk</code> or <code>portswigger.net</code>).</p>
<p>I haven&#39;t yet looked at the macOS gatekeeper stuff and where that data comes from / what macOS is doing there.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(mak)</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="14859918" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a29930_1689"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-03 00:26 PDT" data-time="1591169162">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-16" data-comment-id="14859918" data-ismarkdown="true" ><p>Thanks for the active discussion on this, especially with the context.</p>
<p>I can clarify the exploitation here. In <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c0" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment 0</a>, we found this issue whilst carrying out vulnerability research, where Open Redirect (CWE-601) vulnerabilities have been previously documented in the class of devices we are assessing. Previous exploitation of these vulnerabilities are typically achieved by a user receiving an email, say for a firmware update, where a convincing link to the update is given. In this case, the user will just need to press submit, and if, at some point, they checked the &#39;always save this type&#39; checkbox, when they verify the source of the download, they would see the trusted device as the host, not <code>evil.com</code>, which is where the Open Redirect was exploited to refer the user to somewhere that isn&#39;t the trusted device. They are therefore more likely to open the downloaded file, as they trust the trusted device on their network.<br>
In our PoC, we used <code>cs.bham.ac.uk</code> as the &#39;trusted device&#39; to simulate such a vulnerable system where I would trust anything on <code>cs.bham.ac.uk</code>. If the open/save dialog is shown to the user, they may question why the &#39;from:&#39; is <code>evil.com</code> when the source code shows the trusted device is where the request is going. If they continue to save, this provenance is lost for the session and the user will see the trusted device in the list, and then proceed to open the file.</p>
<p>I would say that <a class="bz_bug_link
          bz_status_NEW" href="/show_bug.cgi?id=829201" title="NEW - History downloads lack referrer support">bug 829201</a>, on the face of it, works as I would expect - what the user sees in the open/save dialog is what they see in the download list. The problem is within the running session, this behaviour is different, where the &#39;from:&#39; doesn&#39;t match the download host in the list which means that we lose what is possibly the last line of defence before a user runs malware.</p>
</div></div><div class="change-set" id="c17"><div class="comment" data-id="14860057" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a29930_1689"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-03 02:09 PDT" data-time="1591175390">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1641487&amp;comment_id=14860057"
     title="4 revisions">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-17" data-comment-id="14860057" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c15" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #15</a>)</p>
<blockquote>
<p>I don&#39;t really understand why we&#39;d use the referrer at all here, unless it&#39;s for the reasons I outlined in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c1" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #1</a>. Marco, it&#39;s been a long time, but perhaps you remember?</p>
</blockquote>
<p>I don&#39;t remember, but I assume the scope was to show the closest thing to the origin from which the user downloaded the file, rather than the origin of the file itself.  I also suspect we pretty much kept the behavior of the legacy toolkit download manager.<br>
It&#39;s possible we&#39;re giving too much importance to the &quot;user-facing&quot; origin, since it&#39;s session-only the user is more likely to remember which page the download came from, and more interested to know from where it was actually downloaded.<br>
Off-hand, the simplest approach here seems to just stop using the referrer. The downside is that the user may be a bit more confused in some cases (like the cdn example you pointed out), but in the end that confusion may actually be a safer path, bringing to more &quot;do I trust this origin&quot; questioning.<br>
I still think the best approach would be to show both info, but considering the UX complications and lack of resources, I&#39;d not hold my breath for that. I&#39;d rather, once a download is complete, show the origin in the Downloads Panel too (must test appropriate cropping for long origins), potentially also in a follow-up.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mak)</span></div></div></div><div class="change-set" id="c18"><div class="comment" data-id="14876078" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_575867" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/9eb8612b118640351041fb0877c5fc8f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_575867" id="a29930_1689"><a class="email " href="/user_profile?user_id=575867" > <span class="fna">Release mgmt bot [:sylvestre / :calixte / :marco for bugbug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-11 05:11 PDT" data-time="1591877490">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="14876078" data-ismarkdown="true" ><p>The severity field is not set for this bug.<br>
:mak, could you have a look please?</p>
<p>For more information, please visit <a href="https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py" rel="nofollow">auto_nag documentation</a>.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(mak)</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="14876089" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-11 05:15 PDT" data-time="1591877759">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="14876089" data-ismarkdown="true" ><p>Still looking at this, though I&#39;m a little overloaded so it&#39;s been slow going.</p>
</div><div class="activity"><div class="change">Assignee: nobody &rarr; gijskruitbosch+bugs</div><div class="change">Severity: -- &rarr; S3</div><div class="change">Status: UNCONFIRMED &rarr; ASSIGNED</div><div class="change">Ever confirmed: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(mak)</span></div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="14983801" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a29930_1689"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-11 01:51 PDT" data-time="1597135900">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-20" data-comment-id="14983801" data-ismarkdown="true" ><p>Hi,<br>
Is there any update on this - if there&#39;s any support we can provide to replicate/demonstrate the issue, please let us know.</p>
<p>Best regards,<br>
Richard</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="14985357" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-11 13:37 PDT" data-time="1597178244">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1641487&amp;comment_id=14985357"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="14985357" data-ismarkdown="true" ><p>(In reply to Richard J. Thomas from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c20" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #20</a>)</p>
<blockquote>
<p>Is there any update on this - if there&#39;s any support we can provide to replicate/demonstrate the issue, please let us know.</p>
</blockquote>
<p>Apologies for the delay here. I&#39;ve just been looking at this again. It&#39;s straightforward to remove the referrer from the internal downloads view; I have a patch in hand for that (though I&#39;ve not checked what automated tests, if any, need updating).</p>
<p>However, the quarantine stuff is more confusing. I was initially not able to reproduce. It appears this is because Apple has some kind of exception for <code>localhost</code>. If I host a test page on my own (public internet) website instead of on <code>localhost</code>, I can reproduce, but the exact same download using <code>localhost</code> correctly shows <code>portswigger.net</code> as the origin of the download.</p>
<p>As your screenshots indicate, the &quot;kMDItemWhereFroms&quot; data is the same between Safari and Nightly. However, we have both that and the quarantine data, and that data is stored in a central DB, not in the file attributes.</p>
<p>Chrome has the same issue with macOS&#39;s UI (ie the gatekeeper dialog shows the referrer, not the origin). Our quarantine code is here: <a href="https://searchfox.org/mozilla-central/rev/ab81b8552f4aa9696a2524f97fdfeb59d4dc31c1/xpcom/io/CocoaFileUtils.mm#247-263" rel="nofollow">https://searchfox.org/mozilla-central/rev/ab81b8552f4aa9696a2524f97fdfeb59d4dc31c1/xpcom/io/CocoaFileUtils.mm#247-263</a> . The Chrome equivalent is at <a href="https://source.chromium.org/chromium/chromium/src/+/master:components/services/quarantine/quarantine_mac.mm;l=171-190?q=kLSQuarantineOriginURLKey&amp;ss=chromium" rel="nofollow">https://source.chromium.org/chromium/chromium/src/+/master:components/services/quarantine/quarantine_mac.mm;l=171-190?q=kLSQuarantineOriginURLKey&amp;ss=chromium</a>  . As you can see we do more or less the same thing even if the code is a little different (and as is also obvious from these code snippets, Apple&#39;s variable naming is pretty confusing!).</p>
<p>This is what the quarantine DB looks like (with hashes/timestamps removed):</p>
<pre><code>$ sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 &quot;select * from LSQuarantineEvent;&quot; | grep --ignore-case burp|
org.mozilla.nightly|Firefox Nightly|https://portswigger.net/burp/releases/download?product=community&amp;version=2020.4.1&amp;type=MacOsx|||0||https://www.gijsk.com/temp/post-redirect-download/index.html|
com.google.Chrome|Chrome|https://portswigger.net/burp/releases/download?product=community&amp;version=2020.4.1&amp;type=MacOsx|||0||https://www.gijsk.com/temp/post-redirect-download/index.html|
com.apple.Safari|Safari|https://portswigger.net/burp/releases/download?product=community&amp;version=2020.4.1&amp;type=MacOsx|||0|||
</code></pre>
<p>As you can see, Safari omits the redirect info from the quarantine DB. <em>Why</em> this happens is a bit of a mystery to me. Chrome and Firefox both have devtools that let me see the request headers; I can&#39;t easily do this in Safari (and it&#39;s all TLS requests, so can&#39;t easily check with other tools) so I don&#39;t know if the difference is simply that Safari doesn&#39;t send the referrer for this download for some reason - though that&#39;d be a bit odd - I see the same behaviour even if I have a simple link from <code>gijsk.com</code> to the dmg, which you&#39;d definitely expect to have a referrer header.</p>
<p>So the question is whether we (and Chrome?) should stop passing the data to macOS, I guess? The documentation from Apple about the key where we put the referrer is at <a href="https://developer.apple.com/documentation/coreservices/klsquarantineoriginurlkey" rel="nofollow">https://developer.apple.com/documentation/coreservices/klsquarantineoriginurlkey</a> and says:</p>
<blockquote>
<p>For web downloads, this property is the URL of the web page on which the user initiated the download. For attachments, this property is the URL of the resource to which the quarantined item was attached (e.g. the email message, calendar event, etc.). The origin URL may be a file URL for local resources, or a custom URL to which the quarantining app will respond when asked to open it. The quarantining app should respond by displaying the resource to the user.</p>
</blockquote>
<blockquote>
<p>The origin URL should not be set to the data URL, or the quarantining app may start downloading the file again if the user choses to view the origin URL while resolving a quarantine warning.</p>
</blockquote>
<p>This implies that there is/was macOS quarantine UI that uses the referrer/origin URL in a way that&#39;s equivalent to Firefox&#39;s &quot;Go To Download Page&quot;, where I think the resulting browser <em>should</em> show the original page (bham.ac.uk in the original report).</p>
<p>I agree that the current gatekeeper UI display can be confusing, but I don&#39;t see a good solution purely from Firefox/Chrome&#39;s perspective to resolve this dual purpose for the quarantine info; I think it&#39;s probably something to raise with Apple.</p>
<p>Does this all make sense?</p>
<p>(edited for clarity)</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(r.j.thomas)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="14985367" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-11 13:47 PDT" data-time="1597178840">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9169497"
         class="attachment"
         data-id="9169497" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D86761-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9169497" itemprop="contentUrl">
        <span id="att-9169497-description" itemprop="description">Bug 1641487, r?jaws</span></a>
        — <a href="attachment.cgi?id=9169497&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c23"><div class="comment" data-id="14985923" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a29930_1689"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-12 01:31 PDT" data-time="1597221090">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="14985923" data-ismarkdown="true" ><p>Hi,<br>
Thanks for looking into this. I think the patch you&#39;ve suggested would bring the POST behaviour in line with what GET does for Firefox, and would remove that possible end-user confusion, and reduce the risk of successful exploitation (i.e. the user seeing a trusted device in the download list and continuing to run/execute that downloaded file). That would also resolve the issue across <em>all</em> of the Firefox installation base.</p>
<p>On the same day we raised this report with Mozilla, we did notify Apple about Gatekeeper and the report remains open - I&#39;ll update the report to see what the progress is on their side as this picks up the final thing that would prevent successful exploitation.</p>
<p>Best regards,<br>
Richard</p>
</div><div class="activity"><div class="change">Flags: needinfo?(r.j.thomas) &rarr; needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="14987503" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a29930_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a29930_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-13 03:37 PDT" data-time="1597315051">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="14987503" data-ismarkdown="true" ><p>This is on autoland:</p>
<p><a href="https://hg.mozilla.org/integration/autoland/rev/082de8244278d76f9d6d216a7fd5da772b5152d3" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/082de8244278d76f9d6d216a7fd5da772b5152d3</a></p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c25"><div class="comment" data-id="14987890" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a29930_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a29930_1689"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-13 08:51 PDT" data-time="1597333918">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="14987890" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/mozilla-central/rev/082de8244278" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/082de8244278</a></p>
</div><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security-release</div><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2020-08-13 08:51 PDT" data-time="1597333918">1 year ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox81&amp;o1=isnotempty">status-firefox81</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox81&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; 81 Branch</div></div></div><div class="change-set" id="a6715447_75935"><div class="change" id="aa6715447_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a6715447_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6715447_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6715447_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a6715447_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-13 19:17 PDT" data-time="1597371436">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox79&amp;o1=isnotempty">status-firefox79</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox79&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox80&amp;o1=isnotempty">status-firefox80</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox80&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=isnotempty">status-firefox-esr78</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c26"><div class="comment" data-id="14989104" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6715447_75935"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-14 06:29 PDT" data-time="1597411771">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="14989104" data-ismarkdown="true" ><p>Would you mind verifying that the issue in Firefox itself here is fixed in today&#39;s nightly? You can download nightly from <a href="https://nightly.mozilla.org/" rel="nofollow">https://nightly.mozilla.org/</a> . (Obviously I think it&#39;s fixed, but it&#39;d be good to have confirmation we&#39;re on the same page. :-) )</p>
</div><div class="activity"><div class="change">Flags: needinfo?(r.j.thomas)</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="14989122" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a6715447_75935"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-14 06:49 PDT" data-time="1597412982">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-27" data-comment-id="14989122" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c26" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #26</a>)</p>
<blockquote>
<p>Would you mind verifying that the issue in Firefox itself here is fixed in today&#39;s nightly? You can download nightly from <a href="https://nightly.mozilla.org/" rel="nofollow">https://nightly.mozilla.org/</a> . (Obviously I think it&#39;s fixed, but it&#39;d be good to have confirmation we&#39;re on the same page. :-) )</p>
</blockquote>
<p>Hi,<br>
I&#39;ve loaded a fresh VM and installed nightly (81.0a1) and the latest production Firefox (79.0) and have tested this out using the same steps as in the report.<br>
In nightly, I&#39;m seeing the correct and same results as you (that is the hostname is the download host, not the redirect one) - GET and POST now have the same behaviour. In Firefox 79 (a version we know is affected), GET and POST result in different hostnames (one the true download site, the other the redirect source), so it looks like the patch has resolved the issue.</p>
<p>Thanks for you and your colleague&#39;s help in the resolution of this issue.</p>
<p>Best regards,<br>
Richard</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(r.j.thomas)</span></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="14989144" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_663870" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/2d66aebd4ee981870fd765f4299fbf86?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_663870" id="a6715447_75935"><a class="email " href="/user_profile?user_id=663870" > <span class="fna">Richard J. Thomas</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-14 07:14 PDT" data-time="1597414463">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="14989144" data-ismarkdown="true" ><p>Sorry - forgot to tag you back in the response.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="14989184" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6715447_75935"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-14 07:39 PDT" data-time="1597415989">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="14989184" data-ismarkdown="true" ><p>Thank you!</p>
</div><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox81&amp;o1=isnotempty">status-firefox81</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox81&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox81&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c30"><div class="comment" data-id="15005740" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6715447_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-25 11:57 PDT" data-time="1598381850">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="15005740" data-ismarkdown="true" ><p>On second pass through going to call this one sec-moderate instead of sec-low -- making the OS lie to users seems slightly more serious than just bad UI.</p>
</div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c31"><div class="comment" data-id="15005914" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6715447_75935"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-25 13:44 PDT" data-time="1598388269">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1641487&amp;comment_id=15005914"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-31" data-comment-id="15005914" data-ismarkdown="true" ><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c30" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #30</a>)</p>
<blockquote>
<p>On second pass through going to call this one sec-moderate instead of sec-low -- making the OS lie to users seems slightly more serious than just bad UI.</p>
</blockquote>
<p>So to be clear, we didn&#39;t change anything in this bug regarding what we tell macOS. What we (and Chrome!) tell macOS matches what the docs say we should tell them (see <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c21" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #21</a>). If I had any idea how to raise this with Apple, I would. (Edit: though also, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487#c23" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">comment #23</a> suggests the reporter has done so already)</p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="15026524" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a6715447_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-08 13:30 PDT" data-time="1599597035">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-32" data-comment-id="15026524" data-ismarkdown="true" ><p>Hi Gijs, does this need an ESR78 approval request?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="15026573" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6715447_75935"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-08 14:06 PDT" data-time="1599599164">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-33" data-comment-id="15026573" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9169497" name="attach_9169497" title="Bug 1641487, r?jaws">attachment 9169497</a> <a href="/attachment.cgi?id=9169497&amp;action=edit" title="Bug 1641487, r?jaws">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">Bug 1641487</a>, r?jaws</p>
<h3>ESR Uplift Approval Request</h3>
<ul>
<li><strong>If this is not a sec:{high,crit} bug, please state case for ESR consideration</strong>: sec-moderate</li>
<li><strong>User impact if declined</strong>: Potentially confusing UI around the origin of downloads</li>
<li><strong>Fix Landed on Version</strong>: 81</li>
<li><strong>Risk to taking this patch</strong>: Low</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: Strictly removal of a few lines of code</li>
<li><strong>String or UUID changes made by this patch</strong>: None</li>
</ul>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div><div class="change">
        <a href="/attachment.cgi?id=9169497&amp;action=edit"
           title="Bug 1641487, r?jaws"
           class=""
        >Attachment #9169497</a> -
        Flags: approval-mozilla-esr78?</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="15027711" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a6715447_75935"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_580382" id="a6715447_75935"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-09 06:18 PDT" data-time="1599657483">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-34" data-comment-id="15027711" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9169497" name="attach_9169497" title="Bug 1641487, r?jaws">attachment 9169497</a> <a href="/attachment.cgi?id=9169497&amp;action=edit" title="Bug 1641487, r?jaws">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1641487" title="VERIFIED FIXED - Firefox Browser - Download Site Obscured from User">Bug 1641487</a>, r?jaws</p>
<p>approved for 78.3</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9169497&amp;action=edit"
           title="Bug 1641487, r?jaws"
           class=""
        >Attachment #9169497</a> -
        Flags: approval-mozilla-esr78? &rarr; approval-mozilla-esr78+</div></div></div><div class="change-set" id="a9001518_580382"><div class="change" id="aa9001518_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a9001518_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a9001518_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9001518_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9001518_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a9001518_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-09 06:18 PDT" data-time="1599657507">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr78&amp;o1=isnotempty">tracking-firefox-esr78</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr78&amp;o1=equals&amp;v1=81%2B">81+</a></div></div></div><div class="change-set" id="c35"><div class="comment" data-id="15028384" data-no="35"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a9001518_580382"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a9001518_580382"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-09 12:16 PDT" data-time="1599679003">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-35" data-comment-id="15028384" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/mozilla-esr78/rev/2ceaf2421137" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr78/rev/2ceaf2421137</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=isnotempty">status-firefox-esr78</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a9548251_578488"><div class="change" id="aa9548251_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a9548251_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a9548251_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9548251_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9548251_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a9548251_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-15 14:10 PDT" data-time="1600204240">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external] [client-bounty-form] [verif?] &rarr; [reporter-external] [client-bounty-form] [verif?][adv-main81+]</div></div></div><div class="change-set" id="a9548299_578488"><div class="change" id="aa9548299_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a9548299_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a9548299_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9548299_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9548299_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a9548299_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-15 14:11 PDT" data-time="1600204288">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main81+] &rarr; [reporter-external] [client-bounty-form] [verif?][adv-main81+][adv-esr78.3+]</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="15037983" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a9548299_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a9548299_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-15 14:16 PDT" data-time="1600204567">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9175901"
         class="attachment obsolete"
         data-id="9175901" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1641487.txt">
      <meta itemprop="contentSize" content="405">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9175901" itemprop="contentUrl">
        <span id="att-9175901-description" itemprop="description">advisory.txt</span></a> (obsolete)
        — <a href="attachment.cgi?id=9175901&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a9548741_578488"><div class="change" id="aa9548741_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a9548741_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a9548741_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9548741_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9548741_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a9548741_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-15 14:18 PDT" data-time="1600204730">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9175901&amp;action=edit"
           title="advisory.txt"
           class=""
        >Attachment #9175901</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="15039516" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a9548741_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a9548741_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-16 10:36 PDT" data-time="1600277769">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9176112"
         class="attachment obsolete"
         data-id="9176112" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1641487.txt">
      <meta itemprop="contentSize" content="405">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9176112" itemprop="contentUrl">
        <span id="att-9176112-description" itemprop="description">advisory.txt</span></a> (obsolete)
        — <a href="attachment.cgi?id=9176112&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c38"><div class="comment" data-id="15044462" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a9548741_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a9548741_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-20 21:13 PDT" data-time="1600661639">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9176804"
         class="attachment"
         data-id="9176804" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1641487.txt">
      <meta itemprop="contentSize" content="367">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9176804" itemprop="contentUrl">
        <span id="att-9176804-description" itemprop="description">advisory.txt</span></a>
        — <a href="attachment.cgi?id=9176804&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9176112&amp;action=edit"
           title="advisory.txt"
           class=""
        >Attachment #9176112</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a10006341_578488"><div class="change" id="aa10006341_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a10006341_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a10006341_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10006341_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10006341_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a10006341_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-20 21:25 PDT" data-time="1600662330">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2020-15677</div></div></div><div class="change-set" id="a17683675_1689"><div class="change" id="aa17683675_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a17683675_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a17683675_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a17683675_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a17683675_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1641487#a17683675_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-12-18 17:01 PST" data-time="1608339664">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1641487&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>