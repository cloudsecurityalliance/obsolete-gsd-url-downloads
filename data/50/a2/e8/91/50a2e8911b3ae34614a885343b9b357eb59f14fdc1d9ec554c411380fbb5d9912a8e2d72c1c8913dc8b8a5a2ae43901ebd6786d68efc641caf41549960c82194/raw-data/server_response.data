<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1042699 - (CVE-2015-4498) Firefox Addon bypass dialog and spoof vulnerability">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1042699">
<meta property="og:description"
      content="RESOLVED (dtownsend) in Toolkit - Add-ons Manager. Last updated 2017-03-29.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1042699 - (CVE-2015-4498) Firefox Addon bypass dialog and spoof vulnerability</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1042699&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1042699">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1042699">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/yui.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/global.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/util.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox41\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox42\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr38\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox40\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"tracking\":{\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_b2g_2_2r\":\"unaffected\",\"cf_status_b2g_2_0m\":\"unaffected\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox42\":\"fixed\",\"cf_status_firefox41\":\"fixed\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_b2g_2_0\":\"unaffected\",\"cf_status_firefox_esr38\":\"fixed\",\"cf_status_b2g_2_2\":\"unaffected\",\"cf_tracking_firefox_esr38\":\"40+\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox40\":\"+\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox40\":\"fixed\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox43\":\"fixed\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox42\":\"+\",\"cf_status_firefox39\":\"wontfix\",\"cf_status_b2g_2_1_s\":\"unaffected\",\"cf_status_b2g_2_1\":\"unaffected\",\"cf_status_b2g_master\":\"unaffected\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox41\":\"+\",\"cf_status_firefox_esr91\":\"---\"},\"project\":{\"cf_a11y_review_project_flag\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1042699;
  BUGZILLA.bug_title = '1042699 - (CVE-2015-4498) Firefox Addon bypass dialog and spoof vulnerability';
  BUGZILLA.bug_summary = 'Firefox Addon bypass dialog and spoof vulnerability';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1042699';
  BUGZILLA.bug_keywords = 'csectype-spoof, sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/field.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/comments.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1042699">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1042699"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1042699 - (CVE-2015-4498) Firefox Addon bypass dialog and spoof vulnerability">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="UUw4m1e03i1RCMgytRVCvOFNiYb8eJmXfGuvp9peO58NfCH5yRr6n2kZ75VaHH45cSnkZlGsdhERUZNpGpCaisyEciukNiowbh3ooAO7SumnkVmSLCvtneV0Mrp5OzgaXumek87MR1WfpDu0uIIdabDFXeEtx8HhMLMWpt4FgGPSkeNJJfgfBjQA8vUZ6nQy5CxwtMn4rme58ajoeuim5cRhomS9dMR81Dyno2hGmm6kvmhS3fuvPiL6FSX7ou0V">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1042699" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622467-6ZUEeDc5CkkMeTKm_pXOijOunSqAX5XT4_AD-Xp7s_k">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1042699" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1042699" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1042699">Bug 1042699</a>
          <span class="edit-hide">(CVE-2015-4498)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2014-07-23 07:26 PDT" data-time="1406125595">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2015-08-24 18:06 PDT" data-time="1440464792">6 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Firefox Addon bypass dialog and spoof vulnerability</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Firefox Addon bypass dialog and spoof vulnerability

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Toolkit :: Add-ons Manager, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Toolkit
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Toolkit</div>
            <div class="description">The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. (<a href="https://wiki.mozilla.org/Modules/Toolkit">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Add-ons Manager
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Toolkit :: Add-ons Manager</div>
            <div class="description">The management and update windows for extensions and themes (add-ons).</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Add-ons%20Manager&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Add-ons%20Manager&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit&amp;component=Add-ons%20Manager"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit" data-component="Add-ons Manager"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            31 Branch

        </span>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            x86_64

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            major

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_b2g_2_0&quot;:&quot;unaffected&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;name&quot;:&quot;sec-bounty&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;name&quot;:&quot;in-testsuite&quot;,&quot;status&quot;:&quot;+&quot;}],&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox42&quot;:&quot;fixed&quot;,&quot;cf_status_firefox41&quot;:&quot;fixed&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_status_firefox40&quot;:&quot;fixed&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_b2g_2_2&quot;:&quot;unaffected&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla43&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox39&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox42&quot;:&quot;+&quot;,&quot;cf_status_firefox_esr38&quot;:&quot;fixed&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_b2g_2_2r&quot;:&quot;unaffected&quot;,&quot;cf_status_b2g_2_0m&quot;:&quot;unaffected&quot;,&quot;cf_status_firefox43&quot;:&quot;fixed&quot;,&quot;id&quot;:1042699,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr38&quot;:&quot;40+&quot;,&quot;cf_tracking_firefox40&quot;:&quot;+&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-spoof&quot;,&quot;sec-high&quot;],&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_firefox41&quot;:&quot;+&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_b2g_2_1_s&quot;:&quot;unaffected&quot;,&quot;cf_status_b2g_master&quot;:&quot;unaffected&quot;,&quot;cf_status_b2g_2_1&quot;:&quot;unaffected&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla43

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox39</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox40</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox40&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox41</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox41&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox42</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox43</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr38</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=40%2B">40+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0M</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1S</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.2</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.2r</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_2r&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-master</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox39</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox39-dirty">
  <select id="cf_status_firefox39" name="cf_status_firefox39">
        <option value="wontfix"
          id="v2164_cf_status_firefox39" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox40</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox40-dirty">
  <select id="cf_tracking_firefox40" name="cf_tracking_firefox40">
        <option value="+"
          id="v2194_cf_tracking_firefox40" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox40-dirty">
  <select id="cf_status_firefox40" name="cf_status_firefox40">
        <option value="fixed"
          id="v2200_cf_status_firefox40" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox41</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox41-dirty">
  <select id="cf_tracking_firefox41" name="cf_tracking_firefox41">
        <option value="+"
          id="v2253_cf_tracking_firefox41" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox41-dirty">
  <select id="cf_status_firefox41" name="cf_status_firefox41">
        <option value="fixed"
          id="v2259_cf_status_firefox41" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox42</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox42-dirty">
  <select id="cf_tracking_firefox42" name="cf_tracking_firefox42">
        <option value="+"
          id="v2305_cf_tracking_firefox42" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox42-dirty">
  <select id="cf_status_firefox42" name="cf_status_firefox42">
        <option value="fixed"
          id="v2311_cf_status_firefox42" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox43</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox43-dirty">
  <select id="cf_status_firefox43" name="cf_status_firefox43">
        <option value="fixed"
          id="v2371_cf_status_firefox43" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr38</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr38-dirty">
  <select id="cf_tracking_firefox_esr38" name="cf_tracking_firefox_esr38">
        <option value="40+"
          id="v2347_cf_tracking_firefox_esr38" selected
        >40+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr38-dirty">
  <select id="cf_status_firefox_esr38" name="cf_status_firefox_esr38">
        <option value="fixed"
          id="v2149_cf_status_firefox_esr38" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0-dirty">
  <select id="cf_status_b2g_2_0" name="cf_status_b2g_2_0">
        <option value="unaffected"
          id="v1601_cf_status_b2g_2_0" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0M</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0m-dirty">
  <select id="cf_status_b2g_2_0m" name="cf_status_b2g_2_0m">
        <option value="unaffected"
          id="v1912_cf_status_b2g_2_0m" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1-dirty">
  <select id="cf_status_b2g_2_1" name="cf_status_b2g_2_1">
        <option value="unaffected"
          id="v1735_cf_status_b2g_2_1" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1S</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1_s-dirty">
  <select id="cf_status_b2g_2_1_s" name="cf_status_b2g_2_1_s">
        <option value="unaffected"
          id="v2119_cf_status_b2g_2_1_s" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.2</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_2-dirty">
  <select id="cf_status_b2g_2_2" name="cf_status_b2g_2_2">
        <option value="unaffected"
          id="v1876_cf_status_b2g_2_2" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.2r</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_2r-dirty">
  <select id="cf_status_b2g_2_2r" name="cf_status_b2g_2_2r">
        <option value="unaffected"
          id="v2350_cf_status_b2g_2_2r" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-master</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_master-dirty">
  <select id="cf_status_b2g_master" name="cf_status_b2g_master">
        <option value="unaffected"
          id="v2076_cf_status_b2g_master" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: bas.venis, Assigned: mossop)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_91159" ><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=91159" > <span class="fna">mossop</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_512384" ><img src="https://secure.gravatar.com/avatar/fab9bf2c8527f284150406dc4034439e?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=512384" > <span class="fna">bas.venis</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_372685" ><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=372685" > <span class="fna">mixedpuppy</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="38">38 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell"
   href="/show_bug.cgi?id=1105556">1105556</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - 40.0.3 broke ability to install featured addons from the add-ons manager"
   href="/show_bug.cgi?id=1200027">1200027</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Installing via direct links to addons XPI fails"
   href="/show_bug.cgi?id=1201534">1201534</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INACTIVE - [e10s] Cannot install add-on / extension via drag and drop to tabstrip"
   href="/show_bug.cgi?id=1202271">1202271</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - Can't install extensions when e10s is enabled and the current tab is not remote"
   href="/show_bug.cgi?id=1204215">1204215</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - [e10s] Add-on installation fails when the current tab is non-remote"
   href="/show_bug.cgi?id=1214210">1214210</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1042699&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1042699">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Bypass XPI Installation Prompt &quot;Firefox prevented this site...&quot; for Installing Addons"
   href="/show_bug.cgi?id=1065876">1065876</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-spoof, sec-high, Whiteboard: [reporter-external] leave hidden until bug 1105556 is fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2015-4498

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[reporter-external] leave hidden until bug 1105556 is fixed
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a34651941_1689"
            class="rel-time-title activity-ref"
            title="7 years ago"
        data-time="1434000565"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1189240">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1189240-dirty">
      <select id="flag-1189240" name="flag-1189240"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c48"
            class="rel-time-title activity-ref"
            title="6 years ago"
        data-time="1440464792"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1238475">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1238475-dirty">
      <select id="flag-1238475" name="flag-1238475"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (7 files, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8460893">poc.zip</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2014-07-23 07:26 PDT" data-time="1406125595">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_512384" ><a class="email " href="/user_profile?user_id=512384" > <span class="fna">Bas Venis</span></a>
</div></span>
        </div>
        <div class="attach-info">7.17 MB,
          application/java-archive        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8460893&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8650158">patch</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2015-08-19 15:02 PDT" data-time="1440021750">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div></span>
        </div>
        <div class="attach-info">93.29 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c39"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440021750"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8650158&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8650158&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8650158">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8651890">patch</a>
        </div>
        <div>
            <a href="#c41" class="attach-time activity-ref"><span class="rel-time" title="2015-08-24 11:21 PDT" data-time="1440440500">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div></span>
        </div>
        <div class="attach-info">93.34 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440440500"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a34419448_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440532304"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c43"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440452513"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8651890&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8651890&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8651890">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8652086"
              title="Fennec add-on install UI"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Fennec add-on install UI
            </a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2015-08-24 17:43 PDT" data-time="1440463434">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_346894" ><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div></span>
        </div>
        <div class="attach-info">104.70 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8652086&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8652099">ESR patch</a>
        </div>
        <div>
            <a href="#c49" class="attach-time activity-ref"><span class="rel-time" title="2015-08-24 18:11 PDT" data-time="1440465104">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div></span>
        </div>
        <div class="attach-info">83.05 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c56"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440532437"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c58"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440535073"
            >
              approval-mozilla-esr38+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8652099&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8652099&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652099">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8652513">beta patch</a>
        </div>
        <div>
            <a href="#c53" class="attach-time activity-ref"><span class="rel-time" title="2015-08-25 12:52 PDT" data-time="1440532336">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div></span>
        </div>
        <div class="attach-info">92.28 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c59"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440532336"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8652513&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8652513&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652513">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8652514">release patch</a>
        </div>
        <div>
            <a href="#c54" class="attach-time activity-ref"><span class="rel-time" title="2015-08-25 12:52 PDT" data-time="1440532364">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div></span>
        </div>
        <div class="attach-info">92.23 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a34419437_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1440532364"
            >
              approval-mozilla-release+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8652514&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8652514&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652514">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8652680">ESR tests</a>
        </div>
        <div>
            <a href="#c64" class="attach-time activity-ref"><span class="rel-time" title="2015-08-25 19:45 PDT" data-time="1440557110">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div></span>
        </div>
        <div class="attach-info">7.82 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8652680&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8652680&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652680">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="0LkZPppOmpxm4p46I0HC12xvZVubpPd9yR89Ds3I0xdaQymX">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9090225" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_512384" ><img src="https://secure.gravatar.com/avatar/fab9bf2c8527f284150406dc4034439e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_512384" ><a class="email " href="/user_profile?user_id=512384" > <span class="fna">Bas Venis</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-07-23 07:26 PDT" data-time="1406125595">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8460893"
         class="attachment"
         data-id="8460893" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="poc.zip">
      <meta itemprop="contentSize" content="7514665">
      <meta itemprop="encodingFormat" content="application/java-archive">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8460893" itemprop="contentUrl">
        <span id="att-8460893-description" itemprop="description">poc.zip</span></a>
        — <a href="attachment.cgi?id=8460893&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="9090225">Normally Firefox warns the user when trying to install add-on if this was page-initiated. 

When the page is redirecting or navigating by &lt;a href link, JavaScript or server redirect, Firefox trows the 
'Firefox prevented this site (site.com) from asking you to install software on your computer.' warning at the user, which needs to explicitly be accepted for the add-on to continue installing.
There is however, a simple vulnerability that lets an attacker bypass this dialog, which allows a rather nasty attack on the user.

Basically, there is one exception in which the dialog will not be shown, which is if the user pastes or copies the direct link/URL in the URL bar.

Now the user could just click on links, redirects etc that lead to this page, because a data uri redirected to the page which itself redirects with a 'page moved header' to the location of the add-on, will disrupt that 'chain' and installation of the add-on will start without the dialog. As if the user typed it in directly.

This behavior in combination with a properly timed attack will result in a scenario where the user will download the add-on controlled by the attacker, the legit add-on webpage shown with it. The only thing not correct is the url of the pushed add-on, which the user CANNOT verify. This dialog is really only useful if the download location is from another domain. Since it will only show the <a rel="nofollow" href="https://addons.mozzila.org/firefox/download/latest/123/randomurl">https://addons.mozzila.org/firefox/download/latest/123/randomurl</a> .. [truncated].

So the attacker will simply upload his unreviewed add-on, with the same name and icon as the desired add-on to be spoofed. Sure, this will eventually be reviewed and picked up or reported in the process. But in the meanwhile the direct link will be used. And since the reputation of the spoofed add-on that is being pushed doesn't matter (user never views that page). There is no way for the user to notice that the add-on is spoofed.

Attached are the files that would be running on the server.

Demonstration of the issue: <a rel="nofollow" href="https://www.youtube.com/watch?v=VTKblGpeW4Y">https://www.youtube.com/watch?v=VTKblGpeW4Y</a> (unlisted)</pre></div><div class="change-set" id="a176583_406847"><div class="change" id="aa176583_406847">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406847" id="a176583_406847"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_406847" id="a176583_406847"><a class="email disabled" href="/user_profile?user_id=406847" > <span class="fna">Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a176583_406847"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a176583_406847">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a176583_406847">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-07-25 08:29 PDT" data-time="1406302178">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external]</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="9128791" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a176583_406847"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-07-31 23:39 PDT" data-time="1406875178">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9128791">I just get 28 seconds of black on the youtube video.</pre></div><div class="change-set" id="c2"><div class="comment" data-id="9129314" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_512384" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/fab9bf2c8527f284150406dc4034439e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_512384" id="a176583_406847"><a class="email " href="/user_profile?user_id=512384" > <span class="fna">Bas Venis</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-08-01 02:40 PDT" data-time="1406886014">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9129314">Weird, works fine for me. Nonetheless, the video is also included in the poc.zip</pre></div><div class="change-set" id="c3"><div class="comment" data-id="9143803" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a176583_406847"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-08-05 10:46 PDT" data-time="1407260771">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9143803"><span class="quote">&gt; Basically, there is one exception in which the dialog will not be shown, which is
&gt; if the user pastes or copies the direct link/URL in the URL bar.</span >

That's an intentional exception. The block is more of an anti-annoyance feature so sites can't pester people into giving in and installing (the next dialog is the actual security prompt). It's known that if you can white-wash your referer away you can mimic this, but then you're generally not at the same site so you can't keep annoying the user that way. Acceptable risk unless we see people start to abuse it, basically.

Spoofing people with the AMO origin of unreviewed add-ons, however, is clever.

Wil: would it be possible to require people to be signed into AMO to reach download links for unreviewed add-ons? Or failing that, maybe change the server to reject such links if the referer for the download doesn't come from AMO itself? Either would pretty much eliminate the potential for spoofing here.</pre><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Flags: needinfo?(clouserw)</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          
            <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="9155246" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_177149" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/656fad0dd7cc21dfc11e9b9e953598fd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_177149" id="a176583_406847"><a class="email " href="/user_profile?user_id=177149" > <span class="fna">Wil Clouser [:clouserw]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-08-07 11:56 PDT" data-time="1407437799">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="9155246">The youtube video never loads for me and the video in the zip file shows a desktop but flickers so much I can't tell what is going on.  So, I can't tell entirely what we're talking about - when you say &quot;unreviewed add-on&quot; are you talking about a preliminarily reviewed add-on?  Can you put in specific steps to reproduce this so I can get a better idea of what's going on?

Regarding the questions:  It's possible to require people be signed in, but I'm not sure it's something we'd want to do.  I think we used to require people be signed in to download add-ons which weren't fully reviewed (when we had the yellow/black stripes on the buttons - it was a long time ago) and we got enough of a negative reaction to it that we stopped doing it.  Jorge could probably give more info.  We'd also have to ask if that would really change anything about the scenario.

Regarding referrers, that depends what URL is being pasted in.  If it's a download link on AMO, potentially we could, but if it's a cached URL directly to the file then probably not.  We may also interfere with legitimate 3rd party sites that link to AMO directly on purpose (and add their own src=___ to the URL for tracking and such).</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(clouserw)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="9156428" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_189742" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/3bd14a58b7b755d332e388e1646ba037?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_189742" id="a176583_406847"><a class="email " href="/user_profile?user_id=189742" > <span class="fna">Jorge Villalobos [:jorgev] (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-08-07 15:48 PDT" data-time="1407451702">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="9156428">(In reply to Wil Clouser [:clouserw] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c4">comment #4</a>)
<span class="quote">&gt; when you say &quot;unreviewed add-on&quot;
&gt; are you talking about a preliminarily reviewed add-on?  Can you put in
&gt; specific steps to reproduce this so I can get a better idea of what's going
&gt; on?</span >

As I understand it, the attacker uses some trickery to directly load the URL that points to the XPI file of an unreviewed add-on on AMO. This bypasses the warning that should appear for non-AMO add-ons, and also the warnings we show on AMO for unreviewed add-ons. This would only work while the version is waiting in the queue, which can range from a few hours to a few weeks depending on the add-on and reviewer availability.

Note that this is only about unreviewed add-ons in the queue, not preliminarily approved add-ons. The latter are checked for security issues, just like fully reviewed add-ons.

<span class="quote">&gt; Regarding the questions:  It's possible to require people be signed in, but
&gt; I'm not sure it's something we'd want to do.</span >

We expose unreviewed add-ons and versions to allow enthusiastic users to be able to install them while they wait in the queue. They are only discoverable by people who know what they're doing. If that's the best solution, I don't think it's a big deal to require being logged in to be able to install these files.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="10373901" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a176583_406847"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-10 22:29 PDT" data-time="1434000565">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="10373901">Decoder met the reporter at HITB and apparently this was intended to be nominated for a bug bounty (though I couldn't find any such mail to our security alias). Fixing that now.

In part this specific example spoof takes advantage of the fact that AMO mixes trusted/reviewed content with untrusted content on the same web and storage servers. Terrible, terrible idea and I've been complaining about it for years (maybe even a decade) so I give up. Signing (starting soon) will at least make the unreviewed stuff not install and break this particular example, but really the word &quot;untrusted&quot; should be in the domain, or path, or not use mozilla.(com/org/net) at all.

Since several client bugs conspire for the rest I'll leave this as a client bug rather than trying to break the chain on the AMO side as we started talking about in the last couple of comments. We probably need to open separate bugs on these because we may need different people to work on them.

1) bypassing the install block is annoying, but by itself not all that serious (sec-low?). We might even have a bug on it already. Without debugging it, my guess is that when the data: page loads the .xpi we're using the data: url as the referrer rather than the origin from the principal. data URLs don't have a host so they look like a file: url, which are allowed to trigger installs. We probably can't change the referrer without breaking lots of stuff so we should check scheme and not just assume based on a null host.

1a) we should check that we're still using the &quot;internal referrer&quot; which we always set because the http header can be stripped entirely in various ways. With the meta-referrer spec that's even easier. The &quot;internal referrer&quot; was something we always set.

2) The heart of this spoof is that the download doorhanger and dialog show up on a page different from the one that spawned it. Coupled with text that says &quot;This site...&quot; rather than the actual origin adds to the spoofing. We should kill the download/install if the progress events are coming back to a different document than the one that launched it -- can't think of a good reason for a legit page to navigate right away, and they can use the callback function to navigate after if they want to. And even if there is a good reason, we're not going to be able to come up with UI that is spoof-proof. Users are ALWAYS going to assume it's the new page doing whatever the doorhanger says.

2a) this really applies to most door-hangers

2b) do we allow non-same-origin frames to trigger an install? If so we have the same spoofing problem if there's an injected or otherwise hostile frame (ad server?). There are several other permission type things in the product where we don't even allow a non-same-origin to request the permission because it's too easy to confuse the user as to whom is asking, and we should think about that for installs.

3) Part of this spoof relies on the ability to make the one thing users can check--the URL in the install dialog--be the expected host (AMO) even though it's untrusted content. That much could be fixed on the AMO side by moving the untrusted content. But the NEW UI doesn't ever show this URL. The name from the signed install.rdf is shown which helps a bit (assuming we won't sign a dupe name) but even then we allow names that are similar to other names and that's probably good enough for a spoof. Worse, the installing site could _tell_ you its installing GoodAddon from AMO, but it's actually installing an old copy of GoodAddon (with known vulns) from its own site. You would have no idea.
  Sure, lots of people wouldn't know where GoodAddon is supposed to be loaded from, but showing the URL of the install package will give savvier users a chance to catch something scammy and report it, helping us to protect all users. If we can't show the URL in the doorhanger can we at least show it on hovering over the name, or make the name a link to the URL that the user can use the context menu to copy?

I'm raising the severity because given the new UI there's no longer the URL shown to help users figure out they've been spoofed, &quot;the site showing the doorhanger&quot; is the security check and that will be green-lock-secure AMO.</pre><div class="activity"><div class="change">Component: Security &rarr; Add-ons Manager</div><div class="change">Flags: sec-bounty?</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a> &rarr; <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div><div class="change">Product: Firefox &rarr; Toolkit</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="10525415" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a176583_406847"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-22 10:59 PDT" data-time="1437587948">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="10525415">Dave, do you know who could look at this? It is a bug from a year ago that was recently reclassified as sec-high. Thanks!</pre><div class="activity"><div class="change">Flags: needinfo?(dtownsend)</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="10526049" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a176583_406847"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-22 12:48 PDT" data-time="1437594489">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="10526049">This looks more necko related. The code here isn't getting a referrer for the request (both branches get a null referer) so we assume it was user-entered. Maybe jduell can recommend someone to look.

<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/toolkit/mozapps/extensions/amContentHandler.js#46">http://mxr.mozilla.org/mozilla-central/source/toolkit/mozapps/extensions/amContentHandler.js#46</a>

That said when add-on signing requirements are enabled we'll refuse to install these unlisted add-ons because they won't be signed so I think we should downgrade the severity of this at that point.</pre><div class="activity"><div class="change">Flags: needinfo?(dtownsend) &rarr; needinfo?(jduell.mcbugs)</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="10529350" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a176583_406847"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-23 06:55 PDT" data-time="1437659753">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="10529350">The sec-high rating here (from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c6">comment 6</a>) is about the new addon UI not providing the URL of the addon any more.  AFAICT that's an addon code fix, not necko.

Bypassing the install block (which is the thing the blank referrer currently enables one to do) is rated as sec-low (which is lower than I would have expected, but I'll defer to dveditz).

Note: my read of the meta-referrer support we landed early this year is that this feature now allows any arbitrary HTML page to suppress the referer header, and so we don't even need the data redirect trick to force an addon install without the user seeing the block. Is that right? Or is the addon check using the internal referrer (aka Docshell QI'd to a propertyBag(&quot;docshell.internalReferrer”), so this isn't an issue?

I'm not familiar with how &quot;docshell.internalReferrer” gets set, so if we do want to fix the data:// redirect issue, we'll have to look into how it gets set and why it doesn't happen in that case.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jduell.mcbugs)</span></div></div></div><div class="change-set" id="c10"><div class="comment" data-id="10529358" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a176583_406847"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-23 07:00 PDT" data-time="1437660031">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="10529358">Punting back to mossop to find someone to fix the addon UI issue.</pre><div class="activity"><div class="change">Flags: needinfo?(dtownsend)</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="10531489" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a176583_406847"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-23 14:01 PDT" data-time="1437685316">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="10531489">(In reply to Jason Duell [:jduell] (needinfo? me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c9">comment #9</a>)
<span class="quote">&gt; The sec-high rating here (from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c6">comment 6</a>) is about the new addon UI not
&gt; providing the URL of the addon any more.  AFAICT that's an addon code fix,
&gt; not necko.
&gt; 
&gt; Bypassing the install block (which is the thing the blank referrer currently
&gt; enables one to do) is rated as sec-low (which is lower than I would have
&gt; expected, but I'll defer to dveditz).
&gt; 
&gt; Note: my read of the meta-referrer support we landed early this year is that
&gt; this feature now allows any arbitrary HTML page to suppress the referer
&gt; header, and so we don't even need the data redirect trick to force an addon
&gt; install without the user seeing the block. Is that right? Or is the addon
&gt; check using the internal referrer (aka Docshell QI'd to a
&gt; propertyBag(&quot;docshell.internalReferrer”), so this isn't an issue?
&gt; 
&gt; I'm not familiar with how &quot;docshell.internalReferrer” gets set, so if we do
&gt; want to fix the data:// redirect issue, we'll have to look into how it gets
&gt; set and why it doesn't happen in that case.</span >

We use docshell.internalReferrer but it isn't getting set here. The load here is a data: url loaded from a Location: header sent by a http request. The data: document includes a &lt;script&gt; that sets window.location.href.

In this case we end up here and principalURI is apparently a null principal so the loadinfo referrer never gets set.

<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/dom/base/nsLocation.cpp#161">http://mxr.mozilla.org/mozilla-central/source/dom/base/nsLocation.cpp#161</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dtownsend)</span></div></div></div><div class="change-set" id="c12"><div class="comment" data-id="10531574" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a176583_406847"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-23 14:18 PDT" data-time="1437686337">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="10531574">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c6">comment #6</a>)
<span class="quote">&gt; 1) bypassing the install block is annoying, but by itself not all that
&gt; serious (sec-low?). We might even have a bug on it already. Without
&gt; debugging it, my guess is that when the data: page loads the .xpi we're
&gt; using the data: url as the referrer rather than the origin from the
&gt; principal. data URLs don't have a host so they look like a file: url, which
&gt; are allowed to trigger installs. We probably can't change the referrer
&gt; without breaking lots of stuff so we should check scheme and not just assume
&gt; based on a null host.
&gt; 
&gt; 1a) we should check that we're still using the &quot;internal referrer&quot; which we
&gt; always set because the http header can be stripped entirely in various ways.
&gt; With the meta-referrer spec that's even easier. The &quot;internal referrer&quot; was
&gt; something we always set.</span >

We are, just in this case it isn't set, see above.

<span class="quote">&gt; 2) The heart of this spoof is that the download doorhanger and dialog show
&gt; up on a page different from the one that spawned it. Coupled with text that
&gt; says &quot;This site...&quot; rather than the actual origin adds to the spoofing. We
&gt; should kill the download/install if the progress events are coming back to a
&gt; different document than the one that launched it -- can't think of a good
&gt; reason for a legit page to navigate right away, and they can use the
&gt; callback function to navigate after if they want to. And even if there is a
&gt; good reason, we're not going to be able to come up with UI that is
&gt; spoof-proof. Users are ALWAYS going to assume it's the new page doing
&gt; whatever the doorhanger says.</span >

Well, sites can't get the callback unless they are whitelisted so if they want to show some post-install page they pretty much have to do it immediately after triggering the install.

<span class="quote">&gt; 2a) this really applies to most door-hangers
&gt; 
&gt; 2b) do we allow non-same-origin frames to trigger an install? If so we have
&gt; the same spoofing problem if there's an injected or otherwise hostile frame
&gt; (ad server?). There are several other permission type things in the product
&gt; where we don't even allow a non-same-origin to request the permission
&gt; because it's too easy to confuse the user as to whom is asking, and we
&gt; should think about that for installs.</span >

I think so, and I think we've even abused this feature in the past :(

<span class="quote">&gt; 3) Part of this spoof relies on the ability to make the one thing users can
&gt; check--the URL in the install dialog--be the expected host (AMO) even though
&gt; it's untrusted content. That much could be fixed on the AMO side by moving
&gt; the untrusted content. But the NEW UI doesn't ever show this URL. The name
&gt; from the signed install.rdf is shown which helps a bit (assuming we won't
&gt; sign a dupe name) but even then we allow names that are similar to other
&gt; names and that's probably good enough for a spoof. Worse, the installing
&gt; site could _tell_ you its installing GoodAddon from AMO, but it's actually
&gt; installing an old copy of GoodAddon (with known vulns) from its own site.
&gt; You would have no idea.
&gt;   Sure, lots of people wouldn't know where GoodAddon is supposed to be
&gt; loaded from, but showing the URL of the install package will give savvier
&gt; users a chance to catch something scammy and report it, helping us to
&gt; protect all users. If we can't show the URL in the doorhanger can we at
&gt; least show it on hovering over the name, or make the name a link to the URL
&gt; that the user can use the context menu to copy?
&gt; 
&gt; I'm raising the severity because given the new UI there's no longer the URL
&gt; shown to help users figure out they've been spoofed, &quot;the site showing the
&gt; doorhanger&quot; is the security check and that will be green-lock-secure AMO.</span >

We took the URL out of the UI because we decided it generally wasn't useful information to the user, more useful was the installing origin, which does show up for http sites but not for data or in this case where we don't know it. As you say the URL is indistinguishable from a regular add-on's URL so I don't think adding the URL back helps us much here.

I think the right fix is to not drop install requests on the floor if they come from somewhere other than the top-level origin and then <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Cancel add-on installations when the associated tab navigates to a new site"
   href="/show_bug.cgi?id=1147812">bug 1147812</a> to cancel ongoing installs. We probably need the docshell referrer info to be available to do that.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="10538525" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a176583_406847"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-26 19:23 PDT" data-time="1437963835">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="10538525">Valentin, can you take a look and see if there's a reasonably clean way to get the internal referrer field to get set correctly for redirects to data: uris?

(If it's a mess, I'm happy to push back against the whole architecture here of relying on referer for addon security, which strikes me as more than a little bit kludgy.)</pre><div class="activity"><div class="change">Assignee: nobody &rarr; valentin.gosu</div><div class="change">Flags: needinfo?(valentin.gosu)</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="10538532" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a176583_406847"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-26 19:29 PDT" data-time="1437964165">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="10538532">(In reply to Jason Duell [:jduell] (needinfo? me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c13">comment #13</a>)
<span class="quote">&gt; (If it's a mess, I'm happy to push back against the whole architecture here
&gt; of relying on referer for addon security, which strikes me as more than a
&gt; little bit kludgy.)</span >

To be clear regardless of the referrer the user is always asked if they want to install an add-on. We use the referrer to tell us if a site is allowed to start the download automatically or if the user has to even confirm at that point. If there is a better way from a content handler to get to the origin that triggered the request that that would be great.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="10542120" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a176583_406847"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-27 12:58 PDT" data-time="1438027110">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="10542120">(In reply to Jason Duell [:jduell] (needinfo? me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c13">comment #13</a>)
<span class="quote">&gt; Valentin, can you take a look and see if there's a reasonably clean way to
&gt; get the internal referrer field to get set correctly for redirects to data:
&gt; uris?</span >

I think the problem here is the data URI. If I'm not mistaken, with a URI such as 'data:text/html,&lt;script&gt; window.location.href = &quot;<a rel="nofollow" href="https://addons.mozilla.org">https://addons.mozilla.org</a>&quot; &lt;/script&gt;' we don't get referrer headers, because it's different than clicking on a link or a redirect. It just sets the location, which makes it more similar to the user writing the URL in the URL bar.

<span class="quote">&gt; Basically, there is one exception in which the dialog will not be shown, which is if the user pastes or
&gt; copies the direct link/URL in the URL bar.</span >

We should probably get rid of this exception, since there is no difference between JavaScript using document.location to navigate to another page, and the user pasting in a URL.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(valentin.gosu)</span></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="10542212" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a176583_406847"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-27 13:10 PDT" data-time="1438027821">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="10542212"><span class="quote">&gt; If there is a better way from a content handler to get to the origin that triggered 
&gt; the request that that would be great.</span >

Tanvi and/or :ckerschb may have ideas here.  They've been adding this kind of info to channels.</pre><div class="activity"><div class="change">Flags: needinfo?(tanvi)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="10542219" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a176583_406847"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-27 13:10 PDT" data-time="1438027856">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="10542219">(In reply to Valentin Gosu [:valentin] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c15">comment #15</a>)
<span class="quote">&gt; (In reply to Jason Duell [:jduell] (needinfo? me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c13">comment #13</a>)
&gt; &gt; Basically, there is one exception in which the dialog will not be shown, which is if the user pastes or
&gt; &gt; copies the direct link/URL in the URL bar.
&gt; 
&gt; We should probably get rid of this exception, since there is no difference
&gt; between JavaScript using document.location to navigate to another page, and
&gt; the user pasting in a URL.</span >

There is a difference as far as the user is concerned. In one case the user explicitely performed an action, in the other the website did it possible automatically.

The whitelist is intended to stop websites from being able to automatically spam the user with add-on install requests.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="10542552" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_430652" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/9f4d447f27c116342ba41a747802372d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_430652" id="a176583_406847"><a class="email " href="/user_profile?user_id=430652" > <span class="fna">Tanvi Vyas[:tanvi]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-27 14:11 PDT" data-time="1438031511">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="10542552">(In reply to Jason Duell [:jduell] (needinfo? me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c16">comment #16</a>)
<span class="quote">&gt; &gt; If there is a better way from a content handler to get to the origin that triggered 
&gt; &gt; the request that that would be great.
&gt; 
&gt; Tanvi and/or :ckerschb may have ideas here.  They've been adding this kind
&gt; of info to channels.</span >

Dave said we use the referrer to tell us if a site is allowed to start the download automatically.  We want to allow the download to start automatically when the user has typed in or pasted in the url, but not when script within a page has changed document.location.

I'm not sure this is possible.  In loadinfo, we have a loadingPrincipal and a triggeringPrincipal.  In bug <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell"
   href="/show_bug.cgi?id=1105556#c12">https://bugzilla.mozilla.org/show_bug.cgi?id=1105556#c12</a> we are going to change the way we set those principals for top level loads.  Given the proposal outlined there, the triggeringPrincipal (which is essentially equivalent to the referrer) will not be null when a user types in a url but instead will be the codebase principal from the url the user typed.  For now, we are only fixing the loading/triggeringPrincipals.  But eventually we will try and fold the referrer logic into triggeringPrincipal, in which case checking for a null referrer will not work.

Perhaps we need to rework the proposal in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell"
   href="/show_bug.cgi?id=1105556">bug 1105556</a> to cover this case and have a slightly different triggeringPrincipal (or flag set on loadinfo) when a user types in a url for a top level load.

Is there another way to determine that the load was initiated by the user outside of using referrer/loadInfo/triggeringPrincipals?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(tanvi)</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="10571146" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a176583_406847"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a176583_406847"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-03 17:15 PDT" data-time="1438647351">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="10571146">I think this could probably be done in nsLocation::CheckURL()
I don't think we can use the referrer for it, but it might be OK to pass along the triggeringPrincipal, and fix this for data URI redirects ( I don't know that code well enough to do it myself )
I haven't checked, but HTML meta http-equiv=&quot;refresh&quot; might also suffer from the same problem.</pre><div class="activity"><div class="change">Assignee: valentin.gosu &rarr; nobody</div></div></div><div class="change-set" id="a32978718_1689"><div class="change" id="aa32978718_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a32978718_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a32978718_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a32978718_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a32978718_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a32978718_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-09 00:11 PDT" data-time="1439104313">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=isnotempty">status-firefox39</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=isnotempty">status-firefox42</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox40&amp;o1=isnotempty">tracking-firefox40</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox40&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox41&amp;o1=isnotempty">tracking-firefox41</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox41&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=isnotempty">tracking-firefox42</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=40%2B">40+</a></div></div></div><div class="change-set" id="a33031025_1689"><div class="change" id="aa33031025_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33031025_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a33031025_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33031025_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33031025_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33031025_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-09 14:43 PDT" data-time="1439156620">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8460893&amp;action=edit"
           title="poc.zip"
           class=""
        >Attachment #8460893</a> -
        Attachment mime type: application/x-zip-compressed &rarr; application/java-archive</div></div></div><div class="change-set" id="a33034437_1689"><div class="change" id="aa33034437_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a33034437_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33034437_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33034437_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33034437_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-09 15:40 PDT" data-time="1439160032">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Bypass XPI Installation Prompt &quot;Firefox prevented this site...&quot; for Installing Addons"
   href="/show_bug.cgi?id=1065876">1065876</a></div></div></div><div class="change-set" id="c21"><div class="comment" data-id="10605640" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a33034437_1689"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 13:06 PDT" data-time="1439323581">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="10605640">Ollie,

Do you know someone who could make the changes in dom/nsLocation for this?  Talking to Valentin, it sounds like passsing in the triggeringPrincipal is easy enough, but he's worried about whether we'd be changing some of the assumptions about window.location, so we should have someone who knows that code well.</pre><div class="activity"><div class="change">Flags: needinfo?(bugs)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="10605647" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a33034437_1689"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 13:07 PDT" data-time="1439323673">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="10605647">Valentin: &quot;my concerns with this bug is if passing the principal every time, there could be some XSS attack vectors I'm not aware of since nsLocation is usable in JavaScript.&quot;</pre></div><div class="change-set" id="c23"><div class="comment" data-id="10606125" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a33034437_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 14:33 PDT" data-time="1439328830">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="10606125">Jason: Olli is on vacation this week, who else can we ask?</pre></div><div class="change-set" id="c24"><div class="comment" data-id="10606616" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33034437_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 16:12 PDT" data-time="1439334768">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="10606616">I'd like to be sure we know what &quot;FIXED&quot; looks like here. I believe it is correctly applying the whitelist and showing the doorhanger to allow the download to proceed instead of proceeding directly to the install, but is there something else we expect?</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="10606680" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a33034437_1689"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 16:26 PDT" data-time="1439335613">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="10606680">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c23">comment #23</a>)
<span class="quote">&gt; Jason: Olli is on vacation this week, who else can we ask?</span >

Maybe Blake? Looks like bholley is mostly out this week.</pre><div class="activity"><div class="change">Flags: needinfo?(mrbkap)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="10607477" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a33034437_1689"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 23:24 PDT" data-time="1439360689">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="10607477">The current setup is broken from a security perspective. We shouldn't rely on ambient authority as we'll keep patching holes. Referrers are interesting for analysis, but not security decisions.

We should definitely have follow up bugs to fix AMO per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c6">comment 6</a>.

Also, if we want to pursue this referrer madness, I think we want a follow up bug there too to make sure it gets standardized, otherwise Servo sure is out of luck. And are we sure all the other ways to programmatically navigate are covered? E.g.,

  data:text/html,&lt;a href=...&gt;&lt;/a&gt;&lt;script&gt;document.links[0].click()&lt;/script&gt;
  data:text/html,&lt;form action=...&gt;&lt;/form&gt;&lt;script&gt;document.forms[0].submit()&lt;/script&gt;
  data:text/html,&lt;meta http-equiv=refresh content=0;url=...&gt;

Soon you can navigate a window through a service worker too...</pre></div><div class="change-set" id="c27"><div class="comment" data-id="10607501" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33034437_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-11 23:41 PDT" data-time="1439361674">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="10607501">(In reply to Anne (:annevk) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c26">comment #26</a>)
<span class="quote">&gt; The current setup is broken from a security perspective. We shouldn't rely
&gt; on ambient authority as we'll keep patching holes. Referrers are interesting
&gt; for analysis, but not security decisions.</span >

Do we have a better option available at the moment?</pre></div><div class="change-set" id="c28"><div class="comment" data-id="10607562" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a33034437_1689"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-12 00:06 PDT" data-time="1439363202">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="10607562">I tend to think we should just ask permission even if you navigate directly to an XPI. Social media has seen its share of attacks using &quot;bookmarklets&quot;. I don't see why that would not be similarly abused for this. &quot;Use Firefox? Copy this URL into your address bar to change the Facebook logo into a kitten!&quot;</pre></div><div class="change-set" id="c29"><div class="comment" data-id="10610330" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33034437_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-12 11:29 PDT" data-time="1439404173">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="10610330">(In reply to Anne (:annevk) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c28">comment #28</a>)
<span class="quote">&gt; I tend to think we should just ask permission even if you navigate directly
&gt; to an XPI. Social media has seen its share of attacks using &quot;bookmarklets&quot;.
&gt; I don't see why that would not be similarly abused for this. &quot;Use Firefox?
&gt; Copy this URL into your address bar to change the Facebook logo into a
&gt; kitten!&quot;</span >

The &quot;allow&quot; doorhanger is mainly designed to make it impossible for a website to spam a user with add-on install requests. AMO is the only site that can bypass it by default, that and user interaction (except here we can't tell it wasn't user interaction). Regardless of whether we show the allow doorhanger users still have to approve the installation so it isn't directly abusable to skip this doorhanger for that case</pre></div><div class="change-set" id="c30"><div class="comment" data-id="10610623" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a33034437_1689"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-12 12:38 PDT" data-time="1439408335">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="10610623">Maybe I'm doing something wrong, but on AMO I get the doorhanger. If I copy-and-paste a URL I don't. (Nightly, OS X)</pre></div><div class="change-set" id="c31"><div class="comment" data-id="10610654" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33034437_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33034437_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-12 12:44 PDT" data-time="1439408642">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="10610654">Go to preferences - security - exceptions. AMO and Marketplace sites should be listed in there. If they aren't then maybe you cleared those at some point?</pre></div><div class="change-set" id="a33288043_181004"><div class="change" id="aa33288043_181004">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_181004" id="a33288043_181004"><img src="https://secure.gravatar.com/avatar/2e65c829d6f9d9ccf3e84753a00fb8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_181004" id="a33288043_181004"><a class="email " href="/user_profile?user_id=181004" > <span class="fna">Brad Lassey [:blassey] (use needinfo?)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33288043_181004"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33288043_181004">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33288043_181004">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-12 14:07 PDT" data-time="1439413638">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; mrbkap</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="10612246" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_102998" id="a33288043_181004"><img src="https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_102998" id="a33288043_181004"><a class="email " href="/user_profile?user_id=102998" > <span class="fna">Anne (:annevk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-12 22:14 PDT" data-time="1439442861">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="10612246">Seems like it. Sorry.</pre></div><div class="change-set" id="c33"><div class="comment" data-id="10620439" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334931" id="a33288043_181004"><img src="https://secure.gravatar.com/avatar/2531a1c9efafc5fe629a977c514b29b1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334931" id="a33288043_181004"><a class="email " href="/user_profile?user_id=334931" > <span class="fna">Jason Duell</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-14 11:48 PDT" data-time="1439578107">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="10620439">If we need a fix for this quickly, could we just always show the doorhanger?  It doesn't seem like an intolerable UX experience for people who directly paste in a URI.  This seems like a lot of security hole-age for a small amount of UX win.</pre></div><div class="change-set" id="a33459823_1689"><div class="change" id="aa33459823_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33459823_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a33459823_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33459823_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33459823_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33459823_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-14 13:50 PDT" data-time="1439585418">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="10621012" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33459823_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a33459823_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-14 14:09 PDT" data-time="1439586564">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="10621012">There are two key parts here. The worse one would not be addressed by your proposal and that's showing the doorhanger(s) on a different site after a navigation. Even in a legit http site to http site transition that's spoofy.

But yes, the other part is we're doing a lot of work to support developers being able to type in .XPI URLs into the URL bar. Always showing a (different) prompt would be one fix. That is, it shouldn't say &quot;This site&quot; is doing anything! It should say something that means &quot;You appear to be manually installing an add-on, is that what you wanted to do?&quot;

Another option I proposed on a mail thread was kill that feature. It's super obscure and only legitimately used by developers. Useful, but dangerous if non-devs get tricked into it. So stop it: if we can't get an internal referrer then we drop the install on the floor. We may find some legit case we break and can fix bugs later, but we're intentionally removing the feature that lets people type in .XPI urls.

Replacement functionality of a sort already exists -- if developers first download the .xpi they can drag-n-drop the file onto a browser window, or use the &quot;Install from File&quot; menu item on the Addon Manager. (We'd have to make sure those both continue to work, they won't have internal referrers either.)

We could also add a GCLI install command for developers. It'd be the same functionality they're using now, but they'd have to open up the command-line first (Shift-F2) and prefix the URL with a command like &quot;install&quot; or &quot;addon&quot;.

Not directly implicated in this bug's testcase, but we should also prevent non-same-origin frames from triggering an install. Yes, the domain at the top of the prompt will be different but users are just going to see &quot;This Site&quot; and miss those fine details. The top level site might have put the iframe there, or the iframe could have been injected or maliciously navigated. We also might want this block to apply only to the pre-install permission prompt, and let whitelisted domains (AMO, marketplace) trigger an install itself.</pre></div><div class="change-set" id="c35"><div class="comment" data-id="10621424" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_69426" id="a33459823_1689"><img src="https://secure.gravatar.com/avatar/89d2149736265010bfe669ce8c3075c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_69426" id="a33459823_1689"><a class="email " href="/user_profile?user_id=69426" > <span class="fna">Blake Kaplan (:mrbkap) (inactive)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-14 16:10 PDT" data-time="1439593837">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="10621424">It appears that Mossop will be working on a solution that has been discussed in an email thread, so I'm giving the bug to him.

We should definitely file a followup bug on switching to triggeringPrincipal and fixing nsLocation to pass through the triggering principal correctly. I don't see any reason not to (responding to the concern in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c21">comment 21</a>).</pre><div class="activity"><div class="change">Assignee: mrbkap &rarr; dtownsend</div><div class="change">Flags: <span class="activity-deleted">needinfo?(mrbkap)</span></div></div></div><div class="change-set" id="a33776822_495955"><div class="change" id="aa33776822_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a33776822_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a33776822_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33776822_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33776822_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33776822_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-18 05:53 PDT" data-time="1439902417">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a33862222_39966"><div class="change" id="aa33862222_39966">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_39966" id="a33862222_39966"><img src="https://secure.gravatar.com/avatar/7ba0f00f24191ccef0d14185bd7ca4ca?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_39966" id="a33862222_39966"><a class="email " href="/user_profile?user_id=39966" > <span class="fna">Olli Pettay [:smaug]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33862222_39966"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33862222_39966">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33862222_39966">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-19 05:36 PDT" data-time="1439987817">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bugs)</span></div></div></div><div class="change-set" id="a33892430_1689"><div class="change" id="aa33892430_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a33892430_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a33892430_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a33892430_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a33892430_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-19 14:00 PDT" data-time="1440018025">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=wontfix">wontfix</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="10637459" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-19 15:02 PDT" data-time="1440021750">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8650158"
         class="attachment patch obsolete"
         data-id="8650158" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="patch">
      <meta itemprop="contentSize" content="95534">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8650158">
          <a class="link" href="attachment.cgi?id=8650158&amp;action=diff">
        <span id="att-8650158-description" itemprop="description">patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8650158&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8650158">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-37" data-comment-id="10637459">This implements the main fixes discussed in the email. I did end up using the triggering principal instead of the internal referrer since it made things easier in the end.

* Non-same-origin frames are denied the ability to initiate installs.
* Installs triggered by the system principal are still allowed, it turns out that dragging a url or XPI into the content area does this so that keeps working. I've only tested that on OSX though, drag and drop is fickle so it might be broken on other platforms.
* Installs triggered by a moznull principal are denied, the spoof testcase here and entering an XPI url into the address bar fall into that category. It seems to me that we could make entering a url into the address bar use the system principle which would mean we could keep that working, I didn't bother trying that though as I have no idea about the implications.
* If the browser navigates to a new origin any pending installs are immediately cancelled and there is code there to make the doorhangers and install prompts hide themselves in that case.

The browser_navigateaway3 test I added seems to be racy. I'm pretty sure it is a test problem so shouldn't need to hold review while I try to fix that. Worst case we can probably disable that test in the cases where it is failing.

I've kept API changes to a minimum, the AddonManager APIs that were public of sorts still accept an nsIURI and convert to a principal that will behave as things used to. I don't expect many will be using this but wanted to keep it compatible for the uplift, we can drop the API support on trunk.

A number of tests that call browser.loadURI with a direct link to an XPI (which ends up using the system principal) had to be altered to load some page first, this is because in e10s browser.contentPrincipal is undefined until a page load has happened.

When we block the user entering a url in the address bar I think we need to show some UI or it will be confusing. For now this patch just shows the standard blocked message (<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/browser/locales/en-US/chrome/browser/browser.properties#22">https://dxr.mozilla.org/mozilla-central/source/browser/locales/en-US/chrome/browser/browser.properties#22</a>) but without the allow button. Ideally we'd get a new string but I'm assuming that would be hard for uplifts. It also shows for this spoofing case which isn't ideal. It also shows the cross-origin install attempts right now but we can turn that off if we want.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8650158&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8650158</a> -
        Flags: review?(dveditz)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="10641576" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-20 13:11 PDT" data-time="1440101496">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="10641576">(In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c37">comment #37</a>)
<span class="quote">&gt; * If the browser navigates to a new origin any pending installs are
&gt; immediately cancelled and there is code there to make the doorhangers and
&gt; install prompts hide themselves in that case.</span >

Is this something that will be an issue for Fennec?</pre><div class="activity"><div class="change">Flags: needinfo?(margaret.leibovic)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="10647031" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a33892430_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-22 01:14 PDT" data-time="1440231253">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="10647031">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8650158" name="attach_8650158" title="patch">attachment 8650158</a> <a href="/attachment.cgi?id=8650158&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8650158&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8650158'>[review]</a>
patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8650158" name="attach_8650158" title="patch">attachment 8650158</a> <a href="/attachment.cgi?id=8650158&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8650158&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8650158'>[review]</a>:
-----------------------------------------------------------------

The comments below are questions or about comments. If you want to address them you can carry over my r+
r=dveditz

::: browser/base/content/browser-addons.js
&#64;&#64; +259,5 &#64;&#64;
<span class="quote">&gt;                                action, null, options);
&gt;        break; }
&gt; +    case &quot;addon-install-origin-blocked&quot;: {
&gt; +      // The URI doesn't make sense in this case
&gt; +      if (!installInfo.originatingURI.schemeIs(&quot;moz-nullprincipal&quot;))</span >

Is this the only edge case? What if some page frames about:home and there's a snippet trying to launch an install? Not sure that could actually happen, but there might be other weird combos.

Would it be a better test to see if the URI has a host instead? Maybe not, I think blob: urls have hosts now, although if your frame was loaded from a blob: presumably the _principal_ would be your origin and not the literal blob: (just as the moz-nullprincipal: is not the actual URL in the frame, it's the principal).

I guess the odd schemes will mostly only come up for add-ons or internal functionality--like if the PDF viewer tries to launch installs (unlikely!). moz-nullprincipal can come up commonly in web content in sandboxed iframes.

&#64;&#64; +277,5 &#64;&#64;
<span class="quote">&gt;        messageString = gNavigatorBundle.getFormattedString(&quot;xpinstallPromptMessage&quot;,
&gt;                          [brandShortName]);
&gt;  
&gt;        let secHistogram = Components.classes[&quot;&#64;mozilla.org/base/telemetry;1&quot;].getService(Ci.nsITelemetry).getHistogramById(&quot;SECURITY_UI&quot;);
&gt; +      if (aTopic == &quot;addon-install-blocked&quot;) {</span >

how could aTopic have changed between evaluating the switch and here three statements later?

::: toolkit/mozapps/extensions/test/xpcshell/test_permissions.js
&#64;&#64; +25,5 &#64;&#64;
<span class="quote">&gt;  
&gt;    startupManager();
&gt;  
&gt;    do_check_false(AddonManager.isInstallAllowed(XPI_MIMETYPE,
&gt; +                                               newPrincipal(&quot;<a rel="nofollow" href="http://test1.com">http://test1.com</a>&quot;)));</span >

Most of these appear flush left like the old NetUtil.newURI() calls but three of them are argument-aligned. (I don't feel strongly, just wanted to point it out in case you did and it was a mistake.)

::: toolkit/mozapps/extensions/test/xpinstall/browser_datauri.js
&#64;&#64; +1,2 &#64;&#64;
<span class="quote">&gt; +// ----------------------------------------------------------------------------
&gt; +// Ensure that an inner frame from a different origin can't initiate an install</span >

Is this comment misdirection? We won't know if this install is blocked because it's triggered from a data: url or because it's a non-same-origin frame. Maybe the comment is just copy-pasta from browser_unsigned_trigger_xorigin.js?

::: toolkit/mozapps/extensions/test/xpinstall/browser_navigateaway2.js
&#64;&#64; +3,1 &#64;&#64;
<span class="quote">&gt;  // This verifies bugs 473060 and 475347</span >

Doesn't this test now test the opposite? Does this un-fix the above two bugs (or at least 473060)? It may be what we have to do but if so we should change the rest of the comment.

Or, do we consider them still fixed because it's canceled cleanly, not with the errors (or crash) described in those bugs?

::: toolkit/mozapps/extensions/test/xpinstall/browser_unsigned_trigger_xorigin.js
&#64;&#64; +1,2 &#64;&#64;
<span class="quote">&gt; +// ----------------------------------------------------------------------------
&gt; +// Ensure that an inner frame from a different origin can't initiate an install</span >

Since this is installing an unsigned package, how can you test whether the install fails because it was cross-origin or because it was unsigned? I see the install_blocked() event handler but it's not saving or checking anything. Would it throw an unsigned error (if it got that far) because there's no handler defined for that one?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8650158&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8650158</a> -
        Flags: review?(dveditz) &rarr; review+</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="10650927" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 09:08 PDT" data-time="1440432538">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="10650927">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c39">comment #39</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8650158" name="attach_8650158" title="patch">attachment 8650158</a> <a href="/attachment.cgi?id=8650158&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8650158&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8650158'>[review]</a>
&gt; patch
&gt; 
&gt; Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8650158" name="attach_8650158" title="patch">attachment 8650158</a> <a href="/attachment.cgi?id=8650158&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8650158&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8650158'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; The comments below are questions or about comments. If you want to address
&gt; them you can carry over my r+
&gt; r=dveditz
&gt; 
&gt; ::: browser/base/content/browser-addons.js
&gt; &#64;&#64; +259,5 &#64;&#64;
&gt; &gt;                                action, null, options);
&gt; &gt;        break; }
&gt; &gt; +    case &quot;addon-install-origin-blocked&quot;: {
&gt; &gt; +      // The URI doesn't make sense in this case
&gt; &gt; +      if (!installInfo.originatingURI.schemeIs(&quot;moz-nullprincipal&quot;))
&gt; 
&gt; Is this the only edge case? What if some page frames about:home and there's
&gt; a snippet trying to launch an install? Not sure that could actually happen,
&gt; but there might be other weird combos.
&gt; 
&gt; Would it be a better test to see if the URI has a host instead? Maybe not, I
&gt; think blob: urls have hosts now, although if your frame was loaded from a
&gt; blob: presumably the _principal_ would be your origin and not the literal
&gt; blob: (just as the moz-nullprincipal: is not the actual URL in the frame,
&gt; it's the principal).
&gt; 
&gt; I guess the odd schemes will mostly only come up for add-ons or internal
&gt; functionality--like if the PDF viewer tries to launch installs (unlikely!).
&gt; moz-nullprincipal can come up commonly in web content in sandboxed iframes.</span >

Looks like PopupNotifications already handles the case where the uri has no valid host so I just removed this check.

<span class="quote">&gt; &#64;&#64; +277,5 &#64;&#64;
&gt; &gt;        messageString = gNavigatorBundle.getFormattedString(&quot;xpinstallPromptMessage&quot;,
&gt; &gt;                          [brandShortName]);
&gt; &gt;  
&gt; &gt;        let secHistogram = Components.classes[&quot;&#64;mozilla.org/base/telemetry;1&quot;].getService(Ci.nsITelemetry).getHistogramById(&quot;SECURITY_UI&quot;);
&gt; &gt; +      if (aTopic == &quot;addon-install-blocked&quot;) {
&gt; 
&gt; how could aTopic have changed between evaluating the switch and here three
&gt; statements later?</span >

Left over from a previous version of the patch, removed.

<span class="quote">&gt; ::: toolkit/mozapps/extensions/test/xpinstall/browser_datauri.js
&gt; &#64;&#64; +1,2 &#64;&#64;
&gt; &gt; +// ----------------------------------------------------------------------------
&gt; &gt; +// Ensure that an inner frame from a different origin can't initiate an install
&gt; 
&gt; Is this comment misdirection? We won't know if this install is blocked
&gt; because it's triggered from a data: url or because it's a non-same-origin
&gt; frame. Maybe the comment is just copy-pasta from
&gt; browser_unsigned_trigger_xorigin.js?</span >

Yeah bad copy-paste, corrected.

<span class="quote">&gt; ::: toolkit/mozapps/extensions/test/xpinstall/browser_navigateaway2.js
&gt; &#64;&#64; +3,1 &#64;&#64;
&gt; &gt;  // This verifies bugs 473060 and 475347
&gt; 
&gt; Doesn't this test now test the opposite? Does this un-fix the above two bugs
&gt; (or at least 473060)? It may be what we have to do but if so we should
&gt; change the rest of the comment.
&gt; 
&gt; Or, do we consider them still fixed because it's canceled cleanly, not with
&gt; the errors (or crash) described in those bugs?</span >

Removed that piece of the comment.

<span class="quote">&gt; toolkit/mozapps/extensions/test/xpinstall/browser_unsigned_trigger_xorigin.js
&gt; &#64;&#64; +1,2 &#64;&#64;
&gt; &gt; +// ----------------------------------------------------------------------------
&gt; &gt; +// Ensure that an inner frame from a different origin can't initiate an install
&gt; 
&gt; Since this is installing an unsigned package, how can you test whether the
&gt; install fails because it was cross-origin or because it was unsigned? I see
&gt; the install_blocked() event handler but it's not saving or checking
&gt; anything. Would it throw an unsigned error (if it got that far) because
&gt; there's no handler defined for that one?</span >

Added a check that the install_blocked handler is called. We should also be covered because signing requirements are disabled in these tests and we have other checks that installing the same file works normally.</pre></div><div class="change-set" id="c41"><div class="comment" data-id="10651654" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 11:21 PDT" data-time="1440440500">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8651890"
         class="attachment patch"
         data-id="8651890" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="patch">
      <meta itemprop="contentSize" content="95580">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8651890">
          <a class="link" href="attachment.cgi?id=8651890&amp;action=diff">
        <span id="att-8651890-description" itemprop="description">patch</span></a>
        — <a href="attachment.cgi?id=8651890&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8651890">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-41" data-comment-id="10651654">Addressed the comments and fixed browser_navigateawa3.js by splitting out the checking of the install UI closing itself into browser_navigateaway4.js</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8650158&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8650158</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8651890&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8651890</a> -
        Flags: review?(dveditz)</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="10652638" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a33892430_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 14:37 PDT" data-time="1440452275">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="10652638">Comment on <span class=""><a href="/attachment.cgi?id=8651890" name="attach_8651890" title="patch">attachment 8651890</a> <a href="/attachment.cgi?id=8651890&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8651890&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8651890'>[review]</a>
patch

Review of <span class=""><a href="/attachment.cgi?id=8651890" name="attach_8651890" title="patch">attachment 8651890</a> <a href="/attachment.cgi?id=8651890&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8651890&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8651890'>[review]</a>:
-----------------------------------------------------------------

Thanks! r=dveditz</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8651890&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8651890</a> -
        Flags: review?(dveditz) &rarr; review+</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="10652661" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a33892430_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 14:41 PDT" data-time="1440452513">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="10652661">Comment on <span class=""><a href="/attachment.cgi?id=8651890" name="attach_8651890" title="patch">attachment 8651890</a> <a href="/attachment.cgi?id=8651890&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8651890&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8651890'>[review]</a>
patch

sec-approval = dveditz</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8651890&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8651890</a> -
        Flags: sec-approval+</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="10652694" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 14:47 PDT" data-time="1440452864">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="10652694"><a rel="nofollow" href="https://hg.mozilla.org/integration/fx-team/rev/9d2d9b4a95b9">https://hg.mozilla.org/integration/fx-team/rev/9d2d9b4a95b9</a></pre></div><div class="change-set" id="c45"><div class="comment" data-id="10652751" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a33892430_1689"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 15:00 PDT" data-time="1440453647">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="10652751">(In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c38">comment #38</a>)
<span class="quote">&gt; (In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c37">comment #37</a>)
&gt; &gt; * If the browser navigates to a new origin any pending installs are
&gt; &gt; immediately cancelled and there is code there to make the doorhangers and
&gt; &gt; install prompts hide themselves in that case.
&gt; 
&gt; Is this something that will be an issue for Fennec?</span >

I haven't looked at this patch closely - are you concerned that your changes will break Fennec in some way, or are you worried that we'll need additional patches to also fix this issue on Fennec?

Is there something I can do to test if this is a problem on Fennec? I'm also happy to write a patch if we need to update our notification UI as well.</pre><div class="activity"><div class="change">Flags: needinfo?(margaret.leibovic) &rarr; needinfo?(dtownsend)</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="10652800" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 15:16 PDT" data-time="1440454569">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="10652800">(In reply to :Margaret Leibovic from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c45">comment #45</a>)
<span class="quote">&gt; (In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c38">comment #38</a>)
&gt; &gt; (In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c37">comment #37</a>)
&gt; &gt; &gt; * If the browser navigates to a new origin any pending installs are
&gt; &gt; &gt; immediately cancelled and there is code there to make the doorhangers and
&gt; &gt; &gt; install prompts hide themselves in that case.
&gt; &gt; 
&gt; &gt; Is this something that will be an issue for Fennec?
&gt; 
&gt; I haven't looked at this patch closely - are you concerned that your changes
&gt; will break Fennec in some way, or are you worried that we'll need additional
&gt; patches to also fix this issue on Fennec?
&gt; 
&gt; Is there something I can do to test if this is a problem on Fennec? I'm also
&gt; happy to write a patch if we need to update our notification UI as well.</span >

The specific part I was talking about is that if the user navigates to a new site from the tab that started an extension install the install will be cancelled. I don't really remember what Fennec's install UI looks like so I'm not sure if that is a problem or not.</pre><div class="activity"><div class="change">Flags: needinfo?(dtownsend) &rarr; needinfo?(margaret.leibovic)</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="10653358" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a33892430_1689"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 17:43 PDT" data-time="1440463434">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8652086"
         class="attachment"
         data-id="8652086" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="2015-08-25 00.40.15.png">
      <meta itemprop="contentSize" content="107211">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8652086" itemprop="contentUrl">
        <span id="att-8652086-description" itemprop="description">Fennec add-on install UI</span></a>
        — <a href="attachment.cgi?id=8652086&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-47" data-comment-id="10653358">Our add-on install UI looks like this. I just tested what happens if I change window.location while this prompt is showing, and it dismisses the prompt, so I think we're okay?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(margaret.leibovic)</span></div></div></div><div class="change-set" id="c48"><div class="comment" data-id="10653505" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a33892430_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 18:06 PDT" data-time="1440464792">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="10653505"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/9d2d9b4a95b9">https://hg.mozilla.org/mozilla-central/rev/9d2d9b4a95b9</a></pre><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2015-08-24 18:06 PDT" data-time="1440464792">6 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=isnotempty">status-firefox43</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite+</div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla43</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="10653517" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a33892430_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-24 18:11 PDT" data-time="1440465104">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8652099"
         class="attachment patch"
         data-id="8652099" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="patch">
      <meta itemprop="contentSize" content="85043">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8652099">
          <a class="link" href="attachment.cgi?id=8652099&amp;action=diff">
        <span id="att-8652099-description" itemprop="description">ESR patch</span></a>
        — <a href="attachment.cgi?id=8652099&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652099">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-49" data-comment-id="10653517">This version applies to ESR code.</pre></div><div class="change-set" id="c50"><div class="comment" data-id="10656140" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a33892430_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a33892430_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 09:15 PDT" data-time="1440519316">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="10656140">Dave, can we have the uplifts request asap? thanks
ESR 31 is now dead but we will have the question, is that affected?</pre><div class="activity"><div class="change">Flags: needinfo?(dtownsend)</div></div></div><div class="change-set" id="a34394498_280903"><div class="change" id="aa34394498_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a34394498_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a34394498_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a34394498_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a34394498_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 09:28 PDT" data-time="1440520093">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2015-4498</div></div></div><div class="change-set" id="c51"><div class="comment" data-id="10657067" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a34394498_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 12:13 PDT" data-time="1440530033">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="10657067">Yes, ESR 31 is affected. The ESR38 patch, or something close to it, might work on 31.</pre></div><div class="change-set" id="c52"><div class="comment" data-id="10657201" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34394498_280903"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 12:51 PDT" data-time="1440532304">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="10657201">Comment on <span class=""><a href="/attachment.cgi?id=8651890" name="attach_8651890" title="patch">attachment 8651890</a> <a href="/attachment.cgi?id=8651890&amp;action=edit" title="patch">[details]</a> <a href="/attachment.cgi?id=8651890&amp;action=diff" title="patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8651890'>[review]</a>
patch

Approval Request Comment
[Risks and why]: Average risk, there is a lot of code changing here but it is all well tested. Some functionality is intentionally disabled.
[String/UUID change made/needed]: One existing string is re-used in a similar context.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dtownsend)</span></div><div class="change">
        <a href="/attachment.cgi?id=8651890&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8651890</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="10657210" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34394498_280903"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 12:52 PDT" data-time="1440532336">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8652513"
         class="attachment patch"
         data-id="8652513" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="beta">
      <meta itemprop="contentSize" content="94498">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8652513">
          <a class="link" href="attachment.cgi?id=8652513&amp;action=diff">
        <span id="att-8652513-description" itemprop="description">beta patch</span></a>
        — <a href="attachment.cgi?id=8652513&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652513">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-53" data-comment-id="10657210">Same patch but applies cleanly to beta</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652513&amp;action=edit"
           title="beta patch"
           class=""
        >Attachment #8652513</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="10657219" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34394498_280903"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 12:52 PDT" data-time="1440532364">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8652514"
         class="attachment patch"
         data-id="8652514" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="release">
      <meta itemprop="contentSize" content="94442">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8652514">
          <a class="link" href="attachment.cgi?id=8652514&amp;action=diff">
        <span id="att-8652514-description" itemprop="description">release patch</span></a>
        — <a href="attachment.cgi?id=8652514&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652514">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-54" data-comment-id="10657219">Same patch but applies cleanly to release</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652514&amp;action=edit"
           title="release patch"
           class=""
        >Attachment #8652514</a> -
        Flags: approval-mozilla-release?</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="10657223" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34394498_280903"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 12:53 PDT" data-time="1440532437">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="10657223">Comment on <span class=""><a href="/attachment.cgi?id=8652099" name="attach_8652099" title="ESR patch">attachment 8652099</a> <a href="/attachment.cgi?id=8652099&amp;action=edit" title="ESR patch">[details]</a> <a href="/attachment.cgi?id=8652099&amp;action=diff" title="ESR patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8652099'>[review]</a>
ESR patch

Forgot that there is one difference here. The string displayed when we block is different on ESR and attempts to include the hostname blocked, but in many cases we don't have one so we get a weird popup like this:

<a rel="nofollow" href="https://www.dropbox.com/s/anc5c3tdzasybk2/Screenshot%202015-08-25%2012.49.34.png?dl=0">https://www.dropbox.com/s/anc5c3tdzasybk2/Screenshot%202015-08-25%2012.49.34.png?dl=0</a>

Changing that would mean a string change and I don't know how feasible that is.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652099&amp;action=edit"
           title="ESR patch"
           class=""
        >Attachment #8652099</a> -
        Flags: review?(dveditz)</div></div></div><div class="change-set" id="c56"><div class="comment" data-id="10657417" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a34394498_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 13:34 PDT" data-time="1440534882">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="10657417">Comment on <span class=""><a href="/attachment.cgi?id=8652099" name="attach_8652099" title="ESR patch">attachment 8652099</a> <a href="/attachment.cgi?id=8652099&amp;action=edit" title="ESR patch">[details]</a> <a href="/attachment.cgi?id=8652099&amp;action=diff" title="ESR patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8652099'>[review]</a>
ESR patch

Review of <span class=""><a href="/attachment.cgi?id=8652099" name="attach_8652099" title="ESR patch">attachment 8652099</a> <a href="/attachment.cgi?id=8652099&amp;action=edit" title="ESR patch">[details]</a> <a href="/attachment.cgi?id=8652099&amp;action=diff" title="ESR patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8652099'>[review]</a>:
-----------------------------------------------------------------

r=dveditz</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652099&amp;action=edit"
           title="ESR patch"
           class=""
        >Attachment #8652099</a> -
        Flags: review?(dveditz) &rarr; review+</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="10657444" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34394498_280903"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 13:37 PDT" data-time="1440535073">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="10657444">Comment on <span class=""><a href="/attachment.cgi?id=8652099" name="attach_8652099" title="ESR patch">attachment 8652099</a> <a href="/attachment.cgi?id=8652099&amp;action=edit" title="ESR patch">[details]</a> <a href="/attachment.cgi?id=8652099&amp;action=diff" title="ESR patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8652099'>[review]</a>
ESR patch

Same as previous patches but applies to esr38</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652099&amp;action=edit"
           title="ESR patch"
           class=""
        >Attachment #8652099</a> -
        Flags: approval-mozilla-esr38?</div></div></div><div class="change-set" id="c58"><div class="comment" data-id="10658339" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a34394498_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 16:23 PDT" data-time="1440544993">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="10658339">Comment on <span class=""><a href="/attachment.cgi?id=8652099" name="attach_8652099" title="ESR patch">attachment 8652099</a> <a href="/attachment.cgi?id=8652099&amp;action=edit" title="ESR patch">[details]</a> <a href="/attachment.cgi?id=8652099&amp;action=diff" title="ESR patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8652099'>[review]</a>
ESR patch

a=dveditz for ESR-38</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652099&amp;action=edit"
           title="ESR patch"
           class=""
        >Attachment #8652099</a> -
        Flags: approval-mozilla-esr38? &rarr; approval-mozilla-esr38+</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="10658340" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34394498_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a34394498_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 16:23 PDT" data-time="1440545020">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="10658340">Comment on <span class=""><a href="/attachment.cgi?id=8652513" name="attach_8652513" title="beta patch">attachment 8652513</a> <a href="/attachment.cgi?id=8652513&amp;action=edit" title="beta patch">[details]</a> <a href="/attachment.cgi?id=8652513&amp;action=diff" title="beta patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1042699&amp;attachment=8652513'>[review]</a>
beta patch

a=dveditz for beta, aurora, and release</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652513&amp;action=edit"
           title="beta patch"
           class=""
        >Attachment #8652513</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="a34419437_1689"><div class="change" id="aa34419437_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34419437_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a34419437_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a34419437_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a34419437_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a34419437_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 16:23 PDT" data-time="1440545032">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8652514&amp;action=edit"
           title="release patch"
           class=""
        >Attachment #8652514</a> -
        Flags: approval-mozilla-release? &rarr; approval-mozilla-release+</div></div></div><div class="change-set" id="a34419448_1689"><div class="change" id="aa34419448_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34419448_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a34419448_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a34419448_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a34419448_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a34419448_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 16:24 PDT" data-time="1440545043">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8651890&amp;action=edit"
           title="patch"
           class=""
        >Attachment #8651890</a> -
        Flags: approval-mozilla-aurora? &rarr; approval-mozilla-aurora+</div></div></div><div class="change-set" id="a34419507_1689"><div class="change" id="aa34419507_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a34419507_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a34419507_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a34419507_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a34419507_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 16:25 PDT" data-time="1440545102">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c60"><div class="comment" data-id="10658619" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a34419507_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 17:41 PDT" data-time="1440549707">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="10658619"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/05f2f11077f5">https://hg.mozilla.org/releases/mozilla-aurora/rev/05f2f11077f5</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=isnotempty">status-b2g-v2.1S</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2r&amp;o1=isnotempty">status-b2g-v2.2r</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2r&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=isnotempty">status-b2g-master</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=isnotempty">status-firefox42</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="c61"><div class="comment" data-id="10658797" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a34419507_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 18:50 PDT" data-time="1440553854">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="10658797"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/8f20947224b7">https://hg.mozilla.org/releases/mozilla-beta/rev/8f20947224b7</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c62"><div class="comment" data-id="10658802" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a34419507_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 18:54 PDT" data-time="1440554064">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="10658802"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-release/rev/d1dc3b231922">https://hg.mozilla.org/releases/mozilla-release/rev/d1dc3b231922</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c63"><div class="comment" data-id="10658824" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a34419507_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 19:07 PDT" data-time="1440554876">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="10658824"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr38/rev/5713bf3a152e">https://hg.mozilla.org/releases/mozilla-esr38/rev/5713bf3a152e</a> (ESR 38.2.x)
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr38/rev/4abc250aa55c">https://hg.mozilla.org/releases/mozilla-esr38/rev/4abc250aa55c</a> (ESR 38.3.x)</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="10658948" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34419507_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 19:45 PDT" data-time="1440557110">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8652680"
         class="attachment patch"
         data-id="8652680" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="patch">
      <meta itemprop="contentSize" content="8009">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8652680">
          <a class="link" href="attachment.cgi?id=8652680&amp;action=diff">
        <span id="att-8652680-description" itemprop="description">ESR tests</span></a>
        — <a href="attachment.cgi?id=8652680&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1042699&attachment=8652680">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-64" data-comment-id="10658948">Test cases missing from the ESR patch</pre></div><div class="change-set" id="c65"><div class="comment" data-id="10658952" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a34419507_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 19:48 PDT" data-time="1440557289">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="10658952"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr38/rev/573127a8200a">https://hg.mozilla.org/releases/mozilla-esr38/rev/573127a8200a</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr38/rev/60aec55a27cc">https://hg.mozilla.org/releases/mozilla-esr38/rev/60aec55a27cc</a></pre></div><div class="change-set" id="c66"><div class="comment" data-id="10659811" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a34419507_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-26 02:22 PDT" data-time="1440580970">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="10659811">Do we know if thunderbird/seamonkey are affected by this issue?</pre></div><div class="change-set" id="c67"><div class="comment" data-id="10659948" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_69594" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/a8d798bd44d391eb16df26cb076f9c30?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_69594" id="a34419507_1689"><a class="email " href="/user_profile?user_id=69594" > <span class="fna">Nick Thomas [:nthomas] (UTC+12)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-26 03:19 PDT" data-time="1440584372">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="10659948">Transplanted onto the Firefox relbranch for esr38 (GECKO3820esr_2015080613_RELBRANCH):
<a rel="nofollow" href="http://hg.mozilla.org/releases/mozilla-esr38/rev/f1c2ced15323">http://hg.mozilla.org/releases/mozilla-esr38/rev/f1c2ced15323</a>
<a rel="nofollow" href="http://hg.mozilla.org/releases/mozilla-esr38/rev/99ef2acc329b">http://hg.mozilla.org/releases/mozilla-esr38/rev/99ef2acc329b</a>  (tests)</pre></div><div class="change-set" id="c68"><div class="comment" data-id="10662938" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_430652" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/9f4d447f27c116342ba41a747802372d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_430652" id="a34419507_1689"><a class="email " href="/user_profile?user_id=430652" > <span class="fna">Tanvi Vyas[:tanvi]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-26 14:20 PDT" data-time="1440624020">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="10662938">I'm a little bit worried about the use of triggeringPrincipal.

Since I'm not too familiar with this area, I'll first summarize the behavior as I understand it.

* If you are on a whitelisted site, the user needs to go through one dialog when they try and install and addon.

* If a user tries to install an addon from a non-whitelisted site, they will get 2 dialogs (one before the actual download and one after)

* If a user uses the addons manager to download an addon, there is no top level domain to check against the whitelist.  So they check if the triggeringPrincipal is systemPrincipal.

* If a user tries to install an addon in any other way (copy/paste a url, data: uri, etc) it should fail.

The problem is that the triggeringPrincipal for top level loads could be system for other reasons.  Examples:
1) When opening a new blank tab
* loadingPrincipal is systemPrincipal - comes from mScriptGlobal-&gt;GetFrameElementInternal
* triggeringPrincipal is set to systemPrincipal (no aOwner)

2) When launching a bookmark OR refreshing a page.
* loadingPrincipal is systemPrincipal - comes from mScriptGlobal-&gt;GetFrameElementInternal
* triggeringPrincipal is set to systemPrincipal (no aOwner)

See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell"
   href="/show_bug.cgi?id=1105556#c10">https://bugzilla.mozilla.org/show_bug.cgi?id=1105556#c10</a> and <a rel="nofollow" href="https://etherpad.mozilla.org/docShellPrincipals">https://etherpad.mozilla.org/docShellPrincipals</a>.

I want to change the value of triggerPrincipal for top level loads as described here <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell"
   href="/show_bug.cgi?id=1105556#c12">https://bugzilla.mozilla.org/show_bug.cgi?id=1105556#c12</a>, but in the meantime there may still be attack vectors.

When using the addons manager, is the referrer null?  Is there any other way to tell that this is where the load came from?</pre></div><div class="change-set" id="c69"><div class="comment" data-id="10663038" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34419507_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a34419507_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-26 14:40 PDT" data-time="1440625203">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-69" data-comment-id="10663038">(In reply to Tanvi Vyas [:tanvi] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c68">comment #68</a>)
<span class="quote">&gt; I'm a little bit worried about the use of triggeringPrincipal.
&gt; 
&gt; Since I'm not too familiar with this area, I'll first summarize the behavior
&gt; as I understand it.
&gt; 
&gt; * If you are on a whitelisted site, the user needs to go through one dialog
&gt; when they try and install and addon.
&gt; 
&gt; * If a user tries to install an addon from a non-whitelisted site, they will
&gt; get 2 dialogs (one before the actual download and one after)
&gt; 
&gt; * If a user uses the addons manager to download an addon, there is no top
&gt; level domain to check against the whitelist.  So they check if the
&gt; triggeringPrincipal is systemPrincipal.</span >

No, the add-ons manager bypasses the code that handles installs from web pages.

<span class="quote">&gt; * If a user tries to install an addon in any other way (copy/paste a url,
&gt; data: uri, etc) it should fail.</span >

Dragging the XPI file or the url to one into the browser should still work.

<span class="quote">&gt; The problem is that the triggeringPrincipal for top level loads could be
&gt; system for other reasons.  Examples:
&gt; 1) When opening a new blank tab
&gt; * loadingPrincipal is systemPrincipal - comes from
&gt; mScriptGlobal-&gt;GetFrameElementInternal
&gt; * triggeringPrincipal is set to systemPrincipal (no aOwner)</span >

This would never cause an XPI install though right?

<span class="quote">&gt; 2) When launching a bookmark OR refreshing a page.
&gt; * loadingPrincipal is systemPrincipal - comes from
&gt; mScriptGlobal-&gt;GetFrameElementInternal
&gt; * triggeringPrincipal is set to systemPrincipal (no aOwner)</span >

That's surprising, so if the user bookmarked an url or refreshed a page that later changed to serving an XPI then it would bypass the whitelist. That's not great though I suspect that that might have been the case before the fix for this bug (the bookmark case for sure, I'm not sure what docshell.internalReferrer did on reloads).

<span class="quote">&gt; When using the addons manager, is the referrer null?  Is there any other way
&gt; to tell that this is where the load came from?</span >

When using the add-ons manager we install using a different path, the triggering principal is not checked in this case.</pre></div><div class="change-set" id="a34651941_1689"><div class="change" id="aa34651941_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a34651941_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a34651941_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a34651941_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a34651941_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a34651941_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-28 08:58 PDT" data-time="1440777536">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="a34913623_91159"><div class="change" id="aa34913623_91159">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a34913623_91159"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_91159" id="a34913623_91159"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a34913623_91159"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a34913623_91159">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a34913623_91159">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-31 09:40 PDT" data-time="1441039218">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - 40.0.3 broke ability to install featured addons from the add-ons manager"
   href="/show_bug.cgi?id=1200027">1200027</a></div></div></div><div class="change-set" id="a35051526_546015"><div class="change" id="aa35051526_546015">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_546015" id="a35051526_546015"><img src="https://secure.gravatar.com/avatar/d0465b8931b44330f542efbeeae855da?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_546015" id="a35051526_546015"><a class="email " href="/user_profile?user_id=546015" > <span class="fna">BMO Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a35051526_546015"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a35051526_546015">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a35051526_546015">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-01 23:58 PDT" data-time="1441177121">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="10706980" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_430652" id="a35051526_546015"><img src="https://secure.gravatar.com/avatar/9f4d447f27c116342ba41a747802372d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_430652" id="a35051526_546015"><a class="email " href="/user_profile?user_id=430652" > <span class="fna">Tanvi Vyas[:tanvi]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-08 12:43 PDT" data-time="1441741405">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="10706980">(In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c69">comment #69</a>)
<span class="quote">&gt; (In reply to Tanvi Vyas [:tanvi] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c68">comment #68</a>)
&gt; &gt; * If a user uses the addons manager to download an addon, there is no top
&gt; &gt; level domain to check against the whitelist.  So they check if the
&gt; &gt; triggeringPrincipal is systemPrincipal.
&gt; 
&gt; No, the add-ons manager bypasses the code that handles installs from web
&gt; pages.</span >
&gt;

<span class="quote">&gt; &gt; When using the addons manager, is the referrer null?  Is there any other way
&gt; &gt; to tell that this is where the load came from?
&gt; 
&gt; When using the add-ons manager we install using a different path, the
&gt; triggering principal is not checked in this case.</span >

If we aren't checking triggeringPrincipal = systemPrincipal to preserve the behavior of add-ons manager, then what are we using that check for?  What use case does it support?

Thanks!</pre></div><div class="change-set" id="c71"><div class="comment" data-id="10707019" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a35051526_546015"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a35051526_546015"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-08 12:53 PDT" data-time="1441742001">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="10707019">(In reply to Tanvi Vyas [:tanvi] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c70">comment #70</a>)
<span class="quote">&gt; (In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c69">comment #69</a>)
&gt; &gt; (In reply to Tanvi Vyas [:tanvi] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c68">comment #68</a>)
&gt; &gt; &gt; * If a user uses the addons manager to download an addon, there is no top
&gt; &gt; &gt; level domain to check against the whitelist.  So they check if the
&gt; &gt; &gt; triggeringPrincipal is systemPrincipal.
&gt; &gt; 
&gt; &gt; No, the add-ons manager bypasses the code that handles installs from web
&gt; &gt; pages.
&gt; &gt;
&gt; 
&gt; &gt; &gt; When using the addons manager, is the referrer null?  Is there any other way
&gt; &gt; &gt; to tell that this is where the load came from?
&gt; &gt; 
&gt; &gt; When using the add-ons manager we install using a different path, the
&gt; &gt; triggering principal is not checked in this case.
&gt; 
&gt; If we aren't checking triggeringPrincipal = systemPrincipal to preserve the
&gt; behavior of add-ons manager, then what are we using that check for?  What
&gt; use case does it support?</span >

It preserves drag and drop of an XPI file into the browser. I was also hoping it might be a way to get the url bar method working again sometime in the future.</pre></div><div class="change-set" id="a35695746_430652"><div class="change" id="aa35695746_430652">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_430652" id="a35695746_430652"><img src="https://secure.gravatar.com/avatar/9f4d447f27c116342ba41a747802372d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_430652" id="a35695746_430652"><a class="email " href="/user_profile?user_id=430652" > <span class="fna">Tanvi Vyas[:tanvi]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a35695746_430652"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a35695746_430652">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a35695746_430652">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 10:55 PDT" data-time="1441821341">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell"
   href="/show_bug.cgi?id=1105556">1105556</a></div></div></div><div class="change-set" id="a35696411_1689"><div class="change" id="aa35696411_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a35696411_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a35696411_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a35696411_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a35696411_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a35696411_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 11:06 PDT" data-time="1441822006">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external] &rarr; [reporter-external] leave hidden until bug 1105556 is fixed</div></div></div><div class="change-set" id="c72"><div class="comment" data-id="10711621" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a35696411_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a35696411_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 11:17 PDT" data-time="1441822624">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="10711621">(In reply to Tanvi Vyas [:tanvi] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox Addon bypass dialog and spoof vulnerability"
   href="/show_bug.cgi?id=1042699#c70">comment #70</a>)
<span class="quote">&gt; If we aren't checking triggeringPrincipal = systemPrincipal to preserve the
&gt; behavior of add-ons manager, then what are we using that check for?  What
&gt; use case does it support?</span >

Also to be clear we never check that the triggeringPrincipal is a system principal in particular, we just check that the triggeringPrincipal subsumes the principal of the document loaded in the tab that started the install.

In the case of the url bar entered install and the poc for this bug the triggering principal is a null principal so that test fails. For drag and drop it is the system principal and so passes. For any same-origin frame in the tab that test passes too.</pre></div><div class="change-set" id="a36381926_91159"><div class="change" id="aa36381926_91159">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a36381926_91159"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_91159" id="a36381926_91159"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a36381926_91159"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a36381926_91159">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a36381926_91159">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-17 09:32 PDT" data-time="1442507521">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INACTIVE - [e10s] Cannot install add-on / extension via drag and drop to tabstrip"
   href="/show_bug.cgi?id=1202271">1202271</a></div></div></div><div class="change-set" id="a37335728_91159"><div class="change" id="aa37335728_91159">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a37335728_91159"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_91159" id="a37335728_91159"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a37335728_91159"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a37335728_91159">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a37335728_91159">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-28 10:28 PDT" data-time="1443461323">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Installing via direct links to addons XPI fails"
   href="/show_bug.cgi?id=1201534">1201534</a></div></div></div><div class="change-set" id="a38561350_91159"><div class="change" id="aa38561350_91159">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a38561350_91159"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_91159" id="a38561350_91159"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a38561350_91159"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a38561350_91159">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a38561350_91159">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-12 14:55 PDT" data-time="1444686945">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - Can't install extensions when e10s is enabled and the current tab is not remote"
   href="/show_bug.cgi?id=1204215">1204215</a></div></div></div><div class="change-set" id="a38626034_91159"><div class="change" id="aa38626034_91159">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a38626034_91159"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_91159" id="a38626034_91159"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a38626034_91159"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a38626034_91159">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a38626034_91159">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-13 08:53 PDT" data-time="1444751629">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - [e10s] Add-on installation fails when the current tab is non-remote"
   href="/show_bug.cgi?id=1214210">1214210</a></div></div></div><div class="change-set" id="a61357328_1689"><div class="change" id="aa61357328_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a61357328_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a61357328_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a61357328_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a61357328_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1042699#a61357328_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-02 11:08 PDT" data-time="1467482923">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1042699&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>