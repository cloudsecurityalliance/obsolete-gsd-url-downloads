<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>CVE-2013-2293 - Bitcoin Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"CVE-2013-2293","wgTitle":"CVE-2013-2293","wgCurRevisionId":54968,"wgRevisionId":54968,"wgArticleId":3892,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"CVE-2013-2293","wgRelevantArticleId":3892,"wgRequestId":"516e3c9ba07636c24ba102e3","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"preview":true,"publish":false}});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.options@0bhc5ha",function($,jQuery,require,module){mw.user.options.set([]);});mw.loader.implement("user.tokens@0ft0puh",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/

});mw.loader.load(["site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector" />
<script async="" src="/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector" />
<meta name="generator" content="MediaWiki 1.30.0" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Bitcoin Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://en.bitcoin.it/w/api.php?action=rsd" />
<link rel="license" href="http://creativecommons.org/licenses/by/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Bitcoin Wiki Atom feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.min.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-CVE-2013-2293 rootpage-CVE-2013-2293 skin-vector action-view"> <div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
<a id="top"></a>
<div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">CVE-2013-2293</h1>
<div id="bodyContent" class="mw-body-content">
<div id="siteSub" class="noprint">From Bitcoin Wiki</div>
<div id="contentSub"></div>
<div id="jump-to-nav" class="mw-jump">
Jump to: <a href="#mw-head">navigation</a>, <a href="#p-search">search</a>
</div>
 <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div id="toc" class="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#New_DoS_vulnerability_by_Forcing_Continuous_Hard_Disk_Seek.2FRead_Activity"><span class="tocnumber">1</span> <span class="toctext">New DoS vulnerability by Forcing Continuous Hard Disk Seek/Read Activity</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Systems_Affected"><span class="tocnumber">2</span> <span class="toctext">Systems Affected</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Affected_Versions"><span class="tocnumber">3</span> <span class="toctext">Affected Versions</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Overview"><span class="tocnumber">4</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Details"><span class="tocnumber">5</span> <span class="toctext">Details</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Possible_Attack_Scenarios"><span class="tocnumber">6</span> <span class="toctext">Possible Attack Scenarios</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Not-a-problem_variations"><span class="tocnumber">7</span> <span class="toctext">Not-a-problem variations</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Suggested_Solution_for_0.6.2F0.7_versions"><span class="tocnumber">8</span> <span class="toctext">Suggested Solution for 0.6/0.7 versions</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Disclosure_Timeline"><span class="tocnumber">9</span> <span class="toctext">Disclosure Timeline</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Credit"><span class="tocnumber">10</span> <span class="toctext">Credit</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#See_Also"><span class="tocnumber">11</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>
<h2><span class="mw-headline" id="New_DoS_vulnerability_by_Forcing_Continuous_Hard_Disk_Seek.2FRead_Activity">New DoS vulnerability by Forcing Continuous Hard Disk Seek/Read Activity</span></h2>
<p>Private Release Date: 08-JAN-2013<br />
Public Release Date: 14-FEB-2013<br />
</p><p><br />
</p>
<h2><span class="mw-headline" id="Systems_Affected">Systems Affected</span></h2>
<ul><li> Satoshi Bitcoin Client (Bitcoin-Qt, bitcoind)</li>
<li> All Bitcoin clients that mimic the behavior related to transaction validation of Satoshi client versions prior 0.8.0</li></ul>
<h2><span class="mw-headline" id="Affected_Versions">Affected Versions</span></h2>
<ul><li> Bitcoin version 0.7.2 released 2012-12-14</li>
<li> Bitcoin version 0.7.1 released 2012-10-19</li>
<li> Bitcoin version 0.7.0 released 2012-09-17</li>
<li> Bitcoin version 0.6.3 released 2012-06-25</li>
<li> Bitcoin version 0.6.2 released 2012-05-08</li>
<li> Bitcoin version 0.6.1 released 2012-05-04</li>
<li> Bitcoin version 0.6.0 released 2012-03-30</li>
<li> Bitcoin version 0.5.3.1 released 2012-03-16</li>
<li> Bitcoin version 0.5.3 released 2012-03-14</li>
<li> Bitcoin version 0.5.2 released 2012-01-09</li>
<li> Bitcoin version 0.5.1 released 2011-12-15</li>
<li> Bitcoin version 0.5.0 released 2011-11-21</li>
<li> Bitcoin version 0.4.0 released 2011-09-23</li>
<li> Bitcoin version 0.3.24 released 2011-07-08</li>
<li> Bitcoin version 0.3.23 released 2011-06-14</li>
<li> Bitcoin version 0.3.22 released 2011-06-05</li>
<li> Bitcoin version 0.3.21 released 2011-04-27</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Overview">Overview</span></h2>
<p>Transaction processing has two stages in Satoshi Bitcoin client. In the first stage, transaction inputs are fetched.
This is done by bringing to RAM the transactions that contains the outputs referred by the inputs.
In the second stage, previous outputs are verified to be unspent and the related scripts are evaluated.
Since double spends are not considered to be a DoS attempt by the protocol rules, a transaction that refers to previous spent outputs will pass the first processing stage without being discarded. An attacker can therefore construct transactions that, before being discarded in the second stage of processing, require the victim application to seek and read too many parts of the block chain that could be scattered thought the storage files, delaying any other processing.
</p>
<h2><span class="mw-headline" id="Details">Details</span></h2>
<p>We assume that the whole block chain does not fit in RAM, so each transaction fetch requires a HD seek and read. An average 7200 rpm hard drive
can random seek/read a 1Kb block in a non-cached 2 Gb file in 12 msec. Each prevout of a transaction consumes 44 bytes, with empty sigscripts.
The attacker creates transaction with many inputs an one output. In this way, the other sections of the transaction (output scripts, headers) are amortized and become irrelevant to this analysis.
For an Internet connection of 50 Kbytes/sec bandwidth, sending 45 bytes requires less than 1 msec.
By continuously sending this specially crafted transactions an attacker can block any Bitcoin peer from performing other tasks.
Also the attacker may be able to block 10 peers at the same time, since the relation of 1:10 in required resources.
Note that the attacker does not need to sign the inputs nor to have the full block-chain to perform the attack. He only requires the hashes of all previous transactions, which currently requires only 10876856*32=332 Mbytes of storage.
</p><p>Version 0.8.0 of the Satoshi client stores only unspent prevouts in memory and can abort processing right after a spent prevout is referred by a transaction.
</p>
<h2><span class="mw-headline" id="Possible_Attack_Scenarios">Possible Attack Scenarios</span></h2>
<p>1. Because of the small resources required to mount the attack, it could be performed by botnets to massively attack the Bitcoin network.
</p><p>2. The attack can be used against miners to prevent them from sending blocks. Nevertheless, currently big miners are only connected to there own front-line of Bitcoin nodes to preven such attacks.
</p><p>3. By using many nodes at once, an attacker may try to create a barrier that splits the network in unconnected components, in order to carry another kind of attack.
</p>
<h2><span class="mw-headline" id="Not-a-problem_variations">Not-a-problem variations</span></h2>
<p>1. A valid 1M transaction could be constructed to reference more than 22K unique input transactions. In theory that transaction would take more than 5 minutes to be verified. Nevertheless the attack is unpractical for two reasons:<br />
a. The attacker should have to own those 22K transactions.<br />
b. Those 22K transactions should have to be scattered thought the blockchain to force HD seeking activity. If they were created in a limited period of time, they would end up confined in a limited portion of the block chain file. The result would be that the hard disk cache will help to reduce the read latency and so attack effectiveness will be reduced. Nevertheless version 0.8.0 of the Satoshi client considers transactions greater that 100K to be non-standard, so the vulnerability is further reduced.
</p>
<h2><span class="mw-headline" id="Suggested_Solution_for_0.6.2F0.7_versions">Suggested Solution for 0.6/0.7 versions</span></h2>
<p>The client application could verify that prevouts are not spent each time they are fetched, and abort if a spent prevout is found.
</p>
<pre>bool CTransaction::FetchInputs(CTxDB&amp; txdb, const map&lt;uint256, CTxIndex&gt;&amp; mapTestPool,
                              bool fBlock, bool fMiner, MapPrevTx&amp; inputsRet, bool&amp; fInvalid)
{
 ..
for (unsigned int i = 0; i &lt; vin.size(); i++)
   {
   // Read txPrev
   CTransaction&amp; txPrev = inputsRet[prevout.hash].second;
   ....
  // NEW CODE BEGINS
   if (prevout.n &gt;= txPrev.vout.size() || prevout.n &gt;= txindex.vSpent.size())
       {
       fInvalid = true;
               return DoS(100, error(" .....
     }
   if (!txindex.vSpent[prevout.n].IsNull())
    return false;
  // NEW CODE ENDS
  }
}
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Disclosure_Timeline">Disclosure Timeline</span></h2>
<p>2013-01-09 - Vulnerability reported to Gavin Andressen and other core devs.<br />
2013-01-09 - Gavin Andressen acknowledges report and confirms version 0.8 will not be vulnerable, permits disclosure after 0.8.0 release candidate 1 is available.<br />
2013-02-09 - Bitcoin version 0.8.0 release candidate 1 is available, fixing the vulnerability<br />
2013-02-14 - Vulnerability disclosure<br />
</p>
<h2><span class="mw-headline" id="Credit">Credit</span></h2>
<p>This vulnerability was discovered by Sergio Demian Lerner, from Certimix.com.
This report was written by SDL.
</p>
<h2><span class="mw-headline" id="See_Also">See Also</span></h2>
<ul><li> <a href="/wiki/Common_Vulnerabilities_and_Exposures" title="Common Vulnerabilities and Exposures">Common Vulnerabilities and Exposures</a></li></ul>


</div>

</div> <div class="printfooter">
Retrieved from "<a dir="ltr" href="https://en.bitcoin.it/w/index.php?title=CVE-2013-2293&amp;oldid=54968">https://en.bitcoin.it/w/index.php?title=CVE-2013-2293&amp;oldid=54968</a>" </div>
<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div> <div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>
<div id="mw-head">
<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
<h3 id="p-personal-label">Personal tools</h3>
<ul>
<li id="pt-createaccount"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=CVE-2013-2293" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=CVE-2013-2293" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li> </ul>
</div>
<div id="left-navigation">
<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
<h3 id="p-namespaces-label">Namespaces</h3>
<ul>
<li id="ca-nstab-main" class="selected"><span><a href="/wiki/CVE-2013-2293" title="View the content page [c]" accesskey="c">Page</a></span></li>
<li id="ca-talk" class="new"><span><a href="/w/index.php?title=Talk:CVE-2013-2293&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
<h3 id="p-variants-label">
<span>Variants</span>
</h3>
<div class="menu">
<ul>
</ul>
</div>
</div>
</div>
<div id="right-navigation">
<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
<h3 id="p-views-label">Views</h3>
<ul>
<li id="ca-view" class="selected"><span><a href="/wiki/CVE-2013-2293">Read</a></span></li>
<li id="ca-viewsource"><span><a href="/w/index.php?title=CVE-2013-2293&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
<li id="ca-history" class="collapsible"><span><a href="/w/index.php?title=CVE-2013-2293&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
<h3 id="p-cactions-label"><span>More</span></h3>
<div class="menu">
<ul>
</ul>
</div>
</div>
 <div id="p-search" role="search">
<h3>
<label for="searchInput">Search</label>
</h3>
<form action="/w/index.php" id="searchform">
<div id="simpleSearch">
<input type="search" name="search" placeholder="Search Bitcoin Wiki" title="Search Bitcoin Wiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton" /> </div>
</form>
</div>
</div>
</div>
<div id="mw-panel">
<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a></div>
<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
<h3 id='p-navigation-label'>Navigation</h3>
<div class="body">
<ul>
<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-Bitcoin-FAQ"><a href="/wiki/Help:FAQ">Bitcoin FAQ</a></li><li id="n-Editing-help"><a href="/wiki/Bitcoin_Wiki:Help">Editing help</a></li><li id="n-Forums"><a href="/wiki/Forums">Forums</a></li><li id="n-Chatrooms"><a href="/wiki/IRC_channels">Chatrooms</a></li><li id="n-Recent-changes"><a href="/wiki/Special:RecentChanges">Recent changes</a></li><li id="n-Page-index"><a href="/wiki/Special:AllPages">Page index</a></li> </ul>
</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
<h3 id='p-tb-label'>Tools</h3>
<div class="body">
<ul>
<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/CVE-2013-2293" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/CVE-2013-2293" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="/w/index.php?title=CVE-2013-2293&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="/w/index.php?title=CVE-2013-2293&amp;oldid=54968" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="/w/index.php?title=CVE-2013-2293&amp;action=info" title="More information about this page">Page information</a></li> </ul>
</div>
</div>
<div class="portal" role="navigation" id='p-Sister_projects' aria-labelledby='p-Sister_projects-label'>
<h3 id='p-Sister_projects-label'>Sister projects</h3>
<div class="body">
<ul>
<li id="n-Essays"><a href="/wiki/Bitcoin_Wiki:Essay_main_page">Essays</a></li><li id="n-Source"><a href="/wiki/Bitcoin_Wiki:Source_main_page">Source</a></li> </ul>
</div>
</div>
</div>
</div>
<div id="footer" role="contentinfo">
<ul id="footer-info">
<li id="footer-info-lastmod"> This page was last edited on 6 March 2015, at 15:54.</li>
<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0</a> unless otherwise noted.</li>
</ul>
<ul id="footer-places">
<li id="footer-places-privacy"><a href="/wiki/Bitcoin_Wiki:Privacy_policy" title="Bitcoin Wiki:Privacy policy">Privacy policy</a></li>
<li id="footer-places-about"><a href="/wiki/Bitcoin_Wiki:About" title="Bitcoin Wiki:About">About Bitcoin Wiki</a></li>
<li id="footer-places-disclaimer"><a href="/wiki/Bitcoin_Wiki:General_disclaimer" title="Bitcoin Wiki:General disclaimer">Disclaimers</a></li>
</ul>
<ul id="footer-icons" class="noprint">
<li id="footer-poweredbyico">
<a href="//www.mediawiki.org/"><img src="/w/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/w/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /w/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a> </li>
</ul>
<div style="clear:both"></div>
</div>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.004","walltime":"0.004","ppvisitednodes":{"value":50,"limit":1000000},"ppgeneratednodes":{"value":64,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20211030233310","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":31});});</script>
</body>
</html>
