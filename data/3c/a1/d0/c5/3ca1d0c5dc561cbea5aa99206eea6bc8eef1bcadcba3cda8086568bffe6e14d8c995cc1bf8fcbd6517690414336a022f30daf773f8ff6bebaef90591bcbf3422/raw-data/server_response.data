-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Wed May 21 11:18:21 CDT 2008
===============================================================================
                           VULNERABILITY SUMMARY

VULNERABILITY:      AIX errpt buffer overflow

PLATFORMS:          AIX 5.2, 5.3, 6.1

SOLUTION:           Apply the fix or workaround as described below.

THREAT:             A local attacker may execute arbitrary code.

CVE Number:         n/a

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   YES (high, medium, or low)
Protected by SED?   YES
===============================================================================
                           DETAILED INFORMATION

I. DESCRIPTION

    The errpt command contains a buffer which can overflow.  A local
    attacker may exploit this overflow to execute arbitrary code with
    root privileges because the command is setuid root.

    The following files are vulnerable:

    /usr/bin/errpt

II. PLATFORM VULNERABILITY ASSESSMENT

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.sysmgt.serv_aid

    The following fileset levels are vulnerable:

    AIX Fileset                Lower Level    Upper Level
    -----------------------------------------------------------
    bos.sysmgt.serv_aid        5.2.0.85       5.2.0.86
    bos.sysmgt.serv_aid        5.2.0.95       5.2.0.96
    bos.sysmgt.serv_aid        5.2.0.105      5.2.0.108
    bos.sysmgt.serv_aid        5.3.0.50       5.3.0.53
    bos.sysmgt.serv_aid        5.3.0.60       5.3.0.65
    bos.sysmgt.serv_aid        5.3.7.0        5.3.7.2
    bos.sysmgt.serv_aid        5.3.8.0        5.3.8.0
    bos.sysmgt.serv_aid        6.1.0.0        6.1.0.3

III. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Availability
        ---------------------------------------------------
        5.2.0               IZ19905            Now
        5.3.0               IZ22346            6/20/2008
        5.3.7               IZ22347            6/20/2008
        5.3.8               IZ21494            6/20/2008
        6.1.0               IZ22348            6/20/2008

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ19905
        http://www.ibm.com/support/docview.wss?uid=isg1IZ22346
        http://www.ibm.com/support/docview.wss?uid=isg1IZ22347
        http://www.ibm.com/support/docview.wss?uid=isg1IZ21494
        http://www.ibm.com/support/docview.wss?uid=isg1IZ22348

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        Fixes are available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/errpt_fix.tar
        ftp://aix.software.ibm.com/aix/efixes/security/errpt_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.
        The fixes below include prerequisite checking. This will
        enforce the correct mapping between the fixes and AIX
        Technology Levels.

        AIX Level          Fix (*.U) and Interim Fix (*.Z)
        -------------------------------------------------------------------
        5.2.0 TL8          IZ19905_08.080514.epkg.Z
        5.2.0 TL9          IZ19905_09.080514.epkg.Z
        5.2.0 TL10         IZ19905_10.080514.epkg.Z
        5.3.0 TL5          IZ22346_05.080514.epkg.Z
        5.3.0 TL6          IZ22346_06.080514.epkg.Z
        5.3.7              IZ22347_07.080514.epkg.Z
        5.3.8              IZ21494_08.080514.epkg.Z
        6.1.0              IZ22348_00.080514.epkg.Z

        To extract the fixes from the tar file:

        tar xvf errpt_fix.tar
        cd errpt_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "sum", "cksum",
        "csum -h MD5" (md5sum), and "csum -h SHA1" (sha1sum) commands
        and are as follows:

        sum         filename
        -------------------------------------
        20662    70 IZ19905_08.080514.epkg.Z
        49871    70 IZ19905_09.080514.epkg.Z
        65249    70 IZ19905_10.080514.epkg.Z
        20402    77 IZ21494_08.080514.epkg.Z
        38539    71 IZ22346_05.080514.epkg.Z
        58208    71 IZ22346_06.080514.epkg.Z
        36061    71 IZ22347_07.080514.epkg.Z
        42508    80 IZ22348_00.080514.epkg.Z

        cksum            filename
        -------------------------------------------
        3882518034 70837 IZ19905_08.080514.epkg.Z
        2140254126 70873 IZ19905_09.080514.epkg.Z
        2999649633 70855 IZ19905_10.080514.epkg.Z
        136921164  77935 IZ21494_08.080514.epkg.Z
        4041292547 71831 IZ22346_05.080514.epkg.Z
        2261779182 72003 IZ22346_06.080514.epkg.Z
        2782459181 71977 IZ22347_07.080514.epkg.Z
        136691478  81601 IZ22348_00.080514.epkg.Z

        csum -h MD5 (md5sum)              filename
        -----------------------------------------------------------
        ddb6f834e7ac261eec0d050692f9a4f9  IZ19905_08.080514.epkg.Z
        7d731e832f34a85dedbaab6944259ff7  IZ19905_09.080514.epkg.Z
        b3c95dec7d77e4f6ece81a460b9081c0  IZ19905_10.080514.epkg.Z
        9097e598765864e037316d73af642213  IZ21494_08.080514.epkg.Z
        6a47bcff98bfc9967a90506d7a84c751  IZ22346_05.080514.epkg.Z
        14530192116bcff8244d159dcd9486aa  IZ22346_06.080514.epkg.Z
        cfb851756c0a0321030a702bd2438ae5  IZ22347_07.080514.epkg.Z
        2f3242a35b5ee025981fb323d03fd7f2  IZ22348_00.080514.epkg.Z

        csum -h SHA1 (sha1sum)                    filename
        -------------------------------------------------------------------
        ed9af41242cab4940e16eaa1f93edcab296d14b0  IZ19905_08.080514.epkg.Z
        fbdb43efe35323bfc22285ff3d8345fa29825e38  IZ19905_09.080514.epkg.Z
        0346358cd53a06c04bae68e7176db59bdeb89650  IZ19905_10.080514.epkg.Z
        a2f4c58a14f85ac29a4afc39e722b6174dbc25ac  IZ21494_08.080514.epkg.Z
        20cdd46d425cc37939eb8ceb317db67d3b0aaa27  IZ22346_05.080514.epkg.Z
        22735d834ffdd299ddbd727611519483ca6ea810  IZ22346_06.080514.epkg.Z
        a9b5d036d93a2a4ec32856485ef4240b3562f3e4  IZ22347_07.080514.epkg.Z
        a8a174860f1fc411f641ba6d1fea575e118e2cbb  IZ22348_00.080514.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum, md5sum, or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        md5sum -c Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security at
        security-alert@austin.ibm.com and describe the discrepancy.

     C. FIX AND INTERIM FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        To preview a fix installation:

        installp -a -d fix_name -p all  # where fix_name is the name of the
                                        # fix package being previewed.
        To install a fix package:

        installp -a -d fix_name -X all  # where fix_name is the name of the  
                                        # fix package being installed.

        Interim fixes have had limited functional and regression
        testing but not the full regression testing that takes place
        for Service Packs; thus, IBM does not warrant the fully
        correct functionality of an interim fix.

        Interim fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview an interim fix installation:

        emgr -e ipkg_name -p         # where ipkg_name is the name of the  
                                     # interim fix package being previewed.

        To install an interim fix package:

        emgr -e ipkg_name -X         # where ipkg_name is the name of the  
                                     # interim fix package being installed.

IV. WORKAROUNDS

    There are two workarounds available.

    A. OPTION 1

        Change the permissions of these commands to remove the setuid
        bit using the following commands:

        chmod 500 /usr/bin/errpt

        NOTE: chmod will disable functionality of these commands for
        all users except root.

    B. OPTION 2 (AIX 6.1, AIX 5.3 TL6 and TL7)

        Use the File Permissions Manager (fpm) command to manage
        setuid and setgid programs.

        fpm documentation can be found in the AIX 6 Security Redbook
        at:

        http://www.redbooks.ibm.com/abstracts/sg247430.html

        An fpm level of high, medium, or low will remove the setuid
        bit from the affected commands.  For example:

        fpm -l high -p    # to preview changes
        fpm -l high       # to execute changes

        NOTE: Please review the documentation before execution.  fpm
        will disable functionality of multiple commands for all users
        except root.


V. OBTAINING FIXES

    AIX security fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security
        ftp://aix.software.ibm.com/aix/efixes/security

    AIX fixes can be downloaded from:

        http://www.ibm.com/eserver/support/fixes/fixcentral/main/pseries/aix

    NOTE: Affected customers are urged to upgrade to the latest
    applicable Technology Level and Service Pack.

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:

        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com

    To request the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:

        A. Send an email with "get key" in the subject line to:

            security-alert@austin.ibm.com

        B. Download the key from a PGP Public Key Server. The key ID is:

            0xADA6EB4D

    Please contact your local IBM AIX support center for any
    assistance.

    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    IBM discovered and fixed this vulnerability as part of its
    commitment to secure the AIX operating system.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFINEtqP9Qud62m600RAl0+AKCkNgNhJaNf4JIZORXnzzl0pBxsDwCdGuOP
EOIBkMKFRGLHmLt5aOEIwsU=
=Wm1z
-----END PGP SIGNATURE-----
