<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/glance/+bug/1398830/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1398830 “[OSSA 2015-003] Glance image leak when in saving s...” : Bugs : Glance</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1398830" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1398830/bug.atom" title="Bug 1398830 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="Tushar Patil reported that https://bugs.launchpad.net/glance/+bug/1383973 can be leverage to conduct a denial of service attack on Glance backend store.

The image in saving state is not taken into account by global quota enforcement.

Attached is a script to reproduce the behavior:


Steps to reproduce (tested on file backend store)

  1.  Check how many images are present in the directory that the Filesystem backend store write the image data to (filesystem_store_datadir parameter).
  2.  R..." />
      <meta property="og:description" content="Tushar Patil reported that https://bugs.launchpad.net/glance/+bug/1383973 can be leverage to conduct a denial of service attack on Glance backend store.

The image in saving state is not taken into account by global quota enforcement.

Attached is a script to reproduce the behavior:


Steps to reproduce (tested on file backend store)

  1.  Check how many images are present in the directory that the Filesystem backend store write the image data to (filesystem_store_datadir parameter).
  2.  R..." />
    

    
    
      <meta property="og:title" content="Bug #1398830 “[OSSA 2015-003] Glance image leak when in saving s...” : Bugs : Glance" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1398830" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["api", "cache", "documentation", "domain-proxy", "gate", "i18n", "low-hanging-fruit", "metadef", "mitaka-backport-potential", "newton-backport-potential", "ocata-rc-potential", "ops", "scrubber", "security"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/glance/+bug/1398830/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/glance"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/355215744/glance-chipmunk-64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/glance">Glance</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/glance">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/glance">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/glance">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/glance">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/glance">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/glance">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1398830 reported by
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray</a>
      <time title="2014-12-03 14:03:55 UTC" datetime="2014-12-03T14:03:55.782983+00:00">on 2014-12-03</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">296</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 4 people</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1726582">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/glance/+bug/1398830/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1726582">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/glance">Glance</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/glance/+bug/1398830/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/glance/+bug/1398830/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1726582">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~lzy-dev">Zhi Yan Liu</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/glance/+milestone/2015.1.0">Glance 2015.1.0 "kilo"</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1726582">
     <td colspan="7"><form action="/glance/+bug/1398830/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/glance">Glance</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-12-03 14:03:55 UTC" datetime="2014-12-03T14:03:55.782983+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-12-03 16:57:28 UTC" datetime="2014-12-03T16:57:28.663861+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-12-30 08:53:55 UTC" datetime="2014-12-30T08:53:55.540471+00:00">2014-12-30</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-12-31 08:13:10 UTC" datetime="2014-12-31T08:13:10.372547+00:00">2014-12-31</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2015-02-05 21:56:24 UTC" datetime="2015-02-05T21:56:24.493717+00:00">2015-02-05</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="glance.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="glance.target.option.package" name="glance.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="glance.target.distribution" name="glance.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="glance.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="glance.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="glance.target.package"
                         name="glance.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;glance.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('glance.target.package');
              var select_menu = Y.DOM.byId('glance.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-glance-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": null, "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "glance.target.package", "show_widget_id": "show-widget-glance-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-glance-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="glance.target.option.product" name="glance.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="glance" id="glance.target.product"
                         name="glance.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;glance.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('glance.target.product');
              var select_menu = Y.DOM.byId('glance.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-glance-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": "glance", "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "glance.target.product", "show_widget_id": "show-widget-glance-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-glance-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="glance.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="glance.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="glance.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="glance.status" name="glance.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="glance.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          Glance 2015.1.0
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="glance.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="glance.assignee.assign_to_me" name="glance.assignee.option" value="glance.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="glance.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="glance.assignee.assigned_to" name="glance.assignee.option" value="glance.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="glance.assignee.assigned_to">
              Zhi Yan Liu (lzy-dev)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="glance.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="glance.comment_on_change" name="glance.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1732138">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/glance/icehouse/+bug/1398830/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/glance/icehouse">Icehouse</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/glance/icehouse/+bug/1398830/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/glance/icehouse/+bug/1398830/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1732138">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~flaper87">Flavio Percoco</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/glance/+milestone/2014.1.4">Glance 2014.1.4</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1732138">
     <td colspan="7"><form action="/glance/icehouse/+bug/1398830/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/glance/icehouse">Glance icehouse</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-12-12 09:16:31 UTC" datetime="2014-12-12T09:16:31.260667+00:00">2014-12-12</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2015-01-21 20:34:44 UTC" datetime="2015-01-21T20:34:44.271779+00:00">2015-01-21</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2015-01-22 15:52:36 UTC" datetime="2015-01-22T15:52:36.534687+00:00">2015-01-22</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2015-01-23 01:22:51 UTC" datetime="2015-01-23T01:22:51.351779+00:00">2015-01-23</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2015-03-13 00:58:51 UTC" datetime="2015-03-13T00:58:51.343663+00:00">2015-03-13</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="glance_icehouse.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="glance_icehouse.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="glance_icehouse.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="glance_icehouse.status" name="glance_icehouse.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="glance_icehouse.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceCRITICAL">Critical</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          Glance 2014.1.4
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="glance_icehouse.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="glance_icehouse.assignee.assign_to_me" name="glance_icehouse.assignee.option" value="glance_icehouse.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="glance_icehouse.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="glance_icehouse.assignee.assigned_to" name="glance_icehouse.assignee.option" value="glance_icehouse.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="glance_icehouse.assignee.assigned_to">
              Flavio Percoco (flaper87)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="glance_icehouse.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="glance_icehouse.comment_on_change" name="glance_icehouse.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1732137">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/glance/juno/+bug/1398830/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/glance/juno">Juno</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/glance/juno/+bug/1398830/+editstatus" style="float: left" class="value statusFIXCOMMITTED">Fix Committed</a>
          <a href="https://bugs.launchpad.net/glance/juno/+bug/1398830/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1732137">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~icordasc">Ian Cordasco</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1732137">
     <td colspan="7"><form action="/glance/juno/+bug/1398830/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/glance/juno">Glance juno</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-12-12 09:16:31 UTC" datetime="2014-12-12T09:16:31.260667+00:00">2014-12-12</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2015-01-21 20:34:48 UTC" datetime="2015-01-21T20:34:48.112907+00:00">2015-01-21</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2015-01-22 15:52:39 UTC" datetime="2015-01-22T15:52:39.301661+00:00">2015-01-22</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2015-01-22 19:43:17 UTC" datetime="2015-01-22T19:43:17.711715+00:00">2015-01-22</time>
      </td>
    </tr>
    
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="glance_juno.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="glance_juno.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="glance_juno.status" name="glance_juno.status" size="1" >
<option selected="selected" value="Fix Committed">Fix Committed</option>
</select>
</div>
<input name="glance_juno.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceCRITICAL">Critical</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="glance_juno.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="glance_juno.assignee.assign_to_me" name="glance_juno.assignee.option" value="glance_juno.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="glance_juno.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="glance_juno.assignee.assigned_to" name="glance_juno.assignee.option" value="glance_juno.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="glance_juno.assignee.assigned_to">
              Ian Cordasco (icordasc)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="glance_juno.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="glance_juno.comment_on_change" name="glance_juno.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1726583">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1398830/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1726583">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1398830/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1398830/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1726583">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~tristan-cacqueray">Tristan Cacqueray</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1726583">
     <td colspan="7"><form action="/ossa/+bug/1398830/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-12-03 14:04:11 UTC" datetime="2014-12-03T14:04:11.820509+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-12-08 15:19:44 UTC" datetime="2014-12-08T15:19:44.497485+00:00">2014-12-08</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2015-01-16 21:52:55 UTC" datetime="2015-01-16T21:52:55.800649+00:00">2015-01-16</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2015-01-16 21:52:53 UTC" datetime="2015-01-16T21:52:53.044660+00:00">2015-01-16</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2015-01-26 16:26:07 UTC" datetime="2015-01-26T16:26:07.000432+00:00">2015-01-26</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": null, "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "ossa.target.package", "show_widget_id": "show-widget-ossa-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": "ossa", "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "ossa.target.product", "show_widget_id": "show-widget-ossa-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Tristan Cacqueray (tristan-cacqueray)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/glance/+bug/1398830/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/glance/+bug/1398830/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/glance/+bug/1398830/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>Tushar Patil reported that <a rel="nofollow" href="https://bugs.launchpad.net/glance/+bug/1383973">https:/<wbr />/bugs.launchpad<wbr />.net/glance/<wbr />+bug/1383973</a> can be leverage to conduct a denial of service attack on Glance backend store.</p>
<p>The image in saving state is not taken into account by global quota enforcement.</p>
<p>Attached is a script to reproduce the behavior:</p>
<p>Steps to reproduce (tested on file backend store)</p>
<p>&nbsp;&nbsp;1.  Check how many images are present in the directory that the Filesystem backend store write the image data to (filesystem_<wbr />store_datadir parameter).<br />
&nbsp;&nbsp;2.  Run the program for 1 hour<br />
&nbsp;&nbsp;3.  Again count images (step 1), it should be the same as recorded in Step 1.</p>
<p>We ran this program for 1 hour in our environment.<br />
Before running the program, count of images in the file store (/opt/stack/<wbr />data/glance/<wbr />images) was 6.</p>
<p>After running the program for 1 hr,</p>
<p>&nbsp;&nbsp;*   Total count of images in the folder /opt/stack/<wbr />data/glance/<wbr />images = 806 (it should have been 6)<br />
&nbsp;&nbsp;*   Total count of images created = 1014<br />
&nbsp;&nbsp;*   Total count of images deleted in saving state = 800<br />
&nbsp;&nbsp;*   Total count of images deleted = 1014</p>
<p>Considering the bug is already public, fix should be proposed directly on gerrit, this new report will let us work on the impact statement and coordinate the security work in parallel to the public fix being merged.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T14:03:55.782983+00:00" title="2014-12-03 14:03:55 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/glance/+bug/1398830/+attachment/4273529/+files/test_images.py">test_images.py</a>
        <a class="sprite edit action-icon" href="/glance/+bug/1398830/+attachment/4273529">Edit</a>
        (1.8 KiB,
        text/x-python)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T15:19:37.548533+00:00" title="2014-12-03 15:19:37 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I see <a href="/bugs/1383973" class="bug-link">bug 1383973</a> was switched to private security after being public for more than a month. Is the intent to mark one as a duplicate of the other?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I see bug 1383973 was switched to private security after being public for more than a month. Is the intent to mark one as a duplicate of the other?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T15:41:39.741949+00:00" title="2014-12-03 15:41:39 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@fungi Yes the idea would have been to discuss security implication here as <a href="/bugs/1383973" class="bug-link">bug 1383973</a> didn&#x27;t have any security tags on it.</p>
<p>Also the former bug lack a description that the behavior overcome quotas settings...</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@fungi Yes the idea would have been to discuss security implication here as bug 1383973 didn't have any security tags on it.

Also the former bug lack a description that the behavior overcome quotas settings...</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~stuart-mclaren" class="sprite person">Stuart McLaren (stuart-mclaren)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T15:47:58.483655+00:00" title="2014-12-03 15:47:58 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; The image in saving state is not taken into account by global quota enforcement.
</span></p>
<p>Just to clarify, are we talking about this quota setting?</p>
<p>&nbsp;# Set a system wide quota for every user.  This value is the total number<br />
&nbsp;# of bytes that a user can use across all storage systems.  A value of<br />
&nbsp;# 0 means unlimited.<br />
&nbsp;#user_<wbr />storage_<wbr />quota = 0</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; The image in saving state is not taken into account by global quota enforcement.

Just to clarify, are we talking about this quota setting? 

 # Set a system wide quota for every user.  This value is the total number
 # of bytes that a user can use across all storage systems.  A value of
 # 0 means unlimited.
 #user_storage_quota = 0

Thanks
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T16:08:53.894172+00:00" title="2014-12-03 16:08:53 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Stuart: yes, the attack is not mitigated by this setting.<br />
I guess the reasoning is that most likely vulnerable setups would have set this value and it won&#x27;t protect against this attack.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Stuart: yes, the attack is not mitigated by this setting.
I guess the reasoning is that most likely vulnerable setups would have set this value and it won't protect against this attack.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~stuart-mclaren" class="sprite person">Stuart McLaren (stuart-mclaren)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T16:23:28.445032+00:00" title="2014-12-03 16:23:28 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m seeing this when trying to reproduce with the test_images.py script<br />
attached to the bug:</p>
<p>&nbsp;2014-12-03 16:21:03.387 30059 TRACE glance.<wbr />api.v1.<wbr />upload_<wbr />utils     result = fd.read(*args)<br />
&nbsp;2014-12-03 16:21:03.387 30059 TRACE glance.<wbr />api.v1.<wbr />upload_<wbr />utils   File &quot;glance/<wbr />common/<wbr />utils.py&quot;<wbr />, line 191, in read<br />
&nbsp;2014-12-03 16:21:03.387 30059 TRACE glance.<wbr />api.v1.<wbr />upload_<wbr />utils     result = self.data.read(i)<br />
&nbsp;2014-12-03 16:21:03.387 30059 TRACE glance.<wbr />api.v1.<wbr />upload_<wbr />utils AttributeError: &#x27;ResponseIndexable&#x27; object has no attribute  &#x27;read&#x27;</p>
<p>looks like an issue with copy-from.</p>
<p>I&#x27;m using juno stable code.<br />
Anyone else get the reproducer to work on juno?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm seeing this when trying to reproduce with the test_images.py script
attached to the bug:

 2014-12-03 16:21:03.387 30059 TRACE glance.api.v1.upload_utils     result = fd.read(*args)
 2014-12-03 16:21:03.387 30059 TRACE glance.api.v1.upload_utils   File "glance/common/utils.py", line 191, in read
 2014-12-03 16:21:03.387 30059 TRACE glance.api.v1.upload_utils     result = self.data.read(i)
 2014-12-03 16:21:03.387 30059 TRACE glance.api.v1.upload_utils AttributeError: 'ResponseIndexable' object has no attribute  'read'

looks like an issue with copy-from.

I'm using juno stable code.
Anyone else get the reproducer to work on juno?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~stuart-mclaren" class="sprite person">Stuart McLaren (stuart-mclaren)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T16:46:28.322754+00:00" title="2014-12-03 16:46:28 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I had to go back to grizzly to get copy-from to work for me.</p>
<p>Any one else had success with copy-from on a later code base?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I had to go back to grizzly to get copy-from to work for me.

Any one else had success with copy-from on a later code base?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~stuart-mclaren" class="sprite person">Stuart McLaren (stuart-mclaren)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T16:59:02.350708+00:00" title="2014-12-03 16:59:02 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Confirmed on Grizzly using reproducer.</p>
<p>Based on zhiyan&#x27;s update to <a rel="nofollow" href="https://bugs.launchpad.net/glance/+bug/1383973">https:/<wbr />/bugs.launchpad<wbr />.net/glance/<wbr />+bug/1383973</a> the underlying inability to delete the bits of an image in a saving state still exists.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Confirmed on Grizzly using reproducer.

Based on zhiyan's update to https://bugs.launchpad.net/glance/+bug/1383973 the underlying inability to delete the bits of an image in a saving state still exists.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~abhishek-kekane" class="sprite person">Abhishek Kekane (abhishek-kekane)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-08T07:14:42.656969+00:00" title="2014-12-08 07:14:42 UTC">on 2014-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi,</p>
<p>I have done some testing using attached program by admin and normal user(demo).</p>
<p>In case of admin user, if image is deleted while it is in saving state, image data doesn&#x27;t get deleted even after data is completely uploaded to the backend.</p>
<p>In case of normal user, if image is deleted while it is in saving state, data gets deleted after image upload completes.<br />
In this case once upload is completed it tries to update the image meta-data, but as image is already deleted it raises ImageNotFound exception and cleans the data for that image from the backend.</p>
<p>user_storage_quota is not considered in the above case as the image is deleted. user_storage_quota doesn&#x27;t considered &#x27;deleted&#x27; or &#x27;killed&#x27; images for checking the quota size. So if the image is deleted while the uploading is processing and user tries to add new image, the user_storage_quota will not consider the previous image size as it&#x27;s status is deleted and doesn&#x27;t throw &#x27;StorageQuotaFull&#x27; exception even if quota size is exceeding.</p>
<p>IMO, image deletion should not be allowed when the image is in saving state.<br />
Please let me know your opinion on the same.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi,

I have done some testing using attached program by admin and normal user(demo).

In case of admin user, if image is deleted while it is in saving state, image data doesn't get deleted even after data is completely uploaded to the backend.

In case of normal user, if image is deleted while it is in saving state, data gets deleted after image upload completes.
In this case once upload is completed it tries to update the image meta-data, but as image is already deleted it raises ImageNotFound exception and cleans the data for that image from the backend.

user_storage_quota is not considered in the above case as the image is deleted. user_storage_quota doesn't considered 'deleted' or 'killed' images for checking the quota size. So if the image is deleted while the uploading is processing and user tries to add new image, the user_storage_quota will not consider the previous image size as it's status is deleted and doesn't throw 'StorageQuotaFull' exception even if quota size is exceeding. 

IMO, image deletion should not be allowed when the image is in saving state.
Please let me know your opinion on the same.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lzy-dev" class="sprite person">Zhi Yan Liu (lzy-dev)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-08T09:16:14.416148+00:00" title="2014-12-08 09:16:14 UTC">on 2014-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Abhishek&#x27;s analysis.</p>
<p>&gt;&gt;&gt; IMO, image deletion should not be allowed when the image is in saving state.</p>
<p>IMO, seems it&#x27;s a easiest solution as to make a limitation/checking on api level for end user. However I&#x27;m a little worried if it reduces usability from end user&#x27;s perspective. And more, from some cross-project cases, image could dead on &#x27;saving&#x27; status, e.g. Nova capture  image failed/hang on upload step, then end user or client code e.g. Nova, need a way to delete the dead image from Glance.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Abhishek's analysis.

&gt;&gt;&gt; IMO, image deletion should not be allowed when the image is in saving state.

IMO, seems it's a easiest solution as to make a limitation/checking on api level for end user. However I'm a little worried if it reduces usability from end user's perspective. And more, from some cross-project cases, image could dead on 'saving' status, e.g. Nova capture  image failed/hang on upload step, then end user or client code e.g. Nova, need a way to delete the dead image from Glance.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-08T15:19:43.442246+00:00" title="2014-12-08 15:19:43 UTC">on 2014-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>OK, my understanding is that this is a valid vulnerability, even if the user is not an admin. Let me know if I got it wrong.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">OK, my understanding is that this is a valid vulnerability, even if the user is not an admin. Let me know if I got it wrong.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~nikhil-komawar" class="sprite person">Nikhil Komawar (nikhil-komawar)</a>
    
    <time title="2014-12-09 17:46:36 UTC" datetime="2014-12-09T17:46:36.648582+00:00">on 2014-12-09</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-15T20:37:39.127093+00:00" title="2014-12-15 20:37:39 UTC">on 2014-12-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Considering the former report does not apply to normal user (see comment #9), the severity is lower than expected: The quota is overran only until the upload is completed and images are cleaned after.<br />
I also did not consider malicious administrator.</p>
<p>Here is impact description draft #1</p>
<p>Title: Glance user storage quota bypass<br />
Reporter: Tushar Patil (NTT)<br />
Products: Glance<br />
Versions: up to 2014.1.3 and 2014.2 version up to 2014.2.1</p>
<p>Description:<br />
Tushar Patil from NTT reported a vulnerability in Glance. By deleting images that are being uploaded, a malicious user can overcome the storage quota and thus may overrun the backend. Images in deleted state are not taken into account by quota and won&#x27;t be effectively deleted until the upload is completed. Only Glance setups configured with user_storage_quota are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Considering the former report does not apply to normal user (see comment #9), the severity is lower than expected: The quota is overran only until the upload is completed and images are cleaned after.
I also did not consider malicious administrator.

Here is impact description draft #1

Title: Glance user storage quota bypass 
Reporter: Tushar Patil (NTT)
Products: Glance
Versions: up to 2014.1.3 and 2014.2 version up to 2014.2.1

Description:
Tushar Patil from NTT reported a vulnerability in Glance. By deleting images that are being uploaded, a malicious user can overcome the storage quota and thus may overrun the backend. Images in deleted state are not taken into account by quota and won't be effectively deleted until the upload is completed. Only Glance setups configured with user_storage_quota are affected.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-15T21:54:11.199534+00:00" title="2014-12-15 21:54:11 UTC">on 2014-12-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 impact description</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 impact description</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-22T15:20:33.906915+00:00" title="2014-12-22 15:20:33 UTC">on 2014-12-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 impact desc</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 impact desc</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~lzy-dev" class="sprite person">Zhi Yan Liu (lzy-dev)</a>
    
    <time title="2014-12-30 08:53:54 UTC" datetime="2014-12-30T08:53:54.971782+00:00">on 2014-12-30</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Zhi Yan Liu (lzy-dev)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lzy-dev" class="sprite person">Zhi Yan Liu (lzy-dev)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-31T08:13:02.748883+00:00" title="2014-12-31 08:13:02 UTC">on 2014-12-31</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix for master trunk proposed at <a rel="nofollow" href="https://review.openstack.org/#/c/144464/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />144464/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix for master trunk proposed at https://review.openstack.org/#/c/144464/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-31T15:14:47.531893+00:00" title="2014-12-31 15:14:47 UTC">on 2014-12-31</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>In the future, please do not make any public mention of embargoed (private) security vulnerabilities before their coordinated publication by the OpenStack Vulnerability Management Team in the form of an official OpenStack Security Advisory. This includes discussion of the bug or associated fixes in public forums such as mailing lists, code review systems and bug trackers. Please also avoid private disclosure to other individuals not already approved for access to this information, and provide this same reminder to those who are made aware of the issue prior to publication. All discussion should remain confined to this private bug report, and any proposed fixes should be added as to the bug as attachments.</p>
<p>Since this bug is now mentioned in a public code review change, we should go ahead and end the embargo by switching it from private security to public security.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">In the future, please do not make any public mention of embargoed (private) security vulnerabilities before their coordinated publication by the OpenStack Vulnerability Management Team in the form of an official OpenStack Security Advisory. This includes discussion of the bug or associated fixes in public forums such as mailing lists, code review systems and bug trackers. Please also avoid private disclosure to other individuals not already approved for access to this information, and provide this same reminder to those who are made aware of the issue prior to publication. All discussion should remain confined to this private bug report, and any proposed fixes should be added as to the bug as attachments.

Since this bug is now mentioned in a public code review change, we should go ahead and end the embargo by switching it from private security to public security.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-31T15:34:26.142184+00:00" title="2014-12-31 15:34:26 UTC">on 2014-12-31</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Oh, I see where the bug description could have been misinterpreted--the expectation on this particular issue (since there&#x27;s a corresponding public bug which doesn&#x27;t mention any security implications) was that it could be fixed in public without discussing this private bug report. However the commit message unfortunately mentions both bug numbers rather than just the public bug.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Oh, I see where the bug description could have been misinterpreted--the expectation on this particular issue (since there's a corresponding public bug which doesn't mention any security implications) was that it could be fixed in public without discussing this private bug report. However the commit message unfortunately mentions both bug numbers rather than just the public bug.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lzy-dev" class="sprite person">Zhi Yan Liu (lzy-dev)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-01T00:56:30.150021+00:00" title="2015-01-01 00:56:30 UTC">on 2015-01-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Re @fungi, about bug number mentioning within patch&#x27;s commit message, I think it&#x27;s not a big deal due to this report is under private status, improper users couldn&#x27;t even know the background and deeper affect from security perspective.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Re @fungi, about bug number mentioning within patch's commit message, I think it's not a big deal due to this report is under private status, improper users couldn't even know the background and deeper affect from security perspective.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-01T01:13:14.312226+00:00" title="2015-01-01 01:13:14 UTC">on 2015-01-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewers who see that bug number and attempt to view the resultant bug report will get a message which says &quot;...you may not have permission to see it...&quot; which is generally known to indicate a private bug (especially if they check that the next bug number following it is already allocated). This is then a hint to more closely scrutinize the review and the other public bug report for an indication of why it might indicate a vulnerable condition.</p>
<p>It&#x27;s not a disaster, just an indication that we should perhaps go ahead and switch this bug to public as well so as to avoid any further confusion.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewers who see that bug number and attempt to view the resultant bug report will get a message which says "...you may not have permission to see it..." which is generally known to indicate a private bug (especially if they check that the next bug number following it is already allocated). This is then a hint to more closely scrutinize the review and the other public bug report for an indication of why it might indicate a vulnerable condition.

It's not a disaster, just an indication that we should perhaps go ahead and switch this bug to public as well so as to avoid any further confusion.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~nikhil-komawar" class="sprite person">Nikhil Komawar (nikhil-komawar)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-13T05:29:54.731430+00:00" title="2015-01-13 05:29:54 UTC">on 2015-01-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Have left some comments on <a rel="nofollow" href="https://review.openstack.org/#/c/144464/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />144464/</a> ; let&#x27;s wait for Zhi Yan a bit. If he is away tomorrow, we can fix the commit message from the web UI as needed.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Have left some comments on https://review.openstack.org/#/c/144464/ ; let's wait for Zhi Yan a bit. If he is away tomorrow, we can fix the commit message from the web UI as needed.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-16T21:53:03.648468+00:00" title="2015-01-16 21:53:03 UTC">on 2015-01-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I open this bug since its pretty much already disclosed and I&#x27;ll request a CVE with impact description from comment #12.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I open this bug since its pretty much already disclosed and I'll request a CVE with impact description from comment #12.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Tristan Cacqueray (tristan-cacqueray)
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~nikhil-komawar" class="sprite person">Nikhil Komawar (nikhil-komawar)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-16T22:35:45.243111+00:00" title="2015-01-16 22:35:45 UTC">on 2015-01-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tristan: Sounds good.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tristan: Sounds good.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; kilo-2
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-17T00:26:33.792203+00:00" title="2015-01-17 00:26:33 UTC">on 2015-01-17</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/glance/+bug/1398830/comments/23">
                <strong>Fix merged to glance (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/144464">https:/<wbr />/review.<wbr />openstack.<wbr />org/144464</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/glance/commit/?id=0dc8fbb3479a53c5bba8475d14f4c7206904c5ea">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />glance/<wbr />commit/<wbr />?id=0dc8fbb3479<wbr />a53c5bba8475d14<wbr />f4c7206904c5ea</a><br />
Submitter: Jenkins<br />
Branch:    master</p>
<p>commit 0dc8fbb3479a53c<wbr />5bba8475d14f4c7<wbr />206904c5ea<br />
Author: Zhi Yan Liu &lt;email address hidden&gt;<br />
Date:   Tue Dec 30 22:25:50 2014 +0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Cleanup chunks for deleted image that was &#x27;saving&#x27;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Currently image data cannot be removed synchronously for an image that<br />
&nbsp;&nbsp;&nbsp;&nbsp;is in saving state. And when, the upload operation for such an image is<br />
&nbsp;&nbsp;&nbsp;&nbsp;completed the operator configured quota can be exceeded.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch fixes the issue of left over chunks for an image which was<br />
&nbsp;&nbsp;&nbsp;&nbsp;deleted from saving status. However, by the limitation of the design we<br />
&nbsp;&nbsp;&nbsp;&nbsp;cannot enforce a global quota check for the image in saving status.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This change introduces a inconsonance between http response codes of<br />
&nbsp;&nbsp;&nbsp;&nbsp;v1 and v2 APIs. The status codes which we will now see after the upload<br />
&nbsp;&nbsp;&nbsp;&nbsp;process completes on an image which was deleted mid way are:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;v1: 412 Precondition Failed<br />
&nbsp;&nbsp;&nbsp;&nbsp;v2: 410 Gone</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;SecurityImpact<br />
&nbsp;&nbsp;&nbsp;&nbsp;UpgradeImpact<br />
&nbsp;&nbsp;&nbsp;&nbsp;APIImpact</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1383973<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1398830<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1188532</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I47229b366c2536<wbr />7ec1bd48aec684e<wbr />0880f3dfe60<br />
&nbsp;&nbsp;&nbsp;&nbsp;Signed-off-by: Zhi Yan Liu &lt;email address hidden&gt;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/144464
Committed: https://git.openstack.org/cgit/openstack/glance/commit/?id=0dc8fbb3479a53c5bba8475d14f4c7206904c5ea
Submitter: Jenkins
Branch:    master

commit 0dc8fbb3479a53c5bba8475d14f4c7206904c5ea
Author: Zhi Yan Liu &lt;zhiyanl@cn.ibm.com&gt;
Date:   Tue Dec 30 22:25:50 2014 +0800

    Cleanup chunks for deleted image that was 'saving'
    
    Currently image data cannot be removed synchronously for an image that
    is in saving state. And when, the upload operation for such an image is
    completed the operator configured quota can be exceeded.
    
    This patch fixes the issue of left over chunks for an image which was
    deleted from saving status. However, by the limitation of the design we
    cannot enforce a global quota check for the image in saving status.
    
    This change introduces a inconsonance between http response codes of
    v1 and v2 APIs. The status codes which we will now see after the upload
    process completes on an image which was deleted mid way are:
    
    v1: 412 Precondition Failed
    v2: 410 Gone
    
    SecurityImpact
    UpgradeImpact
    APIImpact
    
    Closes-Bug: 1383973
    Closes-Bug: 1398830
    Closes-Bug: 1188532
    
    Change-Id: I47229b366c25367ec1bd48aec684e0880f3dfe60
    Signed-off-by: Zhi Yan Liu &lt;zhiyanl@cn.ibm.com&gt;
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2015-01-19 00:39:55 UTC" datetime="2015-01-19T00:39:55.815597+00:00">on 2015-01-19</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Glance image leak when in saving state<br />+ Glance image leak when in saving state (CVE-2014-9623)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-22T20:20:01.822630+00:00" title="2015-01-22 20:20:01 UTC">on 2015-01-22</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/glance/+bug/1398830/comments/24">
                <strong>Fix proposed to glance (stable/juno)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/juno<br />
Review: <a rel="nofollow" href="https://review.openstack.org/149387">https:/<wbr />/review.<wbr />openstack.<wbr />org/149387</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/juno
Review: https://review.openstack.org/149387</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-23T11:36:36.871909+00:00" title="2015-01-23 11:36:36 UTC">on 2015-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/glance/+bug/1398830/comments/25">
                <strong>Fix merged to glance (stable/juno)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/149387">https:/<wbr />/review.<wbr />openstack.<wbr />org/149387</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/glance/commit/?id=7d5d8657fd70b20518610b3c6f8e41e16c72fa31">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />glance/<wbr />commit/<wbr />?id=7d5d8657fd7<wbr />0b20518610b3c6f<wbr />8e41e16c72fa31</a><br />
Submitter: Jenkins<br />
Branch:    stable/juno</p>
<p>commit 7d5d8657fd70b20<wbr />518610b3c6f8e41<wbr />e16c72fa31<br />
Author: Zhi Yan Liu &lt;email address hidden&gt;<br />
Date:   Tue Dec 30 22:25:50 2014 +0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Cleanup chunks for deleted image that was &#x27;saving&#x27;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Currently image data cannot be removed synchronously for an image that<br />
&nbsp;&nbsp;&nbsp;&nbsp;is in saving state. And when, the upload operation for such an image is<br />
&nbsp;&nbsp;&nbsp;&nbsp;completed the operator configured quota can be exceeded.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch fixes the issue of left over chunks for an image which was<br />
&nbsp;&nbsp;&nbsp;&nbsp;deleted from saving status. However, by the limitation of the design we<br />
&nbsp;&nbsp;&nbsp;&nbsp;cannot enforce a global quota check for the image in saving status.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This change introduces a inconsonance between http response codes of<br />
&nbsp;&nbsp;&nbsp;&nbsp;v1 and v2 APIs. The status codes which we will now see after the upload<br />
&nbsp;&nbsp;&nbsp;&nbsp;process completes on an image which was deleted mid way are:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;v1: 412 Precondition Failed<br />
&nbsp;&nbsp;&nbsp;&nbsp;v2: 410 Gone</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;SecurityImpact<br />
&nbsp;&nbsp;&nbsp;&nbsp;UpgradeImpact<br />
&nbsp;&nbsp;&nbsp;&nbsp;APIImpact</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1383973<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1398830<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1188532</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />api/v1/<wbr />upload_<wbr />utils.py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />api/v2/<wbr />image_data.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />tests/unit/<wbr />test_domain_<wbr />proxy.py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />tests/unit/<wbr />v1/test_<wbr />api.py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I47229b366c2536<wbr />7ec1bd48aec684e<wbr />0880f3dfe60<br />
&nbsp;&nbsp;&nbsp;&nbsp;Signed-off-by: Zhi Yan Liu &lt;email address hidden&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 0dc8fbb3479a53c<wbr />5bba8475d14f4c7<wbr />206904c5ea)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/149387
Committed: https://git.openstack.org/cgit/openstack/glance/commit/?id=7d5d8657fd70b20518610b3c6f8e41e16c72fa31
Submitter: Jenkins
Branch:    stable/juno

commit 7d5d8657fd70b20518610b3c6f8e41e16c72fa31
Author: Zhi Yan Liu &lt;zhiyanl@cn.ibm.com&gt;
Date:   Tue Dec 30 22:25:50 2014 +0800

    Cleanup chunks for deleted image that was 'saving'
    
    Currently image data cannot be removed synchronously for an image that
    is in saving state. And when, the upload operation for such an image is
    completed the operator configured quota can be exceeded.
    
    This patch fixes the issue of left over chunks for an image which was
    deleted from saving status. However, by the limitation of the design we
    cannot enforce a global quota check for the image in saving status.
    
    This change introduces a inconsonance between http response codes of
    v1 and v2 APIs. The status codes which we will now see after the upload
    process completes on an image which was deleted mid way are:
    
    v1: 412 Precondition Failed
    v2: 410 Gone
    
    SecurityImpact
    UpgradeImpact
    APIImpact
    
    Closes-Bug: 1383973
    Closes-Bug: 1398830
    Closes-Bug: 1188532
    
    Conflicts:
    	glance/api/v1/upload_utils.py
    	glance/api/v2/image_data.py
    	glance/tests/unit/test_domain_proxy.py
    	glance/tests/unit/v1/test_api.py
    
    Change-Id: I47229b366c25367ec1bd48aec684e0880f3dfe60
    Signed-off-by: Zhi Yan Liu &lt;zhiyanl@cn.ibm.com&gt;
    (cherry picked from commit 0dc8fbb3479a53c5bba8475d14f4c7206904c5ea)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-23T15:04:04.871350+00:00" title="2015-01-23 15:04:04 UTC">on 2015-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/glance/+bug/1398830/comments/26">
                <strong>Change abandoned on glance (stable/icehouse)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by nikhil komawar (&lt;email address hidden&gt;) on branch: stable/icehouse<br />
Review: <a rel="nofollow" href="https://review.openstack.org/149397">https:/<wbr />/review.<wbr />openstack.<wbr />org/149397</a><br />
Reason: <a rel="nofollow" href="https://review.openstack.org/#/c/149646">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />149646</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by nikhil komawar (nikhil.komawar@rackspace.com) on branch: stable/icehouse
Review: https://review.openstack.org/149397
Reason: https://review.openstack.org/#/c/149646</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~nikhil-komawar" class="sprite person">Nikhil Komawar (nikhil-komawar)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-23T15:07:40.683888+00:00" title="2015-01-23 15:07:40 UTC">on 2015-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/glance/+bug/1398830/comments/27">
                <strong>Re: Glance image leak when in saving state (CVE-2014-9623)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>(confirming) stable/icehouse: <a rel="nofollow" href="https://review.openstack.org/#/c/149646">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />149646</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">(confirming) stable/icehouse: https://review.openstack.org/#/c/149646</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2015-01-23 15:43:33 UTC" datetime="2015-01-23T15:43:33.584879+00:00">on 2015-01-23</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/glance/+bug/1398830/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-23T16:45:51.059755+00:00" title="2015-01-23 16:45:51 UTC">on 2015-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/glance/+bug/1398830/comments/28">
                <strong>Fix merged to glance (stable/icehouse)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/glance/+bug/1398830/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/149646">https:/<wbr />/review.<wbr />openstack.<wbr />org/149646</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/glance/commit/?id=f1260cc771ee068651aa62b972bef49d9af81eb0">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />glance/<wbr />commit/<wbr />?id=f1260cc771e<wbr />e068651aa62b972<wbr />bef49d9af81eb0</a><br />
Submitter: Jenkins<br />
Branch:    stable/icehouse</p>
<p>commit f1260cc771ee068<wbr />651aa62b972bef4<wbr />9d9af81eb0<br />
Author: Zhi Yan Liu &lt;email address hidden&gt;<br />
Date:   Tue Dec 30 22:25:50 2014 +0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Cleanup chunks for deleted image that was &#x27;saving&#x27;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Currently image data cannot be removed synchronously for an image that<br />
&nbsp;&nbsp;&nbsp;&nbsp;is in saving state. And when, the upload operation for such an image is<br />
&nbsp;&nbsp;&nbsp;&nbsp;completed the operator configured quota can be exceeded.<br />
&nbsp;&nbsp;&nbsp;&nbsp;This patch fixes the issue of left over chunks for an image which was<br />
&nbsp;&nbsp;&nbsp;&nbsp;deleted from saving status. However, by the limitation of the design we<br />
&nbsp;&nbsp;&nbsp;&nbsp;cannot enforce a global quota check for the image in saving status.<br />
&nbsp;&nbsp;&nbsp;&nbsp;This change introduces a inconsonance between http response codes of<br />
&nbsp;&nbsp;&nbsp;&nbsp;v1 and v2 APIs. The status codes which we will now see after the upload<br />
&nbsp;&nbsp;&nbsp;&nbsp;process completes on an image which was deleted mid way are:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;v1: 412 Precondition Failed<br />
&nbsp;&nbsp;&nbsp;&nbsp;v2: 410 Gone</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;SecurityImpact<br />
&nbsp;&nbsp;&nbsp;&nbsp;UpgradeImpact<br />
&nbsp;&nbsp;&nbsp;&nbsp;APIImpact</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1383973<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1398830<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1188532</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />api/v1/<wbr />upload_<wbr />utils.py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />api/v2/<wbr />image_data.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />quota/_<wbr />_init__<wbr />.py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />tests/unit/<wbr />test_domain_<wbr />proxy.py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />tests/unit/<wbr />test_quota.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glance/<wbr />tests/unit/<wbr />v1/test_<wbr />api.py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Signed-off-by: Zhi Yan Liu &lt;email address hidden&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 0dc8fbb3479a53c<wbr />5bba8475d14f4c7<wbr />206904c5ea)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I47229b366c2536<wbr />7ec1bd48aec684e<wbr />0880f3dfe60</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/149646
Committed: https://git.openstack.org/cgit/openstack/glance/commit/?id=f1260cc771ee068651aa62b972bef49d9af81eb0
Submitter: Jenkins
Branch:    stable/icehouse

commit f1260cc771ee068651aa62b972bef49d9af81eb0
Author: Zhi Yan Liu &lt;zhiyanl@cn.ibm.com&gt;
Date:   Tue Dec 30 22:25:50 2014 +0800

    Cleanup chunks for deleted image that was 'saving'
    
    Currently image data cannot be removed synchronously for an image that
    is in saving state. And when, the upload operation for such an image is
    completed the operator configured quota can be exceeded.
    This patch fixes the issue of left over chunks for an image which was
    deleted from saving status. However, by the limitation of the design we
    cannot enforce a global quota check for the image in saving status.
    This change introduces a inconsonance between http response codes of
    v1 and v2 APIs. The status codes which we will now see after the upload
    process completes on an image which was deleted mid way are:
    
    v1: 412 Precondition Failed
    v2: 410 Gone
    
    SecurityImpact
    UpgradeImpact
    APIImpact
    
    Closes-Bug: 1383973
    Closes-Bug: 1398830
    Closes-Bug: 1188532
    
    Conflicts:
            glance/api/v1/upload_utils.py
            glance/api/v2/image_data.py
            glance/quota/__init__.py
            glance/tests/unit/test_domain_proxy.py
            glance/tests/unit/test_quota.py
            glance/tests/unit/v1/test_api.py
    
    Signed-off-by: Zhi Yan Liu &lt;zhiyanl@cn.ibm.com&gt;
    (cherry picked from commit 0dc8fbb3479a53c5bba8475d14f4c7206904c5ea)
    
    Change-Id: I47229b366c25367ec1bd48aec684e0880f3dfe60
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2015-01-26 16:18:15 UTC" datetime="2015-01-26T16:18:15.674763+00:00">on 2015-01-26</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Glance image leak when in saving state (CVE-2014-9623)<br />+ [OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2015-01-26 16:26:05 UTC" datetime="2015-01-26T16:26:05.842709+00:00">on 2015-01-26</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2015-02-05 21:56:23 UTC" datetime="2015-02-05T21:56:23.548003+00:00">on 2015-02-05</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2015-04-30 08:14:49 UTC" datetime="2015-04-30T08:14:49.841167+00:00">on 2015-04-30</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        kilo-2 &#8594; 2015.1.0
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/glance/+bug/1398830/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/glance/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/glance/+bug/1398830/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/glance/+bug/1398830/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/glance/+bug/1398830/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/glance/+bug/1398830/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/glance/+bug/1398830/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    
  </ul>
</div>

      <div class="portlet" id="portlet-duplicates">
  <h2>Duplicates of this bug</h2>
  <ul>
    <li>
      <a class="sprite bug" href="https://bugs.launchpad.net/glance/+bug/1188532" title="image download process won't terminate after deleting image from dashboard"> Bug #1188532</a>
    </li>
    <li>
      <a class="sprite bug" href="https://bugs.launchpad.net/glance/+bug/1383973" title="image data cannot be removed when deleting a saving status image"> Bug #1383973</a>
    </li>
  </ul>
</div>

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/glance/+bug/1398830/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/glance/+bug/1398830/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/glance/+bug/1398830/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/glance/+bug/1398830/+attachment/4273529/+files/test_images.py">test_images.py</a>
        <small>
          (<a href="/glance/+bug/1398830/+attachment/4273529">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/glance/+bug/1398830/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"initial_comment_batch_offset": 41, "first visible_recent_comment": -12, "related_features": {}, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1398830", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1398830"}, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1398830", "web_link": "https://bugs.launchpad.net/bugs/1398830", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1398830, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)", "description": "Tushar Patil reported that https://bugs.launchpad.net/glance/+bug/1383973 can be leverage to conduct a denial of service attack on Glance backend store.\n\nThe image in saving state is not taken into account by global quota enforcement.\n\nAttached is a script to reproduce the behavior:\n\n\nSteps to reproduce (tested on file backend store)\n\n  1.  Check how many images are present in the directory that the Filesystem backend store write the image data to (filesystem_store_datadir parameter).\n  2.  Run the program for 1 hour\n  3.  Again count images (step 1), it should be the same as recorded in Step 1.\n\nWe ran this program for 1 hour in our environment.\nBefore running the program, count of images in the file store (/opt/stack/data/glance/images) was 6.\n\nAfter running the program for 1 hr,\n\n  *   Total count of images in the folder /opt/stack/data/glance/images = 806 (it should have been 6)\n  *   Total count of images created = 1014\n  *   Total count of images deleted in saving state = 800\n  *   Total count of images deleted = 1014\n\n\n\nConsidering the bug is already public, fix should be proposed directly on gerrit, this new report will let us work on the impact statement and coordinate the security work in parallel to the public fix being merged.", "owner_link": "https://bugs.launchpad.net/api/devel/~tristan-cacqueray", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/bug_tasks", "duplicate_of_link": null, "date_created": "2014-12-03T14:03:55.782983+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/subscriptions", "date_last_updated": "2015-04-30T08:14:51.367489+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 296, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/attachments", "security_related": true, "latest_patch_uploaded": null, "tags": [], "date_last_message": "2015-01-23T16:45:51.059755+00:00", "number_of_duplicates": 2, "message_count": 29, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/users_unaffected", "users_affected_count_with_dupes": 4, "other_users_affected_count_with_dupes": 4, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398830/linked_merge_proposals", "http_etag": "\"018e64b413a9417759cd5cc95bf1c6b3677ae396-36b3114118eb33c684e5146add7960e5b0097ca9\""}, "bugtask_data": {"1732137": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/glance/juno/+bug/1398830/+delete", "user_can_edit_status": true, "bugtask_path": "/glance/juno/+bug/1398830", "row_id": "tasksummary1732137", "importance_value": "Critical", "importance_widget_items": "[]", "id": 1732137, "user_can_delete": false, "targetname": "Glance juno", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)", "assignee_value": "icordasc", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1732137", "target_is_product": false, "assignee_is_team": false, "status_value": "Fix Committed", "user_can_unassign": false, "milestone_value": null, "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "glance_juno"}, "1732138": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/glance/icehouse/+bug/1398830/+delete", "user_can_edit_status": true, "bugtask_path": "/glance/icehouse/+bug/1398830", "row_id": "tasksummary1732138", "importance_value": "Critical", "importance_widget_items": "[]", "id": 1732138, "user_can_delete": false, "targetname": "Glance icehouse", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)", "assignee_value": "flaper87", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1732138", "target_is_product": false, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/glance/+milestone/2014.1.4", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "glance_icehouse"}, "1726582": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/glance/+bug/1398830/+delete", "user_can_edit_status": true, "bugtask_path": "/glance/+bug/1398830", "row_id": "tasksummary1726582", "importance_value": "High", "importance_widget_items": "[]", "id": 1726582, "user_can_delete": false, "targetname": "Glance", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)", "assignee_value": "lzy-dev", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1726582", "target_is_product": true, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/glance/+milestone/2015.1.0", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "glance"}, "1726583": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ossa/+bug/1398830/+delete", "user_can_edit_status": true, "bugtask_path": "/ossa/+bug/1398830", "row_id": "tasksummary1726583", "importance_value": "High", "importance_widget_items": "[]", "id": 1726583, "user_can_delete": false, "targetname": "OpenStack Security Advisory", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)", "assignee_value": "tristan-cacqueray", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1726583", "target_is_product": true, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": null, "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "ossa"}}, "bug_is_private": false, "context": {"self_link": "https://bugs.launchpad.net/api/devel/glance/+bug/1398830", "web_link": "https://bugs.launchpad.net/glance/+bug/1398830", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1398830", "milestone_link": "https://bugs.launchpad.net/api/devel/glance/+milestone/2015.1.0", "status": "Fix Released", "importance": "High", "assignee_link": "https://bugs.launchpad.net/api/devel/~lzy-dev", "bug_target_display_name": "Glance", "bug_target_name": "glance", "bug_watch_link": null, "date_assigned": "2014-12-30T08:53:55.540471+00:00", "date_created": "2014-12-03T14:03:55.782983+00:00", "date_confirmed": "2014-12-03T16:57:28.663861+00:00", "date_incomplete": null, "date_in_progress": "2014-12-31T08:13:10.372547+00:00", "date_closed": "2015-02-05T21:56:24.493717+00:00", "date_left_new": "2014-12-03T16:57:28.663861+00:00", "date_triaged": "2014-12-31T08:13:10.372547+00:00", "date_fix_committed": "2015-01-17T00:26:32.547956+00:00", "date_fix_released": "2015-02-05T21:56:24.493717+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~tristan-cacqueray", "target_link": "https://bugs.launchpad.net/api/devel/glance", "title": "Bug #1398830 in Glance: \"[OSSA 2015-003] Glance image leak when in saving state (CVE-2014-9623)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/glance/+bug/1398830/related_tasks", "is_complete": true, "http_etag": "\"60dd3a4e30be26400543e1d2d62961c47c66a347-e1e2090faed4c0080dcc7ea40e56fec1b850ecfd\""}, "information_type_data": {"PUBLIC": {"value": "PUBLIC", "is_private": false, "order": 0, "name": "Public", "description": "Everyone can see this information.\n", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"value": "PRIVATESECURITY", "is_private": true, "order": 2, "name": "Private Security", "description": "Only the security group can see this information.\n ", "description_css_class": "choice-description"}, "USERDATA": {"value": "USERDATA", "is_private": true, "order": 3, "name": "Private", "description": "Only shared with users permitted to see private user information.\n", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"value": "PUBLICSECURITY", "is_private": false, "order": 1, "name": "Public Security", "description": "Everyone can see this security related information.\n", "description_css_class": "choice-description"}}, "total_comments_and_activity": 77};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 66 queries/external actions issued in 0.74 seconds

    Features: {'bugs.nominations.bug_supervisors_can_target': 'on', 'hard_timeout': '9000', 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'app.maintenance_message': None, 'js.yui_version': None, 'disclosure.dsp_picker.enabled': 'on', 'profiling.enabled': None, 'baselayout.careers_link.disabled': None}

    r0d8de2b

    -->

</html>

