<!DOCTYPE html><!-- Last Published: Wed Oct 27 2021 16:27:49 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="cryptosense.com" data-wf-page="5fca50710e133c3268a43fb5" data-wf-site="5fb79f97eb305e5f85f6dff6"><head><meta charset="utf-8"/><title>Blog - Weak Encryption Flaw in PrimeFaces</title><meta content="Our Java Crypto Analyzer tool works by tracing calls to the cryptographic library from all parts of the application under test, including libraries, framework components and dependencies.We recently tested the Analyzer on a large web application which uses a whole host of different libraries including PrimeFaces, a popular open-source library for graphics and UI elements in web applications." name="description"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://global-uploads.webflow.com/5fb79f97eb305e5f85f6dff6/css/cryptosense.webflow.8ca2e835f.min.css" rel="stylesheet" type="text/css"/><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Varela:400","Exo:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Raleway:300,regular,500,600,700,800,900:latin,latin-ext","Martel:200,300,regular,800,900"]  }});</script><!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]--><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://global-uploads.webflow.com/5fb79f97eb305e5f85f6dff6/6016ebbffd23365bba1b0145_CS%20favicon_32.png" rel="shortcut icon" type="image/x-icon"/><link href="https://global-uploads.webflow.com/5fb79f97eb305e5f85f6dff6/6016ebc4d3effb651314979a_CS%20favicon_256.png" rel="apple-touch-icon"/><link href="https://cryptosense.com/blog/weak-encryption-flaw-in-primefaces" rel="canonical"/><script src="https://www.google.com/recaptcha/api.js" type="text/javascript"></script><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MFWGJJ5');</script>
<!-- End Google Tag Manager -->

<!--bespoke styling elements-->
<style>
	.w-container {max-width: 1280px;}
	table {border-spacing: 2px;border: 1px solid #e8e8e8;}
  	tr:nth-child(odd) {background-color: #f8f8f8;}
  	tr:nth-child(even) {background-color: #fff;}
  	th {background-color: #e8e8e8;}
  	tr {border-spacing: 2px;border: 1px solid #e8e8e8;}
	th, td {padding: 10px;}  
</style>

<!--Memberstack session duration-->
<script>
  ms_settings = {
  session:  5000 //hours
  }
</script>

<!-- Memberstack --> 
<script src="https://api.memberstack.io/static/memberstack.js?webflow" data-memberstack-id="57018d654b3d7f99b8bbb3bde3ccb1dc"> </script> 

<!--Redirect if JS is disabled (memberstack)-->
<noscript>
   <meta http-equiv="refresh" content="0; url=https://cryptosense.webflow.io/javascript-redirect" />
</noscript>

<!-- Sharethis --> 
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=600b07831f464300110ba930&product=inline-share-buttons" async="async"></script></head><body><div class="w-embed w-iframe w-script"><!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MFWGJJ5"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<!-- adds email address to GTM data layer -->
<script>
MemberStack.onReady.then(function(member) {   
  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({'email': member["email"]});
  window.dataLayer.push({'event': 'memberstack_ready'}); 
})
</script></div><nav id="nav" class="main-sticky-nav"><div data-collapse="medium" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav"><div class="navbar-menu w-container"><a href="/" class="brand w-nav-brand"><img src="https://global-uploads.webflow.com/5fb79f97eb305e5f85f6dff6/5fb7a15497f97810803970a0_CS%20logo_300px.png" alt="Cryptosense logo" height="" class="nav-logo"/></a><nav role="navigation" class="nav-menu w-nav-menu"><a href="/analyzer" class="nav-link w-nav-link">Product</a><div data-hover="true" data-delay="0" class="dropdown w-dropdown"><div class="dropdown-toggle w-dropdown-toggle"><div class="navbar-arrow w-icon-dropdown-toggle"></div><div class="navbar-dropdown">Solutions</div></div><nav class="dropdown-list-navbar w-dropdown-list"><div class="dropdown-flex"><div class="dropdown-menu-column"><div class="dropdown-menu-header">DISCOVERY</div><a href="/analyzer/application-scanning" class="dropdown-link w-dropdown-link">Applications</a><a href="/analyzer/filesystem-scanning" class="dropdown-link w-dropdown-link">Filesystems</a><a href="/analyzer/hardware-fuzzing" class="dropdown-link w-dropdown-link">Hardware</a></div><div class="dropdown-menu-column"><div class="dropdown-menu-header">USE CASES</div><a href="/analyzer/cryptography-inventory" class="dropdown-link w-dropdown-link">Automate Cryptography Inventory</a><a href="/analyzer/cryptography-audit" class="dropdown-link w-dropdown-link">Add Crypto Audit to CI Toolchain</a><a href="/analyzer/fips-application-cryptography-audit" class="dropdown-link w-dropdown-link">FIPS Cryptography Audit</a><a href="/analyzer/cloud-cryptography-adoption" class="dropdown-link w-dropdown-link">Securing Cloud Native Applications</a><a href="/analyzer/pci-dss-compliance" class="dropdown-link w-dropdown-link">Automate PCI-DSS Compliance Audit</a><a href="/analyzer/machine-identity-management" class="dropdown-link w-dropdown-link">Certificate Discovery in DevSecOps</a><a href="/analyzer/pkcs11-security" class="dropdown-link w-dropdown-link">Audit PKCS#11 Devices</a></div></div></nav></div><div data-hover="true" data-delay="0" class="dropdown w-dropdown"><div class="dropdown-toggle w-dropdown-toggle"><div class="navbar-arrow w-icon-dropdown-toggle"></div><div class="navbar-dropdown">Resources</div></div><nav class="dropdown-list-navbar w-dropdown-list"><a href="/webinars" class="dropdown-link w-dropdown-link">Webinars</a><a href="/whitepapers" class="dropdown-link w-dropdown-link">White Papers</a><a href="/datasheets" class="dropdown-link w-dropdown-link">Datasheets</a><a href="/training-courses" class="dropdown-link w-dropdown-link">Training Courses</a><a href="/knowledge-base" class="dropdown-link w-dropdown-link">Knowledge Base</a><a href="/blog" class="dropdown-link w-dropdown-link">Blog</a></nav></div><div data-hover="true" data-delay="0" class="dropdown w-dropdown"><div class="dropdown-toggle w-dropdown-toggle"><div class="navbar-arrow w-icon-dropdown-toggle"></div><div class="navbar-dropdown">Company</div></div><nav class="dropdown-list-navbar w-dropdown-list"><a href="/about" class="dropdown-link w-dropdown-link">About</a><a href="/careers" class="dropdown-link w-dropdown-link">Careers</a><a href="/partners-resellers" class="dropdown-link w-dropdown-link">Partners &amp; Resellers</a><a href="/contact" class="dropdown-link w-dropdown-link">Contact</a></nav></div><a href="https://docs.cryptosense.com/" target="_blank" class="nav-link w-nav-link">Docs</a><a href="/contact" class="navbar-button button w-nav-link">Contact</a></nav><div class="menu-button w-nav-button"><div class="icon w-icon-nav-menu"></div></div></div></div></nav><nav id="nav" class="blog-header-menu"><nav class="menu-dropdown-container w-container"><a href="/blog" class="back-button">&lt;- Back to the blog</a></nav></nav><div class="blog-title-section wf-section"><div class="blog-title-container w-container"><h1 class="blog-title">Weak Encryption Flaw in PrimeFaces</h1><div class="text-block-7">Graham Steel</div><div class="text-block-2">October 20, 2016</div></div></div><div class="blog-content-section wf-section"><div class="w-container"><div class="blog-body w-richtext"><p>Our <a href="/analyzer">Java Cryptography Analyzer</a> tool works by tracing calls to the cryptographic library from all parts of the application under test, including libraries, framework components and dependencies.We recently tested the Analyzer on a large web application which uses a whole host of different libraries including <a href="http://primefaces.org/">PrimeFaces</a>, a <a href="http://www.primefaces.org/whouses">popular</a> open-source library for graphics and UI elements in web applications. One result in particular came from stacktraces leading to that library. It seemed that PrimeFaces was encrypting strings in URLs using a custom scheme based around a password that is set in the configuration file. </p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://global-uploads.webflow.com/5fc10dd0bd65e8aa5f7a27cb/5fc12c5cefab26c7f7cac5aa_Screen-Shot-2016-10-19-at-17.24.01.png" alt="Detecting DES crypto"/></div></figure><p>The Analyzer flagged up multiple problems:</p><ul role="list"><li>Fixed salt in password-based key derivation</li><li>Low iteration count (19) in password-based key derivation</li><li>Weak key derivation algorithm: PBEWithMD5</li><li>Weak encryption algorithm: DES</li><li>Short symmetric key (56 bit)</li><li>Unauthenticated encryption with PKCS5 padding (possible padding oracle)</li></ul><p>The upshot of this is an encryption scheme that could be attacked in multiple ways. The default password (&quot;primefaces&quot;) is likely unchanged in many installations. Even if changed, with the weak password-based key derivation function and fixed salt, a dictionary attack could be mounted. The padding oracle could reveal individual plaintexts. Finally, if all else fails, since the key is fixed for an individual server, it could even be worth brute-force guessing the 56 bit DES key (specialist FPGA hardware can do this in a few hours).</p><p>What would be the consequences of breaking this encryption in a graphics library? While following up on this issue, we discovered that it <a href="https://github.com/primefaces/primefaces/issues/1152">was partially fixed in February 2016</a> after being <a href="http://blog.mindedsecurity.com/2016/02/rce-in-oracle-netbeans-opensource.html">reported by Minded Security</a>. They used the PadBuster tool from our friends at <a href="https://github.com/GDSSecurity/PadBuster">Gotham Digital Science</a> to exploit the padding oracle and break the URL encryption. This allowed them to submit fake URLs which, it turns out, are <a href="https://www.owasp.org/index.php/Expression_Language_Injection">interpreted as Expression Language</a> by the server, leading potentially to remote code execution. PrimeFaces was patched to switch the encrypted URLs for pseudo-random IDs at the price of maintaining a little more state on the server. However, our Analyzer results showed the weak encryption scheme was still being used. Its second usage  is to protect the values of QR codes and barcodes encoded in URLs. We reported this to PrimeTek, and they promptly <a href="https://github.com/primefaces/primefaces/issues/1826">fixed it in version 6.0.6</a>.</p><p>We would advise anyone using to PrimeFaces to ensure they have upgraded at least to version 5.2.21, 5.3.8 or 6.0 (which patches the remote code execution flaw), and preferably to version 6.0.6 (which fixes the QR code and barcode protection issue by removing the weak encryption completely).</p></div><div class="form-block form-block-2 newsletter-blog-post w-form"><h3 class="left">Get Fresh Cryptography News In Your Inbox Every Month</h3><div class="left">We&#x27;ll send you monthly updates on cryptography and data protection. <br/>‍<a href="/newsletters">Read previous newsletters</a>.</div><form id="wf-form-Newsletter-Form" name="wf-form-Newsletter-Form" data-name="Newsletter Form" class="blog-post-signup-form"><label for="Name-3" class="form-field-label">Name</label><input type="text" class="form-text-field---underline w-input" maxlength="256" name="Name-2" data-name="Name 2" placeholder="Annie Smith" id="Name-2" required=""/><label for="Email-3" class="form-field-label">Email Address</label><input type="email" class="form-text-field---underline w-input" maxlength="256" name="Email-2" data-name="Email 2" placeholder="annie@example.com" id="Email-2" required=""/><div class="form-buttons-vertical"><div data-sitekey="6LeGRkQaAAAAAMKQBfFOUPRK-wogC0zC15c2jY5M" class="w-form-formrecaptcha g-recaptcha g-recaptcha-error g-recaptcha-disabled"></div><input type="submit" value="Get the Newsletter" data-wait="Please wait..." class="form-submit-button w-button"/></div></form><div class="success-message w-form-done"><h3 class="heading-12">Success!</h3><div>You&#x27;re on the list to receive cryptography news in your inbox every month.</div></div><div class="w-form-fail"><div>Oops! Something went wrong while submitting the form.</div></div></div></div></div><div class="more-articles-section wf-section"><div class="w-container"><h2>Further Reading</h2><div class="w-dyn-list"><div role="list" class="more-articles-list w-dyn-items w-row"><div role="listitem" class="more-articles w-dyn-item w-col w-col-3"><a href="/blog/what-is-cryptography-lifecycle-management-and-why-do-i-need-it" class="more-articles-link w-inline-block"><div class="more-articles-title-div"><h3 class="more-articles-title">What is Cryptography Lifecycle Management and Why do I need it?</h3><div class="more-articles-author">Sam Ross-Gower</div></div><p class="more-articles-description">Cryptography is an essential enabling technology for modern business: without it we would not be able to protect our sensitive data or carry out authentication. When perfectly implemented and maintained, cryptography provides security we can rely on. However, detailed errors in its usage can lead to total loss of protection, and our increasing reliance on cryptography means that these mistakes now carry significant financial and reputational risks.</p><div class="more-articles-cta">READ ARTICLE -&gt;</div></a></div><div role="listitem" class="more-articles w-dyn-item w-col w-col-3"><a href="/blog/when-certificates-attack-shadow-certificates" class="more-articles-link w-inline-block"><div class="more-articles-title-div"><h3 class="more-articles-title">When Certificates Attack: Shadow Certificates</h3><div class="more-articles-author">Jarred McGinnis</div></div><p class="more-articles-description">Shadow certificates are more likely than you think. It is as if the nails and screws used to build a house end up being what makes the house fall down. Briefly, shadow certificates refer to digital certificates that have been introduced by employees that the DevOps or SecOps teams are unaware of. </p><div class="more-articles-cta">READ ARTICLE -&gt;</div></a></div><div role="listitem" class="more-articles w-dyn-item w-col w-col-3"><a href="/blog/is-triple-des-secure" class="more-articles-link w-inline-block"><div class="more-articles-title-div"><h3 class="more-articles-title">Is Triple DES Secure?</h3><div class="more-articles-author">Jarred McGinnis</div></div><p class="more-articles-description">The short answer with supporting evidence is no, because it has been deprecated by the NIST since 2017 for new applications and for all applications by 2023. </p><div class="more-articles-cta">READ ARTICLE -&gt;</div></a></div><div role="listitem" class="more-articles w-dyn-item w-col w-col-3"><a href="/blog/the-zoom-encryption-protocol-why-ecb-is-bad" class="more-articles-link w-inline-block"><div class="more-articles-title-div"><h3 class="more-articles-title">The Zoom Encryption Protocol - Why ECB Is Bad</h3><div class="more-articles-author">Sam Ross-Gower</div></div><p class="more-articles-description">If you use Zoom video-conferencing software, you probably be aware of the recent controversy about the security of their encryption protocols...</p><div class="more-articles-cta">READ ARTICLE -&gt;</div></a></div></div></div></div></div><footer id="footer" class="main-footer wf-section"><div class="w-container"><div class="footer-flex-container"><a href="/" class="footer-logo-link w-inline-block"><img src="https://global-uploads.webflow.com/5fb79f97eb305e5f85f6dff6/5fb7a15497f97810803970a0_CS%20logo_300px.png" loading="lazy" height="30" alt="Cryptosense Logo" class="footer-logo"/></a><div class="footer-menu-links"><h2 class="footer-heading">Solutions</h2><ul role="list" class="w-list-unstyled"><li><a href="/analyzer/fips-application-cryptography-audit" class="footer-link">FIPS Compliance Audit</a><a href="/analyzer/cryptography-inventory" class="footer-link">Post-Quantum Readiness</a><a href="/analyzer/cloud-cryptography-adoption" class="footer-link">Cloud Cryptography</a></li><li><a href="/analyzer/cryptography-inventory" class="footer-link">Cryptography Inventory</a></li><li><a href="/analyzer/cryptography-audit" class="footer-link">Cryptography Audit in CI/CD</a></li><li><a href="/analyzer/pkcs11-security" class="footer-link">PKCS#11 Fuzzing</a></li></ul></div><div class="footer-menu-links"><h2 class="footer-heading">Resources</h2><ul role="list" class="w-list-unstyled"><li><a href="/webinars" class="footer-link">On-Demand Webinars</a></li><li><a href="/whitepapers" class="footer-link">White Papers</a></li><li><a href="/datasheets" class="footer-link">Data Sheets</a></li><li><a href="/blog" class="footer-link">Blog</a></li><li><a href="/knowledge-base" class="footer-link">Knowledge Base</a><a href="https://docs.cryptosense.com/" class="footer-link">Docs</a></li></ul></div><div class="footer-menu-links"><h2 class="footer-heading">Company</h2><ul role="list" class="w-list-unstyled"><li><a href="/about" class="footer-link">About Us</a></li><li><a href="/careers" class="footer-link">Careers</a></li><li><a href="/partners-resellers" class="footer-link">Partners &amp; Resellers</a></li><li><a href="/contact" class="footer-link">Contact</a></li></ul></div></div></div><div class="member-footer-login"><a href="https://analyzer.cryptosense.com/" target="_blank" class="button login w-button">LOGIN TO CRYPTOSENSE ANALYZER</a></div><div class="copyright-notice">Copyright © 2013-2021 Cryptosense SA. All rights reserved.</div></footer><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=5fb79f97eb305e5f85f6dff6" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://global-uploads.webflow.com/5fb79f97eb305e5f85f6dff6/js/webflow.5ac626c14.js" type="text/javascript"></script><!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]--><!-- Active Campaign + Memberstack --> 
<script type="text/javascript">
MemberStack.onReady.then(function(member) {   
    (function(e,t,o,n,p,r,i){e.visitorGlobalObjectAlias=n;e[e.visitorGlobalObjectAlias]=e[e.visitorGlobalObjectAlias]||function(){(e[e.visitorGlobalObjectAlias].q=e[e.visitorGlobalObjectAlias].q||[]).push(arguments)};e[e.visitorGlobalObjectAlias].l=(new Date).getTime();r=t.createElement("script");r.src=o;r.async=true;i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)})(window,document,"https://diffuser-cdn.app-us1.com/diffuser/diffuser.js","vgo");
    vgo('setAccount', '251945139');
    vgo('setTrackByDefault', true);
    vgo('setEmail', member["email"]);
    vgo('process');
    })
</script></body></html>

