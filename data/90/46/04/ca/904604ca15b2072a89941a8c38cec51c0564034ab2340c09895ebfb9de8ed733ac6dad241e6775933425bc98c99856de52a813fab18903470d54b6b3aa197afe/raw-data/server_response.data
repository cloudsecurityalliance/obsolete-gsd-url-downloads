<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/nova/+bug/1251590/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1251590 “[OSSA 2014-003] Live migration can leak root disk ...” : Bugs : OpenStack Compute (nova)</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1251590" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1251590/bug.atom" title="Bug 1251590 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="During pre-live-migration required disks are created along with their backing files (if they don't already exist). However, the ephemeral backing file is created from a glance downloaded root disk.

# If the required ephemeral backing file is present then there's no issue.

# If the required ephemeral backing file is not already present, then the root disk is downloaded and saved as the ephemeral backing file. This will result in the following situations:

## The disk.local transferred during..." />
      <meta property="og:description" content="During pre-live-migration required disks are created along with their backing files (if they don't already exist). However, the ephemeral backing file is created from a glance downloaded root disk.

# If the required ephemeral backing file is present then there's no issue.

# If the required ephemeral backing file is not already present, then the root disk is downloaded and saved as the ephemeral backing file. This will result in the following situations:

## The disk.local transferred during..." />
    

    
    
      <meta property="og:title" content="Bug #1251590 “[OSSA 2014-003] Live migration can leak root disk ...” : Bugs : OpenStack Compute (nova)" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1251590" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["api", "api-ref", "availability-zones", "cells", "ceph", "cinder", "compute", "conductor", "config", "console", "cyborg", "db", "doc", "ec2", "evacuate", "fault-injection", "gate-failure", "glance", "hyper-v", "i18n", "image-cache", "in-stable-liberty", "in-stable-newton", "in-stable-ocata", "ironic", "kilo-backport-potential", "liberty-backport-potential", "libvirt", "live-migration", "low-hanging-fruit", "lxc", "metadata", "mitaka-backport-potential", "needs-attention", "needs-functional-test", "needs.openstack-version", "network", "neutron", "newton-backport-potential", "nfs", "notifications", "nova-manage", "nova-network", "numa", "ocata-backport-potential", "openstack-version.grizzly", "openstack-version.havana", "openstack-version.icehouse", "openstack-version.juno", "openstack-version.kilo", "openstack-version.liberty", "openstack-version.mitaka", "openstack-version.newton", "openstack-version.ocata", "openstack-version.pike", "ops", "oslo", "pci", "performance", "pike-backport-potential", "placement", "policy", "postgresql", "powervm", "privsep", "queens-backport-potential", "quotas", "race-condition", "reboot", "rebuild", "rescue", "resize", "resource-tracker", "rootwrap", "s390x", "scheduler", "security", "security-groups", "serviceability", "shared-storage", "shelve", "snapshot", "stacktrace", "stein-rc-potential", "testing", "train-rc-potential", "unified-objects", "upgrade", "ussuri-backport-potential", "ussuri-rc-potential", "vgpu", "victoria-rc-potential", "vmware", "volumes", "wallaby-rc-potential", "xen", "xena-rc-potential", "xenserver", "zvm"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/nova/+bug/1251590/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/nova"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/324577028/nova64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/nova">OpenStack Compute (nova)</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/nova">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/nova">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/nova">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/nova">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/nova">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/nova">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1251590 reported by
      <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan</a>
      <time title="2013-11-15 11:09:28 UTC" datetime="2013-11-15T11:09:28.840231+00:00">on 2013-11-15</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">276</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1500821">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/nova/+bug/1251590/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1500821">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/nova">OpenStack Compute (nova)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/nova/+bug/1251590/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/nova/+bug/1251590/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1500821">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ndipanov">Nikola Đipanov</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/nova/+milestone/2014.1">OpenStack Compute (nova) 2014.1 "icehouse"</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1500821">
     <td colspan="7"><form action="/nova/+bug/1251590/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/nova">OpenStack Compute (nova)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-11-15 11:09:28 UTC" datetime="2013-11-15T11:09:28.840231+00:00">2013-11-15</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-11-27 11:04:07 UTC" datetime="2013-11-27T11:04:07.922928+00:00">2013-11-27</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-01-28 00:03:33 UTC" datetime="2014-01-28T00:03:33.568748+00:00">2014-01-28</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-12-16 05:01:17 UTC" datetime="2013-12-16T05:01:17.619837+00:00">2013-12-16</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-03-05 13:07:46 UTC" datetime="2014-03-05T13:07:46.837180+00:00">2014-03-05</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="nova.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="nova.target.option.package" name="nova.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="nova.target.distribution" name="nova.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="nova.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="nova.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="nova.target.package"
                         name="nova.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;nova.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('nova.target.package');
              var select_menu = Y.DOM.byId('nova.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-nova-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": null, "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "nova.target.package", "show_widget_id": "show-widget-nova-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-nova-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="nova.target.option.product" name="nova.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="nova" id="nova.target.product"
                         name="nova.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;nova.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('nova.target.product');
              var select_menu = Y.DOM.byId('nova.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-nova-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": "nova", "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "nova.target.product", "show_widget_id": "show-widget-nova-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-nova-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="nova.status" name="nova.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="nova.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Compute (nova) 2014.1
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="nova.assignee.assign_to_me" name="nova.assignee.option" value="nova.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="nova.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="nova.assignee.assigned_to" name="nova.assignee.option" value="nova.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="nova.assignee.assigned_to">
              Nikola Đipanov (ndipanov)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="nova.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="nova.comment_on_change" name="nova.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1523146">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/nova/grizzly/+bug/1251590/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/nova/grizzly">Grizzly</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/nova/grizzly/+bug/1251590/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/nova/grizzly/+bug/1251590/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1523146">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ndipanov">Nikola Đipanov</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/nova/+milestone/2013.1.5">OpenStack Compute (nova) 2013.1.5</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1523146">
     <td colspan="7"><form action="/nova/grizzly/+bug/1251590/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/nova/grizzly">OpenStack Compute (nova) grizzly</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-01-06 13:25:51 UTC" datetime="2014-01-06T13:25:51.776442+00:00">2014-01-06</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-01-06 13:26:02 UTC" datetime="2014-01-06T13:26:02.534078+00:00">2014-01-06</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-01-28 00:03:43 UTC" datetime="2014-01-28T00:03:43.813973+00:00">2014-01-28</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-01-27 11:00:39 UTC" datetime="2014-01-27T11:00:39.629428+00:00">2014-01-27</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-03-20 22:11:07 UTC" datetime="2014-03-20T22:11:07.933814+00:00">2014-03-20</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova_grizzly.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova_grizzly.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova_grizzly.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="nova_grizzly.status" name="nova_grizzly.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="nova_grizzly.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Compute (nova) 2013.1.5
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova_grizzly.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="nova_grizzly.assignee.assign_to_me" name="nova_grizzly.assignee.option" value="nova_grizzly.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="nova_grizzly.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="nova_grizzly.assignee.assigned_to" name="nova_grizzly.assignee.option" value="nova_grizzly.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="nova_grizzly.assignee.assigned_to">
              Nikola Đipanov (ndipanov)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="nova_grizzly.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="nova_grizzly.comment_on_change" name="nova_grizzly.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1523147">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/nova/havana/+bug/1251590/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/nova/havana">Havana</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/nova/havana/+bug/1251590/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/nova/havana/+bug/1251590/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1523147">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ndipanov">Nikola Đipanov</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/nova/+milestone/2013.2.2">OpenStack Compute (nova) 2013.2.2</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1523147">
     <td colspan="7"><form action="/nova/havana/+bug/1251590/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/nova/havana">OpenStack Compute (nova) havana</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-01-06 13:25:51 UTC" datetime="2014-01-06T13:25:51.776442+00:00">2014-01-06</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-01-06 13:25:59 UTC" datetime="2014-01-06T13:25:59.497070+00:00">2014-01-06</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-01-28 00:03:52 UTC" datetime="2014-01-28T00:03:52.885410+00:00">2014-01-28</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-01-06 13:25:59 UTC" datetime="2014-01-06T13:25:59.497070+00:00">2014-01-06</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-02-13 19:18:04 UTC" datetime="2014-02-13T19:18:04.666694+00:00">2014-02-13</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova_havana.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova_havana.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova_havana.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="nova_havana.status" name="nova_havana.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="nova_havana.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Compute (nova) 2013.2.2
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova_havana.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="nova_havana.assignee.assign_to_me" name="nova_havana.assignee.option" value="nova_havana.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="nova_havana.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="nova_havana.assignee.assigned_to" name="nova_havana.assignee.option" value="nova_havana.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="nova_havana.assignee.assigned_to">
              Nikola Đipanov (ndipanov)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="nova_havana.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="nova_havana.comment_on_change" name="nova_havana.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1500932">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1251590/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1500932">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1251590/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1251590/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1500932">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~gmurphy">Grant Murphy</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1500932">
     <td colspan="7"><form action="/ossa/+bug/1251590/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-11-15 16:24:25 UTC" datetime="2013-11-15T16:24:25.826122+00:00">2013-11-15</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-11-15 16:28:52 UTC" datetime="2013-11-15T16:28:52.081438+00:00">2013-11-15</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2013-12-12 00:40:53 UTC" datetime="2013-12-12T00:40:53.981658+00:00">2013-12-12</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-12-16 16:48:32 UTC" datetime="2013-12-16T16:48:32.765058+00:00">2013-12-16</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-01-30 17:18:21 UTC" datetime="2014-01-30T17:18:21.857356+00:00">2014-01-30</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": null, "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "ossa.target.package", "show_widget_id": "show-widget-ossa-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": "ossa", "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "ossa.target.product", "show_widget_id": "show-widget-ossa-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Grant Murphy (gmurphy)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/nova/+bug/1251590/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/nova/+bug/1251590/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/nova/+bug/1251590/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>During pre-live-migration required disks are created along with their backing files (if they don&#x27;t already exist). However, the ephemeral backing file is created from a glance downloaded root disk.</p>
<p># If the required ephemeral backing file is present then there&#x27;s no issue.</p>
<p># If the required ephemeral backing file is not already present, then the root disk is downloaded and saved as the ephemeral backing file. This will result in the following situations:</p>
<p>## The disk.local transferred during live-migration will be rebased on the ephemeral backing file so regardless of the content, the end result will be identical to the source disk.local.<br />
## However, if a new instance of the same flavor is spawned on this compute node, then it will have an ephemeral storage that exposes a root disk.</p>
<p>Security concerns:</p>
<p>If the migrated VM was spawned off a snapshot, now it&#x27;s possible for any instances of the correct flavor to see the snapshot contents of another user via the ephemeral storage.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          <span>See <a href="comments/0">original description</a></span>
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2013-7130" title="The i_create_images_and_backing (aka ...">2013-7130</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
    
    <time title="2013-11-15 11:13:12 UTC" datetime="2013-11-15T11:13:12.892368+00:00">on 2013-11-15</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
    
    <time title="2013-11-15 15:35:06 UTC" datetime="2013-11-15T15:35:06.393168+00:00">on 2013-11-15</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-15T16:13:58.372613+00:00" title="2013-11-15 16:13:58 UTC">on 2013-11-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>One possible solution that seems to work:</p>
<p>diff --git a/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py b/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
index bb3c312..68f68e6 100644<br />
--- a/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
+++ b/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
@@ -4290,13 +4290,22 @@ class LibvirtDriver(<wbr />driver.<wbr />ComputeDriver)<wbr />:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;image = self.image_<wbr />backend.<wbr />image(instance,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;instance_<wbr />disk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;CONF.libvirt_<wbr />images_<wbr />type)<br />
-                image.cache(<wbr />fetch_func=<wbr />libvirt_<wbr />utils.fetch_<wbr />image,<br />
-                            context=context,<br />
-                            filename=<wbr />cache_name,<br />
-                            image_id=<wbr />instance[<wbr />&#x27;image_<wbr />ref&#x27;],<br />
-                            user_id=<wbr />instance[<wbr />&#x27;user_id&#x27;<wbr />],<br />
-                            project_<wbr />id=instance[<wbr />&#x27;project_<wbr />id&#x27;],<br />
-                            size=info[<wbr />&#x27;virt_disk_<wbr />size&#x27;])<br />
+<br />
+                if cache_name.<wbr />startswith(<wbr />&#x27;ephemeral&#x27;<wbr />):<br />
+                    image.cache(<wbr />fetch_func=<wbr />self._create_<wbr />ephemeral,<br />
+                                fs_label=<wbr />&#x27;ephemeral0&#x27;<wbr />,<br />
+                                os_type=<wbr />instance[<wbr />&quot;os_type&quot;<wbr />],<br />
+                                filename=<wbr />cache_name,<br />
+                                size=info[<wbr />&#x27;virt_disk_<wbr />size&#x27;],<br />
+                                ephemeral_<wbr />size=instance[<wbr />&#x27;ephemeral_<wbr />gb&#x27;])<br />
+                else:<br />
+                    image.cache(<wbr />fetch_func=<wbr />libvirt_<wbr />utils.fetch_<wbr />image,<br />
+                                context=context,<br />
+                                filename=<wbr />cache_name,<br />
+                                image_id=<wbr />instance[<wbr />&#x27;image_<wbr />ref&#x27;],<br />
+                                user_id=<wbr />instance[<wbr />&#x27;user_id&#x27;<wbr />],<br />
+                                project_<wbr />id=instance[<wbr />&#x27;project_<wbr />id&#x27;],<br />
+                                size=info[<wbr />&#x27;virt_disk_<wbr />size&#x27;])</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">One possible solution that seems to work:

diff --git a/nova/virt/libvirt/driver.py b/nova/virt/libvirt/driver.py
index bb3c312..68f68e6 100644
--- a/nova/virt/libvirt/driver.py
+++ b/nova/virt/libvirt/driver.py
@@ -4290,13 +4290,22 @@ class LibvirtDriver(driver.ComputeDriver):
                 image = self.image_backend.image(instance,
                                                  instance_disk,
                                                  CONF.libvirt_images_type)
-                image.cache(fetch_func=libvirt_utils.fetch_image,
-                            context=context,
-                            filename=cache_name,
-                            image_id=instance['image_ref'],
-                            user_id=instance['user_id'],
-                            project_id=instance['project_id'],
-                            size=info['virt_disk_size'])
+
+                if cache_name.startswith('ephemeral'):
+                    image.cache(fetch_func=self._create_ephemeral,
+                                fs_label='ephemeral0',
+                                os_type=instance["os_type"],
+                                filename=cache_name,
+                                size=info['virt_disk_size'],
+                                ephemeral_size=instance['ephemeral_gb'])
+                else:
+                    image.cache(fetch_func=libvirt_utils.fetch_image,
+                                context=context,
+                                filename=cache_name,
+                                image_id=instance['image_ref'],
+                                user_id=instance['user_id'],
+                                project_id=instance['project_id'],
+                                size=info['virt_disk_size'])
 
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-15T16:27:41.725206+00:00" title="2013-11-15 16:27:41 UTC">on 2013-11-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This sounds fairly serious to me at first pass. Any idea which releases are affected?</p>
<p>Nova security reviewers, any input on the proposed patch above?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This sounds fairly serious to me at first pass. Any idea which releases are affected?

Nova security reviewers, any input on the proposed patch above?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alaski" class="sprite person">Andrew Laski (alaski)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-15T19:41:31.700808+00:00" title="2013-11-15 19:41:31 UTC">on 2013-11-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The fix seems sane to me, but I am not familiar with libvirt so I would like to see someone more knowledgeable confirm.  It just appears that root disks won&#x27;t be downloaded for ephemeral backing files, and empty images will be created.</p>
<p>But this fix does seem to just address instances migrated after the patch, is there anyway to retroactively address this in cases that a root disk has already been downloaded?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The fix seems sane to me, but I am not familiar with libvirt so I would like to see someone more knowledgeable confirm.  It just appears that root disks won't be downloaded for ephemeral backing files, and empty images will be created.

But this fix does seem to just address instances migrated after the patch, is there anyway to retroactively address this in cases that a root disk has already been downloaded?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-16T01:44:59.899349+00:00" title="2013-11-16 01:44:59 UTC">on 2013-11-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The following is suitable for deployments where it&#x27;s possible to just put together a script and execute.</p>
<p>1. Delete all ephemeral backing files not currently being referred to by a disk.local cow layer. It&#x27;s better to delete all such unused ephemeral files since step 2 below can be unreliable.<br />
2. Identify the ephemeral files that are root disk images. This is quite straightforward if all the root disks have a partition table and all we do is look at the file signature to determine if there&#x27;s a partitionless image with ext3 fs on it. But on a system with user uploaded glance files or where there are single partition root disks with kernel, there could be several false negatives. Anyway, assuming we managed to determine if a compute node has a bad ephemeral backing file then we should first disable the service to prevent any more instance scheduling on that node.<br />
3. Then we could isolate all the VMs using the bad ephemeral file(s) to a set of fresh nodes using live-migration and delete the now unused bad ephemeral files and enable scheduling again.</p>
<p>If one doesn&#x27;t want to take the chance with step 2 above, a more deterministic approach would be to migrate all the VMs at least once to a node known to contain none or new correct ephemeral disks.</p>
<p>What this gives us is that all ephemeral backing files will be corrected and new instances will see the expected block device with an ext3 fs. All existing VMs will continue to run including those that had already seen the exposed data. However, they all would be backed on good ephemeral backing files.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The following is suitable for deployments where it's possible to just put together a script and execute.

1. Delete all ephemeral backing files not currently being referred to by a disk.local cow layer. It's better to delete all such unused ephemeral files since step 2 below can be unreliable.
2. Identify the ephemeral files that are root disk images. This is quite straightforward if all the root disks have a partition table and all we do is look at the file signature to determine if there's a partitionless image with ext3 fs on it. But on a system with user uploaded glance files or where there are single partition root disks with kernel, there could be several false negatives. Anyway, assuming we managed to determine if a compute node has a bad ephemeral backing file then we should first disable the service to prevent any more instance scheduling on that node.
3. Then we could isolate all the VMs using the bad ephemeral file(s) to a set of fresh nodes using live-migration and delete the now unused bad ephemeral files and enable scheduling again.

If one doesn't want to take the chance with step 2 above, a more deterministic approach would be to migrate all the VMs at least once to a node known to contain none or new correct ephemeral disks.

What this gives us is that all ephemeral backing files will be corrected and new instances will see the expected block device with an ext3 fs. All existing VMs will continue to run including those that had already seen the exposed data. However, they all would be backed on good ephemeral backing files.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-18T09:36:13.069149+00:00" title="2013-11-18 09:36:13 UTC">on 2013-11-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So IIUC the issue can only happen when the block migration is used, as this code path is only hit if there is no shared storage - this is a limited use case, and the bug does not affect all live migration setups. I am saying this just for clarity - we should definitely fix the issue asap.</p>
<p>The fix looks like a good start, however I think that we should special-case the swap as well. For inspiration see nova.virt.<wbr />libvirt.<wbr />driver _create_image method that does these things on instance boot.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So IIUC the issue can only happen when the block migration is used, as this code path is only hit if there is no shared storage - this is a limited use case, and the bug does not affect all live migration setups. I am saying this just for clarity - we should definitely fix the issue asap.

The fix looks like a good start, however I think that we should special-case the swap as well. For inspiration see nova.virt.libvirt.driver _create_image method that does these things on instance boot.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-11-27 11:04:07 UTC" datetime="2013-11-27T11:04:07.626984+00:00">on 2013-11-27</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-27T14:17:05.531210+00:00" title="2013-11-27 14:17:05 UTC">on 2013-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>{code}<br />
diff --git a/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py b/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
index 440fe72..db7c6e6 100644<br />
--- a/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
+++ b/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
@@ -4381,7 +4381,22 @@ class LibvirtDriver(<wbr />driver.<wbr />ComputeDriver)<wbr />:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;image = self.image_<wbr />backend.<wbr />image(instance,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;instance_<wbr />disk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;CONF.libvirt.<wbr />images_<wbr />type)<br />
-                image.cache(<wbr />fetch_func=<wbr />libvirt_<wbr />utils.fetch_<wbr />image,<br />
+                if cache_name.<wbr />startswith(<wbr />&#x27;ephemeral&#x27;<wbr />):<br />
+                     image.cache(<wbr />fetch_func=<wbr />self._create_<wbr />ephemeral,<br />
+                                 fs_label=<wbr />&#x27;ephemeral0&#x27;<wbr />,<br />
+                                 os_type=<wbr />instance[<wbr />&quot;os_type&quot;<wbr />],<br />
+                                 filename=<wbr />cache_name,<br />
+                                 size=info[<wbr />&#x27;virt_disk_<wbr />size&#x27;],<br />
+                                 ephemeral_<wbr />size=instance[<wbr />&#x27;ephemeral_<wbr />gb&#x27;])<br />
+                elif cache_name.<wbr />startswith(<wbr />&#x27;swap&#x27;)<wbr />:<br />
+                    inst_type = flavors.<wbr />extract_<wbr />flavor(<wbr />instance)<br />
+                    swap_mb = inst_type[&#x27;swap&#x27;]<br />
+                    image.cache(<wbr />fetch_func=<wbr />self._create_<wbr />swap,<br />
+                                 filename=&quot;swap_%s&quot; % swap_mb,<br />
+                                 size=info[<wbr />&#x27;virt_disk_<wbr />size&#x27;],<br />
+                                 swap_mb=swap_mb)<br />
+                else:<br />
+                    image.cache(<wbr />fetch_func=<wbr />libvirt_<wbr />utils.fetch_<wbr />image,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;context=<wbr />context,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;filename=<wbr />cache_name,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;image_<wbr />id=instance[<wbr />&#x27;image_<wbr />ref&#x27;],<br />
{code}</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">{code}
diff --git a/nova/virt/libvirt/driver.py b/nova/virt/libvirt/driver.py
index 440fe72..db7c6e6 100644
--- a/nova/virt/libvirt/driver.py
+++ b/nova/virt/libvirt/driver.py
@@ -4381,7 +4381,22 @@ class LibvirtDriver(driver.ComputeDriver):
                 image = self.image_backend.image(instance,
                                                  instance_disk,
                                                  CONF.libvirt.images_type)
-                image.cache(fetch_func=libvirt_utils.fetch_image,
+                if cache_name.startswith('ephemeral'):
+                     image.cache(fetch_func=self._create_ephemeral,
+                                 fs_label='ephemeral0',
+                                 os_type=instance["os_type"],
+                                 filename=cache_name,
+                                 size=info['virt_disk_size'],
+                                 ephemeral_size=instance['ephemeral_gb'])
+                elif cache_name.startswith('swap'):
+                    inst_type = flavors.extract_flavor(instance)
+                    swap_mb = inst_type['swap']
+                    image.cache(fetch_func=self._create_swap,
+                                 filename="swap_%s" % swap_mb,
+                                 size=info['virt_disk_size'],
+                                 swap_mb=swap_mb)
+                else:
+                    image.cache(fetch_func=libvirt_utils.fetch_image,
                             context=context,
                             filename=cache_name,
                             image_id=instance['image_ref'],
{code}</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-27T15:17:58.698689+00:00" title="2013-11-27 15:17:58 UTC">on 2013-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ok so this looks much better now. Launchpad is horrible for commenting on patches, but several issues with ephemerals that I can see:<br />
&nbsp;&nbsp;+ fs_label=<wbr />&#x27;ephemeral0&#x27;<wbr />,<br />
This should be cache_name since there can be more than one ephemeral disk<br />
&nbsp;&nbsp;+ ephemeral_<wbr />size=instance[<wbr />&#x27;ephemeral_<wbr />gb&#x27;])<br />
This is not always true - we are able to specify the size of ephemerals too through block device mapping. This is tricky since we don&#x27;t have that info in the xml. I am not sure how to handle this - I need to look into this a bit more.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ok so this looks much better now. Launchpad is horrible for commenting on patches, but several issues with ephemerals that I can see:
  + fs_label='ephemeral0',
This should be cache_name since there can be more than one ephemeral disk
  + ephemeral_size=instance['ephemeral_gb'])
This is not always true - we are able to specify the size of ephemerals too through block device mapping. This is tricky since we don't have that info in the xml. I am not sure how to handle this - I need to look into this a bit more.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-27T15:47:42.441411+00:00" title="2013-11-27 15:47:42 UTC">on 2013-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Having the correct size on an ephemeral backing file is important IMHO only on new instance spawning, since it may expects a filesystem with the size promised by the flavor. During migration it&#x27;s going to be rebased anyway with the existing information from the qcow2 layer.</p>
<p>So to understand the second issue a bit more, are we going to have a backing file of some name ephemeral_<wbr />SIZE_OS_<wbr />TYPE but not of size SIZE?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Having the correct size on an ephemeral backing file is important IMHO only on new instance spawning, since it may expects a filesystem with the size promised by the flavor. During migration it's going to be rebased anyway with the existing information from the qcow2 layer.

So to understand the second issue a bit more, are we going to have a backing file of some name ephemeral_SIZE_OS_TYPE but not of size SIZE?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-27T16:07:21.044627+00:00" title="2013-11-27 16:07:21 UTC">on 2013-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hey, so - agreed on the size point. The fs_label should be ephemeral0, ephemeral1 etc. Not a huge deal imho.</p>
<p>Consider the patch +2 from my side.</p>
<p>And a huge thank you for fixing this so quickly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hey, so - agreed on the size point. The fs_label should be ephemeral0, ephemeral1 etc. Not a huge deal imho. 

Consider the patch +2 from my side.

And a huge thank you for fixing this so quickly.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-27T16:37:40.961293+00:00" title="2013-11-27 16:37:40 UTC">on 2013-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;ll try to fix the fs_label now. Could you please take a look at the swap handling?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'll try to fix the fs_label now. Could you please take a look at the swap handling?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-27T16:56:11.232181+00:00" title="2013-11-27 16:56:11 UTC">on 2013-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m a bit confused on the multiple ephemeral disk code. It appears that regardless of the number of disks created, the backing file is the same. ie fname = &quot;ephemeral_%s_%s&quot; % (eph[&#x27;size&#x27;], os_type_<wbr />with_default) is not dependent on idx. So I&#x27;m wondering if only ephemeral0 will be used in the backing file and the rest used in the qcow2 layers. If that&#x27;s the case we hardcoding &#x27;ephemeral0&#x27; for fs_label won&#x27;t break anything.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm a bit confused on the multiple ephemeral disk code. It appears that regardless of the number of disks created, the backing file is the same. ie fname = "ephemeral_%s_%s" % (eph['size'], os_type_with_default) is not dependent on idx. So I'm wondering if only ephemeral0 will be used in the backing file and the rest used in the qcow2 layers. If that's the case we hardcoding 'ephemeral0' for fs_label won't break anything.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-29T01:20:15.720190+00:00" title="2013-11-29 01:20:15 UTC">on 2013-11-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So can we use the patch in <a rel="nofollow" href="https://bugs.launchpad.net/nova/+bug/1251590/comments/6">https:/<wbr />/bugs.launchpad<wbr />.net/nova/<wbr />+bug/1251590/<wbr />comments/<wbr />6</a> and move this bug along? Let me know if I need to do anything further on this. Thanks.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So can we use the patch in https://bugs.launchpad.net/nova/+bug/1251590/comments/6 and move this bug along? Let me know if I need to do anything further on this. Thanks.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tom-hancock" class="sprite person">Tom Hancock (tom-hancock)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-11-29T10:18:42.830233+00:00" title="2013-11-29 10:18:42 UTC">on 2013-11-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Maybe I misread, but,<br />
&nbsp;&nbsp;&nbsp;&nbsp;size=<wbr />info[&#x27;virt_<wbr />disk_size&#x27;<wbr />],<br />
for swap should it be<br />
&nbsp;&nbsp;&nbsp;&nbsp;size = swap_mb * unit.Mi<br />
based on code further down the file?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Maybe I misread, but,
    size=info['virt_disk_size'],
for swap should it be 
    size = swap_mb * unit.Mi
based on code further down the file?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-03T18:15:05.549651+00:00" title="2013-12-03 18:15:05 UTC">on 2013-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt;I&#x27;m a bit confused on the multiple ephemeral disk code. It appears that regardless of the number of disks created, the backing file is the same. ie fname = &quot;ephemeral_%s_%s&quot; % (eph[&#x27;size&#x27;], os_type_<wbr />with_default) is not dependent on idx. So I&#x27;m wondering if only ephemeral0 will be used in the backing file and the rest used in the qcow2 layers. If that&#x27;s the case we hardcoding &#x27;ephemeral0&#x27; for fs_label won&#x27;t break anything.
</span></p>
<p>so - we go back to the size issue - each ephemeral drive will have a backing file (assuming qcow Images are used by Nova) that is named<br />
&nbsp;&nbsp;fname = &quot;ephemeral_%s_%s&quot; % (eph[&#x27;size&#x27;], os_type_<wbr />with_default)<br />
the sizes however can vary from device to device, so if we have for example an instances that allows ephemeral to be 100G we could have a disk of 50 and two disks of 25 - this will result in two backing files ephemeral_25_blah and ephemeral_50_blah and 3 qcow overlays - two that have the 25 one as base and one that has 50.</p>
<p>The fs_label is applied to the original file when created and it makes no sense for it to be ephemeral0,1 etc... or we should be formatting the newly created overlay which kind of defeats the purpose of having backing files. I will likely file a separate bug for this</p>
<p>Also Tom is right wrt size. The thing is - we will not be getting the real size here, as the user could have overriden it through block device mapping, and we do not save that in the xml.</p>
<p>In the long run - we should really be using the db data to do this and not only the xml, but that is definitely outside of the scope of the bugfix - so as soon as you fix the swap issue - I am +2 on this.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt;I'm a bit confused on the multiple ephemeral disk code. It appears that regardless of the number of disks created, the backing file is the same. ie fname = "ephemeral_%s_%s" % (eph['size'], os_type_with_default) is not dependent on idx. So I'm wondering if only ephemeral0 will be used in the backing file and the rest used in the qcow2 layers. If that's the case we hardcoding 'ephemeral0' for fs_label won't break anything.

so - we go back to the size issue - each ephemeral drive will have a backing file (assuming qcow Images are used by Nova) that is named
  fname = "ephemeral_%s_%s" % (eph['size'], os_type_with_default)
the sizes however can vary from device to device, so if we have for example an instances that allows ephemeral to be 100G we could have a disk of 50 and two disks of 25 - this will result in two backing files ephemeral_25_blah and ephemeral_50_blah and 3 qcow overlays - two that have the 25 one as base and one that has 50.

The fs_label is applied to the original file when created and it makes no sense for it to be ephemeral0,1 etc... or we should be formatting the newly created overlay which kind of defeats the purpose of having backing files. I will likely file a separate bug for this

Also Tom is right wrt size. The thing is - we will not be getting the real size here, as the user could have overriden it through block device mapping, and we do not save that in the xml.

In the long run - we should really be using the db data to do this and not only the xml, but that is definitely outside of the scope of the bugfix - so as soon as you fix the swap issue - I am +2 on this.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-03T18:28:51.769848+00:00" title="2013-12-03 18:28:51 UTC">on 2013-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>diff --git a/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py b/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
index bf7609f..6a1591c 100644<br />
--- a/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
+++ b/nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
@@ -4381,7 +4381,22 @@ class LibvirtDriver(<wbr />driver.<wbr />ComputeDriver)<wbr />:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;image = self.image_<wbr />backend.<wbr />image(instance,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;instance_<wbr />disk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;CONF.libvirt.<wbr />images_<wbr />type)<br />
-                image.cache(<wbr />fetch_func=<wbr />libvirt_<wbr />utils.fetch_<wbr />image,<br />
+                if cache_name.<wbr />startswith(<wbr />&#x27;ephemeral&#x27;<wbr />):<br />
+                    image.cache(<wbr />fetch_func=<wbr />self._create_<wbr />ephemeral,<br />
+                            fs_label=<wbr />cache_name,<br />
+                            os_type=<wbr />instance[<wbr />&quot;os_type&quot;<wbr />],<br />
+                            filename=<wbr />cache_name,<br />
+                            size=info[<wbr />&#x27;virt_disk_<wbr />size&#x27;],<br />
+                            ephemeral_<wbr />size=instance[<wbr />&#x27;ephemeral_<wbr />gb&#x27;])<br />
+                elif cache_name.<wbr />startswith(<wbr />&#x27;swap&#x27;)<wbr />:<br />
+                    inst_type = flavors.<wbr />extract_<wbr />flavor(<wbr />instance)<br />
+                    swap_mb = inst_type[&#x27;swap&#x27;]<br />
+                    image.cache(<wbr />fetch_func=<wbr />self._create_<wbr />swap,<br />
+                            filename=&quot;swap_%s&quot; % swap_mb,<br />
+                            size = swap_mb * unit.Mi<br />
+                            swap_mb=swap_mb)<br />
+                else:<br />
+                    image.cache(<wbr />fetch_func=<wbr />libvirt_<wbr />utils.fetch_<wbr />image,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;context=<wbr />context,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;filename=<wbr />cache_name,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;image_<wbr />id=instance[<wbr />&#x27;image_<wbr />ref&#x27;],</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">diff --git a/nova/virt/libvirt/driver.py b/nova/virt/libvirt/driver.py
index bf7609f..6a1591c 100644
--- a/nova/virt/libvirt/driver.py
+++ b/nova/virt/libvirt/driver.py
@@ -4381,7 +4381,22 @@ class LibvirtDriver(driver.ComputeDriver):
                 image = self.image_backend.image(instance,
                                                  instance_disk,
                                                  CONF.libvirt.images_type)
-                image.cache(fetch_func=libvirt_utils.fetch_image,
+                if cache_name.startswith('ephemeral'):
+                    image.cache(fetch_func=self._create_ephemeral,
+                            fs_label=cache_name,
+                            os_type=instance["os_type"],
+                            filename=cache_name,
+                            size=info['virt_disk_size'],
+                            ephemeral_size=instance['ephemeral_gb'])
+                elif cache_name.startswith('swap'):
+                    inst_type = flavors.extract_flavor(instance)
+                    swap_mb = inst_type['swap']
+                    image.cache(fetch_func=self._create_swap,
+                            filename="swap_%s" % swap_mb,
+                            size = swap_mb * unit.Mi
+                            swap_mb=swap_mb)
+                else:
+                    image.cache(fetch_func=libvirt_utils.fetch_image,
                             context=context,
                             filename=cache_name,
                             image_id=instance['image_ref'],
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-09T22:30:44.061139+00:00" title="2013-12-09 22:30:44 UTC">on 2013-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi all, is the code above ok? Let me know if you need anything else to fix this issue.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi all, is the code above ok? Let me know if you need anything else to fix this issue.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-10T09:49:46.045817+00:00" title="2013-12-10 09:49:46 UTC">on 2013-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Nova core security contacts: could you review the proposed patches ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Nova core security contacts: could you review the proposed patches ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~russellb" class="sprite person">Russell Bryant (russellb)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-10T14:05:00.294131+00:00" title="2013-12-10 14:05:00 UTC">on 2013-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>launchpad has destroyed the formatting in the patch it seems ... can you add the patch as an attachment?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">launchpad has destroyed the formatting in the patch it seems ... can you add the patch as an attachment?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alaski" class="sprite person">Andrew Laski (alaski)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-10T16:25:10.044188+00:00" title="2013-12-10 16:25:10 UTC">on 2013-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The good lgtm based on me indenting it the way I would expect, but I would also like to see it as an attachment to be sure.  All comments within the scope of this change have been addressed as far as I can tell.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The good lgtm based on me indenting it the way I would expect, but I would also like to see it as an attachment to be sure.  All comments within the scope of this change have been addressed as far as I can tell.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alaski" class="sprite person">Andrew Laski (alaski)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-10T16:25:19.883953+00:00" title="2013-12-10 16:25:19 UTC">on 2013-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>s/good/change/</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">s/good/change/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-10T16:45:22.202031+00:00" title="2013-12-10 16:45:22 UTC">on 2013-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3926817/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3926817">Edit</a>
        (2.6 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here&#x27;s the patch,</p>
<p>tests pass - but we need more tests for this - I was working on adding them today but didn&#x27;t manage.</p>
<p>We can post a fix and add tests later too actually.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here's the patch,

tests pass - but we need more tests for this - I was working on adding them today but didn't manage.

We can post a fix and add tests later too actually.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alaski" class="sprite person">Andrew Laski (alaski)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-10T17:31:20.804963+00:00" title="2013-12-10 17:31:20 UTC">on 2013-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Nikola.  The patch looks good to me, but tests would certainly be good to help prevent regressions.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Nikola.  The patch looks good to me, but tests would certainly be good to help prevent regressions.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
    
    <time title="2013-12-12 00:40:53 UTC" datetime="2013-12-12T00:40:53.746312+00:00">on 2013-12-12</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Grant Murphy (gmurphy)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-12T09:52:10.766185+00:00" title="2013-12-12 09:52:10 UTC">on 2013-12-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Draft impact description -</p>
<p>Title :   Live migration can leak root disk into ephemeral storage<br />
Reporter: Loganathan Parthipan<br />
Products  : nova<br />
Affects  : grizzly, havana, icehouse</p>
<p>Description : Loganathan Parthipan reported a vulnerability in the nova libvirt driver. By live migrating a snapshotted virtual machine the contents of the snapshot could potentially be leaked via ephemeral storage.  Only setups using KVM live block migration are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Draft impact description - 

Title :   Live migration can leak root disk into ephemeral storage
Reporter: Loganathan Parthipan   
Products  : nova
Affects  : grizzly, havana, icehouse

Description : Loganathan Parthipan reported a vulnerability in the nova libvirt driver. By live migrating a snapshotted virtual machine the contents of the snapshot could potentially be leaked via ephemeral storage.  Only setups using KVM live block migration are affected. 
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-12T13:54:23.685026+00:00" title="2013-12-12 13:54:23 UTC">on 2013-12-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Grant, a few remarks:<br />
- We usually credit the company the reporter works for, if he provides one.<br />
- We capitalize &quot;Nova&quot;<br />
- For the affects line, we now use &quot;All supported versions&quot; which is a bit more accurate than an enumartion of versions. This may or may not affect Folsom, but we don&#x27;t care because it&#x27;s no longer supported...<br />
- I would precise the attack scenario a bit more, in this case what type of attacker, and how they would get access to the leak. Is it local user ? Another cloud user ? In this case, I would add &quot;An authenticated user could potentially access snapshot content by spawning new servers from the right flavor&quot; or something like it<br />
- We do not have space before colons (header-style)<br />
- We usually add a newline after &quot;Description:&quot;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Grant, a few remarks:
- We usually credit the company the reporter works for, if he provides one.
- We capitalize "Nova"
- For the affects line, we now use "All supported versions" which is a bit more accurate than an enumartion of versions. This may or may not affect Folsom, but we don't care because it's no longer supported... 
- I would precise the attack scenario a bit more, in this case what type of attacker, and how they would get access to the leak. Is it local user ? Another cloud user ? In this case, I would add "An authenticated user could potentially access snapshot content by spawning new servers from the right flavor" or something like it
- We do not have space before colons (header-style)
- We usually add a newline after "Description:"</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-13T01:22:56.779254+00:00" title="2013-12-13 01:22:56 UTC">on 2013-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks ttx. Great feedback.</p>
<p>So is HP right for the company? I couldn&#x27;t tell from the launchpad page..</p>
<p>Attempt #2<br />
----</p>
<p>Title: Live migration can leak root disk into ephemeral storage<br />
Reporter: Loganathan Parthipan<br />
Products: Nova<br />
Affects: All supported versions</p>
<p>Description:<br />
Loganathan Parthipan from Hewlett Packard reported a vulnerability in the Nova libvirt driver.  By spawning a server with the same flavor as another users migrated virtual machine an authenticated user can potentially access that users snapshot content resulting in information leakage. Only setups using KVM live block migration are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks ttx. Great feedback. 

So is HP right for the company? I couldn't tell from the launchpad page..

Attempt #2  
----

Title: Live migration can leak root disk into ephemeral storage
Reporter: Loganathan Parthipan
Products: Nova
Affects: All supported versions

Description:
Loganathan Parthipan from Hewlett Packard reported a vulnerability in the Nova libvirt driver.  By spawning a server with the same flavor as another users migrated virtual machine an authenticated user can potentially access that users snapshot content resulting in information leakage. Only setups using KVM live block migration are affected. 




</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~parthipan" class="sprite person">Loganathan Parthipan (parthipan)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-13T03:46:43.142670+00:00" title="2013-12-13 03:46:43 UTC">on 2013-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yes, HP is correct.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yes, HP is correct.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-13T12:49:58.706757+00:00" title="2013-12-13 12:49:58 UTC">on 2013-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Grant: looks good. I would just add &quot; (HP)&quot; at the end of the Reporter: line and add a comma between &quot;machine&quot; and &quot;an&quot; in the description.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Grant: looks good. I would just add " (HP)" at the end of the Reporter: line and add a comma between "machine" and "an" in the description.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-13T20:32:31.172716+00:00" title="2013-12-13 20:32:31 UTC">on 2013-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Also, should be &quot;user&#x27;s&quot; in two places (possessive form). Otherwise, with Thierry&#x27;s recommendations in mind, the impact description text in comment #27 looks fine to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Also, should be "user's" in two places (possessive form). Otherwise, with Thierry's recommendations in mind, the impact description text in comment #27 looks fine to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-15T22:10:05.882736+00:00" title="2013-12-15 22:10:05 UTC">on 2013-12-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Title: Live migration can leak root disk into ephemeral storage<br />
Reporter: Loganathan Parthipan (HP)<br />
Products: Nova<br />
Affects: All supported versions</p>
<p>Description:<br />
Loganathan Parthipan from Hewlett Packard reported a vulnerability in the Nova libvirt driver. By spawning a server with the same flavor as another user&#x27;s migrated virtual machine, an authenticated user can potentially access that user&#x27;s snapshot content resulting in information leakage. Only setups using KVM live block migration are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Title: Live migration can leak root disk into ephemeral storage
Reporter: Loganathan Parthipan (HP)
Products: Nova
Affects: All supported versions

Description:
Loganathan Parthipan from Hewlett Packard reported a vulnerability in the Nova libvirt driver. By spawning a server with the same flavor as another user's migrated virtual machine, an authenticated user can potentially access that user's snapshot content resulting in information leakage. Only setups using KVM live block migration are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-15T22:26:19.420896+00:00" title="2013-12-15 22:26:19 UTC">on 2013-12-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Grant! That impact description should suffice.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Grant! That impact description should suffice.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
    
    <time title="2013-12-16 05:01:16 UTC" datetime="2013-12-16T05:01:16.322957+00:00">on 2013-12-16</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-12-16 16:48:32 UTC" datetime="2013-12-16T16:48:32.334471+00:00">on 2013-12-16</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-16T17:04:21.156364+00:00" title="2013-12-16 17:04:21 UTC">on 2013-12-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3930419/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3930419">Edit</a>
        (6.1 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>All - here&#x27;s the patch with tests for master - please review and make sure the test is valid as well.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">All - here's the patch with tests for master - please review and make sure the test is valid as well.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-16T17:09:01.735304+00:00" title="2013-12-16 17:09:01 UTC">on 2013-12-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3930420/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3930420">Edit</a>
        (6.3 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here&#x27;s the Havana patch. Am I correct to assume that we will want to fix this in Grizzly as well?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here's the Havana patch. Am I correct to assume that we will want to fix this in Grizzly as well?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-17T13:40:07.800631+00:00" title="2013-12-17 13:40:07 UTC">on 2013-12-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>All,</p>
<p>Wondering if we should open this up because of <a rel="nofollow" href="https://bugs.launchpad.net/nova/+bug/1237683">https:/<wbr />/bugs.launchpad<wbr />.net/nova/<wbr />+bug/1237683</a> comment #1 (basically mentioning the crux of the security issue publicly), or move it along quickly.</p>
<p>I&#x27;ve found several more issues while fixing this that would be good to report and start fixing.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">All,

Wondering if we should open this up because of https://bugs.launchpad.net/nova/+bug/1237683 comment #1 (basically mentioning the crux of the security issue publicly), or move it along quickly.

I've found several more issues while fixing this that would be good to report and start fixing.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-12-18T01:22:45.285128+00:00" title="2013-12-18 01:22:45 UTC">on 2013-12-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think the comment in <a href="/bugs/1237683" class="bug-link">bug 1237683</a> is vague enough as to not point out the security risks involved, so there may still be some benefit to keeping this embargoed while your patches are reviewed here.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think the comment in bug 1237683 is vague enough as to not point out the security risks involved, so there may still be some benefit to keeping this embargoed while your patches are reviewed here.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
    
    <time title="2013-12-18 02:10:37 UTC" datetime="2013-12-18T02:10:37.600279+00:00">on 2013-12-18</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Live migration can leak root disk into ephemeral storage<br />+ Live migration can leak root disk into ephemeral storage (CVE-2013-7130)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-06T13:25:33.577908+00:00" title="2014-01-06 13:25:33 UTC">on 2014-01-06</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/nova/+bug/1251590/comments/37">
                <strong>Re: Live migration can leak root disk into ephemeral storage (CVE-2013-7130)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Nikola: if Grizzly is affected we&#x27;ll want this patch for Grizzly as well.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Nikola: if Grizzly is affected we'll want this patch for Grizzly as well.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-06T13:27:07.872272+00:00" title="2014-01-06 13:27:07 UTC">on 2014-01-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Nova core: another round of review/test on the master and havana patches would be awesome.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Nova core: another round of review/test on the master and havana patches would be awesome.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-14T15:25:40.618824+00:00" title="2014-01-14 15:25:40 UTC">on 2014-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3948550/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3948550">Edit</a>
        (6.0 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is the rebased master patch</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is the rebased master patch</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-14T15:26:44.095778+00:00" title="2014-01-14 15:26:44 UTC">on 2014-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3948551/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3948551">Edit</a>
        (6.3 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The rebased havana patch</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The rebased havana patch</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-14T15:32:10.850787+00:00" title="2014-01-14 15:32:10 UTC">on 2014-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3948566/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_grizzly.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_grizzly.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3948566">Edit</a>
        (7.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is the grizzly patch - please test them.</p>
<p>Thanks a lot!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is the grizzly patch - please test them.

Thanks a lot!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-15T13:15:07.599535+00:00" title="2014-01-15 13:15:07 UTC">on 2014-01-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Nova-core: please review proposed patches and backports !</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Nova-core: please review proposed patches and backports !</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~russellb" class="sprite person">Russell Bryant (russellb)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-15T13:53:19.426502+00:00" title="2014-01-15 13:53:19 UTC">on 2014-01-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>patches look good to me</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">patches look good to me</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alaski" class="sprite person">Andrew Laski (alaski)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-16T16:43:12.054336+00:00" title="2014-01-16 16:43:12 UTC">on 2014-01-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Except for the spurious i in i_create_<wbr />images_<wbr />and_backing method in the commit message they look good to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Except for the spurious i in i_create_images_and_backing method in the commit message they look good to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
    
    <time title="2014-01-20 05:20:33 UTC" datetime="2014-01-20T05:20:33.134704+00:00">on 2014-01-20</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; next
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        next &#8594; icehouse-3
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        icehouse-3 &#8594; none
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-20T07:08:24.686298+00:00" title="2014-01-20 07:08:24 UTC">on 2014-01-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>pre-OSSA sent</p>
<p>Proposed public disclosure date/time: Thursday, January 23, 1500UTC.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">pre-OSSA sent

Proposed public disclosure date/time: Thursday, January 23, 1500UTC.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
    
    <time title="2014-01-22 04:59:29 UTC" datetime="2014-01-22T04:59:29.612141+00:00">on 2014-01-22</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T07:48:13.801159+00:00" title="2014-01-23 07:48:13 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Just noticed that the unit tests for the havana patch aren&#x27;t working for me. (Probably my setup).</p>
<p>./run_tests.sh test_create_<wbr />images_<wbr />and_backing_<wbr />ephemeral_<wbr />gets_created</p>
<p>...</p>
<p>FAIL: nova.tests.<wbr />virt.libvirt.<wbr />test_libvirt.<wbr />LibvirtConnTest<wbr />Case.test_<wbr />create_<wbr />images_<wbr />and_backing_<wbr />ephemeral_<wbr />gets_created</p>
<p>Traceback (most recent call last):<br />
&nbsp;&nbsp;File &quot;/home/<wbr />gm/devel/<wbr />github/<wbr />openstack/<wbr />nova/nova/<wbr />tests/virt/<wbr />libvirt/<wbr />test_libvirt.<wbr />py&quot;, line 3066, in test_create_<wbr />images_<wbr />and_backing_<wbr />ephemeral_<wbr />gets_created<br />
&nbsp;&nbsp;&nbsp;&nbsp;CONF.<wbr />image_cache_<wbr />subdirectory_<wbr />name)<br />
&nbsp;&nbsp;File &quot;/home/<wbr />gm/devel/<wbr />github/<wbr />openstack/<wbr />nova/.venv/<wbr />lib/python2.<wbr />7/site-<wbr />packages/<wbr />oslo/config/<wbr />cfg.py&quot;<wbr />, line 1648, in __getattr__<br />
&nbsp;&nbsp;&nbsp;&nbsp;raise NoSuchOptError(<wbr />name)<br />
NoSuchOptError: no such option: image_cache_<wbr />subdirectory_<wbr />name</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Just noticed that the unit tests for the havana patch aren't working for me. (Probably my setup). 

./run_tests.sh test_create_images_and_backing_ephemeral_gets_created

...

FAIL: nova.tests.virt.libvirt.test_libvirt.LibvirtConnTestCase.test_create_images_and_backing_ephemeral_gets_created

Traceback (most recent call last):
  File "/home/gm/devel/github/openstack/nova/nova/tests/virt/libvirt/test_libvirt.py", line 3066, in test_create_images_and_backing_ephemeral_gets_created
    CONF.image_cache_subdirectory_name)
  File "/home/gm/devel/github/openstack/nova/.venv/lib/python2.7/site-packages/oslo/config/cfg.py", line 1648, in __getattr__
    raise NoSuchOptError(name)
NoSuchOptError: no such option: image_cache_subdirectory_name
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/47" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T09:23:11.716034+00:00" title="2014-01-23 09:23:11 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/47"> #47</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>nope - that&#x27;s a bug.</p>
<p>I&#x27;ll update ASAP</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">nope - that's a bug.

I'll update ASAP</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/48" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T11:08:02.405143+00:00" title="2014-01-23 11:08:02 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/48"> #48</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3954981/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3954981">Edit</a>
        (6.3 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Updated the havana patch to fix the failing tests.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Updated the havana patch to fix the failing tests.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/49" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T12:01:52.306583+00:00" title="2014-01-23 12:01:52 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/49"> #49</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Nikola: The new patch for havana looks like the same from the previous one ( 0001-libvirt-<wbr />Fix-root-<wbr />disk-leak-<wbr />in-live-<wbr />mig_havana.<wbr />patch )</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Nikola: The new patch for havana looks like the same from the previous one ( 0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch ) 

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/50" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T12:34:36.544731+00:00" title="2014-01-23 12:34:36 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/50"> #50</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tristan - you are right - my bad. The real patch is coming up.</p>
<p>Both master and grizzly seem to be OK so no need to update those.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tristan - you are right - my bad. The real patch is coming up.

Both master and grizzly seem to be OK so no need to update those.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/51" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T12:34:54.244594+00:00" title="2014-01-23 12:34:54 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/51"> #51</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3955079/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3955079">Edit</a>
        (6.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/52" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T12:39:23.842267+00:00" title="2014-01-23 12:39:23 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/52"> #52</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thank you Nikola, this last patch fix the test_create_<wbr />images_<wbr />and_backing_<wbr />ephemeral_<wbr />gets_created!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thank you Nikola, this last patch fix the test_create_images_and_backing_ephemeral_gets_created!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/53" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T13:22:10.591691+00:00" title="2014-01-23 13:22:10 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/53"> #53</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sadly, flake8 reported another error afterward (on the last havana patch):</p>
<p>./nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py:4225:<wbr />1: F821 undefined name &#x27;unit&#x27;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sadly, flake8 reported another error afterward (on the last havana patch):

./nova/virt/libvirt/driver.py:4225:1: F821 undefined name 'unit'
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/54" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ndipanov" class="sprite person">Nikola Đipanov (ndipanov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T13:34:51.098210+00:00" title="2014-01-23 13:34:51 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/54"> #54</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3955084/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <a class="sprite edit action-icon" href="/nova/+bug/1251590/+attachment/3955084">Edit</a>
        (6.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Yep - seems that that module does not exist on havana yet - it&#x27;s just a numeric constant tho.</p>
<p>Patch updated.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Yep - seems that that module does not exist on havana yet - it's just a numeric constant tho.

Patch updated.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
    
    <time title="2014-01-23 15:10:33 UTC" datetime="2014-01-23T15:10:33.721928+00:00">on 2014-01-23</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/55" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T15:42:31.783220+00:00" title="2014-01-23 15:42:31 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/55"> #55</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>gerrit review:</p>
<p>master <a rel="nofollow" href="https://review.openstack.org/#/c/68658/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />68658/</a><br />
havana <a rel="nofollow" href="https://review.openstack.org/#/c/68659">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />68659</a><br />
grizzly <a rel="nofollow" href="https://review.openstack.org/#/c/68660/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />68660/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">gerrit review: 

master https://review.openstack.org/#/c/68658/
havana https://review.openstack.org/#/c/68659
grizzly https://review.openstack.org/#/c/68660/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/56" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gmurphy" class="sprite person">Grant Murphy (gmurphy)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-23T16:42:29.211446+00:00" title="2014-01-23 16:42:29 UTC">on 2014-01-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/56"> #56</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>[OSSA 2014-003]</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">[OSSA 2014-003]</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-01-24 18:23:21 UTC" datetime="2014-01-24T18:23:21.986003+00:00">on 2014-01-24</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Live migration can leak root disk into ephemeral storage (CVE-2013-7130)<br />+ [OSSA 2014-003] Live migration can leak root disk into ephemeral storage<br />+ (CVE-2013-7130)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/57" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-25T12:19:05.716289+00:00" title="2014-01-25 12:19:05 UTC">on 2014-01-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/nova/+bug/1251590/comments/57">
                <strong>Fix merged to nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/57"> #57</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/68658">https:/<wbr />/review.<wbr />openstack.<wbr />org/68658</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/nova/commit/?id=b0d36683fe064b32cbef013e1c0c46bd018ab9a1">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />nova/commit/<wbr />?id=b0d36683fe0<wbr />64b32cbef013e1c<wbr />0c46bd018ab9a1</a><br />
Submitter: Jenkins<br />
Branch:    master</p>
<p>commit b0d36683fe064b3<wbr />2cbef013e1c0c46<wbr />bd018ab9a1<br />
Author: Nikola Dipanov &lt;email address hidden&gt;<br />
Date:   Tue Dec 10 17:43:17 2013 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;libvirt: Fix root disk leak in live mig</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch makes sure that i_create_<wbr />images_<wbr />and_backing method of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;libvirt driver (called in several places, but most problematic one is<br />
&nbsp;&nbsp;&nbsp;&nbsp;the call in the pre_live_migration method) creates all the files the<br />
&nbsp;&nbsp;&nbsp;&nbsp;instance needs that are not present.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Prioir to this patch - the method would only attempt to download the<br />
&nbsp;&nbsp;&nbsp;&nbsp;image, and if it did so with the path of the ephemeral drives, it could<br />
&nbsp;&nbsp;&nbsp;&nbsp;expose the image to other users as an ephemeral devices. See the related<br />
&nbsp;&nbsp;&nbsp;&nbsp;bug for more detaiis.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;After this patch - we properly distinguish between image, ephemeral and<br />
&nbsp;&nbsp;&nbsp;&nbsp;swap files, and make sure that the imagebackend does the correct thing.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1251590</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Co-authored-by: Loganathan Parthipan &lt;email address hidden&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I78aa2f4243899d<wbr />b4f4941e77014a7<wbr />e18e27fc63e</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/68658
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=b0d36683fe064b32cbef013e1c0c46bd018ab9a1
Submitter: Jenkins
Branch:    master

commit b0d36683fe064b32cbef013e1c0c46bd018ab9a1
Author: Nikola Dipanov &lt;ndipanov@redhat.com&gt;
Date:   Tue Dec 10 17:43:17 2013 +0100

    libvirt: Fix root disk leak in live mig
    
    This patch makes sure that i_create_images_and_backing method of the
    libvirt driver (called in several places, but most problematic one is
    the call in the pre_live_migration method) creates all the files the
    instance needs that are not present.
    
    Prioir to this patch - the method would only attempt to download the
    image, and if it did so with the path of the ephemeral drives, it could
    expose the image to other users as an ephemeral devices. See the related
    bug for more detaiis.
    
    After this patch - we properly distinguish between image, ephemeral and
    swap files, and make sure that the imagebackend does the correct thing.
    
    Closes-bug: #1251590
    
    Co-authored-by: Loganathan Parthipan &lt;parthipan@hp.com&gt;
    
    Change-Id: I78aa2f4243899db4f4941e77014a7e18e27fc63e
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/58" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-27T21:33:27.364396+00:00" title="2014-01-27 21:33:27 UTC">on 2014-01-27</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/nova/+bug/1251590/comments/58">
                <strong>Fix merged to nova (stable/grizzly)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/58"> #58</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/68660">https:/<wbr />/review.<wbr />openstack.<wbr />org/68660</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/nova/commit/?id=cbeb5e51886b0296349fc476305bfe3d63c627c3">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />nova/commit/<wbr />?id=cbeb5e51886<wbr />b0296349fc47630<wbr />5bfe3d63c627c3</a><br />
Submitter: Jenkins<br />
Branch:    stable/grizzly</p>
<p>commit cbeb5e51886b029<wbr />6349fc476305bfe<wbr />3d63c627c3<br />
Author: Nikola Dipanov &lt;email address hidden&gt;<br />
Date:   Tue Dec 10 17:43:17 2013 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;libvirt: Fix root disk leak in live mig</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch makes sure that _create_<wbr />images_<wbr />and_backing method of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;libvirt driver (called in several places, but most problematic one is<br />
&nbsp;&nbsp;&nbsp;&nbsp;the call in the pre_live_migration method) creates all the files the<br />
&nbsp;&nbsp;&nbsp;&nbsp;instance needs that are not present.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Prioir to this patch - the method would only attempt to download the<br />
&nbsp;&nbsp;&nbsp;&nbsp;image, and if it did so with the path of the ephemeral drives, it could<br />
&nbsp;&nbsp;&nbsp;&nbsp;expose the image to other users as an ephemeral devices. See the related<br />
&nbsp;&nbsp;&nbsp;&nbsp;bug for more detaiis.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;After this patch - we properly distinguish between image, ephemeral and<br />
&nbsp;&nbsp;&nbsp;&nbsp;swap files, and make sure that the imagebackend does the correct thing.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1251590</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Co-authored-by: Loganathan Parthipan &lt;email address hidden&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch also includes part of commit<br />
&nbsp;&nbsp;&nbsp;&nbsp;65386c91910<wbr />ee03d947c2b8bcc<wbr />226a53c30e060a, not cherry-picked as a whole<br />
&nbsp;&nbsp;&nbsp;&nbsp;due to the fact that it is a trivial change, and to avoud the<br />
&nbsp;&nbsp;&nbsp;&nbsp;proliferation of patches needed to fix this bug.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit c69a619668b5f44<wbr />e94a8fe1a23f3d8<wbr />87ba2834d7)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nova/<wbr />tests/test_<wbr />libvirt.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I78aa2f4243899d<wbr />b4f4941e77014a7<wbr />e18e27fc63e</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/68660
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=cbeb5e51886b0296349fc476305bfe3d63c627c3
Submitter: Jenkins
Branch:    stable/grizzly

commit cbeb5e51886b0296349fc476305bfe3d63c627c3
Author: Nikola Dipanov &lt;ndipanov@redhat.com&gt;
Date:   Tue Dec 10 17:43:17 2013 +0100

    libvirt: Fix root disk leak in live mig
    
    This patch makes sure that _create_images_and_backing method of the
    libvirt driver (called in several places, but most problematic one is
    the call in the pre_live_migration method) creates all the files the
    instance needs that are not present.
    
    Prioir to this patch - the method would only attempt to download the
    image, and if it did so with the path of the ephemeral drives, it could
    expose the image to other users as an ephemeral devices. See the related
    bug for more detaiis.
    
    After this patch - we properly distinguish between image, ephemeral and
    swap files, and make sure that the imagebackend does the correct thing.
    
    Closes-bug: #1251590
    
    Co-authored-by: Loganathan Parthipan &lt;parthipan@hp.com&gt;
    
    This patch also includes part of commit
    65386c91910ee03d947c2b8bcc226a53c30e060a, not cherry-picked as a whole
    due to the fact that it is a trivial change, and to avoud the
    proliferation of patches needed to fix this bug.
    
    (cherry picked from commit c69a619668b5f44e94a8fe1a23f3d887ba2834d7)
    
    Conflicts:
    	nova/tests/test_libvirt.py
    	nova/virt/libvirt/driver.py
    
    Change-Id: I78aa2f4243899db4f4941e77014a7e18e27fc63e
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~apevec" class="sprite person">Alan Pevec (apevec)</a>
    
    <time title="2014-01-28 00:03:32 UTC" datetime="2014-01-28T00:03:32.188600+00:00">on 2014-01-28</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Nikola Đipanov (ndipanov)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/nova/+bug/1251590/comments/59" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-01-30T14:24:17.341941+00:00" title="2014-01-30 14:24:17 UTC">on 2014-01-30</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/nova/+bug/1251590/comments/59">
                <strong>Fix merged to nova (stable/havana)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/nova/+bug/1251590/comments/59"> #59</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/68659">https:/<wbr />/review.<wbr />openstack.<wbr />org/68659</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/nova/commit/?id=15ee7e17f63f5583307a546ecf28952c364c88f9">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />nova/commit/<wbr />?id=15ee7e17f63<wbr />f5583307a546ecf<wbr />28952c364c88f9</a><br />
Submitter: Jenkins<br />
Branch:    stable/havana</p>
<p>commit 15ee7e17f63f558<wbr />3307a546ecf2895<wbr />2c364c88f9<br />
Author: Nikola Dipanov &lt;email address hidden&gt;<br />
Date:   Tue Dec 10 17:43:17 2013 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;libvirt: Fix root disk leak in live mig</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch makes sure that _create_<wbr />images_<wbr />and_backing method of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;libvirt driver (called in several places, but most problematic one is<br />
&nbsp;&nbsp;&nbsp;&nbsp;the call in the pre_live_migration method) creates all the files the<br />
&nbsp;&nbsp;&nbsp;&nbsp;instance needs that are not present.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Prioir to this patch - the method would only attempt to download the<br />
&nbsp;&nbsp;&nbsp;&nbsp;image, and if it did so with the path of the ephemeral drives, it could<br />
&nbsp;&nbsp;&nbsp;&nbsp;expose the image to other users as an ephemeral devices. See the related<br />
&nbsp;&nbsp;&nbsp;&nbsp;bug for more detaiis.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;After this patch - we properly distinguish between image, ephemeral and<br />
&nbsp;&nbsp;&nbsp;&nbsp;swap files, and make sure that the imagebackend does the correct thing.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1251590</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Co-authored-by: Loganathan Parthipan &lt;email address hidden&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit c69a619668b5f44<wbr />e94a8fe1a23f3d8<wbr />87ba2834d7)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nova/<wbr />virt/libvirt/<wbr />driver.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I78aa2f4243899d<wbr />b4f4941e77014a7<wbr />e18e27fc63e</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/68659
Committed: https://git.openstack.org/cgit/openstack/nova/commit/?id=15ee7e17f63f5583307a546ecf28952c364c88f9
Submitter: Jenkins
Branch:    stable/havana

commit 15ee7e17f63f5583307a546ecf28952c364c88f9
Author: Nikola Dipanov &lt;ndipanov@redhat.com&gt;
Date:   Tue Dec 10 17:43:17 2013 +0100

    libvirt: Fix root disk leak in live mig
    
    This patch makes sure that _create_images_and_backing method of the
    libvirt driver (called in several places, but most problematic one is
    the call in the pre_live_migration method) creates all the files the
    instance needs that are not present.
    
    Prioir to this patch - the method would only attempt to download the
    image, and if it did so with the path of the ephemeral drives, it could
    expose the image to other users as an ephemeral devices. See the related
    bug for more detaiis.
    
    After this patch - we properly distinguish between image, ephemeral and
    swap files, and make sure that the imagebackend does the correct thing.
    
    Closes-bug: #1251590
    
    Co-authored-by: Loganathan Parthipan &lt;parthipan@hp.com&gt;
    
    (cherry picked from commit c69a619668b5f44e94a8fe1a23f3d887ba2834d7)
    
    Conflicts:
    	nova/virt/libvirt/driver.py
    Change-Id: I78aa2f4243899db4f4941e77014a7e18e27fc63e
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-01-30 17:18:20 UTC" datetime="2014-01-30T17:18:20.360354+00:00">on 2014-01-30</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~russellb" class="sprite person">Russell Bryant (russellb)</a>
    
    <time title="2014-02-21 14:42:33 UTC" datetime="2014-02-21T14:42:33.316226+00:00">on 2014-02-21</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; icehouse-3
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-03-05 13:07:45 UTC" datetime="2014-03-05T13:07:45.840300+00:00">on 2014-03-05</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-04-17 09:04:58 UTC" datetime="2014-04-17T09:04:58.986016+00:00">on 2014-04-17</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        icehouse-3 &#8594; 2014.1
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/nova/+bug/1251590/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/nova/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/nova/+bug/1251590/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/nova/+bug/1251590/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/nova/+bug/1251590/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/nova/+bug/1251590/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/nova/+bug/1251590/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/nova/+bug/1251590/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/nova/+bug/1251590/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/nova/+bug/1251590/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/nova/+bug/1251590/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3926817/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3926817">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3930419/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3930419">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3930420/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3930420">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3948550/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3948550">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3948551/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3948551">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3948566/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_grizzly.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_grizzly.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3948566">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3954981/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3954981">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3955079/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3955079">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/nova/+bug/1251590/+attachment/3955084/+files/0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch">0001-libvirt-Fix-root-disk-leak-in-live-mig_havana.patch</a>
        <small>
          (<a href="/nova/+bug/1251590/+attachment/3955084">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/nova/+bug/1251590/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"initial_comment_batch_offset": 41, "first visible_recent_comment": 19, "related_features": {}, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1251590", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1251590"}, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1251590", "web_link": "https://bugs.launchpad.net/bugs/1251590", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1251590, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)", "description": "During pre-live-migration required disks are created along with their backing files (if they don't already exist). However, the ephemeral backing file is created from a glance downloaded root disk.\n\n# If the required ephemeral backing file is present then there's no issue.\n\n# If the required ephemeral backing file is not already present, then the root disk is downloaded and saved as the ephemeral backing file. This will result in the following situations:\n\n## The disk.local transferred during live-migration will be rebased on the ephemeral backing file so regardless of the content, the end result will be identical to the source disk.local.\n## However, if a new instance of the same flavor is spawned on this compute node, then it will have an ephemeral storage that exposes a root disk.\n\nSecurity concerns:\n\nIf the migrated VM was spawned off a snapshot, now it's possible for any instances of the correct flavor to see the snapshot contents of another user via the ephemeral storage.", "owner_link": "https://bugs.launchpad.net/api/devel/~parthipan", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/bug_tasks", "duplicate_of_link": null, "date_created": "2013-11-15T11:09:28.840231+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/subscriptions", "date_last_updated": "2014-04-17T09:05:01.251173+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 276, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/attachments", "security_related": true, "latest_patch_uploaded": "2014-01-23T13:34:51.098210+00:00", "tags": [], "date_last_message": "2014-01-30T14:24:17.341941+00:00", "number_of_duplicates": 0, "message_count": 60, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1251590/linked_merge_proposals", "http_etag": "\"dcd3d36ca8ff1ac1840446acc1755ebae2402846-8aa3771197af8250135dd4181d6a40c546324bde\""}, "bugtask_data": {"1523146": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/nova/grizzly/+bug/1251590/+delete", "user_can_edit_status": true, "bugtask_path": "/nova/grizzly/+bug/1251590", "row_id": "tasksummary1523146", "importance_value": "High", "importance_widget_items": "[]", "id": 1523146, "user_can_delete": false, "targetname": "OpenStack Compute (nova) grizzly", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)", "assignee_value": "ndipanov", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1523146", "target_is_product": false, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/nova/+milestone/2013.1.5", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "nova_grizzly"}, "1523147": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/nova/havana/+bug/1251590/+delete", "user_can_edit_status": true, "bugtask_path": "/nova/havana/+bug/1251590", "row_id": "tasksummary1523147", "importance_value": "High", "importance_widget_items": "[]", "id": 1523147, "user_can_delete": false, "targetname": "OpenStack Compute (nova) havana", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)", "assignee_value": "ndipanov", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1523147", "target_is_product": false, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/nova/+milestone/2013.2.2", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "nova_havana"}, "1500932": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ossa/+bug/1251590/+delete", "user_can_edit_status": true, "bugtask_path": "/ossa/+bug/1251590", "row_id": "tasksummary1500932", "importance_value": "High", "importance_widget_items": "[]", "id": 1500932, "user_can_delete": false, "targetname": "OpenStack Security Advisory", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)", "assignee_value": "gmurphy", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1500932", "target_is_product": true, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": null, "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "ossa"}, "1500821": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/nova/+bug/1251590/+delete", "user_can_edit_status": true, "bugtask_path": "/nova/+bug/1251590", "row_id": "tasksummary1500821", "importance_value": "High", "importance_widget_items": "[]", "id": 1500821, "user_can_delete": false, "targetname": "OpenStack Compute (nova)", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)", "assignee_value": "ndipanov", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1500821", "target_is_product": true, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/nova/+milestone/2014.1", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "nova"}}, "bug_is_private": false, "context": {"self_link": "https://bugs.launchpad.net/api/devel/nova/+bug/1251590", "web_link": "https://bugs.launchpad.net/nova/+bug/1251590", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1251590", "milestone_link": "https://bugs.launchpad.net/api/devel/nova/+milestone/2014.1", "status": "Fix Released", "importance": "High", "assignee_link": "https://bugs.launchpad.net/api/devel/~ndipanov", "bug_target_display_name": "OpenStack Compute (nova)", "bug_target_name": "nova", "bug_watch_link": null, "date_assigned": "2014-01-28T00:03:33.568748+00:00", "date_created": "2013-11-15T11:09:28.840231+00:00", "date_confirmed": "2013-11-27T11:04:07.922928+00:00", "date_incomplete": null, "date_in_progress": "2013-12-16T05:01:17.619837+00:00", "date_closed": "2014-03-05T13:07:46.837180+00:00", "date_left_new": "2013-11-27T11:04:07.922928+00:00", "date_triaged": "2013-12-16T05:01:17.619837+00:00", "date_fix_committed": "2014-01-25T12:19:03.298646+00:00", "date_fix_released": "2014-03-05T13:07:46.837180+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~parthipan", "target_link": "https://bugs.launchpad.net/api/devel/nova", "title": "Bug #1251590 in OpenStack Compute (nova): \"[OSSA 2014-003] Live migration can leak root disk into ephemeral storage (CVE-2013-7130)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/nova/+bug/1251590/related_tasks", "is_complete": true, "http_etag": "\"6f6dac75841e15bc82eb6c5afa3aa26aaf5409f0-05b480292ebe7f3e2e6badb9254a2eae260e47a9\""}, "information_type_data": {"PUBLIC": {"value": "PUBLIC", "is_private": false, "order": 0, "name": "Public", "description": "Everyone can see this information.\n", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"value": "PRIVATESECURITY", "is_private": true, "order": 2, "name": "Private Security", "description": "Only the security group can see this information.\n ", "description_css_class": "choice-description"}, "USERDATA": {"value": "USERDATA", "is_private": true, "order": 3, "name": "Private", "description": "Only shared with users permitted to see private user information.\n", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"value": "PUBLICSECURITY", "is_private": false, "order": 1, "name": "Public Security", "description": "Everyone can see this security related information.\n", "description_css_class": "choice-description"}}, "total_comments_and_activity": 121};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 64 queries/external actions issued in 1.14 seconds

    Features: {'bugs.nominations.bug_supervisors_can_target': 'on', 'hard_timeout': '9000', 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'app.maintenance_message': None, 'js.yui_version': None, 'disclosure.dsp_picker.enabled': 'on', 'profiling.enabled': None, 'baselayout.careers_link.disabled': None}

    r0d8de2b

    -->

</html>

