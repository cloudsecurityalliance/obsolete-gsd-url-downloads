<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/hplip/+bug/809904/+index" />

    <meta charset="UTF-8" />
    <title>Bug #809904 “insecure tmp file handling in hpcupsfax.cpp” : Bugs : HPLIP</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/809904" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/809904/bug.atom" title="Bug 809904 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="hplip-3.11.5 prnt/hpijs/hpcupsfax.cp contains:
------------------------------------------------------------
    if (iLogLevel &amp; SAVE_PCL_FILE)
    {
        fp = fopen (&quot;/tmp/hpcupsfax.out&quot;, &quot;w&quot;);
        system (&quot;chmod 666 /tmp/hpcupsfax.out&quot;);
    }
------------------------------------------------------------

This insecure tmp file handling results
potential read/write of arbitrary files." />
      <meta property="og:description" content="hplip-3.11.5 prnt/hpijs/hpcupsfax.cp contains:
------------------------------------------------------------
    if (iLogLevel &amp; SAVE_PCL_FILE)
    {
        fp = fopen (&quot;/tmp/hpcupsfax.out&quot;, &quot;w&quot;);
        system (&quot;chmod 666 /tmp/hpcupsfax.out&quot;);
    }
------------------------------------------------------------

This insecure tmp file handling results
potential read/write of arbitrary files." />
    

    
    
      <meta property="og:title" content="Bug #809904 “insecure tmp file handling in hpcupsfax.cpp” : Bugs : HPLIP" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/809904" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["cartridge", "fax", "install", "network", "plugin", "ppd", "print", "quality", "scan", "system-tray", "third-party-packages", "tools", "update", "usb", "wireless", "wishlist"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/hplip/+bug/809904/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/hplip"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/24347132/hp-tux-printer64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/hplip">HPLIP</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/hplip">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/hplip">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/hplip">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/hplip">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/hplip">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/hplip">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    insecure tmp file handling in hpcupsfax.cpp
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #809904 reported by
      <a href="https://launchpad.net/~jsmeix" class="sprite person">Johannes Meixner</a>
      <time title="2011-07-13 14:16:02 UTC" datetime="2011-07-13T14:16:02.160232+00:00">on 2011-07-13</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">10</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary954763">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/hplip/+bug/809904/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary954763">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/hplip">HPLIP</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/hplip/+bug/809904/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/hplip/+bug/809904/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary954763">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~sanjay-kumar14">Sanjay Kumar</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task954763">
     <td colspan="7"><form action="/hplip/+bug/809904/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/hplip">HPLIP</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~jsmeix" class="sprite person">Johannes Meixner</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2011-07-13 14:16:02 UTC" datetime="2011-07-13T14:16:02.160232+00:00">2011-07-13</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2011-08-19 11:32:08 UTC" datetime="2011-08-19T11:32:08.917927+00:00">2011-08-19</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2011-08-16 10:40:49 UTC" datetime="2011-08-16T10:40:49.079144+00:00">2011-08-16</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2011-08-19 11:32:22 UTC" datetime="2011-08-19T11:32:22.994092+00:00">2011-08-19</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2011-10-05 08:26:48 UTC" datetime="2011-10-05T08:26:48.913823+00:00">2011-10-05</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="hplip.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="hplip.target.option.package" name="hplip.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="hplip.target.distribution" name="hplip.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="hplip.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="hplip.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="hplip.target.package"
                         name="hplip.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;hplip.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('hplip.target.package');
              var select_menu = Y.DOM.byId('hplip.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-hplip-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionPackage", "extra_no_results_message": null, "selected_value": null, "show_assign_me_button": false, "show_widget_id": "show-widget-hplip-target-package", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "hplip.target.package"};
        var show_widget_id = 'show-widget-hplip-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="hplip.target.option.product" name="hplip.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="hplip" id="hplip.target.product"
                         name="hplip.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;hplip.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('hplip.target.product');
              var select_menu = Y.DOM.byId('hplip.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-hplip-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a project", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "Product", "extra_no_results_message": null, "selected_value": "hplip", "show_assign_me_button": false, "show_widget_id": "show-widget-hplip-target-product", "step_title": "Search", "assign_me_text": "Pick me", "input_element": "hplip.target.product"};
        var show_widget_id = 'show-widget-hplip-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="hplip.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="hplip.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="hplip.status" name="hplip.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="hplip.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="hplip.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="hplip.assignee.assign_to_me" name="hplip.assignee.option" value="hplip.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="hplip.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="hplip.assignee.assigned_to" name="hplip.assignee.option" value="hplip.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="hplip.assignee.assigned_to">
              Sanjay Kumar (sanjay-kumar14)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="hplip.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="hplip.comment_on_change" name="hplip.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/hplip/+bug/809904/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/hplip/+bug/809904/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/hplip/+bug/809904/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>hplip-3.11.5 prnt/hpijs/<wbr />hpcupsfax.<wbr />cp contains:<br />
-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />----<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (iLogLevel &amp; SAVE_PCL_FILE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp = fopen (&quot;/tmp/<wbr />hpcupsfax.<wbr />out&quot;, &quot;w&quot;);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system (&quot;chmod 666 /tmp/hpcupsfax.<wbr />out&quot;);<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />----</p>
<p>This insecure tmp file handling results<br />
potential read/write of arbitrary files.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2011-2722" title="The send_data_to_stdout function in p...">2011-2722</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jsmeix" class="sprite person">Johannes Meixner (jsmeix)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-12T09:59:38.973438+00:00" title="2011-08-12 09:59:38 UTC">on 2011-08-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I wonder why there is not any kind of response<br />
from the HPLIP team regarding this security bug?</p>
<p>First and foremost I aks for a response whether or not<br />
the HPLIP developers think it is actually a security bug.</p>
<p>As far as I see the crucial point to decide this is to know<br />
under which exact circumstances the condition<br />
&quot;if (iLogLevel &amp; SAVE_PCL_FILE)&quot; becomes  &quot;true&quot;.</p>
<p>If &quot;iLogLevel &amp; SAVE_PCL_FILE&quot; is true in in normal operation<br />
(i.e. when it is true by default), it is a security bug.</p>
<p>In contrast if &quot;iLogLevel &amp; SAVE_PCL_FILE&quot; is true only<br />
under special circumstances it may be no security bug.</p>
<p>E.g. when only the user &quot;root&quot; can set someting<br />
so that &quot;iLogLevel &amp; SAVE_PCL_FILE&quot; is true<br />
(e.g. somehow enable debugging mode which is<br />
by default disabled for normal users)<br />
when the issue is no security bug.</p>
<p>I do not have the knowledge to decide this.<br />
Therefore an analysis from the HPLIP team is needed.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I wonder why there is not any kind of response
from the HPLIP team regarding this security bug?

First and foremost I aks for a response whether or not
the HPLIP developers think it is actually a security bug.

As far as I see the crucial point to decide this is to know
under which exact circumstances the condition
"if (iLogLevel &amp; SAVE_PCL_FILE)" becomes  "true".

If "iLogLevel &amp; SAVE_PCL_FILE" is true in in normal operation
(i.e. when it is true by default), it is a security bug.

In contrast if "iLogLevel &amp; SAVE_PCL_FILE" is true only
under special circumstances it may be no security bug.

E.g. when only the user "root" can set someting
so that "iLogLevel &amp; SAVE_PCL_FILE" is true
(e.g. somehow enable debugging mode which is
by default disabled for normal users)
when the issue is no security bug.

I do not have the knowledge to decide this.
Therefore an analysis from the HPLIP team is needed.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sanjay-kumar14" class="sprite person">Sanjay Kumar (sanjay-kumar14)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-16T10:04:44.749366+00:00" title="2011-08-16 10:04:44 UTC">on 2011-08-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi,</p>
<p>Sorry for the delay in response. Regarding the issue mentioned by you, here are my comments.</p>
<p>1) SAVE_PCL_FILE  is a macro defined in ./prnt/<wbr />hpcups/<wbr />CommonDefinitio<wbr />ns.h of HPLIP Source code. ie<br />
#define BASIC_LOG          1<br />
#define SAVE_PCL_FILE      2<br />
#define SAVE_INPUT_RASTERS 4<br />
#define SEND_TO_<wbr />PRINTER_<wbr />ALSO    8</p>
<p>2) iLogLevel is read from the file /etc/cups/<wbr />cupsd.conf if following line is present in the file.</p>
<p>hpLogLevel &lt;NUMBER&gt;</p>
<p>Where &lt;NUMBER&gt; is the integer value betwwen 1-15 based on our need.<br />
Note: This line is not present in the above file  by default. For debugging purpose only root can add this line in /etc/cups/<wbr />cupsd.conf and then collect the logs.</p>
<p>Therefore &quot;if (iLogLevel &amp; SAVE_PCL_FILE) &quot; condition will be True only when /etc/cups/<wbr />cupsd.conf file is modified in root mode and then cups  is restarted. Since &quot;iLogLevel &amp; SAVE_PCL_FILE&quot; is true only under special circumstances it should not be a security bug.</p>
<p>Thanks,<br />
Sanjay</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi,

Sorry for the delay in response. Regarding the issue mentioned by you, here are my comments.

1) SAVE_PCL_FILE  is a macro defined in ./prnt/hpcups/CommonDefinitions.h of HPLIP Source code. ie
#define BASIC_LOG          1
#define SAVE_PCL_FILE      2
#define SAVE_INPUT_RASTERS 4
#define SEND_TO_PRINTER_ALSO    8


2) iLogLevel is read from the file /etc/cups/cupsd.conf if following line is present in the file.

hpLogLevel &lt;NUMBER&gt;

Where &lt;NUMBER&gt; is the integer value betwwen 1-15 based on our need.
Note: This line is not present in the above file  by default. For debugging purpose only root can add this line in /etc/cups/cupsd.conf and then collect the logs.

Therefore "if (iLogLevel &amp; SAVE_PCL_FILE) " condition will be True only when /etc/cups/cupsd.conf file is modified in root mode and then cups  is restarted. Since "iLogLevel &amp; SAVE_PCL_FILE" is true only under special circumstances it should not be a security bug.

Thanks,
Sanjay


</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~sanjay-kumar14" class="sprite person">Sanjay Kumar (sanjay-kumar14)</a>
    
    <time title="2011-08-16 10:40:43 UTC" datetime="2011-08-16T10:40:43.123978+00:00">on 2011-08-16</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in hplip: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Invalid
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Sanjay Kumar (sanjay-kumar14)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jsmeix" class="sprite person">Johannes Meixner (jsmeix)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-16T12:18:22.099629+00:00" title="2011-08-16 12:18:22 UTC">on 2011-08-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Many thanks for your analysis<br />
and in particular very many thanks<br />
for your thorough description which<br />
helps a lot to understand the issue!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Many thanks for your analysis
and in particular very many thanks
for your thorough description which
helps a lot to understand the issue!
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~jsmeix" class="sprite person">Johannes Meixner (jsmeix)</a>
    
    <time title="2011-08-16 13:23:24 UTC" datetime="2011-08-16T13:23:24.708517+00:00">on 2011-08-16</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>security vulnerability</b>:
      </td>
      <td>
        yes &#8594; no
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>visibility</b>:
      </td>
      <td>
        private &#8594; public
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~meissner" class="sprite person">Marcus Meissner (meissner)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-16T13:58:51.249820+00:00" title="2011-08-16 13:58:51 UTC">on 2011-08-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sanjay, your explanation as given is not an excuse of writing insecure code, as there is<br />
no way to &quot;secure&quot; enable this option on systems with potential malicious users.</p>
<p>A simple symlink left in /tmp/hpcupsfax.out to /etc/shadow or other relevant system files could be used by local attackers to make that file writable and ultimately gain root privileges.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sanjay, your explanation as given is not an excuse of writing insecure code, as there is
no way to "secure" enable this option on systems with potential malicious users.

A simple symlink left in /tmp/hpcupsfax.out to /etc/shadow or other relevant system files could be used by local attackers to make that file writable and ultimately gain root privileges.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sanjay-kumar14" class="sprite person">Sanjay Kumar (sanjay-kumar14)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-17T05:23:35.793151+00:00" title="2011-08-17 05:23:35 UTC">on 2011-08-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hello Marcus,</p>
<p>Thanks for your comments.   The code which you are seeing above is exercised only when there is a problem and we need to generate the log files and debug information. The log levels are enabled by the users and are exercised only temporarily to generate the logs. After logs are generated, they will revert it back to original settings.These files can be cleaned up by the users after generating the logs. Please let us know if this is still an issue.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hello Marcus,

Thanks for your comments.   The code which you are seeing above is exercised only when there is a problem and we need to generate the log files and debug information. The log levels are enabled by the users and are exercised only temporarily to generate the logs. After logs are generated, they will revert it back to original settings.These files can be cleaned up by the users after generating the logs. Please let us know if this is still an issue.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jsmeix" class="sprite person">Johannes Meixner (jsmeix)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-17T08:09:23.624816+00:00" title="2011-08-17 08:09:23 UTC">on 2011-08-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sanjay,<br />
I wished there were comments in the HPLIP code which tell<br />
how the stuff is meant (i.e. what the purpose and idea behind is).</p>
<p>Because I don&#x27;t know for sure what the purpose and idea behind is<br />
I can only make assumptions according to how I understand the code.</p>
<p>Based on this assumptions I think the following:</p>
<p>From my point of view &quot;/tmp/hpcupsfax<wbr />.out&quot; is not meant<br />
as a temporary file but as output file for debugging purpose<br />
which (unfortunately) exists in a directory (/tmp)<br />
where any user can create a symbolic link like for example<br />
&nbsp;&nbsp;/tmp/<wbr />hpcupsfax.<wbr />out -&gt; /etc/passwd<br />
and then when<br />
&nbsp;&nbsp;system (&quot;chmod 666 /tmp/hpcupsfax.<wbr />out&quot;)<br />
would be run as root (I don&#x27;t know under which user it runs)<br />
it would do an evil thing.</p>
<p>When &quot;/tmp/hpcupsfax<wbr />.out&quot; is meant as output file for debugging purpose<br />
it would be not nice when the debugging output file name is not<br />
a fixed name which is known in advance but instead it would be some<br />
secure but awkward &quot;mktemp&quot; name like /tmp/hpcupsfax.<wbr />out.XXXXXXXXXX</p>
<p>When &quot;/tmp/hpcupsfax<wbr />.out&quot; is meant as output file for debugging purpose<br />
I think it should be o.k. to remove an existing file or symbolic link<br />
with this name via something like:</p>
<p>&nbsp;&nbsp;if (iLogLevel &amp; SAVE_PCL_FILE)<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (system (&quot;rm -f /tmp/hpcupsfax.<wbr />out&quot;))<br />
&nbsp;&nbsp;&nbsp;&nbsp;{ return 1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;fp = fopen (&quot;/tmp/<wbr />hpcupsfax.<wbr />out&quot;, &quot;w&quot;);<br />
&nbsp;&nbsp;&nbsp;&nbsp;system (&quot;chmod 666 /tmp/hpcupsfax.<wbr />out&quot;);<br />
&nbsp;&nbsp;}</p>
<p>But because of the stick bit in the /tmp/ directory<br />
&quot;rm -f /tmp/hpcupsfax.out&quot; works only for root and for the user<br />
who had created /tmp/hpcupsfax.out</p>
<p>I think this could be o.k. because when the stuff is run as root<br />
it would enforce &quot;the right thing&quot; and when it is run as non-root<br />
it would do &quot;the right thing&quot; when /tmp/hpcupsfax.out from<br />
the same user already exists and otherwise it would return<br />
something like a &quot;failed&quot; state as far as I guess the meaning<br />
of &quot;return 1&quot; in prnt/hpijs/<wbr />hpcupsfax.<wbr />cpp</p>
<p>But I am not a security expert to finally decide about it.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sanjay,
I wished there were comments in the HPLIP code which tell
how the stuff is meant (i.e. what the purpose and idea behind is).

Because I don't know for sure what the purpose and idea behind is
I can only make assumptions according to how I understand the code.

Based on this assumptions I think the following:

From my point of view "/tmp/hpcupsfax.out" is not meant
as a temporary file but as output file for debugging purpose
which (unfortunately) exists in a directory (/tmp)
where any user can create a symbolic link like for example
  /tmp/hpcupsfax.out -&gt; /etc/passwd
and then when
  system ("chmod 666 /tmp/hpcupsfax.out")
would be run as root (I don't know under which user it runs)
it would do an evil thing.

When "/tmp/hpcupsfax.out" is meant as output file for debugging purpose
it would be not nice when the debugging output file name is not
a fixed name which is known in advance but instead it would be some
secure but awkward "mktemp" name like /tmp/hpcupsfax.out.XXXXXXXXXX

When "/tmp/hpcupsfax.out" is meant as output file for debugging purpose
I think it should be o.k. to remove an existing file or symbolic link
with this name via something like:

  if (iLogLevel &amp; SAVE_PCL_FILE)
  {
    if (system ("rm -f /tmp/hpcupsfax.out"))
    { return 1;
    }
    fp = fopen ("/tmp/hpcupsfax.out", "w");
    system ("chmod 666 /tmp/hpcupsfax.out");
  }

But because of the stick bit in the /tmp/ directory
"rm -f /tmp/hpcupsfax.out" works only for root and for the user
who had created /tmp/hpcupsfax.out

I think this could be o.k. because when the stuff is run as root
it would enforce "the right thing" and when it is run as non-root
it would do "the right thing" when /tmp/hpcupsfax.out from
the same user already exists and otherwise it would return
something like a "failed" state as far as I guess the meaning
of "return 1" in prnt/hpijs/hpcupsfax.cpp

But I am not a security expert to finally decide about it.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/hplip/+bug/809904/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sanjay-kumar14" class="sprite person">Sanjay Kumar (sanjay-kumar14)</a>
            wrote
            <time itemprop="commentTime" datetime="2011-08-19T11:31:55.349804+00:00" title="2011-08-19 11:31:55 UTC">on 2011-08-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/hplip/+bug/809904/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Johannes,</p>
<p>Thanks for the detailed analysis of the problem. We will  remove the hard coded name &quot;hpcupsfax.out&quot; for the temp file creation and  instead create temp file using  mkstemp() call.  Please let us know if there is any issue.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Johannes,

Thanks for the detailed analysis of the problem. We will  remove the hard coded name "hpcupsfax.out" for the temp file creation and  instead create temp file using  mkstemp() call.  Please let us know if there is any issue.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in hplip: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Invalid &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~sanjay-kumar14" class="sprite person">Sanjay Kumar (sanjay-kumar14)</a>
    
    <time title="2011-10-05 08:26:48 UTC" datetime="2011-10-05T08:26:48.571225+00:00">on 2011-10-05</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in hplip: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/hplip/+bug/809904/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/hplip/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/hplip/+bug/809904/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/hplip/+bug/809904/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/hplip/+bug/809904/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/hplip/+bug/809904/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/hplip/+bug/809904/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/hplip/+bug/809904/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/hplip/+bug/809904/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/hplip/+bug/809904/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/hplip/+bug/809904/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  
  


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/809904", "web_link": "https://bugs.launchpad.net/bugs/809904", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 809904, "private": false, "information_type": "Public", "name": null, "title": "insecure tmp file handling in hpcupsfax.cpp", "description": "hplip-3.11.5 prnt/hpijs/hpcupsfax.cp contains:\n------------------------------------------------------------\n    if (iLogLevel \u0026 SAVE_PCL_FILE)\n    {\n        fp = fopen (\"/tmp/hpcupsfax.out\", \"w\");\n        system (\"chmod 666 /tmp/hpcupsfax.out\");\n    }\n------------------------------------------------------------\n\nThis insecure tmp file handling results\npotential read/write of arbitrary files.", "owner_link": "https://bugs.launchpad.net/api/devel/~jsmeix", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/bug_tasks", "duplicate_of_link": null, "date_created": "2011-07-13T14:16:02.160232+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/subscriptions", "date_last_updated": "2011-10-05T08:26:49.322841+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 10, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/attachments", "security_related": false, "latest_patch_uploaded": null, "tags": [], "date_last_message": "2011-08-19T11:31:55.349804+00:00", "number_of_duplicates": 0, "message_count": 8, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/809904/linked_merge_proposals", "http_etag": "\"2929ea941fdafb8a903b833d4ff8326d2a0e97e6-76bbb6c837339a1dcc32c65817f4f72a97743228\""}, "total_comments_and_activity": 16, "related_features": {}, "information_type_data": {"PUBLIC": {"is_private": false, "name": "Public", "order": 0, "description": "Everyone can see this information.\n", "value": "PUBLIC", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"is_private": true, "name": "Private Security", "order": 2, "description": "Only the security group can see this information.\n ", "value": "PRIVATESECURITY", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"is_private": false, "name": "Public Security", "order": 1, "description": "Everyone can see this security related information.\n", "value": "PUBLICSECURITY", "description_css_class": "choice-description"}, "USERDATA": {"is_private": true, "name": "Private", "order": 3, "description": "Only shared with users permitted to see private user information.\n", "value": "USERDATA", "description_css_class": "choice-description"}}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/hplip/+bug/809904", "web_link": "https://bugs.launchpad.net/hplip/+bug/809904", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/809904", "milestone_link": null, "status": "Fix Released", "importance": "High", "assignee_link": "https://bugs.launchpad.net/api/devel/~sanjay-kumar14", "bug_target_display_name": "HPLIP", "bug_target_name": "hplip", "bug_watch_link": null, "date_assigned": "2011-08-16T10:40:49.079144+00:00", "date_created": "2011-07-13T14:16:02.160232+00:00", "date_confirmed": "2011-08-19T11:32:08.917927+00:00", "date_incomplete": null, "date_in_progress": "2011-08-19T11:32:22.994092+00:00", "date_closed": "2011-10-05T08:26:48.913823+00:00", "date_left_new": "2011-08-16T10:40:43.268556+00:00", "date_triaged": "2011-08-19T11:32:22.994092+00:00", "date_fix_committed": "2011-08-19T11:32:22.994092+00:00", "date_fix_released": "2011-10-05T08:26:48.913823+00:00", "date_left_closed": "2011-08-19T11:32:08.917927+00:00", "owner_link": "https://bugs.launchpad.net/api/devel/~jsmeix", "target_link": "https://bugs.launchpad.net/api/devel/hplip", "title": "Bug #809904 in HPLIP: \"insecure tmp file handling in hpcupsfax.cpp\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/hplip/+bug/809904/related_tasks", "is_complete": true, "http_etag": "\"6618b202c0d6a9ec70405281c8de1de83204a8f4-50481f88c46ed573f57c090fbb28885aa29b1fdd\""}, "bugtask_data": {"954763": {"delete_link": "https://bugs.launchpad.net/hplip/+bug/809904/+delete", "bug_title": "insecure tmp file handling in hpcupsfax.cpp", "user_can_unassign": false, "importance_value": "High", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary954763", "target_is_product": true, "user_can_edit_milestone": false, "prefix": "hplip", "bugtask_path": "/hplip/+bug/809904", "id": 954763, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task954763", "targetname": "HPLIP", "assignee_is_team": false, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": "sanjay-kumar14", "status_value": "Fix Released"}}, "subscribers_portlet_url_data": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/809904", "web_link": "https://bugs.launchpad.net/bugs/809904"}, "initial_comment_batch_offset": 41, "first visible_recent_comment": -33};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 56 queries/external actions issued in 0.73 seconds

    Features: {'app.maintenance_message': None, 'hard_timeout': '9000', 'js.yui_version': None, 'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'baselayout.careers_link.disabled': None, 'bugs.affected_count_includes_dupes.disabled': None, 'visible_render_time': None, 'profiling.enabled': None, 'bugs.nominations.bug_supervisors_can_target': 'on'}

    r0d8de2b

    -->

</html>

