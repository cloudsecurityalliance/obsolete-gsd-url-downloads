
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>
Issue 17997: ssl.match_hostname(): sub string wildcard should not match IDNA prefix - Python tracker

</title>
<link rel="shortcut icon" href="@@file/favicon.ico" />
<link rel="stylesheet" type="text/css" href="@@file/main.css" />
<link rel="stylesheet" type="text/css" href="@@file/style.css" />
<link rel="search" type="application/opensearchdescription+xml" href="@@file/osd.xml" title="Python bug tracker search" />
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script nonce="88c06a635563d34e2d420de54061dda7287cc7e90a67f7c7a86f7af23ef549bd" type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        return false;
    }
    submitted = true;
    return true;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://bugs.python.org/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
    HelpWin.focus ()
}
</script>


<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.js"></script>
<script type="text/javascript" src="@@file/issue.item.js"></script>
<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" />


</head>
<body>
  <!--  Logo  -->
  <h1 id="logoheader">
    <a accesskey="1" href="." id="logolink">
       <img src="@@file/python-logo.gif" alt="homepage" border="0" id="logo" /></a>
  </h1>

<div id="utility-menu">
<!-- Search Box -->
<div id="searchbox">
    <form name="searchform" method="get" action="issue" id="searchform">
      <div id="search">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignee,status,type" />
       <input type="hidden" name="@sort" value="-activity" />
       <input type="hidden" name="@filter" value="status" />
       <input type="hidden" name="@action" value="searchid" />
       <input type="hidden" name="ignore" value="file:content" />
       <input class="input-text" id="search-text"
              name="@search_text" size="10" />
       <input type="submit" id="submit" value="search" name="submit" class="input-button" />
       <input type="radio" name="status"
              id="status_notresolved" value="-1,1,3" />
       <label for="status_notresolved">open</label>
       <input type="radio" name="status" checked="checked"
              id="status_all" value="-1,1,2,3" />
       <label for="status_all">all</label>
      </div>
     </form>
</div>
</div>


<div id="left-hand-navigation">
<!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
<div id="menu">
  <ul class="level-one">
    <li><a href="https://www.python.org/" title="Go to the Python homepage">Python Home</a></li>
    <li><a href="https://www.python.org/about/" title="About The Python Language">About</a></li>
    <li><a href="https://www.python.org/blogs/" title="">News</a></li>
    <li><a href="https://www.python.org/doc/" title="">Documentation</a></li>
    <li><a href="https://www.python.org/downloads/" title="">Downloads</a></li>
    <li><a href="https://www.python.org/community/" title="">Community</a></li>
    <li><a href="https://www.python.org/psf/" title="Python Software Foundation">Foundation</a></li>
    <li><a href="https://devguide.python.org/" title="Python Developer's Guide">Developer's Guide</a></li>
    <li class="selected"><a href="." class="selected" title="Python Issue Tracker">Issue Tracker</a>
      <ul class="level-two">
        <li>
          <strong>Issues</strong>
          <ul class="level-three">
            
            <li><a href="issue?@template=search&amp;status=1">Search</a></li>
            <li><a href="issue?@action=random">Random Issue</a></li>
            <li>
              <form method="post" action="issue17997">
                <input type="submit" class="form-small"
                       value="Show issue:" />
                <input class="form-small" size="4" type="text" name="@number" />
                <input type="hidden" name="@type" value="issue" />
                <input type="hidden" name="@action" value="show" />
              </form>
            </li>
          </ul>
        </li>


        <li>
          <strong>Summaries</strong>
          <ul class="level-three">
            

            

            

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Issues%20with%20patch&amp;@startwith=0&amp;@group=priority&amp;keywords=2&amp;@action=search&amp;@filter=&amp;@pagesize=50">Issues with patch</a>
            </li>

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Easy%20issues&amp;@startwith=0&amp;@group=priority&amp;keywords=6&amp;@action=search&amp;@filter=&amp;@pagesize=50">Easy issues</a>
            </li>

            <li>
              <a href="issue?@template=stats">Stats</a>
            </li>

          </ul>
        </li>


        <li>
          <strong>User</strong>
          <form method="post" action="issue17997">
          <ul class="level-three">
            <li>
                Login&nbsp;(OpenID&nbsp;possible)<br />
	         <a style="display:inline;width:0;margin:0"
             href="issue17997?@action=oic_login&amp;provider=Google">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.google.com/favicon.ico"
                       alt="Google" title="Google" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue17997?@action=oic_login&amp;provider=GitHub">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.github.com/favicon.ico"
                       alt="GitHub" title="GitHub" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue17997?@action=openid_login&amp;provider=Launchpad">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://launchpad.net/favicon.ico"
                       alt="Launchpad" title="Launchpad" /></a>
                <input size="10" name="openid_identifier" style="background:url(@@file/openid-16x16.gif)
                  center left no-repeat;padding-left:16px" /><br />
                <input size="10" type="password" name="__login_password" /><br />
                <input type="hidden" name="@action" value="Login" />
                <input type="checkbox" name="remember" id="remember" />
                <label for="remember">Remember me?</label><br />
                <input class="form-small" type="submit"
                       value="Login" /><br />
                <input type="hidden" name="__came_from"
                       value="https://bugs.python.org/issue17997?">
                
                <input type="hidden" name="@sort" value=""/>
<input type="hidden" name="@group" value=""/>
<input type="hidden" name="@pagesize" value="50"/>
<input type="hidden" name="@startwith" value="0"/>
            </li>
            <li>
                <a href="user?@template=register">Register</a>
            </li>
            <li><a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a></li>
          </ul>
          </form>
        </li>

        

        

        <li>
          <strong>Administration</strong>
          <ul class="level-three">
            
            <li>
                <a href="user?@sort=username">User List</a></li>
            <li>
                <a href="user?iscommitter=1&amp;@action=search&amp;@sort=username&amp;@pagesize=300">Committer List</a></li>
            
            
            
          </ul>
        </li>

        <li>
          <strong>Help</strong>
          <ul class="level-three">
            <li><a href="http://docs.python.org/devguide/triaging.html">
                Tracker Documentation</a></li>
            <li><a href="http://wiki.python.org/moin/TrackerDevelopment">
                Tracker Development</a></li>
            <li><a href="https://github.com/python/psf-infra-meta/issues">
                Report Tracker Problem</a></li>
          </ul>
        </li>

      </ul>
    </li>
  </ul>
</div> <!-- menu -->
</div> <!-- left-hand-navigation -->

<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb">
 
 
 Issue17997
 
</div>
 
 





<div>

<form method="post" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue17997">

<fieldset><legend>classification</legend>
<table class="form">
<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#title" target="_blank">Title</a>:</th>
 
 <td colspan="3">
  <span>ssl.match_hostname(): sub string wildcard should not match IDNA prefix</span>
  <input type="hidden" name="title"
         value="ssl.match_hostname(): sub string wildcard should not match IDNA prefix">
 </td>
</tr>

<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#type" target="_blank">Type</a>:</th>
 <td>security</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#stage" target="_blank">Stage</a>:</th>
 <td>patch review</td>
</tr>

<tr>
 <th><a href="http://docs.python.org/devguide/triaging.html#components" target="_blank">Components</a>:</th>
 <td></td>
 <th><a href="http://docs.python.org/devguide/triaging.html#versions" target="_blank">Versions</a>:</th>
 <td>Python 3.3, Python 3.4</td>
</tr>
</table>
</fieldset>

<fieldset><legend>process</legend>
<table class="form">
<tr>
  <th><a href="http://docs.python.org/devguide/triaging.html#status" target="_blank">Status</a>:</th>
  <td>closed</td>
  <th><a href="http://docs.python.org/devguide/triaging.html#resolution" target="_blank">Resolution</a>:</th>
  <td>fixed</td>
</tr>

<tr>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#dependencies"
       target="_blank">Dependencies</a>:
 </th>
 <td>
  
  
 </td>
 <th><a href="http://docs.python.org/devguide/triaging.html#superseder" target="_blank">Superseder</a>:</th>
 <td>
  
 
 </td>
 </tr>
 <tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#assigned-to"
      target="_blank">Assigned To</a>:
 </th>
 
 <td>
  
 </td>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#nosy-list"
      target="_blank">Nosy List</a><!--
        <span tal:condition="context/nosy_count" tal:replace="python: ' (%d)' % context.nosy_count" /> -->:
 </th>
 <td>
     Arfrever, Ben.Darnell, BreamoreBoy, a.badger, barry, christian.heimes, georg.brandl, jwilk, larry, loewis, pitrou, python-dev, t-8ch
     
 </td>
</tr>
<tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#priority"
      target="_blank">Priority</a>:
 </th>
 <td>release blocker</td>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#keywords"
       target="_blank">Keywords</a>:
 </th>
 <td>patch</td>


</tr>









</table>
</fieldset>

</form>

<p>Created on <strong>2013-05-17 14:04</strong> by <strong>christian.heimes</strong>, last changed <strong>2014-09-30 12:49</strong> by <strong>georg.brandl</strong>. This issue is now <strong style="color:#00F; background-color:inherit;">closed</strong>.</p>

<table class="files">
 <tr><th colspan="5" class="header">Files</th></tr>
 <tr>
  <th>File name</th>
  <th>Uploaded</th>
  <th>Description</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td>
   <a href="file31245/match_hostname_RFC6125.patch">match_hostname_RFC6125.patch</a>
  </td>
  <td>
   <span>christian.heimes</span>,
   <span>2013-08-12 12:47</span>
  </td>
  <td></td>
  <td>
      
      <a href="/review/17997/#ps8893">review</a>
      
  </td>
 </tr>
</table>







<table class="messages">
 <tr><th colspan="4" class="header">Messages (16)</th></tr>
 
  <tr>
    <th>
     <a href="#msg189454" id="msg189454">msg189454</a> - <a
    href="msg189454">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-05-17 14:04</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Python's ssl.match_hostname() does sub string matching as specified in RFC 2818:

   Names may contain the wildcard
   character * which is considered to match any single domain name
   component or component fragment. E.g., *.a.com matches foo.a.com but
   not bar.foo.a.com. f*.com matches foo.com but not bar.com.

The RFC doesn't specify how internationalized domain names shoould be handled because it predates RFC 5890 for IDNA by many year. IDNA are prefixed with "xn--", e.g. u"götter.example.de".encode("idna") == 
"xn--gtter-jua.example.de". This can result into false positive matches for a rule like "x*.example.de".

Chrome has special handling for IDN prefix in X509Certificate::VerifyHostname()
<a href="http://src.chromium.org/viewvc/chrome/trunk/src/net/cert/x509_certificate.cc">http://src.chromium.org/viewvc/chrome/trunk/src/net/cert/x509_certificate.cc</a>

Also see <a class="closed" title="[closed] CVE-2013-2099 ssl.match_hostname() trips over crafted	wildcard names" href="issue17980">#17980</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg189514" id="msg189514">msg189514</a> - <a
    href="msg189514">(view)</a></th>
   <th>Author: Antoine Pitrou (pitrou) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-05-18 14:10</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Actually, I don't this is a bug: match_hostname() expects str data, and therefore IDNA-decoded domain names:

&gt;&gt;&gt; b"xn--gtter-jua.example.de".decode("idna")
'götter.example.de'

Doing the matching on the decoded domain name should be safe.
Then it very much depends on whether the data you've got was IDNA-decoded, or naïvely ASCII-decoded, and I don't think the Python stdlib is very consistent here. Looking at the socket module, gethostbyaddr and getnameinfo seem to use ASCII decoding...</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg189516" id="msg189516">msg189516</a> - <a
    href="msg189516">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-05-18 14:35</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>It's called "internationalized domain name for APPLICATIONS". ;) It's up to the application to interpret the ASCII text as IDNA encoded FQDNs. As far as I know DNS, SSL's CNAME and OS interfaces etc. always use ASCII labels. It's an elegant solution. Just the UI part of an application needs to understand IDNA. 

<a href="http://tools.ietf.org/html/rfc6125#section-6.4.2">http://tools.ietf.org/html/rfc6125#section-6.4.2</a>

   If the DNS domain name portion of a reference identifier is an
   internationalized domain name, then an implementation MUST convert
   any U-labels [IDNA-DEFS] in the domain name to A-labels before
   checking the domain name.  In accordance with [IDNA-PROTO], A-labels
   MUST be compared as case-insensitive ASCII.  Each label MUST match in
   order for the domain names to be considered to match, except as
   supplemented by the rule about checking of wildcard labels
   (Section 6.4.3; but see also Section 7.2 regarding wildcards in
   internationalized domain names).


Coincidentally the same RFC contains matching rules for wild card certs 
<a href="http://tools.ietf.org/html/rfc6125#section-6.4.3">http://tools.ietf.org/html/rfc6125#section-6.4.3</a>

   If a client matches the reference identifier against a presented
   identifier whose DNS domain name portion contains the wildcard
   character '*', the following rules apply:

   1.  The client SHOULD NOT attempt to match a presented identifier in
       which the wildcard character comprises a label other than the
       left-most label (e.g., do not match bar.*.example.net).

   2.  If the wildcard character is the only character of the left-most
       label in the presented identifier, the client SHOULD NOT compare
       against anything but the left-most label of the reference
       identifier (e.g., *.example.com would match foo.example.com but
       not bar.foo.example.com or example.com).

   3.  The client MAY match a presented identifier in which the wildcard
       character is not the only character of the label (e.g.,
       baz*.example.net and *baz.example.net and b*z.example.net would
       be taken to match baz1.example.net and foobaz.example.net and
       buzz.example.net, respectively).  However, the client SHOULD NOT
       attempt to match a presented identifier where the wildcard
       character is embedded within an A-label or U-label [IDNA-DEFS] of
       an internationalized domain name [IDNA-PROTO].</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg189527" id="msg189527">msg189527</a> - <a
    href="msg189527">(view)</a></th>
   <th>Author: Antoine Pitrou (pitrou) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-05-18 16:02</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>&gt; It's called "internationalized domain name for APPLICATIONS". ;) It's 
&gt; up to the application to interpret the ASCII text as IDNA encoded
&gt; FQDNs. As far as I know DNS, SSL's CNAME and OS interfaces etc. always 
&gt; use ASCII labels. It's an elegant solution. Just the UI part of an
&gt; application needs to understand IDNA. 

The socket module already decodes to/encodes from IDNA in places (e.g. gethostname()). We need a consistent policy in the stdlib; I would like Martin's advice on this.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg189909" id="msg189909">msg189909</a> - <a
    href="msg189909">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-05-24 13:09</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I finally found the correct RFC for wildcard matching. I think our implementation violates some recommendations.

<a href="http://tools.ietf.org/html/rfc6125#section-6.4.2">http://tools.ietf.org/html/rfc6125#section-6.4.2</a>
<a href="http://tools.ietf.org/html/rfc6125#section-6.4.3">http://tools.ietf.org/html/rfc6125#section-6.4.3</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg189928" id="msg189928">msg189928</a> - <a
    href="msg189928">(view)</a></th>
   <th>Author: Martin v. Löwis (loewis) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-05-24 20:23</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>As a policy, the standard library should accept non-ASCII host names ("U-labels") wherever possible. I.e the hostname parameter of match_hostname should allow for U-labels (as well as A-labels).

When returning names, it should always return the data "as-is", which typically means A-labels. Anybody wanting to display U-labels will need to decode them explicitly.

I believe that the matching of IDNA names doesn't currently happen according to 6.4.2 of RFC 6125, however, this is not actually the issue that Christian reported (which was only about wildcard matching). I suggest to create a separate issue for that.

As for 6.4.3: I find the text to be quite ill-formulated. Specifically, I'm referring to the sentence

       However, the client SHOULD NOT
       attempt to match a presented identifier where the wildcard
       character is embedded within an A-label or U-label [IDNA-DEFS] of
       an internationalized domain name [IDNA-PROTO].

First, in the context of X.509, a wildcard *cannot* be embedded "with an ... U-label"; the certificate can only possibly contain A-labels (because the datatype of dNSName is IA5String).

Second, as written, it *does* allow to match 'götter.example.de' against "x*.example.de", since "x*.example.de" is not an A-label. An A-label is defined as

       An "A-label" is the ASCII-Compatible Encoding (ACE, see
      Section 2.3.2.5) form of an IDNA-valid string.  It must be a
      complete label: IDNA is defined for labels, not for parts of them
      and not for complete domain names.  This means, by definition,
      that every A-label will begin with the IDNA ACE prefix, "xn--"
      (see Section 2.3.2.5), followed by a string that is a valid output
      of the Punycode algorithm [RFC3492] and hence a maximum of 59
      ASCII characters in length.  The prefix and string together must
      conform to all requirements for a label that can be stored in the
      DNS including conformance to the rules for LDH labels
      (Section 2.3.1).  If and only if a string meeting the above
      requirements can be decoded into a U-label is it an A-label.

Since an A-label is required to conform to the LDH label syntax, it cannot possibly contain the asterisk (LDH labels can only contain letters, digits, and the hyphen. Hence, the entire requirement is irrelevant (as literally written). They might mean something else, but I cannot guess what it is that they mean.

I disagree with the classification of this issue as critical. It does not involve a crash, a serious regression, or a breakage of a very important API.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg194950" id="msg194950">msg194950</a> - <a
    href="msg194950">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-08-12 12:47</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Ryan Sleevi of the Google Chrome Security Team has informed us about another issue that is caused by our failure to implement RFC 6125 wildcard matching rules. RFC 6125 allows only one wildcard in the left-most fragment of a hostname. For security reasons matching rules like *.*.com should be not supported.

For wildcards in internationalized domain names I have followed  	the piece of advice "In the face of ambiguity, refuse the temptation to guess.". A substring wildcard does no longer match an IDN A-label fragment. '*' still matches a full punycode fragment but 'x*' no longer matches 'xn--foo'. I copied the idea from Chrome's matching code:

<a href="http://src.chromium.org/viewvc/chrome/trunk/src/net/cert/x509_certificate.cc?revision=212341#l640">http://src.chromium.org/viewvc/chrome/trunk/src/net/cert/x509_certificate.cc?revision=212341#l640</a>

        // * must not match a substring of an IDN A label; just a whole fragment.
        if (reference_host.starts_with("xn--") &amp;&amp;
        !(pattern_begin.empty() &amp;&amp; pattern_end.empty()))
        continue;

The relevant RFC section for the patch are

  <a href="http://tools.ietf.org/html/rfc6125#section-6.4.3">http://tools.ietf.org/html/rfc6125#section-6.4.3</a>
  <a href="http://tools.ietf.org/html/rfc2818#section-3.1">http://tools.ietf.org/html/rfc2818#section-3.1</a>
  <a href="http://tools.ietf.org/html/rfc2459#section-4.2.1.7">http://tools.ietf.org/html/rfc2459#section-4.2.1.7</a>
  <a href="http://tools.ietf.org/html/rfc5280#section-7">http://tools.ietf.org/html/rfc5280#section-7</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg195058" id="msg195058">msg195058</a> - <a
    href="msg195058">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-08-13 09:10</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Affected versions:

- Python 3.2 (&lt; 3.2.5)
- Python 3.3 (&lt; 3.3.3)
- Python 3.4a1
- requests &lt; 1.2.3
<a href="https://pypi.python.org/pypi/requests">https://pypi.python.org/pypi/requests</a>
- backports.ssl_match_hostname (&lt;3.2a3)
<a href="https://pypi.python.org/pypi/backports.ssl_match_hostname/">https://pypi.python.org/pypi/backports.ssl_match_hostname/</a>
- urllib3 &lt; 1.6
<a href="https://github.com/shazow/urllib3">https://github.com/shazow/urllib3</a>
- bzr
- setuptools
- tornado
- pip</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg196823" id="msg196823">msg196823</a> - <a
    href="msg196823">(view)</a></th>
   <th>Author: Toshio Kuratomi (a.badger) <span title="Contributor form received">*</span></th>
   <th>Date: 2013-09-03 03:59</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>So, is this a security issue?  I've been wondering if I should apply the attached patch to the backports-ssl_match_hostname module on pypi.  I was hoping there'd be some information here as to whether this will be going into the stdlib in the future.

Thus far, ssl_match_hostname has just been a backport of the match_hostname function but if this is a security problem, I could press for us to diverge from the python3 stdlib.  It would be easier to make the case if this is seen as a critical problem that will need to be fixed even if the current patch might not be the eventual fix.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg200724" id="msg200724">msg200724</a> - <a
    href="msg200724">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-10-21 08:54</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Yes, it's a security issue. But the patch would changes the behavior of the function. The current function conforms to RFC 2818. The patch implements RFC 6125, which is more restrictive.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg201422" id="msg201422">msg201422</a> - <a
    href="msg201422">(view)</a></th>
   <th>Author: Roundup Robot (python-dev) <img src="@@file/triager.png" title="Python triager" alt="(Python triager)" /></th>
   <th>Date: 2013-10-27 06:38</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>New changeset <a href="https://hg.python.org/lookup/10d0edadbcdd">10d0edadbcdd</a> by Georg Brandl in branch '3.3':
Issue <a class="closed" title="[closed] ssl.match_hostname(): sub string wildcard should not match IDNA prefix" href="issue17997">#17997</a>: Change behavior of ``ssl.match_hostname()`` to follow RFC 6125,
<a href="http://hg.python.org/cpython/rev/10d0edadbcdd">http://hg.python.org/cpython/rev/10d0edadbcdd</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg201431" id="msg201431">msg201431</a> - <a
    href="msg201431">(view)</a></th>
   <th>Author: Georg Brandl (georg.brandl) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-10-27 06:46</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Also merged to default.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg203159" id="msg203159">msg203159</a> - <a
    href="msg203159">(view)</a></th>
   <th>Author: Christian Heimes (christian.heimes) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2013-11-17 14:08</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Python 3.2 hasn't been fixed yet.

Should acquire a CVE for the issue?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg207172" id="msg207172">msg207172</a> - <a
    href="msg207172">(view)</a></th>
   <th>Author: Martin v. Löwis (loewis) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2014-01-02 16:44</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Just to clarify the status of this issue: it *only* blocks 3.2.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg222211" id="msg222211">msg222211</a> - <a
    href="msg222211">(view)</a></th>
   <th>Author: Mark Lawrence (BreamoreBoy) <span title="Contributor form received">*</span></th>
   <th>Date: 2014-07-03 20:23</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>For future reference how do I find out if this has been applied to 3.2?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg227895" id="msg227895">msg227895</a> - <a
    href="msg227895">(view)</a></th>
   <th>Author: Georg Brandl (georg.brandl) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2014-09-30 12:49</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Since it's been out in 3.2.x for so long, I won't apply this for 3.2 since at this point a behavior change might do more harm than good.</pre>
   </td>
  </tr>
 
</table>

<table class="history table table-condensed table-striped"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2014-09-30&nbsp;12:49:13</td><td>georg.brandl</td><td>set</td><td>status: open -> closed<br />resolution: fixed<br />messages:
  + <a rel="nofollow" href="msg227895">msg227895</a><br /><br />versions:
  + Python 3.3, Python 3.4, - Python 3.2</td></tr>
<tr><td>2014-07-03&nbsp;20:23:01</td><td>BreamoreBoy</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user12545">BreamoreBoy</a><br />messages:
  + <a rel="nofollow" href="msg222211">msg222211</a><br /></td></tr>
<tr><td>2014-02-23&nbsp;20:43:47</td><td>jwilk</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user4692">jwilk</a><br /></td></tr>
<tr><td>2014-01-02&nbsp;21:26:49</td><td>loewis</td><td>set</td><td>priority: normal -> release blocker</td></tr>
<tr><td>2014-01-02&nbsp;16:44:07</td><td>loewis</td><td>set</td><td>priority: release blocker -> normal<br /><br />messages:
  + <a rel="nofollow" href="msg207172">msg207172</a></td></tr>
<tr><td>2013-11-17&nbsp;14:08:01</td><td>christian.heimes</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg203159">msg203159</a></td></tr>
<tr><td>2013-10-27&nbsp;06:46:18</td><td>georg.brandl</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg201431">msg201431</a><br />versions:
  - Python 3.3, Python 3.4</td></tr>
<tr><td>2013-10-27&nbsp;06:38:42</td><td>python-dev</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user13902">python-dev</a><br />messages:
  + <a rel="nofollow" href="msg201422">msg201422</a><br /></td></tr>
<tr><td>2013-10-21&nbsp;08:54:40</td><td>christian.heimes</td><td>set</td><td>priority: normal -> release blocker<br />nosy:
  + <a rel="nofollow" href="user2731">larry</a>, <a rel="nofollow" href="user93">georg.brandl</a><br />messages:
  + <a rel="nofollow" href="msg200724">msg200724</a><br /><br /></td></tr>
<tr><td>2013-09-03&nbsp;03:59:24</td><td>a.badger</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user9047">a.badger</a><br />messages:
  + <a rel="nofollow" href="msg196823">msg196823</a><br /></td></tr>
<tr><td>2013-08-27&nbsp;19:26:40</td><td>t-8ch</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user18283">t-8ch</a><br /></td></tr>
<tr><td>2013-08-13&nbsp;09:10:05</td><td>christian.heimes</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg195058">msg195058</a></td></tr>
<tr><td>2013-08-13&nbsp;03:46:44</td><td>Ben.Darnell</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user13997">Ben.Darnell</a><br /></td></tr>
<tr><td>2013-08-12&nbsp;13:27:38</td><td>barry</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user19">barry</a><br /></td></tr>
<tr><td>2013-08-12&nbsp;12:47:57</td><td>christian.heimes</td><td>set</td><td>files:
  + <a rel="nofollow" href="file31245">match_hostname_RFC6125.patch</a><br />versions:
  + Python 3.2<br />messages:
  + <a rel="nofollow" href="msg194950">msg194950</a><br /><br />keywords:
  + <a rel="nofollow" href="keyword2">patch</a><br />stage: needs patch -> patch review</td></tr>
<tr><td>2013-05-25&nbsp;10:50:29</td><td>pitrou</td><td>set</td><td>priority: critical -> normal</td></tr>
<tr><td>2013-05-24&nbsp;20:23:20</td><td>loewis</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg189928">msg189928</a></td></tr>
<tr><td>2013-05-24&nbsp;13:09:31</td><td>christian.heimes</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg189909">msg189909</a></td></tr>
<tr><td>2013-05-18&nbsp;16:02:30</td><td>pitrou</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user8">loewis</a><br />messages:
  + <a rel="nofollow" href="msg189527">msg189527</a><br /></td></tr>
<tr><td>2013-05-18&nbsp;14:35:44</td><td>christian.heimes</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg189516">msg189516</a></td></tr>
<tr><td>2013-05-18&nbsp;14:10:30</td><td>pitrou</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg189514">msg189514</a></td></tr>
<tr><td>2013-05-18&nbsp;07:12:30</td><td>Arfrever</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user9138">Arfrever</a><br /></td></tr>
<tr><td>2013-05-17&nbsp;14:04:53</td><td>christian.heimes</td><td>create</td><td></td></tr>
</table>

</div>


</div> <!-- content-body -->
<div id="footer">
<div id="credits">
  Hosted on <a href="https://m.do.co/c/783434964889" title="Hosted on DigitalOcean">DigitalOcean</a>,
  <br>
  Supported by <a href="https://python.org/psf-landing/" title="The Python Software Foundation">The Python Software Foundation</a>,
  <br>
  Powered by <a href="http://roundup.sourceforge.net" title="Powered by the Roundup Issue Tracker">Roundup</a>
</div> <!-- credits -->
Copyright &copy; 1990-2020, <a href="http://python.org/psf">Python Software Foundation</a><br />
<a href="http://python.org/about/legal">Legal Statements</a>
</div> <!-- footer -->
</div> <!-- body-main -->
</div> <!-- content -->



</body>
</html>

