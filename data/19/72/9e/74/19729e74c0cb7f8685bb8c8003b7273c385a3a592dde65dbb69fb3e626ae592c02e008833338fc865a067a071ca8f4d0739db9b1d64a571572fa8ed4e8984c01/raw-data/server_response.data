<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1240290 - (CVE-2019-11755) Susceptibility to S/MIME Message Takeover Attacks">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1240290">
<meta property="og:description"
      content="RESOLVED (kaie) in MailNews Core - Security: S/MIME. Last updated 2020-08-08.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1240290 - (CVE-2019-11755) Susceptibility to S/MIME Message Takeover Attacks</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1240290&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1240290">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1240290">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/yui.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/global.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/util.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"flags\":{\"project\":{\"cf_tracking_firefox_sumo\":\"---\"},\"tracking\":{\"cf_tracking_thunderbird_93\":\"---\",\"cf_status_seamonkey257esr\":\"---\",\"cf_tracking_seamonkey257esr\":\"---\",\"cf_tracking_seamonkey253\":\"---\",\"cf_tracking_thunderbird_95\":\"---\",\"cf_status_thunderbird_71\":\"fixed\",\"cf_status_thunderbird_esr68\":\"fixed\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_94\":\"---\",\"cf_tracking_thunderbird_esr68\":\"69+\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_thunderbird_70\":\"fixed\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_94\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_thunderbird_95\":\"---\",\"cf_status_seamonkey253\":\"---\",\"cf_status_thunderbird_93\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1240290;
  BUGZILLA.bug_title = '1240290 - (CVE-2019-11755) Susceptibility to S\/MIME Message Takeover Attacks';
  BUGZILLA.bug_summary = 'Susceptibility to S\/MIME Message Takeover Attacks';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1240290';
  BUGZILLA.bug_keywords = 'csectype-spoof, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/field.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/comments.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1240290">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1240290"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1240290 - (CVE-2019-11755) Susceptibility to S/MIME Message Takeover Attacks">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="tZCNqpV9LOvYrLnO3sXUqYTTIu95vkX5EM9AqUL8S3FlkTiRgprjGxoT0GmylOKcI0iJnZmNdeOJQVTvMiUcuadqZjmXuffAT9NiKcX8VlFKhxiH5IjNu1uCGrTqGXKY0EijvUGnq6Zmqzgbo8MQWQym36Ic6ol7ycL604yCavthoCBn8a8tdhUq9yN2WtvpnbMpP1l29rQF2T36EIJRrMXInSIXC57ChK4knR9qj6xJNVNYUOK647XcOvRqLQyV">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1240290" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622875-TxPOnOGlsYVtQVpii2LBbYpQYfjuEvhp5bVOVry5DqE">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1240290" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1240290" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1240290">Bug 1240290</a>
          <span class="edit-hide">(CVE-2019-11755)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2016-01-16 06:31 PST" data-time="1452954660">6 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2019-09-19 15:58 PDT" data-time="1568933930">2 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Susceptibility to S/MIME Message Takeover Attacks</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Susceptibility to S/MIME Message Takeover Attacks

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (MailNews Core :: Security: S/MIME, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=MailNews%20Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">MailNews Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">MailNews Core</div>
            <div class="description">Mail and news components common to Thunderbird and SeaMonkey</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=MailNews%20Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="MailNews Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=MailNews%20Core&component=Security%3A%20S%2FMIME#Security%3A%20S%2FMIME" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Security: S/MIME
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">MailNews Core :: Security: S/MIME</div>
            <div class="description">S/MIME is the sending of signed and/or encrypted email.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;component=Security%3A%20S%2FMIME&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;component=Security%3A%20S%2FMIME&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=MailNews%20Core&amp;component=Security%3A%20S%2FMIME"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="MailNews Core" data-component="Security: S/MIME"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (thunderbird_esr6869+ fixed, thunderbird70 fixed, thunderbird71 fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            Thunderbird 71.0

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird_esr68</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr68&amp;o1=equals&amp;v1=69%2B">69+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_esr68&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird70</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_70&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird71</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_71&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr68</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr68-dirty">
  <select id="cf_tracking_thunderbird_esr68" name="cf_tracking_thunderbird_esr68">
        <option value="69+"
          id="v4419_cf_tracking_thunderbird_esr68" selected
        >69+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr68-dirty">
  <select id="cf_status_thunderbird_esr68" name="cf_status_thunderbird_esr68">
        <option value="fixed"
          id="v4350_cf_status_thunderbird_esr68" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird70</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_70-dirty">
  <select id="cf_status_thunderbird_70" name="cf_status_thunderbird_70">
        <option value="fixed"
          id="v4447_cf_status_thunderbird_70" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird71</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_71-dirty">
  <select id="cf_status_thunderbird_71" name="cf_status_thunderbird_71">
        <option value="fixed"
          id="v4473_cf_status_thunderbird_71" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_93-dirty">
  <select id="cf_tracking_thunderbird_93" name="cf_tracking_thunderbird_93">
        <option value="---"
          id="v5262_cf_tracking_thunderbird_93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_93-dirty">
  <select id="cf_status_thunderbird_93" name="cf_status_thunderbird_93">
        <option value="---"
          id="v5256_cf_status_thunderbird_93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_94-dirty">
  <select id="cf_tracking_thunderbird_94" name="cf_tracking_thunderbird_94">
        <option value="---"
          id="v5300_cf_tracking_thunderbird_94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_94-dirty">
  <select id="cf_status_thunderbird_94" name="cf_status_thunderbird_94">
        <option value="---"
          id="v5304_cf_status_thunderbird_94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_95-dirty">
  <select id="cf_tracking_thunderbird_95" name="cf_tracking_thunderbird_95">
        <option value="---"
          id="v5332_cf_tracking_thunderbird_95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_95-dirty">
  <select id="cf_status_thunderbird_95" name="cf_status_thunderbird_95">
        <option value="---"
          id="v5326_cf_status_thunderbird_95" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">seamonkey2.53</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_seamonkey253-dirty">
  <select id="cf_tracking_seamonkey253" name="cf_tracking_seamonkey253">
        <option value="---"
          id="v3334_cf_tracking_seamonkey253" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_seamonkey253-dirty">
  <select id="cf_status_seamonkey253" name="cf_status_seamonkey253">
        <option value="---"
          id="v3338_cf_status_seamonkey253" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">seamonkey2.57esr</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_seamonkey257esr-dirty">
  <select id="cf_tracking_seamonkey257esr" name="cf_tracking_seamonkey257esr">
        <option value="---"
          id="v3594_cf_tracking_seamonkey257esr" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_seamonkey257esr-dirty">
  <select id="cf_status_seamonkey257esr" name="cf_status_seamonkey257esr">
        <option value="---"
          id="v3588_cf_status_seamonkey257esr" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: fstrenzke, Assigned: KaiE)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_36541" ><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=36541" > <span class="fna">KaiE</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_560895" ><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=560895" > <span class="fna">fstrenzke</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-triage_owner" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            ---

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="32">32 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Regressed 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list" id="field-regresses"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_REOPENED"
   title="REOPENED - Attachments missed from complex MIME (posta certificata)"
   href="/show_bug.cgi?id=1607872">1607872</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - TB crashes during opening s/mime signed mail from mailman mailinglist"
   href="/show_bug.cgi?id=1611105">CVE-2020-6795</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="task"
              aria-label="task" data-type="task">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1577448">1577448</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-spoof, sec-moderate, Whiteboard: [fixes an undetected scenario from efail][fixes handling of multiple layers])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2019-11755

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[fixes an undetected scenario from efail][fixes handling of multiple layers]
        </span>
    </div>

  
</div>

    

    

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a39495123_1689"
            class="rel-time-title activity-ref"
            title="6 years ago"
        data-time="1453311893"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1327071">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1327071-dirty">
      <select id="flag-1327071" name="flag-1327071"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch." for="flag_type-598">wanted-thunderbird</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-598-dirty">
      <select id="flag_type-598" name="flag_type-598"
        title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Include a summary of changes made by this bug in the release notes." for="flag_type-893">relnote</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-893-dirty">
      <select id="flag_type-893" name="flag_type-893"
        title="Include a summary of changes made by this bug in the release notes."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (10 files, 10 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8708683">thb_mta.pdf</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2016-01-16 06:31 PST" data-time="1452954660">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_560895" ><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div></span>
        </div>
        <div class="attach-info">148.24 KB,
          application/pdf        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8708683&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8710033">plaintext MIME after cutting off a signature accepted by TB as unsigned</a>
        </div>
        <div>
            <a href="#c7" class="attach-time activity-ref"><span class="rel-time" title="2016-01-20 09:57 PST" data-time="1453312628">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_560895" ><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div></span>
        </div>
        <div class="attach-info">17.88 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8710033&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8711692">An example where the attacker strips of the beginning of the email.</a>
        </div>
        <div>
            <a href="#c11" class="attach-time activity-ref"><span class="rel-time" title="2016-01-25 07:51 PST" data-time="1453737103">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_560895" ><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div></span>
        </div>
        <div class="attach-info">21.42 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8711692&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8903424">Forbid encrypt &amp; sign (outdated, crashes)</a>
        </div>
        <div>
            <a href="#c43" class="attach-time activity-ref"><span class="rel-time" title="2017-08-31 20:00 PDT" data-time="1504234820">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_286107" ><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div></span>
        </div>
        <div class="attach-info">74.50 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#a113794813_36541"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1566749473"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8903424&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8903424&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=8903424">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8905162">(for old patch) 1240290-crash.txt - crash on now profile with no certificates installed</a>
        </div>
        <div>
            <a href="#c46" class="attach-time activity-ref"><span class="rel-time" title="2017-09-06 11:10 PDT" data-time="1504721424">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_176914" ><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.50 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8905162&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8905166">(for old patch) 1240290-crash2.txt</a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2017-09-06 11:21 PDT" data-time="1504722118">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_176914" ><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.70 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8905166&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9077374">1240290-nss-testsuite.patch</a>
        </div>
        <div>
            <a href="#c67" class="attach-time activity-ref"><span class="rel-time" title="2019-07-11 05:45 PDT" data-time="1562849156">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">5.05 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9077374&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9077374&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9077374">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9077376">1240290-test-data.patch</a>
        </div>
        <div>
            <a href="#c68" class="attach-time activity-ref"><span class="rel-time" title="2019-07-11 05:48 PDT" data-time="1562849281">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">349.51 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9077376&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9077376&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9077376">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9087994">1240290-fix-v2.patch</a>
        </div>
        <div>
            <a href="#c70" class="attach-time activity-ref"><span class="rel-time" title="2019-08-25 09:08 PDT" data-time="1566749323">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">54.60 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9087994&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9087994&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9087994">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9087995">1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)</a>
        </div>
        <div>
            <a href="#c71" class="attach-time activity-ref"><span class="rel-time" title="2019-08-25 09:09 PDT" data-time="1566749395">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">9.93 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9087995&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9087995&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9087995">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9087996">1240290-test-data-v2.patch</a>
        </div>
        <div>
            <a href="#c72" class="attach-time activity-ref"><span class="rel-time" title="2019-08-25 09:10 PDT" data-time="1566749433">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">408.00 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9087996&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9087996&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9087996">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9088033">1240290-incremental-fix-for-scenario-7.patch</a>
        </div>
        <div>
            <a href="#c76" class="attach-time activity-ref"><span class="rel-time" title="2019-08-25 14:56 PDT" data-time="1566770177">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">18.37 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9088033&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9088033&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9088033">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9089015">1240290-fix-v3.patch</a>
        </div>
        <div>
            <a href="#c84" class="attach-time activity-ref"><span class="rel-time" title="2019-08-29 03:41 PDT" data-time="1567075315">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">69.50 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9089015&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9089015&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9089015">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9089016">1240290-fix-v4.patch</a>
        </div>
        <div>
            <a href="#c85" class="attach-time activity-ref"><span class="rel-time" title="2019-08-29 03:52 PDT" data-time="1567075925">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">64.92 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9089016&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9089016&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9089016">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9089345">1240290-fix-v5.patch</a>
        </div>
        <div>
            <a href="#c88" class="attach-time activity-ref"><span class="rel-time" title="2019-08-30 05:04 PDT" data-time="1567166650">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">64.28 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_101158" ><span class="fn">mkmelin</span>
</div>:
              <a href="#c89"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1567166650"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9089345&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9089345&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9089345">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9090421">1240290-fix-v5-plus-nits.patch</a>
        </div>
        <div>
            <a href="#c90" class="attach-time activity-ref"><span class="rel-time" title="2019-09-04 09:11 PDT" data-time="1567613508">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">47.54 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#c90"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1567613508"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9090421&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9090421&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090421">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9090661">1240290-fix-v6-comm-central.patch (merged context changes)</a>
        </div>
        <div>
            <a href="#c91" class="attach-time activity-ref"><span class="rel-time" title="2019-09-05 02:54 PDT" data-time="1567677255">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">48.12 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#c91"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1567677255"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c97"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1568931012"
            >
              approval-comm-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9090661&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9090661&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090661">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9090665">1240290-esr68-test-data.patch</a>
        </div>
        <div>
            <a href="#c92" class="attach-time activity-ref"><span class="rel-time" title="2019-09-05 03:05 PDT" data-time="1567677900">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">498.27 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c117"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1569315666"
            >
              approval-comm-esr68+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9090665&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9090665&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090665">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9090666">1240290-backport-esr68.patch</a>
        </div>
        <div>
            <a href="#c93" class="attach-time activity-ref"><span class="rel-time" title="2019-09-05 03:06 PDT" data-time="1567677992">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">48.41 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9090666&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9090666&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090666">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9093925">1240290-esr68-backport-v2.patch</a>
        </div>
        <div>
            <a href="#c94" class="attach-time activity-ref"><span class="rel-time" title="2019-09-19 08:02 PDT" data-time="1568905347">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">48.72 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c103"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1569002621"
            >
              approval-comm-esr68+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9093925&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9093925&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9093925">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="DxzxHsmp6vBax4D6pHhIqmypFhO4r4mdu8H25ziAtr92O2yT">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="11082366" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" ><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" ><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-16 06:31 PST" data-time="1452954660">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8708683"
         class="attachment"
         data-id="8708683" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="thb_mta.pdf">
      <meta itemprop="contentSize" content="151801">
      <meta itemprop="encodingFormat" content="application/pdf">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8708683" itemprop="contentUrl">
        <span id="att-8708683-description" itemprop="description">thb_mta.pdf</span></a>
        — <a href="attachment.cgi?id=8708683&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="11082366">User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:43.0) Gecko/20100101 Firefox/43.0
Build ID: 20160106234230

Steps to reproduce:

Thunderbird is susceptible to a new form of attack which builds on a flaw in the S/MIME standard. 

When Alice sends a signed-then-encrypted (standard format of today's mail clients) mail to Bob, Eve blocks that mail, strips off the signature, replaces it with her own signature and sends it to Bob. Bob now believes the message originates from Eve. If he replies, he potentially discloses information to Eve. Other attack goals are also feasible. See the attachment for details.


Actual results:

Thunderbird displayed the message as validly signed.


Expected results:

Display of an incorrect signature and suspected attack, with the urge not to respond to the email. Ideally, the contents of the mail are not even displayed.</pre></div><div class="change-set" id="a2280_560895"><div class="change" id="aa2280_560895">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a2280_560895"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_560895" id="a2280_560895"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2280_560895"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2280_560895">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a2280_560895">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-16 07:09 PST" data-time="1452956940">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">OS: Unspecified &rarr; Linux</div><div class="change">Hardware: Unspecified &rarr; x86_64</div></div></div><div class="change-set" id="a272317_1689"><div class="change" id="aa272317_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a272317_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a272317_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a272317_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a272317_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 10:09 PST" data-time="1453226977">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="11088241" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a272317_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 10:10 PST" data-time="1453227055">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="11088241">Richard and Kai: could you guys take a look at this crypto attack.</pre><div class="activity"><div class="change">Component: Security &rarr; Security: S/MIME</div><div class="change">Flags: needinfo?(rlb)</div><div class="change">Product: Thunderbird &rarr; MailNews Core</div><div class="change">Version: 38 Branch &rarr; unspecified</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="11089105" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a272317_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 13:49 PST" data-time="1453240151">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="11089105">I would like to see examples of the mangled resulting message to understand what measures to best take.

It is my opinion that we should only treat signed-then-encrypted messages as having the UI of signed and encrypted, with encrypted-then-signed being displayed as merely encrypted, although I'm not sure how well our current S/MIME code is at being able to control that level of information.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="11089152" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_373085" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/0f471505131b1c419602ba75cfa91397?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_373085" id="a272317_1689"><a class="email " href="/user_profile?user_id=373085" > <span class="fna">Richard Barnes [:rbarnes]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 13:58 PST" data-time="1453240694">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="11089152">Is the following an accurate summary of the attack?

1. Alice constructs Encrypt(Bob_pub, Sign(Alice_priv, message))
2. Eve recovers a slightly garbled message2 = Encrypt(Bob_pub, message) by stripping Alice's signature
3. Eve constructs Sign(Eve_priv, message2)
4. Thunderbird verifies Eve's signature over message2, and ignores the garbling on message2

In that case, I agree that this is a vulnerability, and I agree that we should disable encrypt-then-sign messages.  (That's been the best practice for years now, hasn't it!?)  I don't know the Thunderbird code base at all, so unfortunately I have no idea how to do this.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="11089158" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_373085" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/0f471505131b1c419602ba75cfa91397?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_373085" id="a272317_1689"><a class="email " href="/user_profile?user_id=373085" > <span class="fna">Richard Barnes [:rbarnes]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 13:58 PST" data-time="1453240734">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="11089158">I could live with displaying messages as encrypted-not-signed (vs. rejecting), but this seems like a pretty fine distinction for users to get.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rlb)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="11089189" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a272317_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 14:06 PST" data-time="1453241181">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="11089189">(In reply to Richard Barnes [:rbarnes] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c4">comment #4</a>)
<span class="quote">&gt; I could live with displaying messages as encrypted-not-signed (vs.
&gt; rejecting), but this seems like a pretty fine distinction for users to get.</span >

Yeah, I realize that the distinction is fine. But &quot;merely&quot; encrypted or signed messages already exist and occur in practice (e.g., the message that these notifications give me), so it's not like it's a distinction that doesn't already exist.

(In reply to Richard Barnes [:rbarnes] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c3">comment #3</a>)
<span class="quote">&gt; In that case, I agree that this is a vulnerability, and I agree that we
&gt; should disable encrypt-then-sign messages.  (That's been the best practice
&gt; for years now, hasn't it!?)  I don't know the Thunderbird code base at all,
&gt; so unfortunately I have no idea how to do this.</span >

I know the MIME code better than anybody else, so I can make necessary changes (although finding reviewers for that will be a challenge). I'm substantially less confident on being able to make security UI decisions, and my crypto knowledge is effectively limited to &quot;I know what these things are and sort of when to use them and I know I shouldn't try to come up with this stuff myself.&quot;</pre></div><div class="change-set" id="c6"><div class="comment" data-id="11089321" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a272317_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a272317_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-19 14:30 PST" data-time="1453242646">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="11089321">I can try to look at this by Thursday.

So far I've only had a brief look. What I don't understand yet: If a message is &quot;signed-then-encrypt&quot;, the inner part is signed, and everything is wrapped in an encrypted container. If that's true, if the attacker cannot decrypt, how can the attacker strip the inner signature?</pre></div><div class="change-set" id="a357233_280903"><div class="change" id="aa357233_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a357233_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a357233_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a357233_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a357233_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a357233_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-20 09:44 PST" data-time="1453311893">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="11092106" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a357233_280903"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a357233_280903"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-20 09:57 PST" data-time="1453312628">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8710033"
         class="attachment"
         data-id="8710033" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="decrypted_of_truncated">
      <meta itemprop="contentSize" content="18304">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8710033" itemprop="contentUrl">
        <span id="att-8710033-description" itemprop="description">plaintext MIME after cutting off a signature accepted by TB as unsigned</span></a>
        — <a href="attachment.cgi?id=8710033&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-7" data-comment-id="11092106">This is a resulting plaintext MIME as the recipient will decrypt it. The attacker has removed the signature attachment by truncating the ciphertext while keeping intact the final two blocks in order not to disturb the padding.</pre></div><div class="change-set" id="c8"><div class="comment" data-id="11092113" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a357233_280903"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a357233_280903"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-20 09:58 PST" data-time="1453312717">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="11092113">(In reply to Joshua Cranmer [:jcranmer] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c2">comment #2</a>)
<span class="quote">&gt; I would like to see examples of the mangled resulting message to understand
&gt; what measures to best take.
&gt; </span >
Added new attachment decrypted_of_truncated

<span class="quote">&gt; It is my opinion that we should only treat signed-then-encrypted messages as
&gt; having the UI of signed and encrypted, with encrypted-then-signed being
&gt; displayed as merely encrypted, although I'm not sure how well our current
&gt; S/MIME code is at being able to control that level of information.</span >

Sounds like a good suggestion.</pre></div><div class="change-set" id="c9"><div class="comment" data-id="11092125" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a357233_280903"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a357233_280903"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-20 10:00 PST" data-time="1453312837">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="11092125">(In reply to Richard Barnes [:rbarnes] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c3">comment #3</a>)
<span class="quote">&gt; Is the following an accurate summary of the attack?
&gt; 
&gt; 1. Alice constructs Encrypt(Bob_pub, Sign(Alice_priv, message))
&gt; 2. Eve recovers a slightly garbled message2 = Encrypt(Bob_pub, message) by
&gt; stripping Alice's signature
&gt; 3. Eve constructs Sign(Eve_priv, message2)
&gt; 4. Thunderbird verifies Eve's signature over message2, and ignores the
&gt; garbling on message2
&gt; </span >
Yes, that is correct.

<span class="quote">&gt; In that case, I agree that this is a vulnerability, and I agree that we
&gt; should disable encrypt-then-sign messages.  (That's been the best practice
&gt; for years now, hasn't it!?)  I don't know the Thunderbird code base at all,
&gt; so unfortunately I have no idea how to do this.</span ></pre></div><div class="change-set" id="c10"><div class="comment" data-id="11092455" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a357233_280903"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a357233_280903"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-20 11:12 PST" data-time="1453317169">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="11092455">Here is a link which provides some more background on the attacks (but no additional information relevant for the fixing of Thunderbird):

<a rel="nofollow" href="http://cryptosource.de/posts/smime_mta_en.html">http://cryptosource.de/posts/smime_mta_en.html</a></pre></div><div class="change-set" id="c11"><div class="comment" data-id="11104632" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a357233_280903"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a357233_280903"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-25 07:51 PST" data-time="1453737103">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8711692"
         class="attachment"
         data-id="8711692" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="cut_off_start.eml">
      <meta itemprop="contentSize" content="21931">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8711692" itemprop="contentUrl">
        <span id="att-8711692-description" itemprop="description">An example where the attacker strips of the beginning of the email.</span></a>
        — <a href="attachment.cgi?id=8711692&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-11" data-comment-id="11104632">I am adding another plaintext example. It is achieved by removing the beginning of the MIME:

================&gt;
Content-Type: multipart/signed; protocol=&quot;application/pkcs7-signature&quot;; micalg=sha-512; boundary=&quot;------------ms020405050706010302010500&quot;

--------------ms020405050706010302010500
Content-Type: multipart/alternative;
 boundary=&quot;------------030900070605060900030608&quot;

This is a multi-part message in MIME format.
--------------030900070605060900030608

&lt;=================

Accordingly the message starts with 
===================&gt;
Content-Type: text/plain; charset=utf-8
&lt;===================
The attacker can always produce this from the original email by removing leading ciphertext blocks and if the length of the to-be-removed text is not a multiple of eight blocks, he can render the leading chars of the first line as whitespaces, which is currently accepted by Thunderbird. But even if he doesn't achieve the latter, this hardly matters, as when Thunderbird doesn't find the initial MIME header, it just displays the message as plain text and thus we must assume the attack as successful. If that is what an email client must commit to, then there is no beautiful defence. What remains is to actively look for 
===&gt;
Content-Type: application/pkcs7-signature; name=&quot;smime.p7s&quot;
&lt;===
and deduce from this the presence of a signature and that the message was originally multipart/signed.
If the attacker destroys that text part with bit-flip errors (which always can, he knows the signature offset from the end), than at least invalid character codes should result which can also be detected.</pre></div><div class="change-set" id="a879439_1689"><div class="change" id="aa879439_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a879439_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a879439_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a879439_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a879439_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a879439_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-26 10:48 PST" data-time="1453834099">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div></div></div><div class="change-set" id="a1484800_1689"><div class="change" id="aa1484800_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1484800_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1484800_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1484800_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1484800_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a1484800_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-02 10:57 PST" data-time="1454439460">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(ekr)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="11130337" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" id="a1484800_1689"><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_35667" id="a1484800_1689"><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-02 11:02 PST" data-time="1454439766">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="11130337">dveditz, what did you need here?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ekr)</span></div></div></div><div class="change-set" id="a2089778_1689"><div class="change" id="aa2089778_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2089778_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2089778_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2089778_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a2089778_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-09 11:00 PST" data-time="1455044438">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c13"><div class="comment" data-id="11316369" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_2687" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/16d8dd535dd864f9058fd5152440db74?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_2687" id="a2089778_1689"><a class="email " href="/user_profile?user_id=2687" > <span class="fna">chris hofmann</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-04-11 11:21 PDT" data-time="1460398905">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="11316369">Trying to figure out the bounty for this bug.  We need a rating. Sounds like sec-high is confirmed. 

And we need to understand if this is a spec bug or just an implementation.

Also sounds like <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c9">comment 9</a> proposes a path toward fixing by disabling encrypt-then-sign messages.  Is that the path we intend to take?</pre></div><div class="change-set" id="c14"><div class="comment" data-id="11317896" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a2089778_1689"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-04-11 21:22 PDT" data-time="1460434948">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="11317896">(In reply to chris hofmann from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c13">comment #13</a>)
<span class="quote">&gt; Trying to figure out the bounty for this bug.  We need a rating. Sounds like
&gt; sec-high is confirmed. 
&gt; 
&gt; And we need to understand if this is a spec bug or just an implementation.
&gt; 
&gt; Also sounds like <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c9">comment 9</a> proposes a path toward fixing by disabling
&gt; encrypt-then-sign messages.  Is that the path we intend to take?</span >

It is definitely a spec bug.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="11320006" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_436630" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/bab38f4b117e0ab26e10b3ee363d1458?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_436630" id="a2089778_1689"><a class="email disabled" href="/user_profile?user_id=436630" > <span class="fna">Adam Muntner [:adamm] (use NEEDINFO)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-04-12 12:02 PDT" data-time="1460487744">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="11320006">(In reply to Kai Engert (:kaie) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c6">comment #6</a>)
<span class="quote">&gt; I can try to look at this by Thursday.
&gt; 
&gt; So far I've only had a brief look. What I don't understand yet: If a message
&gt; is &quot;signed-then-encrypt&quot;, the inner part is signed, and everything is
&gt; wrapped in an encrypted container. If that's true, if the attacker cannot
&gt; decrypt, how can the attacker strip the inner signature?</span >

Kai is correct in msg #6. The original issue report said, &quot;When Alice sends a signed-then-encrypted (standard format of today's mail clients) mail to Bob, Eve blocks that mail, strips off the signature, replaces it with her own signature and sends it to Bob.&quot;

I think we are talking about two different issues here. 

Encrypt-then-sign has been a known-bad order of operations for a long time. If Thunderbird currently supports this, the feature should be disabled. 

The issue Falko reported is different, it's a weakness in sign-then-encrypt. 

Reading the attached PDF description of the attack, it says:

&quot;Eve learns the Email Format used by Alice
In order for Eve to learn the length of the MIME signature appended to the clear text she requests from Alicea signed email. The format of the plaintext message in our example attack is
as in Figure 1. Eve determines the number of blocks to remove from end of the
ciphertext in order to strip o  the signature, where she keeps intact the last two
blocks in order not to disturb the padding.&quot;

Falko, if I understand correctly, to perform this attack, the attacker (Eve) must get Alice to send her(Eve) an encrypted then signed email. Once learning the structure of the mail, as the PDF explains, &quot;Eve determines the number of blocks to remove from end of the ciphertext in order to strip o  the signature, where she keeps intact the last two blocks in order not to disturb the padding.&quot;

This is a form of known-plaintext attack.

Then, Eve must be in position to intercept, modify, and reinject the modified message. For the attack to work, &quot;...Eve applies an outer S/MIME signature with her own private key to the enveloped data before she sends the email to Bob.&quot;

If I'm reading this correctly, the 'sends the mail to Bob' convincingly part is not trivial and would require network positioning or mail server mis-configuration. 

If all that is true, this bug should be ranked sec-moderate. 

<a rel="nofollow" href="https://wiki.mozilla.org/Security_Severity_Ratings">https://wiki.mozilla.org/Security_Severity_Ratings</a>
&quot;Vulnerabilities which can provide an attacker additional information or positioning that could be used in combination with other vulnerabilities. Disclosure of sensitive information that represents a violation of privacy but by itself does not expose the user or organization to immediate risk. The vulnerability combined with another moderate vulnerability could result in an attack of high or critical severity (aka stepping stone).&quot;</pre></div><div class="change-set" id="c16"><div class="comment" data-id="11320030" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_436630" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/bab38f4b117e0ab26e10b3ee363d1458?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_436630" id="a2089778_1689"><a class="email disabled" href="/user_profile?user_id=436630" > <span class="fna">Adam Muntner [:adamm] (use NEEDINFO)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-04-12 12:09 PDT" data-time="1460488186">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="11320030">Falko blogged about the category of attack in January, though didn't mention Thunderbird by name. 
<a rel="nofollow" href="http://cryptosource.de/posts/smime_mta_en.html">http://cryptosource.de/posts/smime_mta_en.html</a></pre></div><div class="change-set" id="c17"><div class="comment" data-id="11331675" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a2089778_1689"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-04-16 02:41 PDT" data-time="1460799678">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="11331675">(In reply to Adam Muntner [:adamm] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c15">comment #15</a>)
<span class="quote">&gt; (In reply to Kai Engert (:kaie) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c6">comment #6</a>)
&gt; &gt; I can try to look at this by Thursday.
&gt; &gt; 
&gt; &gt; So far I've only had a brief look. What I don't understand yet: If a message
&gt; &gt; is &quot;signed-then-encrypt&quot;, the inner part is signed, and everything is
&gt; &gt; wrapped in an encrypted container. If that's true, if the attacker cannot
&gt; &gt; decrypt, how can the attacker strip the inner signature?
&gt; 
&gt; Kai is correct in msg #6. The original issue report said, &quot;When Alice sends
&gt; a signed-then-encrypted (standard format of today's mail clients) mail to
&gt; Bob, Eve blocks that mail, strips off the signature, replaces it with her
&gt; own signature and sends it to Bob.&quot;
&gt; 
&gt; I think we are talking about two different issues here. 
&gt; 
&gt; Encrypt-then-sign has been a known-bad order of operations for a long time.
&gt; If Thunderbird currently supports this, the feature should be disabled. 
&gt; 
&gt; The issue Falko reported is different, it's a weakness in sign-then-encrypt. 
&gt; 
&gt; Reading the attached PDF description of the attack, it says:
&gt; 
&gt; &quot;Eve learns the Email Format used by Alice
&gt; In order for Eve to learn the length of the MIME signature appended to the
&gt; clear text she requests from Alicea signed email. The format of the
&gt; plaintext message in our example attack is
&gt; as in Figure 1. Eve determines the number of blocks to remove from end of the
&gt; ciphertext in order to strip o  the signature, where she keeps intact the
&gt; last two
&gt; blocks in order not to disturb the padding.&quot;
&gt; 
&gt; Falko, if I understand correctly, to perform this attack, the attacker (Eve)
&gt; must get Alice to send her(Eve) an encrypted then signed email. Once</span >
Just any signed email from Alice will do (encrypted either way or not at all).
<span class="quote">&gt; learning the structure of the mail, as the PDF explains, &quot;Eve determines the
&gt; number of blocks to remove from end of the ciphertext in order to strip o 
&gt; the signature, where she keeps intact the last two blocks in order not to
&gt; disturb the padding.&quot;
&gt; 
&gt; This is a form of known-plaintext attack.
&gt; 
&gt; Then, Eve must be in position to intercept, modify, and reinject the
&gt; modified message. For the attack to work, &quot;...Eve applies an outer S/MIME
&gt; signature with her own private key to the enveloped data before she sends
&gt; the email to Bob.&quot;
&gt; 
&gt; If I'm reading this correctly, the 'sends the mail to Bob' convincingly part
&gt; is not trivial and would require network positioning or mail server
&gt; mis-configuration. 
&gt; 
&gt; If all that is true, this bug should be ranked sec-moderate. 
&gt; 
&gt; <a rel="nofollow" href="https://wiki.mozilla.org/Security_Severity_Ratings">https://wiki.mozilla.org/Security_Severity_Ratings</a>
&gt; &quot;Vulnerabilities which can provide an attacker additional information or
&gt; positioning that could be used in combination with other vulnerabilities.
&gt; Disclosure of sensitive information that represents a violation of privacy
&gt; but by itself does not expose the user or organization to immediate risk.
&gt; The vulnerability combined with another moderate vulnerability could result
&gt; in an attack of high or critical severity (aka stepping stone).&quot;</span >
I certainly don't claim to be know your rules for severity ratings in detail, but I don't see that the message takeover attacks need another vulnerability to be mounted. &quot;Network positioning&quot; is trivial to achieve. If the attacker runs a WLAN hotspot he is already in a network position.

Please note that what you described above is just the weaker variant of the attack. This one could indeed be mitigated by more strict MIME parsing of Thunderbird. The more general attack is described at
<a rel="nofollow" href="http://cryptosource.de/posts/smime_mta_improved_en.html">http://cryptosource.de/posts/smime_mta_improved_en.html</a>
The only real countermeasure against that one is to disable the acceptance of outer signatures in the recipient's client.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="11545738" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2089778_1689"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-13 10:19 PDT" data-time="1468430345">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11545738">Wayne, is there something you can do to move this along and either resolve the underlying issue or make a decision that we're not going to for TB?</pre><div class="activity"><div class="change">Flags: needinfo?(vseerror)</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="11570217" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a2089778_1689"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-23 03:30 PDT" data-time="1469269846">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11570217">(In reply to Al Billings [:abillings] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c18">comment #18</a>)
<span class="quote">&gt; Wayne, is there something you can do to move this along and either resolve
&gt; the underlying issue or make a decision that we're not going to for TB?</span >

The NI still exists for kaie, though I'm not sure what else he intends to do.

S/mime has no module owners or peers listed, so cc:ing some mime peers who perhaps can decide on next step</pre><div class="activity"><div class="change">Flags: needinfo?(vseerror) &rarr; needinfo?(mkmelin+mozilla)</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="12118370" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a2089778_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 03:49 PST" data-time="1488800959">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12118370">The sad reality is that I still haven't found time to look into this bug :-(</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c21"><div class="comment" data-id="12125945" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a2089778_1689"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-08 05:35 PST" data-time="1488980127">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12125945">FWIW, clokep agrees about &quot;suggestions for not displaying it as encrypted &amp; signed makes sense.&quot;</pre></div><div class="change-set" id="c22"><div class="comment" data-id="12125948" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a2089778_1689"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-08 05:36 PST" data-time="1488980163">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="12125948">Patrick can you offer some perspective?</pre><div class="activity"><div class="change">Flags: needinfo?(patrick)</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="12126190" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_100230" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/da0befc896cd73c16805f598f0e18bcb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_100230" id="a2089778_1689"><a class="email " href="/user_profile?user_id=100230" > <span class="fna">Patrick Brunschwig</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-08 06:55 PST" data-time="1488984915">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12126190">(In reply to Falko Strenzke from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c17">comment #17</a>)

<span class="quote">&gt; The only real countermeasure against that one is to disable the acceptance
&gt; of outer signatures in the recipient's client.</span >

I don't fully agree. If the outer signature is created with the same certificate as the signature in the encrypted message, then the message is valid and the signature is accepted. This is known as sign + encrypt + sign, and is the only possible proof that the message is really encrypted and signed by the same person.

That is, the real countermeasure against this attack is to disable the acceptance of outer signatures in the recipient's client, if there is no signature inside the encrypted message. 

I will try to find out if I can fix this.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; patrick</div><div class="change">Flags: <span class="activity-deleted">needinfo?(patrick)</span></div></div></div><div class="change-set" id="c24"><div class="comment" data-id="12126256" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a2089778_1689"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a2089778_1689"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-08 07:12 PST" data-time="1488985976">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12126256">(In reply to Patrick Brunschwig from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c23">comment #23</a>)
<span class="quote">&gt; (In reply to Falko Strenzke from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c17">comment #17</a>)
&gt; 
&gt; &gt; The only real countermeasure against that one is to disable the acceptance
&gt; &gt; of outer signatures in the recipient's client.
&gt; 
&gt; I don't fully agree. If the outer signature is created with the same
&gt; certificate as the signature in the encrypted message, then the message is
&gt; valid and the signature is accepted. This is known as sign + encrypt + sign,
&gt; and is the only possible proof that the message is really encrypted and
&gt; signed by the same person.
&gt; 
&gt; That is, the real countermeasure against this attack is to disable the
&gt; acceptance of outer signatures in the recipient's client, if there is no
&gt; signature inside the encrypted message. 
&gt; 
&gt; I will try to find out if I can fix this.</span >

Yes, I that is correct.</pre></div><div class="change-set" id="a36036268_29811"><div class="change" id="aa36036268_29811">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a36036268_29811"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_29811" id="a36036268_29811"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a36036268_29811"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a36036268_29811">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a36036268_29811">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-08 08:35 PST" data-time="1488990928">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mkmelin+mozilla)</span></div></div></div><div class="change-set" id="c25"><div class="comment" data-id="12167224" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_485442" id="a36036268_29811"><img src="https://secure.gravatar.com/avatar/7e5d4b651b327e64d6a02b168c4e84db?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_485442" id="a36036268_29811"><a class="email " href="/user_profile?user_id=485442" > <span class="fna">Stephanie Ouillon [:arroway] (needinfo me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-22 05:55 PDT" data-time="1490187304">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="12167224">Sec-high triage: Patrick, thanks for taking this bug. Did you have any luck finding a fix for it?</pre><div class="activity"><div class="change">Flags: needinfo?(patrick)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="12167706" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_100230" id="a36036268_29811"><img src="https://secure.gravatar.com/avatar/da0befc896cd73c16805f598f0e18bcb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_100230" id="a36036268_29811"><a class="email " href="/user_profile?user_id=100230" > <span class="fna">Patrick Brunschwig</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-22 08:07 PDT" data-time="1490195269">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="12167706">I was on holidays, and I'm pretty busy with many other things. I said I will look into it, but it won't happen in the next 1-2 weeks. Given that this bug is already more than a year old, I don't think it's a problem if it needs to wait a little longer.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="12187446" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_485442" id="a36036268_29811"><img src="https://secure.gravatar.com/avatar/7e5d4b651b327e64d6a02b168c4e84db?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_485442" id="a36036268_29811"><a class="email " href="/user_profile?user_id=485442" > <span class="fna">Stephanie Ouillon [:arroway] (needinfo me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-29 03:52 PDT" data-time="1490784773">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="12187446">(In reply to Patrick Brunschwig from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c26">comment #26</a>)
<span class="quote">&gt; Given that this bug is already more than a year old, I don't think it's a problem if it needs to wait a little longer.</span >

This is a common misconception. 
The longer a bug goes unfixed, the more chance it has to be found (and exploited) by other people than us.
Actually, a research paper showed that &quot;Between 15% and 20% of all vulnerabilities in browsers have at least one duplicate. For data available on Android between 2015 and 2016, 22% of vulnerabilities are rediscovered at least once an average of 2 months after their original disclosure. There are reasons to believe that the actual rate is even higher for certain types of software.&quot; [1]

So having a one year old sec-high bug waiting to be fixed _is_ a problem. 

[1] <a rel="nofollow" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2928758">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2928758</a></pre></div><div class="change-set ca-428608" id="c28"><div class="comment" data-id="12187996" data-no="28"
       data-tags="off-topic">
    
    <table class="layout-table change-head " id="ch-28" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a36036268_29811"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a36036268_29811"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-29 07:15 PDT" data-time="1490796945">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags"><span class="comment-tag">off-topic</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-28"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (off-topic)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-28"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="12187996" style="display:none">Al, the sec-bounty flag is over a year old. What's preventing us from making a decision?</pre><div class="activity" style="display:none"><div class="change">Flags: needinfo?(abillings)</div></div></div><div class="change-set ca-280903" id="c29"><div class="comment" data-id="12188702" data-no="29"
       data-tags="off-topic">
    
    <table class="layout-table change-head " id="ch-29" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a36036268_29811"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a36036268_29811"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-29 10:02 PDT" data-time="1490806952">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags"><span class="comment-tag">off-topic</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-29"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="abillings [5 years ago]">
            Comment hidden (off-topic)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-29"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="12188702" style="display:none">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c28">comment #28</a>)
<span class="quote">&gt; Al, the sec-bounty flag is over a year old. What's preventing us from making
&gt; a decision?</span >

Nothing but we ask people to write to <a href="mailto:security&#64;mozilla.org">security&#64;mozilla.org</a> for these sorts of questions and to not have conversations in the bug about it.</pre><div class="activity" style="display:none"><div class="change">Flags: <span class="activity-deleted">needinfo?(abillings)</span></div></div></div><div class="change-set" id="a39495123_1689"><div class="change" id="aa39495123_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a39495123_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a39495123_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a39495123_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a39495123_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-17 10:23 PDT" data-time="1492449783">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="12267310" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a39495123_1689"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-26 06:43 PDT" data-time="1493214220">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="12267310">(In reply to Patrick Brunschwig from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c26">comment #26</a>)
<span class="quote">&gt; I was on holidays, and I'm pretty busy with many other things. I said I will
&gt; look into it, but it won't happen in the next 1-2 weeks.</span >

This happened a month ago.
What's the timeline here?</pre></div><div class="change-set" id="c31"><div class="comment" data-id="12334952" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_100230" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/da0befc896cd73c16805f598f0e18bcb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_100230" id="a39495123_1689"><a class="email " href="/user_profile?user_id=100230" > <span class="fna">Patrick Brunschwig</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-20 01:49 PDT" data-time="1495270167">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="12334952">I tried to fix this, but I don't know enough about the S/MIME code in Thunderbird and the S/MIME protocol in general.</pre><div class="activity"><div class="change">Assignee: patrick &rarr; nobody</div><div class="change">Flags: <span class="activity-deleted">needinfo?(patrick)</span></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="12340339" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_253233" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/834e6840be1a79998020e3004c902ac7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_253233" id="a39495123_1689"><a class="email " href="/user_profile?user_id=253233" > <span class="fna">Philipp Kewisch [:Fallen] [:📆][:🧩]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-23 03:09 PDT" data-time="1495534158">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="12340339">Joshua, any chance you could look into this one as you've already made some starting comments earlier? I am happy to help with UI or reviewing if needed.</pre><div class="activity"><div class="change">Flags: needinfo?(Pidgeot18)</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="12387923" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a39495123_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-09 18:42 PDT" data-time="1497058943">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="12387923">So every time I look at this bug, I keep exceeding the amount of time I have allotted for making progress.

The main question is what we would agree constitutes a &quot;fix&quot; for this bug. There seems to be agreement that making the UI for encrypt-and-sign reflecting a different status (i.e., just encrypted or maybe even questionable security status) is necessary. What countermeasures beyond that are necessary, desirable, or even feasible is unclear to me. It looks like switching from CBC to some other mode (GCM?) might be warranted, but my knowledge turns into a blackbox around the CMS format layer, so I don't know what algorithms are possible here, either from a spec standpoint or a deployed standpoint. In any case, that sort of poking around would need to be done in NSS, not mailnews code (we basically just say &quot;hey, NSS, give me an algorithm I can use for all these recipients&quot;).


(In reply to Falko Strenzke from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c17">comment #17</a>)
<span class="quote">&gt; I certainly don't claim to be know your rules for severity ratings in
&gt; detail, but I don't see that the message takeover attacks need another
&gt; vulnerability to be mounted. &quot;Network positioning&quot; is trivial to achieve. If
&gt; the attacker runs a WLAN hotspot he is already in a network position.</span >

Most email traffic is conducted over SSL, particularly MUA&lt;-&gt;MTA traffic. You have to click through a scary dialog or two to configure an account in Thunderbird to not use SSL or STARTTLS.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(Pidgeot18)</span></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="12390862" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a39495123_1689"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-12 08:07 PDT" data-time="1497280079">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12390862">(In reply to Joshua Cranmer [:jcranmer] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c33">comment #33</a>)
<span class="quote">&gt; So every time I look at this bug, I keep exceeding the amount of time I have
&gt; allotted for making progress.
&gt; 
&gt; The main question is what we would agree constitutes a &quot;fix&quot; for this bug.
&gt; There seems to be agreement that making the UI for encrypt-and-sign
&gt; reflecting a different status (i.e., just encrypted or maybe even
&gt; questionable security status) is necessary. </span >
I would definitely suggest that outer signatures should be indicated as questionable to the user. There should be almost no clients in the field which produce such today, I suppose. As a matter of fact, merely encrypted emails offer only limited security, this is even directly admitted by the S/MIME standard. So it might really be good to indicate to the user that a merely encrypted email might have been tempered with.
<span class="quote">&gt; What countermeasures beyond that
&gt; are necessary, desirable, or even feasible is unclear to me. </span >
It would help if Thunderbird would be able to detect the cutting out of an inner signature. But that is entirely about MIME parsing, the specifics of which I do not know much about. However, it seems quite straightforward to me, that the following measures should help:
- seeing &quot;Content-Type: application/pkcs7-signature&quot; and no signature in the MIME should lead to an invalid message indicated to the user. This is certainly mostly only meaningful for encrypted messages.
- an encrypted message for which the mime parsing fails, and which thus would now be displayed to the user as raw text, should, in a secure version, not be displayed at all or at least only after displaying a clear warning to the user. This would cause a compatibility problem with clients who send plain text messages without any MIME encoding. I suppose that there  aren't any clients today which show such a behavior.
<span class="quote">&gt; It looks like
&gt; switching from CBC to some other mode (GCM?) might be warranted, but my
&gt; knowledge turns into a blackbox around the CMS format layer, so I don't know
&gt; what algorithms are possible here, either from a spec standpoint or a
&gt; deployed standpoint. In any case, that sort of poking around would need to
&gt; be done in NSS, not mailnews code (we basically just say &quot;hey, NSS, give me
&gt; an algorithm I can use for all these recipients&quot;).</span >
It is not possible to use GCM or any other authenticated encryption mode in S/MIME so far, to the best of my knowledge. In their reaction to the published attacks the S/MIME group started discussing this topic, but I havent't heard anything about it actually being done.

<span class="quote">&gt; 
&gt; 
&gt; (In reply to Falko Strenzke from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c17">comment #17</a>)
&gt; &gt; I certainly don't claim to be know your rules for severity ratings in
&gt; &gt; detail, but I don't see that the message takeover attacks need another
&gt; &gt; vulnerability to be mounted. &quot;Network positioning&quot; is trivial to achieve. If
&gt; &gt; the attacker runs a WLAN hotspot he is already in a network position.
&gt; 
&gt; Most email traffic is conducted over SSL, particularly MUA&lt;-&gt;MTA traffic.
&gt; You have to click through a scary dialog or two to configure an account in
&gt; Thunderbird to not use SSL or STARTTLS.</span >
Note that afterwards I also devised a different variant of the attack, where the attacker doesn't need to block the original message.
Generally I tend to think that any argument in favor of not needing to take this type of attack serious could, as it seems to me, equally be used to question the necessity of S/MIME in general. If there are other measures, such as STARTTLS, which one completely relies on, then S/MIME is indeed superfluous. But there are good reasons for end-to-end security. For instance email accounts may be hacked. Access to an encrypted (and signed) message would be sufficient to mount an attack. Or someone might have good reasons not to trust the STARTTLS certificates or the service provider entirely.</pre></div><div class="change-set" id="c35"><div class="comment" data-id="12395079" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a39495123_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-13 11:52 PDT" data-time="1497379947">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12395079">(In reply to Falko Strenzke from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c34">comment #34</a>)
<span class="quote">&gt; It would help if Thunderbird would be able to detect the cutting out of an
&gt; inner signature. But that is entirely about MIME parsing, the specifics of
&gt; which I do not know much about. However, it seems quite straightforward to
&gt; me, that the following measures should help:</span >

MIME is one of those things where almost any input is valid (kind of like HTML 5). In theory, you could try to deal with a missing header block or malformed base64/qp content, but that's really about it. Extraneous MIME boundaries aren't really detectable, especially because there's reason to send content that could be MIME boundaries (diffs, for examples).

In practice, libmime can't really pass parser failures around, even if we did indicate them. Even trying to make decisions on the basis of child parts can be difficult (don't attempt to understand how multipart/related and multipart/alternative work, you don't want to).

<span class="quote">&gt; - seeing &quot;Content-Type: application/pkcs7-signature&quot; and no signature in the
&gt; MIME should lead to an invalid message indicated to the user. This is
&gt; certainly mostly only meaningful for encrypted messages.</span >

You mean an application/pkcs7-signature that's not an immediate child of multipart/signed? Since it's going to be the MIME type picked for a detached signature, I can see it plausible that someone is going to want to send it as an attachment.

<span class="quote">&gt; - an encrypted message for which the mime parsing fails, and which thus
&gt; would now be displayed to the user as raw text, should, in a secure version,
&gt; not be displayed at all or at least only after displaying a clear warning to
&gt; the user. This would cause a compatibility problem with clients who send
&gt; plain text messages without any MIME encoding. I suppose that there  aren't
&gt; any clients today which show such a behavior.</span >

As mentioned above, MIME parsing failures don't really exist, and libmime makes it really difficult to pass them around even if they did.

<span class="quote">&gt; Generally I tend to think that any argument in favor of not needing to take
&gt; this type of attack serious could, as it seems to me, equally be used to
&gt; question the necessity of S/MIME in general. If there are other measures,
&gt; such as STARTTLS, which one completely relies on, then S/MIME is indeed
&gt; superfluous. But there are good reasons for end-to-end security. For
&gt; instance email accounts may be hacked. Access to an encrypted (and signed)
&gt; message would be sufficient to mount an attack. Or someone might have good
&gt; reasons not to trust the STARTTLS certificates or the service provider
&gt; entirely.</span >

I don't deny that S/MIME issues can be very grave. But this does need to be balanced by the fact that the standard network encryption argument of &quot;coffee shop wifi&quot; isn't sufficient to motivate practical attacks with S/MIME.

P.S. I'm going to be busy for the rest of this week, so I can't do any work on it for now.</pre></div><div class="change-set" id="c36"><div class="comment" data-id="12507458" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_485442" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/7e5d4b651b327e64d6a02b168c4e84db?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_485442" id="a39495123_1689"><a class="email " href="/user_profile?user_id=485442" > <span class="fna">Stephanie Ouillon [:arroway] (needinfo me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-26 02:36 PDT" data-time="1501061811">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="12507458">Joshua, have you been able to work again on this bug?</pre><div class="activity"><div class="change">Flags: needinfo?(Pidgeot18)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="12514822" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a39495123_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-28 02:00 PDT" data-time="1501232419">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="12514822">Trying to summarize:

- S/MIME doesn't provide any protections whatsoever, which could allow the processing of S/MIME message
  to detect manipulation of the data stream (no checksum over the entirety of the stream)

- Eve learns about the size of signatures usually created by Alice

- despite not being able to decrypt, Eve knows which parts of the encrypted stream contain the inner signature

- Eve removes the parts that likely contain the inner signature, and replaces it with a different encrypted signature,
  a signature chosen by Eve

- because we cannot check the consistency of the stream, but process S/MIME messages on a best effort basis,
  we display the replacement signature


What I don't understand:

If Eve is unable to decrypt the inner message, how is Eve able to create a fake signature that matches the message content?

Why don't we detect that the fake signature doesn't match the decrypted message?

Why are we displaying a valid signature, if the signature doesn't match the content?</pre></div><div class="change-set" id="c38"><div class="comment" data-id="12514864" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a39495123_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-28 02:19 PDT" data-time="1501233547">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="12514864">Could we get a message example that we could use to debug and test?

We'd require a certificate (including private key) that everyone can use to import into TB, so we that every developer and QA person working on this issue is able to decrypt the messages.

We should get a copy of the original signed message from Alice, and a copy of the manipulated message from Eve. Ideally, to simplify testing, the person who helps with reproducing this issue could create a new mailbox in the Thunderbird Local Folders, copy only these two messages into the folder, and then find the mailbox file on your local disk (TB profile directory/Mail/Local Folders), find that mailbox file (excluding .msf) and attach it to this bug.

I've tried to use the attachment named
   &quot;An example where the attacker strips of the beginning of the email.&quot;
and create a local mailbox containing that message,
but Thunderbird doesn't display any signature UI for it.</pre></div><div class="change-set" id="c39"><div class="comment" data-id="12515634" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a39495123_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-28 07:45 PDT" data-time="1501253124">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="12515634">(In reply to Kai Engert (:kaie:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c37">comment #37</a>)
<span class="quote">&gt; If Eve is unable to decrypt the inner message, how is Eve able to create a
&gt; fake signature that matches the message content?
&gt; 
&gt; Why don't we detect that the fake signature doesn't match the decrypted
&gt; message?
&gt; 
&gt; Why are we displaying a valid signature, if the signature doesn't match the
&gt; content?</span >

AIUI, what's going is this:

1. Eve intercepts original sign &amp; encrypt message
2. Eve scrunches out the signature so that it's just an encrypted message.
3. Eve wraps the message in a new sign part so it looks like Encrypt &amp; Sign.
4. Bob sees message as signed &amp; encrypted, coming from Eve.

(In reply to Stephanie Ouillon [:arroway] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c36">comment #36</a>)
<span class="quote">&gt; Joshua, have you been able to work again on this bug?</span >

No, I haven't had time.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(Pidgeot18)</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="12515707" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a39495123_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-28 08:09 PDT" data-time="1501254557">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="12515707">Is every byte encrypted individually? If yes, I agree that the surgery seems possible.

Or are we encrypting in chunks? Then it seems that it's difficult to cut away exactly the outer parts that are required.</pre></div><div class="change-set" id="c41"><div class="comment" data-id="12515733" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a39495123_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-28 08:13 PDT" data-time="1501254830">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="12515733">It's block-encryption. You'd lose the last few blocks, which would include part of the end of the message. For HTML messages, we're ending with CRLF  &lt;/body&gt;CRLF&lt;/html&gt;, which gives you some slack in things you could chomp the end of without people noticing.</pre></div><div class="change-set" id="c42"><div class="comment" data-id="12515838" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a39495123_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-28 08:38 PDT" data-time="1501256300">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="12515838">Does it work without stripping anything away from the beginning of the message?</pre></div><div class="change-set" id="c43"><div class="comment" data-id="12619238" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a39495123_1689"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-31 20:00 PDT" data-time="1504234820">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8903424"
         class="attachment patch"
         data-id="8903424" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="smime-bunch">
      <meta itemprop="contentSize" content="76286">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8903424">
          <a class="link" href="attachment.cgi?id=8903424&amp;action=diff">
        <span id="att-8903424-description" itemprop="description">Forbid encrypt &amp; sign (outdated, crashes)</span></a>
        — <a href="attachment.cgi?id=8903424&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=8903424">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-43" data-comment-id="12619238">Well, I'm basically cramming three things in this patch:

1. A framework to make decisions about validity that is more holistic than &quot;yep, it's signed&quot; and &quot;yep, it's encrypted.&quot;
2. A cleanup of the libmime integration with S/MIME (basically, I shunted most of the verification logic from mimecms.cpp into SMimeInfo.cpp, threw out dead code, and then cleaned up most of the shunted code to follow more modern C++ style guidelines).
3. New logic for validity that accepts only signed, encrypted, sign-and-encrypt, and sign-encrypt-sign as valid S/MIME forms. (i.e., encrypt-and-sign is now forbidden).

I'd call it narrow, but it's narrow only insofar as I'm not really changing the way we communicate the security, even though I've built the platform to do that. As a result, the resulting UI is a little suboptimal. I'd love to see a more fundamental rethinking of UI (particularly in regards to explaining why we're making the decision we're displaying), but this is not the bug for it.

This turned out to be more complicated than I expected--I ultimately had to change the interface from what I was planning (namely, the nsIMsgSMIMEHeaderSink was going to get the statuses reported in postorder MIME traversal, but that turned out to be far more difficult than it was worth). I did write comments to try to explain what's going on, but I wrote them at different stages in the attempt to get the code working correctly, so I may not have fixed all the comments to reflect this version of the patch. If the comments (or the names) are confusing or seem not to match what the code is doing, please tell me, and I'll try to fix them ASAP.

As for testing... well, I'm not going to subject you to my half-baked automated testing for S/MIME. The easiest thing to do is to generate some local certificates and create some encrypt-and-sign and sign-and-encrypt messages (using openssl smime) and see what the status indicators display. I haven't tested all possible error paths, and seeing what happens in situations like opening up attachments is probably a good idea.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; Pidgeot18</div><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">
        <a href="/attachment.cgi?id=8903424&amp;action=edit"
           title="Forbid encrypt &amp; sign (outdated, crashes)"
           class=""
        >Attachment #8903424</a> -
        Flags: review?(jorgk)</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="12620722" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" id="a39495123_1689"><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_35667" id="a39495123_1689"><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-01 07:54 PDT" data-time="1504277664">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="12620722">This definitely is going to need some automated testing.</pre></div><div class="change-set" id="a51692780_176914"><div class="change" id="aa51692780_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a51692780_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a51692780_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a51692780_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-05 14:37 PDT" data-time="1504647440">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8711692&amp;action=edit"
           title="An example where the attacker strips of the beginning of the email."
           class=""
        >Attachment #8711692</a> -
        Attachment mime type: application/x-extension-eml &rarr; text/plain</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="12634498" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 11:08 PDT" data-time="1504721314">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="12634498">No comments from the reviewer doesn't mean the reviewer isn't doing anything. I'm gearing up to test this, creating certificates, etc.

My first attempt to compile with the patch failed, you need to:
-class MimeObject;
+struct MimeObject;
in SMimeInfo.h. Strange, I thought the Windows compiler is more lenient than any other.

As a basic test I tried signed, encrypted, signed+encrypted messages.

Next would be encrypted+signed and signed+encrypted+signed (see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c23">comment #23</a>). That will take longer since I need to handcraft those.

Sadly just opening a folder into which I have placed three messages exported from TB Daily gives a crash whose stack I will attach. That's before I imported my own certificate into a new profile. It works better after the import of own certificate with which I signed the messages ;-)</pre></div><div class="change-set" id="c46"><div class="comment" data-id="12634506" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 11:10 PDT" data-time="1504721424">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8905162"
         class="attachment"
         data-id="8905162" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-crash.txt">
      <meta itemprop="contentSize" content="3587">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8905162" itemprop="contentUrl">
        <span id="att-8905162-description" itemprop="description">(for old patch) 1240290-crash.txt - crash on now profile with no certificates installed</span></a>
        — <a href="attachment.cgi?id=8905162&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c47"><div class="comment" data-id="12634542" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 11:21 PDT" data-time="1504722118">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8905166"
         class="attachment"
         data-id="8905166" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-crash2.txt">
      <meta itemprop="contentSize" content="3791">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8905166" itemprop="contentUrl">
        <span id="att-8905166-description" itemprop="description">(for old patch) 1240290-crash2.txt</span></a>
        — <a href="attachment.cgi?id=8905166&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-47" data-comment-id="12634542">After installing my certificate, importing a signed message by dragging it onto a folder also crashes, see enclosed.

I also saw some JS errors on the console:
JavaScript error: chrome://messenger-smime/content/msgHdrViewSMIMEOverlay.js, line 163: TypeError: result is null

I think I'll stop testing now until a new patch arrives.

If it doesn't crash, the three messages signed, encrypted and signed+encrypted are shown with the correct icons.</pre></div><div class="change-set" id="c48"><div class="comment" data-id="12634736" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 12:06 PDT" data-time="1504724770">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="12634736">I saw another problem: I have two sent messages, one encrypted, one signed+encrypted.

I have a self-signed certificate issued be a fictitious CA which I also created, both following:
<a rel="nofollow" href="https://gist.github.com/richieforeman/3166387">https://gist.github.com/richieforeman/3166387</a>

In a new profile, I imported those messages, and my personal certificate, not the CA certificate under &quot;Authorities&quot;.
In a Daily, I can decrypt/display those two messages, with your patch I cannot display the signed+encrypted. Is that intentional? (An only signed message displays with an (x) on the envelope to indicate a broken certificate.)

Sorry about these silly test cases, they came about while I was preparing the test environment.</pre></div><div class="change-set" id="c49"><div class="comment" data-id="12641851" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-08 09:24 PDT" data-time="1504887843">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="12641851">Comment on <span class=""><a href="/attachment.cgi?id=8903424" name="attach_8903424" title="Forbid encrypt &amp; sign (outdated, crashes)">attachment 8903424</a> <a href="/attachment.cgi?id=8903424&amp;action=edit" title="Forbid encrypt &amp; sign (outdated, crashes)">[details]</a> <a href="/attachment.cgi?id=8903424&amp;action=diff" title="Forbid encrypt &amp; sign (outdated, crashes)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=8903424'>[review]</a>
Forbid encrypt &amp; sign (outdated, crashes)

I think this needs another round, clearing r? for now.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8903424&amp;action=edit"
           title="Forbid encrypt &amp; sign (outdated, crashes)"
           class=""
        >Attachment #8903424</a> -
        Flags: <span class="activity-deleted">review?(jorgk)</span></div></div></div><div class="change-set" id="c50"><div class="comment" data-id="12727957" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_485442" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/7e5d4b651b327e64d6a02b168c4e84db?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_485442" id="a51692780_176914"><a class="email " href="/user_profile?user_id=485442" > <span class="fna">Stephanie Ouillon [:arroway] (needinfo me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-04 06:41 PDT" data-time="1507124487">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="12727957">Joshua, is that still your plan to continue working on this patch?</pre><div class="activity"><div class="change">Flags: needinfo?(Pidgeot18)</div></div></div><div class="change-set" id="c51"><div class="comment" data-id="12731810" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_286107" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/454e57b6803023bd2c8c92abaff23861?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_286107" id="a51692780_176914"><a class="email " href="/user_profile?user_id=286107" > <span class="fna">Joshua Cranmer [:jcranmer]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-05 05:22 PDT" data-time="1507206164">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="12731810">(In reply to Stephanie Ouillon [:arroway] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c50">comment #50</a>)
<span class="quote">&gt; Joshua, is that still your plan to continue working on this patch?</span >

Yeah. I've got some updates, but I need to double-check that I've fixed all of the problems Jorg found.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(Pidgeot18)</span></div></div></div><div class="change-set" id="c52"><div class="comment" data-id="12928947" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a51692780_176914"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-20 07:05 PST" data-time="1513782340">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="12928947">Josh, please let us know if there's anything we can help you with, unblocking this bug.</pre></div><div class="change-set" id="c53"><div class="comment" data-id="12976163" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a51692780_176914"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 05:51 PST" data-time="1516197071">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="12976163">Jorg, maybe you can push this over the finish line yourself?</pre><div class="activity"><div class="change">Flags: needinfo?(jorgk)</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="12976550" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 08:01 PST" data-time="1516204903">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="12976550">I think you've misunderstood my job description:
<a rel="nofollow" href="https://mail.mozilla.org/pipermail/tb-planning/2016-December/005142.html">https://mail.mozilla.org/pipermail/tb-planning/2016-December/005142.html</a>
I appreciate the importance and severity of security bugs, but we can't have the project come to a grinding halt because the only paid developer is not dedicating time to his prime tasks any more.

Since TB is an open source maybe you academics want to contribute to the fix. If you think this isn't receiving enough attention, please get in touch with the Thunderbird Council (<a href="mailto:thunderbird-council&#64;mozilla.org">thunderbird-council&#64;mozilla.org</a>).

Sorry I can't give you a better answer.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jorgk)</span></div></div></div><div class="change-set" id="c55"><div class="comment" data-id="12976561" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a51692780_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 08:03 PST" data-time="1516205036">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="12976561">Sorry, I mixed up the reporter here. So this should read:
Since TB is an open source, maybe *the* academics want to contribute to the fix.</pre></div><div class="change-set" id="c56"><div class="comment" data-id="13559717" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a51692780_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-21 01:48 PDT" data-time="1534841306">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="13559717">I was staring at this bug for a long time, but then I realized this is actually fixed now as part of the efail fixes, specifically <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug 1464056</a>.

Since <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug 1464056</a> we don't (unless mail.decrypt_children) decrypt sub-parts of a message, meaning we have essentially already disabled encrypt+sign. Now only sign+encrypt is supported since only then the top level type would be application/pkcs7-mime. 

Can anyone confirm? Did I misunderstand something?
And yes, tripple-wrap would now be broken :/</pre></div><div class="change-set" id="c57"><div class="comment" data-id="13559947" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a51692780_176914"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-21 03:33 PDT" data-time="1534847636">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="13559947">What do you mean by &quot;sign+encrypt&quot;. Does that mean &quot;sign-then-encrypt&quot; or &quot;encrypt-then-sign&quot; ? What prevents the MTA attacks is when the recipient insists on encrypted-then-signed messages. The outer signature ensures that the encrypted message is integer. Purely encrypted messages are certainly still affected.

Nice if the eFail countermeasures cover also this bug. But this also seems to suggests that the countermeasures for this bug, had they ever been implemented, would have at least mitigated eFail.</pre></div><div class="change-set" id="c58"><div class="comment" data-id="13560039" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a51692780_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a51692780_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-21 04:38 PDT" data-time="1534851523">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="13560039">Yes s/+/-then-/

Good point, encrypted-only messages would still leak the then decrypted content back to the sender in a reply. Not sure what to do about that. If the encrypted part isn't signed-the-encrypted there's no knowing who encrypted it.

I didn't see any suggestions for how to handle that. Suggestions?</pre></div><div class="change-set" id="a82577125_101158"><div class="change" id="aa82577125_101158">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a82577125_101158"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_101158" id="a82577125_101158"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a82577125_101158"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a82577125_101158">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a82577125_101158">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-29 01:36 PDT" data-time="1535531785">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: Pidgeot18 &rarr; nobody</div><div class="change">Status: ASSIGNED &rarr; NEW</div><div class="change">OS: Linux &rarr; All</div><div class="change">Hardware: x86_64 &rarr; All</div><div class="change">Whiteboard: [basically fixed by efail fixes][decide what to do about encrypted-only emails]</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="13580803" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560895" id="a82577125_101158"><img src="https://secure.gravatar.com/avatar/136ce93c130a98810e3b0c369cb5d10c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_560895" id="a82577125_101158"><a class="email " href="/user_profile?user_id=560895" > <span class="fna">Falko Strenzke</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-30 00:02 PDT" data-time="1535612556">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="13580803">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks"
   href="/show_bug.cgi?id=1240290#c58">comment #58</a>)
<span class="quote">&gt; Yes s/+/-then-/
&gt; 
&gt; Good point, encrypted-only messages would still leak the then decrypted
&gt; content back to the sender in a reply. Not sure what to do about that. If
&gt; the encrypted part isn't signed-the-encrypted there's no knowing who
&gt; encrypted it.
&gt; 
&gt; I didn't see any suggestions for how to handle that. Suggestions?</span >

I think the only case which potentially can be defended against is where the original email was signed-then-encrypted. In that case, as I understand it, the decrypted message will start with a line

Content-Type: multipart/signed; protocol=&quot;application/pkcs7-signature&quot;; micalg=sha-512; boundary=&quot;------------ms040709010602000909080300&quot; 

If then no actual signature follows, the message can be classified as having been tampered with. Forging a useful first line should not be easily possible.</pre></div><div class="change-set" id="c60"><div class="comment" data-id="13580838" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a82577125_101158"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a82577125_101158"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-30 00:46 PDT" data-time="1535615188">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="13580838">In that case the message would be noted as unsigned. Or perhaps broken signature. (These things are hard to test.)

An encrypted-only message, or one with broken signature could leak information back in a reply. But given that the encrypted message can't be only a subpart anymore, the attacker can't e.g. add &quot;Hey, what do you think about the below?&quot;</pre></div><div class="change-set" id="a87033340_1689"><div class="change" id="aa87033340_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a87033340_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a87033340_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a87033340_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a87033340_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-19 15:26 PDT" data-time="1539988000">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c61"><div class="comment" data-id="13909357" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a87033340_1689"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 04:24 PST" data-time="1549542242">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-61" data-comment-id="13909357" data-ismarkdown="true" ><p>Kai, here&#39;s another building site (&quot;Baustelle&quot;) left unfinished.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c62"><div class="comment" data-id="14213128" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 08:27 PDT" data-time="1562167672">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-62" data-comment-id="14213128" data-ismarkdown="true" ><p>Let&#39;s try to summarize again what&#39;s remaining.</p>
<p>In my understanding, at the time this bug was reported, TB supported processing of &quot;encrypt-then-sign&quot; email (outer layer is a signature). If the outer signature was valid, Thunderbird would display a valid signature icon.</p>
<p>After efail, is has been claimed in this bug, that recent versions of TB no longer support messages that are &quot;encrypt-then-sign&quot; and never display signature status for those. Is my understanding of the claim correct?</p>
<p>We should verify the claim is correct. We now have some automated tests for S/MIME. We should add an appropriate test case, before we proceed with the discussion. I can work on that.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c63"><div class="comment" data-id="14213780" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a87033340_1689"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 12:39 PDT" data-time="1562182777">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-63" data-comment-id="14213780" data-ismarkdown="true" ><p>(In reply to Kai Engert (:kaie:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c62" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #62</a>)</p>
<blockquote>
<p>After efail, is has been claimed in this bug, that recent versions of TB no longer support messages that are &quot;encrypt-then-sign&quot; and never display signature status for those. Is my understanding of the claim correct?</p>
</blockquote>
<p>Apparently so, see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c56" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #56</a>, second paragraph.</p>
<p>It would be a pity to lose Joshua&#39;s clean-up work, see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c43" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #43</a>.</p>
</div></div><div class="change-set" id="c64"><div class="comment" data-id="14213828" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 12:58 PDT" data-time="1562183906">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-64" data-comment-id="14213828" data-ismarkdown="true" ><p>I produced two additional test messages.<br>
Both use an inner encrypted message part.</p>
<p>The first test message uses S/MIME clear signing, multipart/signed, for the outer layer.<br>
Opening that message displays a message with an &quot;invalid signature status&quot; icon.<br>
The inner encrypted text isn&#39;t decrypted, the inner plaintext contents aren&#39;t shown.</p>
<p>I&#39;ve toggled pref mailnews.p7m_subparts_external to false (default is true). With this change, the inner contents are decrypted. In addition, I get the encryption status icon.</p>
<p>I guess this confirms that the efail fix prevents the non-top-level message from being decrypted, in the multipart/signed scenario.</p>
<p>For the second test message, I used opaque signing. That is, we have only one MIME part, which is the base64 encoded CMS signature. Embedded inside the CMS signature is the encrypted CMS message.</p>
<p>This message is shown with an encryption icon, plus a valid signature status icon, and the inner message is decrypted and shown.</p>
<p>This means, we still process some encrypted-then-signed messages.</p>
</div></div><div class="change-set" id="c65"><div class="comment" data-id="14213839" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 13:03 PDT" data-time="1562184210">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-65" data-comment-id="14213839" data-ismarkdown="true" ><p>(In reply to Kai Engert (:kaie:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c64" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #64</a>)</p>
<blockquote>
<p>For the second test message, I used opaque signing. That is, we have only one MIME part, which is the base64 encoded CMS signature.</p>
</blockquote>
<p>Well, we have an additional MIME part nested insigned the opaque signature. That part is visible only after the decoding performed in mimecms.cpp</p>
<p>If our intention is to prevent nested encrypted messages, we must teach mimecms.cpp to peek at the content type it is decoding, and forbid it to process a contained encrypted message.</p>
</div></div><div class="change-set" id="c66"><div class="comment" data-id="14215735" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-04 13:58 PDT" data-time="1562273915">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-66" data-comment-id="14215735" data-ismarkdown="true" ><p>FYI, I have started to work on fixes. Including the tests, won&#39;t be a small amount of changes. I&#39;ll file a separate bug (tomorrow) to discuss the change (and CC all of you), so we can separate the general discussion from the suggested first round of fixes (I don&#39;t know if there will be more to come).</p>
</div></div><div class="change-set" id="c67"><div class="comment" data-id="14229056" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-11 05:45 PDT" data-time="1562849156">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9077374"
         class="attachment patch obsolete"
         data-id="9077374" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-nss-testsuite.patch">
      <meta itemprop="contentSize" content="5168">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9077374">
          <a class="link" href="attachment.cgi?id=9077374&amp;action=diff">
        <span id="att-9077374-description" itemprop="description">1240290-nss-testsuite.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9077374&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9077374">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-67" data-comment-id="14229056" data-ismarkdown="true" ><p>This patch creates new test cases for enveloped-then-signed messages.</p>
<p>It should be attached to, and reviewed in, a separate NSS bug. I&#39;ll postpone that, to avoid getting too much attention for now.</p>
</div><div class="activity"><div class="change">Assignee: nobody &rarr; kaie</div></div></div><div class="change-set" id="c68"><div class="comment" data-id="14229060" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-11 05:48 PDT" data-time="1562849281">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9077376"
         class="attachment patch obsolete"
         data-id="9077376" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-test-data.patch">
      <meta itemprop="contentSize" content="357903">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9077376">
          <a class="link" href="attachment.cgi?id=9077376&amp;action=diff">
        <span id="att-9077376-description" itemprop="description">1240290-test-data.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9077376&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9077376">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-68" data-comment-id="14229060" data-ismarkdown="true" ><p>This patch was created by refreshing the NSS test suite data, with NSS that includes the previous patch. It includes the additional envelope-then-sign testcases.</p>
</div></div><div class="change-set" id="c69"><div class="comment" data-id="14320047" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 09:08 PDT" data-time="1566749302">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-69" data-comment-id="14320047" data-ismarkdown="true" ><p>Sigh. Somehow, previously,  I had failed to notice that Joshua had attached a patch. Sorry. I have worked on an alternative patch.</p>
<p>Looking at Josh&#39;s patch now, my patch is less invasive. Given that Joshua&#39;s patch had triggered crashes, we don&#39;t know what side effects that rework might cause, and given that the S/MIME code has changed in 2018 during the EFAIL fixes, and given that we recently changed how the S/MIME code checks that a status update is related to the currently shown message (based on URIs), it might be useful to start with my patch, which is also just half the size.</p>
</div></div><div class="change-set" id="c70"><div class="comment" data-id="14320048" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 09:08 PDT" data-time="1566749323">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9087994"
         class="attachment patch obsolete"
         data-id="9087994" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-fix-v2.patch">
      <meta itemprop="contentSize" content="55906">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9087994">
          <a class="link" href="attachment.cgi?id=9087994&amp;action=diff">
        <span id="att-9087994-description" itemprop="description">1240290-fix-v2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9087994&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9087994">Splinter Review</a>
      </div>
    </div></div><div class="change-set" id="c71"><div class="comment" data-id="14320049" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 09:09 PDT" data-time="1566749395">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9087995"
         class="attachment patch obsolete"
         data-id="9087995" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-nss-testsuite-v2.patch">
      <meta itemprop="contentSize" content="10167">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9087995">
          <a class="link" href="attachment.cgi?id=9087995&amp;action=diff">
        <span id="att-9087995-description" itemprop="description">1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)</span></a> (obsolete)
        — <a href="attachment.cgi?id=9087995&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9087995">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9077374&amp;action=edit"
           title="1240290-nss-testsuite.patch"
           class=""
        >Attachment #9077374</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c72"><div class="comment" data-id="14320050" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a87033340_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a87033340_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 09:10 PDT" data-time="1566749433">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9087996"
         class="attachment patch"
         data-id="9087996" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-test-data-v2.patch">
      <meta itemprop="contentSize" content="417795">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9087996">
          <a class="link" href="attachment.cgi?id=9087996&amp;action=diff">
        <span id="att-9087996-description" itemprop="description">1240290-test-data-v2.patch</span></a>
        — <a href="attachment.cgi?id=9087996&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9087996">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9077376&amp;action=edit"
           title="1240290-test-data.patch"
           class=""
        >Attachment #9077376</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a113794813_36541"><div class="change" id="aa113794813_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a113794813_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a113794813_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a113794813_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 09:11 PDT" data-time="1566749473">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8903424&amp;action=edit"
           title="Forbid encrypt &amp; sign (outdated, crashes)"
           class=""
        >Attachment #8903424</a> -
        Attachment description: Forbid encrypt &amp; sign &rarr; Forbid encrypt &amp; sign (outdated, crashes)</div><div class="change">
        <a href="/attachment.cgi?id=8903424&amp;action=edit"
           title="Forbid encrypt &amp; sign (outdated, crashes)"
           class=""
        >Attachment #8903424</a> -
        Flags: review-</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="14320065" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 10:15 PDT" data-time="1566753328">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-73" data-comment-id="14320065" data-ismarkdown="true" ><p>The released versions of TB, already no longer display any S/MIME signature status for Falko&#39;s attached sample messages.</p>
<p>However, there&#39;s at least one similar scenario, which is unfixed in released versions, and which is fixed by the latest patch.<br>
I&#39;ll iterate through the scenarios, which are covered by the added tests.</p>
<p>As a reminder, &quot;clear text signed&quot; means the &quot;multipart/signed&quot; mechanism (actively used by Thunderbird when creating signatures),<br>
while &quot;opaque signed&quot; means the &quot;application/pkcs7-mime&quot; type, which embeds the message and signature in a CMS blog, but without encryption (this kind of signature is used by Outlook, and supported by Thunderbird for decoding and display).</p>
<p>In all scenarios below that use two signatures, the first (inner signature) is by Alice.</p>
<p>(1) Inner Encrypted, then outer &quot;opaque signed&quot;.</p>
<p>Released Thunderbird shows that as correctly signed and encrypted. Because the inner encrypted message could have originally been intended for a different recipient, we had already decided that we don&#39;t want to allow/display this kind of combination.</p>
<p>The message contents are shown.</p>
<p>The efail fixes have been incomplete to detect this scenario, which consists of two nested &quot;application/pkcs7-mime&quot; messages.</p>
<p>With the fix applied:<br>
Message NOT shown, invalid signature.</p>
<p>(2) Inner Encrypted, then outer &quot;clear-text signed&quot;.</p>
<p>Released TB shows that as &quot;invalid signature&quot;.</p>
<p>Message contents are NOT shown, rather we get an attachment.</p>
<p>With the fix applied:<br>
Same.</p>
<p>(3) Similar to 1, but with an additional outer signature layer. Inner Encrypted, then outer &quot;opaque signed&quot;, then again opaque signed by Dave.</p>
<p>Released TB shows that encrypted, and with a bad signature from Alice. The additional signature isn&#39;t mentioned.</p>
<p>The message contents are shown.</p>
<p>With the fix applied:<br>
Message NOT shown, invalid signature.</p>
<p>(4) Similar to 2, but with an additional outer signature layer. Inner Encrypted, then outer &quot;clear-text signed&quot;, then again opaque signed by Dave.</p>
<p>Released TB shows that as having a bad signature from Alice. The additional signature isn&#39;t mentioned.</p>
<p>Message contents are NOT shown, rather we get an attachment.</p>
<p>With the fix applied:<br>
Message NOT shown, no attachment, invalid signature.</p>
<p>(5) Two signatures, inner opaque signed, outer opaque signed by Dave.</p>
<p>Released TB shows that as a &quot;mismatch signature&quot; from Alice, because Dave is the sender. The additional signature isn&#39;t mentioned.</p>
<p>The message contents are shown.</p>
<p>With the fix applied:<br>
Message NOT shown, no attachment, invalid signature.</p>
<p>(6) Two signatures, inner clear-text signed, outer opaque signed by Dave.</p>
<p>Released TB shows that as a &quot;mismatch signature&quot; from Alice, because Dave is the sender. The additional signature isn&#39;t mentioned.</p>
<p>The message contents are shown.</p>
<p>With the fix applied:<br>
Message NOT shown, no attachment, invalid signature.</p>
<p>(7) Two signatures, inner opaque signed, outer clear-text signed by Dave.</p>
<p>Released TB shows that as a good signature from Dave.</p>
<p>The message contents are NOT shown, and we get an attachment.</p>
<p>With the fix applied:<br>
Same</p>
<p>(8) Two signatures, inner clear-text signed, outer clear-text signed by Dave.</p>
<p>Released TB shows that as a mismatch signature from Alice, the second signature isn&#39;t mentioned.</p>
<p>Message contents are shown,.</p>
<p>With the fix applied:<br>
Message NOT shown, no attachment, invalid signature.</p>
</div></div><div class="change-set" id="c74"><div class="comment" data-id="14320072" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 10:25 PDT" data-time="1566753915">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-74" data-comment-id="14320072" data-ismarkdown="true" ><p>To summarize the previous comment:</p>
<ul>
<li>
<p>Scenario 1 should have been fixed by EFAIL, but wasn&#39;t.</p>
</li>
<li>
<p>If we detect that more than one signature is present,  we&#39;ll never show the email contents.</p>
</li>
<li>
<p>If we detect that more than one signature is present, we&#39;ll usually show an invalid signature status. The exception is scenario 7, if the inner message looks like an encrypted message, which we don&#39;t decode, we don&#39;t detect that we have two signatures.</p>
</li>
</ul>
<p>Because this fix doesn&#39;t require any new UI or new strings, we should consider to backport it to TB 68.x. (My only worry is that we don&#39;t have automated tests for the pasts EFAIL scenarios yet. I&#39;ve filed a bug to get that done eventually.)</p>
<p>(In the future, we could consider to improve the UI. Instead of simply not showing a message, we could inform the user about the reason for not showing the message. I suggest to track that in a separate bug.)</p>
</div></div><div class="change-set" id="c75"><div class="comment" data-id="14320199" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 14:55 PDT" data-time="1566770156">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-75" data-comment-id="14320199" data-ismarkdown="true" ><p>Maybe we shouldn&#39;t allow scenario 7 either?<br>
I&#39;ll attach an incremental patch, which treats scenario 7 the same as the other ones: shown with an invalid signature.</p>
</div></div><div class="change-set" id="c76"><div class="comment" data-id="14320200" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 14:56 PDT" data-time="1566770177">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9088033"
         class="attachment patch obsolete"
         data-id="9088033" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-incremental-fix-for-scenario-7.patch">
      <meta itemprop="contentSize" content="18815">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9088033">
          <a class="link" href="attachment.cgi?id=9088033&amp;action=diff">
        <span id="att-9088033-description" itemprop="description">1240290-incremental-fix-for-scenario-7.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9088033&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9088033">Splinter Review</a>
      </div>
    </div></div><div class="change-set" id="c77"><div class="comment" data-id="14320201" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 14:57 PDT" data-time="1566770244">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-77" data-comment-id="14320201" data-ismarkdown="true" ><p>Please give me your opinions, if the behavior of the fixes described in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c73" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment 73</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c74" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment 74</a> are good improvements.</p>
<p>Also, please tell me your opinion on <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c75" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment 75</a>.</p>
</div></div><div class="change-set" id="c78"><div class="comment" data-id="14320230" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a113794813_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-25 16:08 PDT" data-time="1566774494">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-78" data-comment-id="14320230" data-ismarkdown="true" ><p>Difficult stuff, especially on a Sunday late at night. That aside, how relevant to all this is the &quot;half-Efail&quot; fix of not decoding any child parts? Pref mailnews.p7m_subparts_external implemented in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1464056" title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward">bug 1464056</a> (apparently causing crashes) and regressing <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1524750" title="RESOLVED WONTFIX - Thunderbird cannot decode correctly emails containing .eml attachments">bug 1524750</a>. Can that pref be removed or flipped around at some stage?</p>
<p>So (1) and (2) are encrypted, then signed in two different ways and (3) and (4) are similar but with additional signatures. Maybe a silly question: since you have two signing mechanisms, there are four cases of adding two signatures, just like you have four cases in (5)-(8). IOW, (3) = (1) + op sig, (4) = 2 + op sig, what about (1) + cl sig and (2) + cl sig? Sorry, you have to educate us all.</p>
<p>So cases (5) to (8) have no encrypted part? They are just four permutation of clear/opaque. I&#39;m surprised that the system handles those signature types so differently. What&#39;s the point of not showing the messages? It&#39;s definitely being tampered with? Wouldn&#39;t it be desirable to show invalid signatures for all four cases?</p>
</div></div><div class="change-set" id="c79"><div class="comment" data-id="14328016" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-28 05:34 PDT" data-time="1566995662">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-79" data-comment-id="14328016" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c78" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #78</a>)</p>
<blockquote>
<p>how relevant to all this is the &quot;half-Efail&quot; fix of not decoding any child parts? Pref mailnews.p7m_subparts_external implemented in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1464056" title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward">bug 1464056</a> (apparently causing crashes) and regressing <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1524750" title="RESOLVED WONTFIX - Thunderbird cannot decode correctly emails containing .eml attachments">bug 1524750</a>. Can that pref be removed or flipped around at some stage?</p>
</blockquote>
<p>We don&#39;t want to flip the pref, that would re-introduce security issues. We want to remove the pref and keep the current default, I&#39;ve filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1576828" title="RESOLVED FIXED - Remove pref mailnews.p7m_subparts_external">bug 1576828</a> for that.</p>
<p>I&#39;ve explained why <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1524750" title="RESOLVED WONTFIX - Thunderbird cannot decode correctly emails containing .eml attachments">bug 1524750</a> isn&#39;t a bug, but rather the intended behavior.  I agree user feedback could be better, see <a class="bz_bug_link
          bz_status_NEW" href="/show_bug.cgi?id=1576655" title="NEW - Better UI feedback when nested cryptographic parts in emails aren&#39;t shown (S/MIME or OpenPGP)">bug 1576655</a>.</p>
<p>You didn&#39;t say what crashes you&#39;re referring to. Are you talking about <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1464056#c51" title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward">bug 1464056 comment 51</a> from me? If yes, then yes, the patch here will fix potential crashes, by avoiding the early return, and reaching the init code at the end of mime_find_class.</p>
</div></div><div class="change-set" id="c80"><div class="comment" data-id="14328168" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a113794813_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-28 07:07 PDT" data-time="1567001265">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1240290&amp;comment_id=14328168"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-80" data-comment-id="14328168" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c78" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #78</a>)</p>
<blockquote>
<p>So (1) and (2) are encrypted, then signed in two different ways and (3) and (4) are similar but with additional signatures, just like you have four cases in (5)-(8).</p>
</blockquote>
<p>Correct.</p>
<blockquote>
<p>Maybe a silly question: since you have two signing mechanisms, there are four cases of adding two signatures,</p>
</blockquote>
<p>I&#39;ve added tests for all four combinations of the two signature mechanisms. See <span class="bz_obsolete"><a href="/attachment.cgi?id=9087994" name="attach_9087994" title="1240290-fix-v2.patch">attachment 9087994</a> <a href="/attachment.cgi?id=9087994&amp;action=edit" title="1240290-fix-v2.patch">[details]</a> <a href="/attachment.cgi?id=9087994&amp;action=diff" title="1240290-fix-v2.patch">[diff]</a></span> <a href="/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9087994">[review]</a> and search for &quot;// sign, then sign again&quot;. That section has 16 tests (4 sig combinations * 4 hash algorithm variations).</p>
<p>That&#39;s scenarios 5, 6, 7, 8 from above.</p>
<p>It&#39;s correct, I didn&#39;t test all of those with the additional encrypt.<br>
Test cases 1 and 2 should sufficiently test that we don&#39;t decrypt the inner encrypted part, if they are wrapped inside a signature of either of the two styles.</p>
<p>It&#39;s true that for completeness I could potentially add variations of the encrypt-sign-sign scenarios 3 and 4, which use the multipart sig for the outermost layer, but I didn&#39;t consider it necessary.</p>
<blockquote>
<p>So cases (5) to (8) have no encrypted part? They are just four permutation of clear/opaque.</p>
</blockquote>
<p>right.</p>
<blockquote>
<p>I&#39;m surprised that the system handles those signature types so differently.</p>
</blockquote>
<p>That&#39;s because they work very differently!</p>
<p>For the signature type &quot;multipart/signed&quot;, we have multiple mime parts. Outer multipart/signed, with inner &quot;any encoding&quot; plus second inner part &quot;application/pkcs7-signature&quot;.  MIME handler in mimemcms.cpp. That&#39;s because no other content shares that mime type.</p>
<p>The second signature type uses the same mime type as encryption, and it&#39;s just a single mime part.</p>
<p>Although they look slightly different:</p>
<pre><code>Content-Type: application/pkcs7-mime; name=&quot;smime.p7m&quot;; smime-type=enveloped-data
Content-Description: S/MIME Encrypted Message
</code></pre>
<p>vs.</p>
<pre><code>Content-Type: application/pkcs7-mime; name=smime.p7m; smime-type=signed-data
Content-Description: S/MIME Cryptographic Signature
</code></pre>
<p>we route both of them through the same MIME decoder type in &quot;mimecms.cpp&quot;.</p>
<p>The smime-type might be lying. We can&#39;t be certain what&#39;s inside, until we are decoding that CMS message blob. Because it could potentially be encrypted content (which we want to prevent from being exposed accidentally), we don&#39;t look inside it, we already prevent processing it.</p>
<blockquote>
<p>What&#39;s the point of not showing the messages?</p>
</blockquote>
<p>Arguments:</p>
<ul>
<li>
<p>We want to fix scenario 1. That means, whenever we see an outer layer that is opaque signed, we don&#39;t want to decode the inner parts that could be either signed (inner opaque) or encrypted. Consequently, we&#39;d no longer show the contents for scenario 5 (which is only signatures, no encryption), and also no longer show contents for scenario 3.</p>
</li>
<li>
<p>If we fix scenario 1, the only scenarios with a double-signature that could potentially still show contents are 6 and 8. However, for consistency reasons, I&#39;d prefer to NOT show contents for anything that has a double signature.</p>
</li>
</ul>
<blockquote>
<p>It&#39;s definitely being tampered with?</p>
</blockquote>
<p>Unknown.</p>
<blockquote>
<p>Wouldn&#39;t it be desirable to show invalid signatures for all four cases?</p>
</blockquote>
<p>Yes, that&#39;s why I&#39;m suggesting. That&#39;s why for consistency reasons, I&#39;ve also worked on the additional incremental fix for scenario 7.<br>
(If we agree we want that, I&#39;ll merge the incremental patch, so we only have one patch for code review.)</p>
<p>While looking around, I decided that I should also review function MIMEGetRelativeCryptoNestLevel if it&#39;s still a good implementation.</p>
</div></div><div class="change-set" id="c81"><div class="comment" data-id="14328182" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a113794813_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a113794813_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-28 07:13 PDT" data-time="1567001639">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-81" data-comment-id="14328182" data-ismarkdown="true" ><p>(In reply to Kai Engert (:kaie:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c79" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #79</a>)</p>
<blockquote>
<p>You didn&#39;t say what crashes you&#39;re referring to. Are you talking about <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1464056#c51" title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward">bug 1464056 comment 51</a> from me?</p>
</blockquote>
<p>Yes. I&#39;ll look at <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c80" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #80</a> later.</p>
</div></div><div class="change-set" id="a114118735_36541"><div class="change" id="aa114118735_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114118735_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a114118735_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a114118735_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a114118735_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a114118735_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:09 PDT" data-time="1567073395">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8905162&amp;action=edit"
           title="(for old patch) 1240290-crash.txt - crash on now profile with no certificates installed"
           class=""
        >Attachment #8905162</a> -
        Attachment description: 1240290-crash.txt - crash on now profile with no certificates installed &rarr; (for old patch) 1240290-crash.txt - crash on now profile with no certificates installed</div></div></div><div class="change-set" id="a114118750_36541"><div class="change" id="aa114118750_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114118750_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a114118750_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a114118750_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a114118750_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a114118750_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:10 PDT" data-time="1567073410">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8905166&amp;action=edit"
           title="(for old patch) 1240290-crash2.txt"
           class=""
        >Attachment #8905166</a> -
        Attachment description: 1240290-crash2.txt &rarr; (for old patch) 1240290-crash2.txt</div></div></div><div class="change-set" id="a114118792_36541"><div class="change" id="aa114118792_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114118792_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a114118792_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a114118792_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a114118792_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a114118792_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:10 PDT" data-time="1567073452">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9087995&amp;action=edit"
           title="1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)"
           class=""
        >Attachment #9087995</a> -
        Attachment description: 1240290-nss-testsuite-v2.patch (for NSS) &rarr; 1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)</div></div></div><div class="change-set" id="c82"><div class="comment" data-id="14329926" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114118792_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114118792_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:17 PDT" data-time="1567073845">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-82" data-comment-id="14329926" data-ismarkdown="true" ><p>Justification for the implementation approach I&#39;m using:</p>
<p>Because of the flow of the streaming processing of MIME data, we face the following dilemma:<br>
The outer signature is processed first, and triggers a call to the signedStatus callback.<br>
If the signature is valid, we get a good status in the user interface.</p>
<p>It is difficult to prevent sending the positive signature status, because I don&#39;t know of a way to peek inside the inner contents.<br>
It seems easier to allow the inner contents to override the earlier signature status.</p>
<p>Consequently, we&#39;ll get multiple notifications. That&#39;s why the code is enhanced to never allow overriding of a bad status with a good status. Regardless which status came first, the bad status for a message will always prevail.</p>
<p>That&#39;s also why we the &quot;extra&quot; variable for the individual tests, the tests must wait until we get the expected amount of notifications.</p>
</div></div><div class="change-set" id="c83"><div class="comment" data-id="14329948" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114118792_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114118792_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:38 PDT" data-time="1567075095">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="14329948">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=9087995" name="attach_9087995" title="1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)">attachment 9087995</a> <a href="/attachment.cgi?id=9087995&amp;action=edit" title="1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)">[details]</a> <a href="/attachment.cgi?id=9087995&amp;action=diff" title="1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9087995'>[review]</a>
1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)

Moving this patch to NSS <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1577448">bug 1577448</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9087995&amp;action=edit"
           title="1240290-nss-testsuite-v2.patch (will be reviewed in separate NSS bug)"
           class=""
        >Attachment #9087995</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a114120514_36541"><div class="change" id="aa114120514_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114120514_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a114120514_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a114120514_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a114120514_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a114120514_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:39 PDT" data-time="1567075174">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1577448">1577448</a></div></div></div><div class="change-set" id="c84"><div class="comment" data-id="14329952" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114120514_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114120514_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:41 PDT" data-time="1567075315">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9089015"
         class="attachment patch obsolete"
         data-id="9089015" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-fix-v3.patch">
      <meta itemprop="contentSize" content="71169">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9089015">
          <a class="link" href="attachment.cgi?id=9089015&amp;action=diff">
        <span id="att-9089015-description" itemprop="description">1240290-fix-v3.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9089015&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9089015">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-84" data-comment-id="14329952" data-ismarkdown="true" ><p>merging v2 and incremental fix into new v3</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9087994&amp;action=edit"
           title="1240290-fix-v2.patch"
           class=""
        >Attachment #9087994</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=9088033&amp;action=edit"
           title="1240290-incremental-fix-for-scenario-7.patch"
           class=""
        >Attachment #9088033</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c85"><div class="comment" data-id="14329967" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114120514_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114120514_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 03:52 PDT" data-time="1567075925">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9089016"
         class="attachment patch obsolete"
         data-id="9089016" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-fix-v4.patch">
      <meta itemprop="contentSize" content="66477">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9089016">
          <a class="link" href="attachment.cgi?id=9089016&amp;action=diff">
        <span id="att-9089016-description" itemprop="description">1240290-fix-v4.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9089016&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9089016">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-85" data-comment-id="14329967" data-ismarkdown="true" ><p>merged to trunk (comm-central), merging on top of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1571481" title="RESOLVED FIXED - Covert Content Attack on S/MIME are (still) possible for multipart/alternative">bug 1571481</a>.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9089015&amp;action=edit"
           title="1240290-fix-v3.patch"
           class=""
        >Attachment #9089015</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a114121825_36541"><div class="change" id="aa114121825_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a114121825_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a114121825_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a114121825_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 04:01 PDT" data-time="1567076485">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [basically fixed by efail fixes][decide what to do about encrypted-only emails] &rarr; [fixes an undetected scenario from efail][fixes handling of multiple layers]</div></div></div><div class="change-set" id="c86"><div class="comment" data-id="14331303" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-29 14:36 PDT" data-time="1567114602">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-86" data-comment-id="14331303">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=9089016" name="attach_9089016" title="1240290-fix-v4.patch">attachment 9089016</a> <a href="/attachment.cgi?id=9089016&amp;action=edit" title="1240290-fix-v4.patch">[details]</a> <a href="/attachment.cgi?id=9089016&amp;action=diff" title="1240290-fix-v4.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9089016'>[review]</a>
1240290-fix-v4.patch

I think this is ready for review.

Magnus, would you like to review here in bugzilla?
(Let me know if you prefer to review in phabricator. I haven't yet tested the setup for security sensitive patches with phabricator, but it should work.)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9089016&amp;action=edit"
           title="1240290-fix-v4.patch"
           class=""
        >Attachment #9089016</a> -
        Flags: review?(mkmelin+mozilla)</div></div></div><div class="change-set" id="c87"><div class="comment" data-id="14332006" data-no="87"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-87" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a114121825_36541"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-87"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-87" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c87">Comment 87</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-30 01:49 PDT" data-time="1567154998">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-87">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-87" data-comment-id="14332006">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=9089016" name="attach_9089016" title="1240290-fix-v4.patch">attachment 9089016</a> <a href="/attachment.cgi?id=9089016&amp;action=edit" title="1240290-fix-v4.patch">[details]</a> <a href="/attachment.cgi?id=9089016&amp;action=diff" title="1240290-fix-v4.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9089016'>[review]</a>
1240290-fix-v4.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=9089016" name="attach_9089016" title="1240290-fix-v4.patch">attachment 9089016</a> <a href="/attachment.cgi?id=9089016&amp;action=edit" title="1240290-fix-v4.patch">[details]</a> <a href="/attachment.cgi?id=9089016&amp;action=diff" title="1240290-fix-v4.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9089016'>[review]</a>:
-----------------------------------------------------------------

::: mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js
&#64;&#64; +38,5 &#64;&#64;
<span class="quote">&gt; +  
&gt; +  /**
&gt; +   * Returns NULL if the current window isn't related to a folder, which
&gt; +   * means that comparison by URI is unnecessary.
&gt; +   */</span >

Please use jsdoc style, so something like
&#64;return the URI of the selected message, or null if the current message displayed isn't in a folder

Maybe it should be named getSelectedMessageURI?

&#64;&#64; +61,5 &#64;&#64;
<span class="quote">&gt;        return;
&gt;      }
&gt; +
&gt; +    let selURI = this.getSelectedURI();
&gt; +    if (selURI != null &amp;&amp; selURI != aMsgNeckoURL) {</span >

just do a truthy check 

if (selURI &amp;&amp; selURI != aMsgNeckoURL)

... or well. you can just do

if (aMsgNeckoURL != this.getSelectedURI())

&#64;&#64; +67,4 &#64;&#64;
<span class="quote">&gt;        return;
&gt;      }
&gt;  
&gt; +    if (gSignatureStatusForURI != null &amp;&amp;</span >

just if (gSignatureStatusForURI

... but the == check would take care of it too, right?

::: mailnews/mime/src/mimecms.cpp
&#64;&#64; +176,5 &#64;&#64;
<span class="quote">&gt; +  }
&gt; +  return false;
&gt; +}
&gt; +
&gt; +</span >

nit: remove double newline

&#64;&#64; +468,5 &#64;&#64;
<span class="quote">&gt; +    // inner encrypted part could have been produced by an attacker who
&gt; +    // stripped away a part containing the signature (S/MIME doesn't
&gt; +    // have integrity protection).
&gt; +    // A sign-then-sign encoding is confusing, too, because
&gt; +    // be an attempt to confuse the which part would be shown as having a signature?</span >

missing an &quot;it&quot; here

&#64;&#64; +608,5 &#64;&#64;
<span class="quote">&gt; +    return -1;
&gt; +  }
&gt; +
&gt; +  if (!data-&gt;skip_content &amp;&amp; !data-&gt;decoder_context) {
&gt; +    /* If we don't skip, we should have a context. */</span >

would use // style for comments

&#64;&#64; +646,5 &#64;&#64;
<span class="quote">&gt;  
&gt; +  if (data-&gt;skip_content) {
&gt; +    /* Skipping content means, we detected a forbidden combination
&gt; +     * of CMS objects, so let's make sure we replace the parent status
&gt; +     * with a bad status. */</span >

here too //

::: mailnews/mime/test/unit/test_smime_decrypt.js
&#64;&#64; +198,5 &#64;&#64;
<span class="quote">&gt; + * - match_content: By default (true), we expect that our processing of
&gt; + *                  the message shows the usual message from Alice
&gt; + *                  to Bob. If false, we expect the message isn't
&gt; + *                  shown.
&gt; + *                  (ignored for bad signatures.)</span >

I. 
Don't need the parenthesis

&#64;&#64; +372,5 &#64;&#64;
<span class="quote">&gt;      // dump(&quot;contents: &quot; + contents + &quot;\n&quot;);
&gt;  
&gt;      if (!msg.sig || msg.sig_good) {
&gt; +      let expected = &quot;This is a test message from Alice to Bob.&quot;;
&gt; +      if (!(&quot;match_content&quot; in msg) || msg.match_content ) {</span >

Seems you never set match_content to anything?
And is this if clause correct? match_content is true by default</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9089016&amp;action=edit"
           title="1240290-fix-v4.patch"
           class=""
        >Attachment #9089016</a> -
        Flags: <span class="activity-deleted">review?(mkmelin+mozilla)</span></div></div></div><div class="change-set" id="c88"><div class="comment" data-id="14332278" data-no="88"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-88" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-88"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-88" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c88">Comment 88</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-30 05:04 PDT" data-time="1567166650">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-88">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9089345"
         class="attachment patch obsolete"
         data-id="9089345" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-fix-v5.patch">
      <meta itemprop="contentSize" content="65821">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9089345">
          <a class="link" href="attachment.cgi?id=9089345&amp;action=diff">
        <span id="att-9089345-description" itemprop="description">1240290-fix-v5.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9089345&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9089345">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-88" data-comment-id="14332278" data-ismarkdown="true" ><p>I&#39;ve addressed all your comments. I&#39;ve removed the match_content code, that was leftover from an earlier revision.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9089016&amp;action=edit"
           title="1240290-fix-v4.patch"
           class=""
        >Attachment #9089016</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=9089345&amp;action=edit"
           title="1240290-fix-v5.patch"
           class=""
        >Attachment #9089345</a> -
        Flags: review?(mkmelin+mozilla)</div></div></div><div class="change-set" id="c89"><div class="comment" data-id="14332353" data-no="89"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-89" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a114121825_36541"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-89"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-89" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c89">Comment 89</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-30 05:37 PDT" data-time="1567168667">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-89">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-89" data-comment-id="14332353">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=9089345" name="attach_9089345" title="1240290-fix-v5.patch">attachment 9089345</a> <a href="/attachment.cgi?id=9089345&amp;action=edit" title="1240290-fix-v5.patch">[details]</a> <a href="/attachment.cgi?id=9089345&amp;action=diff" title="1240290-fix-v5.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9089345'>[review]</a>
1240290-fix-v5.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=9089345" name="attach_9089345" title="1240290-fix-v5.patch">attachment 9089345</a> <a href="/attachment.cgi?id=9089345&amp;action=edit" title="1240290-fix-v5.patch">[details]</a> <a href="/attachment.cgi?id=9089345&amp;action=diff" title="1240290-fix-v5.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9089345'>[review]</a>:
-----------------------------------------------------------------

LGTM, r=mkmelin

::: mailnews/mime/src/mimemcms.cpp
&#64;&#64; +379,5 &#64;&#64;
<span class="quote">&gt;  }
&gt;  
&gt; +static void MimeMultCMS_suppressed_child(void *crypto_closure) {
&gt; +  /* I'm a multipart/signed. If one of my cryptographic child elements
&gt; +   * was suppressed, then I want my signature to be shown as invalid. */</span >

nit: // style please

::: mailnews/mime/src/mimemsg.cpp
&#64;&#64; +681,5 &#64;&#64;
<span class="quote">&gt;      return status;
&gt;    }
&gt;  
&gt; +  /* If this is the outermost message, then now is the time to run the
&gt; +   * post_header_html_fn. */</span >

here too //

::: mailnews/mime/src/mimemsig.cpp
&#64;&#64; +531,5 &#64;&#64;
<span class="quote">&gt;    int status = 0;
&gt;    MimeObject *body;
&gt;  
&gt; +  if (!sig-&gt;crypto_closure) {
&gt; +    /* We might have decided to skip processing this part. */</span >

//

&#64;&#64; +544,5 &#64;&#64;
<span class="quote">&gt;    if (obj-&gt;options &amp;&amp; obj-&gt;options-&gt;headers != MimeHeadersCitation &amp;&amp;
&gt;        obj-&gt;options-&gt;write_html_p &amp;&amp; obj-&gt;options-&gt;output_fn &amp;&amp;
&gt;        obj-&gt;options-&gt;headers != MimeHeadersCitation &amp;&amp; sig-&gt;crypto_closure) {
&gt; +    /* Calling crypto_generate_html may trigger wanted side effects.
&gt; +     * But we're no longer using its results. */</span >

//</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9089345&amp;action=edit"
           title="1240290-fix-v5.patch"
           class=""
        >Attachment #9089345</a> -
        Flags: review?(mkmelin+mozilla) &rarr; review+</div></div></div><div class="change-set" id="c90"><div class="comment" data-id="14341645" data-no="90"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-90" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-90"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-90" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c90">Comment 90</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-04 09:11 PDT" data-time="1567613508">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-90">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9090421"
         class="attachment patch obsolete"
         data-id="9090421" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-fix-v5-plus-nits.patch">
      <meta itemprop="contentSize" content="48679">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9090421">
          <a class="link" href="attachment.cgi?id=9090421&amp;action=diff">
        <span id="att-9090421-description" itemprop="description">1240290-fix-v5-plus-nits.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9090421&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090421">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-90" data-comment-id="14341645" data-ismarkdown="true" ><p>fixed the comments</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9089345&amp;action=edit"
           title="1240290-fix-v5.patch"
           class=""
        >Attachment #9089345</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=9090421&amp;action=edit"
           title="1240290-fix-v5-plus-nits.patch"
           class=""
        >Attachment #9090421</a> -
        Flags: review+</div></div></div><div class="change-set" id="c91"><div class="comment" data-id="14343187" data-no="91"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-91" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-91"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-91" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c91">Comment 91</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-05 02:54 PDT" data-time="1567677255">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-91">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9090661"
         class="attachment patch"
         data-id="9090661" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-fix-v6-comm-central.patch">
      <meta itemprop="contentSize" content="49275">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9090661">
          <a class="link" href="attachment.cgi?id=9090661&amp;action=diff">
        <span id="att-9090661-description" itemprop="description">1240290-fix-v6-comm-central.patch (merged context changes)</span></a>
        — <a href="attachment.cgi?id=9090661&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090661">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-91" data-comment-id="14343187" data-ismarkdown="true" ><p>Same patch as before, just merged to trunk, necessary because of context changes (new prettier).</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9090421&amp;action=edit"
           title="1240290-fix-v5-plus-nits.patch"
           class=""
        >Attachment #9090421</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=9090661&amp;action=edit"
           title="1240290-fix-v6-comm-central.patch (merged context changes)"
           class=""
        >Attachment #9090661</a> -
        Flags: review+</div></div></div><div class="change-set" id="c92"><div class="comment" data-id="14343202" data-no="92"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-92" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-92"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-92" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c92">Comment 92</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-05 03:05 PDT" data-time="1567677900">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-92">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9090665"
         class="attachment patch"
         data-id="9090665" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-esr68-test-data.patch">
      <meta itemprop="contentSize" content="510233">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9090665">
          <a class="link" href="attachment.cgi?id=9090665&amp;action=diff">
        <span id="att-9090665-description" itemprop="description">1240290-esr68-test-data.patch</span></a>
        — <a href="attachment.cgi?id=9090665&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090665">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-92" data-comment-id="14343202" data-ismarkdown="true" ><p>test data for ESR 68 branch</p>
</div></div><div class="change-set" id="c93"><div class="comment" data-id="14343203" data-no="93"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-93" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-93"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-93" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c93">Comment 93</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-05 03:06 PDT" data-time="1567677992">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-93">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9090666"
         class="attachment patch obsolete"
         data-id="9090666" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-backport-esr68.patch">
      <meta itemprop="contentSize" content="49568">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9090666">
          <a class="link" href="attachment.cgi?id=9090666&amp;action=diff">
        <span id="att-9090666-description" itemprop="description">1240290-backport-esr68.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9090666&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9090666">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-93" data-comment-id="14343203" data-ismarkdown="true" ><p>Patch backported to ESR 68 branch.<br>
Excludes new prettier changes.<br>
Includes the small change from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1532573" title="RESOLVED FIXED - In TB S/MIME tests, adjust email addresses from bogus to example">bug 1532573</a> which fixes the @bogus.com email addresses in the test script to @example.com to be compatible with the latest test data.</p>
</div></div><div class="change-set" id="c94"><div class="comment" data-id="14371799" data-no="94"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-94" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-94"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-94" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c94">Comment 94</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 08:02 PDT" data-time="1568905347">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-94">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9093925"
         class="attachment patch"
         data-id="9093925" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1240290-esr68-backport-v2.patch">
      <meta itemprop="contentSize" content="49894">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9093925">
          <a class="link" href="attachment.cgi?id=9093925&amp;action=diff">
        <span id="att-9093925-description" itemprop="description">1240290-esr68-backport-v2.patch</span></a>
        — <a href="attachment.cgi?id=9093925&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1240290&attachment=9093925">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-94" data-comment-id="14371799" data-ismarkdown="true" ><p>formatting changes on tb 68 branch require this updated backport patch</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9090666&amp;action=edit"
           title="1240290-backport-esr68.patch"
           class=""
        >Attachment #9090666</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c95"><div class="comment" data-id="14371920" data-no="95"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-95" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-95"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-95" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c95">Comment 95</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 08:43 PDT" data-time="1568907837">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-95">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-95" data-comment-id="14371920" data-ismarkdown="true" ><p>Checkin-needed? Or you can land after the next M-C merge, perhaps in about 20 minutes from now.</p>
</div></div><div class="change-set" id="c96"><div class="comment" data-id="14371925" data-no="96"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-96" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-96"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-96" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c96">Comment 96</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 08:46 PDT" data-time="1568907960">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-96">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-96" data-comment-id="14371925" data-ismarkdown="true" ><p>BTW, I&#39;m doing TB 70 beta 2 today or tomorrow. You want to ship it there?</p>
</div></div><div class="change-set" id="c97"><div class="comment" data-id="14372633" data-no="97"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-97" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-97"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-97" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c97">Comment 97</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 15:10 PDT" data-time="1568931012">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-97">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-97" data-comment-id="14372633">Comment on <span class=""><a href="/attachment.cgi?id=9090661" name="attach_9090661" title="1240290-fix-v6-comm-central.patch (merged context changes)">attachment 9090661</a> <a href="/attachment.cgi?id=9090661&amp;action=edit" title="1240290-fix-v6-comm-central.patch (merged context changes)">[details]</a> <a href="/attachment.cgi?id=9090661&amp;action=diff" title="1240290-fix-v6-comm-central.patch (merged context changes)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9090661'>[review]</a>
1240290-fix-v6-comm-central.patch (merged context changes)

That goes for the data patch, too.

Why is the ESR 68 patch different? c-esr68 should be reformatted now, to the trunk patch should (almost) apply.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9090661&amp;action=edit"
           title="1240290-fix-v6-comm-central.patch (merged context changes)"
           class=""
        >Attachment #9090661</a> -
        Flags: approval-comm-beta+</div></div></div><div class="change-set" id="c98"><div class="comment" data-id="14372637" data-no="98"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-98" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-98"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-98" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c98">Comment 98</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 15:11 PDT" data-time="1568931117">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-98">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-98" data-comment-id="14372637" data-ismarkdown="true" ><p>Try looks good so far:<br>
<a href="https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=514cb59d06af6043f6ced7b7ef726a79c977a2ed" rel="nofollow">https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=514cb59d06af6043f6ced7b7ef726a79c977a2ed</a></p>
</div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div><div class="change">Target Milestone: --- &rarr; Thunderbird 71.0</div></div></div><div class="change-set" id="c99"><div class="comment" data-id="14372659" data-no="99"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-99" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-99"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-99" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c99">Comment 99</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 15:28 PDT" data-time="1568932094">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-99">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-99" data-comment-id="14372659" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+2) (reduced availability 14-19 of Sept.) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c97" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #97</a>)</p>
<blockquote>
<p>Why is the ESR 68 patch different? c-esr68 should be reformatted now, to the<br>
trunk patch should (almost) apply.</p>
</blockquote>
<p>That was explained in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c93" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment 93</a>.</p>
<p>Resulting test data is the same, it&#39;s just that 68 has an older snapshot, and therefore the patch looks different.</p>
</div></div><div class="change-set" id="c100"><div class="comment" data-id="14372689" data-no="100"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-100" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-100"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-100" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c100">Comment 100</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 15:58 PDT" data-time="1568933930">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-100">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-100" data-comment-id="14372689" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/comm-central/rev/e17cea8e7c348566ed1c250396c796a9d18d4a00" rel="nofollow">https://hg.mozilla.org/comm-central/rev/e17cea8e7c348566ed1c250396c796a9d18d4a00</a><br>
<a href="https://hg.mozilla.org/comm-central/rev/5f3a5f96cc9b1b4f52f652e46fd433c4c08717ec" rel="nofollow">https://hg.mozilla.org/comm-central/rev/5f3a5f96cc9b1b4f52f652e46fd433c4c08717ec</a></p>
<p>I took the test data from the try run since it was different from <span class=""><a href="/attachment.cgi?id=9087996" name="attach_9087996" title="1240290-test-data-v2.patch">attachment 9087996</a> <a href="/attachment.cgi?id=9087996&amp;action=edit" title="1240290-test-data-v2.patch">[details]</a> <a href="/attachment.cgi?id=9087996&amp;action=diff" title="1240290-test-data-v2.patch">[diff]</a></span> <a href="/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9087996">[review]</a>.</p>
<p>I forgot to run linting and clang-format, I hope you have, or else, I&#39;ll land a follow-up in a minute.</p>
</div><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2019-09-19 15:58 PDT" data-time="1568933930">2 years ago</span></div><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c101"><div class="comment" data-id="14372703" data-no="101"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-101" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-101"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-101" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c101">Comment 101</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-19 16:07 PDT" data-time="1568934458">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-101">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-101" data-comment-id="14372703" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/comm-central/rev/6542dc3163386308ccb3bd4db7e914d2eb402844" rel="nofollow">https://hg.mozilla.org/comm-central/rev/6542dc3163386308ccb3bd4db7e914d2eb402844</a> - reformat C++ code.</p>
</div></div><div class="change-set" id="c102"><div class="comment" data-id="14373463" data-no="102"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-102" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-102"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-102" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c102">Comment 102</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 03:06 PDT" data-time="1568973992">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-102">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-102" data-comment-id="14373463" data-ismarkdown="true" ><p>TB 70 beta 2:<br>
<a href="https://hg.mozilla.org/releases/comm-beta/rev/07b204800f62b72a0543808c980172bae81b2ef0" rel="nofollow">https://hg.mozilla.org/releases/comm-beta/rev/07b204800f62b72a0543808c980172bae81b2ef0</a><br>
<a href="https://hg.mozilla.org/releases/comm-beta/rev/d38017afcf62c5833a3c01793a8fed474270edc4" rel="nofollow">https://hg.mozilla.org/releases/comm-beta/rev/d38017afcf62c5833a3c01793a8fed474270edc4</a><br>
<a href="https://hg.mozilla.org/releases/comm-beta/rev/4d287273469c94afe9e33a2f7c8414bbc4c6254e" rel="nofollow">https://hg.mozilla.org/releases/comm-beta/rev/4d287273469c94afe9e33a2f7c8414bbc4c6254e</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_70&amp;o1=isnotempty">status-thunderbird70</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_70&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_71&amp;o1=isnotempty">status-thunderbird71</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_71&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c103"><div class="comment" data-id="14374255" data-no="103"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-103" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-103"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-103" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c103">Comment 103</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 11:03 PDT" data-time="1569002621">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-103">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-103" data-comment-id="14374255">Comment on <span class=""><a href="/attachment.cgi?id=9093925" name="attach_9093925" title="1240290-esr68-backport-v2.patch">attachment 9093925</a> <a href="/attachment.cgi?id=9093925&amp;action=edit" title="1240290-esr68-backport-v2.patch">[details]</a> <a href="/attachment.cgi?id=9093925&amp;action=diff" title="1240290-esr68-backport-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9093925'>[review]</a>
1240290-esr68-backport-v2.patch

Approved for TB 68.2 (or let's discuss whether 68.1.1 doesn't make more sense since we can get feedback from a smaller group of users on the ESR channel first).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9093925&amp;action=edit"
           title="1240290-esr68-backport-v2.patch"
           class=""
        >Attachment #9093925</a> -
        Flags: approval-comm-esr68+</div></div></div><div class="change-set" id="c104"><div class="comment" data-id="14374393" data-no="104"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-104" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-104"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-104" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c104">Comment 104</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 12:33 PDT" data-time="1569007988">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-104">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-104" data-comment-id="14374393" data-ismarkdown="true" ><p>I&#39;d prefer to let it bake on Beta for 1-2 weeks, prior to make a decision about shipping in 68.x stable.</p>
</div></div><div class="change-set" id="c105"><div class="comment" data-id="14374433" data-no="105"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-105" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-105"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-105" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c105">Comment 105</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 12:46 PDT" data-time="1569008816">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-105">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-105" data-comment-id="14374433" data-ismarkdown="true" ><p>My experience shows that beta users don&#39;t use any &quot;sophisticated&quot; or uncommon features. Hence my suggestion was to spin it one week on 70 beta 2 and if good, put it on TB 68.1.1 which is not widely distributed so far. Then have it spin there for 1-2 weeks before we ship 68.2 to 25 million users.</p>
</div></div><div class="change-set" id="c106"><div class="comment" data-id="14374455" data-no="106"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-106" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-106"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-106" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c106">Comment 106</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 13:02 PDT" data-time="1569009729">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-106">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-106" data-comment-id="14374455" data-ismarkdown="true" ><p>Why does 68.1.1 have fewer users than 68.2 ? Because we haven&#39;t yet automatically upgraded users from 60.x to 68.x ?</p>
</div></div><div class="change-set" id="c107"><div class="comment" data-id="14374457" data-no="107"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-107" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-107"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-107" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c107">Comment 107</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 13:03 PDT" data-time="1569009828">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-107">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-107" data-comment-id="14374457" data-ismarkdown="true" ><p>Yes.</p>
</div></div><div class="change-set" id="c108"><div class="comment" data-id="14374779" data-no="108"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-108" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a114121825_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-108"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-108" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c108">Comment 108</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-20 16:07 PDT" data-time="1569020854">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-108">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-108" data-comment-id="14374779" data-ismarkdown="true" ><p>Ok. Nevertheless, it would be unfortunate if the first 68.x version that 60.x users upgrade to has broken S/MIME support.</p>
<p>But if we cannot realistically expect that anyone uses Beta builds to test S/MIME with real world scenarios, then all we can do is rely on our tests.</p>
</div></div><div class="change-set" id="c109"><div class="comment" data-id="14377864" data-no="109"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-109" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a114121825_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a114121825_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-109"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-109" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c109">Comment 109</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 01:27 PDT" data-time="1569227220">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1240290&amp;comment_id=14377864"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-109">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-109" data-comment-id="14377864" data-ismarkdown="true" ><p>So does that mean we go for 68.1.1 or 68.2? Surely you&#39;ve viewed some valid S/MIME messages and they&#39;re still displayed OK, right? Plus we have some tests that cover the most common scenarios.</p>
<p>I discussed this with Magnus and he and I are cool to ship this in 68.1.1. Could you do an ESR68 try run with your patches. Please backout<br>
<a href="https://hg.mozilla.org/releases/comm--esr68/rev/af3c68874f9b040b1751db49e8e041e7330c4651" rel="nofollow">https://hg.mozilla.org/releases/comm--esr68/rev/af3c68874f9b040b1751db49e8e041e7330c4651</a> (EDIT: destroyed link)<br>
as part of the try since it caused Mochitest (bct) failures.</p>
</div></div><div class="change-set" id="a116272863_176914"><div class="change" id="aa116272863_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a116272863_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a116272863_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a116272863_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a116272863_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a116272863_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 01:32 PDT" data-time="1569227523">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c110"><div class="comment" data-id="14378046" data-no="110"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-110" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a116272863_176914"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a116272863_176914"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-110"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-110" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c110">Comment 110</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 03:01 PDT" data-time="1569232879">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-110">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-110" data-comment-id="14378046" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c109" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #109</a>)</p>
<blockquote>
<p>Could you do an ESR68 try run with your patches.</p>
</blockquote>
<p>Started:<br>
<a href="https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=54e8f5341997ebb515d951fac91df383c44fe381" rel="nofollow">https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=54e8f5341997ebb515d951fac91df383c44fe381</a></p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c111"><div class="comment" data-id="14378101" data-no="111"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-111" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a116272863_176914"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a116272863_176914"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-111"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-111" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c111">Comment 111</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 03:37 PDT" data-time="1569235049">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-111">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-111" data-comment-id="14378101" data-ismarkdown="true" ><p>Once ready, I&#39;ll run the 68.x try build as my primary client for testing.</p>
</div></div><div class="change-set" id="c112"><div class="comment" data-id="14378103" data-no="112"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-112" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a116272863_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a116272863_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-112"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-112" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c112">Comment 112</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 03:39 PDT" data-time="1569235166">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-112">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-112" data-comment-id="14378103" data-ismarkdown="true" ><p>Good move, that&#39;s what I&#39;ve been doing all along with the 68.x series, starting at its beta release :-)</p>
</div></div><div class="change-set" id="c113"><div class="comment" data-id="14378239" data-no="113"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-113" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a116272863_176914"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a116272863_176914"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-113"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-113" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c113">Comment 113</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 05:00 PDT" data-time="1569240044">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-113">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-113" data-comment-id="14378239" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1240290#c105" title="RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks">comment #105</a>)</p>
<blockquote>
<p>spin it one week on 70 beta 2 and if good, put it on TB 68.1.1 which is not widely distributed so far. Then have it spin there for 1-2 weeks before we ship 68.2 to 25 million users.</p>
</blockquote>
<p>Sounds reasonable.  But it remains to be seen whether it would be 68.1.2, 68.2.0 (in 4-5 weeks) or a 68.2.1 where we <em>fully</em> unthrottle updates.</p>
</div></div><div class="change-set" id="a116317478_1689"><div class="change" id="aa116317478_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a116317478_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a116317478_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a116317478_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a116317478_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a116317478_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-23 13:55 PDT" data-time="1569272138">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: mail-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c114"><div class="comment" data-id="14380174" data-no="114"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-114" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a116317478_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a116317478_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-114"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-114" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c114">Comment 114</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-24 01:40 PDT" data-time="1569314440">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-114">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-114" data-comment-id="14380174" data-ismarkdown="true" ><p>I haven&#39;t seen issues in the limited amount of test message that I could find. If you&#39;re ok with the risk, I&#39;m ok to ship with 68.1.1</p>
</div></div><div class="change-set" id="c115"><div class="comment" data-id="14380185" data-no="115"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-115" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a116317478_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a116317478_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-115"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-115" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c115">Comment 115</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-24 01:48 PDT" data-time="1569314883">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-115">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-115" data-comment-id="14380185" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9093925" name="attach_9093925" title="1240290-esr68-backport-v2.patch">attachment 9093925</a> <a href="/attachment.cgi?id=9093925&amp;action=edit" title="1240290-esr68-backport-v2.patch">[details]</a> <a href="/attachment.cgi?id=9093925&amp;action=diff" title="1240290-esr68-backport-v2.patch">[diff]</a></span> <a href="/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9093925">[review]</a><br>
1240290-esr68-backport-v2.patch</p>
<h3>ESR Uplift Approval Request</h3>
<ul>
<li><strong>If this is not a sec:{high,crit} bug, please state case for ESR consideration</strong>: long standing spoofing issue, and waiting one year for a fix is too long</li>
<li><strong>User impact if declined</strong>: continous exposure to spoofing scenarios</li>
<li><strong>Fix Landed on Version</strong>: 71</li>
<li><strong>Risk to taking this patch</strong>: Medium</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: It&#39;s uncertain if we have sufficiently tested all S/MIME message scenarios, there&#39;s a risk for a regression in treating S/MIME messages correctly.</li>
<li><strong>String or UUID changes made by this patch</strong>: none</li>
</ul>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9093925&amp;action=edit"
           title="1240290-esr68-backport-v2.patch"
           class=""
        >Attachment #9093925</a> -
        Flags: approval-mozilla-esr68?</div></div></div><div class="change-set" id="a116360227_36541"><div class="change" id="aa116360227_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a116360227_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a116360227_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a116360227_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a116360227_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a116360227_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-24 01:48 PDT" data-time="1569314887">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9090665&amp;action=edit"
           title="1240290-esr68-test-data.patch"
           class=""
        >Attachment #9090665</a> -
        Flags: approval-mozilla-esr68?</div></div></div><div class="change-set" id="c116"><div class="comment" data-id="14380202" data-no="116"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-116" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a116360227_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a116360227_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-116"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-116" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c116">Comment 116</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-24 01:59 PDT" data-time="1569315577">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-116">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-116" data-comment-id="14380202">Comment on <span class=""><a href="/attachment.cgi?id=9093925" name="attach_9093925" title="1240290-esr68-backport-v2.patch">attachment 9093925</a> <a href="/attachment.cgi?id=9093925&amp;action=edit" title="1240290-esr68-backport-v2.patch">[details]</a> <a href="/attachment.cgi?id=9093925&amp;action=diff" title="1240290-esr68-backport-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9093925'>[review]</a>
1240290-esr68-backport-v2.patch

Wrong flag. Already approved for comm-esr68.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9093925&amp;action=edit"
           title="1240290-esr68-backport-v2.patch"
           class=""
        >Attachment #9093925</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr68?</span></div></div></div><div class="change-set" id="c117"><div class="comment" data-id="14380204" data-no="117"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-117" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a116360227_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a116360227_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-117"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-117" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c117">Comment 117</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-24 02:01 PDT" data-time="1569315666">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-117">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-117" data-comment-id="14380204">Comment on <span class=""><a href="/attachment.cgi?id=9090665" name="attach_9090665" title="1240290-esr68-test-data.patch">attachment 9090665</a> <a href="/attachment.cgi?id=9090665&amp;action=edit" title="1240290-esr68-test-data.patch">[details]</a> <a href="/attachment.cgi?id=9090665&amp;action=diff" title="1240290-esr68-test-data.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1240290&amp;attachment=9090665'>[review]</a>
1240290-esr68-test-data.patch

Same here. We don't need to approve all patches individually. A flag on one of them is enough not to miss the bug. But since I'm here, I'll apply it. There's also a reformatting changeset which I'll apply to ESR68 as well.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9090665&amp;action=edit"
           title="1240290-esr68-test-data.patch"
           class=""
        >Attachment #9090665</a> -
        Flags: approval-mozilla-esr68? &rarr; approval-comm-esr68+</div></div></div><div class="change-set" id="c118"><div class="comment" data-id="14380349" data-no="118"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-118" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a116360227_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a116360227_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-118"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-118" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c118">Comment 118</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-24 03:55 PDT" data-time="1569322526">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-118">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-118" data-comment-id="14380349" data-ismarkdown="true" ><p>TB 68.1.1 ESR:<br>
<a href="https://hg.mozilla.org/releases/comm-esr68/rev/137371bf8d261c76b13f409303f1a4e586250e99" rel="nofollow">https://hg.mozilla.org/releases/comm-esr68/rev/137371bf8d261c76b13f409303f1a4e586250e99</a><br>
<a href="https://hg.mozilla.org/releases/comm-esr68/rev/75cae72a8bb7499fefb512189202fa12af485dbe" rel="nofollow">https://hg.mozilla.org/releases/comm-esr68/rev/75cae72a8bb7499fefb512189202fa12af485dbe</a><br>
<a href="https://hg.mozilla.org/releases/comm-esr68/rev/41c0a3653f95cf6158a2b49ab7cb19327c50e9e8" rel="nofollow">https://hg.mozilla.org/releases/comm-esr68/rev/41c0a3653f95cf6158a2b49ab7cb19327c50e9e8</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr68&amp;o1=isnotempty">status-thunderbird_esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr68&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr68&amp;o1=isnotempty">tracking-thunderbird_esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr68&amp;o1=equals&amp;v1=69%2B">69+</a></div></div></div><div class="change-set" id="a116561546_280903"><div class="change" id="aa116561546_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a116561546_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a116561546_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a116561546_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a116561546_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a116561546_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-26 09:43 PDT" data-time="1569516206">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2019-11755</div></div></div><div class="change-set" id="c119"><div class="comment" data-id="14389064" data-no="119"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-119" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a116561546_280903"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a116561546_280903"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-119"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-119" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#c119">Comment 119</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-27 02:21 PDT" data-time="1569576113">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-119">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-119" data-comment-id="14389064" data-ismarkdown="true" ><p><a href="https://www.mozilla.org/en-US/security/advisories/mfsa2019-32/#CVE-2019-11755" rel="nofollow">https://www.mozilla.org/en-US/security/advisories/mfsa2019-32/#CVE-2019-11755</a></p>
</div></div><div class="change-set" id="a125683651_176914"><div class="change" id="aa125683651_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a125683651_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a125683651_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a125683651_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a125683651_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a125683651_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-09 22:38 PST" data-time="1578638311">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_REOPENED"
   title="REOPENED - Attachments missed from complex MIME (posta certificata)"
   href="/show_bug.cgi?id=1607872">1607872</a></div></div></div><div class="change-set" id="a127863861_36541"><div class="change" id="aa127863861_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a127863861_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a127863861_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a127863861_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a127863861_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a127863861_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-02-04 04:15 PST" data-time="1580818521">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - TB crashes during opening s/mime signed mail from mailman mailinglist"
   href="/show_bug.cgi?id=1611105">CVE-2020-6795</a></div></div></div><div class="change-set" id="a143949893_1689"><div class="change" id="aa143949893_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a143949893_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a143949893_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a143949893_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a143949893_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1240290#a143949893_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-08 09:35 PDT" data-time="1596904553">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1240290&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>