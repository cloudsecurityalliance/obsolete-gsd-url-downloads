<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>e27936ef82d33a5f286e1f2f22817aa682f79e90 - infra/infra - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><link rel="stylesheet" type="text/css" href="/+static/doc.css"><link rel="stylesheet" type="text/css" href="/+static/prettify/prettify.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://chromium.googlesource.com/login/infra/infra/%2B/e27936ef82d33a5f286e1f2f22817aa682f79e90">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">chromium</a> / <a class="Breadcrumbs-crumb" href="/infra/">infra</a> / <a class="Breadcrumbs-crumb" href="/infra/infra/">infra</a> / <span class="Breadcrumbs-crumb">e27936ef82d33a5f286e1f2f22817aa682f79e90</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>e27936ef82d33a5f286e1f2f22817aa682f79e90</td><td><span>[<a href="/infra/infra/+log/e27936ef82d33a5f286e1f2f22817aa682f79e90">log</a>]</span> <span>[<a href="/infra/infra/+archive/e27936ef82d33a5f286e1f2f22817aa682f79e90.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Jason Robbins &lt;jrobbins@chromium.org&gt;</td><td>Thu Jun 07 23:33:46 2018</td></tr><tr><th class="Metadata-title">committer</th><td>Commit Bot &lt;commit-bot@chromium.org&gt;</td><td>Thu Jun 07 23:33:46 2018</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/">606ed0ea662fd5b860df4443ae85f4b6ae32d5d8</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90%5E">4a543064ae2f35f9c22136bb8e0270d84a440afe</a> <span>[<a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">[Monorail] Prevent request inflation via groupby=.

R=seanmccullough@chromium.org

Bug: b/109802037
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I93cce0c79e4767a89cee173f1d4e6148d2a5b45b">I93cce0c79e4767a89cee173f1d4e6148d2a5b45b</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/1092030">https://chromium-review.googlesource.com/1092030</a>
Reviewed-by: Sean McCullough &lt;seanmccullough@chromium.org&gt;
Commit-Queue: Jason Robbins &lt;jrobbins@chromium.org&gt;
</pre><ul class="DiffTree"><li><a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine/monorail/framework/framework_constants.py">appengine/monorail/framework/framework_constants.py</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90%5E%21/#F0">diff</a>]</span></li><li><a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine/monorail/framework/monorailrequest.py">appengine/monorail/framework/monorailrequest.py</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90%5E%21/#F1">diff</a>]</span></li><li><a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine/monorail/framework/test/monorailrequest_test.py">appengine/monorail/framework/test/monorailrequest_test.py</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90%5E%21/#F2">diff</a>]</span></li><li><a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine/monorail/tracker/tracker_constants.py">appengine/monorail/tracker/tracker_constants.py</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90%5E%21/#F3">diff</a>]</span></li></ul><div class="DiffSummary">4 files changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 606ed0ea662fd5b860df4443ae85f4b6ae32d5d8</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - .gitattributes"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/.gitattributes">.gitattributes</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - .gitignore"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/.gitignore">.gitignore</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - CONTRIBUTING.md"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/CONTRIBUTING.md">CONTRIBUTING.md</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - DEPS"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/DEPS">DEPS</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - LICENSE"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/LICENSE">LICENSE</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - OWNERS"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/OWNERS">OWNERS</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - PRESUBMIT.py"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/PRESUBMIT.py">PRESUBMIT.py</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - README.md"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/README.md">README.md</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - WATCHLISTS"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/WATCHLISTS">WATCHLISTS</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - WHITESPACE"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/WHITESPACE">WHITESPACE</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - appengine/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine/">appengine/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - appengine_module/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine_module/">appengine_module/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - bootstrap/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/bootstrap/">bootstrap/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - build/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/build/">build/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - cipd/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/cipd/">cipd/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - codereview.settings"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/codereview.settings">codereview.settings</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - crdx/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/crdx/">crdx/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - data/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/data/">data/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - doc/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/doc/">doc/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - docker/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/docker/">docker/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - glyco/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/glyco/">glyco/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - go/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/go/">go/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - infra/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/infra/">infra/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - infra_libs/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/infra_libs/">infra_libs/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - navbar.md"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/navbar.md">navbar.md</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - node/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/node/">node/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - packages/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/packages/">packages/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - recipes/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/recipes/">recipes/</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - roll-deps.py"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/roll-deps.py">roll-deps.py</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - run.py"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/run.py">run.py</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - test.py"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/test.py">test.py</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - test/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/test/">test/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - utils/"><a class="FileList-itemLink" href="/infra/infra/+/e27936ef82d33a5f286e1f2f22817aa682f79e90/utils/">utils/</a></li></ol><div class="InlineReadme"><div class="InlineReadme-path">README.md</div><div class="doc"><h1><a class="h" name="infra_git-repository" href="#infra_git-repository"><span></span></a>infra.git repository</h1><p>Welcome to the Chrome Infra repository!</p><p>Wondering where to start? Check out <a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/doc/index.md">General Chrome Infrastructure documentation</a>. In particular, to check out this repo and the rest of the infrastructure code, follow the instructions <a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/doc/source.md">here</a>. The rest of this page is specific to this repo.</p><h2><a class="h" name="Entry-points" href="#Entry-points"><span></span></a><a class="h" name="entry-points" href="#entry-points"><span></span></a>Entry points</h2><ul><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/run.py">run.py</a>: wrapper script to run programs contained in subdirectories without having to deal with <code class="code">sys.path</code> modifications.</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/test.py">test.py</a>: multi-purpose script to run tests.</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/infra_libs">infra_libs/</a>: generally useful functions and classes</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/infra/services">infra/services/</a>: standalone programs intended to be run as daemons.</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/infra/tools">infra/tools</a>: command-line tools, intended to be run by developers.</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/appengine">appengine/</a>: many Chrome-infra-managed AppEngine applications</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/infra/experimental">infra/experimental</a>: for, well, experimental stuff. Once they are stabilized and reviewed, they should be moved in a more permanent place.</li></ul><h2><a class="h" name="Miscellaneous-technical-stuff" href="#Miscellaneous-technical-stuff"><span></span></a><a class="h" name="miscellaneous-technical-stuff" href="#miscellaneous-technical-stuff"><span></span></a>Miscellaneous technical stuff</h2><ul><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/bootstrap">bootstrap/</a>: utilities to set up a proper Python virtual environment.</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/infra/path_hacks">infra/path_hacks</a>: submodules of this modules give access to modules in the build/ repository. <code class="code">from infra.path_hacks.common import &lt;stg&gt;</code> is actually getting <code class="code">&lt;stg&gt;</code> from <a href="https://chromium.googlesource.com/chromium/tools/build/+/master/scripts/common">build/scripts/common</a>.</li><li><a href="e27936ef82d33a5f286e1f2f22817aa682f79e90/utils">utils/</a>: purpose? utils?</li><li>Need to bump infra/deployed to pick up changes?<ul><li><code class="code">git push origin &lt;updated hash&gt;:deployed</code></li><li>mail chrome-troopers@, include:<ul><li>previously deployed hash (for quick rollback)</li><li>the hash you just pushed</li><li>the list of CLs that made this push necessary</li><li>the output of the <code class="code">git push</code> command</li></ul></li></ul></li></ul><h2><a class="h" name="Integrating-tests-with-test_py" href="#Integrating-tests-with-test_py"><span></span></a><a class="h" name="integrating-tests-with-test_py" href="#integrating-tests-with-test_py"><span></span></a>Integrating tests with test.py</h2><p>If you&#39;ve added a new module, integrate your tests with test.py:</p><ol><li>Create a .coveragerc file in the root directory of the module you want to test. Take a look at another .coveragerc to see what to include in that.</li><li>Create a &ldquo;test&rdquo; directory in the root directory of the module you want to test. More your *_test.py files to this directory.</li></ol><p>Double-check that your tests are getting picked up when you want them to be: <code class="code">./test.py test &lt;path-to-package&gt;</code>.</p><p>Tests still not getting picked up by test.py? Double-check to make sure you have <strong>init</strong>.py files in each directory of your module so Python recognizes it as a package.</p></div></div></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>