<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1420296 - (CVE-2020-6809) Webextensions can access local files">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1420296">
<meta property="og:description"
      content="VERIFIED (rob) in WebExtensions - General. Last updated 2020-12-18.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1420296 - (CVE-2020-6809) Webextensions can access local files</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1420296&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1420296">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1420296">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/yui.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/global.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/util.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"blocking\":{\"cf_blocking_webextensions\":\"---\"},\"project\":{\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox72\":\"wontfix\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox73\":\"wontfix\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr68\":\"wontfix\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox74\":\"verified\"}},\"comments\":{\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"blocking\",\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1420296;
  BUGZILLA.bug_title = '1420296 - (CVE-2020-6809) Webextensions can access local files';
  BUGZILLA.bug_summary = 'Webextensions can access local files';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1420296';
  BUGZILLA.bug_keywords = 'sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/field.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/comments.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1420296">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1420296"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1420296 - (CVE-2020-6809) Webextensions can access local files">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="BB3OGOc6GGIR2OAklFW5cDJrEyCGTNwmPzio4xn71AGxvRuZevozSHgJihaJCsZfO0c7ahsaJHrbqL0hAS7TUNB2tdbiOnPOWRCgBXqz71jr48EheGXMveEjvKKGG4u6xIpGDckYlIKOjf8YDxhm4pfWjErmYjJAb5yPDV1IzRr6tFRVjZ1nSqp1gLOyhAly5PyKYu6z4VmqWEclE9jLSE4OAEJKOlJorFCLD5WwvXry40dOBrEcfLIwcn5Ej9Yt">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1420296" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623264-omh_Sxct4gFS8vl_d9ZBaEo4ryoB2O4NnV2nFOXGHrY">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1420296" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1420296" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1420296">Bug 1420296</a>
          <span class="edit-hide">(CVE-2020-6809)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2017-11-23 14:42 PST" data-time="1511476943">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2020-01-14 13:52 PST" data-time="1579038767">2 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Webextensions can access local files</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Webextensions can access local files

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (WebExtensions :: General, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=WebExtensions" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">WebExtensions
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">WebExtensions</div>
            <div class="description">File feature requests and bugs related to the WebExtension add-on API.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=WebExtensions&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=WebExtensions"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="WebExtensions"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=WebExtensions&component=General#General" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">General
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">WebExtensions :: General</div>
            <div class="description">All other bugs about WebExtensions</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=WebExtensions&amp;component=General&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=WebExtensions&amp;component=General&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=WebExtensions&amp;component=General"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="WebExtensions" data-component="General"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            57 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox-esr68 wontfix, firefox72 wontfix, firefox73 wontfix, firefox74 verified)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla74

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr68</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox72</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox73</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox74</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr68</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr68-dirty">
  <select id="cf_status_firefox_esr68" name="cf_status_firefox_esr68">
        <option value="wontfix"
          id="v4417_cf_status_firefox_esr68" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox72</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox72-dirty">
  <select id="cf_status_firefox72" name="cf_status_firefox72">
        <option value="wontfix"
          id="v4506_cf_status_firefox72" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox73</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox73-dirty">
  <select id="cf_status_firefox73" name="cf_status_firefox73">
        <option value="wontfix"
          id="v4549_cf_status_firefox73" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox74</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox74-dirty">
  <select id="cf_status_firefox74" name="cf_status_firefox74">
        <option value="verified"
          id="v4575_cf_status_firefox74" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

      <div class="field edit-show" style="display:none"
>
    <div class="name">Blocking Flags:
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">webextensions</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_blocking_webextensions-dirty">
  <select id="cf_blocking_webextensions" name="cf_blocking_webextensions">
        <option value="---"
          id="v2817_cf_blocking_webextensions" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: jan, Assigned: robwu, Mentored)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_447061" ><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=447061" > <span class="fna">robwu</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-bug_mentors"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=106098" > <span class="fna">kmag</span></a>
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_547788" ><img src="https://secure.gravatar.com/avatar/922adfc5538ed07a332c6f248f30ffa1?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=547788" > <span class="fna">jan</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_372685" ><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=372685" > <span class="fna">mixedpuppy</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="41">41 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Local files can access other files in the same directory"
   href="/show_bug.cgi?id=803143">803143</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">1427448</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file"
   href="/show_bug.cgi?id=1487353">1487353</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1420296&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1420296">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list" id="field-regresses"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - webRequest listeners are not called for subresources loaded by file:// pages"
   href="/show_bug.cgi?id=1621935">1621935</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - content scripts cannot fetch contents of file URIs"
   href="/show_bug.cgi?id=1644488">1644488</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Is this a bug that get any files by path when you have applied &lt;all_urls&gt; of permissions key?"
   href="/show_bug.cgi?id=1420360">1420360</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-moderate, Whiteboard: webext-sec [post-critsmash-triage][adv-main74+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2020-6809

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">webext-sec [post-critsmash-triage][adv-main74+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_553429" ><a class="email " href="/user_profile?user_id=553429" > <span class="fna">brindusat</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a67712091_553429"
            class="rel-time-title activity-ref"
            title="2 years ago"
        data-time="1579189034"
      >qe-verify</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_553429" ><a class="email " href="/user_profile?user_id=553429" > <span class="fna">brindusat</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1942998">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1942998-dirty">
      <select id="flag-1942998" name="flag-1942998"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (6 files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8936952">file_same_origin.patch</a>
        </div>
        <div>
            <a href="#c19" class="attach-time activity-ref"><span class="rel-time" title="2017-12-14 14:34 PST" data-time="1513290867">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_446257" ><a class="email " href="/user_profile?user_id=446257" > <span class="fna">Andrea Marchesini [:baku]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.12 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_465500" ><span class="fn">bkelly</span>
</div>:
              <a href="#c21"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1513290867"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8936952&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8936952&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1420296&attachment=8936952">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9105000">fileaccess.xpi</a>
        </div>
        <div>
            <a href="#c53" class="attach-time activity-ref"><span class="rel-time" title="2019-10-29 11:59 PDT" data-time="1572375557">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_372685" ><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div></span>
        </div>
        <div class="attach-info">722 bytes,
          application/x-xpinstall        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9105000&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9111270">Bug 1420296 - Add file check to WebExtensionPolicy</a>
        </div>
        <div>
            <a href="#c60" class="attach-time activity-ref"><span class="rel-time" title="2019-11-25 08:09 PST" data-time="1574698187">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_447061" ><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9111270&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9111270">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9111271">Bug 1420296 - Add tests for file access from extensions</a>
        </div>
        <div>
            <a href="#c61" class="attach-time activity-ref"><span class="rel-time" title="2019-11-25 08:12 PST" data-time="1574698334">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_447061" ><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9111271&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9111271">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9111273">Bug 1420296 - Test for same-origin file requests</a>
        </div>
        <div>
            <a href="#c62" class="attach-time activity-ref"><span class="rel-time" title="2019-11-25 08:12 PST" data-time="1574698351">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_447061" ><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9111273&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9111273">Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9131374">advisory.txt</a>
        </div>
        <div>
            <a href="#c76" class="attach-time activity-ref"><span class="rel-time" title="2020-03-05 21:21 PST" data-time="1583472072">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">250 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9131374&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
  </div>
  
</footer>
  </div>
</section>



<script nonce="OxFg07JmIXnmjwTUZZV2LGh2f5CWMUK0Iwd3quV3KmId9P8a">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12869915" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_547788" ><img src="https://secure.gravatar.com/avatar/922adfc5538ed07a332c6f248f30ffa1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_547788" ><a class="email " href="/user_profile?user_id=547788" > <span class="fna">Jan Biniok</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 14:42 PST" data-time="1511476943">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="12869915">User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/62.0.3202.89 Chrome/62.0.3202.89 Safari/537.36

Steps to reproduce:

Try the code from this stack overflow answer at a webextension:

<a rel="nofollow" href="https://stackoverflow.com/questions/42108782/firefox-webextensions-get-local-files-content-by-path/44516256#44516256">https://stackoverflow.com/questions/42108782/firefox-webextensions-get-local-files-content-by-path/44516256#44516256</a>

And you'll see that it is possible to read local files without user interaction.

More information:

As far as I know this is at the moment used by Stylus and a beta version of Tampermonkey (my extension). At Tampermonkey it's necessary that the user _explicitly_ enables file access, just like it's necessary at Chrome, in order to use it. 

However, since the stack overflow answer was posted on 2017-05-13, I guess there are some more extensions that use it. That's why and since AMO currently is using a faster/automatic review I'm a little bit concerned that other extension might use it in a non-good-natured way, because the review process is unable to detect it (in opposition to Firefox's legacy API add-ons where the reviewers took account of this).

Finally, please think about implementing user-permitted file _read_ access. It's one of the most requested features of Tampermonkey.
<a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Implement local filesystem read/write access."
   href="/show_bug.cgi?id=1246236">https://bugzilla.mozilla.org/show_bug.cgi?id=1246236</a>
<a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Extensions can not load file: URLs"
   href="/show_bug.cgi?id=1266960">https://bugzilla.mozilla.org/show_bug.cgi?id=1266960</a>


Actual results:

It's possible to read local files without any user interaction.


Expected results:

It should (not/only after user confirmation) be possible to access local files.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="12869952" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 15:07 PST" data-time="1511478459">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="12869952">Only files under $HOME, or also elsewhere? (background: when e10s is enabled, I would expect sandboxing to prohibit accessing files outside of $HOME)</pre><div class="activity"><div class="change">Group: firefox-core-security &rarr; toolkit-core-security</div><div class="change">Component: Untriaged &rarr; WebExtensions: General</div><div class="change">Flags: needinfo?(jan)</div><div class="change">Product: Firefox &rarr; Toolkit</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="12870032" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" ><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" ><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 16:09 PST" data-time="1511482140">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="12870032">Looks like it can be anywhere in my testing of the function in Stylus. 

<a rel="nofollow" href="https://addons.mozilla.org/en-US/firefox/addon/styl-us/">https://addons.mozilla.org/en-US/firefox/addon/styl-us/</a>

To reproduce
1) install stylus
2) go to about:debugging
3) click debug and in the browser console type something like:
 
  download('file:///etc/passwd').then(e =&gt; console.log(e));

Output:

 ##
 # User Database
 # 
 # Note that this file is consulted directly only when the system is running
 # in single-user mode.  At other times this information is provided by
 # Open Directory.
 #
 # See the opendirectoryd(8) man page for additional information about
 # Open Directory.
 ##
 nobody...

Also pinging Jim to let the sandboxing team know.</pre><div class="activity"><div class="change">Flags: needinfo?(kmaglione+bmo)</div><div class="change">Flags: needinfo?(jmathies)</div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="12870065" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" ><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" ><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 16:45 PST" data-time="1511484300">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12870065">This is a bug in fetch &amp; web extension context, when the {mode:'same-origin'} flag is set. I wonder if it affects any other contexts.

MDN says: &quot;same-origin — If a request is made to another origin with this mode set, the result is simply an error. You could use this to ensure that a request is always being made to your origin.&quot; 

But somehow, moz-extension//{UUID} and file:// are considered same origin when you set this flag. 

STR:
Run this script in the background context of any web extension.

var url = file:///SOME/LOCAL/FILE/PATH
fetch(url, {mode:'same-origin'}).then(f=&gt;console.log(&quot;read file&quot;,f.url)).catch(e=&gt; console.log('Error trying to read file'))

Expected:
Console: Error trying to read file

Actual
Console: read file file:///SOME/LOCAL/FILE/PATH</pre></div><div class="change-set" id="c4"><div class="comment" data-id="12870070" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 16:48 PST" data-time="1511484504">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12870070">This isn't exactly unexpected. If the extension has the &lt;all_urls&gt; permission, it has same origin permissions for file: URLs, so this is pretty much the way it should work.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="12870072" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" ><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" ><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 16:55 PST" data-time="1511484901">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12870072">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c4">comment #4</a>)
<span class="quote">&gt; This isn't exactly unexpected. If the extension has the &lt;all_urls&gt;
&gt; permission, it has same origin permissions for file: URLs, so this is pretty
&gt; much the way it should work.</span >

Why does this ONLY work when you set the 'same-origin' flag.

Also note that this request completely bypasses the sandbox.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="12870077" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 16:57 PST" data-time="1511485079">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="12870077">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c5">comment #5</a>)
<span class="quote">&gt; (In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're
&gt; blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c4">comment #4</a>)
&gt; &gt; This isn't exactly unexpected. If the extension has the &lt;all_urls&gt;
&gt; &gt; permission, it has same origin permissions for file: URLs, so this is pretty
&gt; &gt; much the way it should work.
&gt; 
&gt; Why does this ONLY work when you set the 'same-origin' flag.</span >

Because our fetch support kind of sucks, and if you don't specify same-origin, it tries to treat it as a CORS request.

<span class="quote">&gt; Also note that this request completely bypasses the sandbox.</span >

As far as I recall, extension processes don't have filesystem sandboxing yet, so as long as it doesn't work from content scripts, that's not too surprising.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="12870078" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 16:58 PST" data-time="1511485128">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12870078">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c4">comment #4</a>)
<span class="quote">&gt; This isn't exactly unexpected. If the extension has the &lt;all_urls&gt;
&gt; permission, it has same origin permissions for file: URLs,</span >

Maybe we should change that? :-)

<span class="quote">&gt; so this is pretty much the way it should work.</span >

I mean, that wfm, but then we need to be clearer about expectations here, and this doesn't really explain to me why the add-on has to (apparently?) jump through hoops to read files...</pre></div><div class="change-set" id="c8"><div class="comment" data-id="12870092" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 17:01 PST" data-time="1511485299">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12870092">(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c7">comment #7</a>)
<span class="quote">&gt; (In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're
&gt; blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c4">comment #4</a>)
&gt; &gt; This isn't exactly unexpected. If the extension has the &lt;all_urls&gt;
&gt; &gt; permission, it has same origin permissions for file: URLs,
&gt; 
&gt; Maybe we should change that? :-)</span >

We should, but it's basically blocked on <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Implement local filesystem read/write access."
   href="/show_bug.cgi?id=1246236">bug 1246236</a>, and figuring out how we want to deal with filesystem access. I suppose we could add an exception, and ignore file: URL permissions for requests but still allow them for content scripts and such, but I'm not super happy about the idea...

<span class="quote">&gt; &gt; so this is pretty much the way it should work.
&gt; 
&gt; I mean, that wfm, but then we need to be clearer about expectations here,
&gt; and this doesn't really explain to me why the add-on has to (apparently?)
&gt; jump through hoops to read files...</span >

They have to jump through hoops to make any cross-origin requests that don't support CORS. Like I said, our fetch() support kind of sucks.</pre></div><div class="change-set" id="c9"><div class="comment" data-id="12870109" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" ><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" ><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 17:16 PST" data-time="1511486184">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="12870109">Allowing the ability to read arbitrary files, by default is surprising and hard to justify from a security model perspective. Am I missing something here? Why does fetch() fail, and fetch({mode:'same-origin'}). I was taken completely by surprise about this, and I have been looking at web extensions for months. On one hand we say file:// is forbidden [1] but we do clearly state that match patterns will match on file:/// [2]

Regardless, default access to file:/// that bypasses the sandbox is risky and means extensions undermine the sandbox. At a minimum I think,  we need to have users opt-in to extensions being allow to read file: URIs. Something like with a checkbox or menu option in about:addons. (Actually I thought there was a bug on file for that but I can't find it).

[1] <a rel="nofollow" href="https://wiki.mozilla.org/WebExtensions/Filesystem">https://wiki.mozilla.org/WebExtensions/Filesystem</a>
[2] <a rel="nofollow" href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Match_patterns">https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Match_patterns</a></pre></div><div class="change-set" id="a9266_434339"><div class="change" id="aa9266_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a9266_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a9266_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9266_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9266_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a9266_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 17:16 PST" data-time="1511486209">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div></div></div><div class="change-set" id="c10"><div class="comment" data-id="12870118" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a9266_434339"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a9266_434339"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 17:22 PST" data-time="1511486521">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="12870118">There's no default access to file: URLs. Extensions can access file: URLs if they have permissions for those URLs listed in their manifests, which works the same way for file: URLs as it does for other URLs.

For the third time: fetch() can only fetch those URLs in same-origin mode because our fetch() support sucks, and by default it tries to make a CORS request, which file: URLs don't support, rather than a same-origin request that leverages the extension permissions. Requests to http: URLs work the same way.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="12870125" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a9266_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a9266_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 17:32 PST" data-time="1511487134">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="12870125">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c10">comment #10</a>)
<span class="quote">&gt; There's no default access to file: URLs. Extensions can access file: URLs if
&gt; they have permissions for those URLs listed in their manifests, which works
&gt; the same way for file: URLs as it does for other URLs.</span >

Right, but we don't tell the user that in the prompt that is shown for &lt;all_urls&gt;. 

<span class="quote">&gt; 
&gt; For the third time: fetch() can only fetch those URLs in same-origin mode
&gt; because our fetch() support sucks, and by default it tries to make a CORS
&gt; request, which file: URLs don't support, rather than a same-origin request
&gt; that leverages the extension permissions. Requests to http: URLs work the
&gt; same way.</span >

Sorry I missed <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c6">comment 6</a>, and thus didnt understand <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c8">comment 8</a>. 

(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c6">comment #6</a>)
<span class="quote">&gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c5">comment #5</a>)
&gt; &gt; (In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're
&gt; &gt; blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c4">comment #4</a>)
&gt; &gt; &gt; This isn't exactly unexpected. If the extension has the &lt;all_urls&gt;
&gt; &gt; &gt; permission, it has same origin permissions for file: URLs, so this is pretty
&gt; &gt; &gt; much the way it should work.
&gt; &gt; 
&gt; &gt; Why does this ONLY work when you set the 'same-origin' flag.
&gt; 
&gt; Because our fetch support kind of sucks, and if you don't specify
&gt; same-origin, it tries to treat it as a CORS request.
&gt; 
&gt; &gt; Also note that this request completely bypasses the sandbox.
&gt; 
&gt; As far as I recall, extension processes don't have filesystem sandboxing
&gt; yet, so as long as it doesn't work from content scripts, that's not too
&gt; surprising.</span >

Ok I didn't know that - I thought that all content processes had the same rules, except for the one for loading File:// uris.
I guess Jim can clarify there.

In any case, I think we need to _something_ here. My preference would be to deny file:// access by default, and allow the user to opt-in. Not sure how complex that is though, so maybe in the meantime, perhaps we should improve the permission prompt to at least advise the user that the extension can read your local files.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="12870324" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a9266_434339"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a9266_434339"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 20:12 PST" data-time="1511496769">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="12870324">Changing the permission prompt is a bit of a rabbit hole with quite a few problems (how do you message people who installed this already, for example). I think we should deny this case, uplift it to 58 (if possible) and work with the ACE team to message affected add-ons.

Then we keep on the course of figuring out, with all the relevant teams, what use cases for file access to allow and how to do that in the future.</pre></div><div class="change-set" id="a51360_159069"><div class="change" id="aa51360_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a51360_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a51360_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a51360_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a51360_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a51360_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-24 04:58 PST" data-time="1511528303">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Is this a bug that get any files by path when you have applied &lt;all_urls&gt; of permissions key?"
   href="/show_bug.cgi?id=1420360">1420360</a></div></div></div><div class="change-set" id="a477904_279663"><div class="change" id="aa477904_279663">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_279663" id="a477904_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_279663" id="a477904_279663"><a class="email " href="/user_profile?user_id=279663" > <span class="fna">Jim Mathies [:jimm]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a477904_279663"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a477904_279663">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a477904_279663">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-29 03:27 PST" data-time="1511954847">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jmathies)</span></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="12887351" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a477904_279663"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a477904_279663"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-30 10:43 PST" data-time="1512067413">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12887351">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c11">comment #11</a>)
<span class="quote">&gt; (In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're
&gt; blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c10">comment #10</a>)
&gt; &gt; There's no default access to file: URLs. Extensions can access file: URLs if
&gt; &gt; they have permissions for those URLs listed in their manifests, which works
&gt; &gt; the same way for file: URLs as it does for other URLs.
&gt; 
&gt; Right, but we don't tell the user that in the prompt that is shown for
&gt; &lt;all_urls&gt;. </span >

I think that's the crux of the problem. Not that extensions shouldn't be able to read files (if given permission it's a valid thing to do in some cases) but that many/most users will be thinking &quot;Web&quot; when they see that prompt and will not expect &quot;rummage around on my disk&quot; to be part of it. That is, do we need to add a &quot;&lt;file_urls&gt;&quot; permission?</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c15"><div class="comment" data-id="12887378" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a477904_279663"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a477904_279663"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-30 10:52 PST" data-time="1512067973">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="12887378">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c14">comment #14</a>)
<span class="quote">&gt; I think that's the crux of the problem. Not that extensions shouldn't be
&gt; able to read files (if given permission it's a valid thing to do in some
&gt; cases) but that many/most users will be thinking &quot;Web&quot; when they see that
&gt; prompt and will not expect &quot;rummage around on my disk&quot; to be part of it.
&gt; That is, do we need to add a &quot;&lt;file_urls&gt;&quot; permission?</span >

I think we should probably make the &lt;all_urls&gt; permission not apply to files, and require extensions to explicitly specify file://*/. And we should probably require that to be an optional permission.</pre></div><div class="change-set" id="c16"><div class="comment" data-id="12887386" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a477904_279663"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a477904_279663"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-30 10:55 PST" data-time="1512068150">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12887386">The question of how we expose local files to be read is a question for a few groups (security, UX, product) and doing it on a security restricted bug is probably not the best way to get to a solution. There's some good stuff here but I think we should probably stick to the focus of shutting off local file access to fetch in this bug and moving the rest of the discussion to a public bug or forum.</pre></div><div class="change-set" id="c17"><div class="comment" data-id="12887530" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a477904_279663"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a477904_279663"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-30 11:39 PST" data-time="1512070758">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12887530">I probably have some spare cycles to shut off the file access here if no one else gets to it before me.

I had some ideas about how we can handle files but as :andym mentioned we can discuss elsewhere after this is resolved.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="12918982" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_442218" id="a477904_279663"><img src="https://secure.gravatar.com/avatar/c949006731dfdca9783f621522f42ca6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_442218" id="a477904_279663"><a class="email " href="/user_profile?user_id=442218" > <span class="fna">Andrew Overholt [:overholt]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 12:19 PST" data-time="1513282777">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="12918982">I think baku and catalinb would have thoughts here, too.</pre><div class="activity"><div class="change">Flags: needinfo?(amarchesini)</div></div></div><div class="change-set" id="a1813672_446257"><div class="change" id="aa1813672_446257">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_446257" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/dfb8d0427dd67216b2664131a5c31421?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_446257" id="a1813672_446257"><a class="email " href="/user_profile?user_id=446257" > <span class="fna">Andrea Marchesini [:baku]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1813672_446257"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1813672_446257">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a1813672_446257">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 14:30 PST" data-time="1513290615">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; amarchesini</div><div class="change">Flags: <span class="activity-deleted">needinfo?(amarchesini)</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="12919275" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_446257" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/dfb8d0427dd67216b2664131a5c31421?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_446257" id="a1813672_446257"><a class="email " href="/user_profile?user_id=446257" > <span class="fna">Andrea Marchesini [:baku]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 14:34 PST" data-time="1513290867">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8936952"
         class="attachment patch"
         data-id="8936952" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_same_origin.patch">
      <meta itemprop="contentSize" content="1152">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8936952">
          <a class="link" href="attachment.cgi?id=8936952&amp;action=diff">
        <span id="att-8936952-description" itemprop="description">file_same_origin.patch</span></a>
        — <a href="attachment.cgi?id=8936952&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1420296&attachment=8936952">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-19" data-comment-id="12919275">The spec says that: 
&quot;To perform a scheme fetch using request, switch on request’s current url’s scheme, and run the associated steps: [...] file: For now, unfortunate as it is, file and ftp URLs are left as an exercise for the reader.&quot;

Let's force no-cors for file URLs.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8936952&amp;action=edit"
           title="file_same_origin.patch"
           class=""
        >Attachment #8936952</a> -
        Flags: review?(bkelly)</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="12919431" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1813672_446257"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 16:00 PST" data-time="1513296042">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12919431">Why does no-cors mode help here if we treat the principal's as same-origin?  A no-cors request can return a basic response if it's same-origin.</pre></div><div class="change-set" id="c21"><div class="comment" data-id="12919467" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1813672_446257"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 16:52 PST" data-time="1513299126">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12919467">Comment on <span class=""><a href="/attachment.cgi?id=8936952" name="attach_8936952" title="file_same_origin.patch">attachment 8936952</a> <a href="/attachment.cgi?id=8936952&amp;action=edit" title="file_same_origin.patch">[details]</a> <a href="/attachment.cgi?id=8936952&amp;action=diff" title="file_same_origin.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1420296&amp;attachment=8936952'>[review]</a>
file_same_origin.patch

I think this is a bug in our security checks and we probably should not try to paper over them here.  This patch relies on this particular bug to work.  I think I understand what is going wrong and will post a follow-up comment with details.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8936952&amp;action=edit"
           title="file_same_origin.patch"
           class=""
        >Attachment #8936952</a> -
        Flags: review?(bkelly) &rarr; review-</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="12919480" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1813672_446257"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 17:05 PST" data-time="1513299944">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="12919480">So, both 'cors' and 'no-cors' mode reject because we end up calling DoCheckLoadURIChecks() here:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/dom/security/nsContentSecurityManager.cpp#724">https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/dom/security/nsContentSecurityManager.cpp#724</a>

This in turn ends up calling CheckLoadURIFlags() eventually which checks URI_IS_LOCAL_FILE:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/caps/nsScriptSecurityManager.cpp#938">https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/caps/nsScriptSecurityManager.cpp#938</a>

This block ends up failing and the file URL is blocked as intended.  Note, this is done *before* checking for URI_LOADABLE_BY_ANYONE.

For 'same-origin' mode, though, we do not call DoCheckLoadURIChecks().  Instead we call DoSOPChecks() which basically calls NS_HasBeenCrossOrigin():

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/dom/security/nsContentSecurityManager.cpp#711">https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/dom/security/nsContentSecurityManager.cpp#711</a>

Which then ends up calling BasePrincipal::CheckMayLoad().  This happily accepts any URL if URI_FETCHABLE_BY_ANYONE is set:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/caps/BasePrincipal.cpp#152">https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/caps/BasePrincipal.cpp#152</a>

As Kris mentioned, web extensions set this flag based on manifest data:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/netwerk/protocol/res/ExtensionProtocolHandler.cpp#382">https://searchfox.org/mozilla-central/rev/110706c3c09d457dc70293b213d7bccb4f6f5643/netwerk/protocol/res/ExtensionProtocolHandler.cpp#382</a>

This seems like a policy or security check problem.  I don't think trying to fix this in fetch() is the right place.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="12919481" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1813672_446257"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 17:06 PST" data-time="1513300011">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12919481">To clarify what I think is at least one problem:

In the cross-origin security checks we explicitly check for and disallow file URLs.  In same-origin security checks we don't do this because we assume they will be cross-origin and fail anyway.  The flag breaks that assumption, though.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="12919493" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1813672_446257"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1813672_446257"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 17:20 PST" data-time="1513300854">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12919493">Other same-origin requests I see in the tree which would be able to touch local files:

* worker scripts
* HTMLTrackElement
* Some FontFace loading code
* nsManifestCheck
* etc

These probably don't have the simple attack vector of fetch(), but I think we should fix them in a way that addressed them all if we can.</pre></div><div class="change-set" id="a2020369_446257"><div class="change" id="aa2020369_446257">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_446257" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/dfb8d0427dd67216b2664131a5c31421?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_446257" id="a2020369_446257"><a class="email " href="/user_profile?user_id=446257" > <span class="fna">Andrea Marchesini [:baku]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2020369_446257"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2020369_446257">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a2020369_446257">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-16 23:55 PST" data-time="1513497312">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="12928925" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2020369_446257"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-20 06:57 PST" data-time="1513781864">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="12928925">Boris, I think Bens assessment in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c22">comment 22</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c23">comment 23</a> is correct. I think it wouldn't hurt to also explicitly add an  disallow file URL access check to same origin checks. I assume the problem was just the assumption that SOP checks would fail file: loads because they are considered cross-origin anyway, right?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb) &rarr; needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="12929013" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_522029" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/57eed489fd29eafb3021f3fcf25b78e8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_522029" id="a2020369_446257"><a class="email " href="/user_profile?user_id=522029" > <span class="fna">Johann Hofmann [:johannh]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-20 07:23 PST" data-time="1513783382">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="12929013">Can you also add a test, at least for high level local file access through WebExtensions, and maybe unit tests for the content security checks, please? :)</pre></div><div class="change-set" id="c27"><div class="comment" data-id="12929528" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a2020369_446257"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a2020369_446257"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-20 10:05 PST" data-time="1513793129">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="12929528">I am not actually following <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c22">comment 22</a>.  That &quot;FETCHABLE_BY_ANYONE&quot; flag would be on the _uri_, not the _principal_.  Webextensions set that on _webextension_ URIs, which doesn't obviously have anything to do with attempts to load file:// URIs.

I have a slightly different question.  Why is file:// special?  Can extensions use this same mechanism to get at chrome:// URIs or whatnot?

Or put another way, should &lt;all_urls&gt; basically mean &quot;all URLs that are URI_LOADABLE_BY_ANYONE&quot;, as opposed to &quot;all URLs&quot;?  That will presumably restrict it to the things users expect....</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="12938612" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a2020369_446257"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-30 16:18 PST" data-time="1514679517">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="12938612">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c15">comment #15</a>)
<span class="quote">&gt; (In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c14">comment #14</a>)
&gt; &gt; I think that's the crux of the problem. Not that extensions shouldn't be
&gt; &gt; able to read files (if given permission it's a valid thing to do in some
&gt; &gt; cases) but that many/most users will be thinking &quot;Web&quot; when they see that
&gt; &gt; prompt and will not expect &quot;rummage around on my disk&quot; to be part of it.
&gt; &gt; That is, do we need to add a &quot;&lt;file_urls&gt;&quot; permission?
&gt; 
&gt; I think we should probably make the &lt;all_urls&gt; permission not apply to
&gt; files, and require extensions to explicitly specify file://*/. And we should
&gt; probably require that to be an optional permission.</span >

FWIW I like this proposal, even though it differs from chrome.

I'm here though now, to bring up <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a> which complicates the fix here slightly i think (at least i think this bug will depend on 1427448).</pre><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">1427448</a></div></div></div><div class="change-set" id="c29"><div class="comment" data-id="13014426" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a2020369_446257"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 08:55 PST" data-time="1517590512">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="13014426">This seems to have stalled, it got listed as sec-moderate but a P1 by the WebExtensions team, so it keeps popping up in triages for us. Should we drop the priority down to reflect the sec- status? Is there anything we can do to help move this forward baku?</pre></div><div class="change-set" id="c30"><div class="comment" data-id="13014434" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a2020369_446257"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 08:59 PST" data-time="1517590796">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="13014434">I think the fix is probably more in Christoph's wheelhouse in the security manager.  Christoph, can you take this?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="13022368" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2020369_446257"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2020369_446257"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-06 11:18 PST" data-time="1517944712">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="13022368">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c30">comment #30</a>)
<span class="quote">&gt; I think the fix is probably more in Christoph's wheelhouse in the security
&gt; manager.  Christoph, can you take this?</span >

Unfortunately I don't have the cycles to tackle this one at the moment. I guess we have to lower the priority until we get more engineering power back in content security.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="a6467898_547788"><div class="change" id="aa6467898_547788">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_547788" id="a6467898_547788"><img src="https://secure.gravatar.com/avatar/922adfc5538ed07a332c6f248f30ffa1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_547788" id="a6467898_547788"><a class="email " href="/user_profile?user_id=547788" > <span class="fna">Jan Biniok</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6467898_547788"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6467898_547788">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a6467898_547788">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-06 11:20 PST" data-time="1517944841">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jan)</span></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="13041276" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a6467898_547788"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a6467898_547788"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 03:55 PST" data-time="1518609325">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="13041276">(In reply to Andy McKay [:andym] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c29">comment #29</a>)
<span class="quote">&gt; This seems to have stalled, it got listed as sec-moderate but a P1 by the
&gt; WebExtensions team, so it keeps popping up in triages for us. Should we drop
&gt; the priority down to reflect the sec- status? Is there anything we can do to
&gt; help move this forward baku?</span >

No, keep it P1 - this is fundamental inconsistency in the security model. Either we need to fix this, or we need to make it clear that web extensions are allowed to read files from the file system. Web Extension bugs tend to get lower rating due to exploitation being predicated on installing a malicious extension - not a huge barrier, but more than if the issue was web exploitable. So while only being moderate in the scheme of firefox, I'd say this should be a P1 in the context of web extensions.</pre></div><div class="change-set" id="c33"><div class="comment" data-id="13041596" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6467898_547788"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6467898_547788"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 06:43 PST" data-time="1518619380">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="13041596">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c28">comment #28</a>)
<span class="quote">&gt; (In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're
&gt; blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c15">comment #15</a>)
&gt; &gt; (In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c14">comment #14</a>)
&gt; &gt; &gt; I think that's the crux of the problem. Not that extensions shouldn't be
&gt; &gt; &gt; able to read files (if given permission it's a valid thing to do in some
&gt; &gt; &gt; cases) but that many/most users will be thinking &quot;Web&quot; when they see that
&gt; &gt; &gt; prompt and will not expect &quot;rummage around on my disk&quot; to be part of it.
&gt; &gt; &gt; That is, do we need to add a &quot;&lt;file_urls&gt;&quot; permission?
&gt; &gt; 
&gt; &gt; I think we should probably make the &lt;all_urls&gt; permission not apply to
&gt; &gt; files, and require extensions to explicitly specify file://*/. And we should
&gt; &gt; probably require that to be an optional permission.
&gt; 
&gt; FWIW I like this proposal, even though it differs from chrome.
&gt; 
&gt; I'm here though now, to bring up <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a> which complicates the fix here
&gt; slightly i think (at least i think this bug will depend on 1427448).</span >

What's needed to move ahead with this proposal? I don't think the fix for <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a> will necessarily make much of a difference here. AIUI to fix this type of thing, we'd need to:

1) add a new permission for &lt;file_urls&gt;
2) require it to be optional
3) in CAPS, when the triggering/subject principal is an add-on and the target URI chain has the local file flag, check if the add-on has the relevant permission

Does that sound right? Do we need further buy-in on this plan to move forward here?</pre><div class="activity"><div class="change">Flags: needinfo?(kmaglione+bmo)</div><div class="change">Flags: needinfo?(ddurst)</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="13042241" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a6467898_547788"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a6467898_547788"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 10:21 PST" data-time="1518632465">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="13042241">(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c33">comment #33</a>)
<span class="quote">&gt; What's needed to move ahead with this proposal? I don't think the fix for
&gt; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a> will necessarily make much of a difference here. AIUI to fix
&gt; this type of thing, we'd need to:
&gt; 
&gt; 1) add a new permission for &lt;file_urls&gt;
&gt; 2) require it to be optional
&gt; 3) in CAPS, when the triggering/subject principal is an add-on and the
&gt; target URI chain has the local file flag, check if the add-on has the
&gt; relevant permission
&gt; 
&gt; Does that sound right? Do we need further buy-in on this plan to move
&gt; forward here?</span >

No. &lt;all_urls&gt; should still match file URLs, and so should file://*

What we need is a separate setting that allows users to opt into giving an extension access to local files, similar to what Chrome does. I don't particularly care when/where we prompt users to opt into this, but the status of that permission should at least be displayed on the add-on's about:addons detail page, and be togglable there.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c35"><div class="comment" data-id="13042246" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a6467898_547788"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a6467898_547788"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 10:24 PST" data-time="1518632648">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="13042246">(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c33">comment #33</a>)
<span class="quote">&gt; 3) in CAPS, when the triggering/subject principal is an add-on and the
&gt; target URI chain has the local file flag, check if the add-on has the
&gt; relevant permission</span >

Which means adding a new boolean flag to WebExtensionPolicy[1] and checking it in MatchPattern[2]. Which probably means adding an optional policy property to MatchPattern instances.

[1]: <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/webidl/WebExtensionPolicy.webidl">https://searchfox.org/mozilla-central/source/dom/webidl/WebExtensionPolicy.webidl</a>
[2]: <a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/d03ad8843e3bf2e856126bc53b0475c595e5183b/toolkit/components/extensions/MatchPattern.cpp#405">https://searchfox.org/mozilla-central/rev/d03ad8843e3bf2e856126bc53b0475c595e5183b/toolkit/components/extensions/MatchPattern.cpp#405</a></pre></div><div class="change-set" id="c36"><div class="comment" data-id="13042677" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6467898_547788"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6467898_547788"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 12:45 PST" data-time="1518641143">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="13042677">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c34">comment #34</a>)
<span class="quote">&gt; No. &lt;all_urls&gt; should still match file URLs, and so should file://*</span >

To me this seems like the opposite of what <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c15">comment #15</a> said:

(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c15">comment #15</a>)
<span class="quote">&gt; I think we should probably make the &lt;all_urls&gt; permission not apply to
&gt; files, and require extensions to explicitly specify file://*/. And we should
&gt; probably require that to be an optional permission.</span >

Can you clarify what you mean more precisely?</pre><div class="activity"><div class="change">Flags: needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="a7203326_446257"><div class="change" id="aa7203326_446257">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_446257" id="a7203326_446257"><img src="https://secure.gravatar.com/avatar/dfb8d0427dd67216b2664131a5c31421?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_446257" id="a7203326_446257"><a class="email " href="/user_profile?user_id=446257" > <span class="fna">Andrea Marchesini [:baku]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7203326_446257"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7203326_446257">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a7203326_446257">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 23:37 PST" data-time="1518680269">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: amarchesini &rarr; nobody</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="13407627" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a7203326_446257"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a7203326_446257"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-15 15:25 PDT" data-time="1529101529">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="13407627">(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c34">comment #34</a>)
<span class="quote">&gt; (In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c33">comment #33</a>)</span >
...
<span class="quote">&gt; 
&gt; What we need is a separate setting that allows users to opt into giving an
&gt; extension access to local files, similar to what Chrome does. I don't
&gt; particularly care when/where we prompt users to opt into this, but the
&gt; status of that permission should at least be displayed on the add-on's
&gt; about:addons detail page, and be togglable there.</span >

We just spoke about this at all hands, and as asked Im adding my strong support for the approach suggested by Kris above (i.e. a toggle where users can OPT IN to allowing extensions to have file access, and prevent access in the regular case).</pre></div><div class="change-set" id="c38"><div class="comment" data-id="13407641" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a7203326_446257"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a7203326_446257"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-15 15:32 PDT" data-time="1529101941">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="13407641">With a side note that, in addition to preventing direct loading of file:// uris, we also need to prevent extensions open in tabs with file:// URIs (and then injecting a content script into it). From a discussion here it sounds like we don't want to still allow extensions even without the &quot;file access&quot; granted to inject content scripts into tabs with File:// uris that the USER opened. (im not super pumped about that, but it sounds also you shouldn't have to grant a random extension access to your file system, just so that it can inject some content script into the one specific document you opened from the file system.</pre></div><div class="change-set" id="a17961711_546015"><div class="change" id="aa17961711_546015">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_546015" id="a17961711_546015"><img src="https://secure.gravatar.com/avatar/d0465b8931b44330f542efbeeae855da?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_546015" id="a17961711_546015"><a class="email " href="/user_profile?user_id=546015" > <span class="fna">BMO Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a17961711_546015"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a17961711_546015">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a17961711_546015">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-19 13:04 PDT" data-time="1529438654">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Product: Toolkit &rarr; WebExtensions</div></div></div><div class="change-set" id="a18039021_500559"><div class="change" id="aa18039021_500559">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_500559" id="a18039021_500559"><img src="https://secure.gravatar.com/avatar/5bd88cf3a23a91a5c0dd0d6dd5573f51?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_500559" id="a18039021_500559"><a class="email " href="/user_profile?user_id=500559" > <span class="fna">David Durst [:ddurst]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18039021_500559"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18039021_500559">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a18039021_500559">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-20 10:32 PDT" data-time="1529515964">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; kmaglione+bmo</div><div class="change">Flags: <span class="activity-deleted">needinfo?(ddurst)</span></div></div></div><div class="change-set" id="c39"><div class="comment" data-id="13420911" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a18039021_500559"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a18039021_500559"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-22 13:56 PDT" data-time="1529700980">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="13420911">I'm going to handle the back-end portion of this. I might punt the front-end portion to Mark, since I have a lot of things on my plate at the moment.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="13421512" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_547788" id="a18039021_500559"><img src="https://secure.gravatar.com/avatar/922adfc5538ed07a332c6f248f30ffa1?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_547788" id="a18039021_500559"><a class="email " href="/user_profile?user_id=547788" > <span class="fna">Jan Biniok</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-23 03:59 PDT" data-time="1529751576">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="13421512"><span class="quote">&gt; I'm going to handle the back-end portion of this.</span >

Does &quot;this&quot; mean to prevent content script file:// access by default _AND_ to implement &quot;a toggle where users can OPT IN to allowing extensions to have file access&quot;?

I'm asking because the first &quot;fix&quot; will break Tampermonkey's ability to install scripts from local file URIs unless content scripts that are defined at the manifest are exempted from this change.

Thanks, Jan

{
    &quot;manifest_version&quot;: 2,
...
    &quot;content_scripts&quot;:
    [
        {...}, {
            &quot;js&quot;: [
                 &quot;rea/content.js&quot;
            ],
            &quot;matches&quot;: [ &quot;file:///*.user.js&quot; ],
            &quot;run_at&quot;: &quot;document_start&quot;
        }
    ],
...
}</pre></div><div class="change-set" id="a30576910_500559"><div class="change" id="aa30576910_500559">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_500559" id="a30576910_500559"><img src="https://secure.gravatar.com/avatar/5bd88cf3a23a91a5c0dd0d6dd5573f51?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_500559" id="a30576910_500559"><a class="email " href="/user_profile?user_id=500559" > <span class="fna">David Durst [:ddurst]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a30576910_500559"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a30576910_500559">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a30576910_500559">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-12 12:17 PST" data-time="1542053853">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: kmaglione+bmo &rarr; tomica</div></div></div><div class="change-set" id="a30577845_500559"><div class="change" id="aa30577845_500559">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_500559" id="a30577845_500559"><img src="https://secure.gravatar.com/avatar/5bd88cf3a23a91a5c0dd0d6dd5573f51?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_500559" id="a30577845_500559"><a class="email " href="/user_profile?user_id=500559" > <span class="fna">David Durst [:ddurst]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a30577845_500559"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a30577845_500559">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a30577845_500559">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-12 12:33 PST" data-time="1542054788">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Mentor: kmaglione+bmo</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="13763322" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a30577845_500559"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a30577845_500559"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-17 14:10 PST" data-time="1542492654">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="13763322">I'm looking into this, but there are several linked bugs that I can't access.  Can someone please go through <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Is this a bug that get any files by path when you have applied &lt;all_urls&gt; of permissions key?"
   href="/show_bug.cgi?id=1420360">bug 1420360</a>, and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1316343">bug 1316343</a>, and CC me to those pertinent to this issue?



(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c34">comment #34</a>)
<span class="quote">&gt; What we need is a separate setting that allows users to opt into giving an
&gt; extension access to local files, similar to what Chrome does. I don't
&gt; particularly care when/where we prompt users to opt into this, but the
&gt; status of that permission should at least be displayed on the add-on's
&gt; about:addons detail page, and be togglable there.</span >

Do we want this as a new &quot;public&quot; permission, or just an internal flag that extension can never request, and can only be manually toggled though the UI?

And what should we do with already installed extensions in either case?



(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c38">comment #38</a>)
<span class="quote">&gt; With a side note that, in addition to preventing direct loading of file://
&gt; uris, we also need to prevent extensions open in tabs with file:// URIs (and
&gt; then injecting a content script into it). From a discussion here it sounds
&gt; like we don't want to still allow extensions even without the &quot;file access&quot;
&gt; granted to inject content scripts into tabs with File:// uris that the USER
&gt; opened. (im not super pumped about that, but it sounds also you shouldn't
&gt; have to grant a random extension access to your file system, just so that it
&gt; can inject some content script into the one specific document you opened
&gt; from the file system.</span >

I don't understand this the way it's worded.  And it seems all of the discussion in this bug is about direct access to reading local files, content scripts are a separate issue, and can be a separate bug.



(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c39">comment #39</a>)
<span class="quote">&gt; I might punt the front-end portion to Mark</span >


This can be done in a separate public bug, if it needs to involve UX and/or others, right?</pre></div><div class="change-set" id="c42"><div class="comment" data-id="13765153" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a30577845_500559"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a30577845_500559"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-19 08:29 PST" data-time="1542644976">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="13765153">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c41">comment #41</a>)
<span class="quote">&gt; I'm looking into this, but there are several linked bugs that I can't
&gt; access.  Can someone please go through <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Is this a bug that get any files by path when you have applied &lt;all_urls&gt; of permissions key?"
   href="/show_bug.cgi?id=1420360">bug 1420360</a>, and bug
&gt; 1316343, and CC me to those pertinent to this issue?</span >

Done this for you, can't comment on the other stuff.</pre></div><div class="change-set" id="c43"><div class="comment" data-id="13797129" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a30577845_500559"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a30577845_500559"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-12-04 20:21 PST" data-time="1543983694">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="13797129">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c41">comment #41</a>)
<span class="quote">&gt; I'm looking into this, but there are several linked bugs that I can't
&gt; access.  Can someone please go through <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Is this a bug that get any files by path when you have applied &lt;all_urls&gt; of permissions key?"
   href="/show_bug.cgi?id=1420360">bug 1420360</a>, and bug
&gt; 1316343, and CC me to those pertinent to this issue?
&gt; 
&gt; 
&gt; 
&gt; (In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c34">comment #34</a>)
&gt; &gt; What we need is a separate setting that allows users to opt into giving an
&gt; &gt; extension access to local files, similar to what Chrome does. I don't
&gt; &gt; particularly care when/where we prompt users to opt into this, but the
&gt; &gt; status of that permission should at least be displayed on the add-on's
&gt; &gt; about:addons detail page, and be togglable there.
&gt; 
&gt; Do we want this as a new &quot;public&quot; permission, or just an internal flag that
&gt; extension can never request, and can only be manually toggled though the UI?
&gt; 
&gt; And what should we do with already installed extensions in either case?
&gt; 
&gt; 
&gt; 
&gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c38">comment #38</a>)
&gt; &gt; With a side note that, in addition to preventing direct loading of file://
&gt; &gt; uris, we also need to prevent extensions open in tabs with file:// URIs (and
&gt; &gt; then injecting a content script into it). From a discussion here it sounds
&gt; &gt; like we don't want to still allow extensions even without the &quot;file access&quot;
&gt; &gt; granted to inject content scripts into tabs with File:// uris that the USER
&gt; &gt; opened. (im not super pumped about that, but it sounds also you shouldn't
&gt; &gt; have to grant a random extension access to your file system, just so that it
&gt; &gt; can inject some content script into the one specific document you opened
&gt; &gt; from the file system.
&gt; 
&gt; I don't understand this the way it's worded.  And it seems all of the
&gt; discussion in this bug is about direct access to reading local files,
&gt; content scripts are a separate issue, and can be a separate bug.</span >

Sorry, my comment is barely readable. I meant that we should have a holistic approach to restricting file system access. If we close this fetch hole, but still allow extensions to open and interact with tabs which have a file:// url open, then extensions will still have read access to the file system (since file: uris are treated as same-origin as files in the same directory). But you are right, that perhaps should be a separate bug.</pre></div><div class="change-set" id="c44"><div class="comment" data-id="13797283" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a30577845_500559"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a30577845_500559"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-12-05 01:55 PST" data-time="1544003752">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="13797283">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Webextensions can access local files"
   href="/show_bug.cgi?id=1420296#c43">comment #43</a>)
<span class="quote">&gt; (since file: uris are treated as same-origin as files in the same
&gt; directory)</span >

We should just finally fix this - <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Local files can access other files in the same directory"
   href="/show_bug.cgi?id=803143">bug 803143</a>.</pre></div><div class="change-set" id="c45"><div class="comment" data-id="13919715" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a30577845_500559"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a30577845_500559"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-11 15:22 PST" data-time="1549927323">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-45" data-comment-id="13919715" data-ismarkdown="true" ><p>ni? to Kris and Mike for what to do with already installed extensions here (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c41" title="VERIFIED FIXED - Webextensions can access local files">comment 41</a>), similar to the situation about private browsing being solved right now.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(mconca)</div><div class="change">Flags: needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="a41820253_1689"><div class="change" id="aa41820253_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a41820253_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a41820253_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a41820253_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a41820253_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a41820253_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 16:26 PDT" data-time="1553297196">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: toolkit-core-security &rarr; firefox-core-security</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="14020639" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_599100" id="a41820253_1689"><img src="https://secure.gravatar.com/avatar/04780e375a532aeb20ec1365ce163109?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_599100" id="a41820253_1689"><a class="email " href="/user_profile?user_id=599100" > <span class="fna">Mike Conca [:mconca]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-29 13:56 PDT" data-time="1553892991">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-46" data-comment-id="14020639" data-ismarkdown="true" ><p>(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c45" title="VERIFIED FIXED - Webextensions can access local files">comment #45</a>)</p>
<blockquote>
<p>ni? to Kris and Mike for what to do with already installed extensions here (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c41" title="VERIFIED FIXED - Webextensions can access local files">comment 41</a>), similar to the situation about private browsing being solved right now.</p>
</blockquote>
<p>This particular question is being rolled up into a larger discussion around exactly how/when extensions can access local files.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mconca)</span></div></div></div><div class="change-set" id="c47"><div class="comment" data-id="14110660" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a41820253_1689"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a41820253_1689"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-05-10 12:25 PDT" data-time="1557516307">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-47" data-comment-id="14110660" data-ismarkdown="true" ><p>I&#39;m confused by this bug; the docs describe a function to check this capability: <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension/isAllowedFileSchemeAccess" rel="nofollow">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension/isAllowedFileSchemeAccess</a> and describe &quot;the user-controlled &#39;Allow access to File URLs&#39; checkbox&quot; (on <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension#getURL()" rel="nofollow">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension#getURL()</a> )</p>
<p>Are the docs incorrect or has much of what has been discussed in this bug been implemented?</p>
</div></div><div class="change-set" id="c48"><div class="comment" data-id="14110695" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a41820253_1689"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a41820253_1689"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-05-10 12:46 PDT" data-time="1557517584">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-48" data-comment-id="14110695" data-ismarkdown="true" ><p>(In reply to Tom Ritter [:tjr] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c47" title="VERIFIED FIXED - Webextensions can access local files">comment #47</a>)</p>
<blockquote>
<p>I&#39;m confused by this bug; the docs describe a function to check this capability: <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension/isAllowedFileSchemeAccess" rel="nofollow">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension/isAllowedFileSchemeAccess</a> and describe &quot;the user-controlled &#39;Allow access to File URLs&#39; checkbox&quot; (on <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension#getURL()" rel="nofollow">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension#getURL()</a> )</p>
<p>Are the docs incorrect or has much of what has been discussed in this bug been implemented?</p>
</blockquote>
<p>That currently only applies to Chrome, who we inherited this API from.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="a50601475_279663"><div class="change" id="aa50601475_279663">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_279663" id="a50601475_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_279663" id="a50601475_279663"><a class="email " href="/user_profile?user_id=279663" > <span class="fna">Jim Mathies [:jimm]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a50601475_279663"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a50601475_279663">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a50601475_279663">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-02 07:40 PDT" data-time="1562078418">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Local files can access other files in the same directory"
   href="/show_bug.cgi?id=803143">803143</a></div></div></div><div class="change-set" id="a54501379_279663"><div class="change" id="aa54501379_279663">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_279663" id="a54501379_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_279663" id="a54501379_279663"><a class="email " href="/user_profile?user_id=279663" > <span class="fna">Jim Mathies [:jimm]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a54501379_279663"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a54501379_279663">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a54501379_279663">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-16 10:58 PDT" data-time="1565978322">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: webext-sec</div></div></div><div class="change-set" id="a60819031_279663"><div class="change" id="aa60819031_279663">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_279663" id="a60819031_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_279663" id="a60819031_279663"><a class="email " href="/user_profile?user_id=279663" > <span class="fna">Jim Mathies [:jimm]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a60819031_279663"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a60819031_279663">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a60819031_279663">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-28 13:52 PDT" data-time="1572295974">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: tomica &rarr; nobody</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="14453010" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a60819031_279663"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-28 16:38 PDT" data-time="1572305927">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-49" data-comment-id="14453010" data-ismarkdown="true" ><p>I&#39;m currently unable to reproduce this with either the stack overflow example from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c0" title="VERIFIED FIXED - Webextensions can access local files">comment 0</a> or the simplified version in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c3" title="VERIFIED FIXED - Webextensions can access local files">comment 3</a>.</p>
</div></div><div class="change-set" id="c50"><div class="comment" data-id="14453078" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a60819031_279663"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-28 17:43 PDT" data-time="1572309828">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-50" data-comment-id="14453078" data-ismarkdown="true" ><p>I can still reproduce on Linux with Nightly 72.0a1, buildID 20191021215155 .</p>
<ol>
<li>manifest.json with</li>
</ol>
<pre><code class="language-{">    &quot;name&quot;: &quot;Extension with file access&quot;,
    &quot;version&quot;: &quot;1&quot;,
    &quot;manifest_version&quot;: 2,
    &quot;background&quot;: {&quot;scripts&quot;: [&quot;bg.js&quot;]},
    &quot;permissions&quot;: [&quot;file:///*&quot;]
}
</code></pre>
<ol start="2">
<li>bg.js</li>
</ol>
<pre><code>async function test() {
    let r = await fetch(&#39;file:///etc/passwd&#39;, {mode:&#39;same-origin&#39;});
    let t = await r.text();
    console.log(t)
}
test();
</code></pre>
<p>Result: The content of <code>/etc/passwd</code>.</p>
</div></div><div class="change-set" id="c51"><div class="comment" data-id="14454315" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a60819031_279663"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 09:26 PDT" data-time="1572366414">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-51" data-comment-id="14454315" data-ismarkdown="true" ><p>If I add a catch on the fetch, I get &quot;TypeError: NetworkError when attempting to fetch resource.&quot;.</p>
<p>Nightly OSX 10.14</p>
</div></div><div class="change-set" id="c52"><div class="comment" data-id="14454962" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a60819031_279663"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 11:55 PDT" data-time="1572375336">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-52" data-comment-id="14454962" data-ismarkdown="true" ><p>So, I am still unable to reproduce this on osx regardless of the privacy.file_unique_origin value.  However, on a fresh profile, same extension, I can reproduce this on linux.  Either it is unrelated to file_unique_origin or it is linux specific.  Due to this, I&#39;ll set my vm to dealing with windows for the rest of the afternoon.</p>
</div></div><div class="change-set" id="c53"><div class="comment" data-id="14454967" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a60819031_279663"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 11:59 PDT" data-time="1572375557">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9105000"
         class="attachment"
         data-id="9105000" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="fileaccess.xpi">
      <meta itemprop="contentSize" content="722">
      <meta itemprop="encodingFormat" content="application/x-xpinstall">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9105000" itemprop="contentUrl">
        <span id="att-9105000-description" itemprop="description">fileaccess.xpi</span></a>
        — <a href="attachment.cgi?id=9105000&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-53" data-comment-id="14454967" data-ismarkdown="true" ><p>This xpi does two fetches, one that is just normal (was making sure I didn&#39;t have some stupid problem) and one that does a file fetch.  This same xpi fails to fetch the file on osx, but works fine on linux.</p>
</div></div><div class="change-set" id="c54"><div class="comment" data-id="14455166" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a60819031_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a60819031_279663"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 13:28 PDT" data-time="1572380934">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-54" data-comment-id="14455166" data-ismarkdown="true" ><p>How do I check whether I&#39;m reproducing with that extension?  I installed the extension, started the browser, loaded example.com, but I don&#39;t know which console it&#39;s logging to and hence whether it&#39;s managing to do the fetches...</p>
</div></div><div class="change-set" id="c55"><div class="comment" data-id="14455178" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a60819031_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a60819031_279663"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 13:32 PDT" data-time="1572381139">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-55" data-comment-id="14455178" data-ismarkdown="true" ><p>Ah, nevermind.  If I add some <code>dump()</code> calls I can see it running at startup.  Poking at things...</p>
</div></div><div class="change-set" id="c56"><div class="comment" data-id="14455610" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a60819031_279663"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 14:56 PDT" data-time="1572386167">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-56" data-comment-id="14455610" data-ismarkdown="true" ><p>This reproduces on Windows 10 and latest Nightly 72 from today.</p>
</div></div><div class="change-set" id="c57"><div class="comment" data-id="14455956" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a60819031_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a60819031_279663"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-29 20:19 PDT" data-time="1572405563">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-57" data-comment-id="14455956" data-ismarkdown="true" ><p>So the <code>fetch(&#39;file:///etc/passwd&#39;)</code> call happens in a content process.  The triggering principal (and loading principal) for the fetch is a ContentPrincipal with the URI <code>&quot;moz-extension://01cf4af3-f9f4-4f63-8222-1f2c1db5bffb/_generated_background_page.html&quot;</code>.</p>
<p>We end up in <code>ContentPrincipal::MayLoadInternal</code> and the <code>AddonAllowsLoad</code> call there returns true, because the <code>WebExtensionPolicy::CanAccessURI</code> call returns true.  Given the manifest claims <code>&quot;file:///*&quot;</code> in the permissions this doesn&#39;t seem surprising, right?  Anyway, that means <code>BasePrincipal::CheckMayLoad</code> returns true, and that&#39;s our general &quot;Should this principal be considered same-origin with this URI?&quot; method.  So we consider this a same-origin load (e.g. <code>NS_HasBeenCrossOrigin</code> returns false, so <code>DoSOPChecks</code> returns success, so <code>nsContentSecurityManager::CheckChannel</code> returns success, so the load is allowed.</p>
<p>After things things Just Work: the fetch successfully opens the <code>FileChannelChild</code> channel, that remotes the actual filesystem access to the parent process (which is why sandboxing is nor relevant), etc.</p>
<p>Is there some expectation that given our current code this should <em>not</em> work?</p>
</div></div><div class="change-set" id="c58"><div class="comment" data-id="14456714" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a60819031_279663"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a60819031_279663"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-30 06:29 PDT" data-time="1572442171">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-58" data-comment-id="14456714" data-ismarkdown="true" ><p><code>fetch(&#39;file:///etc/passwd&#39;);</code> does not load the resource (and neither does <code>XMLHttpRequest</code>) - this is desired as explained below.<br>
<code>fetch(&#39;file:///etc/passwd&#39;, {mode:&#39;same-origin&#39;});</code> does load the resource.</p>
<p>They should behave consistently.</p>
<p><code>file:///*</code> is automatically granted when the <code>&lt;all_urls&gt;</code> permission is requested, which is very common.<br>
Most of the extensions that request <code>&lt;all_urls&gt;</code> don&#39;t really need file access.<br>
I&#39;d like to block file access by default unless a user explicitly consented, to protect the general population whose add-ons don&#39;t need to access files.</p>
<p>(FWIW, in Chrome <code>&lt;all_urls&gt;</code> also includes <code>file:///*</code>, but access is withheld until the user manually grants access at the extension management page.)</p>
</div></div><div class="change-set" id="a62984924_447061"><div class="change" id="aa62984924_447061">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a62984924_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_447061" id="a62984924_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a62984924_447061"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a62984924_447061">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a62984924_447061">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-22 14:31 PST" data-time="1574461867">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; rob</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="14506530" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a62984924_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a62984924_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-23 15:10 PST" data-time="1574550632">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-59" data-comment-id="14506530" data-ismarkdown="true" ><p>Next week (or maybe the week after, at the start of release cycle of 73), I intend to land a patch that closes this hole.<br>
The hole does already not work on macOS (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c49" title="VERIFIED FIXED - Webextensions can access local files">comment 49</a>), and starting with my patch, it won&#39;t work either on Linux, Windows and Android.</p>
</div></div><div class="change-set" id="c60"><div class="comment" data-id="14509504" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a62984924_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a62984924_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-25 08:09 PST" data-time="1574698187">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9111270"
         class="attachment"
         data-id="9111270" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D54540-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9111270" itemprop="contentUrl">
        <span id="att-9111270-description" itemprop="description">Bug 1420296 - Add file check to WebExtensionPolicy</span></a>
        — <a href="attachment.cgi?id=9111270&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c61"><div class="comment" data-id="14509510" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a62984924_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a62984924_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-25 08:12 PST" data-time="1574698334">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9111271"
         class="attachment"
         data-id="9111271" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D54541-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9111271" itemprop="contentUrl">
        <span id="att-9111271-description" itemprop="description">Bug 1420296 - Add tests for file access from extensions</span></a>
        — <a href="attachment.cgi?id=9111271&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-61" data-comment-id="14509510" data-ismarkdown="true" ><p>Content scripts are allowed to run on file:-URLs, but other forms of<br>
file access from extensions are not allowed. This has been the behavior<br>
for a while, but there were no tests. This commit adds tests to ensure<br>
that the functionality continues to work as intended.</p>
</div></div><div class="change-set" id="c62"><div class="comment" data-id="14509512" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a62984924_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a62984924_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-25 08:12 PST" data-time="1574698351">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9111273"
         class="attachment"
         data-id="9111273" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D54543-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9111273" itemprop="contentUrl">
        <span id="att-9111273-description" itemprop="description">Bug 1420296 - Test for same-origin file requests</span></a>
        — <a href="attachment.cgi?id=9111273&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c63"><div class="comment" data-id="14509526" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a62984924_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a62984924_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-25 08:15 PST" data-time="1574698551">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-63" data-comment-id="14509526" data-ismarkdown="true" ><ul>
<li><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c60" title="VERIFIED FIXED - Webextensions can access local files">comment 60</a> is a fix for this bug and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1487353" title="RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file">bug 1487353</a> (a unit test is attached in that other bug).</li>
<li><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c61" title="VERIFIED FIXED - Webextensions can access local files">comment 61</a> is a set of unit tests that already pass, independently of the bugfix. These tests were added to make sure that content scripts for files do not regress.</li>
<li><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c61" title="VERIFIED FIXED - Webextensions can access local files">comment 61</a> is a regression test for this bug, and should land in the future, when this bug becomes public.</li>
</ul>
</div></div><div class="change-set" id="a63221681_447061"><div class="change" id="aa63221681_447061">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a63221681_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_447061" id="a63221681_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a63221681_447061"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a63221681_447061">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a63221681_447061">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-11-25 08:17 PST" data-time="1574698624">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file"
   href="/show_bug.cgi?id=1487353">1487353</a></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="14529245" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a63221681_447061"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a63221681_447061"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-05 06:27 PST" data-time="1575556058">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-64" data-comment-id="14529245" data-ismarkdown="true" ><p>The patch in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c60" title="VERIFIED FIXED - Webextensions can access local files">comment 60</a> seems fine, but I want to understand answers to a few questions beforehand:</p>
<ol>
<li>
<p>This proposed fix is different than the agreed consensus in most of this bug, up to and including your second-to-last <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c58" title="VERIFIED FIXED - Webextensions can access local files">comment 58</a>, which was putting this access behind a special permission prompt/checkbox.  Why did you change your approach?  Given recent urgency in <a class="bz_bug_link
          bz_status_ASSIGNED" href="/show_bug.cgi?id=1598946" title="ASSIGNED">bug 1598946</a>, should we bundle the two bugs together, behind the same optional permission?</p>
</li>
<li>
<p>Why doesn&#39;t this work on MacOS?  Is it a recent &quot;regression&quot;, or some configuration/platform difference?</p>
</li>
<li>
<p>I&#39;m looking up code related to <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c23" title="VERIFIED FIXED - Webextensions can access local files">comment 23</a>, perhaps this cross-origin check should be lower in the chain to cover more than just addons usecase.</p>
</li>
</ol>
</div></div><div class="change-set" id="c65"><div class="comment" data-id="14529552" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a63221681_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a63221681_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-05 08:43 PST" data-time="1575564198">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-65" data-comment-id="14529552" data-ismarkdown="true" ><p>(In reply to :Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c64" title="VERIFIED FIXED - Webextensions can access local files">comment #64</a>)</p>
<blockquote>
<p>The patch in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c60" title="VERIFIED FIXED - Webextensions can access local files">comment 60</a> seems fine, but I want to understand answers to a few questions beforehand:</p>
<ol>
<li>This proposed fix is different than the agreed consensus in most of this bug, up to and including your second-to-last <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c58" title="VERIFIED FIXED - Webextensions can access local files">comment 58</a>, which was putting this access behind a special permission prompt/checkbox.  Why did you change your approach?  Given recent urgency in <a class="bz_bug_link
          bz_status_ASSIGNED" href="/show_bug.cgi?id=1598946" title="ASSIGNED">bug 1598946</a>, should we bundle the two bugs together, behind the same optional permission?</li>
</ol>
</blockquote>
<p>I implemented it like this because it fixes file:-access related bugs without breaking known supported cases.<br>
We probably still want to support a prompt/checkbox, but that requires more efforts and review/feedback cycles. That fits better in <a class="bz_bug_link
          bz_status_ASSIGNED" href="/show_bug.cgi?id=1598946" title="ASSIGNED">bug 1598946</a> or a follow-up to that bug (and some of the ideas expressed here already align with the tentative plan).</p>
<blockquote>
<ol start="2">
<li>Why doesn&#39;t this work on MacOS?  Is it a recent &quot;regression&quot;, or some configuration/platform difference?</li>
</ol>
</blockquote>
<p>The paths that we tested were blocked by the sandbox on macOS. If I choose a <a href="https://searchfox.org/mozilla-central/rev/efdf9bb55789ea782ae3a431bda6be74a87b041e/security/sandbox/mac/SandboxPolicyContent.h#70" rel="nofollow">whitelisted location</a>, e.g. <code>file:///usr/share/</code> , then the load is still accepted.</p>
<blockquote>
<ol start="3">
<li>I&#39;m looking up code related to <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c23" title="VERIFIED FIXED - Webextensions can access local files">comment 23</a>, perhaps this cross-origin check should be lower in the chain to cover more than just addons usecase.</li>
</ol>
</blockquote>
<p>I&#39;m not aware of any other generic file:-whitelisting other than extensions. Judged by extension permissions only, <code>file:</code>-access should have been allowed (and is so, according to <code>WebExtensionPolicy::CanAccessURI</code>). But we don&#39;t have a separate permission warning or any other obvious indication that an extension is allowed access to local files, so it was a nice &quot;feature&quot; that <code>file:</code>-URLs were somehow already blocked access (through <code>fetch</code> / <code>XMLHttpRequest</code>) despite being allowed by <code>CanAccessURI</code>. The patch changes the implementation of <code>CanAccessURI</code> to match the current default behavior for cors-fetches, and does it at that place to cover most scenarios (without affecting content scripts, for which we want to continue supporting access). If we ever decide to open up file:-access (rather than restricting it), then we probably need to revisit the implementation, but until then, I&#39;d rather be on the safe side.</p>
<p>I think that file:-access to extensions can be a useful feature in some cases, but it should by no means be the silent default behavior.</p>
</div></div><div class="change-set" id="c66"><div class="comment" data-id="14543590" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a63221681_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a63221681_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-12 09:35 PST" data-time="1576172135">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-66" data-comment-id="14543590" data-ismarkdown="true" ><p>What&#39;s your advice on landing the patches?</p>
<p>I want to land two patches, the fix itself, and unit tests that verifies that the supported behaviors are still working as intended.</p>
<p>Do you think that it is fine to land the following at the same time:</p>
<ul>
<li><a href="https://phabricator.services.mozilla.com/D54541" rel="nofollow">https://phabricator.services.mozilla.com/D54541</a> (tests that already passed before the fix)</li>
<li><a href="https://phabricator.services.mozilla.com/D54540" rel="nofollow">https://phabricator.services.mozilla.com/D54540</a> (fix itself)</li>
</ul>
<p>(and the regression test in the future - <a href="https://phabricator.services.mozilla.com/D54543" rel="nofollow">https://phabricator.services.mozilla.com/D54543</a> ).</p>
<p>... or should I only land the fix now, and land the tests later?<br>
One interesting point to consider is that the bug itself has been public for over two years by now:<br>
<a href="https://stackoverflow.com/questions/42108782/firefox-webextensions-get-local-files-content-by-path/44516256#44516256" rel="nofollow">https://stackoverflow.com/questions/42108782/firefox-webextensions-get-local-files-content-by-path/44516256#44516256</a></p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c67"><div class="comment" data-id="14550360" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a63221681_447061"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a63221681_447061"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-16 11:24 PST" data-time="1576524269">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-67" data-comment-id="14550360" data-ismarkdown="true" ><p>Given the public stackoverflow item I&#39;m fine with you landing all of it at once, including D54543.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c68"><div class="comment" data-id="14553799" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a63221681_447061"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a63221681_447061"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-18 00:29 PST" data-time="1576657788">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-68" data-comment-id="14553799" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/integration/autoland/rev/b4cc65a4d11e4569ea64670d24e38ef6c88a075e" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/b4cc65a4d11e4569ea64670d24e38ef6c88a075e</a><br>
<a href="https://hg.mozilla.org/mozilla-central/rev/b4cc65a4d11e" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/b4cc65a4d11e</a></p>
</div><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security-release</div><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2019-12-18 00:29 PST" data-time="1576657788">2 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=isnotempty">status-firefox73</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla73</div></div></div><div class="change-set" id="c69"><div class="comment" data-id="14554069" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a63221681_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a63221681_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-18 03:57 PST" data-time="1576670278">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-69" data-comment-id="14554069" data-ismarkdown="true" ><p>I&#39;ve only landed the already-passing tests; I&#39;ll land the other parts once I&#39;ve verified that the impact on extensions is minimal.</p>
</div><div class="activity"><div class="change">Status: RESOLVED &rarr; REOPENED</div><div class="change">Resolution: FIXED &rarr; ---</div></div></div><div class="change-set" id="a65194422_575867"><div class="change" id="aa65194422_575867">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_575867" id="a65194422_575867"><img src="https://secure.gravatar.com/avatar/9eb8612b118640351041fb0877c5fc8f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_575867" id="a65194422_575867"><a class="email " href="/user_profile?user_id=575867" > <span class="fna">Release mgmt bot [:sylvestre / :calixte / :marco for bugbug]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a65194422_575867"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a65194422_575867">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a65194422_575867">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-12-18 04:16 PST" data-time="1576671365">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=isnotempty">status-firefox73</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c70"><div class="comment" data-id="14583861" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a65194422_575867"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a65194422_575867"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-09 15:59 PST" data-time="1578614388">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-70" data-comment-id="14583861" data-ismarkdown="true" ><p>I checked all public add-ons on AMO, and the following add-ons are relying on this bug / &quot;feature&quot;. I&#39;ve listed the number of users and the use cases:</p>
<ul>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/" rel="nofollow">https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/</a> 323k users
<ul>
<li>To import local files in scripts: <a href="https://github.com/Tampermonkey/tampermonkey/issues/347" rel="nofollow">https://github.com/Tampermonkey/tampermonkey/issues/347</a></li>
</ul>
</li>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/s3download-statusbar/" rel="nofollow">https://addons.mozilla.org/en-US/firefox/addon/s3download-statusbar/</a> 82k users (recommended badge)
<ul>
<li>To read files for checksum calculations and image preview.</li>
</ul>
</li>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/styl-us/" rel="nofollow">https://addons.mozilla.org/en-US/firefox/addon/styl-us/</a> 77k users (recommended badge)
<ul>
<li>To support installation of local user styles: <a href="https://github.com/openstyles/stylus/pull/134" rel="nofollow">https://github.com/openstyles/stylus/pull/134</a></li>
</ul>
</li>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/exif-viewer/" rel="nofollow">https://addons.mozilla.org/en-US/firefox/addon/exif-viewer/</a> 35k users
<ul>
<li>Used to view metadata of local files.</li>
</ul>
</li>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/foxreplace/" rel="nofollow">https://addons.mozilla.org/en-US/firefox/addon/foxreplace/</a> 7k users
<ul>
<li>Used to automatically update by reading from a local file.</li>
</ul>
</li>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/surfingkeys_ff/" rel="nofollow">https://addons.mozilla.org/en-US/firefox/addon/surfingkeys_ff/</a> (version &lt;= 0.9.41) 1k users
<ul>
<li>Used to read settings from a local file: <a href="https://github.com/brookhong/Surfingkeys/pull/891" rel="nofollow">https://github.com/brookhong/Surfingkeys/pull/891</a></li>
<li>Author removed the code in the latest versions (including 0.9.57) when they discovered that the functionality does not work on macOS.</li>
</ul>
</li>
<li>and a couple of smaller ones.</li>
</ul>
<p>The total number of users is about 500k. Since the functionality is already not working on macOS, and the loss of use cases is not extremely critical, I&#39;ll land the patch that disables local file access, next week.</p>
</div></div><div class="change-set" id="c71"><div class="comment" data-id="14584396" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a65194422_575867"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a65194422_575867"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-10 02:11 PST" data-time="1578651090">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-71" data-comment-id="14584396" data-ismarkdown="true" ><p>Many of those affected addons would be better served with <code>&lt;input type=file&gt;</code>, it seems.</p>
</div></div><div class="change-set" id="c72"><div class="comment" data-id="14592793" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a65194422_575867"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a65194422_575867"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 13:52 PST" data-time="1579038767">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-72" data-comment-id="14592793" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/integration/autoland/rev/a32b39b12097218637d33cb0f6ac86e8d93366aa" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/a32b39b12097218637d33cb0f6ac86e8d93366aa</a><br>
<a href="https://hg.mozilla.org/mozilla-central/rev/a32b39b12097" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/a32b39b12097</a></p>
</div><div class="activity"><div class="change">Status: REOPENED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2019-12-18 00:29 PST" data-time="1576657788">2 years ago</span> &rarr; <span class="rel-time" title="2020-01-14 13:52 PST" data-time="1579038767">2 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=isnotempty">status-firefox74</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: mozilla73 &rarr; mozilla74</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="14593157" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a65194422_575867"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a65194422_575867"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 18:10 PST" data-time="1579054247">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-73" data-comment-id="14593157" data-ismarkdown="true" ><p>Doesn&#39;t feel like the kind of change we&#39;d want to land on an ESR branch, but should we consider uplifting this to Beta for Fx73?</p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=isnotempty">status-firefox72</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">Flags: needinfo?(rob)</div></div></div><div class="change-set" id="c74"><div class="comment" data-id="14593162" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a65194422_575867"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447061" id="a65194422_575867"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 18:17 PST" data-time="1579054641">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-74" data-comment-id="14593162" data-ismarkdown="true" ><p>This vulnerability has been public for multiple years, and consequently some extensions rely on it for legitimate reasons. I want to let it ride the trains to give add-on developers the opportunity to work with the limitations.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rob)</span></div></div></div><div class="change-set" id="a67577739_75935"><div class="change" id="aa67577739_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a67577739_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a67577739_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a67577739_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a67577739_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a67577739_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 18:18 PST" data-time="1579054682">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=isnotempty">status-firefox73</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a67712091_553429"><div class="change" id="aa67712091_553429">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_553429" id="a67712091_553429"><img src="https://secure.gravatar.com/avatar/468d4236db8a9810a9043dbbd470fc25?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_553429" id="a67712091_553429"><a class="email " href="/user_profile?user_id=553429" > <span class="fna">Brindusa Tot[:brindusat]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a67712091_553429"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a67712091_553429">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a67712091_553429">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-16 07:37 PST" data-time="1579189034">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify+</div><div class="change">Whiteboard: webext-sec &rarr; webext-sec [post-critsmash-triage]</div></div></div><div class="change-set" id="c75"><div class="comment" data-id="14605015" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_642772" id="a67712091_553429"><img src="https://secure.gravatar.com/avatar/ab35b4abf8109bf527125e349f88d90c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_642772" id="a67712091_553429"><a class="email " href="/user_profile?user_id=642772" > <span class="fna">Miruna Curtean</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-22 04:27 PST" data-time="1579696073">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-75" data-comment-id="14605015" data-ismarkdown="true" ><p>Verified fixed using the fileaccess.xpi extension provided in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1420296#c53" title="VERIFIED FIXED - Webextensions can access local files">comment 53</a> On Windows 10 Pro 64-bit, MacOS Catalina 10.15 and Ubuntu 16.04 LTS on FF 74.0a1 (20200121215203).<br>
Checked through loading the extension  from about debugging and inspecting it on a fixed version and also installing it (after setting xpinstall.signatures.required to false) in about:addons on a Nightly build from before the push and then upgrading the browser.<br>
A security error declaring that data may not be loaded from &quot;file:///etc/passwd&quot; is logged in the extension console log after the fix.</p>
</div><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=isnotempty">status-firefox74</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a71989444_578488"><div class="change" id="aa71989444_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a71989444_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a71989444_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a71989444_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a71989444_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a71989444_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-03-05 19:46 PST" data-time="1583466387">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: webext-sec [post-critsmash-triage] &rarr; webext-sec [post-critsmash-triage][adv-main74+]</div></div></div><div class="change-set" id="c76"><div class="comment" data-id="14679737" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a71989444_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a71989444_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-03-05 21:21 PST" data-time="1583472072">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9131374"
         class="attachment"
         data-id="9131374" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1420296.txt">
      <meta itemprop="contentSize" content="250">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9131374" itemprop="contentUrl">
        <span id="att-9131374-description" itemprop="description">advisory.txt</span></a>
        — <a href="attachment.cgi?id=9131374&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a72295880_578488"><div class="change" id="aa72295880_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a72295880_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a72295880_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a72295880_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a72295880_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a72295880_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-03-09 09:53 PDT" data-time="1583772823">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2020-6809</div></div></div><div class="change-set" id="c77"><div class="comment" data-id="14688009" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a72295880_578488"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a72295880_578488"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-03-10 14:51 PDT" data-time="1583877070">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-77" data-comment-id="14688009" data-ismarkdown="true" ><p>Test for same-origin file requests:<br>
<a href="https://hg.mozilla.org/integration/autoland/rev/823481edb95885927d150b4584ecfe639022830b" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/823481edb95885927d150b4584ecfe639022830b</a><br>
<a href="https://hg.mozilla.org/mozilla-central/rev/823481edb958" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/823481edb958</a></p>
</div></div><div class="change-set" id="a72540371_447061"><div class="change" id="aa72540371_447061">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a72540371_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_447061" id="a72540371_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a72540371_447061"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a72540371_447061">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a72540371_447061">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-03-12 05:48 PDT" data-time="1584017314">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - webRequest listeners are not called for subresources loaded by file:// pages"
   href="/show_bug.cgi?id=1621935">1621935</a></div></div></div><div class="change-set" id="a80929187_580382"><div class="change" id="aa80929187_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a80929187_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a80929187_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a80929187_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a80929187_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a80929187_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-17 08:02 PDT" data-time="1592406130">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - content scripts cannot fetch contents of file URIs"
   href="/show_bug.cgi?id=1644488">1644488</a></div></div></div><div class="change-set" id="a96862731_1689"><div class="change" id="aa96862731_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a96862731_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a96862731_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a96862731_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a96862731_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1420296#a96862731_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-12-18 17:01 PST" data-time="1608339674">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1420296&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>