<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#737206 - /usr/lib/plan9/bin/rc: CVE-2014-1935: insecure use of /tmp - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=737206&quot;&gt;737206&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:737206@bugs.debian.org">#737206</a><br>
/usr/lib/plan9/bin/rc: CVE-2014-1935: insecure use of /tmp</h1>
<div class="versiongraph"><a href="version.cgi?absolute=0;found=9base%2F1%3A6-6;collapse=1;package=9base;info=1"><img alt="version graph" src="version.cgi?height=2;found=9base%2F1%3A6-6;absolute=0;package=9base;width=2;collapse=1"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=9base">9base</a>;
Maintainer for <a href="pkgreport.cgi?package=9base">9base</a> is <a href="pkgreport.cgi?maint=packages%40qa.debian.org">Debian QA Group &lt;packages@qa.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=9base">9base</a> is <a href="pkgreport.cgi?src=9base">src:9base</a> (<a href="https://tracker.debian.org/pkg/9base">PTS</a>, <a href="https://buildd.debian.org/9base">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=9base">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=jwilk%40debian.org">Jakub Wilk &lt;jwilk@debian.org&gt;</a></p>
  <p>Date: Fri, 31 Jan 2014 11:06:01 UTC</p>

<p>Severity: important</p>
<p>Tags: security</p>

<p>Found in version 9base/1:6-6</p>



<p>Forwarded to rsc@swtch.com, anselm@garbe.us, 9trouble@plan9.bell-labs.com, 9fans@9fans.net</p>
</div>

<p><a href="mailto:737206@bugs.debian.org">Reply</a> or <a href="mailto:737206-subscribe@bugs.debian.org">subscribe</a> to this bug.</p>
<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=737206;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=737206;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=737206;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, jwilk@debian.org, Gergely Nagy &lt;algernon@madhouse-project.org&gt; -->
<!-- time:1391166366 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, jwilk@debian.org, Gergely Nagy &lt;algernon@madhouse-project.org&gt;</code>:<br>
<code>Bug#737206</code>; Package <code>9base</code>.
 (Fri, 31 Jan 2014 11:06:06 GMT) (<a href="bugreport.cgi?bug=737206;msg=2">full text</a>, <a href="bugreport.cgi?bug=737206;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="3"></a><a name="msg3"></a><a href="#3">Message #3</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=737206;msg=3">full text</a>, <a href="bugreport.cgi?bug=737206;mbox=yes;msg=3">mbox</a>, <a href="mailto:737206@bugs.debian.org?subject=Re%3A%20%2Fusr%2Flib%2Fplan9%2Fbin%2Frc%3A%20insecure%20use%20of%20%2Ftmp&amp;In-Reply-To=%3C20140131110328.GA9023%40jwilk.net%3E&amp;References=%3C20140131110328.GA9023%40jwilk.net%3E&amp;body=On%20Fri%2C%2031%20Jan%202014%2012%3A03%3A28%20%2B0100%20Jakub%20Wilk%20%3Cjwilk%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%209base%0A%3E%20Version%3A%201%3A6-6%0A%3E%20Severity%3A%20important%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20Murray%20McAllister%20from%20Red%20Hat%20Security%20Response%20Team%20discovered%20that%20rc%20%0A%3E%20creates%20temporary%20files%20in%20an%20insecure%20way%3A%0A%3E%20%0A%3E%20%24%20strace%20-o%20%27%7C%20grep%20%2Ftmp%27%20.%2Ftest-heredoc%0A%3E%20open%28%22%2Ftmp%2Fhere217f.0000%22%2C%20O_WRONLY%7CO_CREAT%7CO_TRUNC%7CO_LARGEFILE%2C%200666%29%20%3D%205%0A%3E%20open%28%22%2Ftmp%2Fhere217f.0000%22%2C%20O_RDONLY%7CO_LARGEFILE%29%20%3D%205%0A%3E%20moo%0A%3E%20unlink%28%22%2Ftmp%2Fhere217f.0000%22%29%20%20%20%20%20%20%20%20%20%20%20%20%3D%200%0A%3E%20%0A%3E%20%0A%3E%20As%20you%20can%20see%2C%20the%20filenames%20are%20easily%20predictable%2C%20and%20the%20O_EXCL%20%0A%3E%20flag%20is%20missing.%0A%3E%20%0A%3E%20--%20%0A%3E%20Jakub%20Wilk%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jwilk%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jakub Wilk &lt;jwilk@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> /usr/lib/plan9/bin/rc: insecure use of /tmp</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 31 Jan 2014 12:03:28 +0100</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=737206;msg=3">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message flowed">Package: 9base
Version: 1:6-6
Severity: important
Tags: security

Murray McAllister from Red Hat Security Response Team discovered that rc 
creates temporary files in an insecure way:

$ strace -o &#39;| grep /tmp&#39; ./test-heredoc
open(&quot;/tmp/here217f.0000&quot;, O_WRONLY|O_CREAT|O_TRUNC|O_LARGEFILE, 0666) = 5
open(&quot;/tmp/here217f.0000&quot;, O_RDONLY|O_LARGEFILE) = 5
moo
unlink(&quot;/tmp/here217f.0000&quot;)            = 0


As you can see, the filenames are easily predictable, and the O_EXCL 
flag is missing.

-- 
Jakub Wilk
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=737206;filename=test-heredoc;msg=3">test-heredoc</a> (text/plain, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="4"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1392100214 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;/usr/lib/plan9/bin/rc: CVE-2014-1935: insecure use of /tmp&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;/usr/lib/plan9/bin/rc: insecure use of /tmp&#39;
            };
-->
<strong>Changed Bug title to &#39;/usr/lib/plan9/bin/rc: CVE-2014-1935: insecure use of /tmp&#39; from &#39;/usr/lib/plan9/bin/rc: insecure use of /tmp&#39;</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 11 Feb 2014 06:30:14 GMT) (<a href="bugreport.cgi?bug=737206;msg=5">full text</a>, <a href="bugreport.cgi?bug=737206;mbox=yes;msg=5">mbox</a>, <a href="#4">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- command:forwarded -->
<!-- requester: Stéphane Aulery &lt;saulery@free.fr&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1417650858 -->
<!-- new_data:
$new_data = {
              &#39;forwarded&#39; =&gt; &#39;rsc@swtch.com, anselm@garbe.us, 9trouble@plan9.bell-labs.com, 9fans@9fans.net&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;forwarded&#39; =&gt; &#39;&#39;
            };
-->
<strong>Set Bug forwarded-to-address to &#39;rsc@swtch.com, anselm@garbe.us, 9trouble@plan9.bell-labs.com, 9fans@9fans.net&#39;.</strong>
Request was from <code>Stéphane Aulery &lt;saulery@free.fr&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 03 Dec 2014 23:54:18 GMT) (<a href="bugreport.cgi?bug=737206;msg=7">full text</a>, <a href="bugreport.cgi?bug=737206;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=737206">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:28:37 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
