<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/neutron/+bug/1734320/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1734320 “Eavesdropping private traffic” : Bugs : neutron</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1734320" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1734320/bug.atom" title="Bug 1734320 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="Eavesdropping private traffic
=============================

Abstract
--------

We've discovered a security issue that allows end users within their own private network to receive from, and send traffic to, other private networks on the same compute node.

Description
-----------

During live-migration there is a small time window where the ports of instances are untagged. Instances have a port trunked to the integration bridge and receive 802.1Q tagged private traffic from other tenants.

If..." />
      <meta property="og:description" content="Eavesdropping private traffic
=============================

Abstract
--------

We've discovered a security issue that allows end users within their own private network to receive from, and send traffic to, other private networks on the same compute node.

Description
-----------

During live-migration there is a small time window where the ports of instances are untagged. Instances have a port trunked to the integration bridge and receive 802.1Q tagged private traffic from other tenants.

If..." />
    

    
    
      <meta property="og:title" content="Bug #1734320 “Eavesdropping private traffic” : Bugs : neutron" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1734320" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["access-control", "api", "api-ref", "auto-allocated-topology", "availability-zones", "baremetal", "cells", "ceph", "cinder", "compute", "conductor", "config", "console", "cyborg", "db", "deprecation", "dns", "doc", "ec2", "evacuate", "fault-injection", "fullstack", "functional-tests", "fwaas", "gate-failure", "glance", "hyper-v", "i18n", "image-cache", "in-stable-icehouse", "in-stable-liberty", "in-stable-newton", "in-stable-ocata", "ipv6", "ironic", "kilo-backport-potential", "l2-pop", "l3-bgp", "l3-dvr-backlog", "l3-ha", "l3-ipam-dhcp", "lbaas", "lib", "liberty-backport-potential", "libvirt", "linuxbridge", "live-migration", "loadimpact", "logging", "low-hanging-fruit", "lxc", "metadata", "metering", "mitaka-backport-potential", "needs-attention", "needs-functional-test", "needs.openstack-version", "network", "neutron", "newton-backport-potential", "newton-rc-potential", "nfs", "notifications", "nova-manage", "nova-network", "numa", "ocata-backport-potential", "ocata-rc-potential", "openstack-version.grizzly", "openstack-version.havana", "openstack-version.icehouse", "openstack-version.juno", "openstack-version.kilo", "openstack-version.liberty", "openstack-version.mitaka", "openstack-version.newton", "openstack-version.ocata", "openstack-version.pike", "opnfv", "ops", "oslo", "ovn", "ovn-octavia-provider", "ovs", "ovs-fw", "ovs-lib", "pci", "performance", "pike-backport-potential", "placement", "policy", "postgresql", "powervm", "privsep", "py34", "qos", "queens-backport-potential", "quotas", "race-condition", "reboot", "rebuild", "rescue", "resize", "resource-tracker", "rfe", "rfe-approved", "rfe-confirmed", "rfe-postponed", "rfe-triaged", "rootwrap", "s390x", "scheduler", "security", "security-groups", "serviceability", "sg-fw", "shared-storage", "shelve", "snapshot", "sriov-pci-pt", "stacktrace", "stein-rc-potential", "tempest", "testing", "train-rc-potential", "troubleshooting", "trunk", "unified-objects", "unittest", "upgrade", "usability", "ussuri-backport-potential", "ussuri-rc-potential", "vgpu", "victoria-rc-potential", "vmware", "volumes", "vpnaas", "wallaby-rc-potential", "xen", "xena-rc-potential", "xenial", "xenserver", "zvm"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/neutron/+bug/1734320/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/neutron"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/neutron">neutron</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/neutron">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/neutron">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/neutron">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/neutron">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/neutron">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/neutron">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    Eavesdropping private traffic
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1734320 reported by
      <a href="https://launchpad.net/~peereb" class="sprite person">Paul Peereboom</a>
      <time title="2017-11-24 11:16:18 UTC" datetime="2017-11-24T11:16:18.241887+00:00">on 2017-11-24</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">50</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 4 people</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr id="tasksummary2320351">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/nova/+bug/1734320/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2320351">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/nova">OpenStack Compute (nova)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/nova/+bug/1734320/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/nova/+bug/1734320/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2320351">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~sean-k-mooney">sean mooney</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2320351">
     <td colspan="7"><form action="/nova/+bug/1734320/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/nova">OpenStack Compute (nova)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2017-11-28 05:37:33 UTC" datetime="2017-11-28T05:37:33.434567+00:00">2017-11-28</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2019-01-16 15:39:28 UTC" datetime="2019-01-16T15:39:28.304293+00:00">2019-01-16</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2018-09-13 20:03:58 UTC" datetime="2018-09-13T20:03:58.428846+00:00">2018-09-13</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2019-01-16 15:39:28 UTC" datetime="2019-01-16T15:39:28.304293+00:00">2019-01-16</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-08-03 22:44:46 UTC" datetime="2020-08-03T22:44:46.582244+00:00">2020-08-03</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="nova.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="nova.target.option.package" name="nova.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="nova.target.distribution" name="nova.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="nova.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="nova.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="nova.target.package"
                         name="nova.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;nova.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('nova.target.package');
              var select_menu = Y.DOM.byId('nova.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-nova-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": null, "step_title": "Search by name", "header": "Select a package", "vocabulary_filters": [], "show_create_team": false, "input_element": "nova.target.package", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "DistributionPackage", "show_widget_id": "show-widget-nova-target-package"};
        var show_widget_id = 'show-widget-nova-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="nova.target.option.product" name="nova.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="nova" id="nova.target.product"
                         name="nova.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;nova.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('nova.target.product');
              var select_menu = Y.DOM.byId('nova.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-nova-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": "nova", "step_title": "Search", "header": "Select a project", "vocabulary_filters": [], "show_create_team": false, "input_element": "nova.target.product", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "Product", "show_widget_id": "show-widget-nova-target-product"};
        var show_widget_id = 'show-widget-nova-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="nova.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="nova.status" name="nova.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="nova.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="nova.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="nova.assignee.assign_to_me" name="nova.assignee.option" value="nova.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="nova.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="nova.assignee.assigned_to" name="nova.assignee.option" value="nova.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="nova.assignee.assigned_to">
              sean mooney (sean-k-mooney)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="nova.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="nova.comment_on_change" name="nova.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary2319628">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1734320/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2319628">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1734320/+editstatus" style="float: left" class="value statusWONTFIX">Won't Fix</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1734320/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2319628">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2319628">
     <td colspan="7"><form action="/ossa/+bug/1734320/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2017-11-24 13:18:44 UTC" datetime="2017-11-24T13:18:44.537357+00:00">2017-11-24</time>
      </td>
    </tr>
    
    
    
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2018-04-27 16:41:12 UTC" datetime="2018-04-27T16:41:12.521627+00:00">2018-04-27</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": null, "step_title": "Search by name", "header": "Select a package", "vocabulary_filters": [], "show_create_team": false, "input_element": "ossa.target.package", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "DistributionPackage", "show_widget_id": "show-widget-ossa-target-package"};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": "ossa", "step_title": "Search", "header": "Select a project", "vocabulary_filters": [], "show_create_team": false, "input_element": "ossa.target.product", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "Product", "show_widget_id": "show-widget-ossa-target-product"};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Won't Fix">Won't Fix</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ossa.assignee.assign_to_nobody" name="ossa.assignee.option" value="ossa.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr class="highlight" id="tasksummary2319596">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/neutron/+bug/1734320/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2319596">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/neutron">neutron</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/neutron/+bug/1734320/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/neutron/+bug/1734320/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2319596">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~rodolfo-alonso-hernandez">Rodolfo Alonso</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2319596">
     <td colspan="7"><form action="/neutron/+bug/1734320/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/neutron">neutron</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~peereb" class="sprite person">Paul Peereboom</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2017-11-24 11:16:18 UTC" datetime="2017-11-24T11:16:18.241887+00:00">2017-11-24</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2020-08-03 22:45:25 UTC" datetime="2020-08-03T22:45:25.161552+00:00">2020-08-03</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2018-11-08 16:36:34 UTC" datetime="2018-11-08T16:36:34.148441+00:00">2018-11-08</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2020-08-04 12:39:48 UTC" datetime="2020-08-04T12:39:48.736063+00:00">2020-08-04</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-12-11 11:15:07 UTC" datetime="2020-12-11T11:15:07.375059+00:00">2020-12-11</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="neutron.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="neutron.target.option.package" name="neutron.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="neutron.target.distribution" name="neutron.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="neutron.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="neutron.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="neutron.target.package"
                         name="neutron.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;neutron.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('neutron.target.package');
              var select_menu = Y.DOM.byId('neutron.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-neutron-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": null, "step_title": "Search by name", "header": "Select a package", "vocabulary_filters": [], "show_create_team": false, "input_element": "neutron.target.package", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "DistributionPackage", "show_widget_id": "show-widget-neutron-target-package"};
        var show_widget_id = 'show-widget-neutron-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="neutron.target.option.product" name="neutron.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="neutron" id="neutron.target.product"
                         name="neutron.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;neutron.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('neutron.target.product');
              var select_menu = Y.DOM.byId('neutron.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-neutron-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": "neutron", "step_title": "Search", "header": "Select a project", "vocabulary_filters": [], "show_create_team": false, "input_element": "neutron.target.product", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "Product", "show_widget_id": "show-widget-neutron-target-product"};
        var show_widget_id = 'show-widget-neutron-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="neutron.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="neutron.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="neutron.status" name="neutron.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="neutron.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="neutron.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="neutron.assignee.assign_to_me" name="neutron.assignee.option" value="neutron.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="neutron.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="neutron.assignee.assigned_to" name="neutron.assignee.option" value="neutron.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="neutron.assignee.assigned_to">
              Rodolfo Alonso (rodolfo-alonso-hernandez)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="neutron.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="neutron.comment_on_change" name="neutron.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary2324524">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/os-vif/+bug/1734320/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2324524">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/os-vif">os-vif</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/os-vif/+bug/1734320/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/os-vif/+bug/1734320/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2324524">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~sean-k-mooney">sean mooney</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2324524">
     <td colspan="7"><form action="/os-vif/+bug/1734320/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/os-vif">os-vif</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2017-12-05 22:53:51 UTC" datetime="2017-12-05T22:53:51.225964+00:00">2017-12-05</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2018-08-21 10:16:42 UTC" datetime="2018-08-21T10:16:42.850635+00:00">2018-08-21</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2018-08-21 10:16:42 UTC" datetime="2018-08-21T10:16:42.484279+00:00">2018-08-21</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2018-08-21 10:16:42 UTC" datetime="2018-08-21T10:16:42.850635+00:00">2018-08-21</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2019-01-04 15:13:01 UTC" datetime="2019-01-04T15:13:01.149683+00:00">2019-01-04</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="os-vif.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="os-vif.target.option.package" name="os-vif.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="os-vif.target.distribution" name="os-vif.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="os-vif.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="os-vif.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="os-vif.target.package"
                         name="os-vif.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;os-vif.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('os-vif.target.package');
              var select_menu = Y.DOM.byId('os-vif.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-os-vif-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": null, "step_title": "Search by name", "header": "Select a package", "vocabulary_filters": [], "show_create_team": false, "input_element": "os-vif.target.package", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "DistributionPackage", "show_widget_id": "show-widget-os-vif-target-package"};
        var show_widget_id = 'show-widget-os-vif-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="os-vif.target.option.product" name="os-vif.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="os-vif" id="os-vif.target.product"
                         name="os-vif.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;os-vif.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('os-vif.target.product');
              var select_menu = Y.DOM.byId('os-vif.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-os-vif-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": "os-vif", "step_title": "Search", "header": "Select a project", "vocabulary_filters": [], "show_create_team": false, "input_element": "os-vif.target.product", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "Product", "show_widget_id": "show-widget-os-vif-target-product"};
        var show_widget_id = 'show-widget-os-vif-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="os-vif.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="os-vif.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="os-vif.status" name="os-vif.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="os-vif.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="os-vif.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="os-vif.assignee.assign_to_me" name="os-vif.assignee.option" value="os-vif.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="os-vif.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="os-vif.assignee.assigned_to" name="os-vif.assignee.option" value="os-vif.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="os-vif.assignee.assigned_to">
              sean mooney (sean-k-mooney)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="os-vif.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="os-vif.comment_on_change" name="os-vif.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/neutron/+bug/1734320/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/neutron/+bug/1734320/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/neutron/+bug/1734320/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>Eavesdropping private traffic<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=</p>
<p>Abstract<br />
--------</p>
<p>We&#x27;ve discovered a security issue that allows end users within their own private network to receive from, and send traffic to, other private networks on the same compute node.</p>
<p>Description<br />
-----------</p>
<p>During live-migration there is a small time window where the ports of instances are untagged. Instances have a port trunked to the integration bridge and receive 802.1Q tagged private traffic from other tenants.</p>
<p>If the port is administratively down during live migration, the port will remain in trunk mode indefinitely.</p>
<p>Traffic is possible between ports is that are administratively down, even between tenants self-service networks.</p>
<p>Conditions<br />
----------</p>
<p>The following conditions are necessary.</p>
<p>* Openvswitch Self-service networks<br />
* An Openstack administrator or an automated process needs to schedule a Live migration</p>
<p>We tested this on newton.</p>
<p>Issues<br />
------</p>
<p>This outcome is the result of multiple independent issues. We will list the most important first, and follow with bugs that create a fragile situation.</p>
<p>Issue #1 Initially creating a trunk port</p>
<p>When the port is initially created, it is in trunk mode. This creates a fail-open situation.<br />
See: <a rel="nofollow" href="https://github.com/openstack/os-vif/blob/newton-eol/vif_plug_ovs/linux_net.py#L52">https:/<wbr />/github.<wbr />com/openstack/<wbr />os-vif/<wbr />blob/newton-<wbr />eol/vif_<wbr />plug_ovs/<wbr />linux_net.<wbr />py#L52</a><br />
Recommendation: create ports in the port_dead state, don&#x27;t leave it dangling in trunk-mode. Add a drop-flow initially.</p>
<p>Issue #2 Order of creation.</p>
<p>The instance is actually migrated before the (networking) configuration is completed.</p>
<p>Recommendation: wait with finishing the live migration until the underlying configuration has been applied completely.</p>
<p>Issue #3 Not closing the port when it is down.</p>
<p>Neutron calls the port_dead function to ensure the port is down. It sets the tag to 4095 and adds a &quot;drop&quot; flow if (and only if) there is already another tag on the port. The port_dead function will keep untagged ports untagged.</p>
<p><a rel="nofollow" href="https://github.com/openstack/neutron/blob/stable/newton/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L995">https:/<wbr />/github.<wbr />com/openstack/<wbr />neutron/<wbr />blob/stable/<wbr />newton/<wbr />neutron/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/ovs_<wbr />neutron_<wbr />agent.py#<wbr />L995</a></p>
<p>Recommendation: Make port_dead also shut the port if no tag is found. Log a warning if this happens.</p>
<p>Issue #4 Putting the port administratively down actually puts the port on a compute node shared vlan</p>
<p>Instances from different projects on different private networks can talk to each other if they put their ports down. The code does install an openflow &quot;drop&quot; rule but it has a lower priority (2) than the allow rules.</p>
<p>Recommendation: Increase the port_dead openflow drop rule priority to MAX</p>
<p>Timeline<br />
--------</p>
<p>&nbsp;2017-09-14 Discovery eavesdropping issue<br />
&nbsp;2017-09-15 Verify workaround.<br />
&nbsp;2017-10-04 Discovery port-down-traffic issue<br />
&nbsp;2017-11-24 Vendor Disclosure to Openstack</p>
<p>Steps to reproduce<br />
------------------</p>
<p>1. Attach an instance to two networks:</p>
<p>admin$ openstack server create --nic net-id=&lt;net-uuid1&gt; --nic net-id=&lt;net-uuid2&gt; --image &lt;image_id&gt; --flavor &lt;flavor_id&gt; instance_temp</p>
<p>2. Attach a FIP to the instance to be able to log in to this instance</p>
<p>3. Verify:</p>
<p>admin$ openstack server show -c name -c addresses fe28a2ee-<wbr />098f-4425-<wbr />9d3c-8e2cd38354<wbr />7d</p>
<p>+------<wbr />-----+-<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />------+<br />
| Field     | Value                                                                       |<br />
+------<wbr />-----+-<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />------+<br />
| addresses | network1=<wbr />192.168.<wbr />99.8, &lt;FIP&gt;; network2=<wbr />192.168.<wbr />80.14                        |<br />
| name      | instance_temp                                                               |<br />
+------<wbr />-----+-<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />------+</p>
<p>4. Ssh to the instance using network1 and run a tcpdump on the other port network2</p>
<p>[root@instance_<wbr />temp]$ tcpdump -eeenni eth1</p>
<p>5. Get port-id of network2</p>
<p>admin$ nova interface-list fe28a2ee-<wbr />098f-4425-<wbr />9d3c-8e2cd38354<wbr />7d<br />
+------<wbr />------+<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />---+---<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />+------<wbr />-------<wbr />--+----<wbr />-------<wbr />-------<wbr />-+<br />
| Port State | Port ID                              | Net ID                               | IP addresses  | MAC Addr          |<br />
+------<wbr />------+<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />---+---<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />+------<wbr />-------<wbr />--+----<wbr />-------<wbr />-------<wbr />-+<br />
| ACTIVE     | a848520b-<wbr />0814-4030-<wbr />bb48-49e4b5cf81<wbr />60 | d69028f7-<wbr />9558-4f14-<wbr />8ce6-29cb8f1c19<wbr />cd | 192.168.80.14 | fa:16:3e:2d:8b:7b |<br />
| ACTIVE     | fad148ca-<wbr />cf7a-4839-<wbr />aac3-a2cd8d1d22<wbr />60 | d22c22ae-<wbr />0a42-4e3b-<wbr />8144-f28534c343<wbr />9a | 192.168.99.8  | fa:16:3e:60:2c:fa |<br />
+------<wbr />------+<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />---+---<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />+------<wbr />-------<wbr />--+----<wbr />-------<wbr />-------<wbr />-+</p>
<p>6. Force port down on network 2</p>
<p>admin$ neutron port-update a848520b-<wbr />0814-4030-<wbr />bb48-49e4b5cf81<wbr />60 --admin-state-up False</p>
<p>7. Port gets tagged with vlan 4095, the dead vlan tag, which is normal:</p>
<p>compute1# grep a848520b-<wbr />0814-4030-<wbr />bb48-49e4b5cf81<wbr />60 /var/log/<wbr />neutron/<wbr />neutron-<wbr />openvswitch-<wbr />agent.log | tail -1<br />
INFO neutron.<wbr />plugins.<wbr />ml2.drivers.<wbr />openvswitch.<wbr />agent.ovs_<wbr />neutron_<wbr />agent [req-e008feb3-<wbr />8a35-4c97-<wbr />adac-b48ff88165<wbr />b2 - - - - -] VIF port: a848520b-<wbr />0814-4030-<wbr />bb48-49e4b5cf81<wbr />60 admin state up disabled, putting on the dead VLAN</p>
<p>8. Verify the port is tagged with vlan 4095</p>
<p>compute1# ovs-vsctl show | grep -A3 qvoa848520b-08<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;qvoa848520b-08&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag: 4095<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;qvoa848520b-08&quot;</p>
<p>9. Now live-migrate the instance:</p>
<p>admin# nova live-migration fe28a2ee-<wbr />098f-4425-<wbr />9d3c-8e2cd38354<wbr />7d</p>
<p>10. Verify the tag is gone on compute2, and take a deep breath</p>
<p>compute2# ovs-vsctl show | grep -A3 qvoa848520b-08<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;qvoa848520b-08&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;qvoa848520b-08&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port...<br />
compute2# echo &quot;Wut!&quot;</p>
<p>11. Now traffic of all other self-service networks present on compute2 can be sniffed from instance_temp</p>
<p>[root@instance_<wbr />temp] tcpdump -eenni eth1<br />
13:14:31.748266 fa:16:3e:6a:17:38 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.152, length 28<br />
13:14:31.804573 fa:16:3e:e8:a2:d2 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.70, length 28<br />
13:14:31.810482 fa:16:3e:95:ca:3a &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.154, length 28<br />
13:14:31.977820 fa:16:3e:6f:f4:9b &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.150, length 28<br />
13:14:31.979590 fa:16:3e:0f:3d:cc &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 9, p 0, ethertype ARP, Request who-has 10.103.9.163 tell 10.103.9.1, length 28<br />
13:14:32.048082 fa:16:3e:65:64:38 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.101, length 28<br />
13:14:32.127400 fa:16:3e:30:cb:b5 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.165, length 28<br />
13:14:32.141982 fa:16:3e:96:cd:b0 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.100, length 28<br />
13:14:32.205327 fa:16:3e:a2:0b:76 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.153, length 28<br />
13:14:32.444142 fa:16:3e:1f:db:ed &gt; 01:00:5e:00:00:12, ethertype 802.1Q (0x8100), length 58: vlan 72, p 0, ethertype IPv4, 192.168.99.212 &gt; 224.0.0.18: VRRPv2, Advertisement, vrid 50, prio 103, authtype none, intvl 1s, length 20<br />
13:14:32.449497 fa:16:3e:1c:24:c0 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.20, length 28<br />
13:14:32.476015 fa:16:3e:f2:3b:97 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.22, length 28<br />
13:14:32.575034 fa:16:3e:44:fe:35 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.163, length 28<br />
13:14:32.676185 fa:16:3e:1e:92:d7 &gt; ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.150, length 28<br />
13:14:32.711755 fa:16:3e:99:6c:c8 &gt; 01:00:5e:00:00:12, ethertype 802.1Q (0x8100), length 62: vlan 10, p 0, ethertype IPv4, 10.103.12.154 &gt; 224.0.0.18: VRRPv2, Advertisement, vrid 2, prio 49, authtype simple, intvl 1s, length 24<br />
13:14:32.711773 fa:16:3e:f5:23:d5 &gt; 01:00:5e:00:00:12, ethertype 802.1Q (0x8100), length 58: vlan 12, p 0, ethertype IPv4, 10.103.15.154 &gt; 224.0.0.18: VRRPv2, Advertisement, vrid 1, prio 49, authtype simple, intvl 1s, length 20</p>
<p>Workaround<br />
----------</p>
<p>We temporary fixed this issue by forcing the dead vlan tag on port creation on compute nodes:</p>
<p>/usr/lib/<wbr />python2.<wbr />7/site-<wbr />packages/<wbr />vif_plug_<wbr />ovs/linux_<wbr />net.py:</p>
<p>def _create_<wbr />ovs_vif_<wbr />cmd(bridge, dev, iface_id, mac,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;instance_<wbr />id, interface_<wbr />type=None,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;vhost_<wbr />server_<wbr />path=None)<wbr />:<br />
+   # ODCN: initialize port as dead<br />
+   # ODCN: TODO: set drop flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;cmd = [&#x27;--&#x27;, &#x27;--if-exists&#x27;, &#x27;del-port&#x27;, dev, &#x27;--&#x27;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;add-<wbr />port&#x27;, bridge, dev,<br />
+           &#x27;tag=4095&#x27;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;--&#x27;, &#x27;set&#x27;, &#x27;Interface&#x27;, dev,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;external-<wbr />ids:iface-<wbr />id=%s&#x27; % iface_id,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;external-<wbr />ids:iface-<wbr />status=<wbr />active&#x27;<wbr />,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;external-<wbr />ids:attached-<wbr />mac=%s&#x27; % mac,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;external-<wbr />ids:vm-<wbr />uuid=%s&#x27; % instance_id]<br />
&nbsp;&nbsp;&nbsp;&nbsp;if interface_type:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd += [&#x27;type=%s&#x27; % interface_type]<br />
&nbsp;&nbsp;&nbsp;&nbsp;if vhost_server_path:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd += [&#x27;options:<wbr />vhost-server-<wbr />path=%s&#x27; % vhost_server_path]<br />
&nbsp;&nbsp;&nbsp;&nbsp;return cmd</p>
<p><a rel="nofollow" href="https://github.com/openstack/neutron/blob/stable/newton/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L995">https:/<wbr />/github.<wbr />com/openstack/<wbr />neutron/<wbr />blob/stable/<wbr />newton/<wbr />neutron/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/ovs_<wbr />neutron_<wbr />agent.py#<wbr />L995</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;def port_dead(self, port, log_errors=True):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;&#x27;&#x27;Once a port has no binding, put it on the &quot;dead vlan&quot;.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:param port: an ovs_lib.VifPort object.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;&#x27;&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#x27;t kill a port if it&#x27;s already dead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cur_tag = self.int_<wbr />br.db_get_<wbr />val(&quot;Port&quot;<wbr />, port.port_name, &quot;tag&quot;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_<wbr />errors=<wbr />log_errors)<br />
+       # ODCN GM 20170915<br />
+       if not cur_tag:<br />
+           LOG.error(<wbr />&#x27;port_dead(<wbr />): port %s has no tag&#x27;, port.port_name)<br />
+       # ODCN AJS 20170915<br />
+       if not cur_tag or cur_tag != constants.<wbr />DEAD_VLAN_<wbr />TAG:<br />
-       if cur_tag and cur_tag != constants.<wbr />DEAD_VLAN_<wbr />TAG:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;LOG.<wbr />info(&#x27;port_<wbr />dead(): put port %s on dead vlan&#x27;, port.port_name)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />int_br.<wbr />set_db_<wbr />attribute(<wbr />&quot;Port&quot;, port.port_name, &quot;tag&quot;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants<wbr />.DEAD_VLAN_<wbr />TAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_<wbr />errors=<wbr />log_errors)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />int_br.<wbr />drop_port(<wbr />in_port=<wbr />port.ofport)</p>
<p>plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/openflow/<wbr />ovs_ofctl/<wbr />ovs_bridge.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;def drop_port(self, in_port):<br />
+        # ODCN AJS 20171004:<br />
-       self.install_<wbr />drop(priority=<wbr />2, in_port=in_port)<br />
+       self.install_<wbr />drop(priority=<wbr />65535, in_port=in_port)</p>
<p>Regards,</p>
<p>ODC Noord.<br />
Gerhard Muntingh<br />
Albert Siersema<br />
Paul Peereboom</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          <span>See <a href="comments/0">original description</a></span>
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            Tags:
          </span>
          <span id="tag-list">
            <a class="official-tag" href="/neutron/+bugs?field.tag=security">security</a>
            <a class="unofficial-tag" href="/neutron/+bugs?field.tag=in-stable-pike">in-stable-pike</a>
            <a class="unofficial-tag" href="/neutron/+bugs?field.tag=in-stable-queens">in-stable-queens</a>
            <a class="unofficial-tag" href="/neutron/+bugs?field.tag=in-stable-rocky">in-stable-rocky</a>
            <a class="unofficial-tag" href="/neutron/+bugs?field.tag=in-stable-victoria">in-stable-victoria</a>
            <a class="unofficial-tag" href="/neutron/+bugs?field.tag=neutron-proactive-backport-potential">neutron-proactive-backport-potential</a>
          </span>
          
          <a href="+edit" title="Edit tags" id="tags-trigger" class="sprite edit action-icon">Edit</a>
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2018-14636" title="Live-migrated instances are briefly a...">2018-14636</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-24T13:19:21.490334+00:00" title="2017-11-24 13:19:21 UTC">on 2017-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-24T17:31:37.094199+00:00" title="2017-11-24 17:31:37 UTC">on 2017-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looking.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looking.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-24T17:36:31.319407+00:00" title="2017-11-24 17:36:31 UTC">on 2017-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>My fear is that this vulnerability might be present on releases newer than Newton.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">My fear is that this vulnerability might be present on releases newer than Newton.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kevinbenton" class="sprite person">Kevin Benton (kevinbenton)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-24T18:49:17.399757+00:00" title="2017-11-24 18:49:17 UTC">on 2017-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The other thing that surprised me about this is that there are rules forwarding traffic to the port when it doesn&#x27;t have a VLAN tag. Is the behavior of the NORMAL action to flood to all untagged ports as if they were trunks carrying all VLANs?</p>
<p>The other suggested fixes all seem to be working under the assumption that traffic will flow to ports if no rules are installed. I think it would be safest to ensure that a newly added port to br-int doesn&#x27;t receive any traffic until flows are setup. Going that route would also avoid having to ban all earlier versions of os-vif because a VLAN tag would not need to be set on plugging.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The other thing that surprised me about this is that there are rules forwarding traffic to the port when it doesn't have a VLAN tag. Is the behavior of the NORMAL action to flood to all untagged ports as if they were trunks carrying all VLANs?

The other suggested fixes all seem to be working under the assumption that traffic will flow to ports if no rules are installed. I think it would be safest to ensure that a newly added port to br-int doesn't receive any traffic until flows are setup. Going that route would also avoid having to ban all earlier versions of os-vif because a VLAN tag would not need to be set on plugging.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T05:02:47.197117+00:00" title="2017-11-28 05:02:47 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Should we subscribe the Nova project for the issue #2 (Order of creation)?</p>
<p>Also, isn&#x27;t instance migration an admin only operation? If so, can a regular user abuse this bug without an admin cooperation?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Should we subscribe the Nova project for the issue #2 (Order of creation)?

Also, isn't instance migration an admin only operation? If so, can a regular user abuse this bug without an admin cooperation?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T05:14:01.566680+00:00" title="2017-11-28 05:14:01 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tristan: perhaps looping in the nova project is not a bad idea, and yes, you&#x27;re right that migration can only be performed by an admin according to the default policy.json.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tristan: perhaps looping in the nova project is not a bad idea, and yes, you're right that migration can only be performed by an admin according to the default policy.json.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T05:19:09.677809+00:00" title="2017-11-28 05:19:09 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Today I was looking at this a bit to see if &#x27;resizing&#x27; would expose the same behavior, as that is available to regular users. I shall be able to find more time tomorrow to assess what&#x27;s going on pike and ocata.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Today I was looking at this a bit to see if 'resizing' would expose the same behavior, as that is available to regular users. I shall be able to find more time tomorrow to assess what's going on pike and ocata.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T05:41:07.238608+00:00" title="2017-11-28 05:41:07 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Armando for the prompt feedback. I&#x27;ve subscribed nova-coresec to discuss the scope of this vulnerability, in particular the issue #2.</p>
<p>@nova-coresec, is it correct to assume migration operation are restricted to admin? If a deployment does authorize regular user to do migration operation, wouldn&#x27;t they be vulnerable to other unexpected issues anyway?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Armando for the prompt feedback. I've subscribed nova-coresec to discuss the scope of this vulnerability, in particular the issue #2.

@nova-coresec, is it correct to assume migration operation are restricted to admin? If a deployment does authorize regular user to do migration operation, wouldn't they be vulnerable to other unexpected issues anyway?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peereb" class="sprite person">Paul Peereboom (peereb)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T08:28:53.351957+00:00" title="2017-11-28 08:28:53 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tristan: yes nova live-migration is by default an admin only operation. But forcing the port-down can be done by a user aswell. Then it&#x27;s just waiting for an admin to do a live-migration of a instance. We live-migrate instances regularly to empty a compute node and patch the compute node.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tristan: yes nova live-migration is by default an admin only operation. But forcing the port-down can be done by a user aswell. Then it's just waiting for an admin to do a live-migration of a instance. We live-migrate instances regularly to empty a compute node and patch the compute node.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T14:54:35.366490+00:00" title="2017-11-28 14:54:35 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Block migration would also be affected by the same behavior.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Block migration would also be affected by the same behavior.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T14:55:38.800088+00:00" title="2017-11-28 14:55:38 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Paul, well I tend to agree this is a vulnerability (class A according to the VMT taxonomy: <a rel="nofollow" href="http://security.openstack.org/vmt-process.html#incident-report-taxonomy">http://<wbr />security.<wbr />openstack.<wbr />org/vmt-<wbr />process.<wbr />html#incident-<wbr />report-<wbr />taxonomy</a> ). However, since a malicious user can&#x27;t control the condition of exploitation, other VMT member may disagree with issuing an advisory for this issue.</p>
<p>I guess it boils down to how likely a user can snoop sensitive traffic.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Paul, well I tend to agree this is a vulnerability (class A according to the VMT taxonomy: http://security.openstack.org/vmt-process.html#incident-report-taxonomy ). However, since a malicious user can't control the condition of exploitation, other VMT member may disagree with issuing an advisory for this issue.

I guess it boils down to how likely a user can snoop sensitive traffic.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-28T15:12:51.289173+00:00" title="2017-11-28 15:12:51 UTC">on 2017-11-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>That&#x27;s why I am trying to verify that the resize operation has the same behavior, because if that&#x27;s the case, the user is very much in control!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">That's why I am trying to verify that the resize operation has the same behavior, because if that's the case, the user is very much in control!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peereb" class="sprite person">Paul Peereboom (peereb)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-29T09:03:35.103892+00:00" title="2017-11-29 09:03:35 UTC">on 2017-11-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Agree lets see if we can reproduce without admin credentials.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Agree lets see if we can reproduce without admin credentials.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-29T17:01:43.695743+00:00" title="2017-11-29 17:01:43 UTC">on 2017-11-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I used a Pike-based deployment as a testing platform and I can confirm that the resize operation exposes the same behavior as live/block migration (as reported in this report), i.e. the port connected to the VM shows up without a local VLAN tag on the target host.</p>
<p>I still have to look at the extent of the damage that the user can inflict. So, it looks like the malicious user can be in full control of the condition of exploitation.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I used a Pike-based deployment as a testing platform and I can confirm that the resize operation exposes the same behavior as live/block migration (as reported in this report), i.e. the port connected to the VM shows up without a local VLAN tag on the target host.

I still have to look at the extent of the damage that the user can inflict. So, it looks like the malicious user can be in full control of the condition of exploitation.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-29T23:27:35.668529+00:00" title="2017-11-29 23:27:35 UTC">on 2017-11-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Armando,</p>
<p>so the next question is, can this be fixed across all the supported stable release? (e.g.: pike and ocata) ?<br />
And is there something to fix in the os-vif and nova project too?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Armando,

so the next question is, can this be fixed across all the supported stable release? (e.g.: pike and ocata) ?
And is there something to fix in the os-vif and nova project too? </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-11-29T23:45:36.098559+00:00" title="2017-11-29 23:45:36 UTC">on 2017-11-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Tristan,</p>
<p>I wanted to look a bit deeper at what happens on the datapath, but I keep getting sidetracked. The report and analysis from Paul has been excellent, and I welcome that level of detail very much, but I want to see this through a bit more to formulate a recommendation.</p>
<p>Thanks for everyone involved!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Tristan,

I wanted to look a bit deeper at what happens on the datapath, but I keep getting sidetracked. The report and analysis from Paul has been excellent, and I welcome that level of detail very much, but I want to see this through a bit more to formulate a recommendation.

Thanks for everyone involved!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-02T06:02:47.947749+00:00" title="2017-12-02 06:02:47 UTC">on 2017-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>OK, I finally had some interrupted time in which I could look into this more carefully. the TL;DR summary is: the behavior is exposed in live-migrate/<wbr />block-migrate/<wbr />resize operations. That said, I don&#x27;t believe this vulnerability is serious at least under default conditions. Here&#x27;s why:</p>
<p>1) live/block migration is an admin operation: if the admin avoids turning a port down, the vulnerability is not exposed. Turning a port down is not strictly necessary. Furthermore block migration is disruptive, in that users loses console and network connectivity to the instance.</p>
<p>2) resize is a user allowed operation, but the operation leads to traffic disruption. Even though a user can explicitly turn a port DOWN and resize the instance without admin intervention, there&#x27;s no way she can keep connectivity to the instance while the operation is in progress. Turning the port back UP will reinstate the local VLAN tag and restore connectivity. The loophole at that point is closed.</p>
<p>For these reasons, I would cautiously say that this vulnerability is not easily exploitable, but we do want to warn the admin of the potential loophole (OSSN B2?), and eventually address the neutron OVS agent codebase to ensure that a port is always tagged even when it&#x27;s in ADMIN_DOWN after a migration/resize operation.</p>
<p>I&#x27;d recommend against changing os-vif to start a port on the dead vlan for two reasons:</p>
<p>a) neutron use cases go beyond just spinning up VMs. So if possible we should find a fix confined within neutron alone.</p>
<p>b) I feel that the os-vif fix as proposed is ineffective in closing any timing window because while the port is untagged, it&#x27;s practically unlikely that a user can get hold of the console remotely.</p>
<p>I am open to feedback on my recommendation, but in the meantime I would like to thank the reporter for the very detailed, well thought and challenging report. I had fun cracking this one. Keep them coming!</p>
<p>Needless to say, open to further discussion.</p>
<p>@Tristan: what&#x27;s next steps? Is this OSSA then marked CONFIRMED? I would like to involve Ihar and Miguel for what comes next. Unless my rationale is flawed, I consider my triage complete and I&#x27;d like to push the ball into someone else&#x27;s court.</p>
<p>Cheers,<br />
Armando</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">OK, I finally had some interrupted time in which I could look into this more carefully. the TL;DR summary is: the behavior is exposed in live-migrate/block-migrate/resize operations. That said, I don't believe this vulnerability is serious at least under default conditions. Here's why:

1) live/block migration is an admin operation: if the admin avoids turning a port down, the vulnerability is not exposed. Turning a port down is not strictly necessary. Furthermore block migration is disruptive, in that users loses console and network connectivity to the instance.

2) resize is a user allowed operation, but the operation leads to traffic disruption. Even though a user can explicitly turn a port DOWN and resize the instance without admin intervention, there's no way she can keep connectivity to the instance while the operation is in progress. Turning the port back UP will reinstate the local VLAN tag and restore connectivity. The loophole at that point is closed.

For these reasons, I would cautiously say that this vulnerability is not easily exploitable, but we do want to warn the admin of the potential loophole (OSSN B2?), and eventually address the neutron OVS agent codebase to ensure that a port is always tagged even when it's in ADMIN_DOWN after a migration/resize operation.

I'd recommend against changing os-vif to start a port on the dead vlan for two reasons:

a) neutron use cases go beyond just spinning up VMs. So if possible we should find a fix confined within neutron alone.

b) I feel that the os-vif fix as proposed is ineffective in closing any timing window because while the port is untagged, it's practically unlikely that a user can get hold of the console remotely.

I am open to feedback on my recommendation, but in the meantime I would like to thank the reporter for the very detailed, well thought and challenging report. I had fun cracking this one. Keep them coming!

Needless to say, open to further discussion.

@Tristan: what's next steps? Is this OSSA then marked CONFIRMED? I would like to involve Ihar and Miguel for what comes next. Unless my rationale is flawed, I consider my triage complete and I'd like to push the ball into someone else's court.

Cheers,
Armando</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Triaged
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Low
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-02T06:40:15.610324+00:00" title="2017-12-02 06:40:15 UTC">on 2017-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thank you Armando for this thorough investigation.</p>
<p>You mention console access as a requirement, but couldn&#x27;t the user run nohup task in the background to capture the traffic, and then retrieve the data later?</p>
<p>To answer your last question, if this is triaged as B2, then we would subscribe the ossg-coresec group so that an OSSN could be prepared and may be sent to the downstream stakeholders through the embargo-notice mailing list before disclosing this bug. Though the live migration case may be bad enough (e.g.: for operator going through that process often) that we may want to issue an advisory instead.</p>
<p>Please feel free to subscribe more neutron or nova developers to this bug, at least to check for unforeseen scenarios.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thank you Armando for this thorough investigation.

You mention console access as a requirement, but couldn't the user run nohup task in the background to capture the traffic, and then retrieve the data later?

To answer your last question, if this is triaged as B2, then we would subscribe the ossg-coresec group so that an OSSN could be prepared and may be sent to the downstream stakeholders through the embargo-notice mailing list before disclosing this bug. Though the live migration case may be bad enough (e.g.: for operator going through that process often) that we may want to issue an advisory instead.

Please feel free to subscribe more neutron or nova developers to this bug, at least to check for unforeseen scenarios.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gerhard-1" class="sprite person">Gerhard Muntingh (gerhard-1)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-02T11:48:23.679221+00:00" title="2017-12-02 11:48:23 UTC">on 2017-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Armando, I&#x27;m also impressed by the thorough investigation. Especially the resize insight.</p>
<p>Please carefully read point two below. I think the issue is more serious because of it.</p>
<p>1) Turning the port down (as a user) is not necessary, but it changes the trunk-mode time from a couple of seconds to indefinitely.</p>
<p>2) There&#x27;s no need to put the port (eth0) back up, if the attacker creates a secondary network interface (eth1) to access the instance.  No console access is needed.  This is the described scenario in the original report.</p>
<p>Thanks,<br />
Gerhard.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Armando, I'm also impressed by the thorough investigation. Especially the resize insight.

Please carefully read point two below. I think the issue is more serious because of it.

1) Turning the port down (as a user) is not necessary, but it changes the trunk-mode time from a couple of seconds to indefinitely.

2) There's no need to put the port (eth0) back up, if the attacker creates a secondary network interface (eth1) to access the instance.  No console access is needed.  This is the described scenario in the original report.



Thanks,
Gerhard.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-02T17:23:20.840386+00:00" title="2017-12-02 17:23:20 UTC">on 2017-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I didn&#x27;t mean that console would be a requirement for the exploit, and indeed I overlooked the two-NICs scenario. Thanks for your feedback...I feared I was missing something ;)</p>
<p>That said, I have been thinking if ensuring a tag on the port after resize/migration operation suffices to mitigate the exploitation.</p>
<p>Ihar identified snippet of code [1] as potential contentious, and I wonder if along location [2] would be the only two areas required to be hardened.</p>
<p>Thoughts?<br />
Thanks,<br />
Armando</p>
<p>[1] <a rel="nofollow" href="https://github.com/openstack/neutron/blob/master/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L1426-L1436">https:/<wbr />/github.<wbr />com/openstack/<wbr />neutron/<wbr />blob/master/<wbr />neutron/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/ovs_<wbr />neutron_<wbr />agent.py#<wbr />L1426-L1436</a><br />
[2] <a rel="nofollow" href="https://github.com/openstack/neutron/blob/newton-eol/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L995">https:/<wbr />/github.<wbr />com/openstack/<wbr />neutron/<wbr />blob/newton-<wbr />eol/neutron/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/ovs_<wbr />neutron_<wbr />agent.py#<wbr />L995</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I didn't mean that console would be a requirement for the exploit, and indeed I overlooked the two-NICs scenario. Thanks for your feedback...I feared I was missing something ;)

That said, I have been thinking if ensuring a tag on the port after resize/migration operation suffices to mitigate the exploitation.

Ihar identified snippet of code [1] as potential contentious, and I wonder if along location [2] would be the only two areas required to be hardened.

Thoughts?
Thanks,
Armando

[1] https://github.com/openstack/neutron/blob/master/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L1426-L1436
[2] https://github.com/openstack/neutron/blob/newton-eol/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L995</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gerhard-1" class="sprite person">Gerhard Muntingh (gerhard-1)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-04T12:57:19.336705+00:00" title="2017-12-04 12:57:19 UTC">on 2017-12-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hardening both locations doesn&#x27;t fix the issue. It brings the time window back to a couple of seconds.</p>
<p>Out of curiosity, can&#x27;t nova-compute skip the os-vif step, and have neutron configure the port entirely?</p>
<p>Looping will also work.</p>
<p>Also, don&#x27;t forget the less serious issue #4.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hardening both locations doesn't fix the issue. It brings the time window back to a couple of seconds. 

Out of curiosity, can't nova-compute skip the os-vif step, and have neutron configure the port entirely?

Looping will also work.

Also, don't forget the less serious issue #4. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-05T21:27:49.100031+00:00" title="2017-12-05 21:27:49 UTC">on 2017-12-05</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I agree with Gerhard on the fact that hardening on neutron side won&#x27;t completely eliminate the issue in nova/neutron setup. We should also have a fix on os-vif side where we enforce dead tag on newly created ports. AFAIU os-vif may not have been used before recent releases of Nova so the fix may need to be both in os-vif and nova stable branches.</p>
<p>As for #4, I think it will not be an issue if we enforce dead tag when putting a port down. (The problem is currently we don&#x27;t do it for unbound ports.)</p>
<p>If I try to capture all the things we may need to patch, I get the following:<br />
- (neutron) port_dead to always set dead tag on new unbound ports;<br />
- (os-vif/nova) enforce dead tag for new ovs ports.</p>
<p>The first patch fixes the issue on neutron side for setups that are not using Nova / os-vif. In those setups, components calling to Neutron should make sure newly created ports are dead, otherwise they are still exposed to a (short) vulnerable window. (Should we include this info in a release note / security report? Should we reach out to Neutron API consumers that may be affected?)</p>
<p>The second fix will completely close the short vulnerable window in neutron/nova setups discussed above.</p>
<p>(I actually feel that those two issues are independent and should be treated as two separate CVEs targeting different components.)</p>
<p>Then additional hardening patches could also be:<br />
- (neutron) use drop rule for normal action on br-int; (may be invasive / breaking external code);<br />
(and/or)<br />
- (neutron) bump priority for drop flow rule set for dead ports.</p>
<p>The hardening may happen in public since neither of those issues should expose anything as long as os-vif/neutron patches as described before.</p>
<p>Does it make sense?</p>
<p>Is anyone from Nova team aware of the issue?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I agree with Gerhard on the fact that hardening on neutron side won't completely eliminate the issue in nova/neutron setup. We should also have a fix on os-vif side where we enforce dead tag on newly created ports. AFAIU os-vif may not have been used before recent releases of Nova so the fix may need to be both in os-vif and nova stable branches.

As for #4, I think it will not be an issue if we enforce dead tag when putting a port down. (The problem is currently we don't do it for unbound ports.)

If I try to capture all the things we may need to patch, I get the following:
- (neutron) port_dead to always set dead tag on new unbound ports;
- (os-vif/nova) enforce dead tag for new ovs ports.

The first patch fixes the issue on neutron side for setups that are not using Nova / os-vif. In those setups, components calling to Neutron should make sure newly created ports are dead, otherwise they are still exposed to a (short) vulnerable window. (Should we include this info in a release note / security report? Should we reach out to Neutron API consumers that may be affected?)

The second fix will completely close the short vulnerable window in neutron/nova setups discussed above.

(I actually feel that those two issues are independent and should be treated as two separate CVEs targeting different components.)

Then additional hardening patches could also be:
- (neutron) use drop rule for normal action on br-int; (may be invasive / breaking external code);
(and/or)
- (neutron) bump priority for drop flow rule set for dead ports.

The hardening may happen in public since neither of those issues should expose anything as long as os-vif/neutron patches as described before.

Does it make sense?

Is anyone from Nova team aware of the issue?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~armando-migliaccio" class="sprite person">Armando Migliaccio (armando-migliaccio)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-05T22:54:14.632100+00:00" title="2017-12-05 22:54:14 UTC">on 2017-12-05</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ihar, I agree with your assessment, thanks for pushing this forward; I am a bit uneasy about the implications of adding a drop rule for normal actions on br-int for the reasons you&#x27;ve stated (maybe that breaks Tap as a Service or SFC or other stuff?). We should also make sure that the change on the os-vif side will not break things like OVN/ODL or other drivers that rely on OVS because I don&#x27;t believe there&#x27;s any local VLAN tagging involved for those. Have you considered these scenarios?</p>
<p>To answer Gerhard&#x27;s question about os-vif, iirc the rationale of having nova do the plugging is to enable scenarios where there&#x27;s no network agent involved on the neutron side and/or to abstract the networking service from hypervisor internals.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ihar, I agree with your assessment, thanks for pushing this forward; I am a bit uneasy about the implications of adding a drop rule for normal actions on br-int for the reasons you've stated (maybe that breaks Tap as a Service or SFC or other stuff?). We should also make sure that the change on the os-vif side will not break things like OVN/ODL or other drivers that rely on OVS because I don't believe there's any local VLAN tagging involved for those. Have you considered these scenarios?

To answer Gerhard's question about os-vif, iirc the rationale of having nova do the plugging is to enable scenarios where there's no network agent involved on the neutron side and/or to abstract the networking service from hypervisor internals.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gerhard-1" class="sprite person">Gerhard Muntingh (gerhard-1)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-06T07:10:18.844785+00:00" title="2017-12-06 07:10:18 UTC">on 2017-12-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks, that makes sense.</p>
<p>I suspect adding a drop rule for normal action on br-int will require quite some explicit flows to deal with all the other bridges (br-ex), but we&#x27;ll see.</p>
<p>On neutron hardening: Bumping priority for drop flow rule set for dead ports will fix issue #4.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks, that makes sense.

I suspect adding a drop rule for normal action on br-int will require quite some explicit flows to deal with all the other bridges (br-ex), but we'll see.

On neutron hardening: Bumping priority for drop flow rule set for dead ports will fix issue #4.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~minsel" class="sprite person">Miguel Lavalle (minsel)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-06T21:11:37.573585+00:00" title="2017-12-06 21:11:37 UTC">on 2017-12-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks to everybody who has helped in diagnosing this issue. It seems we have two sets of actions:</p>
<p>1) Fixing: that involves port_dead to always set dead tag on new unbound ports in Neutron and enforce dead tag for new ovs ports in nova / os-vif</p>
<p>2) Hardening of Neutron code</p>
<p>I suggest that as the very next step we concentrate in the fixing part. For this the Neutron side seems to be uncontroversial. The only sticking point left is the potential breakage of other back-ends with the os-vif fix. Can we involve someone from OVN to see what the implications might be?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks to everybody who has helped in diagnosing this issue. It seems we have two sets of actions:

1) Fixing: that involves port_dead to always set dead tag on new unbound ports in Neutron and enforce dead tag for new ovs ports in nova / os-vif

2) Hardening of Neutron code

I suggest that as the very next step we concentrate in the fixing part. For this the Neutron side seems to be uncontroversial. The only sticking point left is the potential breakage of other back-ends with the os-vif fix. Can we involve someone from OVN to see what the implications might be?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-06T21:30:09.690860+00:00" title="2017-12-06 21:30:09 UTC">on 2017-12-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Please subscribe anyone you think may be able to help identify a safe solution.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Please subscribe anyone you think may be able to help identify a safe solution.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-07T18:52:27.182517+00:00" title="2017-12-07 18:52:27 UTC">on 2017-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I subscribed Miguel Angel Ajo from networking-ovn team to assess whether proposed os-vif fix would break them.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I subscribed Miguel Angel Ajo from networking-ovn team to assess whether proposed os-vif fix would break them.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-07T19:04:17.342094+00:00" title="2017-12-07 19:04:17 UTC">on 2017-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>(something we discussed with Armando yesterday)</p>
<p>if for some reason the suggested change to os-vif to mark all new ports with dead tag is breaking other projects, we may roll it in as opt-in, where consumer passes some flag through binding profile dictionary that would instruct nova to also mark a new port as dead; then the flag would be proxied into os-vif binding code that would enact the request. If the flag was not set / passed disabled, then nova would not request port death, and os-vif would do the same action as it does right now.</p>
<p>There are several compatibility issues to be concerned about here.</p>
<p>1. we effectively change api payload for binding extension; but because we already treat profile dict as a large box of random crap to pass around between neutron and nova, unpatched nova should already be ready to receive a dict with unknown keys.</p>
<p>2. it may be that os-vif is not patched while nova is, which would potentially lead to binding call to os-vif failing because of unknown flag passed by nova. I don&#x27;t think we can bump minimal supported os-vif version in requirements.txt, so nova will need to find a way to deal with older releases. If nothing else, we can always catch TypeError: ... expected at least X arguments, got Y error and fall back to flag-less call to os-vif (plus a warning).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">(something we discussed with Armando yesterday)

if for some reason the suggested change to os-vif to mark all new ports with dead tag is breaking other projects, we may roll it in as opt-in, where consumer passes some flag through binding profile dictionary that would instruct nova to also mark a new port as dead; then the flag would be proxied into os-vif binding code that would enact the request. If the flag was not set / passed disabled, then nova would not request port death, and os-vif would do the same action as it does right now.

There are several compatibility issues to be concerned about here.

1. we effectively change api payload for binding extension; but because we already treat profile dict as a large box of random crap to pass around between neutron and nova, unpatched nova should already be ready to receive a dict with unknown keys.

2. it may be that os-vif is not patched while nova is, which would potentially lead to binding call to os-vif failing because of unknown flag passed by nova. I don't think we can bump minimal supported os-vif version in requirements.txt, so nova will need to find a way to deal with older releases. If nothing else, we can always catch TypeError: ... expected at least X arguments, got Y error and fall back to flag-less call to os-vif (plus a warning).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-07T19:05:28.228723+00:00" title="2017-12-07 19:05:28 UTC">on 2017-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This ^ would of course imply that instead of having one/two places to patch (os-vif + maybe neutron), we will have three (neutron -&gt; nova -&gt; os-vif).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This ^ would of course imply that instead of having one/two places to patch (os-vif + maybe neutron), we will have three (neutron -&gt; nova -&gt; os-vif).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mangelajo" class="sprite person">Miguel Angel Ajo (mangelajo)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-07T21:34:55.920961+00:00" title="2017-12-07 21:34:55 UTC">on 2017-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi,</p>
<p>Thank you very much for looping me in,</p>
<p>I&#x27;m not sure if networking-ovn, or other plugins that don&#x27;t use tags+NORMAL-rules in OVS would work with the os-vif change (which as far as I undertood creates the ports right away in the dead vlan).</p>
<p>Could we also loop Numan Siddique to verify how ovn behaves in this case?, tomorrow we have a bank holiday in Spain, and I will be physically away from my computer until late.</p>
<p>The question is if the &quot;vlan tag&quot; will be just ignored based on the used OpenFlow rules, or what happens exactly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi, 

Thank you very much for looping me in,

I'm not sure if networking-ovn, or other plugins that don't use tags+NORMAL-rules in OVS would work with the os-vif change (which as far as I undertood creates the ports right away in the dead vlan).

Could we also loop Numan Siddique to verify how ovn behaves in this case?, tomorrow we have a bank holiday in Spain, and I will be physically away from my computer until late.

The question is if the "vlan tag" will be just ignored based on the used OpenFlow rules, or what happens exactly.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-08T17:29:06.572415+00:00" title="2017-12-08 17:29:06 UTC">on 2017-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Miguel: my request from comment #26 definitely applies to you as well. Please subscribe anyone you think may be able to help identify a safe solution.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Miguel: my request from comment #26 definitely applies to you as well. Please subscribe anyone you think may be able to help identify a safe solution.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mangelajo" class="sprite person">Miguel Angel Ajo (mangelajo)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-11T09:39:45.736276+00:00" title="2017-12-11 09:39:45 UTC">on 2017-12-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sorry, I didn&#x27;t know that I had permissions to add more people, I did it with numan, but I will verify now that I&#x27;m back from PTO</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sorry, I didn't know that I had permissions to add more people, I did it with numan, but I will verify now that I'm back from PTO</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mangelajo" class="sprite person">Miguel Angel Ajo (mangelajo)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-12T09:26:57.552134+00:00" title="2017-12-12 09:26:57 UTC">on 2017-12-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>[root@primary ~]# ovs-vsctl show<br />
a6b77a09-<wbr />2647-47d7-<wbr />8815-ef4d4f689c<wbr />e8<br />
&nbsp;&nbsp;&nbsp;&nbsp;Bridge br-int<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fail_mode: secure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;tap5a27427b-22&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;tap5a27427b-22&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port br-int<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface br-int<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;type: internal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;patch-<wbr />br-int-<wbr />to-provnet-<wbr />d556080a-<wbr />799f-4621-<wbr />bb2d-d4ac9b8bb3<wbr />2e&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;patch-<wbr />br-int-<wbr />to-provnet-<wbr />d556080a-<wbr />799f-4621-<wbr />bb2d-d4ac9b8bb3<wbr />2e&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;type: patch<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;options: {peer=&quot;<wbr />patch-provnet-<wbr />d556080a-<wbr />799f-4621-<wbr />bb2d-d4ac9b8bb3<wbr />2e-to-br-<wbr />int&quot;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;tapa4e1ef4d-40&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag: 4095<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;tapa4e1ef4d-40&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;tap4b56611b-99&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag: 4095<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;tap4b56611b-99&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;tap473919fe-31&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag: 4095<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;tap473919fe-31&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;Bridge br-ex<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port br-ex<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface br-ex<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;type: internal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port &quot;patch-<wbr />provnet-<wbr />d556080a-<wbr />799f-4621-<wbr />bb2d-d4ac9b8bb3<wbr />2e-to-br-<wbr />int&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interface &quot;patch-<wbr />provnet-<wbr />d556080a-<wbr />799f-4621-<wbr />bb2d-d4ac9b8bb3<wbr />2e-to-br-<wbr />int&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;type: patch<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;options: {peer=&quot;<wbr />patch-br-<wbr />int-to-<wbr />provnet-<wbr />d556080a-<wbr />799f-4621-<wbr />bb2d-d4ac9b8bb3<wbr />2e&quot;}<br />
[root@primary ~]# ip netns exec ovnmeta-<wbr />a4e1ef4d-<wbr />47ce-4b92-<wbr />8043-70d88237ef<wbr />f1 ssh cirros@10.0.0.4<br />
cirros@10.0.0.4&#x27;s password:</p>
<p>[root@primary ~]# ip netns exec ovnmeta-<wbr />a4e1ef4d-<wbr />47ce-4b92-<wbr />8043-70d88237ef<wbr />f1 ssh cirros@10.0.0.6<br />
The authenticity of host &#x27;10.0.0.6 (10.0.0.6)&#x27; can&#x27;t be established.<br />
RSA key fingerprint is SHA256:<wbr />cDLkQEB0LfxZfIv<wbr />pd084MucUa4uohU<wbr />d0COf3ArPa1A0.<br />
RSA key fingerprint is MD5:cd:<wbr />4e:f7:f5:<wbr />e1:bb:61:<wbr />ea:a7:4d:<wbr />46:f8:67:<wbr />43:20:00.<br />
Are you sure you want to continue connecting (yes/no)? yes<br />
Warning: Permanently added &#x27;10.0.0.6&#x27; (RSA) to the list of known hosts.<br />
cirros@10.0.0.6&#x27;s password:</p>
<p>[root@primary ~]# ip netns exec ovnmeta-<wbr />a4e1ef4d-<wbr />47ce-4b92-<wbr />8043-70d88237ef<wbr />f1 ssh cirros@10.0.0.8<br />
The authenticity of host &#x27;10.0.0.8 (10.0.0.8)&#x27; can&#x27;t be established.<br />
RSA key fingerprint is SHA256:<wbr />XUX8EfLF2oRJLqD<wbr />ChEEw3smHGeHm7z<wbr />cQapdpayZcb0Y.<br />
RSA key fingerprint is MD5:33:<wbr />00:41:fb:<wbr />96:25:a4:<wbr />79:b5:2e:<wbr />63:c8:03:<wbr />8f:2e:be.<br />
Are you sure you want to continue connecting (yes/no)? ^C<br />
[root@primary ~]#<br />
[root@primary ~]#</p>
<p>Sorry for the delay, I&#x27;ve verified that the solution would be fine for OVN (and I suspect that also for other openflow based solutions which don&#x27;t use the &quot;NORMAL&quot; rule).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">[root@primary ~]# ovs-vsctl show
a6b77a09-2647-47d7-8815-ef4d4f689ce8
    Bridge br-int
        fail_mode: secure
        Port "tap5a27427b-22"
            Interface "tap5a27427b-22"
        Port br-int
            Interface br-int
                type: internal
        Port "patch-br-int-to-provnet-d556080a-799f-4621-bb2d-d4ac9b8bb32e"
            Interface "patch-br-int-to-provnet-d556080a-799f-4621-bb2d-d4ac9b8bb32e"
                type: patch
                options: {peer="patch-provnet-d556080a-799f-4621-bb2d-d4ac9b8bb32e-to-br-int"}
        Port "tapa4e1ef4d-40"
            tag: 4095
            Interface "tapa4e1ef4d-40"
        Port "tap4b56611b-99"
            tag: 4095
            Interface "tap4b56611b-99"
        Port "tap473919fe-31"
            tag: 4095
            Interface "tap473919fe-31"
    Bridge br-ex
        Port br-ex
            Interface br-ex
                type: internal
        Port "patch-provnet-d556080a-799f-4621-bb2d-d4ac9b8bb32e-to-br-int"
            Interface "patch-provnet-d556080a-799f-4621-bb2d-d4ac9b8bb32e-to-br-int"
                type: patch
                options: {peer="patch-br-int-to-provnet-d556080a-799f-4621-bb2d-d4ac9b8bb32e"}
[root@primary ~]# ip netns exec ovnmeta-a4e1ef4d-47ce-4b92-8043-70d88237eff1 ssh cirros@10.0.0.4
cirros@10.0.0.4's password:

[root@primary ~]# ip netns exec ovnmeta-a4e1ef4d-47ce-4b92-8043-70d88237eff1 ssh cirros@10.0.0.6
The authenticity of host '10.0.0.6 (10.0.0.6)' can't be established.
RSA key fingerprint is SHA256:cDLkQEB0LfxZfIvpd084MucUa4uohUd0COf3ArPa1A0.
RSA key fingerprint is MD5:cd:4e:f7:f5:e1:bb:61:ea:a7:4d:46:f8:67:43:20:00.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.0.0.6' (RSA) to the list of known hosts.
cirros@10.0.0.6's password:

[root@primary ~]# ip netns exec ovnmeta-a4e1ef4d-47ce-4b92-8043-70d88237eff1 ssh cirros@10.0.0.8
The authenticity of host '10.0.0.8 (10.0.0.8)' can't be established.
RSA key fingerprint is SHA256:XUX8EfLF2oRJLqDChEEw3smHGeHm7zcQapdpayZcb0Y.
RSA key fingerprint is MD5:33:00:41:fb:96:25:a4:79:b5:2e:63:c8:03:8f:2e:be.
Are you sure you want to continue connecting (yes/no)? ^C
[root@primary ~]#
[root@primary ~]#


Sorry for the delay, I've verified that the solution would be fine for OVN (and I suspect that also for other openflow based solutions which don't use the "NORMAL" rule).



</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~minsel" class="sprite person">Miguel Lavalle (minsel)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-13T16:40:25.426822+00:00" title="2017-12-13 16:40:25 UTC">on 2017-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tocayo Miguel Ajo,</p>
<p>Thanks for the testing. Much appreciated</p>
<p>Based on this I think we can move ahead with the &quot;fixing&quot; part, which involves:</p>
<p>1) port_dead to always set dead tag on new unbound ports in Neutron<br />
2) Enforce dead tag for new ovs ports in nova / os-vif</p>
<p>What are the mechanics of creating, reviewing and merging these two patches under the embargo conditions of this CVE? I am available to work on this</p>
<p>I&#x27;ll still loop in someone from ODL to make sure they are fine with the proposed approach</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tocayo Miguel Ajo,

Thanks for the testing. Much appreciated

Based on this I think we can move ahead with the "fixing" part, which involves:

1) port_dead to always set dead tag on new unbound ports in Neutron
2) Enforce dead tag for new ovs ports in nova / os-vif

What are the mechanics of creating, reviewing and merging these two patches under the embargo conditions of this CVE? I am available to work on this

I'll still loop in someone from ODL to make sure they are fine with the proposed approach </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2017-12-13T17:11:03.428146+00:00" title="2017-12-13 17:11:03 UTC">on 2017-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>If the issue is considered widespread, easy enough to exploit and able to do a sufficient amount of damage or obtain sensitive information with some certainty, then we would want to keep this report privately embargoed while fixes are developed, attached to this bug and tested/reviewed locally by the bug&#x27;s subscribers. Once working fixes for master are identified and backports are created and attached to this bug for all supported stable branches, we will get a CVE identifier assigned, propose a disclosure schedule and provide advance notice and copies of the patches privately to downstream stakeholders.</p>
<p>If the risk from this bug is of questionable severity, we should subscribe the ossg-coresec team to get their opinion on the possibility of switching to our (simpler) public workflow for this report instead.</p>
<p>As a reminder, our process for both of these options is described here: <a rel="nofollow" href="https://security.openstack.org/vmt-process.html">https:/<wbr />/security.<wbr />openstack.<wbr />org/vmt-<wbr />process.<wbr />html</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">If the issue is considered widespread, easy enough to exploit and able to do a sufficient amount of damage or obtain sensitive information with some certainty, then we would want to keep this report privately embargoed while fixes are developed, attached to this bug and tested/reviewed locally by the bug's subscribers. Once working fixes for master are identified and backports are created and attached to this bug for all supported stable branches, we will get a CVE identifier assigned, propose a disclosure schedule and provide advance notice and copies of the patches privately to downstream stakeholders.

If the risk from this bug is of questionable severity, we should subscribe the ossg-coresec team to get their opinion on the possibility of switching to our (simpler) public workflow for this report instead.

As a reminder, our process for both of these options is described here: https://security.openstack.org/vmt-process.html</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2018-01-05T20:07:36.768144+00:00" title="2018-01-05 20:07:36 UTC">on 2018-01-05</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I tried to reach out to Matt (Nova PTL) via email, so far no luck. I think their involvement is crucial here.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I tried to reach out to Matt (Nova PTL) via email, so far no luck. I think their involvement is crucial here.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2018-01-05T20:32:39.163903+00:00" title="2018-01-05 20:32:39 UTC">on 2018-01-05</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/neutron/+bug/1734320/+attachment/5031634/+files/0001-Mark-all-dead-ports-with-dead-tag.patch">0001-Mark-all-dead-ports-with-dead-tag.patch</a>
        <a class="sprite edit action-icon" href="/neutron/+bug/1734320/+attachment/5031634">Edit</a>
        (2.7 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This is the neutron piece of the puzzle to make ovs agent mark all untagged ports as dead. I am considering adding a new functional or fullstack test for the scenario too, but posting what I have for now to start review.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This is the neutron piece of the puzzle to make ovs agent mark all untagged ports as dead. I am considering adding a new functional or fullstack test for the scenario too, but posting what I have for now to start review.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2018-01-09T21:42:32.056671+00:00" title="2018-01-09 21:42:32 UTC">on 2018-01-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/neutron/+bug/1734320/+attachment/5033809/+files/0001-Create-new-ovs-ports-with-dead-vlan-tag.patch">os-vif tagging new ovs port with dead tag</a>
        <a class="sprite edit action-icon" href="/neutron/+bug/1734320/+attachment/5033809">Edit</a>
        (2.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2018-01-09T21:47:25.394292+00:00" title="2018-01-09 21:47:25 UTC">on 2018-01-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>In nova, there is also some code in nova/network/<wbr />linux_net.<wbr />py (specifically, class LinuxOVSInterfa<wbr />ceDriver) that seems to have plug() method that calls add-port and would benefit from dead tag setting too, but I failed to find a place where this code is hooked into actual services, so I wonder if this code is not some dead end that will be cleaned up in due course after os-vif switch. I will leave it up to nova team to decide.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">In nova, there is also some code in nova/network/linux_net.py (specifically, class LinuxOVSInterfaceDriver) that seems to have plug() method that calls add-port and would benefit from dead tag setting too, but I failed to find a place where this code is hooked into actual services, so I wonder if this code is not some dead end that will be cleaned up in due course after os-vif switch. I will leave it up to nova team to decide.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
            wrote
            <time itemprop="commentTime" datetime="2018-01-09T22:00:11.977347+00:00" title="2018-01-09 22:00:11 UTC">on 2018-01-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Backporting for neutron seems simple: the patch applies cleanly to stable/ocata which is the oldest version upstream supports.</p>
<p>Since I also have an interest in earlier releases that may still be supported by Red Hat, I also checked that the patch applies with some adjustments up to liberty. As for earlier releases, they are probably not affected because they don&#x27;t include <a rel="nofollow" href="https://review.openstack.org/#/q/I5ef9665770df3a9bbaf79049b219fadd73e20309">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/q/<wbr />I5ef9665770df3a<wbr />9bbaf79049b219f<wbr />add73e20309</a> that made neutron ovs agent skip tagging ports as dead if they don&#x27;t have a tag in the first place.</p>
<p>Which makes me think that we should make sure that the CVE fix doesn&#x27;t break the assumptions that the patch I linked to above made. The concern there is, as far as I understand, is that drop flows are left on the bridge even after port is gone, which may hinder performance etal.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Backporting for neutron seems simple: the patch applies cleanly to stable/ocata which is the oldest version upstream supports.

Since I also have an interest in earlier releases that may still be supported by Red Hat, I also checked that the patch applies with some adjustments up to liberty. As for earlier releases, they are probably not affected because they don't include https://review.openstack.org/#/q/I5ef9665770df3a9bbaf79049b219fadd73e20309 that made neutron ovs agent skip tagging ports as dead if they don't have a tag in the first place.

Which makes me think that we should make sure that the CVE fix doesn't break the assumptions that the patch I linked to above made. The concern there is, as far as I understand, is that drop flows are left on the bridge even after port is gone, which may hinder performance etal.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
    
    <time title="2018-01-25 17:32:35 UTC" datetime="2018-01-25T17:32:35.706066+00:00">on 2018-01-25</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Low &#8594; High
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
    
    <time title="2018-04-27 16:41:02 UTC" datetime="2018-04-27T16:41:02.112830+00:00">on 2018-04-27</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Won&#x27;t Fix
      </td>
    </tr>
  
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
    
    <time title="2018-08-21 10:16:40 UTC" datetime="2018-08-21T10:16:40.913124+00:00">on 2018-08-21</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in os-vif: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Slawek Kaplonski (slaweq)
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
    
    <time title="2018-09-13 16:01:52 UTC" datetime="2018-09-13T16:01:52.019685+00:00">on 2018-09-13</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in os-vif: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        Slawek Kaplonski (slaweq) &#8594; sean mooney (sean-k-mooney)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
    
    <time title="2018-09-13 20:03:57 UTC" datetime="2018-09-13T20:03:57.540567+00:00">on 2018-09-13</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; sean mooney (sean-k-mooney)
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
    
    <time title="2018-11-08 16:36:33 UTC" datetime="2018-11-08T16:36:33.005448+00:00">on 2018-11-08</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; sean mooney (sean-k-mooney)
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
    
    <time title="2018-12-10 14:42:39 UTC" datetime="2018-12-10T14:42:39.803171+00:00">on 2018-12-10</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in os-vif: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          

          
              <div>
  <div id="comments-container"></div>
  <div class="boardComment comments-hidden-message" style="border-bottom: 0">
    <div class="boardCommentDetails">
      <table>
        <tbody>
          <tr>
            <td>
              <span class="sprite arrowRight"></span>
              31 comments hidden
              <span id="more-comments-spinner" class="hidden">
                Loading more comments
                <img src="/@@/spinner" />
              </span>
            </td>

            <td class="bug-comment-index">
              <a href="?comments=all" id="show-comments-link" class="show-comments-link sprite retry" style="white-space: nowrap">
                 view all 111 comments</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/72" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2018-12-14T05:40:17.489822+00:00" title="2018-12-14 05:40:17 UTC">on 2018-12-14</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/72">
                <strong>Fix merged to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/72"> #72</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/616609">https:/<wbr />/review.<wbr />openstack.<wbr />org/616609</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=e3dc447b908f57e9acc0378111b8e09cbd88ddc5">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=e3dc447b908<wbr />f57e9acc0378111<wbr />b8e09cbd88ddc5</a><br />
Submitter: Zuul<br />
Branch:    master</p>
<p>commit e3dc447b908f57e<wbr />9acc0378111b8e0<wbr />9cbd88ddc5<br />
Author: Sean Mooney &lt;email address hidden&gt;<br />
Date:   Thu Nov 8 16:07:55 2018 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;raise priority of dead vlan drop</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- This change adds a max priority flow to drop<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all traffic that is associated with the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEAD VLAN 4095.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- This change is part of a partial mitigation of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/bugs/1734320" class="bug-link">bug 1734320</a>. Without this change vlan 4095 traffic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will be dropped via a low priority flow after being<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processed by part/all of the openflow pipeline.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By raising the priorty and droping in table 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we drop invalid packets as soon as they enter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the pipeline.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I3482c7c4f00942<wbr />828cc9396cd2f3d<wbr />646c9e8c9d1<br />
&nbsp;&nbsp;&nbsp;&nbsp;Partial-Bug: #1734320</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/616609
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=e3dc447b908f57e9acc0378111b8e09cbd88ddc5
Submitter: Zuul
Branch:    master

commit e3dc447b908f57e9acc0378111b8e09cbd88ddc5
Author: Sean Mooney &lt;work@seanmooney.info&gt;
Date:   Thu Nov 8 16:07:55 2018 +0000

    raise priority of dead vlan drop
    
    - This change adds a max priority flow to drop
      all traffic that is associated with the
      DEAD VLAN 4095.
    - This change is part of a partial mitigation of
      bug 1734320. Without this change vlan 4095 traffic
      will be dropped via a low priority flow after being
      processed by part/all of the openflow pipeline.
      By raising the priorty and droping in table 0
      we drop invalid packets as soon as they enter
      the pipeline.
    
    Change-Id: I3482c7c4f00942828cc9396cd2f3d646c9e8c9d1
    Partial-Bug: #1734320
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~bcafarel" class="sprite person">Bernard Cafarelli (bcafarel)</a>
    
    <time title="2019-01-04 13:55:02 UTC" datetime="2019-01-04T13:55:02.617023+00:00">on 2019-01-04</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: neutron-proactive-backport-potential
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
    
    <time title="2019-01-04 15:12:59 UTC" datetime="2019-01-04T15:12:59.069911+00:00">on 2019-01-04</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in os-vif: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Won&#x27;t Fix
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/73" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-01-04T15:26:08.502983+00:00" title="2019-01-04 15:26:08 UTC">on 2019-01-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/73"> #73</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>hi just updating this.<br />
the os-vif fix was released in 1.13.0 but that had a file Handel leak so<br />
1.13.1 is the minium version that should be used to receive this fix.</p>
<p>the neutron change has been commited to master but not released.<br />
both the neutron and os-vif change should be backported.</p>
<p>the nova change was not required so i have set it to wont fix.</p>
<p>the code that is currently commited should be suffient to resovle the bug however there are a number of related changes that i have not written yet that would make this more robost in general.<br />
those changes will likely have to wait until Train to implement as i likely wont have time in stein.</p>
<p>the two addtional changes in neutron would be extending neutron to record the ml2 diriver that bound the port in then neutron port binding_detils and recorded in the ml2 driver send vif plug enent on port bind or on interface plug.</p>
<p>in nova i would like to modify it to pass this info to os-vif so that it can be used by the os-vif plugins to dynamically enable isolation when ml2/ovs is used.<br />
i would also like to use use the info regarding when vif plug events are sent so we can more correctly Handel them in nova.</p>
<p>none of these additional changes are required to fix this bug however the will harden the interface between nova and neutron and should help prevent related bugs from being introduced in the future.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">hi just updating this.
the os-vif fix was released in 1.13.0 but that had a file Handel leak so
1.13.1 is the minium version that should be used to receive this fix.

the neutron change has been commited to master but not released.
both the neutron and os-vif change should be backported.

the nova change was not required so i have set it to wont fix.

the code that is currently commited should be suffient to resovle the bug however there are a number of related changes that i have not written yet that would make this more robost in general.
those changes will likely have to wait until Train to implement as i likely wont have time in stein.

the two addtional changes in neutron would be extending neutron to record the ml2 diriver that bound the port in then neutron port binding_detils and recorded in the ml2 driver send vif plug enent on port bind or on interface plug.

in nova i would like to modify it to pass this info to os-vif so that it can be used by the os-vif plugins to dynamically enable isolation when ml2/ovs is used.
i would also like to use use the info regarding when vif plug events are sent so we can more correctly Handel them in nova.

none of these additional changes are required to fix this bug however the will harden the interface between nova and neutron and should help prevent related bugs from being introduced in the future.

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
    
    <time title="2019-01-16 15:39:27 UTC" datetime="2019-01-16T15:39:27.529910+00:00">on 2019-01-16</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Won&#x27;t Fix &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/74" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-02-06T01:26:11.358138+00:00" title="2019-02-06 01:26:11 UTC">on 2019-02-06</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/74">
                <strong>Related fix proposed to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/74"> #74</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Related fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.openstack.org/635083">https:/<wbr />/review.<wbr />openstack.<wbr />org/635083</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Related fix proposed to branch: master
Review: https://review.openstack.org/635083</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/75" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-03-01T04:54:26.542007+00:00" title="2019-03-01 04:54:26 UTC">on 2019-03-01</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/75">
                <strong>Fix proposed to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/75"> #75</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.openstack.org/640258">https:/<wbr />/review.<wbr />openstack.<wbr />org/640258</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: master
Review: https://review.openstack.org/640258</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/76" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-04-16T08:46:37.003209+00:00" title="2019-04-16 08:46:37 UTC">on 2019-04-16</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/76">
                <strong>Change abandoned on neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/76"> #76</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by Slawek Kaplonski (&lt;email address hidden&gt;) on branch: master<br />
Review: <a rel="nofollow" href="https://review.openstack.org/640258">https:/<wbr />/review.<wbr />openstack.<wbr />org/640258</a><br />
Reason: This review is &gt; 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a &#x27;recheck&#x27; comment to get fresh test results.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by Slawek Kaplonski (skaplons@redhat.com) on branch: master
Review: https://review.openstack.org/640258
Reason: This review is &gt; 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/77" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-05-30T17:12:58.785123+00:00" title="2019-05-30 17:12:58 UTC">on 2019-05-30</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/77">
                <strong>Change abandoned on os-vif (stable/queens)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/77"> #77</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by sean mooney (&lt;email address hidden&gt;) on branch: stable/queens<br />
Review: <a rel="nofollow" href="https://review.opendev.org/609851">https:/<wbr />/review.<wbr />opendev.<wbr />org/609851</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by sean mooney (smooney@redhat.com) on branch: stable/queens
Review: https://review.opendev.org/609851</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/78" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-05-30T17:13:12.613904+00:00" title="2019-05-30 17:13:12 UTC">on 2019-05-30</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/78">
                <strong>Change abandoned on os-vif (stable/rocky)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/78"> #78</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by sean mooney (&lt;email address hidden&gt;) on branch: stable/rocky<br />
Review: <a rel="nofollow" href="https://review.opendev.org/609850">https:/<wbr />/review.<wbr />opendev.<wbr />org/609850</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by sean mooney (smooney@redhat.com) on branch: stable/rocky
Review: https://review.opendev.org/609850</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/79" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-05-30T17:13:24.977703+00:00" title="2019-05-30 17:13:24 UTC">on 2019-05-30</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/79"> #79</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by sean mooney (&lt;email address hidden&gt;) on branch: stable/rocky<br />
Review: <a rel="nofollow" href="https://review.opendev.org/616285">https:/<wbr />/review.<wbr />opendev.<wbr />org/616285</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by sean mooney (smooney@redhat.com) on branch: stable/rocky
Review: https://review.opendev.org/616285</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/80" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-05-30T17:19:55.812291+00:00" title="2019-05-30 17:19:55 UTC">on 2019-05-30</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/80">
                <strong>Change abandoned on neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/80"> #80</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by sean mooney (&lt;email address hidden&gt;) on branch: master<br />
Review: <a rel="nofollow" href="https://review.opendev.org/635083">https:/<wbr />/review.<wbr />opendev.<wbr />org/635083</a><br />
Reason: we have changed the direction somewhat so this is not needed in it current form.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by sean mooney (smooney@redhat.com) on branch: master
Review: https://review.opendev.org/635083
Reason: we have changed the direction somewhat so this is not needed in it current form.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/81" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-03T08:03:02.208272+00:00" title="2019-10-03 08:03:02 UTC">on 2019-10-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/81">
                <strong>Fix proposed to neutron (stable/rocky)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/81"> #81</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/rocky<br />
Review: <a rel="nofollow" href="https://review.opendev.org/686345">https:/<wbr />/review.<wbr />opendev.<wbr />org/686345</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/rocky
Review: https://review.opendev.org/686345</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/82" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-03T08:15:10.210013+00:00" title="2019-10-03 08:15:10 UTC">on 2019-10-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/82">
                <strong>Fix proposed to neutron (stable/queens)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/82"> #82</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/queens<br />
Review: <a rel="nofollow" href="https://review.opendev.org/686346">https:/<wbr />/review.<wbr />opendev.<wbr />org/686346</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/queens
Review: https://review.opendev.org/686346</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/83" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-03T08:20:12.391766+00:00" title="2019-10-03 08:20:12 UTC">on 2019-10-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/83">
                <strong>Fix proposed to neutron (stable/pike)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/83"> #83</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/pike<br />
Review: <a rel="nofollow" href="https://review.opendev.org/686347">https:/<wbr />/review.<wbr />opendev.<wbr />org/686347</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/pike
Review: https://review.opendev.org/686347</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/84" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-04T15:39:54.892865+00:00" title="2019-10-04 15:39:54 UTC">on 2019-10-04</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/84">
                <strong>Fix merged to neutron (stable/rocky)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/84"> #84</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/686345">https:/<wbr />/review.<wbr />opendev.<wbr />org/686345</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=ffee956d44da34e38e62f82a3bc676cdd6179f48">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=ffee956d44d<wbr />a34e38e62f82a3b<wbr />c676cdd6179f48</a><br />
Submitter: Zuul<br />
Branch:    stable/rocky</p>
<p>commit ffee956d44da34e<wbr />38e62f82a3bc676<wbr />cdd6179f48<br />
Author: Sean Mooney &lt;email address hidden&gt;<br />
Date:   Thu Nov 8 16:07:55 2018 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;raise priority of dead vlan drop</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- This change adds a max priority flow to drop<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all traffic that is associated with the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEAD VLAN 4095.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- This change is part of a partial mitigation of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/bugs/1734320" class="bug-link">bug 1734320</a>. Without this change vlan 4095 traffic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will be dropped via a low priority flow after being<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processed by part/all of the openflow pipeline.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By raising the priorty and droping in table 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we drop invalid packets as soon as they enter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the pipeline.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I3482c7c4f00942<wbr />828cc9396cd2f3d<wbr />646c9e8c9d1<br />
&nbsp;&nbsp;&nbsp;&nbsp;Partial-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3dc447b908f57e<wbr />9acc0378111b8e0<wbr />9cbd88ddc5)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/686345
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=ffee956d44da34e38e62f82a3bc676cdd6179f48
Submitter: Zuul
Branch:    stable/rocky

commit ffee956d44da34e38e62f82a3bc676cdd6179f48
Author: Sean Mooney &lt;work@seanmooney.info&gt;
Date:   Thu Nov 8 16:07:55 2018 +0000

    raise priority of dead vlan drop
    
    - This change adds a max priority flow to drop
      all traffic that is associated with the
      DEAD VLAN 4095.
    - This change is part of a partial mitigation of
      bug 1734320. Without this change vlan 4095 traffic
      will be dropped via a low priority flow after being
      processed by part/all of the openflow pipeline.
      By raising the priorty and droping in table 0
      we drop invalid packets as soon as they enter
      the pipeline.
    
    Change-Id: I3482c7c4f00942828cc9396cd2f3d646c9e8c9d1
    Partial-Bug: #1734320
    (cherry picked from commit e3dc447b908f57e9acc0378111b8e09cbd88ddc5)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-rocky
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/85" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~obondarev" class="sprite person">Oleg Bondarev (obondarev)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-18T12:43:59.430322+00:00" title="2019-10-18 12:43:59 UTC">on 2019-10-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/85"> #85</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Should this bug be reopened for os-vif now when revert <a rel="nofollow" href="https://review.opendev.org/#/c/631829">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />631829</a> was merged?</p>
<p>@sean-k-mooney can you please share that status of this bug? Is there anything except neutron <a rel="nofollow" href="https://review.opendev.org/#/c/640258">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />640258</a> and nova <a rel="nofollow" href="https://review.opendev.org/#/c/602432/">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />602432/</a> changes pending?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Should this bug be reopened for os-vif now when revert https://review.opendev.org/#/c/631829 was merged?

@sean-k-mooney can you please share that status of this bug? Is there anything except neutron https://review.opendev.org/#/c/640258 and nova https://review.opendev.org/#/c/602432/ changes pending?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/86" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-18T13:27:15.826344+00:00" title="2019-10-18 13:27:15 UTC">on 2019-10-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/86"> #86</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>there is a mitagation for this bug in all cases except when the ovs firewall driver is used with kernel ovs.<br />
<a rel="nofollow" href="https://review.opendev.org/#/c/631829">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />631829</a> has not been reverted and there is no plans to revert it.<br />
it.</p>
<p><a rel="nofollow" href="https://review.opendev.org/#/c/612534/">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />612534/</a> was intoduced to add a config option to enable isolation.<br />
<a rel="nofollow" href="https://review.opendev.org/#/c/636061/">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />636061/</a> allows the caller of os-vif to determin if os-vif should plug the interface to the network backend.</p>
<p>the nova change uses that abilty to delegate the plugging to os-vif instead of libvirt<br />
<a rel="nofollow" href="https://review.opendev.org/#/c/602432/13/nova/network/os_vif_util.py">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />602432/<wbr />13/nova/<wbr />network/<wbr />os_vif_<wbr />util.py</a></p>
<p>but we cannot do that until the neutron change is merged  <a rel="nofollow" href="https://review.opendev.org/#/c/640258">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />640258</a></p>
<p>i am not really activly workign on either patch right now.<br />
i tried to repoduce the dvr failutre locally but in my env it seams to work fine.<br />
we know from the upstream testing that in a non dvr env this seams to work fine.<br />
if some neutron dvr folks can try and fix the dvr issue that woudl move things forward<br />
but a few neutorn review have looked and we are not sure why this is broken.</p>
<p>i think the issue is here <a rel="nofollow" href="https://review.opendev.org/#/c/640258/15/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_dvr_neutron_agent.py@404">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />640258/<wbr />15/neutron/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/ovs_<wbr />dvr_neutron_<wbr />agent.py@<wbr />404</a><br />
we are not looking at the correct field however i have not had tiem to actully debug this as i have been working on other issue.</p>
<p>so to summarize the status<br />
form an os-vif point of view i consider this bug to be fixed.<br />
the nova fix is currently blocked by dvr support in the neutron patch.</p>
<p>if you are using a configuration other than kernel ovs with the ovs firewall driver we believe this bug is fixed.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">there is a mitagation for this bug in all cases except when the ovs firewall driver is used with kernel ovs.
https://review.opendev.org/#/c/631829 has not been reverted and there is no plans to revert it.
it.

https://review.opendev.org/#/c/612534/ was intoduced to add a config option to enable isolation.
https://review.opendev.org/#/c/636061/ allows the caller of os-vif to determin if os-vif should plug the interface to the network backend.

the nova change uses that abilty to delegate the plugging to os-vif instead of libvirt
https://review.opendev.org/#/c/602432/13/nova/network/os_vif_util.py

but we cannot do that until the neutron change is merged  https://review.opendev.org/#/c/640258 

i am not really activly workign on either patch right now.
i tried to repoduce the dvr failutre locally but in my env it seams to work fine.
we know from the upstream testing that in a non dvr env this seams to work fine.
if some neutron dvr folks can try and fix the dvr issue that woudl move things forward
but a few neutorn review have looked and we are not sure why this is broken.

i think the issue is here https://review.opendev.org/#/c/640258/15/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_dvr_neutron_agent.py@404
we are not looking at the correct field however i have not had tiem to actully debug this as i have been working on other issue.

so to summarize the status
form an os-vif point of view i consider this bug to be fixed.
the nova fix is currently blocked by dvr support in the neutron patch.

if you are using a configuration other than kernel ovs with the ovs firewall driver we believe this bug is fixed.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/87" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-18T14:33:54.922658+00:00" title="2019-10-18 14:33:54 UTC">on 2019-10-18</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/87">
                <strong>Fix merged to neutron (stable/queens)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/87"> #87</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/686346">https:/<wbr />/review.<wbr />opendev.<wbr />org/686346</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=9b0919e64809729f4c0186e9be63b1082510bbb1">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=9b0919e6480<wbr />9729f4c0186e9be<wbr />63b1082510bbb1</a><br />
Submitter: Zuul<br />
Branch:    stable/queens</p>
<p>commit 9b0919e64809729<wbr />f4c0186e9be63b1<wbr />082510bbb1<br />
Author: Sean Mooney &lt;email address hidden&gt;<br />
Date:   Thu Nov 8 16:07:55 2018 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;raise priority of dead vlan drop</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- This change adds a max priority flow to drop<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all traffic that is associated with the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEAD VLAN 4095.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- This change is part of a partial mitigation of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/bugs/1734320" class="bug-link">bug 1734320</a>. Without this change vlan 4095 traffic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will be dropped via a low priority flow after being<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processed by part/all of the openflow pipeline.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By raising the priorty and droping in table 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we drop invalid packets as soon as they enter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the pipeline.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;neutron/<wbr />tests/unit/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/openflow/<wbr />native/<wbr />test_br_<wbr />int.py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I3482c7c4f00942<wbr />828cc9396cd2f3d<wbr />646c9e8c9d1<br />
&nbsp;&nbsp;&nbsp;&nbsp;Partial-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3dc447b908f57e<wbr />9acc0378111b8e0<wbr />9cbd88ddc5)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/686346
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=9b0919e64809729f4c0186e9be63b1082510bbb1
Submitter: Zuul
Branch:    stable/queens

commit 9b0919e64809729f4c0186e9be63b1082510bbb1
Author: Sean Mooney &lt;work@seanmooney.info&gt;
Date:   Thu Nov 8 16:07:55 2018 +0000

    raise priority of dead vlan drop
    
    - This change adds a max priority flow to drop
      all traffic that is associated with the
      DEAD VLAN 4095.
    - This change is part of a partial mitigation of
      bug 1734320. Without this change vlan 4095 traffic
      will be dropped via a low priority flow after being
      processed by part/all of the openflow pipeline.
      By raising the priorty and droping in table 0
      we drop invalid packets as soon as they enter
      the pipeline.
    
    Conflicts:
        neutron/tests/unit/plugins/ml2/drivers/openvswitch/agent/openflow/native/test_br_int.py
    
    Change-Id: I3482c7c4f00942828cc9396cd2f3d646c9e8c9d1
    Partial-Bug: #1734320
    (cherry picked from commit e3dc447b908f57e9acc0378111b8e09cbd88ddc5)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-queens
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/88" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-23T01:39:09.434463+00:00" title="2019-10-23 01:39:09 UTC">on 2019-10-23</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/88">
                <strong>Fix merged to neutron (stable/pike)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/88"> #88</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/686347">https:/<wbr />/review.<wbr />opendev.<wbr />org/686347</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=797a379c51a05fca356d2f2575bfc386b0287afd">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=797a379c51a<wbr />05fca356d2f2575<wbr />bfc386b0287afd</a><br />
Submitter: Zuul<br />
Branch:    stable/pike</p>
<p>commit 797a379c51a05fc<wbr />a356d2f2575bfc3<wbr />86b0287afd<br />
Author: Sean Mooney &lt;email address hidden&gt;<br />
Date:   Thu Nov 8 16:07:55 2018 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;raise priority of dead vlan drop</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- This change adds a max priority flow to drop<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all traffic that is associated with the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEAD VLAN 4095.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- This change is part of a partial mitigation of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/bugs/1734320" class="bug-link">bug 1734320</a>. Without this change vlan 4095 traffic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will be dropped via a low priority flow after being<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processed by part/all of the openflow pipeline.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By raising the priorty and droping in table 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we drop invalid packets as soon as they enter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the pipeline.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;neutron/<wbr />tests/unit/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/openflow/<wbr />native/<wbr />test_br_<wbr />int.py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I3482c7c4f00942<wbr />828cc9396cd2f3d<wbr />646c9e8c9d1<br />
&nbsp;&nbsp;&nbsp;&nbsp;Partial-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3dc447b908f57e<wbr />9acc0378111b8e0<wbr />9cbd88ddc5)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/686347
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=797a379c51a05fca356d2f2575bfc386b0287afd
Submitter: Zuul
Branch:    stable/pike

commit 797a379c51a05fca356d2f2575bfc386b0287afd
Author: Sean Mooney &lt;work@seanmooney.info&gt;
Date:   Thu Nov 8 16:07:55 2018 +0000

    raise priority of dead vlan drop
    
    - This change adds a max priority flow to drop
      all traffic that is associated with the
      DEAD VLAN 4095.
    - This change is part of a partial mitigation of
      bug 1734320. Without this change vlan 4095 traffic
      will be dropped via a low priority flow after being
      processed by part/all of the openflow pipeline.
      By raising the priorty and droping in table 0
      we drop invalid packets as soon as they enter
      the pipeline.
    
    Conflicts:
        neutron/tests/unit/plugins/ml2/drivers/openvswitch/agent/openflow/native/test_br_int.py
    
    Change-Id: I3482c7c4f00942828cc9396cd2f3d646c9e8c9d1
    Partial-Bug: #1734320
    (cherry picked from commit e3dc447b908f57e9acc0378111b8e09cbd88ddc5)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-pike
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/89" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~obondarev" class="sprite person">Oleg Bondarev (obondarev)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-24T12:41:14.155951+00:00" title="2019-10-24 12:41:14 UTC">on 2019-10-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/89"> #89</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Copying here my comment on neutron patch <a rel="nofollow" href="https://review.opendev.org/640258/">https:/<wbr />/review.<wbr />opendev.<wbr />org/640258/</a>: not sure the failures are related to DVR: it seems we only run full tempest set with dvr enabled (with OVS). Test failures are mostly about VM not becoming ACTIVE (stuck in BUILD), I guess due to neutron VM port not becoming ACTIVE. This should not be affected by DVR in any way. Also in ovs agent logs I see errors on ovs-vsctl operations with ports having ofport -1.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Copying here my comment on neutron patch https://review.opendev.org/640258/: not sure the failures are related to DVR: it seems we only run full tempest set with dvr enabled (with OVS). Test failures are mostly about VM not becoming ACTIVE (stuck in BUILD), I guess due to neutron VM port not becoming ACTIVE. This should not be affected by DVR in any way. Also in ovs agent logs I see errors on ovs-vsctl operations with ports having ofport -1.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/90" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-10-24T13:10:14.333699+00:00" title="2019-10-24 13:10:14 UTC">on 2019-10-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/90"> #90</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>yes so as i commented before<br />
the issue is here <a rel="nofollow" href="https://review.opendev.org/#/c/640258/15/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_dvr_neutron_agent.py@404">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />640258/<wbr />15/neutron/<wbr />plugins/<wbr />ml2/drivers/<wbr />openvswitch/<wbr />agent/ovs_<wbr />dvr_neutron_<wbr />agent.py@<wbr />404</a><br />
We are not reading the correct field so once we fix that we expect it to work in the dvr case.<br />
that is noted in the Gerrit review. the failures are all cased by the fact we try to read a filed that<br />
does not exist this raise an error and the port does not  become acitve. we the reach the timout on the nova side and role back the vm.</p>
<p>it is not an error for a port to have -1 on the ovs side.<br />
that is what we want to allow.<br />
a ofport id of -1 mean the port is declare in the control plane e.g.<br />
in the ovs-db but has not yet been attach to the data plane.<br />
when the tap deive is actully created in the kernel it will automaticaly be<br />
added to the ovs dataplane and a ofport id will be assigned.</p>
<p>so do be clear we expect ove to assing a port id of -1 and it may also raise a waring in the ovs-db<br />
but that is normal and the intended behavior. this is what happens with vhost-user by the way as the ofport id does not get asigned until the vm startrs and until that point it will have a ofportid of -1 not []</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">yes so as i commented before 
the issue is here https://review.opendev.org/#/c/640258/15/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_dvr_neutron_agent.py@404
We are not reading the correct field so once we fix that we expect it to work in the dvr case.
that is noted in the Gerrit review. the failures are all cased by the fact we try to read a filed that
does not exist this raise an error and the port does not  become acitve. we the reach the timout on the nova side and role back the vm.

it is not an error for a port to have -1 on the ovs side.
that is what we want to allow.
a ofport id of -1 mean the port is declare in the control plane e.g.
in the ovs-db but has not yet been attach to the data plane.
when the tap deive is actully created in the kernel it will automaticaly be
added to the ovs dataplane and a ofport id will be assigned.

so do be clear we expect ove to assing a port id of -1 and it may also raise a waring in the ovs-db
but that is normal and the intended behavior. this is what happens with vhost-user by the way as the ofport id does not get asigned until the vm startrs and until that point it will have a ofportid of -1 not []</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/91" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peereb" class="sprite person">Paul Peereboom (peereb)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-12-18T13:36:14.898344+00:00" title="2019-12-18 13:36:14 UTC">on 2019-12-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/91"> #91</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  <a href="https://bugs.launchpad.net/neutron/+bug/1734320/comments/91/+download">Download full text</a> (4.1 KiB)
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Sean,</p>
<p>I&#x27;ve finally managed to setup a Stein environment to test the isolate_vif option. I tried to set isolate_vif in nova.conf but instances than fails to spawn with the following in the nova-compute.log:</p>
<p>2019-12-18 13:32:07.180 30660 ERROR vif_plug_<wbr />ovs.ovsdb.<wbr />impl_vsctl [req-303dc31c-<wbr />3c1e-446e-<wbr />8f1e-83b604cee0<wbr />c6 68910e67a8cb49e<wbr />1af2d2bb3b4e3fa<wbr />49 d5d22a5d7e194a0<wbr />789a07a3c4d2aff<wbr />d6 - default default] Unable to e<br />
xecute [&#x27;ovs-vsctl&#x27;, &#x27;--timeout=120&#x27;, &#x27;--oneline&#x27;, &#x27;--format=json&#x27;, &#x27;--db=tcp:<wbr />127.0.0.<wbr />1:6640&#x27;<wbr />, &#x27;--&#x27;, &#x27;--may-exist&#x27;, &#x27;add-port&#x27;, &#x27;br-int&#x27;, &#x27;qvo5639e4bf-52&#x27;, &#x27;--&#x27;, &#x27;set&#x27;, &#x27;Interface&#x27;, &#x27;qvo5639e4bf-52&#x27;, &#x27;ext<br />
ernal_ids:<wbr />iface-id=<wbr />5639e4bf-<wbr />52d7-4674-<wbr />9084-e258acb47f<wbr />ae&#x27;, &#x27;external_<wbr />ids:iface-<wbr />status=<wbr />active&#x27;<wbr />, &#x27;external_<wbr />ids:attached-<wbr />mac=fa:<wbr />16:3e:d8:<wbr />ff:c8&#x27;, &#x27;external_<wbr />ids:vm-<wbr />uuid=1a6cfd1e-<wbr />7414-4ac3-<wbr />8c5d-81918a445a<wbr />b5&#x27;, &#x27;t<br />
ag=4095&#x27;]. Exception: Unexpected error while running command.<br />
Command: ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:<wbr />127.0.0.<wbr />1:6640 -- --may-exist add-port br-int qvo5639e4bf-52 -- set Interface qvo5639e4bf-52 external_<wbr />ids:iface-<wbr />id=5639e4bf-<wbr />52d7-4674-<wbr />9084<br />
-e258acb47fae external_<wbr />ids:iface-<wbr />status=<wbr />active external_<wbr />ids:attached-<wbr />mac=fa:<wbr />16:3e:d8:<wbr />ff:c8 external_<wbr />ids:vm-<wbr />uuid=1a6cfd1e-<wbr />7414-4ac3-<wbr />8c5d-81918a445a<wbr />b5 tag=4095<br />
Exit code: 1<br />
Stdout: &#x27;&#x27;<br />
Stderr: &#x27;ovs-vsctl: Interface does not contain a column whose name matches &quot;tag&quot;\n&#x27;: oslo_concurrenc<wbr />y.processutils.<wbr />ProcessExecutio<wbr />nError: Unexpected error while running command.<br />
2019-12-18 13:32:07.254 30660 INFO os_vif [req-303dc31c-<wbr />3c1e-446e-<wbr />8f1e-83b604cee0<wbr />c6 68910e67a8cb49e<wbr />1af2d2bb3b4e3fa<wbr />49 d5d22a5d7e194a0<wbr />789a07a3c4d2aff<wbr />d6 - default default] Successfully plugged vif VIFBridge(<br />
active=<wbr />False,address=<wbr />fa:16:3e:<wbr />d8:ff:c8,<wbr />bridge_<wbr />name=&#x27;qbr5639e4<wbr />bf-52&#x27;,<wbr />has_traffic_<wbr />filtering=<wbr />True,id=<wbr />5639e4bf-<wbr />52d7-4674-<wbr />9084-e258acb47f<wbr />ae,network=<wbr />Network(<wbr />c4197b2d-<wbr />f568-4bd2-<wbr />9b0a-eb0fa05e74<wbr />28),plugin=<wbr />&#x27;ovs&#x27;,po<br />
rt_profile=<wbr />VIFPortProfileO<wbr />penVSwitch,<wbr />preserve_<wbr />on_delete=<wbr />False,vif_<wbr />name=&#x27;tap5639e4<wbr />bf-52&#x27;)<br />
2019-12-18 13:32:07.275 30660 ERROR vif_plug_<wbr />ovs.ovsdb.<wbr />impl_vsctl [req-be4f125b-<wbr />e4e5-427d-<wbr />ba84-b0fb864788<wbr />07 68910e67a8cb49e<wbr />1af2d2bb3b4e3fa<wbr />49 d5d22a5d7e194a0<wbr />789a07a3c4d2aff<wbr />d6 - default default] Unable to e<br />
xecute [&#x27;ovs-vsctl&#x27;, &#x27;--timeout=120&#x27;, &#x27;--oneline&#x27;, &#x27;--format=json&#x27;, &#x27;--db=tcp:<wbr />127.0.0.<wbr />1:6640&#x27;<wbr />, &#x27;--&#x27;, &#x27;--may-exist&#x27;, &#x27;add-port&#x27;, &#x27;br-int&#x27;, &#x27;qvo8e2e0cb9-27&#x27;, &#x27;--&#x27;, &#x27;set&#x27;, &#x27;Interface&#x27;, &#x27;qvo8e2e0cb9-27&#x27;, &#x27;ext<br />
ernal_ids:<wbr />iface-id=<wbr />8e2e0cb9-<wbr />2785-4d09-<wbr />835d-f20897035c<wbr />f2&#x27;, &#x27;external_<wbr />ids:iface-<wbr />status=<wbr />active&#x27;<wbr />, &#x27;external_<wbr />ids:attached-<wbr />mac=fa:<wbr />16:3e:41:<wbr />40:43&#x27;, &#x27;external_<wbr />ids:vm-<wbr />uuid=4773263b-<wbr />d538-4e1b-<wbr />b405-7c39c96eb7<wbr />e2&#x27;, &#x27;t<br />
ag=4095&#x27;]. Exception: Unexpected error while running command.<br />
Command: ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:<wbr />127.0.0.<wbr />1:6640 -- --may-exist add-port br-int qvo8e2e0cb9-27 -- set Interface qvo8e2e0cb9-27 external_<wbr />ids:iface-<wbr />id=8e2e0cb9-<wbr />2785-4d09-<wbr />835d<br />
-f20897035cf2 external_<wbr />ids:iface-<wbr />status=<wbr />active external_<wbr />ids:attached-<wbr />mac=fa:<wbr />16:3e:41:<wbr />40:43 external_<wbr />ids:vm-<wbr />uuid=4773263b-<wbr />d538-4e1b-<wbr />b405-7c39c96eb7<wbr />e2 tag=4095<br />
Exit code: 1<br />
Stdout: &#x27;&#x27;<br />
Stderr: &#x27;ovs-vsctl: Interface does not contain a column whose name matches &quot;tag&quot;\n&#x27;: oslo_concurrenc<wbr />y.processutils.<wbr />ProcessExecutio<wbr />nError: Unexpected error while running command.</p>
<p>Open...</p></div>
    
    <p>
      <a href="/neutron/+bug/1734320/comments/91">Read more...</a>
    </p>
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Sean,

I've finally managed to setup a Stein environment to test the isolate_vif option. I tried to set isolate_vif in nova.conf but instances than fails to spawn with the following in the nova-compute.log:

2019-12-18 13:32:07.180 30660 ERROR vif_plug_ovs.ovsdb.impl_vsctl [req-303dc31c-3c1e-446e-8f1e-83b604cee0c6 68910e67a8cb49e1af2d2bb3b4e3fa49 d5d22a5d7e194a0789a07a3c4d2affd6 - default default] Unable to e
xecute ['ovs-vsctl', '--timeout=120', '--oneline', '--format=json', '--db=tcp:127.0.0.1:6640', '--', '--may-exist', 'add-port', 'br-int', 'qvo5639e4bf-52', '--', 'set', 'Interface', 'qvo5639e4bf-52', 'ext
ernal_ids:iface-id=5639e4bf-52d7-4674-9084-e258acb47fae', 'external_ids:iface-status=active', 'external_ids:attached-mac=fa:16:3e:d8:ff:c8', 'external_ids:vm-uuid=1a6cfd1e-7414-4ac3-8c5d-81918a445ab5', 't
ag=4095']. Exception: Unexpected error while running command.
Command: ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:127.0.0.1:6640 -- --may-exist add-port br-int qvo5639e4bf-52 -- set Interface qvo5639e4bf-52 external_ids:iface-id=5639e4bf-52d7-4674-9084
-e258acb47fae external_ids:iface-status=active external_ids:attached-mac=fa:16:3e:d8:ff:c8 external_ids:vm-uuid=1a6cfd1e-7414-4ac3-8c5d-81918a445ab5 tag=4095
Exit code: 1
Stdout: ''
Stderr: 'ovs-vsctl: Interface does not contain a column whose name matches "tag"\n': oslo_concurrency.processutils.ProcessExecutionError: Unexpected error while running command.
2019-12-18 13:32:07.254 30660 INFO os_vif [req-303dc31c-3c1e-446e-8f1e-83b604cee0c6 68910e67a8cb49e1af2d2bb3b4e3fa49 d5d22a5d7e194a0789a07a3c4d2affd6 - default default] Successfully plugged vif VIFBridge(
active=False,address=fa:16:3e:d8:ff:c8,bridge_name='qbr5639e4bf-52',has_traffic_filtering=True,id=5639e4bf-52d7-4674-9084-e258acb47fae,network=Network(c4197b2d-f568-4bd2-9b0a-eb0fa05e7428),plugin='ovs',po
rt_profile=VIFPortProfileOpenVSwitch,preserve_on_delete=False,vif_name='tap5639e4bf-52')
2019-12-18 13:32:07.275 30660 ERROR vif_plug_ovs.ovsdb.impl_vsctl [req-be4f125b-e4e5-427d-ba84-b0fb86478807 68910e67a8cb49e1af2d2bb3b4e3fa49 d5d22a5d7e194a0789a07a3c4d2affd6 - default default] Unable to e
xecute ['ovs-vsctl', '--timeout=120', '--oneline', '--format=json', '--db=tcp:127.0.0.1:6640', '--', '--may-exist', 'add-port', 'br-int', 'qvo8e2e0cb9-27', '--', 'set', 'Interface', 'qvo8e2e0cb9-27', 'ext
ernal_ids:iface-id=8e2e0cb9-2785-4d09-835d-f20897035cf2', 'external_ids:iface-status=active', 'external_ids:attached-mac=fa:16:3e:41:40:43', 'external_ids:vm-uuid=4773263b-d538-4e1b-b405-7c39c96eb7e2', 't
ag=4095']. Exception: Unexpected error while running command.
Command: ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:127.0.0.1:6640 -- --may-exist add-port br-int qvo8e2e0cb9-27 -- set Interface qvo8e2e0cb9-27 external_ids:iface-id=8e2e0cb9-2785-4d09-835d
-f20897035cf2 external_ids:iface-status=active external_ids:attached-mac=fa:16:3e:41:40:43 external_ids:vm-uuid=4773263b-d538-4e1b-b405-7c39c96eb7e2 tag=4095
Exit code: 1
Stdout: ''
Stderr: 'ovs-vsctl: Interface does not contain a column whose name matches "tag"\n': oslo_concurrency.processutils.ProcessExecutionError: Unexpected error while running command.


Openstack version: Stein


[root@compute1 (GN0) ~]# ovs-vsctl -V
ovs-vsctl (Open vSwitch) 2.11.0
DB Schema 7.16.1

[root@compute1 (GN0) ~]# rpm -qa | grep neutron
openstack-neutron-common-14.0.3-0.20190923200444.5eb234b.el8ost.noarch
openstack-neutron-openvswitch-14.0.3-0.20190923200444.5eb234b.el8ost.noarch
python3-neutron-lib-1.25.0-0.20190521130309.fc2a810.el8ost.noarch
python3-neutronclient-6.12.0-0.20190312100012.680b417.el8ost.noarch
openstack-neutron-14.0.3-0.20190923200444.5eb234b.el8ost.noarch
python3-neutron-14.0.3-0.20190923200444.5eb234b.el8ost.noarch
openstack-neutron-ml2-14.0.3-0.20190923200444.5eb234b.el8ost.noarch

[root@compute1 (GN0) ~]# rpm -qa | grep nova
python3-novaclient-13.0.1-0.20190710173535.ef842ca.el8ost.noarch
python3-nova-19.0.3-0.20190814170534.a8e19af.el8ost.noarch
openstack-nova-common-19.0.3-0.20190814170534.a8e19af.el8ost.noarch
openstack-nova-compute-19.0.3-0.20190814170534.a8e19af.el8ost.noarch


Do I miss something?


Regards,
Paul
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/92" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~peereb" class="sprite person">Paul Peereboom (peereb)</a>
            wrote
            <time itemprop="commentTime" datetime="2019-12-18T13:57:17.948668+00:00" title="2019-12-18 13:57:17 UTC">on 2019-12-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/92"> #92</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Aha think I got it, looks like the tag order is wrong:</p>
<p>Fails:<br />
ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:<wbr />127.0.0.<wbr />1:6640 -- --may-exist add-port br-int qvo8e2e0cb9-27 -- set Interface qvoc94a40f4-a3 external_<wbr />ids:iface-<wbr />id=8e2e0cb9-<wbr />2785-4d09-<wbr />835d-f20897035c<wbr />f2 external_<wbr />ids:iface-<wbr />status=<wbr />active external_<wbr />ids:attached-<wbr />mac=fa:<wbr />16:3e:41:<wbr />40:43 external_<wbr />ids:vm-<wbr />uuid=4773263b-<wbr />d538-4e1b-<wbr />b405-7c39c96eb7<wbr />e2 tag=4095</p>
<p>Works:<br />
ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:<wbr />127.0.0.<wbr />1:6640 -- --may-exist add-port br-int qvo8e2e0cb9-27 tag=4095 -- set Interface qvoc94a40f4-a3 external_<wbr />ids:iface-<wbr />id=8e2e0cb9-<wbr />2785-4d09-<wbr />835d-f20897035c<wbr />f2 external_<wbr />ids:iface-<wbr />status=<wbr />active external_<wbr />ids:attached-<wbr />mac=fa:<wbr />16:3e:41:<wbr />40:43 external_<wbr />ids:vm-<wbr />uuid=4773263b-<wbr />d538-4e1b-<wbr />b405-7c39c96eb7<wbr />e2</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Aha think I got it, looks like the tag order is wrong:

Fails:
ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:127.0.0.1:6640 -- --may-exist add-port br-int qvo8e2e0cb9-27 -- set Interface qvoc94a40f4-a3 external_ids:iface-id=8e2e0cb9-2785-4d09-835d-f20897035cf2 external_ids:iface-status=active external_ids:attached-mac=fa:16:3e:41:40:43 external_ids:vm-uuid=4773263b-d538-4e1b-b405-7c39c96eb7e2 tag=4095

Works:
ovs-vsctl --timeout=120 --oneline --format=json --db=tcp:127.0.0.1:6640 -- --may-exist add-port br-int qvo8e2e0cb9-27 tag=4095 -- set Interface qvoc94a40f4-a3 external_ids:iface-id=8e2e0cb9-2785-4d09-835d-f20897035cf2 external_ids:iface-status=active external_ids:attached-mac=fa:16:3e:41:40:43 external_ids:vm-uuid=4773263b-d538-4e1b-b405-7c39c96eb7e2</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~bcafarel" class="sprite person">Bernard Cafarelli (bcafarel)</a>
    
    <time title="2020-01-14 11:34:01 UTC" datetime="2020-01-14T11:34:01.011063+00:00">on 2020-01-14</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        removed: neutron-proactive-backport-potential
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~l7kx" class="sprite person">ABDULLAH (l7kx)</a>
    
    <time title="2020-08-03 22:44:29 UTC" datetime="2020-08-03T22:44:29.101332+00:00">on 2020-08-03</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; New
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in nova: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Released
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
    
    <time title="2020-08-04 12:39:47 UTC" datetime="2020-08-04T12:39:47.619781+00:00">on 2020-08-04</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        sean mooney (sean-k-mooney) &#8594; Rodolfo Alonso (rodolfo-alonso-hernandez)
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/93" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-08-25T15:38:56.505306+00:00" title="2020-08-25 15:38:56 UTC">on 2020-08-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/93">
                <strong>Fix merged to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/93"> #93</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/640258">https:/<wbr />/review.<wbr />opendev.<wbr />org/640258</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=7fd2725cb14b81f442eb57a38755829270ff2c43">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=7fd2725cb14<wbr />b81f442eb57a387<wbr />55829270ff2c43</a><br />
Submitter: Zuul<br />
Branch:    master</p>
<p>commit 7fd2725cb14b81f<wbr />442eb57a3875582<wbr />9270ff2c43<br />
Author: Sean Mooney &lt;email address hidden&gt;<br />
Date:   Fri Mar 1 04:43:20 2019 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Do not skip ports with ofport unset or invalid</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This change removes the &quot;_check_ofport&quot; function and its use form<br />
&nbsp;&nbsp;&nbsp;&nbsp;the ovs_lib.py file.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;By skipping ports without a unique ofport in the &quot;get_vifs_by_ids&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;and &quot;get_vifs_by_id&quot; functions, the OVS agent incorrectly treated<br />
&nbsp;&nbsp;&nbsp;&nbsp;newly added port with an ofport of -1 as removed ports in the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&quot;treat_<wbr />devices_<wbr />added_or_<wbr />updated&quot; function.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Co-Authored-By: Rodolfo Alonso Hernandez &lt;email address hidden&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I79158baafbb99b<wbr />ee99a1d68703931<wbr />3eb454d3a9b<br />
&nbsp;&nbsp;&nbsp;&nbsp;Partial-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;Partial-Bug: #1815989</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/640258
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=7fd2725cb14b81f442eb57a38755829270ff2c43
Submitter: Zuul
Branch:    master

commit 7fd2725cb14b81f442eb57a38755829270ff2c43
Author: Sean Mooney &lt;work@seanmooney.info&gt;
Date:   Fri Mar 1 04:43:20 2019 +0000

    Do not skip ports with ofport unset or invalid
    
    This change removes the "_check_ofport" function and its use form
    the ovs_lib.py file.
    
    By skipping ports without a unique ofport in the "get_vifs_by_ids"
    and "get_vifs_by_id" functions, the OVS agent incorrectly treated
    newly added port with an ofport of -1 as removed ports in the
    "treat_devices_added_or_updated" function.
    
    Co-Authored-By: Rodolfo Alonso Hernandez &lt;ralonsoh@redhat.com&gt;
    
    Change-Id: I79158baafbb99bee99a1d687039313eb454d3a9b
    Partial-Bug: #1734320
    Partial-Bug: #1815989
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/94" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-08-26T20:01:05.119677+00:00" title="2020-08-26 20:01:05 UTC">on 2020-08-26</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/94">
                <strong>Related fix proposed to nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/94"> #94</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Related fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.opendev.org/748296">https:/<wbr />/review.<wbr />opendev.<wbr />org/748296</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Related fix proposed to branch: master
Review: https://review.opendev.org/748296</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~bcafarel" class="sprite person">Bernard Cafarelli (bcafarel)</a>
    
    <time title="2020-09-04 12:52:17 UTC" datetime="2020-09-04T12:52:17.122488+00:00">on 2020-09-04</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: neutron-proactive-backport-potential
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/95" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-09-04T13:27:16.675018+00:00" title="2020-09-04 13:27:16 UTC">on 2020-09-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/95"> #95</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>by the way while the neutron patch is now merged the nova patch to delegate the pluggin to os-vif is blocked as the neutron api seams to be sending network-vif-plugged events at the wrong time when we are evacuating nad during some other lifecycle operations like revert. so untill we figure out that the backport fo the most resent neturon patch will do nothing help adress this.</p>
<p>the way nova is using neutron has not changed so libvirt will still delete the port on ovs and recreated it defeating the work that has been done to validate the netowrking is set up before we migrate.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">by the way while the neutron patch is now merged the nova patch to delegate the pluggin to os-vif is blocked as the neutron api seams to be sending network-vif-plugged events at the wrong time when we are evacuating nad during some other lifecycle operations like revert. so untill we figure out that the backport fo the most resent neturon patch will do nothing help adress this.

the way nova is using neutron has not changed so libvirt will still delete the port on ovs and recreated it defeating the work that has been done to validate the netowrking is set up before we migrate.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/96" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sean-k-mooney" class="sprite person">sean mooney (sean-k-mooney)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-09-04T13:28:55.492093+00:00" title="2020-09-04 13:28:55 UTC">on 2020-09-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/96"> #96</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>with that said it is safe to backport the neutron patch that recnetly merged and it will have to be backported before the nova patch is but we were recommending waiting for the nova patch and any other neutron patche that might be required to merge first before starting the backports<br />
we only want to backport a fully working solution</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">with that said it is safe to backport the neutron patch that recnetly merged and it will have to be backported before the nova patch is but we were recommending waiting for the nova patch and any other neutron patche that might be required to merge first before starting the backports
we only want to backport a fully working solution</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/97" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-09-08T10:56:33.530060+00:00" title="2020-09-08 10:56:33 UTC">on 2020-09-08</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/97">
                <strong>Change abandoned on nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/97"> #97</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by sean mooney (&lt;email address hidden&gt;) on branch: master<br />
Review: <a rel="nofollow" href="https://review.opendev.org/748296">https:/<wbr />/review.<wbr />opendev.<wbr />org/748296</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by sean mooney (smooney@redhat.com) on branch: master
Review: https://review.opendev.org/748296</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/98" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-09-25T19:29:24.185033+00:00" title="2020-09-25 19:29:24 UTC">on 2020-09-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/98">
                <strong>Fix proposed to neutron (stable/ussuri)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/98"> #98</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/ussuri<br />
Review: <a rel="nofollow" href="https://review.opendev.org/754475">https:/<wbr />/review.<wbr />opendev.<wbr />org/754475</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/ussuri
Review: https://review.opendev.org/754475</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/99" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-06T23:01:30.719377+00:00" title="2020-10-06 23:01:30 UTC">on 2020-10-06</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/99">
                <strong>Related fix merged to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/99"> #99</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/753314">https:/<wbr />/review.<wbr />opendev.<wbr />org/753314</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=c8a819aff4db62e58192af0a272a7f1ce7923146">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=c8a819aff4d<wbr />b62e58192af0a27<wbr />2a7f1ce7923146</a><br />
Submitter: Zuul<br />
Branch:    master</p>
<p>commit c8a819aff4db62e<wbr />58192af0a272a7f<wbr />1ce7923146<br />
Author: Rodolfo Alonso Hernandez &lt;email address hidden&gt;<br />
Date:   Thu Sep 24 09:44:47 2020 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Filter out port with invalid ofport in OVS firewall</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since [1], &quot;get_vif_<wbr />port_by_<wbr />id&quot; is also returning ports with an<br />
&nbsp;&nbsp;&nbsp;&nbsp;invalid ofport. OVS firewall cannot set an OpenFlow rule for a port<br />
&nbsp;&nbsp;&nbsp;&nbsp;without a valid ofport. &quot;get_ovs_port&quot; should filter out those ports.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1815989<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1734320</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1]<a rel="nofollow" href="https://review.opendev.org/#/c/640258/">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />640258/</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Id12486b3127ab4<wbr />ac8ad9ef2b3641d<wbr />a1b79a25a50</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/753314
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=c8a819aff4db62e58192af0a272a7f1ce7923146
Submitter: Zuul
Branch:    master

commit c8a819aff4db62e58192af0a272a7f1ce7923146
Author: Rodolfo Alonso Hernandez &lt;ralonsoh@redhat.com&gt;
Date:   Thu Sep 24 09:44:47 2020 +0000

    Filter out port with invalid ofport in OVS firewall
    
    Since [1], "get_vif_port_by_id" is also returning ports with an
    invalid ofport. OVS firewall cannot set an OpenFlow rule for a port
    without a valid ofport. "get_ovs_port" should filter out those ports.
    
    Related-Bug: #1815989
    Related-Bug: #1734320
    
    [1]https://review.opendev.org/#/c/640258/
    
    Change-Id: Id12486b3127ab4ac8ad9ef2b3641da1b79a25a50
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/100" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-07T09:51:48.232271+00:00" title="2020-10-07 09:51:48 UTC">on 2020-10-07</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/100">
                <strong>Related fix proposed to neutron (stable/victoria)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/100"> #100</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Related fix proposed to branch: stable/victoria<br />
Review: <a rel="nofollow" href="https://review.opendev.org/756478">https:/<wbr />/review.<wbr />opendev.<wbr />org/756478</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Related fix proposed to branch: stable/victoria
Review: https://review.opendev.org/756478</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/101" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-23T01:22:42.731598+00:00" title="2020-10-23 01:22:42 UTC">on 2020-10-23</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/101">
                <strong>Related fix merged to neutron (stable/victoria)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/101"> #101</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/756478">https:/<wbr />/review.<wbr />opendev.<wbr />org/756478</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=24dd977c2217bb10baf2cf226eab2bd0e5b47d62">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=24dd977c221<wbr />7bb10baf2cf226e<wbr />ab2bd0e5b47d62</a><br />
Submitter: Zuul<br />
Branch:    stable/victoria</p>
<p>commit 24dd977c2217bb1<wbr />0baf2cf226eab2b<wbr />d0e5b47d62<br />
Author: Rodolfo Alonso Hernandez &lt;email address hidden&gt;<br />
Date:   Thu Sep 24 09:44:47 2020 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Filter out port with invalid ofport in OVS firewall</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since [1], &quot;get_vif_<wbr />port_by_<wbr />id&quot; is also returning ports with an<br />
&nbsp;&nbsp;&nbsp;&nbsp;invalid ofport. OVS firewall cannot set an OpenFlow rule for a port<br />
&nbsp;&nbsp;&nbsp;&nbsp;without a valid ofport. &quot;get_ovs_port&quot; should filter out those ports.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1815989<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1734320</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1]<a rel="nofollow" href="https://review.opendev.org/#/c/640258/">https:/<wbr />/review.<wbr />opendev.<wbr />org/#/c/<wbr />640258/</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Id12486b3127ab4<wbr />ac8ad9ef2b3641d<wbr />a1b79a25a50<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit c8a819aff4db62e<wbr />58192af0a272a7f<wbr />1ce7923146)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/756478
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=24dd977c2217bb10baf2cf226eab2bd0e5b47d62
Submitter: Zuul
Branch:    stable/victoria

commit 24dd977c2217bb10baf2cf226eab2bd0e5b47d62
Author: Rodolfo Alonso Hernandez &lt;ralonsoh@redhat.com&gt;
Date:   Thu Sep 24 09:44:47 2020 +0000

    Filter out port with invalid ofport in OVS firewall
    
    Since [1], "get_vif_port_by_id" is also returning ports with an
    invalid ofport. OVS firewall cannot set an OpenFlow rule for a port
    without a valid ofport. "get_ovs_port" should filter out those ports.
    
    Related-Bug: #1815989
    Related-Bug: #1734320
    
    [1]https://review.opendev.org/#/c/640258/
    
    Change-Id: Id12486b3127ab4ac8ad9ef2b3641da1b79a25a50
    (cherry picked from commit c8a819aff4db62e58192af0a272a7f1ce7923146)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-victoria
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~slaweq" class="sprite person">Slawek Kaplonski (slaweq)</a>
    
    <time title="2020-12-11 11:15:06 UTC" datetime="2020-12-11T11:15:06.213403+00:00">on 2020-12-11</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/102" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-05-01T04:07:04.548587+00:00" title="2021-05-01 04:07:04 UTC">on 2021-05-01</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/102">
                <strong>Fix merged to nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/102"> #102</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/602432">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/602432</a><br />
Committed: <a rel="nofollow" href="https://opendev.org/openstack/nova/commit/a62dd42c0dbb6b2ab128e558e127d76962738446">https:/<wbr />/opendev.<wbr />org/openstack/<wbr />nova/commit/<wbr />a62dd42c0dbb6b2<wbr />ab128e558e127d7<wbr />6962738446</a><br />
Submitter: &quot;Zuul (22348)&quot;<br />
Branch:    master</p>
<p>commit a62dd42c0dbb6b2<wbr />ab128e558e127d7<wbr />6962738446<br />
Author: Stephen Finucane &lt;email address hidden&gt;<br />
Date:   Fri Apr 30 12:51:35 2021 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;libvirt: Delegate OVS plug to os-vif</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;os-vif 1.15.0 added the ability to create an OVS port during plugging<br />
&nbsp;&nbsp;&nbsp;&nbsp;by specifying the &#x27;create_port&#x27; attribute in the &#x27;port_profile&#x27; field.<br />
&nbsp;&nbsp;&nbsp;&nbsp;By delegating port creation to os-vif, we can rely on it&#x27;s &#x27;isolate_vif&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;config option [1] that will temporarily configure the VLAN to 4095<br />
&nbsp;&nbsp;&nbsp;&nbsp;(0xfff), which is reserved for implementation use [2] and is used by<br />
&nbsp;&nbsp;&nbsp;&nbsp;neutron to as a dead VLAN [3]. By doing this, we ensure VIFs are plugged<br />
&nbsp;&nbsp;&nbsp;&nbsp;securely, preventing guests from accessing other tenants&#x27; networks<br />
&nbsp;&nbsp;&nbsp;&nbsp;before the neutron OVS agent can wire up the port.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This change requires a little dance as part of the live migration flow.<br />
&nbsp;&nbsp;&nbsp;&nbsp;Since we can&#x27;t be certain the destination host has a version of os-vif<br />
&nbsp;&nbsp;&nbsp;&nbsp;that supports this feature, we need to use a sentinel to indicate when<br />
&nbsp;&nbsp;&nbsp;&nbsp;it does. Typically we would do so with a field in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;LibvirtLiv<wbr />eMigrateData&#x27;<wbr />, such as the &#x27;src_supports_<wbr />numa_live_<wbr />migration&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;and &#x27;dst_supports_<wbr />numa_live_<wbr />migration&#x27; fields used to indicate support<br />
&nbsp;&nbsp;&nbsp;&nbsp;for NUMA-aware live migration. However, doing this prevents us<br />
&nbsp;&nbsp;&nbsp;&nbsp;backporting this important fix since o.vo changes are not backportable.<br />
&nbsp;&nbsp;&nbsp;&nbsp;Instead, we (somewhat evilly) rely on the free-form nature of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;VIFMigrate<wbr />Data.profile_<wbr />json&#x27; string field, which stores JSON blobs and<br />
&nbsp;&nbsp;&nbsp;&nbsp;is included in &#x27;LibvirtLiveMig<wbr />rateData&#x27; via the &#x27;vifs&#x27; attribute, to<br />
&nbsp;&nbsp;&nbsp;&nbsp;transport this sentinel. This is a hack but is necessary to work around<br />
&nbsp;&nbsp;&nbsp;&nbsp;the lack of a free-form &quot;capabilities&quot; style dict that would allow us do<br />
&nbsp;&nbsp;&nbsp;&nbsp;backportable fixes to live migration features.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Note that this change has the knock on effect of modifying the XML<br />
&nbsp;&nbsp;&nbsp;&nbsp;generated for OVS ports: when hybrid plug is false will now be of type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;ethernet&#x27; rather than &#x27;bridge&#x27; as before. This explains the larger than<br />
&nbsp;&nbsp;&nbsp;&nbsp;expected test damage but should not affect users.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://opendev.org/openstack/os-vif/src/tag/2.4.0/vif_plug_ovs/ovs.py#L90-L93">https:/<wbr />/opendev.<wbr />org/openstack/<wbr />os-vif/<wbr />src/tag/<wbr />2.4.0/vif_<wbr />plug_ovs/<wbr />ovs.py#<wbr />L90-L93</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://en.wikipedia.org/wiki/IEEE_802.1Q#Frame_format">https:/<wbr />/en.wikipedia.<wbr />org/wiki/<wbr />IEEE_802.<wbr />1Q#Frame_<wbr />format</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[3] <a rel="nofollow" href="https://answers.launchpad.net/neutron/+question/231806">https:/<wbr />/answers.<wbr />launchpad.<wbr />net/neutron/<wbr />+question/<wbr />231806</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I11fb5d3ada7f27<wbr />b39c183157ea73c<wbr />8b72b4e672e<br />
&nbsp;&nbsp;&nbsp;&nbsp;Depends-On: Id12486b3127ab4<wbr />ac8ad9ef2b3641d<wbr />a1b79a25a50<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: #1815989</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/c/openstack/nova/+/602432
Committed: https://opendev.org/openstack/nova/commit/a62dd42c0dbb6b2ab128e558e127d76962738446
Submitter: "Zuul (22348)"
Branch:    master

commit a62dd42c0dbb6b2ab128e558e127d76962738446
Author: Stephen Finucane &lt;stephenfin@redhat.com&gt;
Date:   Fri Apr 30 12:51:35 2021 +0100

    libvirt: Delegate OVS plug to os-vif
    
    os-vif 1.15.0 added the ability to create an OVS port during plugging
    by specifying the 'create_port' attribute in the 'port_profile' field.
    By delegating port creation to os-vif, we can rely on it's 'isolate_vif'
    config option [1] that will temporarily configure the VLAN to 4095
    (0xfff), which is reserved for implementation use [2] and is used by
    neutron to as a dead VLAN [3]. By doing this, we ensure VIFs are plugged
    securely, preventing guests from accessing other tenants' networks
    before the neutron OVS agent can wire up the port.
    
    This change requires a little dance as part of the live migration flow.
    Since we can't be certain the destination host has a version of os-vif
    that supports this feature, we need to use a sentinel to indicate when
    it does. Typically we would do so with a field in
    'LibvirtLiveMigrateData', such as the 'src_supports_numa_live_migration'
    and 'dst_supports_numa_live_migration' fields used to indicate support
    for NUMA-aware live migration. However, doing this prevents us
    backporting this important fix since o.vo changes are not backportable.
    Instead, we (somewhat evilly) rely on the free-form nature of the
    'VIFMigrateData.profile_json' string field, which stores JSON blobs and
    is included in 'LibvirtLiveMigrateData' via the 'vifs' attribute, to
    transport this sentinel. This is a hack but is necessary to work around
    the lack of a free-form "capabilities" style dict that would allow us do
    backportable fixes to live migration features.
    
    Note that this change has the knock on effect of modifying the XML
    generated for OVS ports: when hybrid plug is false will now be of type
    'ethernet' rather than 'bridge' as before. This explains the larger than
    expected test damage but should not affect users.
    
    [1] https://opendev.org/openstack/os-vif/src/tag/2.4.0/vif_plug_ovs/ovs.py#L90-L93
    [2] https://en.wikipedia.org/wiki/IEEE_802.1Q#Frame_format
    [3] https://answers.launchpad.net/neutron/+question/231806
    
    Change-Id: I11fb5d3ada7f27b39c183157ea73c8b72b4e672e
    Depends-On: Id12486b3127ab4ac8ad9ef2b3641da1b79a25a50
    Closes-Bug: #1734320
    Closes-Bug: #1815989
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/103" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-05-10T17:25:43.847929+00:00" title="2021-05-10 17:25:43 UTC">on 2021-05-10</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/103">
                <strong>Fix proposed to nova (stable/wallaby)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/103"> #103</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/wallaby<br />
Review: <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/790447">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/790447</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/wallaby
Review: https://review.opendev.org/c/openstack/nova/+/790447</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/104" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-06-18T17:15:59.023579+00:00" title="2021-06-18 17:15:59 UTC">on 2021-06-18</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/104">
                <strong>Related fix proposed to nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/104"> #104</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Related fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797142">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797142</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Related fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/nova/+/797142</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/105" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-06-18T17:39:04.986951+00:00" title="2021-06-18 17:39:04 UTC">on 2021-06-18</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/105">
                <strong>Fix proposed to nova (stable/victoria)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/105"> #105</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/victoria<br />
Review: <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797144">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797144</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/victoria
Review: https://review.opendev.org/c/openstack/nova/+/797144</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/106" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-06-21T13:09:10.835289+00:00" title="2021-06-21 13:09:10 UTC">on 2021-06-21</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/106">
                <strong>Fix proposed to nova (stable/ussuri)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/106"> #106</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/ussuri<br />
Review: <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797291">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797291</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/ussuri
Review: https://review.opendev.org/c/openstack/nova/+/797291</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/107" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-06-21T14:11:49.540983+00:00" title="2021-06-21 14:11:49 UTC">on 2021-06-21</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/107">
                <strong>Fix proposed to nova (stable/train)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/107"> #107</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/train<br />
Review: <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797316">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797316</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/train
Review: https://review.opendev.org/c/openstack/nova/+/797316</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/108" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-06-22T11:19:08.218842+00:00" title="2021-06-22 11:19:08 UTC">on 2021-06-22</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/108">
                <strong>Related fix proposed to nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/108"> #108</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Related fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797428">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797428</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Related fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/nova/+/797428</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/109" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-07-25T04:11:04.204347+00:00" title="2021-07-25 04:11:04 UTC">on 2021-07-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/109">
                <strong>Related fix merged to nova (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/109"> #109</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797142">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797142</a><br />
Committed: <a rel="nofollow" href="https://opendev.org/openstack/nova/commit/99cf5292c782828ea33a3448ae0e7da028d5d176">https:/<wbr />/opendev.<wbr />org/openstack/<wbr />nova/commit/<wbr />99cf5292c782828<wbr />ea33a3448ae0e7d<wbr />a028d5d176</a><br />
Submitter: &quot;Zuul (22348)&quot;<br />
Branch:    master</p>
<p>commit 99cf5292c782828<wbr />ea33a3448ae0e7d<wbr />a028d5d176<br />
Author: Stephen Finucane &lt;email address hidden&gt;<br />
Date:   Fri Jun 18 17:55:50 2021 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;objects: Fix VIFMigrateData.<wbr />supports_<wbr />os_vif_<wbr />delegation setter</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;We&#x27;re using a &#x27;profile&#x27; getter/setter in the &#x27;VIFMigrateData&#x27; object to<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensure we transform the JSON encoded string we store in the database to<br />
&nbsp;&nbsp;&nbsp;&nbsp;an actual dictionary on load and vice versa on save. However, because<br />
&nbsp;&nbsp;&nbsp;&nbsp;the getter is returning a new object (constructed from &#x27;json.loads&#x27;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;rather than a reference to the original data (which is a string),<br />
&nbsp;&nbsp;&nbsp;&nbsp;modifying this object doesn&#x27;t actually change the underlying data in the<br />
&nbsp;&nbsp;&nbsp;&nbsp;object. We were relying on this broken behavior to set the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;supports_<wbr />os_vif_<wbr />delegation&#x27; attribute of the &#x27;VIFMigrateData&#x27; object<br />
&nbsp;&nbsp;&nbsp;&nbsp;and trigger the delegated port creation introduced in change<br />
&nbsp;&nbsp;&nbsp;&nbsp;I11fb5d3ada<wbr />7f27b39c183157e<wbr />a73c8b72b4e672e<wbr />, which means that code isn&#x27;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;actually doing anything yet. Resolve this.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I362deb1088c88c<wbr />dcd8219922da9dc<wbr />9a01b10a940<br />
&nbsp;&nbsp;&nbsp;&nbsp;Signed-off-by: Stephen Finucane &lt;email address hidden&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1815989</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/c/openstack/nova/+/797142
Committed: https://opendev.org/openstack/nova/commit/99cf5292c782828ea33a3448ae0e7da028d5d176
Submitter: "Zuul (22348)"
Branch:    master

commit 99cf5292c782828ea33a3448ae0e7da028d5d176
Author: Stephen Finucane &lt;stephenfin@redhat.com&gt;
Date:   Fri Jun 18 17:55:50 2021 +0100

    objects: Fix VIFMigrateData.supports_os_vif_delegation setter
    
    We're using a 'profile' getter/setter in the 'VIFMigrateData' object to
    ensure we transform the JSON encoded string we store in the database to
    an actual dictionary on load and vice versa on save. However, because
    the getter is returning a new object (constructed from 'json.loads')
    rather than a reference to the original data (which is a string),
    modifying this object doesn't actually change the underlying data in the
    object. We were relying on this broken behavior to set the
    'supports_os_vif_delegation' attribute of the 'VIFMigrateData' object
    and trigger the delegated port creation introduced in change
    I11fb5d3ada7f27b39c183157ea73c8b72b4e672e, which means that code isn't
    actually doing anything yet. Resolve this.
    
    Change-Id: I362deb1088c88cdcd8219922da9dc9a01b10a940
    Signed-off-by: Stephen Finucane &lt;stephenfin@redhat.com&gt;
    Related-Bug: #1734320
    Related-Bug: #1815989
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/110" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-07-26T19:45:22.891717+00:00" title="2021-07-26 19:45:22 UTC">on 2021-07-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/110"> #110</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/c/openstack/nova/+/797428">https:/<wbr />/review.<wbr />opendev.<wbr />org/c/openstack<wbr />/nova/+<wbr />/797428</a><br />
Committed: <a rel="nofollow" href="https://opendev.org/openstack/nova/commit/fa0fb2fe3d61de1cb871c48ee97053cf2fb5827a">https:/<wbr />/opendev.<wbr />org/openstack/<wbr />nova/commit/<wbr />fa0fb2fe3d61de1<wbr />cb871c48ee97053<wbr />cf2fb5827a</a><br />
Submitter: &quot;Zuul (22348)&quot;<br />
Branch:    master</p>
<p>commit fa0fb2fe3d61de1<wbr />cb871c48ee97053<wbr />cf2fb5827a<br />
Author: Stephen Finucane &lt;email address hidden&gt;<br />
Date:   Tue Jun 22 11:37:22 2021 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;libvirt: Always delegate OVS plug to os-vif</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;In change I11fb5d3ada7f27<wbr />b39c183157ea73c<wbr />8b72b4e672e, we started<br />
&nbsp;&nbsp;&nbsp;&nbsp;delegating plugging of OVS ports to os-vif to work around a number of<br />
&nbsp;&nbsp;&nbsp;&nbsp;bugs. However, this was only introduced for live migration. Plugging is<br />
&nbsp;&nbsp;&nbsp;&nbsp;still handled by libvirt for spawn. This results in an odd situation,<br />
&nbsp;&nbsp;&nbsp;&nbsp;whereby an interface of type &#x27;bridge&#x27; will be use when creating the<br />
&nbsp;&nbsp;&nbsp;&nbsp;instance initially, only for this to change to &#x27;ethernet&#x27; on live<br />
&nbsp;&nbsp;&nbsp;&nbsp;migration. Resolve this by *always* delegating plugging to os-vif. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;is achieved by consistently setting the &#x27;delegate_create&#x27; attribute of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;nova.<wbr />network.<wbr />model.VIF&#x27; to &#x27;True&#x27;, which will later get transformed to<br />
&nbsp;&nbsp;&nbsp;&nbsp;the &#x27;create_port&#x27; attribute of the &#x27;os_vif.<wbr />objects.<wbr />vif.VIFOpenVSwi<wbr />tch&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;object(s) created in &#x27;nova.network.<wbr />os_vif_<wbr />util._nova_<wbr />to_osvif_<wbr />vif_ovs&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;and ultimately result in delegate port creation.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Note that we don&#x27;t need to worry about making the setting of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;delegate_<wbr />create&#x27; conditional on whether we&#x27;re looking at an OVS port or<br />
&nbsp;&nbsp;&nbsp;&nbsp;not: this will be handled by &#x27;_nova_<wbr />to_osvif_<wbr />vif_ovs&#x27;<wbr />. We also don&#x27;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;need to worry about unsetting this attribute before a live migration:<br />
&nbsp;&nbsp;&nbsp;&nbsp;the &#x27;delegate_create&#x27; attribute is always overridden as part of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&#x27;nova.<wbr />objects.<wbr />migrate_<wbr />data.VIFMigrate<wbr />Data.get_<wbr />dest_vif&#x27;<wbr />.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I014c5a81752f86<wbr />c6b99d19d769c42<wbr />f318e18e676<br />
&nbsp;&nbsp;&nbsp;&nbsp;Signed-off-by: Stephen Finucane &lt;email address hidden&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1734320<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1815989</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/c/openstack/nova/+/797428
Committed: https://opendev.org/openstack/nova/commit/fa0fb2fe3d61de1cb871c48ee97053cf2fb5827a
Submitter: "Zuul (22348)"
Branch:    master

commit fa0fb2fe3d61de1cb871c48ee97053cf2fb5827a
Author: Stephen Finucane &lt;stephenfin@redhat.com&gt;
Date:   Tue Jun 22 11:37:22 2021 +0100

    libvirt: Always delegate OVS plug to os-vif
    
    In change I11fb5d3ada7f27b39c183157ea73c8b72b4e672e, we started
    delegating plugging of OVS ports to os-vif to work around a number of
    bugs. However, this was only introduced for live migration. Plugging is
    still handled by libvirt for spawn. This results in an odd situation,
    whereby an interface of type 'bridge' will be use when creating the
    instance initially, only for this to change to 'ethernet' on live
    migration. Resolve this by *always* delegating plugging to os-vif. This
    is achieved by consistently setting the 'delegate_create' attribute of
    'nova.network.model.VIF' to 'True', which will later get transformed to
    the 'create_port' attribute of the 'os_vif.objects.vif.VIFOpenVSwitch'
    object(s) created in 'nova.network.os_vif_util._nova_to_osvif_vif_ovs'
    and ultimately result in delegate port creation.
    
    Note that we don't need to worry about making the setting of
    'delegate_create' conditional on whether we're looking at an OVS port or
    not: this will be handled by '_nova_to_osvif_vif_ovs'. We also don't
    need to worry about unsetting this attribute before a live migration:
    the 'delegate_create' attribute is always overridden as part of
    'nova.objects.migrate_data.VIFMigrateData.get_dest_vif'.
    
    Change-Id: I014c5a81752f86c6b99d19d769c42f318e18e676
    Signed-off-by: Stephen Finucane &lt;stephenfin@redhat.com&gt;
    Related-Bug: #1734320
    Related-Bug: #1815989
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1734320/comments/111" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-09-17T14:40:35.636155+00:00" title="2021-09-17 14:40:35 UTC">on 2021-09-17</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1734320/comments/111">
                <strong>Fix included in openstack/nova 24.0.0.0rc1</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1734320/comments/111"> #111</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This issue was fixed in the openstack/nova 24.0.0.0rc1 release candidate.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This issue was fixed in the openstack/nova 24.0.0.0rc1 release candidate.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/neutron/+bug/1734320/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
        
          <div class="informational message comments-hidden-message">
            Displaying first 40
            and last 40
            comments.
            
              <a class="show-comments-link" href="/neutron/+bug/1734320?comments=all">
                View all 111
                comments</a> or <a href="/neutron/+bug/1734320?comments=all">add a comment</a>.
            
          </div>
            
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/neutron/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/neutron/+bug/1734320/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/neutron/+bug/1734320/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/neutron/+bug/1734320/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/neutron/+bug/1734320/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/neutron/+bug/1734320/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/neutron/+bug/1734320/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/neutron/+bug/1734320/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/neutron/+bug/1734320/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/neutron/+bug/1734320/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/neutron/+bug/1734320/+attachment/5031634/+files/0001-Mark-all-dead-ports-with-dead-tag.patch">0001-Mark-all-dead-ports-with-dead-tag.patch</a>
        <small>
          (<a href="/neutron/+bug/1734320/+attachment/5031634">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/neutron/+bug/1734320/+attachment/5033809/+files/0001-Create-new-ovs-ports-with-dead-vlan-tag.patch">os-vif tagging new ovs port with dead tag</a>
        <small>
          (<a href="/neutron/+bug/1734320/+attachment/5033809">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/neutron/+bug/1734320/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  


      <div class="portlet" id="portlet-watches">
  <h2>Remote bug watches</h2>
  <ul>
    <li>
      <span class="sprite bug-remote"></span>
      <a class="link-external" href="https://bugzilla.redhat.com/show_bug.cgi?id=1558336">redhat-bugs #1558336</a>
      
        <br />[<span>CLOSED NOTABUG</span>]
        <a class="sprite edit action-icon" title="Change watch details" href="/bugs/1734320/+watch/128803">Edit</a>
    </li>
  </ul>
  <p>Bug watches keep track of this bug in other bug trackers.</p>
</div>

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1734320", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1734320"}, "information_type_data": {"PUBLIC": {"description": "Everyone can see this information.\n", "name": "Public", "is_private": false, "order": 0, "description_css_class": "choice-description", "value": "PUBLIC"}, "PUBLICSECURITY": {"description": "Everyone can see this security related information.\n", "name": "Public Security", "is_private": false, "order": 1, "description_css_class": "choice-description", "value": "PUBLICSECURITY"}, "USERDATA": {"description": "Only shared with users permitted to see private user information.\n", "name": "Private", "is_private": true, "order": 3, "description_css_class": "choice-description", "value": "USERDATA"}, "PRIVATESECURITY": {"description": "Only the security group can see this information.\n ", "name": "Private Security", "is_private": true, "order": 2, "description_css_class": "choice-description", "value": "PRIVATESECURITY"}}, "total_comments_and_activity": 171, "bug_is_private": false, "related_features": {}, "first visible_recent_comment": 71, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1734320", "web_link": "https://bugs.launchpad.net/bugs/1734320", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1734320, "private": false, "information_type": "Public", "name": null, "title": "Eavesdropping private traffic", "description": "Eavesdropping private traffic\n=============================\n\nAbstract\n--------\n\nWe've discovered a security issue that allows end users within their own private network to receive from, and send traffic to, other private networks on the same compute node.\n\nDescription\n-----------\n\nDuring live-migration there is a small time window where the ports of instances are untagged. Instances have a port trunked to the integration bridge and receive 802.1Q tagged private traffic from other tenants.\n\nIf the port is administratively down during live migration, the port will remain in trunk mode indefinitely.\n\nTraffic is possible between ports is that are administratively down, even between tenants self-service networks.\n\nConditions\n----------\n\nThe following conditions are necessary.\n\n* Openvswitch Self-service networks\n* An Openstack administrator or an automated process needs to schedule a Live migration\n\nWe tested this on newton.\n\nIssues\n------\n\nThis outcome is the result of multiple independent issues. We will list the most important first, and follow with bugs that create a fragile situation.\n\nIssue #1 Initially creating a trunk port\n\nWhen the port is initially created, it is in trunk mode. This creates a fail-open situation.\nSee: https://github.com/openstack/os-vif/blob/newton-eol/vif_plug_ovs/linux_net.py#L52\nRecommendation: create ports in the port_dead state, don't leave it dangling in trunk-mode. Add a drop-flow initially.\n\nIssue #2 Order of creation.\n\nThe instance is actually migrated before the (networking) configuration is completed.\n\nRecommendation: wait with finishing the live migration until the underlying configuration has been applied completely.\n\nIssue #3 Not closing the port when it is down.\n\nNeutron calls the port_dead function to ensure the port is down. It sets the tag to 4095 and adds a \"drop\" flow if (and only if) there is already another tag on the port. The port_dead function will keep untagged ports untagged.\n\nhttps://github.com/openstack/neutron/blob/stable/newton/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L995\n\nRecommendation: Make port_dead also shut the port if no tag is found. Log a warning if this happens.\n\nIssue #4 Putting the port administratively down actually puts the port on a compute node shared vlan\n\nInstances from different projects on different private networks can talk to each other if they put their ports down. The code does install an openflow \"drop\" rule but it has a lower priority (2) than the allow rules.\n\nRecommendation: Increase the port_dead openflow drop rule priority to MAX\n\nTimeline\n--------\n\n\u00a02017-09-14 Discovery eavesdropping issue\n\u00a02017-09-15 Verify workaround.\n\u00a02017-10-04 Discovery port-down-traffic issue\n\u00a02017-11-24 Vendor Disclosure to Openstack\n\nSteps to reproduce\n------------------\n\n1. Attach an instance to two networks:\n\nadmin$ openstack server create --nic net-id=\u003cnet-uuid1\u003e --nic net-id=\u003cnet-uuid2\u003e --image \u003cimage_id\u003e --flavor \u003cflavor_id\u003e instance_temp\n\n2. Attach a FIP to the instance to be able to log in to this instance\n\n3. Verify:\n\nadmin$ openstack server show -c name -c addresses fe28a2ee-098f-4425-9d3c-8e2cd383547d\n\n+-----------+-----------------------------------------------------------------------------+\n| Field     | Value                                                                       |\n+-----------+-----------------------------------------------------------------------------+\n| addresses | network1=192.168.99.8, \u003cFIP\u003e; network2=192.168.80.14                        |\n| name      | instance_temp                                                               |\n+-----------+-----------------------------------------------------------------------------+\n\n4. Ssh to the instance using network1 and run a tcpdump on the other port network2\n\n[root@instance_temp]$ tcpdump -eeenni eth1\n\n5. Get port-id of network2\n\nadmin$ nova interface-list fe28a2ee-098f-4425-9d3c-8e2cd383547d\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses  | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n| ACTIVE     | a848520b-0814-4030-bb48-49e4b5cf8160 | d69028f7-9558-4f14-8ce6-29cb8f1c19cd | 192.168.80.14 | fa:16:3e:2d:8b:7b |\n| ACTIVE     | fad148ca-cf7a-4839-aac3-a2cd8d1d2260 | d22c22ae-0a42-4e3b-8144-f28534c3439a | 192.168.99.8  | fa:16:3e:60:2c:fa |\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n\n6. Force port down on network 2\n\nadmin$ neutron port-update a848520b-0814-4030-bb48-49e4b5cf8160 --admin-state-up False\n\n7. Port gets tagged with vlan 4095, the dead vlan tag, which is normal:\n\ncompute1# grep a848520b-0814-4030-bb48-49e4b5cf8160 /var/log/neutron/neutron-openvswitch-agent.log | tail -1\nINFO neutron.plugins.ml2.drivers.openvswitch.agent.ovs_neutron_agent [req-e008feb3-8a35-4c97-adac-b48ff88165b2 - - - - -] VIF port: a848520b-0814-4030-bb48-49e4b5cf8160 admin state up disabled, putting on the dead VLAN\n\n8. Verify the port is tagged with vlan 4095\n\ncompute1# ovs-vsctl show | grep -A3 qvoa848520b-08\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Port \"qvoa848520b-08\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0tag: 4095\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Interface \"qvoa848520b-08\"\n\n9. Now live-migrate the instance:\n\nadmin# nova live-migration fe28a2ee-098f-4425-9d3c-8e2cd383547d\n\n10. Verify the tag is gone on compute2, and take a deep breath\n\ncompute2# ovs-vsctl show | grep -A3 qvoa848520b-08\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Port \"qvoa848520b-08\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Interface \"qvoa848520b-08\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Port...\ncompute2# echo \"Wut!\"\n\n11. Now traffic of all other self-service networks present on compute2 can be sniffed from instance_temp\n\n[root@instance_temp] tcpdump -eenni eth1\n13:14:31.748266 fa:16:3e:6a:17:38 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.152, length 28\n13:14:31.804573 fa:16:3e:e8:a2:d2 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.70, length 28\n13:14:31.810482 fa:16:3e:95:ca:3a \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.154, length 28\n13:14:31.977820 fa:16:3e:6f:f4:9b \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.150, length 28\n13:14:31.979590 fa:16:3e:0f:3d:cc \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 9, p 0, ethertype ARP, Request who-has 10.103.9.163 tell 10.103.9.1, length 28\n13:14:32.048082 fa:16:3e:65:64:38 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.101, length 28\n13:14:32.127400 fa:16:3e:30:cb:b5 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.165, length 28\n13:14:32.141982 fa:16:3e:96:cd:b0 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.100, length 28\n13:14:32.205327 fa:16:3e:a2:0b:76 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.153, length 28\n13:14:32.444142 fa:16:3e:1f:db:ed \u003e 01:00:5e:00:00:12, ethertype 802.1Q (0x8100), length 58: vlan 72, p 0, ethertype IPv4, 192.168.99.212 \u003e 224.0.0.18: VRRPv2, Advertisement, vrid 50, prio 103, authtype none, intvl 1s, length 20\n13:14:32.449497 fa:16:3e:1c:24:c0 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.20, length 28\n13:14:32.476015 fa:16:3e:f2:3b:97 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 33, p 0, ethertype ARP, Request who-has 10.0.1.9 tell 10.0.1.22, length 28\n13:14:32.575034 fa:16:3e:44:fe:35 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.163, length 28\n13:14:32.676185 fa:16:3e:1e:92:d7 \u003e ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 10, p 0, ethertype ARP, Request who-has 10.103.12.160 tell 10.103.12.150, length 28\n13:14:32.711755 fa:16:3e:99:6c:c8 \u003e 01:00:5e:00:00:12, ethertype 802.1Q (0x8100), length 62: vlan 10, p 0, ethertype IPv4, 10.103.12.154 \u003e 224.0.0.18: VRRPv2, Advertisement, vrid 2, prio 49, authtype simple, intvl 1s, length 24\n13:14:32.711773 fa:16:3e:f5:23:d5 \u003e 01:00:5e:00:00:12, ethertype 802.1Q (0x8100), length 58: vlan 12, p 0, ethertype IPv4, 10.103.15.154 \u003e 224.0.0.18: VRRPv2, Advertisement, vrid 1, prio 49, authtype simple, intvl 1s, length 20\n\nWorkaround\n----------\n\nWe temporary fixed this issue by forcing the dead vlan tag on port creation on compute nodes:\n\n/usr/lib/python2.7/site-packages/vif_plug_ovs/linux_net.py:\n\ndef _create_ovs_vif_cmd(bridge, dev, iface_id, mac,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance_id, interface_type=None,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0vhost_server_path=None):\n+   # ODCN: initialize port as dead\n+   # ODCN: TODO: set drop flow\n\u00a0\u00a0\u00a0\u00a0cmd = ['--', '--if-exists', 'del-port', dev, '--',\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'add-port', bridge, dev,\n+           'tag=4095',\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'--', 'set', 'Interface', dev,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'external-ids:iface-id=%s' % iface_id,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'external-ids:iface-status=active',\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'external-ids:attached-mac=%s' % mac,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'external-ids:vm-uuid=%s' % instance_id]\n\u00a0\u00a0\u00a0\u00a0if interface_type:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0cmd += ['type=%s' % interface_type]\n\u00a0\u00a0\u00a0\u00a0if vhost_server_path:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0cmd += ['options:vhost-server-path=%s' % vhost_server_path]\n\u00a0\u00a0\u00a0\u00a0return cmd\n\nhttps://github.com/openstack/neutron/blob/stable/newton/neutron/plugins/ml2/drivers/openvswitch/agent/ovs_neutron_agent.py#L995\n\n\u00a0\u00a0\u00a0\u00a0def port_dead(self, port, log_errors=True):\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'''Once a port has no binding, put it on the \"dead vlan\".\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0:param port: an ovs_lib.VifPort object.\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'''\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# Don't kill a port if it's already dead\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0cur_tag = self.int_br.db_get_val(\"Port\", port.port_name, \"tag\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0log_errors=log_errors)\n+       # ODCN GM 20170915\n+       if not cur_tag:\n+           LOG.error('port_dead(): port %s has no tag', port.port_name)\n+       # ODCN AJS 20170915\n+       if not cur_tag or cur_tag != constants.DEAD_VLAN_TAG:\n-       if cur_tag and cur_tag != constants.DEAD_VLAN_TAG:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LOG.info('port_dead(): put port %s on dead vlan', port.port_name)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.int_br.set_db_attribute(\"Port\", port.port_name, \"tag\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0constants.DEAD_VLAN_TAG,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0log_errors=log_errors)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.int_br.drop_port(in_port=port.ofport)\n\nplugins/ml2/drivers/openvswitch/agent/openflow/ovs_ofctl/ovs_bridge.py\n\u00a0\u00a0\u00a0\u00a0def drop_port(self, in_port):\n+        # ODCN AJS 20171004:\n-       self.install_drop(priority=2, in_port=in_port)\n+       self.install_drop(priority=65535, in_port=in_port)\n\nRegards,\n\nODC Noord.\nGerhard Muntingh\nAlbert Siersema\nPaul Peereboom", "owner_link": "https://bugs.launchpad.net/api/devel/~peereb", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/bug_tasks", "duplicate_of_link": null, "date_created": "2017-11-24T11:16:18.241887+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/subscriptions", "date_last_updated": "2021-09-17T14:40:36.952332+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 50, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/attachments", "security_related": false, "latest_patch_uploaded": "2018-01-09T21:42:32.056671+00:00", "tags": ["in-stable-pike", "in-stable-queens", "in-stable-rocky", "in-stable-victoria", "neutron-proactive-backport-potential", "security"], "date_last_message": "2021-09-17T14:40:35.636155+00:00", "number_of_duplicates": 0, "message_count": 112, "users_affected_count": 4, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/users_unaffected", "users_affected_count_with_dupes": 4, "other_users_affected_count_with_dupes": 4, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1734320/linked_merge_proposals", "http_etag": "\"dccaade03603ed81846285de053e22049783fee6-2eb80d9cd9cfbb2d1538c1f89f2fd83af588d83d\""}, "bugtask_data": {"2324524": {"assignee_vocabulary": "AllUserTeamsParticipation", "user_can_unassign": false, "bugtask_path": "/os-vif/+bug/1734320", "assignee_value": "sean-k-mooney", "user_can_edit_status": true, "bug_title": "Eavesdropping private traffic", "user_can_edit_milestone": false, "prefix": "os-vif", "form_row_id": "task2324524", "target_is_product": true, "user_can_edit_importance": false, "assignee_is_team": false, "delete_link": "https://bugs.launchpad.net/os-vif/+bug/1734320/+delete", "user_can_edit_assignee": false, "milestone_widget_items": "[]", "status_widget_items": "[]", "status_value": "Fix Released", "importance_value": "High", "hide_assignee_team_selection": true, "user_can_delete": false, "row_id": "tasksummary2324524", "assignee_vocabulary_filters": [], "targetname": "os-vif", "importance_widget_items": "[]", "milestone_value": null, "id": 2324524}, "2319596": {"assignee_vocabulary": "AllUserTeamsParticipation", "user_can_unassign": false, "bugtask_path": "/neutron/+bug/1734320", "assignee_value": "rodolfo-alonso-hernandez", "user_can_edit_status": true, "bug_title": "Eavesdropping private traffic", "user_can_edit_milestone": false, "prefix": "neutron", "form_row_id": "task2319596", "target_is_product": true, "user_can_edit_importance": false, "assignee_is_team": false, "delete_link": "https://bugs.launchpad.net/neutron/+bug/1734320/+delete", "user_can_edit_assignee": false, "milestone_widget_items": "[]", "status_widget_items": "[]", "status_value": "Fix Released", "importance_value": "High", "hide_assignee_team_selection": true, "user_can_delete": false, "row_id": "tasksummary2319596", "assignee_vocabulary_filters": [], "targetname": "neutron", "importance_widget_items": "[]", "milestone_value": null, "id": 2319596}, "2319628": {"assignee_vocabulary": "AllUserTeamsParticipation", "user_can_unassign": false, "bugtask_path": "/ossa/+bug/1734320", "assignee_value": null, "user_can_edit_status": true, "bug_title": "Eavesdropping private traffic", "user_can_edit_milestone": false, "prefix": "ossa", "form_row_id": "task2319628", "target_is_product": true, "user_can_edit_importance": false, "assignee_is_team": null, "delete_link": "https://bugs.launchpad.net/ossa/+bug/1734320/+delete", "user_can_edit_assignee": false, "milestone_widget_items": "[]", "status_widget_items": "[]", "status_value": "Won't Fix", "importance_value": "Undecided", "hide_assignee_team_selection": true, "user_can_delete": false, "row_id": "tasksummary2319628", "assignee_vocabulary_filters": [], "targetname": "OpenStack Security Advisory", "importance_widget_items": "[]", "milestone_value": null, "id": 2319628}, "2320351": {"assignee_vocabulary": "AllUserTeamsParticipation", "user_can_unassign": false, "bugtask_path": "/nova/+bug/1734320", "assignee_value": "sean-k-mooney", "user_can_edit_status": true, "bug_title": "Eavesdropping private traffic", "user_can_edit_milestone": false, "prefix": "nova", "form_row_id": "task2320351", "target_is_product": true, "user_can_edit_importance": false, "assignee_is_team": false, "delete_link": "https://bugs.launchpad.net/nova/+bug/1734320/+delete", "user_can_edit_assignee": false, "milestone_widget_items": "[]", "status_widget_items": "[]", "status_value": "Fix Released", "importance_value": "Undecided", "hide_assignee_team_selection": true, "user_can_delete": false, "row_id": "tasksummary2320351", "assignee_vocabulary_filters": [], "targetname": "OpenStack Compute (nova)", "importance_widget_items": "[]", "milestone_value": null, "id": 2320351}}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/neutron/+bug/1734320", "web_link": "https://bugs.launchpad.net/neutron/+bug/1734320", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1734320", "milestone_link": null, "status": "Fix Released", "importance": "High", "assignee_link": "https://bugs.launchpad.net/api/devel/~rodolfo-alonso-hernandez", "bug_target_display_name": "neutron", "bug_target_name": "neutron", "bug_watch_link": null, "date_assigned": "2018-11-08T16:36:34.148441+00:00", "date_created": "2017-11-24T11:16:18.241887+00:00", "date_confirmed": "2020-08-03T22:45:25.161552+00:00", "date_incomplete": null, "date_in_progress": "2020-08-04T12:39:48.736063+00:00", "date_closed": "2020-12-11T11:15:07.375059+00:00", "date_left_new": "2017-12-02T06:02:56.826088+00:00", "date_triaged": "2020-08-04T12:39:48.736063+00:00", "date_fix_committed": "2020-12-11T11:15:07.375059+00:00", "date_fix_released": "2020-12-11T11:15:07.375059+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~peereb", "target_link": "https://bugs.launchpad.net/api/devel/neutron", "title": "Bug #1734320 in neutron: \"Eavesdropping private traffic\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/neutron/+bug/1734320/related_tasks", "is_complete": true, "http_etag": "\"3807d937371c7c5a2cc7197731205b114d65865a-a9d65c9b281be3dabbcb0ebee97084ceff403f5d\""}, "initial_comment_batch_offset": 41};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 65 queries/external actions issued in 1.60 seconds

    Features: {'app.maintenance_message': None, 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'bugs.nominations.bug_supervisors_can_target': 'on', 'baselayout.careers_link.disabled': None, 'hard_timeout': '9000', 'js.yui_version': None, 'profiling.enabled': None}

    r0d8de2b

    -->

</html>

