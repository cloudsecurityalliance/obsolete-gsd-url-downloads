<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1517226 “Remote double-free and memory corruption vulnerabi...” : Bugs : dhcpcd package : Ubuntu</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1517226" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1517226/bug.atom" title="Bug 1517226 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="Hey,

I have subjected a crucial part of dhcpcd, the function parse_dhcpmessage() in dhcp.c as well as the functions it invokes, to thorough fuzzing (using AFL) and manual source code inspection. This effort has resulted in the identification of a number of remote memory corruption vulnerabilities.

Please bear in mind that in order to make these routines of dhcpcd fuzzable I needed to modify the main() function such that parse_dhcpmessage() could be directly invoked with input received from ..." />
      <meta property="og:description" content="Hey,

I have subjected a crucial part of dhcpcd, the function parse_dhcpmessage() in dhcp.c as well as the functions it invokes, to thorough fuzzing (using AFL) and manual source code inspection. This effort has resulted in the identification of a number of remote memory corruption vulnerabilities.

Please bear in mind that in order to make these routines of dhcpcd fuzzable I needed to modify the main() function such that parse_dhcpmessage() could be directly invoked with input received from ..." />
    

    
    
      <meta property="og:title" content="Bug #1517226 “Remote double-free and memory corruption vulnerabi...” : Bugs : dhcpcd package : Ubuntu" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1517226" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["a11y", "appstream", "bionic", "bisect-done", "bitesize", "cherry-pick", "community-security", "desktop-file", "disco", "dist-upgrade", "focal", "ftbfs", "groovy", "hirsute", "hw-specific", "impish", "jammy", "kernel-bug", "manpage", "metabug", "multiarch", "needs-bisect", "needs-design", "needs-packaging", "needs-reassignment", "package-conflict", "packaging", "patch", "patch-accepted-debian", "patch-accepted-upstream", "patch-forwarded-debian", "patch-forwarded-upstream", "patch-needswork", "patch-rejected", "patch-rejected-debian", "patch-rejected-upstream", "performing-bisect", "py2-removal", "qt4-removal", "regression-proposed", "regression-release", "regression-update", "string-fix", "suspend-resume", "systemd-boot", "testcase", "touch", "unmetdeps", "upgrade-software-version", "verification-done-bionic", "verification-done-focal", "verification-done-groovy", "verification-done-hirsute", "verification-done-impish", "verification-done-xenial", "verification-failed-bionic", "verification-failed-groovy", "verification-failed-impish", "verification-failed-xenial", "verification-needed-bionic", "verification-needed-focal", "verification-needed-groovy", "verification-needed-hirsute", "verification-needed-impish", "verification-needed-trusty", "verification-needed-xenial", "wayland", "xenial"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/ubuntu"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/49558155/64_logo.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/ubuntu">Ubuntu</a><br /><a href="https://launchpad.net/ubuntu/+source/dhcpcd">dhcpcd package</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/ubuntu/+source/dhcpcd">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/ubuntu/+source/dhcpcd">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd">Bugs</a></li>
      
      
    
    
      
      
      <li class="specifications disabled-tab"><span>Blueprints</span></li>
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/ubuntu/+source/dhcpcd">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/ubuntu/+source/dhcpcd">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    Remote double-free and memory corruption vulnerabilities
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1517226 reported by
      <a href="https://launchpad.net/~guidovranken" class="sprite person">Guido</a>
      <time title="2015-11-17 21:57:27 UTC" datetime="2015-11-17T21:57:27.640299+00:00">on 2015-11-17</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">260</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1948575">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1948575">
        <span class="yui3-activator-data-box">
            <a class="sprite package-source" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd" title="Latest release: 1:3.2.3-11+deb7u1build0.14.04.1, uploaded to main on 2016-03-30 22:44:25.459058+00:00 by Tyler Hicks (tyhicks), maintained by Simon Kelley (simon-thekelleys)">dhcpcd (Ubuntu)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1948575">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1948575">
     <td colspan="7"><form action="/ubuntu/+source/dhcpcd/+bug/1517226/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/+source/dhcpcd">dhcpcd (Ubuntu)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~guidovranken" class="sprite person">Guido</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2015-11-17 21:57:27 UTC" datetime="2015-11-17T21:57:27.640299+00:00">2015-11-17</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2015-12-09 12:48:24 UTC" datetime="2015-12-09T12:48:24.052045+00:00">2015-12-09</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2016-03-31 14:00:55 UTC" datetime="2016-03-31T14:00:55.032005+00:00">2016-03-31</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2016-03-31 14:00:55 UTC" datetime="2016-03-31T14:00:55.032005+00:00">2016-03-31</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ubuntu_dhcpcd.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ubuntu_dhcpcd.target.option.package" name="ubuntu_dhcpcd.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ubuntu_dhcpcd.target.distribution" name="ubuntu_dhcpcd.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ubuntu_dhcpcd.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ubuntu_dhcpcd.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="dhcpcd" id="ubuntu_dhcpcd.target.package"
                         name="ubuntu_dhcpcd.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_dhcpcd.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_dhcpcd.target.package');
              var select_menu = Y.DOM.byId('ubuntu_dhcpcd.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_dhcpcd-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": "dhcpcd", "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "ubuntu_dhcpcd.target.package", "show_widget_id": "show-widget-ubuntu_dhcpcd-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ubuntu_dhcpcd-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" id="ubuntu_dhcpcd.target.option.product" name="ubuntu_dhcpcd.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ubuntu_dhcpcd.target.product"
                         name="ubuntu_dhcpcd.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_dhcpcd.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_dhcpcd.target.product');
              var select_menu = Y.DOM.byId('ubuntu_dhcpcd.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_dhcpcd-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": null, "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "ubuntu_dhcpcd.target.product", "show_widget_id": "show-widget-ubuntu_dhcpcd-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ubuntu_dhcpcd-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_dhcpcd.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_dhcpcd.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_dhcpcd.status" name="ubuntu_dhcpcd.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ubuntu_dhcpcd.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_dhcpcd.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_dhcpcd.assignee.assign_to_nobody" name="ubuntu_dhcpcd.assignee.option" value="ubuntu_dhcpcd.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_dhcpcd.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_dhcpcd.assignee.assign_to_me" name="ubuntu_dhcpcd.assignee.option" value="ubuntu_dhcpcd.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_dhcpcd.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_dhcpcd.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_dhcpcd.comment_on_change" name="ubuntu_dhcpcd.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>Hey,</p>
<p>I have subjected a crucial part of dhcpcd, the function parse_dhcpmessage() in dhcp.c as well as the functions it invokes, to thorough fuzzing (using AFL) and manual source code inspection. This effort has resulted in the identification of a number of remote memory corruption vulnerabilities.</p>
<p>Please bear in mind that in order to make these routines of dhcpcd fuzzable I needed to modify the main() function such that parse_dhcpmessage() could be directly invoked with input received from the fuzzer. So while the proof of concepts included with this post are tailored to triggering the vulnerabilities this specific set-up, I have very little doubt that they can be triggered in a scenario in which dhcpcd is employed for its actual purpose. In order to emulate exploitation under authentic use of the program, one would need to write a mock DHCP server which responds to the client&#x27;s inquiries with one of the malicious payloads. The vulnerabilities contained in the Ubuntu version of dhcpcd (3.2.3) are in fact removed in later versions of the upstream version of the application. Whether due to inadequate diligence on the part of its maintainers to report found security vulnerabilities, or due to serendipitous remediation by the virtue of general, pro-active code hardening in the upstream version, I couldn&#x27;t find any earlier reports (CVE&#x27;s or otherwise) of these vulnerabilities, which is likely the reason it hasn&#x27;t been fixed yet in the Ubuntu version.</p>
<p>My proposed patch for the vulnerabilities is basically taken from the way in which later upstream versions deal with the problem. I can guarantee that my set of proof of concept payloads does not trigger memory corruption after the patch has been applied (it doesn&#x27;t crash nor does ASAN report any corruption). However, you might to double check my changes, especially to see whether the application as a DHCP client keeps working as expected.</p>
<p>By extension of the above reasoning as to why the vulnerability in the Ubuntu version wasn&#x27;t uncovered and fixed earlier, you might want to consider upgrading to a later upstream version altogether, because more vulnerabilities and bugs might be present in your (rather old) code.</p>
<p>I am including two files with this message: one is the dhcp.c patch, and the other a modified version of dhcpcd.c and a collection of payloads (generated by AFL) that will trigger corruptions. You can copy dhcpcd.c over the original version and then invoke it as: ./dhcpcd &lt;path_to_payload&gt;. You can copy these .c files over the ones that appear after you do &#x27;apt-get source dhcpcd&#x27;.</p>
<p>I believe the patch speaks for itself. However, if you require more commentary on the technical reasons of the crashes, I&#x27;ll be happy to elaborate on this upon your request.</p>
<p>For what it&#x27;s worth:</p>
<p>$ lsb_release -rd<br />
Description:	Ubuntu 14.04.3 LTS<br />
Release:	14.04</p>
<p>-<br />
Guido Vranken</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            Tags:
          </span>
          <span id="tag-list">
            <a class="official-tag" href="/ubuntu/+source/dhcpcd/+bugs?field.tag=patch">patch</a>
          </span>
          
          <a href="+edit" title="Edit tags" id="tags-trigger" class="sprite edit action-icon">Edit</a>
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          

            <div id="bug-branches">
              <h2>Related branches</h2>

              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/trusty/dhcpcd/trusty-security" class="sprite branch">lp:ubuntu/trusty-security/dhcpcd</a>
  
  
</div>



              
              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/debian/wheezy/dhcpcd/wheezy" class="sprite branch">lp:debian/wheezy/dhcpcd</a>
  
  
</div>



              
            </div>
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2012-6698" title="The decode_search function in dhcp.c ...">2012-6698</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2012-6699" title="The decode_search function in dhcp.c ...">2012-6699</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2012-6700" title="The decode_search function in dhcp.c ...">2012-6700</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~guidovranken" class="sprite person">Guido (guidovranken)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-17T21:57:27.640299+00:00" title="2015-11-17 21:57:27 UTC">on 2015-11-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4520925/+files/patch-payloads-dhcpcd.c.tar.xz">patch-payloads-dhcpcd.c.tar.xz</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4520925">Edit</a>
        (10.7 KiB,
        application/octet-stream)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~guidovranken" class="sprite person">Guido (guidovranken)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-30T11:01:59.163944+00:00" title="2015-11-30 11:01:59 UTC">on 2015-11-30</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>What&#x27;s the plan? Will this be fixed?</p>
<p>Guido</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">What's the plan? Will this be fixed?

Guido</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-30T23:51:05.713107+00:00" title="2015-11-30 23:51:05 UTC">on 2015-11-30</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Guido, some of the other distributions asked for more time to investigate; I&#x27;ve asked them to report back on their progress.</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Guido, some of the other distributions asked for more time to investigate; I've asked them to report back on their progress.

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-02T01:40:33.592714+00:00" title="2015-12-02 01:40:33 UTC">on 2015-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4528335/+files/dhcp.c.patch">dhcp.c.patch</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4528335">Edit</a>
        (1.4 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Guido&#x27;s patch from the tarball</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Guido's patch from the tarball</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~crichton" class="sprite person">Ubuntu Foundations Team Bug Bot (crichton)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-02T04:21:06.517393+00:00" title="2015-12-02 04:21:06 UTC">on 2015-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The attachment &quot;dhcp.c.patch&quot; seems to be a patch.  If it isn&#x27;t, please remove the &quot;patch&quot; flag from the attachment, remove the &quot;patch&quot; tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.</p>
<p>[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The attachment "dhcp.c.patch" seems to be a patch.  If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: patch
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-03T18:29:48.256717+00:00" title="2015-12-03 18:29:48 UTC">on 2015-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>MITRE assigned CVEs: <a rel="nofollow" href="http://www.openwall.com/lists/oss-security/2015/12/03/1">http://<wbr />www.openwall.<wbr />com/lists/<wbr />oss-security/<wbr />2015/12/<wbr />03/1</a></p>
<p>Quoting MITRE:</p>
<p>Use CVE-2012-6698 for the vulnerability in which the possibility of<br />
&quot;out == start&quot; wasn&#x27;t considered, leading to an out-of-bounds write.</p>
<p>Use CVE-2012-6699 for this loop error that results in an out-of-bounds read.</p>
<p>Use CVE-2012-6700 for the presence of the free call in an incorrect place.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">MITRE assigned CVEs: http://www.openwall.com/lists/oss-security/2015/12/03/1

Quoting MITRE:

Use CVE-2012-6698 for the vulnerability in which the possibility of
"out == start" wasn't considered, leading to an out-of-bounds write.

Use CVE-2012-6699 for this loop error that results in an out-of-bounds read.

Use CVE-2012-6700 for the presence of the free call in an incorrect place.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-03T18:30:49.859456+00:00" title="2015-12-03 18:30:49 UTC">on 2015-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Guido, are you in a position to prepare updates for sponsoring? There&#x27;s information on how to prepare updates at <a rel="nofollow" href="https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures">https:/<wbr />/wiki.ubuntu.<wbr />com/SecurityTea<wbr />m/UpdateProcedu<wbr />res</a></p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Guido, are you in a position to prepare updates for sponsoring? There's information on how to prepare updates at https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~mdeslaur" class="sprite person">Marc Deslauriers (mdeslaur)</a>
    
    <time title="2015-12-09 12:48:23 UTC" datetime="2015-12-09T12:48:23.686557+00:00">on 2015-12-09</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in dhcpcd (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/dhcpcd/+bug/1517226/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-03-31T14:00:53.561755+00:00" title="2016-03-31 14:00:53 UTC">on 2016-03-31</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/dhcpcd/+bug/1517226/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package dhcpcd - 1:3.2.3-<wbr />11+deb7u1build0<wbr />.14.04.<wbr />1</p>
<p>---------------<br />
dhcpcd (1:3.2.<wbr />3-11+deb7u1buil<wbr />d0.14.04.<wbr />1) trusty-security; urgency=medium</p>
<p>&nbsp;&nbsp;* fake sync from Debian (LP: <a href="/bugs/1517226" class="bug-link">#1517226</a>)</p>
<p>dhcpcd (1:3.2.3-11+deb7u1) oldstable-security; urgency=high</p>
<p>&nbsp;&nbsp;* Fix CVE-2012-6698, CVE-2012-6699, CVE-2012-6700,<br />
&nbsp;&nbsp;&nbsp;&nbsp;out-of-bound reads/writes and use-after-free issues with specially<br />
&nbsp;&nbsp;&nbsp;&nbsp;crafted DHCP messages.<br />
&nbsp;&nbsp;&nbsp;&nbsp;This is a forward port of the patch applied to squeeze-lts since<br />
&nbsp;&nbsp;&nbsp;&nbsp;wheezy uses the same upstream version. (LP: <a href="/bugs/1517226" class="bug-link">#1517226</a>)</p>
<p>&nbsp;-- Tyler Hicks &lt;email address hidden&gt;  Wed, 30 Mar 2016 17:40:57 -0500</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package dhcpcd - 1:3.2.3-11+deb7u1build0.14.04.1

---------------
dhcpcd (1:3.2.3-11+deb7u1build0.14.04.1) trusty-security; urgency=medium

  * fake sync from Debian (LP: #1517226)

dhcpcd (1:3.2.3-11+deb7u1) oldstable-security; urgency=high

  * Fix CVE-2012-6698, CVE-2012-6699, CVE-2012-6700,
    out-of-bound reads/writes and use-after-free issues with specially
    crafted DHCP messages.
    This is a forward port of the patch applied to squeeze-lts since
    wheezy uses the same upstream version. (LP: #1517226)

 -- Tyler Hicks &lt;tyhicks@canonical.com&gt;  Wed, 30 Mar 2016 17:40:57 -0500</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in dhcpcd (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/ubuntu/+source/dhcpcd/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/ubuntu/+source/dhcpcd/+bug/1517226/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/ubuntu/+source/dhcpcd/+bug/1517226/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/ubuntu/+source/dhcpcd/+bug/1517226/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4528335/+files/dhcp.c.patch">dhcp.c.patch</a>
        <small>
          (<a href="/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4528335">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/ubuntu/+source/dhcpcd/+bug/1517226/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4520925/+files/patch-payloads-dhcpcd.c.tar.xz">patch-payloads-dhcpcd.c.tar.xz</a>
        <small>
          (<a href="/ubuntu/+source/dhcpcd/+bug/1517226/+attachment/4520925">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/ubuntu/+source/dhcpcd/+bug/1517226/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"initial_comment_batch_offset": 41, "first visible_recent_comment": -32, "related_features": {}, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1517226", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1517226"}, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1517226", "web_link": "https://bugs.launchpad.net/bugs/1517226", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1517226, "private": false, "information_type": "Public Security", "name": null, "title": "Remote double-free and memory corruption vulnerabilities", "description": "Hey,\n\nI have subjected a crucial part of dhcpcd, the function parse_dhcpmessage() in dhcp.c as well as the functions it invokes, to thorough fuzzing (using AFL) and manual source code inspection. This effort has resulted in the identification of a number of remote memory corruption vulnerabilities.\n\nPlease bear in mind that in order to make these routines of dhcpcd fuzzable I needed to modify the main() function such that parse_dhcpmessage() could be directly invoked with input received from the fuzzer. So while the proof of concepts included with this post are tailored to triggering the vulnerabilities this specific set-up, I have very little doubt that they can be triggered in a scenario in which dhcpcd is employed for its actual purpose. In order to emulate exploitation under authentic use of the program, one would need to write a mock DHCP server which responds to the client's inquiries with one of the malicious payloads. The vulnerabilities contained in the Ubuntu version of dhcpcd (3.2.3) are in fact removed in later versions of the upstream version of the application. Whether due to inadequate diligence on the part of its maintainers to report found security vulnerabilities, or due to serendipitous remediation by the virtue of general, pro-active code hardening in the upstream version, I couldn't find any earlier reports (CVE's or otherwise) of these vulnerabilities, which is likely the reason it hasn't been fixed yet in the Ubuntu version.\n\nMy proposed patch for the vulnerabilities is basically taken from the way in which later upstream versions deal with the problem. I can guarantee that my set of proof of concept payloads does not trigger memory corruption after the patch has been applied (it doesn't crash nor does ASAN report any corruption). However, you might to double check my changes, especially to see whether the application as a DHCP client keeps working as expected.\n\nBy extension of the above reasoning as to why the vulnerability in the Ubuntu version wasn't uncovered and fixed earlier, you might want to consider upgrading to a later upstream version altogether, because more vulnerabilities and bugs might be present in your (rather old) code.\n\nI am including two files with this message: one is the dhcp.c patch, and the other a modified version of dhcpcd.c and a collection of payloads (generated by AFL) that will trigger corruptions. You can copy dhcpcd.c over the original version and then invoke it as: ./dhcpcd \u003cpath_to_payload\u003e. You can copy these .c files over the ones that appear after you do 'apt-get source dhcpcd'.\n\nI believe the patch speaks for itself. However, if you require more commentary on the technical reasons of the crashes, I'll be happy to elaborate on this upon your request.\n\nFor what it's worth:\n\n$ lsb_release -rd\nDescription:\tUbuntu 14.04.3 LTS\nRelease:\t14.04\n\n-\nGuido Vranken", "owner_link": "https://bugs.launchpad.net/api/devel/~guidovranken", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/bug_tasks", "duplicate_of_link": null, "date_created": "2015-11-17T21:57:27.640299+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/subscriptions", "date_last_updated": "2016-08-11T06:08:43.299993+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 260, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/attachments", "security_related": true, "latest_patch_uploaded": "2015-12-02T01:40:33.592714+00:00", "tags": ["patch"], "date_last_message": "2016-03-31T14:00:53.561755+00:00", "number_of_duplicates": 0, "message_count": 9, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1517226/linked_merge_proposals", "http_etag": "\"c8f8a0816ba58c66982937ebb76b9b61996a04a5-648cd357aac6b9a23df64060c51dab84edb16513\""}, "bugtask_data": {"1948575": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226/+delete", "user_can_edit_status": true, "bugtask_path": "/ubuntu/+source/dhcpcd/+bug/1517226", "row_id": "tasksummary1948575", "importance_value": "Undecided", "importance_widget_items": "[]", "id": 1948575, "user_can_delete": false, "targetname": "dhcpcd (Ubuntu)", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "Remote double-free and memory corruption vulnerabilities", "assignee_value": null, "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1948575", "target_is_product": false, "assignee_is_team": null, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": null, "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "ubuntu_dhcpcd"}}, "bug_is_private": false, "context": {"self_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/dhcpcd/+bug/1517226", "web_link": "https://bugs.launchpad.net/ubuntu/+source/dhcpcd/+bug/1517226", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1517226", "milestone_link": null, "status": "Fix Released", "importance": "Undecided", "assignee_link": null, "bug_target_display_name": "dhcpcd (Ubuntu)", "bug_target_name": "dhcpcd (Ubuntu)", "bug_watch_link": null, "date_assigned": null, "date_created": "2015-11-17T21:57:27.640299+00:00", "date_confirmed": "2015-12-09T12:48:24.052045+00:00", "date_incomplete": null, "date_in_progress": "2016-03-31T14:00:55.032005+00:00", "date_closed": "2016-03-31T14:00:55.032005+00:00", "date_left_new": "2015-12-09T12:48:24.052045+00:00", "date_triaged": "2016-03-31T14:00:55.032005+00:00", "date_fix_committed": "2016-03-31T14:00:55.032005+00:00", "date_fix_released": "2016-03-31T14:00:55.032005+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~guidovranken", "target_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/dhcpcd", "title": "Bug #1517226 in dhcpcd (Ubuntu): \"Remote double-free and memory corruption vulnerabilities\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/dhcpcd/+bug/1517226/related_tasks", "is_complete": true, "http_etag": "\"1995e261f763290f7132071b22b5de7957f8765b-72c51ea25ea5404b89ede5f13528210c9f08ef97\""}, "information_type_data": {"PUBLIC": {"value": "PUBLIC", "is_private": false, "order": 0, "name": "Public", "description": "Everyone can see this information.\n", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"value": "PRIVATESECURITY", "is_private": true, "order": 2, "name": "Private Security", "description": "Only the security group can see this information.\n ", "description_css_class": "choice-description"}, "USERDATA": {"value": "USERDATA", "is_private": true, "order": 3, "name": "Private", "description": "Only shared with users permitted to see private user information.\n", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"value": "PUBLICSECURITY", "is_private": false, "order": 1, "name": "Public Security", "description": "Everyone can see this security related information.\n", "description_css_class": "choice-description"}}, "total_comments_and_activity": 21};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 78 queries/external actions issued in 0.73 seconds

    Features: {'bugs.nominations.bug_supervisors_can_target': 'on', 'hard_timeout': '9000', 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'app.maintenance_message': None, 'js.yui_version': None, 'disclosure.dsp_picker.enabled': 'on', 'profiling.enabled': None, 'baselayout.careers_link.disabled': None}

    r0d8de2b

    -->

</html>

