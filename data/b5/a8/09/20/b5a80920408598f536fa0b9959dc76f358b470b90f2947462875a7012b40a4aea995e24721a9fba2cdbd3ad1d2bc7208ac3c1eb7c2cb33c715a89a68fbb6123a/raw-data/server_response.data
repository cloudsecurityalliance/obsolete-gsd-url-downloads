<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/keystone/+bug/1202952/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1202952 “[OSSA 2013-025] PKI tokens are never revoked using...” : Bugs : OpenStack Identity (keystone)</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1202952" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1202952/bug.atom" title="Bug 1202952 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="This is a more serious incarnation of: https://bugs.launchpad.net/keystone/+bug/1202050.
Looks to be fixed on master in c238ace30981877e5991874c5b193ea7d5107419 (id hashing happens keystone/token/core.py there).

In the memcache token backend, whole tokens are stored in the revocation list.

In keystone/token/backends.py:
166     def _add_to_revocation_list(self, data):
167         data_json = jsonutils.dumps(data)
168         if not self.client.append(self.revocation_key, ',%s' % data_json):..." />
      <meta property="og:description" content="This is a more serious incarnation of: https://bugs.launchpad.net/keystone/+bug/1202050.
Looks to be fixed on master in c238ace30981877e5991874c5b193ea7d5107419 (id hashing happens keystone/token/core.py there).

In the memcache token backend, whole tokens are stored in the revocation list.

In keystone/token/backends.py:
166     def _add_to_revocation_list(self, data):
167         data_json = jsonutils.dumps(data)
168         if not self.client.append(self.revocation_key, ',%s' % data_json):..." />
    

    
    
      <meta property="og:title" content="Bug #1202952 “[OSSA 2013-025] PKI tokens are never revoked using...” : Bugs : OpenStack Identity (keystone)" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1202952" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["api-ref", "caching", "configuration", "default-roles", "documentation", "federation", "fernet", "fix-requires-microversion", "hierarchical-multitenancy", "i18n", "jwt", "ldap", "limits", "logging", "low-hanging-fruit", "meeting-topic", "notifications", "ocata-backport-potential", "office-hours", "ops", "password", "pci", "performance", "pike-backport-potential", "pki", "policy", "python3", "queens-backport-potential", "rc-potential", "revoke", "rfe", "rocky-backport-potential", "security", "sql", "system-scope", "test-improvement", "trusts", "upgrades", "user-experience", "x509"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/keystone/+bug/1202952/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/keystone"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/keystone">OpenStack Identity (keystone)</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/keystone">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/keystone">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/keystone">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/keystone">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/keystone">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/keystone">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1202952 reported by
      <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear</a>
      <time title="2013-07-19 07:17:35 UTC" datetime="2013-07-19T07:17:35.751621+00:00">on 2013-07-19</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">260</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1434967">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/keystone/+bug/1202952/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1434967">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/keystone">OpenStack Identity (keystone)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/keystone/+bug/1202952/+editstatus" style="float: left" class="value statusINVALID">Invalid</a>
          <a href="https://bugs.launchpad.net/keystone/+bug/1202952/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1434967">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1434967">
     <td colspan="7"><form action="/keystone/+bug/1202952/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/keystone">OpenStack Identity (keystone)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-07-19 07:17:35 UTC" datetime="2013-07-19T07:17:35.751621+00:00">2013-07-19</time>
      </td>
    </tr>
    
    
    
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2013-09-12 07:37:58 UTC" datetime="2013-09-12T07:37:58.112395+00:00">2013-09-12</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="keystone.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="keystone.target.option.package" name="keystone.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="keystone.target.distribution" name="keystone.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="keystone.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="keystone.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="keystone.target.package"
                         name="keystone.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;keystone.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('keystone.target.package');
              var select_menu = Y.DOM.byId('keystone.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-keystone-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionPackage", "extra_no_results_message": null, "selected_value": null, "show_assign_me_button": false, "show_widget_id": "show-widget-keystone-target-package", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "keystone.target.package"};
        var show_widget_id = 'show-widget-keystone-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="keystone.target.option.product" name="keystone.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="keystone" id="keystone.target.product"
                         name="keystone.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;keystone.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('keystone.target.product');
              var select_menu = Y.DOM.byId('keystone.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-keystone-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a project", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "Product", "extra_no_results_message": null, "selected_value": "keystone", "show_assign_me_button": false, "show_widget_id": "show-widget-keystone-target-product", "step_title": "Search", "assign_me_text": "Pick me", "input_element": "keystone.target.product"};
        var show_widget_id = 'show-widget-keystone-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="keystone.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="keystone.status" name="keystone.status" size="1" >
<option selected="selected" value="Invalid">Invalid</option>
</select>
</div>
<input name="keystone.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="keystone.assignee.assign_to_nobody" name="keystone.assignee.option" value="keystone.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="keystone.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="keystone.assignee.assign_to_me" name="keystone.assignee.option" value="keystone.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="keystone.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="keystone.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="keystone.comment_on_change" name="keystone.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1458632">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/keystone/folsom/+bug/1202952/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/keystone/folsom">Folsom</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/keystone/folsom/+bug/1202952/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/keystone/folsom/+bug/1202952/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1458632">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1458632">
     <td colspan="7"><form action="/keystone/folsom/+bug/1202952/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/keystone/folsom">OpenStack Identity (keystone) folsom</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-09-04 12:42:19 UTC" datetime="2013-09-04T12:42:19.170995+00:00">2013-09-04</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-09-04 12:42:30 UTC" datetime="2013-09-04T12:42:30.725918+00:00">2013-09-04</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-09-11 15:06:14 UTC" datetime="2013-09-11T15:06:14.212817+00:00">2013-09-11</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-06-04 23:25:21 UTC" datetime="2014-06-04T23:25:21.689041+00:00">2014-06-04</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone_folsom.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="keystone_folsom.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="keystone_folsom.status" name="keystone_folsom.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="keystone_folsom.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone_folsom.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="keystone_folsom.assignee.assign_to_nobody" name="keystone_folsom.assignee.option" value="keystone_folsom.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="keystone_folsom.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="keystone_folsom.assignee.assign_to_me" name="keystone_folsom.assignee.option" value="keystone_folsom.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="keystone_folsom.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="keystone_folsom.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="keystone_folsom.comment_on_change" name="keystone_folsom.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1458630">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/keystone/grizzly/+bug/1202952/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/keystone/grizzly">Grizzly</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/keystone/grizzly/+bug/1202952/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/keystone/grizzly/+bug/1202952/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1458630">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~mdrnstm">Morgan Fainberg</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/keystone/+milestone/2013.1.4">OpenStack Identity (keystone) 2013.1.4</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1458630">
     <td colspan="7"><form action="/keystone/grizzly/+bug/1202952/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/keystone/grizzly">OpenStack Identity (keystone) grizzly</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-09-04 12:42:04 UTC" datetime="2013-09-04T12:42:04.348450+00:00">2013-09-04</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-09-04 12:42:33 UTC" datetime="2013-09-04T12:42:33.097679+00:00">2013-09-04</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2013-10-17 19:03:14 UTC" datetime="2013-10-17T19:03:14.371325+00:00">2013-10-17</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-09-11 15:06:17 UTC" datetime="2013-09-11T15:06:17.188261+00:00">2013-09-11</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2013-10-17 19:03:33 UTC" datetime="2013-10-17T19:03:33.850741+00:00">2013-10-17</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone_grizzly.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="keystone_grizzly.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="keystone_grizzly.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="keystone_grizzly.status" name="keystone_grizzly.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="keystone_grizzly.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Identity (keystone) 2013.1.4
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone_grizzly.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="keystone_grizzly.assignee.assign_to_me" name="keystone_grizzly.assignee.option" value="keystone_grizzly.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="keystone_grizzly.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="keystone_grizzly.assignee.assigned_to" name="keystone_grizzly.assignee.option" value="keystone_grizzly.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="keystone_grizzly.assignee.assigned_to">
              Morgan Fainberg (mdrnstm)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="keystone_grizzly.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="keystone_grizzly.comment_on_change" name="keystone_grizzly.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1435147">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1202952/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1435147">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1202952/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1202952/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1435147">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ttx">Thierry Carrez</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1435147">
     <td colspan="7"><form action="/ossa/+bug/1202952/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2013-07-19 10:18:51 UTC" datetime="2013-07-19T10:18:51.112405+00:00">2013-07-19</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2013-07-29 10:18:36 UTC" datetime="2013-07-29T10:18:36.038131+00:00">2013-07-29</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2013-07-29 10:24:58 UTC" datetime="2013-07-29T10:24:58.665683+00:00">2013-07-29</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2013-08-30 14:13:13 UTC" datetime="2013-08-30T14:13:13.554589+00:00">2013-08-30</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2013-09-12 07:34:10 UTC" datetime="2013-09-12T07:34:10.066379+00:00">2013-09-12</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionPackage", "extra_no_results_message": null, "selected_value": null, "show_assign_me_button": false, "show_widget_id": "show-widget-ossa-target-package", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "ossa.target.package"};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a project", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "Product", "extra_no_results_message": null, "selected_value": "ossa", "show_assign_me_button": false, "show_widget_id": "show-widget-ossa-target-product", "step_title": "Search", "assign_me_text": "Pick me", "input_element": "ossa.target.product"};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Thierry Carrez (ttx)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/keystone/+bug/1202952/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/keystone/+bug/1202952/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/keystone/+bug/1202952/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>This is a more serious incarnation of: <a rel="nofollow" href="https://bugs.launchpad.net/keystone/+bug/1202050">https:/<wbr />/bugs.launchpad<wbr />.net/keystone/<wbr />+bug/1202050</a>.<br />
Looks to be fixed on master in c238ace30981877<wbr />e5991874c5b193e<wbr />a7d5107419 (id hashing happens keystone/<wbr />token/core.<wbr />py there).</p>
<p>In the memcache token backend, whole tokens are stored in the revocation list.</p>
<p>In keystone/<wbr />token/backends.<wbr />py:<br />
166     def _add_to_<wbr />revocation_<wbr />list(self, data):<br />
167         data_json = jsonutils.<wbr />dumps(data)<br />
168         if not self.client.<wbr />append(<wbr />self.revocation<wbr />_key, &#x27;,%s&#x27; % data_json):<br />
169             if not self.client.<wbr />add(self.<wbr />revocation_<wbr />key, data_json):<br />
170                 if not self.client.<wbr />append(<wbr />self.revocation<wbr />_key,<br />
171                                           &#x27;,%s&#x27; % data_json):<br />
172                     msg = _(&#x27;Unable to add token to revocation list.&#x27;)<br />
173                     raise exception.<wbr />UnexpectedError<wbr />(msg)<br />
174<br />
175     def delete_token(self, token_id):<br />
176         # Test for existence<br />
177         data = self.get_<wbr />token(token_<wbr />id)        &lt;----<br />
178         ptk = self._prefix_<wbr />token_id(<wbr />token_id)<br />
179         result = self.client.<wbr />delete(<wbr />ptk)<br />
180         self._add_<wbr />to_revocation_<wbr />list(data)       &lt;----<br />
181         return result</p>
<p>And returned from the API when the auth_token middleware asks for the revocation list:</p>
<p>208     def list_revoked_<wbr />tokens(<wbr />self):<br />
209         list_json = self.client.<wbr />get(self.<wbr />revocation_<wbr />key)<br />
210         if list_json:<br />
211             return jsonutils.<wbr />loads(&#x27;<wbr />[%s]&#x27; % list_json)<br />
212         return []</p>
<p>The auth_token middleware hashes the signed token and searches the revocation list for the hash:</p>
<p>1017     def is_signed_<wbr />token_revoked(<wbr />self, signed_text):<br />
1018         &quot;&quot;&quot;Indicate whether the token appears in the revocation list.&quot;&quot;&quot;<br />
1019         revocation_list = self.token_<wbr />revocation_<wbr />list<br />
1020         revoked_tokens = revocation_<wbr />list.get(<wbr />&#x27;revoked&#x27;<wbr />, [])<br />
1021         if not revoked_tokens:<br />
1022             return<br />
1023         revoked_ids = (x[&#x27;id&#x27;] for x in revoked_tokens)<br />
1024         token_id = utils.hash_<wbr />signed_<wbr />token(signed_<wbr />text)<br />
1025         for revoked_id in revoked_ids:<br />
1026             if token_id == revoked_id:<br />
1027                 self.LOG.<wbr />debug(&#x27;<wbr />Token %s is marked as having been revoked&#x27;,<br />
1028                                token_id)<br />
1029                 return True<br />
1030         return False</p>
<p>Because the memcache backend stores the entire token,  the value of x[&#x27;id&#x27;] above is not an md5 hash, but the encoded PKI token. This will never match the value of the hashed untrusted token.</p>
<p>Storing the whole token also means only around 256 tokens can stored before the memcache page is full and errors happen.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          

            <div id="bug-branches">
              <h2>Related branches</h2>

              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/quantal/keystone/quantal-security" class="sprite branch">lp:ubuntu/quantal-security/keystone</a>
  
  
</div>



              
              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/quantal/keystone/quantal-updates" class="sprite branch">lp:ubuntu/quantal-updates/keystone</a>
  
  
</div>



              
              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/raring/keystone/raring-security" class="sprite branch">lp:ubuntu/raring-security/keystone</a>
  
  
</div>



              
              
                

 

 <div class="buglink-summary">

  <a href="https://code.launchpad.net/~ubuntu-branches/ubuntu/raring/keystone/raring-updates" class="sprite branch">lp:ubuntu/raring-updates/keystone</a>
  
  
</div>



              
            </div>
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2013-4294" title="The (1) mamcache and (2) KVS token ba...">2013-4294</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T10:19:32.537829+00:00" title="2013-07-19 10:19:32 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Adding Keystone PTL for impact confirmation</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Adding Keystone PTL for impact confirmation</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ayoung" class="sprite person">Adam Young (ayoung)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T17:17:52.683039+00:00" title="2013-07-19 17:17:52 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looks legitimate.  A quick check of the code shows that we do not test the format of the revocation list for each of the backends, but merely that the ID in is the same as the revoked ID, which would mask this issue.</p>
<p>The memcached backend already has a serious and public failing in that it is not persisted over reboots.  As such, using the memcahced backend for tokens is probably a bad choice.</p>
<p>One solution to both problems would be to have the revocation list always stored in SQL.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looks legitimate.  A quick check of the code shows that we do not test the format of the revocation list for each of the backends, but merely that the ID in is the same as the revoked ID, which would mask this issue.

The memcached backend already has a serious and public failing in that it is not persisted over reboots.  As such, using the memcahced backend for tokens is probably a bad choice.

One solution to both problems would be to have the revocation list always stored in SQL.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T21:37:09.179004+00:00" title="2013-07-19 21:37:09 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m trying to follow along but I&#x27;m having to make a few assumptions documented below. Please verify!</p>
<p>First, I assume &quot;keystone/<wbr />token/backends.<wbr />py&quot; is intended to refer to &quot;keystone/<wbr />token/backends/<wbr />memcache.<wbr />py&quot;.</p>
<p>Second, all the line numbers in the code excerpts appear to refer to the current master branch (not stable/grizzly?).</p>
<p>Those two excerpts on master:</p>
<p>1.  <a rel="nofollow" href="https://github.com/openstack/keystone/blob/53ed50ddd0cdebd1b6329f47caac3c8d8b41cd7e/keystone/token/backends/memcache.py#L166-L181">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/53ed50ddd0<wbr />cdebd1b6329f47c<wbr />aac3c8d8b41cd7e<wbr />/keystone/<wbr />token/backends/<wbr />memcache.<wbr />py#L166-<wbr />L181</a></p>
<p>2. <a rel="nofollow" href="https://github.com/openstack/keystone/blob/53ed50ddd0cdebd1b6329f47caac3c8d8b41cd7e/keystone/token/backends/memcache.py#L208-L212">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/53ed50ddd0<wbr />cdebd1b6329f47c<wbr />aac3c8d8b41cd7e<wbr />/keystone/<wbr />token/backends/<wbr />memcache.<wbr />py#L208-<wbr />L212</a></p>
<p>The same two excerpts on stable/grizzly:</p>
<p>1. <a rel="nofollow" href="https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/memcache.py#L87-L102">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/76a94c68d6<wbr />21c893941a817d3<wbr />6f8ddbe9559dbde<wbr />/keystone/<wbr />token/backends/<wbr />memcache.<wbr />py#L87-<wbr />L102</a></p>
<p>2. <a rel="nofollow" href="https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/memcache.py#L129-L133">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/76a94c68d6<wbr />21c893941a817d3<wbr />6f8ddbe9559dbde<wbr />/keystone/<wbr />token/backends/<wbr />memcache.<wbr />py#L129-<wbr />L133</a></p>
<p>Anyway, attempting to reproduce on each branch results in the following responses from GET /v2.0/tokens/<wbr />revoked:</p>
<p><a rel="nofollow" href="https://gist.github.com/dolph/899226d3b774787a2ad5">https:/<wbr />/gist.github.<wbr />com/dolph/<wbr />899226d3b774787<wbr />a2ad5</a></p>
<p>So, the actual content of the response changes quite radically from the entire signed token in stable/grizzly to just a hash in master. In other words, we&#x27;ve introduced a backwards-<wbr />incompatible API change between the two branches.</p>
<p>While I would prefer to revise the client to handle both responses, we can&#x27;t guarantee that keystoneclient is the only consumer of that API. It&#x27;s not very attractive, but the only viable option I see is to revert the change in master, and publish entire signed tokens in the token revocation list.</p>
<p>I didn&#x27;t test against folsom, but it&#x27;s safe to assume that the responses from both folsom and grizzly are the same.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm trying to follow along but I'm having to make a few assumptions documented below. Please verify!

First, I assume "keystone/token/backends.py" is intended to refer to "keystone/token/backends/memcache.py".

Second, all the line numbers in the code excerpts appear to refer to the current master branch (not stable/grizzly?).

Those two excerpts on master:

1.  https://github.com/openstack/keystone/blob/53ed50ddd0cdebd1b6329f47caac3c8d8b41cd7e/keystone/token/backends/memcache.py#L166-L181

2. https://github.com/openstack/keystone/blob/53ed50ddd0cdebd1b6329f47caac3c8d8b41cd7e/keystone/token/backends/memcache.py#L208-L212

The same two excerpts on stable/grizzly:

1. https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/memcache.py#L87-L102

2. https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/memcache.py#L129-L133

Anyway, attempting to reproduce on each branch results in the following responses from GET /v2.0/tokens/revoked:

https://gist.github.com/dolph/899226d3b774787a2ad5

So, the actual content of the response changes quite radically from the entire signed token in stable/grizzly to just a hash in master. In other words, we've introduced a backwards-incompatible API change between the two branches.

While I would prefer to revise the client to handle both responses, we can't guarantee that keystoneclient is the only consumer of that API. It's not very attractive, but the only viable option I see is to revert the change in master, and publish entire signed tokens in the token revocation list.

I didn't test against folsom, but it's safe to assume that the responses from both folsom and grizzly are the same.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T21:41:51.042000+00:00" title="2013-07-19 21:41:51 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>In case something happens to the gist above, the verified responses appear as follows...</p>
<p>grizzly:</p>
<p>&nbsp;&nbsp;{&quot;revoked&quot;: [{&quot;expires&quot;: &quot;2013-07-<wbr />20T20:59:<wbr />39Z&quot;, &quot;id&quot;: &quot;--signed-<wbr />token--<wbr />&quot;}]}</p>
<p>master:</p>
<p>&nbsp;&nbsp;{&quot;revoked&quot;: [{&quot;expires&quot;: &quot;2013-07-<wbr />20T21:10:<wbr />09Z&quot;, &quot;id&quot;: &quot;--md5-<wbr />checksum-<wbr />-&quot;}]}</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">In case something happens to the gist above, the verified responses appear as follows...

grizzly:

  {"revoked": [{"expires": "2013-07-20T20:59:39Z", "id": "--signed-token--"}]}

master:

  {"revoked": [{"expires": "2013-07-20T21:10:09Z", "id": "--md5-checksum--"}]}</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear (kspear)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-19T23:54:14.549644+00:00" title="2013-07-19 23:54:14 UTC">on 2013-07-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Dolph, obviously my delivery could use some work... The code excerpts were taken before I realised the auth_token issue didn&#x27;t affect master.</p>
<p>Regarding the breaking API change, note that the SQL backend in stable/grizzly has always only stored the md5 checksum in the token id:<br />
<a rel="nofollow" href="https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/sql.py#L64">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/76a94c68d6<wbr />21c893941a817d3<wbr />6f8ddbe9559dbde<wbr />/keystone/<wbr />token/backends/<wbr />sql.py#<wbr />L64</a><br />
<a rel="nofollow" href="https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/sql.py#L161">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/76a94c68d6<wbr />21c893941a817d3<wbr />6f8ddbe9559dbde<wbr />/keystone/<wbr />token/backends/<wbr />sql.py#<wbr />L161</a></p>
<p>So in Grizzly just switching backends also changes the content of the revocation list.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Dolph, obviously my delivery could use some work... The code excerpts were taken before I realised the auth_token issue didn't affect master.

Regarding the breaking API change, note that the SQL backend in stable/grizzly has always only stored the md5 checksum in the token id:
https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/sql.py#L64
https://github.com/openstack/keystone/blob/76a94c68d621c893941a817d36f8ddbe9559dbde/keystone/token/backends/sql.py#L161

So in Grizzly just switching backends also changes the content of the revocation list.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-20T01:38:47.741883+00:00" title="2013-07-20 01:38:47 UTC">on 2013-07-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ah, I didn&#x27;t even think to switch to the memcache driver in either of my tests... I used the default config in both cases. So the above reflects the KVS driver in grizzly, and the SQL driver in master.</p>
<p>This is going to be a mess to clean up... but, I&#x27;m now thinking we should handle both variations in auth_token as an immediate security fix, and then work out exactly which drivers in which branches are producing hashes before changing any of them.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ah, I didn't even think to switch to the memcache driver in either of my tests... I used the default config in both cases. So the above reflects the KVS driver in grizzly, and the SQL driver in master.

This is going to be a mess to clean up... but, I'm now thinking we should handle both variations in auth_token as an immediate security fix, and then work out exactly which drivers in which branches are producing hashes before changing any of them.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ayoung" class="sprite person">Adam Young (ayoung)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-22T16:35:25.801016+00:00" title="2013-07-22 16:35:25 UTC">on 2013-07-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3745634/+files/keystone-ayoung-0007-Memcached-revocation-list-hashed-Id.patch">keystone-ayoung-0007-Memcached-revocation-list-hashed-Id.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3745634">Edit</a>
        (1.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>With the applied patch, you can see the revocation list in memcached:</p>
<p>ran devstack, killed keystone server, modified /etc/keystone/<wbr />keystone.<wbr />conf with</p>
<p>[token]<br />
driver = keystone.<wbr />token.backends.<wbr />memcache.<wbr />Token<br />
#driver = keystone.<wbr />token.backends.<wbr />sql.Token</p>
<p>service start memcached</p>
<p>restarted keystone server</p>
<p>sourced openrc</p>
<p>as demo user, created a bunch of tokens using cli token-get</p>
<p>export OS_USERNAME=admin<br />
export ADMINTOKEN=`  keystone token-get | awk &#x27;/ id /{print $4}&#x27;`</p>
<p>deleted a bunch of tokens  using:<br />
curl -X DELETE  -H &quot;X-Auth-<wbr />Token:$<wbr />ADMINTOKEN&quot; <a rel="nofollow" href="http://localhost:35357/v2.0/tokens/$USERTOKEN">http://<wbr />localhost:<wbr />35357/v2.<wbr />0/tokens/<wbr />$USERTOKEN</a></p>
<p>ran the following code in the python interpreter</p>
<p>import memcache<br />
memcache_client = memcache.<wbr />Client(<wbr />[&#x27;localhost&#x27;<wbr />],debug=<wbr />0)<br />
memcache_<wbr />client.<wbr />get(revocation_<wbr />key)</p>
<p>output looks like this:</p>
<p>&#x27;{&quot;id&quot;: &quot;83d677322322fc<wbr />279a6a11c9c7474<wbr />cb3&quot;},{<wbr />&quot;id&quot;: &quot;089dfcc4e55f96<wbr />301d3d19beb6634<wbr />35d&quot;},{<wbr />&quot;id&quot;: &quot;36851e53e0027b<wbr />f55c32b12a898b2<wbr />950&quot;}&#x27;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">With the applied patch, you can see the revocation list in memcached:

ran devstack, killed keystone server, modified /etc/keystone/keystone.conf with

[token]
driver = keystone.token.backends.memcache.Token
#driver = keystone.token.backends.sql.Token

service start memcached

restarted keystone server

sourced openrc 

as demo user, created a bunch of tokens using cli token-get

export OS_USERNAME=admin
export ADMINTOKEN=`  keystone token-get | awk '/ id /{print $4}'`

deleted a bunch of tokens  using:
curl -X DELETE  -H "X-Auth-Token:$ADMINTOKEN" http://localhost:35357/v2.0/tokens/$USERTOKEN


ran the following code in the python interpreter

import memcache
memcache_client = memcache.Client(['localhost'],debug=0)
memcache_client.get(revocation_key)

output looks like this:

'{"id": "83d677322322fc279a6a11c9c7474cb3"},{"id": "089dfcc4e55f96301d3d19beb663435d"},{"id": "36851e53e0027bf55c32b12a898b2950"}'</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear (kspear)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-23T01:10:25.553201+00:00" title="2013-07-23 01:10:25 UTC">on 2013-07-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think some of the higher up code expects the &#x27;expires&#x27; key in the revocation list dicts when the list is requested. Fix looks good to me otherwise.</p>
<p>Looks like the KVS backend is fixed on master:<br />
<a rel="nofollow" href="https://github.com/openstack/keystone/commit/efc30beab10faf4720a96322adb135726662b025#L1R46">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />commit/<wbr />efc30beab10faf4<wbr />720a96322adb135<wbr />726662b025#<wbr />L1R46</a><br />
Date:   Wed May 8 10:51:27 2013 +1000</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think some of the higher up code expects the 'expires' key in the revocation list dicts when the list is requested. Fix looks good to me otherwise.

Looks like the KVS backend is fixed on master:
https://github.com/openstack/keystone/commit/efc30beab10faf4720a96322adb135726662b025#L1R46
Date:   Wed May 8 10:51:27 2013 +1000
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-07-29T10:18:35.194569+00:00" title="2013-07-29 10:18:35 UTC">on 2013-07-29</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looks like this will need an OSSA in all cases.</p>
<p>If I understand the comments correctly, the issue is that the server in some cases (grizzly/memcache at least, not sure about others... please re-precise) returns full token instead of token id in the check, which breaks Keystone middleware revocation.</p>
<p>If that&#x27;s correct, I suppose we could fix it directly on the server side because it&#x27;s a bit unlikely that another client would have relied on that wrong answer.. The alternative is to not fix it in Grizzly, support both forms in the middleware/client side and introduce the fix only in Havana...</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looks like this will need an OSSA in all cases.

If I understand the comments correctly, the issue is that the server in some cases (grizzly/memcache at least, not sure about others... please re-precise) returns full token instead of token id in the check, which breaks Keystone middleware revocation.

If that's correct, I suppose we could fix it directly on the server side because it's a bit unlikely that another client would have relied on that wrong answer.. The alternative is to not fix it in Grizzly, support both forms in the middleware/client side and introduce the fix only in Havana...</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-07-29 10:24:58 UTC" datetime="2013-07-29T10:24:58.274971+00:00">on 2013-07-29</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Thierry Carrez (ttx)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-01T13:13:49.288780+00:00" title="2013-08-01 13:13:49 UTC">on 2013-08-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Dolph, Adam: is only grizzly/memcache affected ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Dolph, Adam: is only grizzly/memcache affected ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ayoung" class="sprite person">Adam Young (ayoung)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-08T15:52:32.545284+00:00" title="2013-08-08 15:52:32 UTC">on 2013-08-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>All memcache token incarnations for PKI tokens are affected.  Since that code went in back in Folsom, that means Folsom, Grizzly and Havana.</p>
<p>The fix is a server side fix.  We could also fix using the auth_token middleware, but that is probably suboptimal.  It will slow down the revocation check, and it would require updating every component in an OS deployment.  Server side fix is preferable and proper.</p>
<p>Deploying the fix will dump the revocation list, but since it was not checked before, it will be no worse than it was.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">All memcache token incarnations for PKI tokens are affected.  Since that code went in back in Folsom, that means Folsom, Grizzly and Havana.

The fix is a server side fix.  We could also fix using the auth_token middleware, but that is probably suboptimal.  It will slow down the revocation check, and it would require updating every component in an OS deployment.  Server side fix is preferable and proper.

Deploying the fix will dump the revocation list, but since it was not checked before, it will be no worse than it was.  </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-09T12:45:26.500379+00:00" title="2013-08-09 12:45:26 UTC">on 2013-08-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Keystone core, please review proposed patch !<br />
Kieran: should we credit a company in addition to your name ?<br />
My understanding is that only the memcache backend is affected in master... but what about Folsom/Grizzly ? Is the KVS backend affected there ? Comments are contradictory :)</p>
<p>Proposed impact description, please review:<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====<br />
Title: Token revocation failure when using Keystone memcache backend<br />
Reporter: Kieran Spear ($COMPANY)<br />
Products: Keystone<br />
Affects: Folsom and later</p>
<p>Description:<br />
Kieran Spear from $COMPANY reported a vulnerability in Keystone memcache token backend. The memcache token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked tokens still being considered valid. Only Keystone setups making use of the memcache token backend are affected.<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Keystone core, please review proposed patch !
Kieran: should we credit a company in addition to your name ?
My understanding is that only the memcache backend is affected in master... but what about Folsom/Grizzly ? Is the KVS backend affected there ? Comments are contradictory :)

Proposed impact description, please review:
=================================
Title: Token revocation failure when using Keystone memcache backend
Reporter: Kieran Spear ($COMPANY)
Products: Keystone
Affects: Folsom and later

Description:
Kieran Spear from $COMPANY reported a vulnerability in Keystone memcache token backend. The memcache token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked tokens still being considered valid. Only Keystone setups making use of the memcache token backend are affected.
=================================</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-10T02:37:51.742468+00:00" title="2013-08-10 02:37:51 UTC">on 2013-08-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;d still like to test each branch &amp; token backend at the API level, but at first glance, it appears that ayoung&#x27;s fix wouldn&#x27;t produce the expected API response as Kieran cites (missing the &quot;expires&quot; attribute for each token).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'd still like to test each branch &amp; token backend at the API level, but at first glance, it appears that ayoung's fix wouldn't produce the expected API response as Kieran cites (missing the "expires" attribute for each token).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-12T16:20:55.903481+00:00" title="2013-08-12 16:20:55 UTC">on 2013-08-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Affected:</p>
<p>&nbsp;&nbsp;master + memcache token driver<br />
&nbsp;&nbsp;stable/grizzly + kvs token driver<br />
&nbsp;&nbsp;stable/grizzly + memcache token driver<br />
&nbsp;&nbsp;stable/folsom + kvs token driver</p>
<p>Not affected (ID attribute is at least a predictable MD5 hex digest):</p>
<p>&nbsp;&nbsp;master + kvs token driver<br />
&nbsp;&nbsp;master + sql token driver<br />
&nbsp;&nbsp;stable/grizzly + sql token driver<br />
&nbsp;&nbsp;stable/folsom + sql token driver</p>
<p>Untestable / completely broken due to MemcachedKeyLen<wbr />gthError:</p>
<p>&nbsp;&nbsp;stable/folsom + memcache token driver<br />
&nbsp;&nbsp;&nbsp;&nbsp;backtrace: <a rel="nofollow" href="https://gist.github.com/dolph/899226d3b774787a2ad5#file-folsom-memcache-500">https:/<wbr />/gist.github.<wbr />com/dolph/<wbr />899226d3b774787<wbr />a2ad5#file-<wbr />folsom-<wbr />memcache-<wbr />500</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Affected:

  master + memcache token driver
  stable/grizzly + kvs token driver
  stable/grizzly + memcache token driver
  stable/folsom + kvs token driver

Not affected (ID attribute is at least a predictable MD5 hex digest):

  master + kvs token driver
  master + sql token driver
  stable/grizzly + sql token driver
  stable/folsom + sql token driver

Untestable / completely broken due to MemcachedKeyLengthError:

  stable/folsom + memcache token driver
    backtrace: https://gist.github.com/dolph/899226d3b774787a2ad5#file-folsom-memcache-500</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-12T16:27:01.633576+00:00" title="2013-08-12 16:27:01 UTC">on 2013-08-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sample API responses of the above branch/driver combinations: <a rel="nofollow" href="https://gist.github.com/dolph/899226d3b774787a2ad5#file-notes">https:/<wbr />/gist.github.<wbr />com/dolph/<wbr />899226d3b774787<wbr />a2ad5#file-<wbr />notes</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sample API responses of the above branch/driver combinations: https://gist.github.com/dolph/899226d3b774787a2ad5#file-notes</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear (kspear)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-13T04:03:23.967586+00:00" title="2013-08-13 04:03:23 UTC">on 2013-08-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>COMPANY = &#x27;[the] University of Melbourne&#x27;</p>
<p>Nice analysis, Dolph. That matches my understanding of the state of things from digging through the code.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">COMPANY = '[the] University of Melbourne'

Nice analysis, Dolph. That matches my understanding of the state of things from digging through the code.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-13T19:29:09.918516+00:00" title="2013-08-13 19:29:09 UTC">on 2013-08-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>New proposed impact description, please review:<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====<br />
Title: Token revocation failure using Keystone memcache/KVS backends<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: Keystone<br />
Affects: Folsom and later</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone memcache and KVS token backends. The token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked tokens still being considered valid. Only Keystone setups making use of the memcache token backend (using Grizzly and later) and KVS token backend (using Folsom and Grizzly only, master branch is already fixed) are affected. The SQL token backend is unaffected.<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">New proposed impact description, please review:
=================================
Title: Token revocation failure using Keystone memcache/KVS backends
Reporter: Kieran Spear (University of Melbourne)
Products: Keystone
Affects: Folsom and later

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone memcache and KVS token backends. The token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked tokens still being considered valid. Only Keystone setups making use of the memcache token backend (using Grizzly and later) and KVS token backend (using Folsom and Grizzly only, master branch is already fixed) are affected. The SQL token backend is unaffected.
=================================</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-13T20:11:42.918873+00:00" title="2013-08-13 20:11:42 UTC">on 2013-08-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Regarding impact description: deployments using UUID tokens are not affected, only those using PKI tokens (`keystone.conf [signing] token_format = PKI`).</p>
<p>`UUID` is the default format in stable/folsom and `PKI` is the default in stable/grizzly. In master, `token_format` is deprecated in favor of `keystone.conf [token] provider`.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Regarding impact description: deployments using UUID tokens are not affected, only those using PKI tokens (`keystone.conf [signing] token_format = PKI`).

`UUID` is the default format in stable/folsom and `PKI` is the default in stable/grizzly. In master, `token_format` is deprecated in favor of `keystone.conf [token] provider`.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-14T17:32:01.079006+00:00" title="2013-08-14 17:32:01 UTC">on 2013-08-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>How about this ?</p>
<p>=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====<br />
Title: Token revocation failure using Keystone memcache/KVS backends<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: Keystone<br />
Affects: Folsom and later</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone memcache and KVS token backends. The PKI token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked PKI tokens still being considered valid. Only Keystone setups making use of PKI tokens with the memcache token backend (using Grizzly and later) and KVS token backend (using Folsom and Grizzly only, master branch is already fixed) are affected. Setups using UUID tokens, or using PKI tokens with the SQL token backend, are unaffected.<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">How about this ?

=================================
Title: Token revocation failure using Keystone memcache/KVS backends
Reporter: Kieran Spear (University of Melbourne)
Products: Keystone
Affects: Folsom and later

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone memcache and KVS token backends. The PKI token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked PKI tokens still being considered valid. Only Keystone setups making use of PKI tokens with the memcache token backend (using Grizzly and later) and KVS token backend (using Folsom and Grizzly only, master branch is already fixed) are affected. Setups using UUID tokens, or using PKI tokens with the SQL token backend, are unaffected.
=================================</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-14T18:12:56.396048+00:00" title="2013-08-14 18:12:56 UTC">on 2013-08-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thierry&#x27;s proposed impact description in comment #19 looks good to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thierry's proposed impact description in comment #19 looks good to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-15T12:32:11.099504+00:00" title="2013-08-15 12:32:11 UTC">on 2013-08-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Keystone core: Could we get a review on Adam&#x27;s patch ?<br />
Anyone up for the Grizzly and Folsom backports ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Keystone core: Could we get a review on Adam's patch ?
Anyone up for the Grizzly and Folsom backports ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-19T19:03:42.728507+00:00" title="2013-08-19 19:03:42 UTC">on 2013-08-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>impact description looks great</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">impact description looks great</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T02:13:13.618632+00:00" title="2013-08-20 02:13:13 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3778662/+files/bug-1202952-master-v1-tests.patch">bug-1202952-master-v1-tests.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3778662">Edit</a>
        (1.7 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Attaching patches that only include automated tests to reproduce. These are my results with these tests, which differ from my analysis done by hand above (differences noted in parens).</p>
<p>Affected:</p>
<p>&nbsp;&nbsp;stable/grizzly + kvs token driver<br />
&nbsp;&nbsp;stable/grizzly + sql token driver (previously not affected)<br />
&nbsp;&nbsp;stable/grizzly + memcache token driver<br />
&nbsp;&nbsp;stable/folsom + kvs token driver<br />
&nbsp;&nbsp;stable/folsom + memcache token driver (previously untestable)</p>
<p>Not affected:</p>
<p>&nbsp;&nbsp;master + kvs token driver<br />
&nbsp;&nbsp;master + sql token driver<br />
&nbsp;&nbsp;master + memcache token driver (previously affected)<br />
&nbsp;&nbsp;stable/grizzly + sql token driver</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Attaching patches that only include automated tests to reproduce. These are my results with these tests, which differ from my analysis done by hand above (differences noted in parens).

Affected:

  stable/grizzly + kvs token driver
  stable/grizzly + sql token driver (previously not affected)
  stable/grizzly + memcache token driver
  stable/folsom + kvs token driver
  stable/folsom + memcache token driver (previously untestable)

Not affected:

  master + kvs token driver
  master + sql token driver
  master + memcache token driver (previously affected)
  stable/grizzly + sql token driver</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T02:13:36.671648+00:00" title="2013-08-20 02:13:36 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3778663/+files/bug-1202952-grizzly-v1-tests.patch">bug-1202952-grizzly-v1-tests.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3778663">Edit</a>
        (1.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T02:13:50.881266+00:00" title="2013-08-20 02:13:50 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3778664/+files/bug-1202952-master-v1-tests.patch">bug-1202952-master-v1-tests.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3778664">Edit</a>
        (1.7 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T13:04:46.866824+00:00" title="2013-08-20 13:04:46 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Dolph: &quot;stable/grizzly + sql token driver&quot; is listed in both the &quot;Affected&quot; and &quot;Not affected&quot; lists ? What about &quot;stable/folsom + sql token driver&quot; ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Dolph: "stable/grizzly + sql token driver" is listed in both the "Affected" and "Not affected" lists ? What about "stable/folsom + sql token driver" ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T15:16:39.339202+00:00" title="2013-08-20 15:16:39 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>My mistake!</p>
<p>stable/grizzly + sql token driver IS affected.<br />
stable/folsom + sql token driver is NOT affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">My mistake!

stable/grizzly + sql token driver IS affected.
stable/folsom + sql token driver is NOT affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T15:31:00.228698+00:00" title="2013-08-20 15:31:00 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3779470/+files/bug-1202952-folsom-v1.patch">bug-1202952-folsom-v1.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3779470">Edit</a>
        (4.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix for stable/folsom memcache and kvs is attached, with tests from above.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix for stable/folsom memcache and kvs is attached, with tests from above.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T16:18:57.770991+00:00" title="2013-08-20 16:18:57 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3779480/+files/bug-1202952-grizzly-v1.patch">bug-1202952-grizzly-v1.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3779480">Edit</a>
        (4.0 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix for stable/grizzly memcache and kvs is attached, with a slightly modified version of the tests from above (see inline comment).</p>
<p>With the modified tests, stable/grizzly + sql token driver does NOT appear to be affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix for stable/grizzly memcache and kvs is attached, with a slightly modified version of the tests from above (see inline comment).

With the modified tests, stable/grizzly + sql token driver does NOT appear to be affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-20T16:38:41.682355+00:00" title="2013-08-20 16:38:41 UTC">on 2013-08-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Final list of affected branches / drivers:</p>
<p>&nbsp;&nbsp;stable/grizzly + kvs token driver<br />
&nbsp;&nbsp;stable/grizzly + memcache token driver<br />
&nbsp;&nbsp;stable/folsom + kvs token driver<br />
&nbsp;&nbsp;stable/folsom + memcache token driver</p>
<p>I originally had marked &quot;master + memcache token driver&quot; as &quot;affected&quot; because it returns a relatively bloated API response (as the other failing implementations do), however the response itself does not present a vulnerability because the &quot;id&quot; values are MD5-hashed as expected.</p>
<p>As far as I can tell, this API has never been previously documented or tested at all, hence the inconsistencies in implementation.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Final list of affected branches / drivers:

  stable/grizzly + kvs token driver
  stable/grizzly + memcache token driver
  stable/folsom + kvs token driver
  stable/folsom + memcache token driver

I originally had marked "master + memcache token driver" as "affected" because it returns a relatively bloated API response (as the other failing implementations do), however the response itself does not present a vulnerability because the "id" values are MD5-hashed as expected.

As far as I can tell, this API has never been previously documented or tested at all, hence the inconsistencies in implementation.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-21T18:53:39.348334+00:00" title="2013-08-21 18:53:39 UTC">on 2013-08-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>New revision:</p>
<p>=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====<br />
Title: Token revocation failure using Keystone memcache/KVS backends<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: Keystone<br />
Affects: Folsom, Grizzly</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone memcache and KVS token backends. The PKI token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked PKI tokens still being considered valid. Only Folsom and Grizzly Keystone setups making use of PKI tokens with the memcache or KVS token backends are affected. Havana setups, setups using UUID tokens, or setups using PKI tokens with the SQL token backend are all unaffected.<br />
=======<wbr />=======<wbr />=======<wbr />=======<wbr />=====</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">New revision:

=================================
Title: Token revocation failure using Keystone memcache/KVS backends
Reporter: Kieran Spear (University of Melbourne)
Products: Keystone
Affects: Folsom, Grizzly

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone memcache and KVS token backends. The PKI token revocation lists stored the entire token instead of the token ID, triggering comparison failures, ultimately resulting in revoked PKI tokens still being considered valid. Only Folsom and Grizzly Keystone setups making use of PKI tokens with the memcache or KVS token backends are affected. Havana setups, setups using UUID tokens, or setups using PKI tokens with the SQL token backend are all unaffected.
=================================</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-21T19:12:18.657499+00:00" title="2013-08-21 19:12:18 UTC">on 2013-08-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 for impact; definitely easier to understand which branches are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 for impact; definitely easier to understand which branches are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T09:44:25.077837+00:00" title="2013-08-22 09:44:25 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Running through the folsom patch from #29, it looks like memcache fix was not adding in the &quot;expired&quot; field, which would cause list_revoked_tokens to fail.</p>
<p>Attached is a fix based upon patch from #29 with added functionality to handle adding &#x27;expires&#x27; into the revocation-list (per token) in the memcache token driver.  Updated new tests to verify token_id and expires both are in each element of the revocation_list.  Updated TokenTests.<wbr />test_token_<wbr />crud to avoid stripping &quot;expired&quot; fields from tokens in fake-memcache server, ensuring tests will now complete.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Running through the folsom patch from #29, it looks like memcache fix was not adding in the "expired" field, which would cause list_revoked_tokens to fail.  

Attached is a fix based upon patch from #29 with added functionality to handle adding 'expires' into the revocation-list (per token) in the memcache token driver.  Updated new tests to verify token_id and expires both are in each element of the revocation_list.  Updated TokenTests.test_token_crud to avoid stripping "expired" fields from tokens in fake-memcache server, ensuring tests will now complete.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T09:57:55.531290+00:00" title="2013-08-22 09:57:55 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3782210/+files/bug-1202952-folsom-v2.patch">bug-1202952-folsom-v2.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3782210">Edit</a>
        (5.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Attaching correct patch file (for #33).  This one should work for python2.6 as well.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Attaching correct patch file (for #33).  This one should work for python2.6 as well.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T10:20:03.622312+00:00" title="2013-08-22 10:20:03 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Correction on post #33/#34, the patch is based upon the Folsom patch in post #28.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Correction on post #33/#34, the patch is based upon the Folsom patch in post #28.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T18:12:59.814723+00:00" title="2013-08-22 18:12:59 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 for revisions on folsom patch</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 for revisions on folsom patch</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T20:15:36.809574+00:00" title="2013-08-22 20:15:36 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So, to summarize... our patches for this are posted at:<br />
master (havana): comment 7<br />
grizzly: comment 29<br />
folsom: comment 34</p>
<p>keystone-core please confirm and +2 proposed patches !</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So, to summarize... our patches for this are posted at:
master (havana): comment 7
grizzly: comment 29
folsom: comment 34

keystone-core please confirm and +2 proposed patches !</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T21:00:18.867057+00:00" title="2013-08-22 21:00:18 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I am performing the same changes for the grizzly patch (and should be done shortly) to correct the same bugs in folsom.</p>
<p>Grizzly patch will not succeed gate because of <a rel="nofollow" href="https://bugs.launchpad.net/keystone/+bug/1212939">https:/<wbr />/bugs.launchpad<wbr />.net/keystone/<wbr />+bug/1212939</a>.  In regards to <a href="/bugs/1212939" class="bug-link">bug 1212939</a>, the quickest solution would be to include netaddr in the test-requirements with the grizzly patch, but it doesn&#x27;t resolve the bug the &quot;right&quot; way.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I am performing the same changes for the grizzly patch (and should be done shortly) to correct the same bugs in folsom. 

Grizzly patch will not succeed gate because of https://bugs.launchpad.net/keystone/+bug/1212939.  In regards to bug 1212939, the quickest solution would be to include netaddr in the test-requirements with the grizzly patch, but it doesn't resolve the bug the "right" way.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T21:06:55.430860+00:00" title="2013-08-22 21:06:55 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Grizzly - <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-grizzly-v1.patch from comment #29<br />
- unit tests worked - Ran 1306 tests in 2467.505s<br />
- visual inspection looks good<br />
= +2</p>
<p>Folsom <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-folsom-v2.patch from comment #34<br />
- run unit tests - Ran 709 tests in 411.905s - a couple of s3token tests failed but I don&#x27;t know why, they also fail without the patch<br />
- visual inspection looks good<br />
= +2</p>
<p>The master patch from comment #7 didn&#x27;t apply.<br />
error: patch failed: keystone/<wbr />token/backends/<wbr />memcache.<wbr />py:174<br />
error: keystone/<wbr />token/backends/<wbr />memcache.<wbr />py: patch does not apply</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Grizzly - bug-1202952-grizzly-v1.patch from comment #29
- unit tests worked - Ran 1306 tests in 2467.505s
- visual inspection looks good
= +2

Folsom bug-1202952-folsom-v2.patch from comment #34
- run unit tests - Ran 709 tests in 411.905s - a couple of s3token tests failed but I don't know why, they also fail without the patch
- visual inspection looks good
= +2

The master patch from comment #7 didn't apply.
error: patch failed: keystone/token/backends/memcache.py:174
error: keystone/token/backends/memcache.py: patch does not apply
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T21:09:15.982148+00:00" title="2013-08-22 21:09:15 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3783218/+files/bug-1202952-grizzly-v2.patch">bug-1202952-grizzly-v2.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3783218">Edit</a>
        (5.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fixed grizzly patch attached, same functional issues corrected as in patch from #34.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fixed grizzly patch attached, same functional issues corrected as in patch from #34.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-22T21:56:24.590177+00:00" title="2013-08-22 21:56:24 UTC">on 2013-08-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Folsom - <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-folsom-v2.patch from comment #34<br />
- unit tests worked - Ran 709 tests in 44.883s<br />
- visual inspection looks good<br />
- verified functionally in devstack<br />
= abstain since I provided updated patch (+2 if this doesn&#x27;t matter)</p>
<p>Grizzly - <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-grizzly-v1.patch from comment #29<br />
- unit tests worked - Ran 1306 tests in 191.340s<br />
- visual inspection - missing expires field in revocation list in memcache driver<br />
- fails functionally in devstack (memcache driver causes exception in building revocation_list due to missing &#x27;expires&#x27; key/element in the elements in the revocation_list)<br />
= -2 (do not merge)</p>
<p>Updated grizzly <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-grizzly-v2.patch from comment #41<br />
- Units test pass with the addition of netaddr in vnenv - Ran 1306 tests in 192.625s<br />
- visual inspection looks good<br />
- verified functionally in devstack (no exceptions)<br />
= abstain since I provided updated patch (+2 if this doesn&#x27;t matter)</p>
<p>Master patch from #7 does not apply.<br />
error: patch failed: keystone/<wbr />token/backends/<wbr />memcache.<wbr />py:174<br />
error: keystone/<wbr />token/backends/<wbr />memcache.<wbr />py: patch does not apply<br />
- Patch from #7, while beneficial is not required for this bug.  Master is not affected by the security bug.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Folsom - bug-1202952-folsom-v2.patch from comment #34
- unit tests worked - Ran 709 tests in 44.883s
- visual inspection looks good
- verified functionally in devstack
= abstain since I provided updated patch (+2 if this doesn't matter)

Grizzly - bug-1202952-grizzly-v1.patch from comment #29
- unit tests worked - Ran 1306 tests in 191.340s
- visual inspection - missing expires field in revocation list in memcache driver
- fails functionally in devstack (memcache driver causes exception in building revocation_list due to missing 'expires' key/element in the elements in the revocation_list)
= -2 (do not merge)

Updated grizzly bug-1202952-grizzly-v2.patch from comment #41
- Units test pass with the addition of netaddr in vnenv - Ran 1306 tests in 192.625s
- visual inspection looks good
- verified functionally in devstack (no exceptions)
= abstain since I provided updated patch (+2 if this doesn't matter)

Master patch from #7 does not apply.
error: patch failed: keystone/token/backends/memcache.py:174
error: keystone/token/backends/memcache.py: patch does not apply
- Patch from #7, while beneficial is not required for this bug.  Master is not affected by the security bug.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T13:31:38.485248+00:00" title="2013-08-23 13:31:38 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 for revisions on grizzly patch in comment #41</p>
<p>tests for master can be corrected in gerrit publicly after folsom &amp; grizzly patches are released</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 for revisions on grizzly patch in comment #41

tests for master can be corrected in gerrit publicly after folsom &amp; grizzly patches are released</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T15:41:59.643887+00:00" title="2013-08-23 15:41:59 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Question on the grizzly patch v2 from comment #41 --</p>
<p>in token/backends/<wbr />memcache.<wbr />py, at line 99 do<br />
&nbsp;token_id = token.unique_<wbr />id(token_<wbr />id)<br />
then at line 101<br />
&nbsp;ptk = self._prefix_<wbr />token_id(<wbr />token.unique_<wbr />id(token_<wbr />id))</p>
<p>so now token_id has had token.unique_id() applied twice when passed to self._prefix_<wbr />token_id(<wbr />). Seems strange would need to double-apply an operation, so wondering if this is intentional.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Question on the grizzly patch v2 from comment #41 --

in token/backends/memcache.py, at line 99 do
 token_id = token.unique_id(token_id)
then at line 101
 ptk = self._prefix_token_id(token.unique_id(token_id))

so now token_id has had token.unique_id() applied twice when passed to self._prefix_token_id(). Seems strange would need to double-apply an operation, so wondering if this is intentional.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T17:48:52.720750+00:00" title="2013-08-23 17:48:52 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Brant: It appears to be un-intentional, but shouldn&#x27;t hurt anything as the cms.hash_token function does validation before rehashing.  This is a flaw in both versions of both patches (grizzly and folsom).  It can be removed if it&#x27;s a big concern and  I&#x27;ll run through the tests and post &#x27;v3&#x27;s of each with the modification if needed.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Brant: It appears to be un-intentional, but shouldn't hurt anything as the cms.hash_token function does validation before rehashing.  This is a flaw in both versions of both patches (grizzly and folsom).  It can be removed if it's a big concern and  I'll run through the tests and post 'v3's of each with the modification if needed.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T17:52:49.988049+00:00" title="2013-08-23 17:52:49 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Morgan - please fix it since it looks incorrect, and I&#x27;d be worried about somebody changing the unique_id function expecting nobody&#x27;s applying it twice.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Morgan - please fix it since it looks incorrect, and I'd be worried about somebody changing the unique_id function expecting nobody's applying it twice.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/47" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T20:27:58.323218+00:00" title="2013-08-23 20:27:58 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/47"> #47</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>No problem, I&#x27;ll roll the changes and get them posted here shortly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">No problem, I'll roll the changes and get them posted here shortly.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/48" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T21:51:38.875386+00:00" title="2013-08-23 21:51:38 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/48"> #48</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3784963/+files/bug-1202952-folsom-v3.patch">bug-1202952-folsom-v3.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3784963">Edit</a>
        (5.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Folsom update covering Brant&#x27;s concern.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Folsom update covering Brant's concern.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/49" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdrnstm" class="sprite person">Morgan Fainberg (mdrnstm)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T22:07:17.607358+00:00" title="2013-08-23 22:07:17 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/49"> #49</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3785020/+files/bug-1202952-grizzly-v3.patch">bug-1202952-grizzly-v3.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1202952/+attachment/3785020">Edit</a>
        (5.6 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Grizzly update covering Brant&#x27;s concern.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Grizzly update covering Brant's concern.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/50" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T23:26:05.369770+00:00" title="2013-08-23 23:26:05 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/50"> #50</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Grizzly - <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-grizzly-v3.patch from comment #49<br />
- unit tests worked - Ran 1306 tests in 2366.276s<br />
- visual inspection looks good, my comment was addressed<br />
= +2</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Grizzly - bug-1202952-grizzly-v3.patch from comment #49
- unit tests worked - Ran 1306 tests in 2366.276s
- visual inspection looks good, my comment was addressed
= +2
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/51" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-23T23:42:01.894715+00:00" title="2013-08-23 23:42:01 UTC">on 2013-08-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/51"> #51</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Folsom - <a href="/bugs/1202952" class="bug-link">bug-1202952</a>-folsom-v3.patch  in comment #48<br />
- unit tests worked - Ran 709 tests in 412.283s<br />
- visual inspection looks good, my comment was addressed<br />
= +2</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Folsom - bug-1202952-folsom-v3.patch  in comment #48
- unit tests worked - Ran 709 tests in 412.283s
- visual inspection looks good, my comment was addressed
= +2</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/52" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-26T18:18:48.769323+00:00" title="2013-08-26 18:18:48 UTC">on 2013-08-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/52"> #52</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+2 for revised patches in comments #48 and #49</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+2 for revised patches in comments #48 and #49</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/53" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-08-30T14:12:50.258270+00:00" title="2013-08-30 14:12:50 UTC">on 2013-08-30</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/53"> #53</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This should be good to go with the patches in comments #48 and #49.<br />
Requesting CVE.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This should be good to go with the patches in comments #48 and #49.
Requesting CVE.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/54" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-09-04T12:41:40.773036+00:00" title="2013-09-04 12:41:40 UTC">on 2013-09-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/54"> #54</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>CVE: CVE-2013-4294</p>
<p>Proposed public disclosure date/time: Wednesday, September 11, 1500UTC.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">CVE: CVE-2013-4294

Proposed public disclosure date/time: Wednesday, September 11, 1500UTC. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>no longer affects</b>:
      </td>
      <td>
        keystone/havana
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Invalid
      </td>
    </tr>
  
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>no longer affects</b>:
      </td>
      <td>
        python-keystoneclient
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        High &#8594; Undecided
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2013-09-11 15:00:48 UTC" datetime="2013-09-11T15:00:48.462400+00:00">on 2013-09-11</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/55" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-09-11T15:06:03.964414+00:00" title="2013-09-11 15:06:03 UTC">on 2013-09-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/55"> #55</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Folsom @ <a rel="nofollow" href="https://review.openstack.org/#/c/46079/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />46079/</a><br />
Grizzly @ <a rel="nofollow" href="https://review.openstack.org/#/c/46080/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />46080/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Folsom @ https://review.openstack.org/#/c/46079/
Grizzly @ https://review.openstack.org/#/c/46080/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/56" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-09-11T15:48:22.960856+00:00" title="2013-09-11 15:48:22 UTC">on 2013-09-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/56"> #56</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>[OSSA 2013-025]</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">[OSSA 2013-025]</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - PKI tokens are never revoked using memcache token backend<br />+ [OSSA 2013-025] PKI tokens are never revoked using memcache token<br />+ backend (CVE-2013-4294)
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/57" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-09-11T16:56:26.518733+00:00" title="2013-09-11 16:56:26 UTC">on 2013-09-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/57"> #57</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Opening against master to forward port tests.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Opening against master to forward port tests.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Invalid &#8594; Triaged
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Wishlist
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1202952/comments/58" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2013-09-12T07:37:55.607496+00:00" title="2013-09-12 07:37:55 UTC">on 2013-09-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1202952/comments/58"> #58</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Dolph: This bug is about the vulnerability, I don&#x27;t want to create confusion whether master is affected by keeping a master task on this. I created <a href="/bugs/1224320" class="bug-link">bug 1224320</a> to cover for the forward-porting of tests.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Dolph: This bug is about the vulnerability, I don't want to create confusion whether master is affected by keeping a master task on this. I created bug 1224320 to cover for the forward-porting of tests.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Wishlist &#8594; Undecided
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Invalid
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/keystone/+bug/1202952/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/keystone/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/keystone/+bug/1202952/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/keystone/+bug/1202952/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/keystone/+bug/1202952/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/keystone/+bug/1202952/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/keystone/+bug/1202952/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/keystone/+bug/1202952/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/keystone/+bug/1202952/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/keystone/+bug/1202952/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/keystone/+bug/1202952/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3745634/+files/keystone-ayoung-0007-Memcached-revocation-list-hashed-Id.patch">keystone-ayoung-0007-Memcached-revocation-list-hashed-Id.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3745634">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3778662/+files/bug-1202952-master-v1-tests.patch">bug-1202952-master-v1-tests.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3778662">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3778663/+files/bug-1202952-grizzly-v1-tests.patch">bug-1202952-grizzly-v1-tests.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3778663">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3778664/+files/bug-1202952-master-v1-tests.patch">bug-1202952-master-v1-tests.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3778664">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3779470/+files/bug-1202952-folsom-v1.patch">bug-1202952-folsom-v1.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3779470">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3779480/+files/bug-1202952-grizzly-v1.patch">bug-1202952-grizzly-v1.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3779480">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3782210/+files/bug-1202952-folsom-v2.patch">bug-1202952-folsom-v2.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3782210">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3783218/+files/bug-1202952-grizzly-v2.patch">bug-1202952-grizzly-v2.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3783218">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3784963/+files/bug-1202952-folsom-v3.patch">bug-1202952-folsom-v3.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3784963">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1202952/+attachment/3785020/+files/bug-1202952-grizzly-v3.patch">bug-1202952-grizzly-v3.patch</a>
        <small>
          (<a href="/keystone/+bug/1202952/+attachment/3785020">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/keystone/+bug/1202952/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1202952", "web_link": "https://bugs.launchpad.net/bugs/1202952", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1202952, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)", "description": "This is a more serious incarnation of: https://bugs.launchpad.net/keystone/+bug/1202050.\nLooks to be fixed on master in c238ace30981877e5991874c5b193ea7d5107419 (id hashing happens keystone/token/core.py there).\n\nIn the memcache token backend, whole tokens are stored in the revocation list.\n\nIn keystone/token/backends.py:\n166     def _add_to_revocation_list(self, data):\n167         data_json = jsonutils.dumps(data)\n168         if not self.client.append(self.revocation_key, ',%s' % data_json):\n169             if not self.client.add(self.revocation_key, data_json):\n170                 if not self.client.append(self.revocation_key,\n171                                           ',%s' % data_json):\n172                     msg = _('Unable to add token to revocation list.')\n173                     raise exception.UnexpectedError(msg)\n174                     \n175     def delete_token(self, token_id):\n176         # Test for existence\n177         data = self.get_token(token_id)        \u003c----\n178         ptk = self._prefix_token_id(token_id)\n179         result = self.client.delete(ptk)\n180         self._add_to_revocation_list(data)       \u003c---- \n181         return result\n\nAnd returned from the API when the auth_token middleware asks for the revocation list:\n\n208     def list_revoked_tokens(self):\n209         list_json = self.client.get(self.revocation_key)\n210         if list_json:\n211             return jsonutils.loads('[%s]' % list_json)\n212         return []\n\nThe auth_token middleware hashes the signed token and searches the revocation list for the hash:\n\n1017     def is_signed_token_revoked(self, signed_text):\n1018         \"\"\"Indicate whether the token appears in the revocation list.\"\"\"\n1019         revocation_list = self.token_revocation_list\n1020         revoked_tokens = revocation_list.get('revoked', [])\n1021         if not revoked_tokens:\n1022             return\n1023         revoked_ids = (x['id'] for x in revoked_tokens)\n1024         token_id = utils.hash_signed_token(signed_text)\n1025         for revoked_id in revoked_ids:\n1026             if token_id == revoked_id:\n1027                 self.LOG.debug('Token %s is marked as having been revoked',\n1028                                token_id)\n1029                 return True\n1030         return False\n\nBecause the memcache backend stores the entire token,  the value of x['id'] above is not an md5 hash, but the encoded PKI token. This will never match the value of the hashed untrusted token.\n\nStoring the whole token also means only around 256 tokens can stored before the memcache page is full and errors happen.", "owner_link": "https://bugs.launchpad.net/api/devel/~kspear", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/bug_tasks", "duplicate_of_link": null, "date_created": "2013-07-19T07:17:35.751621+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/subscriptions", "date_last_updated": "2014-06-04T23:25:23.546297+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 260, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/attachments", "security_related": true, "latest_patch_uploaded": "2013-08-23T22:07:17.607358+00:00", "tags": [], "date_last_message": "2013-09-12T07:37:55.607496+00:00", "number_of_duplicates": 0, "message_count": 59, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1202952/linked_merge_proposals", "http_etag": "\"cf1c1ab22c5f0109a8c90f45561b13f3f42a2461-7d2fb5640e9869db47fadf5978325a2da06c5ec6\""}, "total_comments_and_activity": 121, "related_features": {}, "information_type_data": {"PUBLIC": {"is_private": false, "name": "Public", "order": 0, "description": "Everyone can see this information.\n", "value": "PUBLIC", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"is_private": true, "name": "Private Security", "order": 2, "description": "Only the security group can see this information.\n ", "value": "PRIVATESECURITY", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"is_private": false, "name": "Public Security", "order": 1, "description": "Everyone can see this security related information.\n", "value": "PUBLICSECURITY", "description_css_class": "choice-description"}, "USERDATA": {"is_private": true, "name": "Private", "order": 3, "description": "Only shared with users permitted to see private user information.\n", "value": "USERDATA", "description_css_class": "choice-description"}}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/keystone/+bug/1202952", "web_link": "https://bugs.launchpad.net/keystone/+bug/1202952", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1202952", "milestone_link": null, "status": "Invalid", "importance": "Undecided", "assignee_link": null, "bug_target_display_name": "OpenStack Identity (keystone)", "bug_target_name": "keystone", "bug_watch_link": null, "date_assigned": null, "date_created": "2013-07-19T07:17:35.751621+00:00", "date_confirmed": null, "date_incomplete": null, "date_in_progress": null, "date_closed": "2013-09-12T07:37:58.112395+00:00", "date_left_new": "2013-07-19T21:44:22.528485+00:00", "date_triaged": null, "date_fix_committed": null, "date_fix_released": null, "date_left_closed": "2013-09-11T16:55:33.506032+00:00", "owner_link": "https://bugs.launchpad.net/api/devel/~kspear", "target_link": "https://bugs.launchpad.net/api/devel/keystone", "title": "Bug #1202952 in OpenStack Identity (keystone): \"[OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/keystone/+bug/1202952/related_tasks", "is_complete": true, "http_etag": "\"05f9dc6042661f206a3dff81a745dc60334bae1d-f4b918a38bebc1ec3a42a2b651404bbacc8f7c2c\""}, "bugtask_data": {"1458632": {"delete_link": "https://bugs.launchpad.net/keystone/folsom/+bug/1202952/+delete", "bug_title": "[OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)", "user_can_unassign": false, "importance_value": "High", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1458632", "target_is_product": false, "user_can_edit_milestone": false, "prefix": "keystone_folsom", "bugtask_path": "/keystone/folsom/+bug/1202952", "id": 1458632, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1458632", "targetname": "OpenStack Identity (keystone) folsom", "assignee_is_team": null, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": null, "status_value": "Fix Released"}, "1435147": {"delete_link": "https://bugs.launchpad.net/ossa/+bug/1202952/+delete", "bug_title": "[OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)", "user_can_unassign": false, "importance_value": "High", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1435147", "target_is_product": true, "user_can_edit_milestone": false, "prefix": "ossa", "bugtask_path": "/ossa/+bug/1202952", "id": 1435147, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1435147", "targetname": "OpenStack Security Advisory", "assignee_is_team": false, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": "ttx", "status_value": "Fix Released"}, "1458630": {"delete_link": "https://bugs.launchpad.net/keystone/grizzly/+bug/1202952/+delete", "bug_title": "[OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)", "user_can_unassign": false, "importance_value": "High", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1458630", "target_is_product": false, "user_can_edit_milestone": false, "prefix": "keystone_grizzly", "bugtask_path": "/keystone/grizzly/+bug/1202952", "id": 1458630, "milestone_value": "https://bugs.launchpad.net/api/devel/keystone/+milestone/2013.1.4", "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1458630", "targetname": "OpenStack Identity (keystone) grizzly", "assignee_is_team": false, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": "mdrnstm", "status_value": "Fix Released"}, "1434967": {"delete_link": "https://bugs.launchpad.net/keystone/+bug/1202952/+delete", "bug_title": "[OSSA 2013-025] PKI tokens are never revoked using memcache token backend (CVE-2013-4294)", "user_can_unassign": false, "importance_value": "Undecided", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1434967", "target_is_product": true, "user_can_edit_milestone": false, "prefix": "keystone", "bugtask_path": "/keystone/+bug/1202952", "id": 1434967, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1434967", "targetname": "OpenStack Identity (keystone)", "assignee_is_team": null, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": null, "status_value": "Invalid"}}, "subscribers_portlet_url_data": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1202952", "web_link": "https://bugs.launchpad.net/bugs/1202952"}, "initial_comment_batch_offset": 41, "first visible_recent_comment": 18};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 78 queries/external actions issued in 1.77 seconds

    Features: {'app.maintenance_message': None, 'hard_timeout': '9000', 'js.yui_version': None, 'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'baselayout.careers_link.disabled': None, 'bugs.affected_count_includes_dupes.disabled': None, 'visible_render_time': None, 'profiling.enabled': None, 'bugs.nominations.bug_supervisors_can_target': 'on'}

    r0d8de2b

    -->

</html>

