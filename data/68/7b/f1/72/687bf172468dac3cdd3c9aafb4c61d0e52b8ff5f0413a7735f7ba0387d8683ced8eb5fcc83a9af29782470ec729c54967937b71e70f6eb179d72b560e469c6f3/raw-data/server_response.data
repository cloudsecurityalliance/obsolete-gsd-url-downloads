<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1528050 “NTP statsdir cleanup cronjob insecure” : Bugs : ntp package : Ubuntu</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1528050" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1528050/bug.atom" title="Bug 1528050 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="The cronjob script bundled with ntp package on Ubuntu Wily is intended to perform cleanup on statistics files produced by NTP daemon running with statistics enabled. The script is run as root during the daily cronjobs all operations on the ntp-user controlled statistics directory without switching to user ntp. Thus all steps are performed with root permissions in place.

Due to multiple bugs in the script, a malicious ntp user can make the backup process to overwrite arbitrary files with cont..." />
      <meta property="og:description" content="The cronjob script bundled with ntp package on Ubuntu Wily is intended to perform cleanup on statistics files produced by NTP daemon running with statistics enabled. The script is run as root during the daily cronjobs all operations on the ntp-user controlled statistics directory without switching to user ntp. Thus all steps are performed with root permissions in place.

Due to multiple bugs in the script, a malicious ntp user can make the backup process to overwrite arbitrary files with cont..." />
    

    
    
      <meta property="og:title" content="Bug #1528050 “NTP statsdir cleanup cronjob insecure” : Bugs : ntp package : Ubuntu" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1528050" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["a11y", "appstream", "bionic", "bisect-done", "bitesize", "cherry-pick", "community-security", "desktop-file", "disco", "dist-upgrade", "focal", "ftbfs", "groovy", "hirsute", "hw-specific", "impish", "jammy", "kernel-bug", "manpage", "metabug", "multiarch", "needs-bisect", "needs-design", "needs-packaging", "needs-reassignment", "package-conflict", "packaging", "patch", "patch-accepted-debian", "patch-accepted-upstream", "patch-forwarded-debian", "patch-forwarded-upstream", "patch-needswork", "patch-rejected", "patch-rejected-debian", "patch-rejected-upstream", "performing-bisect", "py2-removal", "qt4-removal", "regression-proposed", "regression-release", "regression-update", "string-fix", "suspend-resume", "systemd-boot", "testcase", "touch", "unmetdeps", "upgrade-software-version", "verification-done-bionic", "verification-done-focal", "verification-done-groovy", "verification-done-hirsute", "verification-done-impish", "verification-done-xenial", "verification-failed-bionic", "verification-failed-groovy", "verification-failed-impish", "verification-failed-xenial", "verification-needed-bionic", "verification-needed-focal", "verification-needed-groovy", "verification-needed-hirsute", "verification-needed-impish", "verification-needed-trusty", "verification-needed-xenial", "wayland", "xenial"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/ubuntu"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/49558155/64_logo.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/ubuntu">Ubuntu</a><br /><a href="https://launchpad.net/ubuntu/+source/ntp">ntp package</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/ubuntu/+source/ntp">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/ubuntu/+source/ntp">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/ubuntu/+source/ntp">Bugs</a></li>
      
      
    
    
      
      
      <li class="specifications disabled-tab"><span>Blueprints</span></li>
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/ubuntu/+source/ntp">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/ubuntu/+source/ntp">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    NTP statsdir cleanup cronjob insecure
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1528050 reported by
      <a href="https://launchpad.net/~halfdog" class="sprite person">halfdog</a>
      <time title="2015-12-20 20:59:28 UTC" datetime="2015-12-20T20:59:28.993690+00:00">on 2015-12-20</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">264</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1967261">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1967261">
        <span class="yui3-activator-data-box">
            <a class="sprite package-source" href="https://bugs.launchpad.net/ubuntu/+source/ntp" title="Latest release: 1:4.2.8p12+dfsg-3ubuntu6, uploaded to main on 2021-07-26 15:50:09.204662+00:00 by Brian Morton (rokclimb15), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)">ntp (Ubuntu)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1967261">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1967261">
     <td colspan="7"><form action="/ubuntu/+source/ntp/+bug/1528050/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/+source/ntp">ntp (Ubuntu)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~halfdog" class="sprite person">halfdog</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2015-12-20 20:59:28 UTC" datetime="2015-12-20T20:59:28.993690+00:00">2015-12-20</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2015-12-23 06:25:33 UTC" datetime="2015-12-23T06:25:33.613731+00:00">2015-12-23</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2016-06-01 16:58:04 UTC" datetime="2016-06-01T16:58:04.482467+00:00">2016-06-01</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2016-06-01 16:58:04 UTC" datetime="2016-06-01T16:58:04.482467+00:00">2016-06-01</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ubuntu_ntp.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ubuntu_ntp.target.option.package" name="ubuntu_ntp.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ubuntu_ntp.target.distribution" name="ubuntu_ntp.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ubuntu_ntp.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ubuntu_ntp.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="ntp" id="ubuntu_ntp.target.package"
                         name="ubuntu_ntp.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_ntp.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_ntp.target.package');
              var select_menu = Y.DOM.byId('ubuntu_ntp.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_ntp-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionPackage", "extra_no_results_message": null, "selected_value": "ntp", "show_assign_me_button": false, "show_widget_id": "show-widget-ubuntu_ntp-target-package", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "ubuntu_ntp.target.package"};
        var show_widget_id = 'show-widget-ubuntu_ntp-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" id="ubuntu_ntp.target.option.product" name="ubuntu_ntp.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ubuntu_ntp.target.product"
                         name="ubuntu_ntp.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_ntp.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_ntp.target.product');
              var select_menu = Y.DOM.byId('ubuntu_ntp.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_ntp-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a project", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "Product", "extra_no_results_message": null, "selected_value": null, "show_assign_me_button": false, "show_widget_id": "show-widget-ubuntu_ntp-target-product", "step_title": "Search", "assign_me_text": "Pick me", "input_element": "ubuntu_ntp.target.product"};
        var show_widget_id = 'show-widget-ubuntu_ntp-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_ntp.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_ntp.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_ntp.status" name="ubuntu_ntp.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ubuntu_ntp.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_ntp.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_ntp.assignee.assign_to_nobody" name="ubuntu_ntp.assignee.option" value="ubuntu_ntp.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_ntp.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_ntp.assignee.assign_to_me" name="ubuntu_ntp.assignee.option" value="ubuntu_ntp.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_ntp.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_ntp.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_ntp.comment_on_change" name="ubuntu_ntp.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1992486">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/wily/+source/ntp/+bug/1528050/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/ubuntu/wily/+source/ntp">Wily</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/wily/+source/ntp/+bug/1528050/+editstatus" style="float: left" class="value statusWONTFIX">Won't Fix</a>
          <a href="https://bugs.launchpad.net/ubuntu/wily/+source/ntp/+bug/1528050/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1992486">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1992486">
     <td colspan="7"><form action="/ubuntu/wily/+source/ntp/+bug/1528050/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/wily/+source/ntp">ntp (Ubuntu Wily)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~racb" class="sprite person">Robie Basak</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2016-02-04 13:53:22 UTC" datetime="2016-02-04T13:53:22.517169+00:00">2016-02-04</time>
      </td>
    </tr>
    
    
    
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2016-08-16 02:53:43 UTC" datetime="2016-08-16T02:53:43.442881+00:00">2016-08-16</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    <table>
      <tr>
        <td>
          <label for="ubuntu_wily_ntp.sourcepackagename">Package</label>
        </td>
      </tr>
      <tr>
        <td>
          


    <input type="text" value="ntp" id="ubuntu_wily_ntp.sourcepackagename"
                         name="ubuntu_wily_ntp.sourcepackagename" size="20"
                         maxlength=""
                         onKeyPress="" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_wily_ntp.sourcepackagename');
              var select_menu = Y.DOM.byId('ubuntu_wily_ntp.sourcepackagename-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_wily_ntp-sourcepackagename" href="#">Find&hellip;</a>)</span>
    <script>
  LPJS.use('node', 'lp.app.picker', function(Y) {
      var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionSourcePackage", "extra_no_results_message": null, "selected_value": "ntp", "show_assign_me_button": false, "show_widget_id": "show-widget-ubuntu_wily_ntp-sourcepackagename", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "ubuntu_wily_ntp.sourcepackagename"};
      var distribution_name = '';
      var distribution_id = '';
      var distroseries_id = '';
      if (distribution_name !== '') {
          config.getContextPath = function() {
              return '/' + distribution_name;
          }
      } else if (distribution_id !== '') {
          config.getContextPath = function() {
              return '/' + Y.DOM.byId(distribution_id).value;
          };
      } else if (distroseries_id !== '') {
          config.getContextPath = function() {
              return '/' + Y.DOM.byId(distroseries_id).value.split('/', 2)[0];
          };
      }
      var show_widget_id = 'show-widget-ubuntu_wily_ntp-sourcepackagename';
      Y.on('domready', function(e) {
          Y.lp.app.picker.addPicker(config, show_widget_id);
      });
  });
  </script>
  



          
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_wily_ntp.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_wily_ntp.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_wily_ntp.status" name="ubuntu_wily_ntp.status" size="1" >
<option selected="selected" value="Won't Fix">Won't Fix</option>
</select>
</div>
<input name="ubuntu_wily_ntp.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_wily_ntp.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_wily_ntp.assignee.assign_to_nobody" name="ubuntu_wily_ntp.assignee.option" value="ubuntu_wily_ntp.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_wily_ntp.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_wily_ntp.assignee.assign_to_me" name="ubuntu_wily_ntp.assignee.option" value="ubuntu_wily_ntp.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_wily_ntp.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_wily_ntp.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_wily_ntp.comment_on_change" name="ubuntu_wily_ntp.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary2121420">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/xenial/+source/ntp/+bug/1528050/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/ubuntu/xenial/+source/ntp">Xenial</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/xenial/+source/ntp/+bug/1528050/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/xenial/+source/ntp/+bug/1528050/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2121420">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2121420">
     <td colspan="7"><form action="/ubuntu/xenial/+source/ntp/+bug/1528050/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/xenial/+source/ntp">ntp (Ubuntu Xenial)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~sbeattie" class="sprite person">Steve Beattie</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2016-08-16 02:52:59 UTC" datetime="2016-08-16T02:52:59.509323+00:00">2016-08-16</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2016-08-16 02:54:33 UTC" datetime="2016-08-16T02:54:33.003741+00:00">2016-08-16</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2016-10-05 17:32:03 UTC" datetime="2016-10-05T17:32:03.685342+00:00">2016-10-05</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2016-10-05 17:32:03 UTC" datetime="2016-10-05T17:32:03.685342+00:00">2016-10-05</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    <table>
      <tr>
        <td>
          <label for="ubuntu_xenial_ntp.sourcepackagename">Package</label>
        </td>
      </tr>
      <tr>
        <td>
          


    <input type="text" value="ntp" id="ubuntu_xenial_ntp.sourcepackagename"
                         name="ubuntu_xenial_ntp.sourcepackagename" size="20"
                         maxlength=""
                         onKeyPress="" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_xenial_ntp.sourcepackagename');
              var select_menu = Y.DOM.byId('ubuntu_xenial_ntp.sourcepackagename-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_xenial_ntp-sourcepackagename" href="#">Find&hellip;</a>)</span>
    <script>
  LPJS.use('node', 'lp.app.picker', function(Y) {
      var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionSourcePackage", "extra_no_results_message": null, "selected_value": "ntp", "show_assign_me_button": false, "show_widget_id": "show-widget-ubuntu_xenial_ntp-sourcepackagename", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "ubuntu_xenial_ntp.sourcepackagename"};
      var distribution_name = '';
      var distribution_id = '';
      var distroseries_id = '';
      if (distribution_name !== '') {
          config.getContextPath = function() {
              return '/' + distribution_name;
          }
      } else if (distribution_id !== '') {
          config.getContextPath = function() {
              return '/' + Y.DOM.byId(distribution_id).value;
          };
      } else if (distroseries_id !== '') {
          config.getContextPath = function() {
              return '/' + Y.DOM.byId(distroseries_id).value.split('/', 2)[0];
          };
      }
      var show_widget_id = 'show-widget-ubuntu_xenial_ntp-sourcepackagename';
      Y.on('domready', function(e) {
          Y.lp.app.picker.addPicker(config, show_widget_id);
      });
  });
  </script>
  



          
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_xenial_ntp.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_xenial_ntp.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_xenial_ntp.status" name="ubuntu_xenial_ntp.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ubuntu_xenial_ntp.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_xenial_ntp.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_xenial_ntp.assignee.assign_to_nobody" name="ubuntu_xenial_ntp.assignee.option" value="ubuntu_xenial_ntp.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_xenial_ntp.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_xenial_ntp.assignee.assign_to_me" name="ubuntu_xenial_ntp.assignee.option" value="ubuntu_xenial_ntp.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_xenial_ntp.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_xenial_ntp.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_xenial_ntp.comment_on_change" name="ubuntu_xenial_ntp.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>The cronjob script bundled with ntp package on Ubuntu Wily is intended to perform cleanup on statistics files produced by NTP daemon running with statistics enabled. The script is run as root during the daily cronjobs all operations on the ntp-user controlled statistics directory without switching to user ntp. Thus all steps are performed with root permissions in place.</p>
<p>Due to multiple bugs in the script, a malicious ntp user can make the backup process to overwrite arbitrary files with content controlled by the attacker, thus gaining root privileges. The problematic parts in /etc/cron.daily/ntp are:</p>
<p>find &quot;$statsdir&quot; -type f -mtime +7 -exec rm {} \;</p>
<p># compress whatever is left to save space<br />
cd &quot;$statsdir&quot;<br />
ls *stats.???????? &gt; /dev/null 2&gt;&amp;1<br />
if [ $? -eq 0 ]; then<br />
&nbsp;&nbsp;# Note that gzip won&#x27;t compress the file names that<br />
&nbsp;&nbsp;# are hard links to the live/current files, so this<br />
&nbsp;&nbsp;# compresses yesterday and previous, leaving the live<br />
&nbsp;&nbsp;# log alone.  We supress the warnings gzip issues<br />
&nbsp;&nbsp;# about not compressing the linked file.<br />
&nbsp;&nbsp;gzip --best --quiet *stats.????????</p>
<p>Relevant targets are:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;find and rm invocation is racy, symlinks on rm<br />
&nbsp;&nbsp;&nbsp;&nbsp;rm can be invoked with one attacker controlled option<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls can be invoked with arbitrary number of attacker controlled command line options<br />
&nbsp;&nbsp;&nbsp;&nbsp;gzip can be invoked with arbitrary number of attacker controlled options</p>
<p>See <a rel="nofollow" href="http://www.halfdog.net/Security/2015/NtpCronjobUserNtpToRootPrivilegeEscalation/">http://<wbr />www.halfdog.<wbr />net/Security/<wbr />2015/NtpCronjob<wbr />UserNtpToRootPr<wbr />ivilegeEscalati<wbr />on/</a> for working user ntp to root privilege escalation exploit (User: InvitedOnly, Pass: wtq39EiZ), sharing policy is attached to this issue.</p>
<p># lsb_release -rd<br />
Description:    Ubuntu 15.10<br />
Release:        15.10<br />
# apt-cache policy ntp<br />
ntp:<br />
&nbsp;&nbsp;Installed: 1:4.2.6.<wbr />p5+dfsg-<wbr />3ubuntu8.<wbr />1<br />
&nbsp;&nbsp;Candidate: 1:4.2.6.<wbr />p5+dfsg-<wbr />3ubuntu8.<wbr />1<br />
&nbsp;&nbsp;Version table:<br />
&nbsp;*** 1:4.2.6.<wbr />p5+dfsg-<wbr />3ubuntu8.<wbr />1 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;500 <a rel="nofollow" href="http://archive.ubuntu.com/ubuntu/">http://<wbr />archive.<wbr />ubuntu.<wbr />com/ubuntu/</a> wily-updates/main amd64 Packages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;500 <a rel="nofollow" href="http://archive.ubuntu.com/ubuntu/">http://<wbr />archive.<wbr />ubuntu.<wbr />com/ubuntu/</a> wily-security/main amd64 Packages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100 /var/lib/<wbr />dpkg/status<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:<wbr />4.2.6.p5+<wbr />dfsg-3ubuntu8 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;500 <a rel="nofollow" href="http://archive.ubuntu.com/ubuntu/">http://<wbr />archive.<wbr />ubuntu.<wbr />com/ubuntu/</a> wily/main amd64 Packages</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          <span>See <a href="comments/0">original description</a></span>
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            Tags:
          </span>
          <span id="tag-list">
            <a class="official-tag" href="/ubuntu/+source/ntp/+bugs?field.tag=patch">patch</a>
          </span>
          
          <a href="+edit" title="Edit tags" id="tags-trigger" class="sprite edit action-icon">Edit</a>
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7973" title="NTP before 4.2.8p6 and 4.3.x before 4...">2015-7973</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7974" title="NTP 4.x before 4.2.8p6 and 4.3.x befo...">2015-7974</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7975" title="The nextvar function in NTP before 4....">2015-7975</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7976" title="The ntpq saveconfig command in NTP 4....">2015-7976</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7977" title="ntpd in NTP before 4.2.8p6 and 4.3.x ...">2015-7977</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7978" title="NTP before 4.2.8p6 and 4.3.0 before 4...">2015-7978</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-7979" title="NTP before 4.2.8p6 and 4.3.x before 4...">2015-7979</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-8138" title="NTP before 4.2.8p6 and 4.3.x before 4...">2015-8138</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-8158" title="The getresponse function in ntpq in N...">2015-8158</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-0727" title="The crontab script in the ntp package...">2016-0727</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-1547" title="An off-path attacker can cause a pree...">2016-1547</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-1548" title="An attacker can spoof a packet from a...">2016-1548</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-1550" title="An exploitable vulnerability exists i...">2016-1550</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-2516" title="NTP before 4.2.8p7 and 4.3.x before 4...">2016-2516</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-2518" title="The MATCH_ASSOC function in NTP befor...">2016-2518</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-4954" title="The process_packet function in ntp_pr...">2016-4954</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-4955" title="ntpd in NTP 4.x before 4.2.8p8, when ...">2016-4955</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-4956" title="ntpd in NTP 4.x before 4.2.8p8 allows...">2016-4956</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~halfdog" class="sprite person">halfdog (halfdog)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-20T21:00:36.650150+00:00" title="2015-12-20 21:00:36 UTC">on 2015-12-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+attachment/4538049/+files/policy.txt">Vulnerability information sharing policy</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/ntp/+bug/1528050/+attachment/4538049">Edit</a>
        (671 bytes,
        text/plain)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~halfdog" class="sprite person">halfdog (halfdog)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-20T21:01:54.437466+00:00" title="2015-12-20 21:01:54 UTC">on 2015-12-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+attachment/4538050/+files/etc-cron-daily-ntp.diff">Patch just securing commands as they are</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/ntp/+bug/1528050/+attachment/4538050">Edit</a>
        (1.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~halfdog" class="sprite person">halfdog (halfdog)</a>
    
    <time title="2015-12-22 22:36:53 UTC" datetime="2015-12-22T22:36:53.023834+00:00">on 2015-12-22</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-23T06:25:37.045603+00:00" title="2015-12-23 06:25:37 UTC">on 2015-12-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thank you for the report halfdog; we&#x27;re currently on holidays with very little coverage until the new year. Do you mind if we investigate this further in the new year?</p>
<p>Thanks for the fine report! Good work as always.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thank you for the report halfdog; we're currently on holidays with very little coverage until the new year. Do you mind if we investigate this further in the new year?

Thanks for the fine report! Good work as always.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ntp (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~halfdog" class="sprite person">halfdog (halfdog)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-23T08:53:17.769715+00:00" title="2015-12-23 08:53:17 UTC">on 2015-12-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I have already informed NTP upstream, but I guess they will also need some time to do their work. I will try to assist upstream in fixing and hold the issue back from my side. So unless upstream wants to march on at their pace or unless you have objections, I would try to kick it into the oss-security distros list around 2015-12-30, thus you having time till 2016-01-12 before embargo time ends (unless other distros have objections).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I have already informed NTP upstream, but I guess they will also need some time to do their work. I will try to assist upstream in fixing and hold the issue back from my side. So unless upstream wants to march on at their pace or unless you have objections, I would try to kick it into the oss-security distros list around 2015-12-30, thus you having time till 2016-01-12 before embargo time ends (unless other distros have objections).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mdeslaur" class="sprite person">Marc Deslauriers (mdeslaur)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-21T19:08:55.929061+00:00" title="2016-01-21 19:08:55 UTC">on 2016-01-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>halfdog, can I make this bug public now?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">halfdog, can I make this bug public now?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~halfdog" class="sprite person">halfdog (halfdog)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-21T19:42:07.709191+00:00" title="2016-01-21 19:42:07 UTC">on 2016-01-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Done: Is is public via <a rel="nofollow" href="http://www.openwall.com/lists/oss-security/2016/01/21/7">http://<wbr />www.openwall.<wbr />com/lists/<wbr />oss-security/<wbr />2016/01/<wbr />21/7</a> anyway.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Done: Is is public via http://www.openwall.com/lists/oss-security/2016/01/21/7 anyway.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~crichton" class="sprite person">Ubuntu Foundations Team Bug Bot (crichton)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-21T20:25:40.586846+00:00" title="2016-01-21 20:25:40 UTC">on 2016-01-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The attachment &quot;Patch just securing commands as they are&quot; seems to be a patch.  If it isn&#x27;t, please remove the &quot;patch&quot; flag from the attachment, remove the &quot;patch&quot; tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.</p>
<p>[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The attachment "Patch just securing commands as they are" seems to be a patch.  If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: patch
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~paelzer" class="sprite person">Christian Ehrhardt  (paelzer)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-05-01T15:50:36.821323+00:00" title="2016-05-01 15:50:36 UTC">on 2016-05-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m afraid this might have been lost in tracking.<br />
Also adding Security team (since it is a CVE) and setting triaged as a patch that seems reasonable is available.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm afraid this might have been lost in tracking.
Also adding Security team (since it is a CVE) and setting triaged as a patch that seems reasonable is available.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ntp (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-06-01T16:58:00.356387+00:00" title="2016-06-01 16:58:00 UTC">on 2016-06-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package ntp - 1:4.2.8p4+<wbr />dfsg-3ubuntu6</p>
<p>---------------<br />
ntp (1:4.2.<wbr />8p4+dfsg-<wbr />3ubuntu6) yakkety; urgency=medium</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: Deja Vu replay attack on authenticated broadcast mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7973.patch: improve timestamp verification in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include/<wbr />ntp.h, ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7973<br />
&nbsp;&nbsp;* SECURITY UPDATE: impersonation between authenticated peers<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7974.patch: check key ID in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7974<br />
&nbsp;&nbsp;* SECURITY UPDATE: ntpq buffer overflow<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7975.patch: add length check to ntpq/ntpq.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7975<br />
&nbsp;&nbsp;* SECURITY UPDATE: ntpq saveconfig command allows dangerous characters in<br />
&nbsp;&nbsp;&nbsp;&nbsp;filenames<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7976.patch: check filename in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_control.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7976<br />
&nbsp;&nbsp;* SECURITY UPDATE: restrict list denial of service<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7977-7978.<wbr />patch: improve restrict list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processing in ntpd/ntp_request.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7977<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7978<br />
&nbsp;&nbsp;* SECURITY UPDATE: authenticated broadcast mode off-path denial of<br />
&nbsp;&nbsp;&nbsp;&nbsp;service<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7979.patch: add more checks to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_proto.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7979<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-1547<br />
&nbsp;&nbsp;* SECURITY UPDATE: Zero Origin Timestamp Bypass<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />8138.patch: check p_org in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-8138<br />
&nbsp;&nbsp;* SECURITY UPDATE: potential infinite loop in ntpq<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />8158.patch: add time checks to ntpdc/ntpdc.c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpq/ntpq.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-8158<br />
&nbsp;&nbsp;* SECURITY UPDATE: NTP statsdir cleanup cronjob insecure (LP: <a href="/bugs/1528050" class="bug-link">#1528050</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />ntp.cron.<wbr />daily: fix security issues, patch thanks to halfdog!<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-0727<br />
&nbsp;&nbsp;* SECURITY UPDATE: time spoofing via interleaved symmetric mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-20xx-<wbr />xxxx.patch: check for bogus packets in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_proto.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-1548<br />
&nbsp;&nbsp;* SECURITY UPDATE: buffer comparison timing attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />1550.patch: use CRYPTO_memcmp in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libntp/<wbr />a_md5encrypt.<wbr />c, sntp/crypto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-1550<br />
&nbsp;&nbsp;* SECURITY UPDATE: DoS via duplicate IPs on unconfig directives<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />2516.patch: improve logic in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_request.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-2516<br />
&nbsp;&nbsp;* SECURITY UPDATE: denial of service via crafted addpeer<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />2518.patch: check mode value in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_request.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-2518</p>
<p>&nbsp;-- Marc Deslauriers &lt;email address hidden&gt;  Wed, 01 Jun 2016 08:38:07 -0400</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package ntp - 1:4.2.8p4+dfsg-3ubuntu6

---------------
ntp (1:4.2.8p4+dfsg-3ubuntu6) yakkety; urgency=medium

  * SECURITY UPDATE: Deja Vu replay attack on authenticated broadcast mode
    - debian/patches/CVE-2015-7973.patch: improve timestamp verification in
      include/ntp.h, ntpd/ntp_proto.c.
    - CVE-2015-7973
  * SECURITY UPDATE: impersonation between authenticated peers
    - debian/patches/CVE-2015-7974.patch: check key ID in ntpd/ntp_proto.c.
    - CVE-2015-7974
  * SECURITY UPDATE: ntpq buffer overflow
    - debian/patches/CVE-2015-7975.patch: add length check to ntpq/ntpq.c.
    - CVE-2015-7975
  * SECURITY UPDATE: ntpq saveconfig command allows dangerous characters in
    filenames
    - debian/patches/CVE-2015-7976.patch: check filename in
      ntpd/ntp_control.c.
    - CVE-2015-7976
  * SECURITY UPDATE: restrict list denial of service
    - debian/patches/CVE-2015-7977-7978.patch: improve restrict list
      processing in ntpd/ntp_request.c.
    - CVE-2015-7977
    - CVE-2015-7978
  * SECURITY UPDATE: authenticated broadcast mode off-path denial of
    service
    - debian/patches/CVE-2015-7979.patch: add more checks to
      ntpd/ntp_proto.c.
    - CVE-2015-7979
    - CVE-2016-1547
  * SECURITY UPDATE: Zero Origin Timestamp Bypass
    - debian/patches/CVE-2015-8138.patch: check p_org in ntpd/ntp_proto.c.
    - CVE-2015-8138
  * SECURITY UPDATE: potential infinite loop in ntpq
    - debian/patches/CVE-2015-8158.patch: add time checks to ntpdc/ntpdc.c,
      ntpq/ntpq.c.
    - CVE-2015-8158
  * SECURITY UPDATE: NTP statsdir cleanup cronjob insecure (LP: #1528050)
    - debian/ntp.cron.daily: fix security issues, patch thanks to halfdog!
    - CVE-2016-0727
  * SECURITY UPDATE: time spoofing via interleaved symmetric mode
    - debian/patches/CVE-20xx-xxxx.patch: check for bogus packets in
      ntpd/ntp_proto.c.
    - CVE-2016-1548
  * SECURITY UPDATE: buffer comparison timing attacks
    - debian/patches/CVE-2016-1550.patch: use CRYPTO_memcmp in
      libntp/a_md5encrypt.c, sntp/crypto.c.
    - CVE-2016-1550
  * SECURITY UPDATE: DoS via duplicate IPs on unconfig directives
    - debian/patches/CVE-2016-2516.patch: improve logic in
      ntpd/ntp_request.c.
    - CVE-2016-2516
  * SECURITY UPDATE: denial of service via crafted addpeer
    - debian/patches/CVE-2016-2518.patch: check mode value in
      ntpd/ntp_request.c.
    - CVE-2016-2518

 -- Marc Deslauriers &lt;marc.deslauriers@ubuntu.com&gt;  Wed, 01 Jun 2016 08:38:07 -0400</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ntp (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~sbeattie" class="sprite person">Steve Beattie (sbeattie)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-08-16T02:53:42.218446+00:00" title="2016-08-16 02:53:42 UTC">on 2016-08-16</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Wily has reached end of support, closing as Won&#x27;t Fix.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Wily has reached end of support, closing as Won't Fix.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ntp (Ubuntu Wily): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Won&#x27;t Fix
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ntp (Ubuntu Xenial): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/ntp/+bug/1528050/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-10-05T17:32:01.970026+00:00" title="2016-10-05 17:32:01 UTC">on 2016-10-05</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/ntp/+bug/1528050/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package ntp - 1:4.2.8p4+<wbr />dfsg-3ubuntu5.<wbr />3</p>
<p>---------------<br />
ntp (1:4.2.<wbr />8p4+dfsg-<wbr />3ubuntu5.<wbr />3) xenial-security; urgency=medium</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: Deja Vu replay attack on authenticated broadcast mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7973.patch: improve timestamp verification in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include/<wbr />ntp.h, ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7973<br />
&nbsp;&nbsp;* SECURITY UPDATE: impersonation between authenticated peers<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7974.patch: check key ID in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7974<br />
&nbsp;&nbsp;* SECURITY UPDATE: ntpq buffer overflow<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7975.patch: add length check to ntpq/ntpq.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7975<br />
&nbsp;&nbsp;* SECURITY UPDATE: ntpq saveconfig command allows dangerous characters in<br />
&nbsp;&nbsp;&nbsp;&nbsp;filenames<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7976.patch: check filename in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_control.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7976<br />
&nbsp;&nbsp;* SECURITY UPDATE: restrict list denial of service<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7977-7978.<wbr />patch: improve restrict list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processing in ntpd/ntp_request.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7977<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7978<br />
&nbsp;&nbsp;* SECURITY UPDATE: authenticated broadcast mode off-path denial of<br />
&nbsp;&nbsp;&nbsp;&nbsp;service<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />7979.patch: add more checks to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_proto.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-7979<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-1547<br />
&nbsp;&nbsp;* SECURITY UPDATE: Zero Origin Timestamp Bypass<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />8138.patch: check p_org in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-8138<br />
&nbsp;&nbsp;* SECURITY UPDATE: potential infinite loop in ntpq<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />8158.patch: add time checks to ntpdc/ntpdc.c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpq/ntpq.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-8158<br />
&nbsp;&nbsp;* SECURITY UPDATE: NTP statsdir cleanup cronjob insecure (LP: <a href="/bugs/1528050" class="bug-link">#1528050</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />ntp.cron.<wbr />daily: fix security issues, patch thanks to halfdog!<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-0727<br />
&nbsp;&nbsp;* SECURITY UPDATE: time spoofing via interleaved symmetric mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />1548.patch: check for bogus packets in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_proto.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-1548<br />
&nbsp;&nbsp;* SECURITY UPDATE: buffer comparison timing attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />1550.patch: use CRYPTO_memcmp in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libntp/<wbr />a_md5encrypt.<wbr />c, sntp/crypto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-1550<br />
&nbsp;&nbsp;* SECURITY UPDATE: DoS via duplicate IPs on unconfig directives<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />2516.patch: improve logic in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_request.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-2516<br />
&nbsp;&nbsp;* SECURITY UPDATE: denial of service via crafted addpeer<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />2518.patch: check mode value in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ntpd/<wbr />ntp_request.<wbr />c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-2518<br />
&nbsp;&nbsp;* SECURITY UPDATE: denial of service via spoofed packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />4954.patch: discard packet that fails tests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-4954<br />
&nbsp;&nbsp;* SECURITY UPDATE: denial of service via spoofed crypto-NAK or incorrect<br />
&nbsp;&nbsp;&nbsp;&nbsp;MAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />4955.patch: fix checks in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-4955<br />
&nbsp;&nbsp;* SECURITY UPDATE: denial of service via spoofed broadcast packet<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />4956.patch: properly handle switch in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;broadcast interleaved mode in ntpd/ntp_proto.c.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-4956</p>
<p>&nbsp;-- Marc Deslauriers &lt;email address hidden&gt;  Wed, 05 Oct 2016 08:01:29 -0400</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package ntp - 1:4.2.8p4+dfsg-3ubuntu5.3

---------------
ntp (1:4.2.8p4+dfsg-3ubuntu5.3) xenial-security; urgency=medium

  * SECURITY UPDATE: Deja Vu replay attack on authenticated broadcast mode
    - debian/patches/CVE-2015-7973.patch: improve timestamp verification in
      include/ntp.h, ntpd/ntp_proto.c.
    - CVE-2015-7973
  * SECURITY UPDATE: impersonation between authenticated peers
    - debian/patches/CVE-2015-7974.patch: check key ID in ntpd/ntp_proto.c.
    - CVE-2015-7974
  * SECURITY UPDATE: ntpq buffer overflow
    - debian/patches/CVE-2015-7975.patch: add length check to ntpq/ntpq.c.
    - CVE-2015-7975
  * SECURITY UPDATE: ntpq saveconfig command allows dangerous characters in
    filenames
    - debian/patches/CVE-2015-7976.patch: check filename in
      ntpd/ntp_control.c.
    - CVE-2015-7976
  * SECURITY UPDATE: restrict list denial of service
    - debian/patches/CVE-2015-7977-7978.patch: improve restrict list
      processing in ntpd/ntp_request.c.
    - CVE-2015-7977
    - CVE-2015-7978
  * SECURITY UPDATE: authenticated broadcast mode off-path denial of
    service
    - debian/patches/CVE-2015-7979.patch: add more checks to
      ntpd/ntp_proto.c.
    - CVE-2015-7979
    - CVE-2016-1547
  * SECURITY UPDATE: Zero Origin Timestamp Bypass
    - debian/patches/CVE-2015-8138.patch: check p_org in ntpd/ntp_proto.c.
    - CVE-2015-8138
  * SECURITY UPDATE: potential infinite loop in ntpq
    - debian/patches/CVE-2015-8158.patch: add time checks to ntpdc/ntpdc.c,
      ntpq/ntpq.c.
    - CVE-2015-8158
  * SECURITY UPDATE: NTP statsdir cleanup cronjob insecure (LP: #1528050)
    - debian/ntp.cron.daily: fix security issues, patch thanks to halfdog!
    - CVE-2016-0727
  * SECURITY UPDATE: time spoofing via interleaved symmetric mode
    - debian/patches/CVE-2016-1548.patch: check for bogus packets in
      ntpd/ntp_proto.c.
    - CVE-2016-1548
  * SECURITY UPDATE: buffer comparison timing attacks
    - debian/patches/CVE-2016-1550.patch: use CRYPTO_memcmp in
      libntp/a_md5encrypt.c, sntp/crypto.c.
    - CVE-2016-1550
  * SECURITY UPDATE: DoS via duplicate IPs on unconfig directives
    - debian/patches/CVE-2016-2516.patch: improve logic in
      ntpd/ntp_request.c.
    - CVE-2016-2516
  * SECURITY UPDATE: denial of service via crafted addpeer
    - debian/patches/CVE-2016-2518.patch: check mode value in
      ntpd/ntp_request.c.
    - CVE-2016-2518
  * SECURITY UPDATE: denial of service via spoofed packets
    - debian/patches/CVE-2016-4954.patch: discard packet that fails tests
      in ntpd/ntp_proto.c.
    - CVE-2016-4954
  * SECURITY UPDATE: denial of service via spoofed crypto-NAK or incorrect
    MAC
    - debian/patches/CVE-2016-4955.patch: fix checks in ntpd/ntp_proto.c.
    - CVE-2016-4955
  * SECURITY UPDATE: denial of service via spoofed broadcast packet
    - debian/patches/CVE-2016-4956.patch: properly handle switch in
      broadcast interleaved mode in ntpd/ntp_proto.c.
    - CVE-2016-4956

 -- Marc Deslauriers &lt;marc.deslauriers@ubuntu.com&gt;  Wed, 05 Oct 2016 08:01:29 -0400</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ntp (Ubuntu Xenial): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/ubuntu/+source/ntp/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/ubuntu/+source/ntp/+bug/1528050/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/ubuntu/+source/ntp/+bug/1528050/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/ubuntu/+source/ntp/+bug/1528050/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+attachment/4538050/+files/etc-cron-daily-ntp.diff">Patch just securing commands as they are</a>
        <small>
          (<a href="/ubuntu/+source/ntp/+bug/1528050/+attachment/4538050">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/ubuntu/+source/ntp/+bug/1528050/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+attachment/4538049/+files/policy.txt">Vulnerability information sharing policy</a>
        <small>
          (<a href="/ubuntu/+source/ntp/+bug/1528050/+attachment/4538049">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/ubuntu/+source/ntp/+bug/1528050/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1528050", "web_link": "https://bugs.launchpad.net/bugs/1528050", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1528050, "private": false, "information_type": "Public Security", "name": null, "title": "NTP statsdir cleanup cronjob insecure", "description": "The cronjob script bundled with ntp package on Ubuntu Wily is intended to perform cleanup on statistics files produced by NTP daemon running with statistics enabled. The script is run as root during the daily cronjobs all operations on the ntp-user controlled statistics directory without switching to user ntp. Thus all steps are performed with root permissions in place.\n\nDue to multiple bugs in the script, a malicious ntp user can make the backup process to overwrite arbitrary files with content controlled by the attacker, thus gaining root privileges. The problematic parts in /etc/cron.daily/ntp are:\n\nfind \"$statsdir\" -type f -mtime +7 -exec rm {} \\;\n\n# compress whatever is left to save space\ncd \"$statsdir\"\nls *stats.???????? \u003e /dev/null 2\u003e\u00261\nif [ $? -eq 0 ]; then\n\u00a0\u00a0# Note that gzip won't compress the file names that\n\u00a0\u00a0# are hard links to the live/current files, so this\n\u00a0\u00a0# compresses yesterday and previous, leaving the live\n\u00a0\u00a0# log alone.  We supress the warnings gzip issues\n\u00a0\u00a0# about not compressing the linked file.\n\u00a0\u00a0gzip --best --quiet *stats.????????\n\nRelevant targets are:\n\n\u00a0\u00a0\u00a0\u00a0find and rm invocation is racy, symlinks on rm\n\u00a0\u00a0\u00a0\u00a0rm can be invoked with one attacker controlled option\n\u00a0\u00a0\u00a0\u00a0ls can be invoked with arbitrary number of attacker controlled command line options\n\u00a0\u00a0\u00a0\u00a0gzip can be invoked with arbitrary number of attacker controlled options\n\nSee http://www.halfdog.net/Security/2015/NtpCronjobUserNtpToRootPrivilegeEscalation/ for working user ntp to root privilege escalation exploit (User: InvitedOnly, Pass: wtq39EiZ), sharing policy is attached to this issue.\n\n# lsb_release -rd\nDescription:    Ubuntu 15.10\nRelease:        15.10\n# apt-cache policy ntp\nntp:\n\u00a0\u00a0Installed: 1:4.2.6.p5+dfsg-3ubuntu8.1\n\u00a0\u00a0Candidate: 1:4.2.6.p5+dfsg-3ubuntu8.1\n\u00a0\u00a0Version table:\n\u00a0*** 1:4.2.6.p5+dfsg-3ubuntu8.1 0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0500 http://archive.ubuntu.com/ubuntu/ wily-updates/main amd64 Packages\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0500 http://archive.ubuntu.com/ubuntu/ wily-security/main amd64 Packages\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0100 /var/lib/dpkg/status\n\u00a0\u00a0\u00a0\u00a0\u00a01:4.2.6.p5+dfsg-3ubuntu8 0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0500 http://archive.ubuntu.com/ubuntu/ wily/main amd64 Packages", "owner_link": "https://bugs.launchpad.net/api/devel/~halfdog", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/bug_tasks", "duplicate_of_link": null, "date_created": "2015-12-20T20:59:28.993690+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/subscriptions", "date_last_updated": "2016-10-05T17:32:07.067866+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 264, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/attachments", "security_related": true, "latest_patch_uploaded": "2015-12-20T21:01:54.437466+00:00", "tags": ["patch"], "date_last_message": "2016-10-05T17:32:01.970026+00:00", "number_of_duplicates": 0, "message_count": 12, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1528050/linked_merge_proposals", "http_etag": "\"48fc9480bfb0c25c6ad72adcc9373639cd1811d7-a4db245866adbc642914d36f55e6fba650e23264\""}, "total_comments_and_activity": 48, "related_features": {}, "information_type_data": {"PUBLIC": {"is_private": false, "name": "Public", "order": 0, "description": "Everyone can see this information.\n", "value": "PUBLIC", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"is_private": true, "name": "Private Security", "order": 2, "description": "Only the security group can see this information.\n ", "value": "PRIVATESECURITY", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"is_private": false, "name": "Public Security", "order": 1, "description": "Everyone can see this security related information.\n", "value": "PUBLICSECURITY", "description_css_class": "choice-description"}, "USERDATA": {"is_private": true, "name": "Private", "order": 3, "description": "Only shared with users permitted to see private user information.\n", "value": "USERDATA", "description_css_class": "choice-description"}}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/ntp/+bug/1528050", "web_link": "https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1528050", "milestone_link": null, "status": "Fix Released", "importance": "Undecided", "assignee_link": null, "bug_target_display_name": "ntp (Ubuntu)", "bug_target_name": "ntp (Ubuntu)", "bug_watch_link": null, "date_assigned": null, "date_created": "2015-12-20T20:59:28.993690+00:00", "date_confirmed": "2015-12-23T06:25:33.613731+00:00", "date_incomplete": null, "date_in_progress": "2016-06-01T16:58:04.482467+00:00", "date_closed": "2016-06-01T16:58:04.482467+00:00", "date_left_new": "2015-12-23T06:25:33.613731+00:00", "date_triaged": "2016-05-01T15:49:51.191119+00:00", "date_fix_committed": "2016-06-01T16:58:04.482467+00:00", "date_fix_released": "2016-06-01T16:58:04.482467+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~halfdog", "target_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/ntp", "title": "Bug #1528050 in ntp (Ubuntu): \"NTP statsdir cleanup cronjob insecure\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/ntp/+bug/1528050/related_tasks", "is_complete": true, "http_etag": "\"f0c791a13e52685ca3fd7f9b7cdbf375d0ecd9bf-5dd95640665269baac437ef699470e278111a8f8\""}, "bugtask_data": {"2121420": {"delete_link": "https://bugs.launchpad.net/ubuntu/xenial/+source/ntp/+bug/1528050/+delete", "bug_title": "NTP statsdir cleanup cronjob insecure", "user_can_unassign": false, "importance_value": "Undecided", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary2121420", "target_is_product": false, "user_can_edit_milestone": false, "prefix": "ubuntu_xenial_ntp", "bugtask_path": "/ubuntu/xenial/+source/ntp/+bug/1528050", "id": 2121420, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task2121420", "targetname": "ntp (Ubuntu Xenial)", "assignee_is_team": null, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": null, "status_value": "Fix Released"}, "1967261": {"delete_link": "https://bugs.launchpad.net/ubuntu/+source/ntp/+bug/1528050/+delete", "bug_title": "NTP statsdir cleanup cronjob insecure", "user_can_unassign": false, "importance_value": "Undecided", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1967261", "target_is_product": false, "user_can_edit_milestone": false, "prefix": "ubuntu_ntp", "bugtask_path": "/ubuntu/+source/ntp/+bug/1528050", "id": 1967261, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1967261", "targetname": "ntp (Ubuntu)", "assignee_is_team": null, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": null, "status_value": "Fix Released"}, "1992486": {"delete_link": "https://bugs.launchpad.net/ubuntu/wily/+source/ntp/+bug/1528050/+delete", "bug_title": "NTP statsdir cleanup cronjob insecure", "user_can_unassign": false, "importance_value": "Undecided", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1992486", "target_is_product": false, "user_can_edit_milestone": false, "prefix": "ubuntu_wily_ntp", "bugtask_path": "/ubuntu/wily/+source/ntp/+bug/1528050", "id": 1992486, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1992486", "targetname": "ntp (Ubuntu Wily)", "assignee_is_team": null, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": null, "status_value": "Won't Fix"}}, "subscribers_portlet_url_data": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1528050", "web_link": "https://bugs.launchpad.net/bugs/1528050"}, "initial_comment_batch_offset": 41, "first visible_recent_comment": -29};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 68 queries/external actions issued in 1.02 seconds

    Features: {'app.maintenance_message': None, 'hard_timeout': '9000', 'js.yui_version': None, 'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'baselayout.careers_link.disabled': None, 'bugs.affected_count_includes_dupes.disabled': None, 'visible_render_time': None, 'profiling.enabled': None, 'bugs.nominations.bug_supervisors_can_target': 'on'}

    r0d8de2b

    -->

</html>

