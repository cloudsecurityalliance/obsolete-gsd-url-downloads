-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Tue Sep 29 12:42:51 CDT 2009

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/nfs4_advisory.asc
or
ftp://aix.software.ibm.com/aix/efixes/security/nfs4_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX NFSv4 nfs_portmon and Kerberos vulnerabilities.

PLATFORMS:       AIX 5.3, 6.1

SOLUTION:        Apply the fix as described below.

THREAT:          A local user can gain unauthorized access to
                 Kerberized AIX NFSv4 shares.  A remote user can gain
                 unauthorized network access to AIX NFSv4 shares
                 protected by the nfs_portmon tunable.  

CERT VU Number:  n/a
CVE Number:      n/a

Reboot required?    YES*
Workarounds?        NO
Protected by FPM?   NO
Protected by SED?   NO

* For the nfs_portmon fix, the machine must be rebooted to reload the
  NFS kernel extensions.  For the Kerberos fix, the gssd daemon must
  be restarted.

                           DETAILED INFORMATION

I. DESCRIPTION

    There are two security vulnerabilities in the AIX NFSv4 (Network
    File System version 4) implementation.

    The first vulnerability is an error in the handling of the NFSv4
    Kerberos credential cache.  The successful exploitation of this
    vulnerability allows a local user to access Kerberized network
    shares without authorization.

    The second vulnerability is that the nfs_portmon tunable is not
    utilized correctly in NFSv4.  The successful exploitation of this
    vulnerability allows a remote user to access network shares
    protected by nfs_portmon without authorization.

    The following commands are vulnerable: 

        /usr/sbin/gssd
        /usr/lib/drivers/nfs.ext

II. PLATFORM VULNERABILITY ASSESSMENT

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.net.nfs.client

    The following fileset levels are vulnerable:

    AIX Fileset           Lower Level       Upper Level
    ---------------------------------------------------
    bos.net.nfs.client    all earlier versions of 5.3
    bos.net.nfs.client    5.3.7.0           5.3.7.8
    bos.net.nfs.client    5.3.8.0           5.3.8.6
    bos.net.nfs.client    5.3.9.0           5.3.9.2
    bos.net.nfs.client    6.1.0.0           6.1.0.8
    bos.net.nfs.client    6.1.1.0           6.1.1.4
    bos.net.nfs.client    6.1.2.0           6.1.2.3

III. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Availability
        ----------------------------------------------------
        5.3.7               IZ50496            Now (SP9)
        5.3.8               IZ50444            Now (SP7)
        5.3.9               IZ50399            Now (SP4)
        6.1.0               IZ49278            Now (SP9)
        6.1.1               IZ49096            Now (SP5)
        6.1.2               IZ49024            Now (SP4)

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ50496
        http://www.ibm.com/support/docview.wss?uid=isg1IZ50444
        http://www.ibm.com/support/docview.wss?uid=isg1IZ50399
        http://www.ibm.com/support/docview.wss?uid=isg1IZ49278
        http://www.ibm.com/support/docview.wss?uid=isg1IZ49096
        http://www.ibm.com/support/docview.wss?uid=isg1IZ49024

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/nfs4_fix.tar
        ftp://aix.software.ibm.com/aix/efixes/security/nfs4_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

        AIX Level         Fix
        ----------------------------------------------------
        5.3.7             bos.net.nfs.client.5.3.7.9.U
        5.3.8             bos.net.nfs.client.5.3.8.7.U
        5.3.9             bos.net.nfs.client.5.3.9.3.U
        6.1.0             bos.net.nfs.client.6.1.0.9.U
        6.1.1             bos.net.nfs.client.6.1.1.5.U
        6.1.2             bos.net.nfs.client.6.1.2.4.U

        To extract the fixes from the tar file:

        tar xvf nfs4_fix.tar
        cd nfs4_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ----------------------------------------------------------------------
        6498591e2a75f5081f30487220ef205649be34a3  bos.net.nfs.client.5.3.7.9.U
        55ff5576fccb052c05d0432250619ef9e3bd1fe1  bos.net.nfs.client.5.3.8.7.U
        c98585939e0bf02c5b88adbb0bbc48c52d261e07  bos.net.nfs.client.5.3.9.3.U
        d0d3f99ea11fcae97bacd782b904363f60191351  bos.net.nfs.client.6.1.0.9.U
        5c73c73eca95fa782f82ade9c5b56f64217113ab  bos.net.nfs.client.6.1.1.5.U
        a3251008ee0e4e4a67b7e9beff5a0d9550407fcf  bos.net.nfs.client.6.1.2.4.U

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following address:

            security-alert@austin.ibm.com

     C. FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        To preview a fix installation:

        installp -a -d fix_name -p all  # where fix_name is the name of the
                                        # fix package being previewed.
        To install a fix package:

        installp -a -d fix_name -X all  # where fix_name is the name of the  
                                        # fix package being installed.

IV. WORKAROUNDS

    There are no workarounds.

V. OBTAINING FIXES

    AIX security fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security
        or
        ftp://aix.software.ibm.com/aix/efixes/security

    AIX fixes can be downloaded from:

        http://www.ibm.com/eserver/support/fixes/fixcentral/main/pseries/aix

    NOTE: Affected customers are urged to upgrade to the latest
    applicable Technology Level and Service Pack.

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:
 
        A. Download the key from our web page:
 
  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt
 
        B. Download the key from a PGP Public Key Server. The key ID is:
 
            0xADA6EB4D
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    The vulnerabilties were reported by Anton Lundin.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFKwkdYP9Qud62m600RAjxsAJwNxkpMReX6iAv222wuUJLULzEJwQCeLahd
SFVrhFko9oMabu83JeAiYL8=
=Dz6F
-----END PGP SIGNATURE-----
