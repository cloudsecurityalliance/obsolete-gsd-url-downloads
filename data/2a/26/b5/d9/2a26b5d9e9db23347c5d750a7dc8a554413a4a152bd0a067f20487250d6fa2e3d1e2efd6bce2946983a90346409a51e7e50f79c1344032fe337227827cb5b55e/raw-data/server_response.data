<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#330733 - twiki: INCLUDE function allows arbitrary shell command execution - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=330733&quot;&gt;330733&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:330733@bugs.debian.org">#330733</a><br>
twiki: INCLUDE function allows arbitrary shell command execution</h1>
<div class="versiongraph"><a href="version.cgi?info=1;found=twiki%2F20040902-3;collapse=1;absolute=0;package=twiki"><img alt="version graph" src="version.cgi?height=2;collapse=1;package=twiki;width=2;found=twiki%2F20040902-3;absolute=0"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=twiki">twiki</a>;
Maintainer for <a href="pkgreport.cgi?package=twiki">twiki</a> is <a href="pkgreport.cgi?maint=">(unknown)</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=micah%40riseup.net">Micah Anderson &lt;micah@riseup.net&gt;</a></p>
  <p>Date: Thu, 29 Sep 2005 16:03:02 UTC</p>

<p>Severity: <em class="severity">grave</em></p>
<p>Tags: security</p>

<p>Found in version twiki/20040902-3</p>

<p><strong>Done:</strong> Florian Weimer &lt;fw@deneb.enyo.de&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=330733;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<strong>Report forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Debian Security Team &lt;team@security.debian.org&gt;, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>:<br>
<code>Bug#330733</code>; Package <code>twiki</code>.
(<a href="bugreport.cgi?bug=330733;msg=2">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<strong>Acknowledgement sent</strong> to <code>Micah Anderson &lt;micah@riseup.net&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Debian Security Team &lt;team@security.debian.org&gt;, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>.
(<a href="bugreport.cgi?bug=330733;msg=4">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=5">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=5">mbox</a>, <a href="mailto:330733@bugs.debian.org?body=On%20Thu%2C%2029%20Sep%202005%2011%3A28%3A23%20-0400%20Micah%20Anderson%20%3Cmicah%40riseup.net%3E%20wrote%3A%0A%3E%20Package%3A%20twiki%0A%3E%20Version%3A%2020040902-3%0A%3E%20Severity%3A%20grave%0A%3E%20Tags%3A%20security%0A%3E%20Justification%3A%20user%20security%20hole%0A%3E%20%0A%3E%20A%20new%20security%20bug%20in%20twiki%20showed%20up%20today%3A%0A%3E%20http%3A%2F%2Ftwiki.org%2Fcgi-bin%2Fview%2FCodev%2FSecurityAlertExecuteCommandsWithInclude%0A%3E%20%0A%3E%20An%20attacker%20is%20able%20to%20execute%20arbitrary%20shell%20commands%20with%20the%0A%3E%20privileges%20of%20the%20web%20server%20process.%20The%20TWiki%20INCLUDE%20function%0A%3E%20enables%20a%20malicious%20user%20to%20compose%20a%20command%20line%20executed%20by%20the%0A%3E%20Perl%20backtick%20%28%60%29%20operator.%0A%3E%20%0A%3E%20The%20rev%20parameter%20of%20the%20INCLUDE%20variable%20is%20not%20checked%20properly%20for%0A%3E%20shell%20metacharacters%20and%20is%20thus%20vulnerable%20to%20revision%20numbers%0A%3E%20containing%20pipes%20and%20shell%20commands.%20The%20exploit%20is%20possible%20on%0A%3E%20included%20topics%20with%20two%20or%20more%20revisions.%0A%3E%20%0A%3E%20Example%20INCLUDE%20variable%20exploiting%20the%20rev%20parameter%3A%0A%3E%20%25INCLUDE%7B%20%22Main.TWikiUsers%22%20rev%3D%222%7Cless%20%2Fetc%2Fpasswd%22%20%7D%25%0A%3E%20%0A%3E%20The%20same%20vulnerability%20is%20exposed%20to%20all%20Plugins%20and%20add-ons%20that%20use%0A%3E%20TWiki%3A%3AFunc%3A%3AreadTopicText%20function%20to%20read%20a%20previous%20topic%20revision.%0A%3E%20This%20has%20been%20tested%20on%20TWiki%3APlugins.RevCommentPlugin%20and%0A%3E%20TWiki%3APlugins.CompareRevisionsAddon.%0A%3E%20%0A%3E%20If%20access%20to%20TWiki%20is%20not%20restricted%20by%20other%20means%2C%20attackers%20can%20use%0A%3E%20the%20revision%20function%20with%20or%20without%20prior%20authentication%2C%20depending%0A%3E%20on%20the%20configuration.%20%0A%3E%20%0A%3E%20The%20Common%20Vulnerabilities%20and%20Exposures%20project%20has%20assigned%20the%20name%0A%3E%20CAN-2005-3056%20to%20this%20vulnerability.%20Please%20include%20this%20number%20in%20any%0A%3E%20changelogs%20fixing%20this.%0A%3E%20%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%20testing%2Funstable%0A%3E%20%20%20APT%20prefers%20testing%0A%3E%20%20%20APT%20policy%3A%20%28990%2C%20%27testing%27%29%2C%20%28500%2C%20%27unstable%27%29%0A%3E%20Architecture%3A%20i386%20%28i686%29%0A%3E%20Shell%3A%20%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fbash%0A%3E%20Kernel%3A%20Linux%202.6.8-2-k7%0A%3E%20Locale%3A%20LANG%3Den_US.UTF-8%2C%20LC_CTYPE%3Den_US.UTF-8%20%28charmap%3DUTF-8%29%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20050929152823.6BDAC3A847%40pond%3E&amp;subject=Re%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%20execution&amp;References=%3C20050929152823.6BDAC3A847%40pond%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=micah%40riseup.net" alt="">
<div class="header"><span class="headerfield">From:</span> Micah Anderson &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> twiki: INCLUDE function allows arbitrary shell command execution</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 29 Sep 2005 11:28:23 -0400</div>
</div>
<pre class="message">Package: twiki
Version: 20040902-3
Severity: grave
Tags: security
Justification: user security hole

A new security bug in twiki showed up today:
<a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>

An attacker is able to execute arbitrary shell commands with the
privileges of the web server process. The TWiki INCLUDE function
enables a malicious user to compose a command line executed by the
Perl backtick (`) operator.

The rev parameter of the INCLUDE variable is not checked properly for
shell metacharacters and is thus vulnerable to revision numbers
containing pipes and shell commands. The exploit is possible on
included topics with two or more revisions.

Example INCLUDE variable exploiting the rev parameter:
%INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%

The same vulnerability is exposed to all Plugins and add-ons that use
TWiki::Func::readTopicText function to read a previous topic revision.
This has been tested on TWiki:Plugins.RevCommentPlugin and
TWiki:Plugins.CompareRevisionsAddon.

If access to TWiki is not restricted by other means, attackers can use
the revision function with or without prior authentication, depending
on the configuration. 

The Common Vulnerabilities and Exposures project has assigned the name
CAN-2005-3056 to this vulnerability. Please include this number in any
changelogs fixing this.


-- System Information:
Debian Release: testing/unstable
  APT prefers testing
  APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.8-2-k7
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)


</pre>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<strong>Reply sent</strong> to <code>Florian Weimer &lt;fw@deneb.enyo.de&gt;</code>:<br>
You have taken responsibility.
(<a href="bugreport.cgi?bug=330733;msg=7">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<strong>Notification sent</strong> to <code>Micah Anderson &lt;micah@riseup.net&gt;</code>:<br>
Bug acknowledged by developer.
(<a href="bugreport.cgi?bug=330733;msg=9">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 330733-done@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=10">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=10">mbox</a>, <a href="mailto:330733@bugs.debian.org?References=%3C20050929152823.6BDAC3A847%40pond%3E%0A%20%3C87irwjpvfj.fsf%40mid.deneb.enyo.de%3E&amp;subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%20execution&amp;In-Reply-To=%3C87irwjpvfj.fsf%40mid.deneb.enyo.de%3E&amp;body=On%20Thu%2C%2029%20Sep%202005%2020%3A42%3A40%20%2B0200%20Florian%20Weimer%20%3Cfw%40deneb.enyo.de%3E%20wrote%3A%0A%3E%20%2A%20Micah%20Anderson%3A%0A%3E%20%0A%3E%20%3E%20A%20new%20security%20bug%20in%20twiki%20showed%20up%20today%3A%0A%3E%20%3E%20http%3A%2F%2Ftwiki.org%2Fcgi-bin%2Fview%2FCodev%2FSecurityAlertExecuteCommandsWithInclude%0A%3E%20%0A%3E%20This%20bug%20has%20already%20been%20fixed%20in%20Debian%20version%2020040902-2%2C%20as%20far%0A%3E%20as%20I%20know.%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de" alt="">
<div class="header"><span class="headerfield">From:</span> Florian Weimer &lt;fw@deneb.enyo.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> Micah Anderson &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 330733-done@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command execution</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 29 Sep 2005 20:42:40 +0200</div>
</div>
<pre class="message">* Micah Anderson:

&gt; A new security bug in twiki showed up today:
&gt; <a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>

This bug has already been fixed in Debian version 20040902-2, as far
as I know.


</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>:<br>
<code>Bug#330733</code>; Package <code>twiki</code>.
(<a href="bugreport.cgi?bug=330733;msg=12">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<strong>Acknowledgement sent</strong> to <code>Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>.
(<a href="bugreport.cgi?bug=330733;msg=14">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 330733@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=15">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=15">mbox</a>, <a href="mailto:330733@bugs.debian.org?body=On%20Thu%2C%2029%20Sep%202005%2022%3A25%3A00%20%2B0200%20Sven%20Dowideit%20%3CSvenDowideit%40home.org.au%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20excellent.%0A%3E%20%0A%3E%20Micah%2C%20did%20you%20manage%20to%20reproduce%20this%20in%20the%20debian%20package%20at%20all%3F%0A%3E%20%0A%3E%20you%20see%2C%20the%20debian%20package%20is%20significantly%20more%20secure%20than%20the%0A%3E%20upstream%20version%2C%20and%20as%20you%27ve%20marked%20it%20as%20grave%2C%20I%20presume%20that%20you%0A%3E%20have%20found%20a%20way%20to%20make%20it%20happen.%20%28as%20when%20I%20had%20a%20go%2C%20i%20did%20not%20get%0A%3E%20the%20exploit%20%28i%20got%20a%20unhelpful%2C%20but%20correct%20error%20message%20%22invalid%0A%3E%20number%20argument%20at%20%2Fusr%2Fshare%2Fperl5%2FTWiki.pm%20line%203339.%22%29%0A%3E%20%0A%3E%20could%20you%20please%20either%20tell%20me%20how%20to%20reproduce%20the%20problem%20in%20the%0A%3E%20current%20debian%20package%2C%20or%20close%20it%3F%0A%3E%20%0A%3E%20Cheers%0A%3E%20%0A%3E%20Sven%0A%3E%20%0A%3E%20Micah%20Anderson%20wrote%3A%0A%3E%20%3E%20Package%3A%20twiki%0A%3E%20%3E%20Version%3A%2020040902-3%0A%3E%20%3E%20Severity%3A%20grave%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%3E%20Justification%3A%20user%20security%20hole%0A%3E%20%3E%20%0A%3E%20%3E%20A%20new%20security%20bug%20in%20twiki%20showed%20up%20today%3A%0A%3E%20%3E%20http%3A%2F%2Ftwiki.org%2Fcgi-bin%2Fview%2FCodev%2FSecurityAlertExecuteCommandsWithInclude%0A%3E%20%3E%20%0A%3E%20%3E%20An%20attacker%20is%20able%20to%20execute%20arbitrary%20shell%20commands%20with%20the%0A%3E%20%3E%20privileges%20of%20the%20web%20server%20process.%20The%20TWiki%20INCLUDE%20function%0A%3E%20%3E%20enables%20a%20malicious%20user%20to%20compose%20a%20command%20line%20executed%20by%20the%0A%3E%20%3E%20Perl%20backtick%20%28%60%29%20operator.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20rev%20parameter%20of%20the%20INCLUDE%20variable%20is%20not%20checked%20properly%20for%0A%3E%20%3E%20shell%20metacharacters%20and%20is%20thus%20vulnerable%20to%20revision%20numbers%0A%3E%20%3E%20containing%20pipes%20and%20shell%20commands.%20The%20exploit%20is%20possible%20on%0A%3E%20%3E%20included%20topics%20with%20two%20or%20more%20revisions.%0A%3E%20%3E%20%0A%3E%20%3E%20Example%20INCLUDE%20variable%20exploiting%20the%20rev%20parameter%3A%0A%3E%20%3E%20%25INCLUDE%7B%20%22Main.TWikiUsers%22%20rev%3D%222%7Cless%20%2Fetc%2Fpasswd%22%20%7D%25%0A%3E%20%3E%20%0A%3E%20%3E%20The%20same%20vulnerability%20is%20exposed%20to%20all%20Plugins%20and%20add-ons%20that%20use%0A%3E%20%3E%20TWiki%3A%3AFunc%3A%3AreadTopicText%20function%20to%20read%20a%20previous%20topic%20revision.%0A%3E%20%3E%20This%20has%20been%20tested%20on%20TWiki%3APlugins.RevCommentPlugin%20and%0A%3E%20%3E%20TWiki%3APlugins.CompareRevisionsAddon.%0A%3E%20%3E%20%0A%3E%20%3E%20If%20access%20to%20TWiki%20is%20not%20restricted%20by%20other%20means%2C%20attackers%20can%20use%0A%3E%20%3E%20the%20revision%20function%20with%20or%20without%20prior%20authentication%2C%20depending%0A%3E%20%3E%20on%20the%20configuration.%20%0A%3E%20%3E%20%0A%3E%20%3E%20The%20Common%20Vulnerabilities%20and%20Exposures%20project%20has%20assigned%20the%20name%0A%3E%20%3E%20CAN-2005-3056%20to%20this%20vulnerability.%20Please%20include%20this%20number%20in%20any%0A%3E%20%3E%20changelogs%20fixing%20this.%0A%3E%20%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20--%20System%20Information%3A%0A%3E%20%3E%20Debian%20Release%3A%20testing%2Funstable%0A%3E%20%3E%20%20%20APT%20prefers%20testing%0A&amp;In-Reply-To=%3C433C4D9C.2040305%40home.org.au%3E&amp;References=%3C20050929152823.6BDAC3A847%40pond%3E%0A%20%3C433C4D9C.2040305%40home.org.au%3E&amp;subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%0A%20execution">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au" alt="">
<div class="header"><span class="headerfield">From:</span> Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</div>
<div class="header"><span class="headerfield">To:</span> Micah Anderson &lt;micah@riseup.net&gt;,  330733@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command
 execution</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 29 Sep 2005 22:25:00 +0200</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

excellent.

Micah, did you manage to reproduce this in the debian package at all?

you see, the debian package is significantly more secure than the
upstream version, and as you&#39;ve marked it as grave, I presume that you
have found a way to make it happen. (as when I had a go, i did not get
the exploit (i got a unhelpful, but correct error message &quot;invalid
number argument at /usr/share/perl5/TWiki.pm line 3339.&quot;)

could you please either tell me how to reproduce the problem in the
current debian package, or close it?

Cheers

Sven

Micah Anderson wrote:
&gt; Package: twiki
&gt; Version: 20040902-3
&gt; Severity: grave
&gt; Tags: security
&gt; Justification: user security hole
&gt; 
&gt; A new security bug in twiki showed up today:
&gt; <a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>
&gt; 
&gt; An attacker is able to execute arbitrary shell commands with the
&gt; privileges of the web server process. The TWiki INCLUDE function
&gt; enables a malicious user to compose a command line executed by the
&gt; Perl backtick (`) operator.
&gt; 
&gt; The rev parameter of the INCLUDE variable is not checked properly for
&gt; shell metacharacters and is thus vulnerable to revision numbers
&gt; containing pipes and shell commands. The exploit is possible on
&gt; included topics with two or more revisions.
&gt; 
&gt; Example INCLUDE variable exploiting the rev parameter:
&gt; %INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%
&gt; 
&gt; The same vulnerability is exposed to all Plugins and add-ons that use
&gt; TWiki::Func::readTopicText function to read a previous topic revision.
&gt; This has been tested on TWiki:Plugins.RevCommentPlugin and
&gt; TWiki:Plugins.CompareRevisionsAddon.
&gt; 
&gt; If access to TWiki is not restricted by other means, attackers can use
&gt; the revision function with or without prior authentication, depending
&gt; on the configuration. 
&gt; 
&gt; The Common Vulnerabilities and Exposures project has assigned the name
&gt; CAN-2005-3056 to this vulnerability. Please include this number in any
&gt; changelogs fixing this.
&gt; 
&gt; 
&gt; -- System Information:
&gt; Debian Release: testing/unstable
&gt;   APT prefers testing
&gt;   APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
&gt; Architecture: i386 (i686)
&gt; Shell:  /bin/sh linked to /bin/bash
&gt; Kernel: Linux 2.6.8-2-k7
&gt; Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
&gt; 
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - <a href="http://enigmail.mozdev.org">http://enigmail.mozdev.org</a>

iD8DBQFDPE2aPAwzu0QrW+kRAqZLAJ90bJEaXjUiwrkNcOu/U25JiLXAjgCeMoiy
VRnVrGHfBUXGaRpLZR8JP0M=
=5784
-----END PGP SIGNATURE-----


</pre>

<div class="infmessage"><hr><p>
<a name="16"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>:<br>
<code>Bug#330733</code>; Package <code>twiki</code>.
(<a href="bugreport.cgi?bug=330733;msg=17">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="18"></a>
<strong>Acknowledgement sent</strong> to <code>micah &lt;micah@riseup.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>.
(<a href="bugreport.cgi?bug=330733;msg=19">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="20"></a><a name="msg20"></a><a href="#20">Message #20</a> received at 330733@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=20">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=20">mbox</a>, <a href="mailto:330733@bugs.debian.org?subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%0A%20execution&amp;References=%3C20050929152823.6BDAC3A847%40pond%3E%20%3C433C4D9C.2040305%40home.org.au%3E%0A%20%3C4341E2D2.6020003%40riseup.net%3E&amp;In-Reply-To=%3C4341E2D2.6020003%40riseup.net%3E&amp;body=On%20Mon%2C%2003%20Oct%202005%2022%3A02%3A58%20-0400%20micah%20%3Cmicah%40riseup.net%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Sven%2C%0A%3E%20%0A%3E%20I%20have%20not%20attempted%20to%20reproduce%20this%20in%20the%20debian%20package%2C%20I%27m%0A%3E%20tracking%20known%20vulnerabilities%20with%20the%20testing-security%20team.%20When%20I%0A%3E%20see%20a%20new%20CVE%20id%20assigned%20to%20a%20package%20and%20no%20bugs%20filed%20on%20that%20package%0A%3E%20regarding%20that%20CVE%2C%20and%20no%20entries%20in%20the%20changelogs%20noting%20that%20it%20has%0A%3E%20been%20fixed%2C%20I%20tend%20to%20believe%20that%20it%20hasn%27t%20been%20because%20it%20is%20a%20rare%0A%3E%20package%20maintainer%20who%20has%20security%20issues%20fixed%20before%20they%20are%0A%3E%20discovered%20or%20announced.%0A%3E%20%0A%3E%20Additionally%2C%20the%20advisory%20indicates%20that%20the%20version%20in%20debian%0A%3E%20%2820040902-3%29%20is%20affected%2C%20as%20the%20only%20versions%20it%20indicates%20are%20safe%20is%0A%3E%20the%20TWikiRelease01Sep2004%20patched%20with%20Florian%20Weimer%27s%0A%3E%20UncoordinatedSecurityAlert23Feb2005%20patches.%20Without%20any%20indication%20in%0A%3E%20the%20BTS%20or%20in%20changelogs%2C%20I%20assume%20that%20the%20package%20is%20affected%20because%0A%3E%20the%20version%20numbers%20typically%20are%20very%20good%20indicators.%20Admittedly%2C%20you%0A%3E%20could%20very%20well%20have%20addressed%20this%20issue%2C%20and%20I%20have%20a%20feeling%20that%20you%0A%3E%20have%20as%20Florian%20is%20very%20active%20in%20Debian.%20If%20so%2C%20I%27d%20be%20happy%20to%20know%0A%3E%20that%2C%20and%20we%20can%20close%20this%20bug%2C%20so%20I%20can%20note%20it%20in%20the%0A%3E%20testing-security%20database.%0A%3E%20%0A%3E%20Unfortunately%2C%20if%20I%20had%20to%20try%20every%20exploit%2C%20even%20those%20without%0A%3E%20published%20exploits%2C%20for%20every%20CVE%20assigned%2C%20there%20would%20be%20a%20net%20loss.%20I%0A%3E%20understand%20that%20this%20means%20this%20is%20an%20annoyance%20to%20you%20to%20get%20a%20grave%0A%3E%20bug%20report%20for%20something%20that%20you%20may%20have%20addressed%2C%20however%20it%20ends%20up%0A%3E%20being%20a%20good%20thing%20because%20then%20we%20know%20for%20sure%2C%20and%20can%20better%20track%0A%3E%20vulnerabilities%20in%20Debian.%20It%20is%20better%20to%20be%20asked%20once%20if%20this%20is%20an%0A%3E%20issue%20and%20have%20it%20properly%20noted%2C%20than%20for%20Debian%20to%20not%20pay%20attention%0A%3E%20to%20anything%20at%20all%20and%20be%20riddled%20with%20security%20holes.%0A%3E%20%0A%3E%20micah%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20Sven%20Dowideit%20wrote%3A%0A%3E%20%3E%20excellent.%0A%3E%20%3E%20%0A%3E%20%3E%20Micah%2C%20did%20you%20manage%20to%20reproduce%20this%20in%20the%20debian%20package%20at%20all%3F%0A%3E%20%3E%20%0A%3E%20%3E%20you%20see%2C%20the%20debian%20package%20is%20significantly%20more%20secure%20than%20the%0A%3E%20%3E%20upstream%20version%2C%20and%20as%20you%27ve%20marked%20it%20as%20grave%2C%20I%20presume%20that%20you%0A%3E%20%3E%20have%20found%20a%20way%20to%20make%20it%20happen.%20%28as%20when%20I%20had%20a%20go%2C%20i%20did%20not%20get%0A%3E%20%3E%20the%20exploit%20%28i%20got%20a%20unhelpful%2C%20but%20correct%20error%20message%20%22invalid%0A%3E%20%3E%20number%20argument%20at%20%2Fusr%2Fshare%2Fperl5%2FTWiki.pm%20line%203339.%22%29%0A%3E%20%3E%20%0A%3E%20%3E%20could%20you%20please%20either%20tell%20me%20how%20to%20reproduce%20the%20problem%20in%20the%0A%3E%20%3E%20current%20debian%20package%2C%20or%20close%20it%3F%0A%3E%20%3E%20%0A%3E%20%3E%20Cheers%0A%3E%20%3E%20%0A%3E%20%3E%20Sven%0A%3E%20%3E%20%0A%3E%20%3E%20Micah%20Anderson%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%3E%3EPackage%3A%20twiki%0A%3E%20%3E%3E%3EVersion%3A%2020040902-3%0A%3E%20%3E%3E%3ESeverity%3A%20grave%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=micah%40riseup.net" alt="">
<div class="header"><span class="headerfield">From:</span> micah &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 330733@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command
 execution</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 03 Oct 2005 22:02:58 -0400</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Sven,

I have not attempted to reproduce this in the debian package, I&#39;m
tracking known vulnerabilities with the testing-security team. When I
see a new CVE id assigned to a package and no bugs filed on that package
regarding that CVE, and no entries in the changelogs noting that it has
been fixed, I tend to believe that it hasn&#39;t been because it is a rare
package maintainer who has security issues fixed before they are
discovered or announced.

Additionally, the advisory indicates that the version in debian
(20040902-3) is affected, as the only versions it indicates are safe is
the TWikiRelease01Sep2004 patched with Florian Weimer&#39;s
UncoordinatedSecurityAlert23Feb2005 patches. Without any indication in
the BTS or in changelogs, I assume that the package is affected because
the version numbers typically are very good indicators. Admittedly, you
could very well have addressed this issue, and I have a feeling that you
have as Florian is very active in Debian. If so, I&#39;d be happy to know
that, and we can close this bug, so I can note it in the
testing-security database.

Unfortunately, if I had to try every exploit, even those without
published exploits, for every CVE assigned, there would be a net loss. I
understand that this means this is an annoyance to you to get a grave
bug report for something that you may have addressed, however it ends up
being a good thing because then we know for sure, and can better track
vulnerabilities in Debian. It is better to be asked once if this is an
issue and have it properly noted, than for Debian to not pay attention
to anything at all and be riddled with security holes.

micah



Sven Dowideit wrote:
&gt; excellent.
&gt; 
&gt; Micah, did you manage to reproduce this in the debian package at all?
&gt; 
&gt; you see, the debian package is significantly more secure than the
&gt; upstream version, and as you&#39;ve marked it as grave, I presume that you
&gt; have found a way to make it happen. (as when I had a go, i did not get
&gt; the exploit (i got a unhelpful, but correct error message &quot;invalid
&gt; number argument at /usr/share/perl5/TWiki.pm line 3339.&quot;)
&gt; 
&gt; could you please either tell me how to reproduce the problem in the
&gt; current debian package, or close it?
&gt; 
&gt; Cheers
&gt; 
&gt; Sven
&gt; 
&gt; Micah Anderson wrote:
&gt; 
&gt;&gt;&gt;Package: twiki
&gt;&gt;&gt;Version: 20040902-3
&gt;&gt;&gt;Severity: grave
&gt;&gt;&gt;Tags: security
&gt;&gt;&gt;Justification: user security hole
&gt;&gt;&gt;
&gt;&gt;&gt;A new security bug in twiki showed up today:
&gt;&gt;&gt;<a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>
&gt;&gt;&gt;
&gt;&gt;&gt;An attacker is able to execute arbitrary shell commands with the
&gt;&gt;&gt;privileges of the web server process. The TWiki INCLUDE function
&gt;&gt;&gt;enables a malicious user to compose a command line executed by the
&gt;&gt;&gt;Perl backtick (`) operator.
&gt;&gt;&gt;
&gt;&gt;&gt;The rev parameter of the INCLUDE variable is not checked properly for
&gt;&gt;&gt;shell metacharacters and is thus vulnerable to revision numbers
&gt;&gt;&gt;containing pipes and shell commands. The exploit is possible on
&gt;&gt;&gt;included topics with two or more revisions.
&gt;&gt;&gt;
&gt;&gt;&gt;Example INCLUDE variable exploiting the rev parameter:
&gt;&gt;&gt;%INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%
&gt;&gt;&gt;
&gt;&gt;&gt;The same vulnerability is exposed to all Plugins and add-ons that use
&gt;&gt;&gt;TWiki::Func::readTopicText function to read a previous topic revision.
&gt;&gt;&gt;This has been tested on TWiki:Plugins.RevCommentPlugin and
&gt;&gt;&gt;TWiki:Plugins.CompareRevisionsAddon.
&gt;&gt;&gt;
&gt;&gt;&gt;If access to TWiki is not restricted by other means, attackers can use
&gt;&gt;&gt;the revision function with or without prior authentication, depending
&gt;&gt;&gt;on the configuration. 
&gt;&gt;&gt;
&gt;&gt;&gt;The Common Vulnerabilities and Exposures project has assigned the name
&gt;&gt;&gt;CAN-2005-3056 to this vulnerability. Please include this number in any
&gt;&gt;&gt;changelogs fixing this.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;-- System Information:
&gt;&gt;&gt;Debian Release: testing/unstable
&gt;&gt;&gt;  APT prefers testing
&gt;&gt;&gt;  APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
&gt;&gt;&gt;Architecture: i386 (i686)
&gt;&gt;&gt;Shell:  /bin/sh linked to /bin/bash
&gt;&gt;&gt;Kernel: Linux 2.6.8-2-k7
&gt;&gt;&gt;Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
&gt;&gt;&gt;
&gt; 
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iD8DBQFDQeLS9n4qXRzy1ioRAh14AJ94XXJC7UaX0vlpo+VIOqr+qRHM0QCfYf1Q
9ftwzksPFsreIMdvPx4Du2A=
=Khzi
-----END PGP SIGNATURE-----


</pre>

<div class="infmessage"><hr><p>
<a name="21"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>:<br>
<code>Bug#330733</code>; Package <code>twiki</code>.
(<a href="bugreport.cgi?bug=330733;msg=22">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="23"></a>
<strong>Acknowledgement sent</strong> to <code>Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>.
(<a href="bugreport.cgi?bug=330733;msg=24">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="25"></a><a name="msg25"></a><a href="#25">Message #25</a> received at 330733@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=25">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=25">mbox</a>, <a href="mailto:330733@bugs.debian.org?body=On%20Tue%2C%2004%20Oct%202005%2008%3A55%3A57%20%2B0200%20Sven%20Dowideit%20%3CSvenDowideit%40home.org.au%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20while%20I%20think%20its%20very%20reasonable%20for%20you%20to%20send%20along%20these%0A%3E%20advisories%2C%20and%20even%20doing%20so%20as%20a%20BTS%20bug%20wothout%20testing%20them%0A%3E%20%0A%3E%20I%20think%20its%20incredibly%20rude%20to%20do%20so%20without%20saying%20that%20you%20have%20not%0A%3E%20tested%20it%20out.%0A%3E%20%0A%3E%20please%2C%20if%20you%20enter%20a%20bug%20report%2C%20tell%20the%20maintainer%20what%20you%20have%20or%0A%3E%20have%20not%20done%2C%20that%20way%20they%20can%20deal%20more%20appropriatly%20with%20the%20issue%0A%3E%20%0A%3E%20%28in%20the%20cases%20where%20the%20core%20issue%20has%20been%20dealt%20with%20%28thanks%20to%0A%3E%20Florian%21%29%20I%27m%20very%20busy%20helping%20out%20upstream%2C%20and%20i%27m%20sure%20this%0A%3E%20situation%20_should_%20apply%20to%20others%20%28i%20object%20to%20the%20number%20of%20debian%0A%3E%20maintainers%20that%20are%20not%20appropriatly%20active%20upstream%29%0A%3E%20%0A%3E%20however%2C%20other%20than%20my%20rant%20%3A%29%20thanks%20for%20the%20notification%2C%20its%0A%3E%20important%20%28i%27m%20still%20notifying%20people%20now%29%0A%3E%20%0A%3E%20Sven%0A%3E%20%0A%3E%20micah%20wrote%3A%0A%3E%20%3E%20Sven%2C%0A%3E%20%3E%20%0A%3E%20%3E%20I%20have%20not%20attempted%20to%20reproduce%20this%20in%20the%20debian%20package%2C%20I%27m%0A%3E%20%3E%20tracking%20known%20vulnerabilities%20with%20the%20testing-security%20team.%20When%20I%0A%3E%20%3E%20see%20a%20new%20CVE%20id%20assigned%20to%20a%20package%20and%20no%20bugs%20filed%20on%20that%20package%0A%3E%20%3E%20regarding%20that%20CVE%2C%20and%20no%20entries%20in%20the%20changelogs%20noting%20that%20it%20has%0A%3E%20%3E%20been%20fixed%2C%20I%20tend%20to%20believe%20that%20it%20hasn%27t%20been%20because%20it%20is%20a%20rare%0A%3E%20%3E%20package%20maintainer%20who%20has%20security%20issues%20fixed%20before%20they%20are%0A%3E%20%3E%20discovered%20or%20announced.%0A%3E%20%3E%20%0A%3E%20%3E%20Additionally%2C%20the%20advisory%20indicates%20that%20the%20version%20in%20debian%0A%3E%20%3E%20%2820040902-3%29%20is%20affected%2C%20as%20the%20only%20versions%20it%20indicates%20are%20safe%20is%0A%3E%20%3E%20the%20TWikiRelease01Sep2004%20patched%20with%20Florian%20Weimer%27s%0A%3E%20%3E%20UncoordinatedSecurityAlert23Feb2005%20patches.%20Without%20any%20indication%20in%0A%3E%20%3E%20the%20BTS%20or%20in%20changelogs%2C%20I%20assume%20that%20the%20package%20is%20affected%20because%0A%3E%20%3E%20the%20version%20numbers%20typically%20are%20very%20good%20indicators.%20Admittedly%2C%20you%0A%3E%20%3E%20could%20very%20well%20have%20addressed%20this%20issue%2C%20and%20I%20have%20a%20feeling%20that%20you%0A%3E%20%3E%20have%20as%20Florian%20is%20very%20active%20in%20Debian.%20If%20so%2C%20I%27d%20be%20happy%20to%20know%0A%3E%20%3E%20that%2C%20and%20we%20can%20close%20this%20bug%2C%20so%20I%20can%20note%20it%20in%20the%0A%3E%20%3E%20testing-security%20database.%0A%3E%20%3E%20%0A%3E%20%3E%20Unfortunately%2C%20if%20I%20had%20to%20try%20every%20exploit%2C%20even%20those%20without%0A%3E%20%3E%20published%20exploits%2C%20for%20every%20CVE%20assigned%2C%20there%20would%20be%20a%20net%20loss.%20I%0A%3E%20%3E%20understand%20that%20this%20means%20this%20is%20an%20annoyance%20to%20you%20to%20get%20a%20grave%0A%3E%20%3E%20bug%20report%20for%20something%20that%20you%20may%20have%20addressed%2C%20however%20it%20ends%20up%0A%3E%20%3E%20being%20a%20good%20thing%20because%20then%20we%20know%20for%20sure%2C%20and%20can%20better%20track%0A%3E%20%3E%20vulnerabilities%20in%20Debian.%20It%20is%20better%20to%20be%20asked%20once%20if%20this%20is%20an%0A%3E%20%3E%20issue%20and%20have%20it%20properly%20noted%2C%20than%20for%20Debian%20to%20not%20pay%20attention%0A%3E%20%3E%20to%20anything%20at%20all%20and%20be%20riddled%20with%20security%20holes.%0A%3E%20%3E%20%0A%3E%20%3E%20micah%0A%3E%20%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20Sven%20Dowideit%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%3E%3Eexcellent.%0A&amp;In-Reply-To=%3C4342277D.9030901%40home.org.au%3E&amp;References=%3C20050929152823.6BDAC3A847%40pond%3E%20%3C433C4D9C.2040305%40home.org.au%3E%20%3C4341E2D2.6020003%40riseup.net%3E%0A%20%3C4342277D.9030901%40home.org.au%3E&amp;subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%0A%20execution">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au" alt="">
<div class="header"><span class="headerfield">From:</span> Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</div>
<div class="header"><span class="headerfield">To:</span> micah &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 330733@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command
 execution</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 04 Oct 2005 08:55:57 +0200</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

while I think its very reasonable for you to send along these
advisories, and even doing so as a BTS bug wothout testing them

I think its incredibly rude to do so without saying that you have not
tested it out.

please, if you enter a bug report, tell the maintainer what you have or
have not done, that way they can deal more appropriatly with the issue

(in the cases where the core issue has been dealt with (thanks to
Florian!) I&#39;m very busy helping out upstream, and i&#39;m sure this
situation _should_ apply to others (i object to the number of debian
maintainers that are not appropriatly active upstream)

however, other than my rant :) thanks for the notification, its
important (i&#39;m still notifying people now)

Sven

micah wrote:
&gt; Sven,
&gt; 
&gt; I have not attempted to reproduce this in the debian package, I&#39;m
&gt; tracking known vulnerabilities with the testing-security team. When I
&gt; see a new CVE id assigned to a package and no bugs filed on that package
&gt; regarding that CVE, and no entries in the changelogs noting that it has
&gt; been fixed, I tend to believe that it hasn&#39;t been because it is a rare
&gt; package maintainer who has security issues fixed before they are
&gt; discovered or announced.
&gt; 
&gt; Additionally, the advisory indicates that the version in debian
&gt; (20040902-3) is affected, as the only versions it indicates are safe is
&gt; the TWikiRelease01Sep2004 patched with Florian Weimer&#39;s
&gt; UncoordinatedSecurityAlert23Feb2005 patches. Without any indication in
&gt; the BTS or in changelogs, I assume that the package is affected because
&gt; the version numbers typically are very good indicators. Admittedly, you
&gt; could very well have addressed this issue, and I have a feeling that you
&gt; have as Florian is very active in Debian. If so, I&#39;d be happy to know
&gt; that, and we can close this bug, so I can note it in the
&gt; testing-security database.
&gt; 
&gt; Unfortunately, if I had to try every exploit, even those without
&gt; published exploits, for every CVE assigned, there would be a net loss. I
&gt; understand that this means this is an annoyance to you to get a grave
&gt; bug report for something that you may have addressed, however it ends up
&gt; being a good thing because then we know for sure, and can better track
&gt; vulnerabilities in Debian. It is better to be asked once if this is an
&gt; issue and have it properly noted, than for Debian to not pay attention
&gt; to anything at all and be riddled with security holes.
&gt; 
&gt; micah
&gt; 
&gt; 
&gt; 
&gt; Sven Dowideit wrote:
&gt; 
&gt;&gt;&gt;excellent.
&gt;&gt;&gt;
&gt;&gt;&gt;Micah, did you manage to reproduce this in the debian package at all?
&gt;&gt;&gt;
&gt;&gt;&gt;you see, the debian package is significantly more secure than the
&gt;&gt;&gt;upstream version, and as you&#39;ve marked it as grave, I presume that you
&gt;&gt;&gt;have found a way to make it happen. (as when I had a go, i did not get
&gt;&gt;&gt;the exploit (i got a unhelpful, but correct error message &quot;invalid
&gt;&gt;&gt;number argument at /usr/share/perl5/TWiki.pm line 3339.&quot;)
&gt;&gt;&gt;
&gt;&gt;&gt;could you please either tell me how to reproduce the problem in the
&gt;&gt;&gt;current debian package, or close it?
&gt;&gt;&gt;
&gt;&gt;&gt;Cheers
&gt;&gt;&gt;
&gt;&gt;&gt;Sven
&gt;&gt;&gt;
&gt;&gt;&gt;Micah Anderson wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Package: twiki
&gt;&gt;&gt;&gt;&gt;Version: 20040902-3
&gt;&gt;&gt;&gt;&gt;Severity: grave
&gt;&gt;&gt;&gt;&gt;Tags: security
&gt;&gt;&gt;&gt;&gt;Justification: user security hole
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;A new security bug in twiki showed up today:
&gt;&gt;&gt;&gt;&gt;<a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;An attacker is able to execute arbitrary shell commands with the
&gt;&gt;&gt;&gt;&gt;privileges of the web server process. The TWiki INCLUDE function
&gt;&gt;&gt;&gt;&gt;enables a malicious user to compose a command line executed by the
&gt;&gt;&gt;&gt;&gt;Perl backtick (`) operator.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;The rev parameter of the INCLUDE variable is not checked properly for
&gt;&gt;&gt;&gt;&gt;shell metacharacters and is thus vulnerable to revision numbers
&gt;&gt;&gt;&gt;&gt;containing pipes and shell commands. The exploit is possible on
&gt;&gt;&gt;&gt;&gt;included topics with two or more revisions.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Example INCLUDE variable exploiting the rev parameter:
&gt;&gt;&gt;&gt;&gt;%INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;The same vulnerability is exposed to all Plugins and add-ons that use
&gt;&gt;&gt;&gt;&gt;TWiki::Func::readTopicText function to read a previous topic revision.
&gt;&gt;&gt;&gt;&gt;This has been tested on TWiki:Plugins.RevCommentPlugin and
&gt;&gt;&gt;&gt;&gt;TWiki:Plugins.CompareRevisionsAddon.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;If access to TWiki is not restricted by other means, attackers can use
&gt;&gt;&gt;&gt;&gt;the revision function with or without prior authentication, depending
&gt;&gt;&gt;&gt;&gt;on the configuration. 
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;The Common Vulnerabilities and Exposures project has assigned the name
&gt;&gt;&gt;&gt;&gt;CAN-2005-3056 to this vulnerability. Please include this number in any
&gt;&gt;&gt;&gt;&gt;changelogs fixing this.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;-- System Information:
&gt;&gt;&gt;&gt;&gt;Debian Release: testing/unstable
&gt;&gt;&gt;&gt;&gt; APT prefers testing
&gt;&gt;&gt;&gt;&gt; APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
&gt;&gt;&gt;&gt;&gt;Architecture: i386 (i686)
&gt;&gt;&gt;&gt;&gt;Shell:  /bin/sh linked to /bin/bash
&gt;&gt;&gt;&gt;&gt;Kernel: Linux 2.6.8-2-k7
&gt;&gt;&gt;&gt;&gt;Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - <a href="http://enigmail.mozdev.org">http://enigmail.mozdev.org</a>

iD8DBQFDQid7PAwzu0QrW+kRAsEoAJ9+GXExEvN2Z2VWChFT4PdDkzLhhwCfVsg6
PUP0bbpDuBHe7eBSLk5ZPQY=
=+J/s
-----END PGP SIGNATURE-----


</pre>

<div class="infmessage"><hr><p>
<a name="26"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>:<br>
<code>Bug#330733</code>; Package <code>twiki</code>.
(<a href="bugreport.cgi?bug=330733;msg=27">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=27">mbox</a>, <a href="#26">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="28"></a>
<strong>Acknowledgement sent</strong> to <code>micah &lt;micah@riseup.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>.
(<a href="bugreport.cgi?bug=330733;msg=29">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="30"></a><a name="msg30"></a><a href="#30">Message #30</a> received at 330733@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=30">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=30">mbox</a>, <a href="mailto:330733@bugs.debian.org?References=%3C20050929152823.6BDAC3A847%40pond%3E%20%3C433C4D9C.2040305%40home.org.au%3E%20%3C4341E2D2.6020003%40riseup.net%3E%20%3C4342277D.9030901%40home.org.au%3E%0A%20%3C43428438.10004%40riseup.net%3E&amp;subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%0A%20execution&amp;In-Reply-To=%3C43428438.10004%40riseup.net%3E&amp;body=On%20Tue%2C%2004%20Oct%202005%2009%3A31%3A36%20-0400%20micah%20%3Cmicah%40riseup.net%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20%0A%3E%20Does%20this%20mean%20that%20the%20twiki%20%2820040902-3%29%20in%20Debian%20is%20not%20vulnerable%0A%3E%20and%20this%20bug%20report%20can%20be%20closed%3F%0A%3E%20%0A%3E%20Micah%0A%3E%20%0A%3E%20Sven%20Dowideit%20wrote%3A%0A%3E%20%3E%20while%20I%20think%20its%20very%20reasonable%20for%20you%20to%20send%20along%20these%0A%3E%20%3E%20advisories%2C%20and%20even%20doing%20so%20as%20a%20BTS%20bug%20wothout%20testing%20them%0A%3E%20%3E%20%0A%3E%20%3E%20I%20think%20its%20incredibly%20rude%20to%20do%20so%20without%20saying%20that%20you%20have%20not%0A%3E%20%3E%20tested%20it%20out.%0A%3E%20%3E%20%0A%3E%20%3E%20please%2C%20if%20you%20enter%20a%20bug%20report%2C%20tell%20the%20maintainer%20what%20you%20have%20or%0A%3E%20%3E%20have%20not%20done%2C%20that%20way%20they%20can%20deal%20more%20appropriatly%20with%20the%20issue%0A%3E%20%3E%20%0A%3E%20%3E%20%28in%20the%20cases%20where%20the%20core%20issue%20has%20been%20dealt%20with%20%28thanks%20to%0A%3E%20%3E%20Florian%21%29%20I%27m%20very%20busy%20helping%20out%20upstream%2C%20and%20i%27m%20sure%20this%0A%3E%20%3E%20situation%20_should_%20apply%20to%20others%20%28i%20object%20to%20the%20number%20of%20debian%0A%3E%20%3E%20maintainers%20that%20are%20not%20appropriatly%20active%20upstream%29%0A%3E%20%3E%20%0A%3E%20%3E%20however%2C%20other%20than%20my%20rant%20%3A%29%20thanks%20for%20the%20notification%2C%20its%0A%3E%20%3E%20important%20%28i%27m%20still%20notifying%20people%20now%29%0A%3E%20%3E%20%0A%3E%20%3E%20Sven%0A%3E%20%3E%20%0A%3E%20%3E%20micah%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%3E%3ESven%2C%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3EI%20have%20not%20attempted%20to%20reproduce%20this%20in%20the%20debian%20package%2C%20I%27m%0A%3E%20%3E%3E%3Etracking%20known%20vulnerabilities%20with%20the%20testing-security%20team.%20When%20I%0A%3E%20%3E%3E%3Esee%20a%20new%20CVE%20id%20assigned%20to%20a%20package%20and%20no%20bugs%20filed%20on%20that%20package%0A%3E%20%3E%3E%3Eregarding%20that%20CVE%2C%20and%20no%20entries%20in%20the%20changelogs%20noting%20that%20it%20has%0A%3E%20%3E%3E%3Ebeen%20fixed%2C%20I%20tend%20to%20believe%20that%20it%20hasn%27t%20been%20because%20it%20is%20a%20rare%0A%3E%20%3E%3E%3Epackage%20maintainer%20who%20has%20security%20issues%20fixed%20before%20they%20are%0A%3E%20%3E%3E%3Ediscovered%20or%20announced.%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3EAdditionally%2C%20the%20advisory%20indicates%20that%20the%20version%20in%20debian%0A%3E%20%3E%3E%3E%2820040902-3%29%20is%20affected%2C%20as%20the%20only%20versions%20it%20indicates%20are%20safe%20is%0A%3E%20%3E%3E%3Ethe%20TWikiRelease01Sep2004%20patched%20with%20Florian%20Weimer%27s%0A%3E%20%3E%3E%3EUncoordinatedSecurityAlert23Feb2005%20patches.%20Without%20any%20indication%20in%0A%3E%20%3E%3E%3Ethe%20BTS%20or%20in%20changelogs%2C%20I%20assume%20that%20the%20package%20is%20affected%20because%0A%3E%20%3E%3E%3Ethe%20version%20numbers%20typically%20are%20very%20good%20indicators.%20Admittedly%2C%20you%0A%3E%20%3E%3E%3Ecould%20very%20well%20have%20addressed%20this%20issue%2C%20and%20I%20have%20a%20feeling%20that%20you%0A%3E%20%3E%3E%3Ehave%20as%20Florian%20is%20very%20active%20in%20Debian.%20If%20so%2C%20I%27d%20be%20happy%20to%20know%0A%3E%20%3E%3E%3Ethat%2C%20and%20we%20can%20close%20this%20bug%2C%20so%20I%20can%20note%20it%20in%20the%0A%3E%20%3E%3E%3Etesting-security%20database.%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3EUnfortunately%2C%20if%20I%20had%20to%20try%20every%20exploit%2C%20even%20those%20without%0A%3E%20%3E%3E%3Epublished%20exploits%2C%20for%20every%20CVE%20assigned%2C%20there%20would%20be%20a%20net%20loss.%20I%0A%3E%20%3E%3E%3Eunderstand%20that%20this%20means%20this%20is%20an%20annoyance%20to%20you%20to%20get%20a%20grave%0A%3E%20%3E%3E%3Ebug%20report%20for%20something%20that%20you%20may%20have%20addressed%2C%20however%20it%20ends%20up%0A%3E%20%3E%3E%3Ebeing%20a%20good%20thing%20because%20then%20we%20know%20for%20sure%2C%20and%20can%20better%20track%0A%3E%20%3E%3E%3Evulnerabilities%20in%20Debian.%20It%20is%20better%20to%20be%20asked%20once%20if%20this%20is%20an%0A%3E%20%3E%3E%3Eissue%20and%20have%20it%20properly%20noted%2C%20than%20for%20Debian%20to%20not%20pay%20attention%0A%3E%20%3E%3E%3Eto%20anything%20at%20all%20and%20be%20riddled%20with%20security%20holes.%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=micah%40riseup.net" alt="">
<div class="header"><span class="headerfield">From:</span> micah &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 330733@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command
 execution</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 04 Oct 2005 09:31:36 -0400</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Does this mean that the twiki (20040902-3) in Debian is not vulnerable
and this bug report can be closed?

Micah

Sven Dowideit wrote:
&gt; while I think its very reasonable for you to send along these
&gt; advisories, and even doing so as a BTS bug wothout testing them
&gt; 
&gt; I think its incredibly rude to do so without saying that you have not
&gt; tested it out.
&gt; 
&gt; please, if you enter a bug report, tell the maintainer what you have or
&gt; have not done, that way they can deal more appropriatly with the issue
&gt; 
&gt; (in the cases where the core issue has been dealt with (thanks to
&gt; Florian!) I&#39;m very busy helping out upstream, and i&#39;m sure this
&gt; situation _should_ apply to others (i object to the number of debian
&gt; maintainers that are not appropriatly active upstream)
&gt; 
&gt; however, other than my rant :) thanks for the notification, its
&gt; important (i&#39;m still notifying people now)
&gt; 
&gt; Sven
&gt; 
&gt; micah wrote:
&gt; 
&gt;&gt;&gt;Sven,
&gt;&gt;&gt;
&gt;&gt;&gt;I have not attempted to reproduce this in the debian package, I&#39;m
&gt;&gt;&gt;tracking known vulnerabilities with the testing-security team. When I
&gt;&gt;&gt;see a new CVE id assigned to a package and no bugs filed on that package
&gt;&gt;&gt;regarding that CVE, and no entries in the changelogs noting that it has
&gt;&gt;&gt;been fixed, I tend to believe that it hasn&#39;t been because it is a rare
&gt;&gt;&gt;package maintainer who has security issues fixed before they are
&gt;&gt;&gt;discovered or announced.
&gt;&gt;&gt;
&gt;&gt;&gt;Additionally, the advisory indicates that the version in debian
&gt;&gt;&gt;(20040902-3) is affected, as the only versions it indicates are safe is
&gt;&gt;&gt;the TWikiRelease01Sep2004 patched with Florian Weimer&#39;s
&gt;&gt;&gt;UncoordinatedSecurityAlert23Feb2005 patches. Without any indication in
&gt;&gt;&gt;the BTS or in changelogs, I assume that the package is affected because
&gt;&gt;&gt;the version numbers typically are very good indicators. Admittedly, you
&gt;&gt;&gt;could very well have addressed this issue, and I have a feeling that you
&gt;&gt;&gt;have as Florian is very active in Debian. If so, I&#39;d be happy to know
&gt;&gt;&gt;that, and we can close this bug, so I can note it in the
&gt;&gt;&gt;testing-security database.
&gt;&gt;&gt;
&gt;&gt;&gt;Unfortunately, if I had to try every exploit, even those without
&gt;&gt;&gt;published exploits, for every CVE assigned, there would be a net loss. I
&gt;&gt;&gt;understand that this means this is an annoyance to you to get a grave
&gt;&gt;&gt;bug report for something that you may have addressed, however it ends up
&gt;&gt;&gt;being a good thing because then we know for sure, and can better track
&gt;&gt;&gt;vulnerabilities in Debian. It is better to be asked once if this is an
&gt;&gt;&gt;issue and have it properly noted, than for Debian to not pay attention
&gt;&gt;&gt;to anything at all and be riddled with security holes.
&gt;&gt;&gt;
&gt;&gt;&gt;micah
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;Sven Dowideit wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;excellent.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Micah, did you manage to reproduce this in the debian package at all?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;you see, the debian package is significantly more secure than the
&gt;&gt;&gt;&gt;&gt;upstream version, and as you&#39;ve marked it as grave, I presume that you
&gt;&gt;&gt;&gt;&gt;have found a way to make it happen. (as when I had a go, i did not get
&gt;&gt;&gt;&gt;&gt;the exploit (i got a unhelpful, but correct error message &quot;invalid
&gt;&gt;&gt;&gt;&gt;number argument at /usr/share/perl5/TWiki.pm line 3339.&quot;)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;could you please either tell me how to reproduce the problem in the
&gt;&gt;&gt;&gt;&gt;current debian package, or close it?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Sven
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Micah Anderson wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Package: twiki
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Version: 20040902-3
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Severity: grave
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Tags: security
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Justification: user security hole
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;A new security bug in twiki showed up today:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;<a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;An attacker is able to execute arbitrary shell commands with the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;privileges of the web server process. The TWiki INCLUDE function
&gt;&gt;&gt;&gt;&gt;&gt;&gt;enables a malicious user to compose a command line executed by the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Perl backtick (`) operator.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;The rev parameter of the INCLUDE variable is not checked properly for
&gt;&gt;&gt;&gt;&gt;&gt;&gt;shell metacharacters and is thus vulnerable to revision numbers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;containing pipes and shell commands. The exploit is possible on
&gt;&gt;&gt;&gt;&gt;&gt;&gt;included topics with two or more revisions.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Example INCLUDE variable exploiting the rev parameter:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;%INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;The same vulnerability is exposed to all Plugins and add-ons that use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;TWiki::Func::readTopicText function to read a previous topic revision.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;This has been tested on TWiki:Plugins.RevCommentPlugin and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;TWiki:Plugins.CompareRevisionsAddon.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;If access to TWiki is not restricted by other means, attackers can use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the revision function with or without prior authentication, depending
&gt;&gt;&gt;&gt;&gt;&gt;&gt;on the configuration. 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;The Common Vulnerabilities and Exposures project has assigned the name
&gt;&gt;&gt;&gt;&gt;&gt;&gt;CAN-2005-3056 to this vulnerability. Please include this number in any
&gt;&gt;&gt;&gt;&gt;&gt;&gt;changelogs fixing this.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;-- System Information:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Debian Release: testing/unstable
&gt;&gt;&gt;&gt;&gt;&gt;&gt;APT prefers testing
&gt;&gt;&gt;&gt;&gt;&gt;&gt;APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Architecture: i386 (i686)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Shell:  /bin/sh linked to /bin/bash
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Kernel: Linux 2.6.8-2-k7
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iD8DBQFDQoQ49n4qXRzy1ioRAq3qAJ0Unv67KRVRhspysHwYVSPMcgREXQCgnErl
dQYbLhUMHN1nVASNCDzWAew=
=Ew1E
-----END PGP SIGNATURE-----


</pre>

<div class="infmessage"><hr><p>
<a name="31"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>:<br>
<code>Bug#330733</code>; Package <code>twiki</code>.
(<a href="bugreport.cgi?bug=330733;msg=32">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=32">mbox</a>, <a href="#31">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="33"></a>
<strong>Acknowledgement sent</strong> to <code>Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Sven Dowideit &lt;svenud@ozemail.com.au&gt;</code>.
(<a href="bugreport.cgi?bug=330733;msg=34">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=34">mbox</a>, <a href="#33">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="35"></a><a name="msg35"></a><a href="#35">Message #35</a> received at 330733@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=35">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=35">mbox</a>, <a href="mailto:330733@bugs.debian.org?body=On%20Tue%2C%2004%20Oct%202005%2015%3A44%3A08%20%2B0200%20Sven%20Dowideit%20%3CSvenDowideit%40home.org.au%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Yes%2C%20defiantly%0A%3E%20%0A%3E%20I%20have%20not%20found%20any%20way%20to%20exploit%20the%20debian%20package%20using%20any%20thus%0A%3E%20far%20found%20methods.%20Florians%20patch%20get%20in%20the%20way%20every%20time%20%3A%29%0A%3E%20%0A%3E%20Sven%0A%3E%20%0A%3E%20micah%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%20Does%20this%20mean%20that%20the%20twiki%20%2820040902-3%29%20in%20Debian%20is%20not%20vulnerable%0A%3E%20%3E%20and%20this%20bug%20report%20can%20be%20closed%3F%0A%3E%20%3E%20%0A%3E%20%3E%20Micah%0A%3E%20%3E%20%0A%3E%20%3E%20Sven%20Dowideit%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%3E%3Ewhile%20I%20think%20its%20very%20reasonable%20for%20you%20to%20send%20along%20these%0A%3E%20%3E%3E%3Eadvisories%2C%20and%20even%20doing%20so%20as%20a%20BTS%20bug%20wothout%20testing%20them%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3EI%20think%20its%20incredibly%20rude%20to%20do%20so%20without%20saying%20that%20you%20have%20not%0A%3E%20%3E%3E%3Etested%20it%20out.%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3Eplease%2C%20if%20you%20enter%20a%20bug%20report%2C%20tell%20the%20maintainer%20what%20you%20have%20or%0A%3E%20%3E%3E%3Ehave%20not%20done%2C%20that%20way%20they%20can%20deal%20more%20appropriatly%20with%20the%20issue%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%28in%20the%20cases%20where%20the%20core%20issue%20has%20been%20dealt%20with%20%28thanks%20to%0A%3E%20%3E%3E%3EFlorian%21%29%20I%27m%20very%20busy%20helping%20out%20upstream%2C%20and%20i%27m%20sure%20this%0A%3E%20%3E%3E%3Esituation%20_should_%20apply%20to%20others%20%28i%20object%20to%20the%20number%20of%20debian%0A%3E%20%3E%3E%3Emaintainers%20that%20are%20not%20appropriatly%20active%20upstream%29%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3Ehowever%2C%20other%20than%20my%20rant%20%3A%29%20thanks%20for%20the%20notification%2C%20its%0A%3E%20%3E%3E%3Eimportant%20%28i%27m%20still%20notifying%20people%20now%29%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3ESven%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3Emicah%20wrote%3A%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3ESven%2C%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3EI%20have%20not%20attempted%20to%20reproduce%20this%20in%20the%20debian%20package%2C%20I%27m%0A%3E%20%3E%3E%3E%3E%3Etracking%20known%20vulnerabilities%20with%20the%20testing-security%20team.%20When%20I%0A%3E%20%3E%3E%3E%3E%3Esee%20a%20new%20CVE%20id%20assigned%20to%20a%20package%20and%20no%20bugs%20filed%20on%20that%20package%0A%3E%20%3E%3E%3E%3E%3Eregarding%20that%20CVE%2C%20and%20no%20entries%20in%20the%20changelogs%20noting%20that%20it%20has%0A%3E%20%3E%3E%3E%3E%3Ebeen%20fixed%2C%20I%20tend%20to%20believe%20that%20it%20hasn%27t%20been%20because%20it%20is%20a%20rare%0A%3E%20%3E%3E%3E%3E%3Epackage%20maintainer%20who%20has%20security%20issues%20fixed%20before%20they%20are%0A%3E%20%3E%3E%3E%3E%3Ediscovered%20or%20announced.%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3EAdditionally%2C%20the%20advisory%20indicates%20that%20the%20version%20in%20debian%0A%3E%20%3E%3E%3E%3E%3E%2820040902-3%29%20is%20affected%2C%20as%20the%20only%20versions%20it%20indicates%20are%20safe%20is%0A%3E%20%3E%3E%3E%3E%3Ethe%20TWikiRelease01Sep2004%20patched%20with%20Florian%20Weimer%27s%0A%3E%20%3E%3E%3E%3E%3EUncoordinatedSecurityAlert23Feb2005%20patches.%20Without%20any%20indication%20in%0A%3E%20%3E%3E%3E%3E%3Ethe%20BTS%20or%20in%20changelogs%2C%20I%20assume%20that%20the%20package%20is%20affected%20because%0A%3E%20%3E%3E%3E%3E%3Ethe%20version%20numbers%20typically%20are%20very%20good%20indicators.%20Admittedly%2C%20you%0A%3E%20%3E%3E%3E%3E%3Ecould%20very%20well%20have%20addressed%20this%20issue%2C%20and%20I%20have%20a%20feeling%20that%20you%0A%3E%20%3E%3E%3E%3E%3Ehave%20as%20Florian%20is%20very%20active%20in%20Debian.%20If%20so%2C%20I%27d%20be%20happy%20to%20know%0A%3E%20%3E%3E%3E%3E%3Ethat%2C%20and%20we%20can%20close%20this%20bug%2C%20so%20I%20can%20note%20it%20in%20the%0A&amp;In-Reply-To=%3C43428728.6000300%40home.org.au%3E&amp;References=%3C20050929152823.6BDAC3A847%40pond%3E%20%3C433C4D9C.2040305%40home.org.au%3E%20%3C4341E2D2.6020003%40riseup.net%3E%20%3C4342277D.9030901%40home.org.au%3E%20%3C43428438.10004%40riseup.net%3E%0A%20%3C43428728.6000300%40home.org.au%3E&amp;subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%0A%20execution">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au" alt="">
<div class="header"><span class="headerfield">From:</span> Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</div>
<div class="header"><span class="headerfield">To:</span> micah &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 330733@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command
 execution</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 04 Oct 2005 15:44:08 +0200</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Yes, defiantly

I have not found any way to exploit the debian package using any thus
far found methods. Florians patch get in the way every time :)

Sven

micah wrote:
&gt; 
&gt; Does this mean that the twiki (20040902-3) in Debian is not vulnerable
&gt; and this bug report can be closed?
&gt; 
&gt; Micah
&gt; 
&gt; Sven Dowideit wrote:
&gt; 
&gt;&gt;&gt;while I think its very reasonable for you to send along these
&gt;&gt;&gt;advisories, and even doing so as a BTS bug wothout testing them
&gt;&gt;&gt;
&gt;&gt;&gt;I think its incredibly rude to do so without saying that you have not
&gt;&gt;&gt;tested it out.
&gt;&gt;&gt;
&gt;&gt;&gt;please, if you enter a bug report, tell the maintainer what you have or
&gt;&gt;&gt;have not done, that way they can deal more appropriatly with the issue
&gt;&gt;&gt;
&gt;&gt;&gt;(in the cases where the core issue has been dealt with (thanks to
&gt;&gt;&gt;Florian!) I&#39;m very busy helping out upstream, and i&#39;m sure this
&gt;&gt;&gt;situation _should_ apply to others (i object to the number of debian
&gt;&gt;&gt;maintainers that are not appropriatly active upstream)
&gt;&gt;&gt;
&gt;&gt;&gt;however, other than my rant :) thanks for the notification, its
&gt;&gt;&gt;important (i&#39;m still notifying people now)
&gt;&gt;&gt;
&gt;&gt;&gt;Sven
&gt;&gt;&gt;
&gt;&gt;&gt;micah wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Sven,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;I have not attempted to reproduce this in the debian package, I&#39;m
&gt;&gt;&gt;&gt;&gt;tracking known vulnerabilities with the testing-security team. When I
&gt;&gt;&gt;&gt;&gt;see a new CVE id assigned to a package and no bugs filed on that package
&gt;&gt;&gt;&gt;&gt;regarding that CVE, and no entries in the changelogs noting that it has
&gt;&gt;&gt;&gt;&gt;been fixed, I tend to believe that it hasn&#39;t been because it is a rare
&gt;&gt;&gt;&gt;&gt;package maintainer who has security issues fixed before they are
&gt;&gt;&gt;&gt;&gt;discovered or announced.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Additionally, the advisory indicates that the version in debian
&gt;&gt;&gt;&gt;&gt;(20040902-3) is affected, as the only versions it indicates are safe is
&gt;&gt;&gt;&gt;&gt;the TWikiRelease01Sep2004 patched with Florian Weimer&#39;s
&gt;&gt;&gt;&gt;&gt;UncoordinatedSecurityAlert23Feb2005 patches. Without any indication in
&gt;&gt;&gt;&gt;&gt;the BTS or in changelogs, I assume that the package is affected because
&gt;&gt;&gt;&gt;&gt;the version numbers typically are very good indicators. Admittedly, you
&gt;&gt;&gt;&gt;&gt;could very well have addressed this issue, and I have a feeling that you
&gt;&gt;&gt;&gt;&gt;have as Florian is very active in Debian. If so, I&#39;d be happy to know
&gt;&gt;&gt;&gt;&gt;that, and we can close this bug, so I can note it in the
&gt;&gt;&gt;&gt;&gt;testing-security database.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Unfortunately, if I had to try every exploit, even those without
&gt;&gt;&gt;&gt;&gt;published exploits, for every CVE assigned, there would be a net loss. I
&gt;&gt;&gt;&gt;&gt;understand that this means this is an annoyance to you to get a grave
&gt;&gt;&gt;&gt;&gt;bug report for something that you may have addressed, however it ends up
&gt;&gt;&gt;&gt;&gt;being a good thing because then we know for sure, and can better track
&gt;&gt;&gt;&gt;&gt;vulnerabilities in Debian. It is better to be asked once if this is an
&gt;&gt;&gt;&gt;&gt;issue and have it properly noted, than for Debian to not pay attention
&gt;&gt;&gt;&gt;&gt;to anything at all and be riddled with security holes.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;micah
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Sven Dowideit wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;excellent.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Micah, did you manage to reproduce this in the debian package at all?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;you see, the debian package is significantly more secure than the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;upstream version, and as you&#39;ve marked it as grave, I presume that you
&gt;&gt;&gt;&gt;&gt;&gt;&gt;have found a way to make it happen. (as when I had a go, i did not get
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the exploit (i got a unhelpful, but correct error message &quot;invalid
&gt;&gt;&gt;&gt;&gt;&gt;&gt;number argument at /usr/share/perl5/TWiki.pm line 3339.&quot;)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;could you please either tell me how to reproduce the problem in the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;current debian package, or close it?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Sven
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Micah Anderson wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Package: twiki
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Version: 20040902-3
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Severity: grave
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Tags: security
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Justification: user security hole
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;A new security bug in twiki showed up today:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;An attacker is able to execute arbitrary shell commands with the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;privileges of the web server process. The TWiki INCLUDE function
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;enables a malicious user to compose a command line executed by the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Perl backtick (`) operator.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The rev parameter of the INCLUDE variable is not checked properly for
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;shell metacharacters and is thus vulnerable to revision numbers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;containing pipes and shell commands. The exploit is possible on
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;included topics with two or more revisions.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Example INCLUDE variable exploiting the rev parameter:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;%INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The same vulnerability is exposed to all Plugins and add-ons that use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;TWiki::Func::readTopicText function to read a previous topic revision.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;This has been tested on TWiki:Plugins.RevCommentPlugin and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;TWiki:Plugins.CompareRevisionsAddon.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;If access to TWiki is not restricted by other means, attackers can use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the revision function with or without prior authentication, depending
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;on the configuration. 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The Common Vulnerabilities and Exposures project has assigned the name
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;CAN-2005-3056 to this vulnerability. Please include this number in any
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;changelogs fixing this.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-- System Information:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Debian Release: testing/unstable
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;APT prefers testing
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Architecture: i386 (i686)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Shell:  /bin/sh linked to /bin/bash
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Kernel: Linux 2.6.8-2-k7
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - <a href="http://enigmail.mozdev.org">http://enigmail.mozdev.org</a>

iD8DBQFDQocnPAwzu0QrW+kRAkefAKCajM1zqAFYXcjG71Lziz+06CnwJQCdGtAP
XEchJVRNsc7vPWFr/zvuEl4=
=sPxV
-----END PGP SIGNATURE-----


</pre>

<hr><p class="msgreceived"><a name="36"></a><a name="msg36"></a><a href="#36">Message #36</a> received at 330733-done@bugs.debian.org (<a href="bugreport.cgi?bug=330733;msg=36">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=36">mbox</a>, <a href="mailto:330733@bugs.debian.org?subject=Re%3A%20Bug%23330733%3A%20twiki%3A%20INCLUDE%20function%20allows%20arbitrary%20shell%20command%0A%20execution&amp;References=%3C20050929152823.6BDAC3A847%40pond%3E%20%3C433C4D9C.2040305%40home.org.au%3E%20%3C4341E2D2.6020003%40riseup.net%3E%20%3C4342277D.9030901%40home.org.au%3E%20%3C43428438.10004%40riseup.net%3E%20%3C43428728.6000300%40home.org.au%3E%0A%20%3C43428880.4010306%40riseup.net%3E&amp;In-Reply-To=%3C43428880.4010306%40riseup.net%3E&amp;body=On%20Tue%2C%2004%20Oct%202005%2009%3A49%3A52%20-0400%20micah%20%3Cmicah%40riseup.net%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20%0A%3E%20Great%21%20Thanks%20for%20keeping%20the%20package%20secure.%0A%3E%20%0A%3E%20micah%0A%3E%20%0A%3E%20Sven%20Dowideit%20wrote%3A%0A%3E%20%3E%20Yes%2C%20defiantly%0A%3E%20%3E%20%0A%3E%20%3E%20I%20have%20not%20found%20any%20way%20to%20exploit%20the%20debian%20package%20using%20any%20thus%0A%3E%20%3E%20far%20found%20methods.%20Florians%20patch%20get%20in%20the%20way%20every%20time%20%3A%29%0A%3E%20%3E%20%0A%3E%20%3E%20Sven%0A%3E%20%3E%20%0A%3E%20%3E%20micah%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%3E%3EDoes%20this%20mean%20that%20the%20twiki%20%2820040902-3%29%20in%20Debian%20is%20not%20vulnerable%0A%3E%20%3E%3E%3Eand%20this%20bug%20report%20can%20be%20closed%3F%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3EMicah%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3ESven%20Dowideit%20wrote%3A%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3Ewhile%20I%20think%20its%20very%20reasonable%20for%20you%20to%20send%20along%20these%0A%3E%20%3E%3E%3E%3E%3Eadvisories%2C%20and%20even%20doing%20so%20as%20a%20BTS%20bug%20wothout%20testing%20them%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3EI%20think%20its%20incredibly%20rude%20to%20do%20so%20without%20saying%20that%20you%20have%20not%0A%3E%20%3E%3E%3E%3E%3Etested%20it%20out.%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3Eplease%2C%20if%20you%20enter%20a%20bug%20report%2C%20tell%20the%20maintainer%20what%20you%20have%20or%0A%3E%20%3E%3E%3E%3E%3Ehave%20not%20done%2C%20that%20way%20they%20can%20deal%20more%20appropriatly%20with%20the%20issue%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%28in%20the%20cases%20where%20the%20core%20issue%20has%20been%20dealt%20with%20%28thanks%20to%0A%3E%20%3E%3E%3E%3E%3EFlorian%21%29%20I%27m%20very%20busy%20helping%20out%20upstream%2C%20and%20i%27m%20sure%20this%0A%3E%20%3E%3E%3E%3E%3Esituation%20_should_%20apply%20to%20others%20%28i%20object%20to%20the%20number%20of%20debian%0A%3E%20%3E%3E%3E%3E%3Emaintainers%20that%20are%20not%20appropriatly%20active%20upstream%29%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3Ehowever%2C%20other%20than%20my%20rant%20%3A%29%20thanks%20for%20the%20notification%2C%20its%0A%3E%20%3E%3E%3E%3E%3Eimportant%20%28i%27m%20still%20notifying%20people%20now%29%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3ESven%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3Emicah%20wrote%3A%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%3E%3ESven%2C%0A%3E%20%3E%3E%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%3E%3EI%20have%20not%20attempted%20to%20reproduce%20this%20in%20the%20debian%20package%2C%20I%27m%0A%3E%20%3E%3E%3E%3E%3E%3E%3Etracking%20known%20vulnerabilities%20with%20the%20testing-security%20team.%20When%20I%0A%3E%20%3E%3E%3E%3E%3E%3E%3Esee%20a%20new%20CVE%20id%20assigned%20to%20a%20package%20and%20no%20bugs%20filed%20on%20that%20package%0A%3E%20%3E%3E%3E%3E%3E%3E%3Eregarding%20that%20CVE%2C%20and%20no%20entries%20in%20the%20changelogs%20noting%20that%20it%20has%0A%3E%20%3E%3E%3E%3E%3E%3E%3Ebeen%20fixed%2C%20I%20tend%20to%20believe%20that%20it%20hasn%27t%20been%20because%20it%20is%20a%20rare%0A%3E%20%3E%3E%3E%3E%3E%3E%3Epackage%20maintainer%20who%20has%20security%20issues%20fixed%20before%20they%20are%0A%3E%20%3E%3E%3E%3E%3E%3E%3Ediscovered%20or%20announced.%0A%3E%20%3E%3E%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%3E%3EAdditionally%2C%20the%20advisory%20indicates%20that%20the%20version%20in%20debian%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=micah%40riseup.net" alt="">
<div class="header"><span class="headerfield">From:</span> micah &lt;micah@riseup.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Sven Dowideit &lt;SvenDowideit@home.org.au&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 330733-done@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#330733: twiki: INCLUDE function allows arbitrary shell command
 execution</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 04 Oct 2005 09:49:52 -0400</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Great! Thanks for keeping the package secure.

micah

Sven Dowideit wrote:
&gt; Yes, defiantly
&gt; 
&gt; I have not found any way to exploit the debian package using any thus
&gt; far found methods. Florians patch get in the way every time :)
&gt; 
&gt; Sven
&gt; 
&gt; micah wrote:
&gt; 
&gt;&gt;&gt;Does this mean that the twiki (20040902-3) in Debian is not vulnerable
&gt;&gt;&gt;and this bug report can be closed?
&gt;&gt;&gt;
&gt;&gt;&gt;Micah
&gt;&gt;&gt;
&gt;&gt;&gt;Sven Dowideit wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;while I think its very reasonable for you to send along these
&gt;&gt;&gt;&gt;&gt;advisories, and even doing so as a BTS bug wothout testing them
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;I think its incredibly rude to do so without saying that you have not
&gt;&gt;&gt;&gt;&gt;tested it out.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;please, if you enter a bug report, tell the maintainer what you have or
&gt;&gt;&gt;&gt;&gt;have not done, that way they can deal more appropriatly with the issue
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;(in the cases where the core issue has been dealt with (thanks to
&gt;&gt;&gt;&gt;&gt;Florian!) I&#39;m very busy helping out upstream, and i&#39;m sure this
&gt;&gt;&gt;&gt;&gt;situation _should_ apply to others (i object to the number of debian
&gt;&gt;&gt;&gt;&gt;maintainers that are not appropriatly active upstream)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;however, other than my rant :) thanks for the notification, its
&gt;&gt;&gt;&gt;&gt;important (i&#39;m still notifying people now)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Sven
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;micah wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Sven,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;I have not attempted to reproduce this in the debian package, I&#39;m
&gt;&gt;&gt;&gt;&gt;&gt;&gt;tracking known vulnerabilities with the testing-security team. When I
&gt;&gt;&gt;&gt;&gt;&gt;&gt;see a new CVE id assigned to a package and no bugs filed on that package
&gt;&gt;&gt;&gt;&gt;&gt;&gt;regarding that CVE, and no entries in the changelogs noting that it has
&gt;&gt;&gt;&gt;&gt;&gt;&gt;been fixed, I tend to believe that it hasn&#39;t been because it is a rare
&gt;&gt;&gt;&gt;&gt;&gt;&gt;package maintainer who has security issues fixed before they are
&gt;&gt;&gt;&gt;&gt;&gt;&gt;discovered or announced.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Additionally, the advisory indicates that the version in debian
&gt;&gt;&gt;&gt;&gt;&gt;&gt;(20040902-3) is affected, as the only versions it indicates are safe is
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the TWikiRelease01Sep2004 patched with Florian Weimer&#39;s
&gt;&gt;&gt;&gt;&gt;&gt;&gt;UncoordinatedSecurityAlert23Feb2005 patches. Without any indication in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the BTS or in changelogs, I assume that the package is affected because
&gt;&gt;&gt;&gt;&gt;&gt;&gt;the version numbers typically are very good indicators. Admittedly, you
&gt;&gt;&gt;&gt;&gt;&gt;&gt;could very well have addressed this issue, and I have a feeling that you
&gt;&gt;&gt;&gt;&gt;&gt;&gt;have as Florian is very active in Debian. If so, I&#39;d be happy to know
&gt;&gt;&gt;&gt;&gt;&gt;&gt;that, and we can close this bug, so I can note it in the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;testing-security database.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Unfortunately, if I had to try every exploit, even those without
&gt;&gt;&gt;&gt;&gt;&gt;&gt;published exploits, for every CVE assigned, there would be a net loss. I
&gt;&gt;&gt;&gt;&gt;&gt;&gt;understand that this means this is an annoyance to you to get a grave
&gt;&gt;&gt;&gt;&gt;&gt;&gt;bug report for something that you may have addressed, however it ends up
&gt;&gt;&gt;&gt;&gt;&gt;&gt;being a good thing because then we know for sure, and can better track
&gt;&gt;&gt;&gt;&gt;&gt;&gt;vulnerabilities in Debian. It is better to be asked once if this is an
&gt;&gt;&gt;&gt;&gt;&gt;&gt;issue and have it properly noted, than for Debian to not pay attention
&gt;&gt;&gt;&gt;&gt;&gt;&gt;to anything at all and be riddled with security holes.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;micah
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;Sven Dowideit wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;excellent.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Micah, did you manage to reproduce this in the debian package at all?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;you see, the debian package is significantly more secure than the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;upstream version, and as you&#39;ve marked it as grave, I presume that you
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;have found a way to make it happen. (as when I had a go, i did not get
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the exploit (i got a unhelpful, but correct error message &quot;invalid
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;number argument at /usr/share/perl5/TWiki.pm line 3339.&quot;)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;could you please either tell me how to reproduce the problem in the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;current debian package, or close it?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Cheers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Sven
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Micah Anderson wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Package: twiki
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Version: 20040902-3
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Severity: grave
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Tags: security
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Justification: user security hole
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;A new security bug in twiki showed up today:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<a href="http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude">http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithInclude</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;An attacker is able to execute arbitrary shell commands with the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;privileges of the web server process. The TWiki INCLUDE function
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;enables a malicious user to compose a command line executed by the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Perl backtick (`) operator.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The rev parameter of the INCLUDE variable is not checked properly for
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;shell metacharacters and is thus vulnerable to revision numbers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;containing pipes and shell commands. The exploit is possible on
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;included topics with two or more revisions.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Example INCLUDE variable exploiting the rev parameter:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;%INCLUDE{ &quot;Main.TWikiUsers&quot; rev=&quot;2|less /etc/passwd&quot; }%
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The same vulnerability is exposed to all Plugins and add-ons that use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;TWiki::Func::readTopicText function to read a previous topic revision.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;This has been tested on TWiki:Plugins.RevCommentPlugin and
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;TWiki:Plugins.CompareRevisionsAddon.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;If access to TWiki is not restricted by other means, attackers can use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;the revision function with or without prior authentication, depending
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;on the configuration. 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;The Common Vulnerabilities and Exposures project has assigned the name
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;CAN-2005-3056 to this vulnerability. Please include this number in any
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;changelogs fixing this.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-- System Information:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Debian Release: testing/unstable
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;APT prefers testing
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;APT policy: (990, &#39;testing&#39;), (500, &#39;unstable&#39;)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Architecture: i386 (i686)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Shell:  /bin/sh linked to /bin/bash
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Kernel: Linux 2.6.8-2-k7
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iD8DBQFDQoiA9n4qXRzy1ioRAoeFAKC3XUvfC8YM0ot4JPPFeLcRxH41vwCfUHGG
WpOTrxfh6oysL3wrFp2ahQE=
=j0ZX
-----END PGP SIGNATURE-----


</pre>

<div class="msgreceived"><hr><p>
<a name="37"></a>
<!-- time:1182124293 -->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>. 
 (Sun, 17 Jun 2007 23:51:33 GMT) (<a href="bugreport.cgi?bug=330733;msg=38">full text</a>, <a href="bugreport.cgi?bug=330733;mbox=yes;msg=38">mbox</a>, <a href="#37">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=330733">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:23:08 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
