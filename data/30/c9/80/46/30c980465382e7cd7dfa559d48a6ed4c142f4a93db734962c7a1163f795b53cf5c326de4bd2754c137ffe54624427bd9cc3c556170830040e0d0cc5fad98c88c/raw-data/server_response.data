<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#358028 - pasting large chunk of code into termnet crashes it - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=358028&quot;&gt;358028&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:358028@bugs.debian.org">#358028</a><br>
pasting large chunk of code into termnet crashes it</h1>
<div class="versiongraph"><a href="version.cgi?fixed=termpkg%2F3.3-7;package=termnetd;info=1;absolute=0;collapse=1"><img alt="version graph" src="version.cgi?collapse=1;height=2;width=2;absolute=0;fixed=termpkg%2F3.3-7;package=termnetd"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=termnetd">termnetd</a>;
Maintainer for <a href="pkgreport.cgi?package=termnetd">termnetd</a> is <a href="pkgreport.cgi?maint=">(unknown)</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=joeyh%40debian.org">Joey Hess &lt;joeyh@debian.org&gt;</a></p>
  <p>Date: Mon, 20 Mar 2006 21:34:17 UTC</p>

<p>Severity: normal</p>
<p>Tags: patch, security</p>

<p>Fixed in version termpkg/3.3-7</p>

<p><strong>Done:</strong> Loic Minier &lt;lool@dooz.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=358028;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<strong>Report forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Loic Minier &lt;lool@dooz.org&gt;</code>:<br>
<code>Bug#358028</code>; Package <code>termnet</code>.
(<a href="bugreport.cgi?bug=358028;msg=2">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<strong>Acknowledgement sent</strong> to <code>Joey Hess &lt;joeyh@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Loic Minier &lt;lool@dooz.org&gt;</code>.
(<a href="bugreport.cgi?bug=358028;msg=4">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=358028;msg=5">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=5">mbox</a>, <a href="mailto:358028@bugs.debian.org?In-Reply-To=%3C20060320213359.GA19723%40kitenet.net%3E&amp;subject=Re%3A%20pasting%20large%20chunk%20of%20code%20into%20termnet%20crashes%20it&amp;body=On%20Mon%2C%2020%20Mar%202006%2016%3A33%3A59%20-0500%20Joey%20Hess%20%3Cjoeyh%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20termnet%0A%3E%20Version%3A%203.3-6%0A%3E%20Severity%3A%20normal%0A%3E%20%0A%3E%20Pasting%20a%20chunk%20of%20code%20like%20the%20following%20into%20termnet%20crashes%20it%3A%0A%3E%20%0A%3E%20if%20%5B%20-n%20%22%24olddev%22%20%5D%20%26%26%20%5B%20-n%20%22%24newdev%22%20%5D%20%26%26%20%5C%0A%3E%20%20%20%20%5B%20%22%24olddev%22%20%21%3D%20%22%24newdev%22%20%5D%3B%20then%0A%3E%20%20%20%20%20%20%20%20%20echo%20%22Replacing%20%24olddev%20with%20%24newdev%20in%20%2Fetc%2Ffstab%20..%22%0A%3E%20%20%20%20%20%20%20%20%20mount%20-o%20remount%2Crw%20%2F%0A%3E%20%20%20%20%20%20%20%20%20sed%20-i%20-e%20%22s%21%5E%24olddev%21%24newdev%21%22%20%2Fetc%2Ffstab%0A%3E%20%20%20%20%20%20%20%20%20mount%20-o%20remount%2Cro%20%2F%0A%3E%20fi%0A%3E%20%0A%3E%20The%20limit%20seems%20to%20be%20around%20this%20many%20characters%20or%20lines%2C%20anything%20this%20big%0A%3E%20or%20bigger%20crashes%20it.%20Looks%20like%20this%3A%0A%3E%20%0A%3E%20%23%3C27%3EMar%2020%2017%3A00%3A48%20termnetd%5B11494%5D%3A%20telnetd%28%29%3AError%20Writing%20to%20network%3ABad%20file%20descriptor%3C30%3EMar%2020%2017%3A00%3A48%20termnetd%5B11494%5D%3A%20telnetd%28%29%3AShutting%20down%20proccessIllegal%20seek%3AConnection%20Closed%0A%3E%20%0A%3E%20zsh%3A%20exit%201%20%20%20%20%20termnet%20slug%203000%0A%3E%20%0A%3E%20The%20termnet%20server%20I%27m%20connecting%20to%20is%20a%20Debian%20arm%20box%20running%0A%3E%20termnetd%203.3-4%20and%20with%20a%20USB%20serial%20converter.%20The%20following%20appears%20in%0A%3E%20the%20logs%20there%20the%20next%20time%20I%20connect%20to%20it%20with%20termnet%3A%0A%3E%20%0A%3E%20Mar%2020%2017%3A05%3A32%20slug%20termnetd%5B4017%5D%3A%20chekDevc%28%29%3ATesting%20Entries%2011496%2C%200%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20chekDevc%28%29%3ATesting%20Entries%2011496%2C%200%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20chekDevc%28%29%3APid%2011496%20dead%21%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20lockDevc%28%29%3AEnter%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20isLocked%28%29%3AEnter%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20isLocked%28%29%3AExit%280%29%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20lockDevc%28%29%3ADevice%20%2Fdev%2FttyUSB0%20not%20locked%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20lockDevc%28%29%3AAllocating%20Lock%20struct%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20lockDevc%28%29%3ALocking%20Device%20%2Fdev%2FttyUSB0%0A%3E%20Mar%2020%2017%3A05%3A37%20slug%20termnetd%5B4017%5D%3A%20lockDevc%280%29%3AExit%0A%3E%20%0A%3E%20When%20I%20strace%20the%20termnetd%20process%2C%20I%20get%20this%3A%0A%3E%20%0A%3E%20getrlimit%28RLIMIT_NOFILE%2C%20%7Brlim_cur%3D1024%2C%20rlim_max%3D1024%7D%29%20%3D%200%0A%3E%20select%281024%2C%20%5B0%203%204%206%5D%2C%20NULL%2C%20%5B0%5D%2C%20NULL%29%20%3D%202%20%28in%20%5B0%206%5D%29%0A%3E%20read%280%2C%20%22i%5Cr%22%2C%20256%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%202%0A%3E%20write%287%2C%20%22i%22%2C%201%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%201%0A%3E%20write%287%2C%20%22%5Cr%22%2C%201%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%201%0A%3E%20read%286%2C%20%22if%20%5B%20-n%20%5C%22%24olddev%5C%22%20%5D%20%26%26%20%5B%20-n%20%5C%22%24ne%22...%2C%20256%29%20%3D%20256%0A%3E%20write%283%2C%20%22if%20%5B%20-n%20%5C%22%24olddev%5C%22%20%5D%20%26%26%20%5B%20-n%20%5C%22%24ne%22...%2C%20256%29%20%3D%20256%0A%3E%20getrlimit%28RLIMIT_NOFILE%2C%20%7Brlim_cur%3D1024%2C%20rlim_max%3D1024%7D%29%20%3D%200%0A%3E%20select%281024%2C%20%5B0%203%204%206%5D%2C%20NULL%2C%20%5B0%5D%2C%20NULL%29%20%3D%202%20%28in%20%5B3%206%5D%29%0A%3E%20read%283%2C%20%22if%20%5B%20-n%20%5C%22%24ol%22%2C%20255%29%20%20%20%20%20%20%20%20%20%20%20%3D%2012%0A%3E%20write%28-1%2C%20%22if%20%5B%20-n%20%5C%22%24ol%22%2C%2012%29%20%20%20%20%20%20%20%20%20%20%3D%20-1%20EBADF%20%28Bad%20file%20descriptor%29%0A%3E%20time%28%5B1142874381%5D%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%201142874381%0A%3E%20stat64%28%22%2Fetc%2Flocaltime%22%2C%20%7Bst_mode%3DS_IFREG%7C0644%2C%20st_size%3D56%2C%20...%7D%29%20%3D%200%0A%3E%20stat64%28%22%2Fetc%2Flocaltime%22%2C%20%7Bst_mode%3DS_IFREG%7C0644%2C%20st_size%3D56%2C%20...%7D%29%20%3D%200%0A%3E%20stat64%28%22%2Fetc%2Flocaltime%22%2C%20%7Bst_mode%3DS_IFREG%7C0644%2C%20st_size%3D56%2C%20...%7D%29%20%3D%200%0A%3E%20getpid%28%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%2011572%0A%3E%20send%280%2C%20%22%3C27%3EMar%2020%2017%3A06%3A21%20termnetd%5B115%22...%2C%2091%2C%20MSG_NOSIGNAL%29%20%3D%2091%0A%3E%20time%28%5B1142874381%5D%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%201142874381%0A%3E%20stat64%28%22%2Fetc%2Flocaltime%22%2C%20%7Bst_mode%3DS_IFREG%7C0644%2C%20st_size%3D56%2C%20...%7D%29%20%3D%200%0A%3E%20stat64%28%22%2Fetc%2Flocaltime%22%2C%20%7Bst_mode%3DS_IFREG%7C0644%2C%20st_size%3D56%2C%20...%7D%29%20%3D%200%0A%3E%20stat64%28%22%2Fetc%2Flocaltime%22%2C%20%7Bst_mode%3DS_IFREG%7C0644%2C%20st_size%3D56%2C%20...%7D%29%20%3D%200%0A%3E%20getpid%28%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3D%2011572%0A&amp;References=%3C20060320213359.GA19723%40kitenet.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=joeyh%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Joey Hess &lt;joeyh@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> pasting large chunk of code into termnet crashes it</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 20 Mar 2006 16:33:59 -0500</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=358028;msg=5">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Package: termnet
Version: 3.3-6
Severity: normal

Pasting a chunk of code like the following into termnet crashes it:

if [ -n &quot;$olddev&quot; ] &amp;&amp; [ -n &quot;$newdev&quot; ] &amp;&amp; \
   [ &quot;$olddev&quot; != &quot;$newdev&quot; ]; then
        echo &quot;Replacing $olddev with $newdev in /etc/fstab ..&quot;
        mount -o remount,rw /
        sed -i -e &quot;s!^$olddev!$newdev!&quot; /etc/fstab
        mount -o remount,ro /
fi

The limit seems to be around this many characters or lines, anything this big
or bigger crashes it. Looks like this:

#&lt;27&gt;Mar 20 17:00:48 termnetd[11494]: telnetd():Error Writing to network:Bad file descriptor&lt;30&gt;Mar 20 17:00:48 termnetd[11494]: telnetd():Shutting down proccessIllegal seek:Connection Closed

zsh: exit 1     termnet slug 3000

The termnet server I&#39;m connecting to is a Debian arm box running
termnetd 3.3-4 and with a USB serial converter. The following appears in
the logs there the next time I connect to it with termnet:

Mar 20 17:05:32 slug termnetd[4017]: chekDevc():Testing Entries 11496, 0
Mar 20 17:05:37 slug termnetd[4017]: chekDevc():Testing Entries 11496, 0
Mar 20 17:05:37 slug termnetd[4017]: chekDevc():Pid 11496 dead!
Mar 20 17:05:37 slug termnetd[4017]: lockDevc():Enter
Mar 20 17:05:37 slug termnetd[4017]: isLocked():Enter
Mar 20 17:05:37 slug termnetd[4017]: isLocked():Exit(0)
Mar 20 17:05:37 slug termnetd[4017]: lockDevc():Device /dev/ttyUSB0 not locked
Mar 20 17:05:37 slug termnetd[4017]: lockDevc():Allocating Lock struct
Mar 20 17:05:37 slug termnetd[4017]: lockDevc():Locking Device /dev/ttyUSB0
Mar 20 17:05:37 slug termnetd[4017]: lockDevc(0):Exit

When I strace the termnetd process, I get this:

getrlimit(RLIMIT_NOFILE, {rlim_cur=1024, rlim_max=1024}) = 0
select(1024, [0 3 4 6], NULL, [0], NULL) = 2 (in [0 6])
read(0, &quot;i\r&quot;, 256)                     = 2
write(7, &quot;i&quot;, 1)                        = 1
write(7, &quot;\r&quot;, 1)                       = 1
read(6, &quot;if [ -n \&quot;$olddev\&quot; ] &amp;&amp; [ -n \&quot;$ne&quot;..., 256) = 256
write(3, &quot;if [ -n \&quot;$olddev\&quot; ] &amp;&amp; [ -n \&quot;$ne&quot;..., 256) = 256
getrlimit(RLIMIT_NOFILE, {rlim_cur=1024, rlim_max=1024}) = 0
select(1024, [0 3 4 6], NULL, [0], NULL) = 2 (in [3 6])
read(3, &quot;if [ -n \&quot;$ol&quot;, 255)           = 12
write(-1, &quot;if [ -n \&quot;$ol&quot;, 12)          = -1 EBADF (Bad file descriptor)
time([1142874381])                      = 1142874381
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=56, ...}) = 0
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=56, ...}) = 0
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=56, ...}) = 0
getpid()                                = 11572
send(0, &quot;&lt;27&gt;Mar 20 17:06:21 termnetd[115&quot;..., 91, MSG_NOSIGNAL) = 91
time([1142874381])                      = 1142874381
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=56, ...}) = 0
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=56, ...}) = 0
stat64(&quot;/etc/localtime&quot;, {st_mode=S_IFREG|0644, st_size=56, ...}) = 0
getpid()                                = 11572
send(0, &quot;&lt;30&gt;Mar 20 17:06:21 termnetd[115&quot;..., 69, MSG_NOSIGNAL) = 69
close(3)                                = 0
munmap(0x4001c000, 4096)                = 0
close(3)                                = -1 EBADF (Bad file descriptor)
close(0)                                = 0
munmap(0x4001b000, 4096)                = 0
io_submit(0, 0, {}Process 11572 detached

-- System Information:
Debian Release: testing/unstable
  APT prefers unstable
  APT policy: (500, &#39;unstable&#39;), (1, &#39;experimental&#39;)
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.15-1-686
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)

Versions of packages termnet depends on:
ii  libc6                         2.3.6-3    GNU C Library: Shared libraries an

termnet recommends no packages.

-- no debconf information

-- 
see shy jo
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=358028;filename=signature.asc;msg=5">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Loic Minier &lt;lool@dooz.org&gt;</code>:<br>
<code>Bug#358028</code>; Package <code>termnet</code>.
(<a href="bugreport.cgi?bug=358028;msg=7">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<strong>Acknowledgement sent</strong> to <code>Loïc Minier &lt;lool@dooz.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Loic Minier &lt;lool@dooz.org&gt;</code>.
(<a href="bugreport.cgi?bug=358028;msg=9">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 358028@bugs.debian.org (<a href="bugreport.cgi?bug=358028;msg=10">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=10">mbox</a>, <a href="mailto:358028@bugs.debian.org?In-Reply-To=%3C20060619162054.GR19909%40bee.dooz.org%3E&amp;body=On%20Mon%2C%2019%20Jun%202006%2018%3A20%3A54%20%2B0200%20%3D%3Fiso-8859-1%3FQ%3FLo%3DEFc%3F%3D%20Minier%20%3Clool%40dooz.org%3E%20wrote%3A%0A%3E%20reassign%20358028%20termnetd%0A%3E%20tags%20358028%20%2B%20help%0A%3E%20stop%0A%3E%20%0A%3E%20%20%20%20%20%20%20%20%20Hi%2C%0A%3E%20%0A%3E%20On%20Mon%2C%20Mar%2020%2C%202006%2C%20Joey%20Hess%20wrote%3A%0A%3E%20%3E%20Pasting%20a%20chunk%20of%20code%20%5B...%5D%20into%20termnet%20crashes%20it%0A%3E%20%0A%3E%20%20It%27s%20actually%20mainly%20a%20termnetd%20problem.%20%20termnet%20isn%27t%20particularly%0A%3E%20%20clean%20in%20the%20handling%20of%20the%20problem%2C%20but%20I%20could%20reproduce%20the%20problem%0A%3E%20%20with%20a%20simple%20telnet.%0A%3E%20%0A%3E%20%20It%20seems%20termnetd%20can%20not%20deal%20with%20so%20many%20lines%20in%20one%20paste%2C%20which%0A%3E%20%20is%20rather%20stupid.%0A%3E%20%0A%3E%20%0A%3E%20%20%20%20Bye%2C%0A%3E%20%0A%3E%20PS%3A%0A%3E%20%20I%20had%20a%20lot%20of%20trouble%20reproducing%20this%20problem%2C%20and%20couldn%27t%20reproduce%0A%3E%20%20it%20reliably.%20%20My%20setup%20was%20with%20pseudo-devices%20%28%2Fdev%2Fptyz0%20%2B%0A%3E%20%20%2Fdev%2Fttyz0%29%2C%20and%20I%20couldn%27t%20setup%20a%20real%20console%20properly%20with%20getty%20or%0A%3E%20%20mgetty.%20%20The%20channel%20was%20working%20until%20I%20entered%20my%20login%2C%20but%20things%0A%3E%20%20were%20going%20wrong%20when%20getty%20calls%20execve%28%29%20on%20login%2C%20login%20tries%0A%3E%20%20writing%20%22Password%3A%22%20to%20the%20correct%20fd%2C%20but%20termnetd%20never%20sees%20it%2C%20and%0A%3E%20%20I%20have%20no%20idea%20why.%0A%3E%20%0A%3E%20%20I%20have%20tried%20for%20a%20couple%20of%20hours%20to%20get%20this%20working%2C%20and%20couldn%27t%0A%3E%20%20understand%20anything%20from%20the%20tty%20related%20ioctl%28%29s%20that%20I%20was%20seeing%2C%20so%0A%3E%20%20I%27m%20giving%20up%3B%20I%20probably%20miss%20the%20required%20skills%20to%20maintain%20this%0A%3E%20%20package%20and%20will%20RFA%20%2F%20O%20it.%0A%3E%20%0A%3E%20--%20%0A%3E%20Lo%C3%AFc%20Minier%20%3Clool%40dooz.org%3E%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23358028%3A%20pasting%20large%20chunk%20of%20code%20into%20termnet%20crashes%20it&amp;References=%3C20060320213359.GA19723%40kitenet.net%3E%0A%20%3C20060619162054.GR19909%40bee.dooz.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=lool%40dooz.org" alt="">
<div class="header"><span class="headerfield">From:</span> Loïc Minier &lt;lool@dooz.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Joey Hess &lt;joeyh@debian.org&gt;, 358028@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> control@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#358028: pasting large chunk of code into termnet crashes it</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 19 Jun 2006 18:20:54 +0200</div>
</div>
<pre class="message">reassign 358028 termnetd
tags 358028 + help
stop

        Hi,

On Mon, Mar 20, 2006, Joey Hess wrote:
&gt; Pasting a chunk of code [...] into termnet crashes it

 It&#39;s actually mainly a termnetd problem.  termnet isn&#39;t particularly
 clean in the handling of the problem, but I could reproduce the problem
 with a simple telnet.

 It seems termnetd can not deal with so many lines in one paste, which
 is rather stupid.


   Bye,

PS:
 I had a lot of trouble reproducing this problem, and couldn&#39;t reproduce
 it reliably.  My setup was with pseudo-devices (/dev/ptyz0 +
 /dev/ttyz0), and I couldn&#39;t setup a real console properly with getty or
 mgetty.  The channel was working until I entered my login, but things
 were going wrong when getty calls execve() on login, login tries
 writing &quot;Password:&quot; to the correct fd, but termnetd never sees it, and
 I have no idea why.

 I have tried for a couple of hours to get this working, and couldn&#39;t
 understand anything from the tty related ioctl()s that I was seeing, so
 I&#39;m giving up; I probably miss the required skills to maintain this
 package and will RFA / O it.

-- 
Loïc Minier &lt;lool@dooz.org&gt;


</pre>

<div class="msgreceived"><hr><p>
<a name="11"></a>
<strong>Bug reassigned from package `<a href="pkgreport.cgi?package=termnet">termnet</a>' to `<a href="pkgreport.cgi?package=termnetd">termnetd</a>'.</strong>
Request was from <code>Loïc Minier &lt;lool@dooz.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=358028;msg=12">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="13"></a>
<strong>Tags added: help</strong>
Request was from <code>Loïc Minier &lt;lool@dooz.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=358028;msg=14">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="15"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Loic Minier &lt;lool@dooz.org&gt;</code>:<br>
<code>Bug#358028</code>; Package <code>termnetd</code>.
(<a href="bugreport.cgi?bug=358028;msg=16">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="17"></a>
<strong>Acknowledgement sent</strong> to <code>Joey Hess &lt;joeyh@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Loic Minier &lt;lool@dooz.org&gt;</code>.
(<a href="bugreport.cgi?bug=358028;msg=18">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=18">mbox</a>, <a href="#17">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="19"></a><a name="msg19"></a><a href="#19">Message #19</a> received at 358028@bugs.debian.org (<a href="bugreport.cgi?bug=358028;msg=19">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=19">mbox</a>, <a href="mailto:358028@bugs.debian.org?subject=Re%3A%20Bug%23358028%3A%20pasting%20large%20chunk%20of%20code%20into%20termnet%20crashes%20it&amp;body=On%20Mon%2C%2019%20Jun%202006%2012%3A42%3A37%20-0400%20Joey%20Hess%20%3Cjoeyh%40debian.org%3E%20wrote%3A%0A%3E%20Lo%C3%AFc%20Minier%20wrote%3A%0A%3E%20%3E%20%20It%20seems%20termnetd%20can%20not%20deal%20with%20so%20many%20lines%20in%20one%20paste%2C%20which%0A%3E%20%3E%20%20is%20rather%20stupid.%0A%3E%20%0A%3E%20My%20guess%20is%20that%20it%20uses%20a%20static%20buffer%2C%20which%20might%20also%20mean%20that%0A%3E%20this%20could%20be%20used%20for%20a%20buffer%20overrrun%20security%20attack.%20Note%20that%0A%3E%20termnetd%20runs%20as%20root%2C%20so%20if%20that%27s%20true%20it%20would%20be%20somewhat%20bad.%0A%3E%20%0A%3E%20%3E%20PS%3A%0A%3E%20%3E%20%20I%20had%20a%20lot%20of%20trouble%20reproducing%20this%20problem%2C%20and%20couldn%27t%20reproduce%0A%3E%20%3E%20%20it%20reliably.%20%20My%20setup%20was%20with%20pseudo-devices%20%28%2Fdev%2Fptyz0%20%2B%0A%3E%20%3E%20%20%2Fdev%2Fttyz0%29%2C%20and%20I%20couldn%27t%20setup%20a%20real%20console%20properly%20with%20getty%20or%0A%3E%20%3E%20%20mgetty.%20%20The%20channel%20was%20working%20until%20I%20entered%20my%20login%2C%20but%20things%0A%3E%20%3E%20%20were%20going%20wrong%20when%20getty%20calls%20execve%28%29%20on%20login%2C%20login%20tries%0A%3E%20%3E%20%20writing%20%22Password%3A%22%20to%20the%20correct%20fd%2C%20but%20termnetd%20never%20sees%20it%2C%20and%0A%3E%20%3E%20%20I%20have%20no%20idea%20why.%0A%3E%20%0A%3E%20I%27ve%20found%20it%20pretty%20easy%20to%20get%20working%20with%20a%20real%20serial%20port%2C%20FWIW.%0A%3E%20%0A%3E%20%3E%20%20I%20have%20tried%20for%20a%20couple%20of%20hours%20to%20get%20this%20working%2C%20and%20couldn%27t%0A%3E%20%3E%20%20understand%20anything%20from%20the%20tty%20related%20ioctl%28%29s%20that%20I%20was%20seeing%2C%20so%0A%3E%20%3E%20%20I%27m%20giving%20up%3B%20I%20probably%20miss%20the%20required%20skills%20to%20maintain%20this%0A%3E%20%3E%20%20package%20and%20will%20RFA%20%2F%20O%20it.%0A%3E%20%0A%3E%20That%27s%20a%20shame%2C%20it%27s%20much%20nicer%20%28and%20freer%29%20than%20conserver..%0A%3E%20%0A%3E%20--%20%0A%3E%20see%20shy%20jo%0A&amp;References=%3C20060320213359.GA19723%40kitenet.net%3E%20%3C20060619162054.GR19909%40bee.dooz.org%3E%0A%20%3C20060619164237.GG15591%40kitenet.net%3E&amp;In-Reply-To=%3C20060619164237.GG15591%40kitenet.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=joeyh%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Joey Hess &lt;joeyh@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Loïc Minier &lt;lool@dooz.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 358028@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#358028: pasting large chunk of code into termnet crashes it</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 19 Jun 2006 12:42:37 -0400</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=358028;msg=19">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Loïc Minier wrote:
&gt;  It seems termnetd can not deal with so many lines in one paste, which
&gt;  is rather stupid.

My guess is that it uses a static buffer, which might also mean that
this could be used for a buffer overrrun security attack. Note that
termnetd runs as root, so if that&#39;s true it would be somewhat bad.

&gt; PS:
&gt;  I had a lot of trouble reproducing this problem, and couldn&#39;t reproduce
&gt;  it reliably.  My setup was with pseudo-devices (/dev/ptyz0 +
&gt;  /dev/ttyz0), and I couldn&#39;t setup a real console properly with getty or
&gt;  mgetty.  The channel was working until I entered my login, but things
&gt;  were going wrong when getty calls execve() on login, login tries
&gt;  writing &quot;Password:&quot; to the correct fd, but termnetd never sees it, and
&gt;  I have no idea why.

I&#39;ve found it pretty easy to get working with a real serial port, FWIW.

&gt;  I have tried for a couple of hours to get this working, and couldn&#39;t
&gt;  understand anything from the tty related ioctl()s that I was seeing, so
&gt;  I&#39;m giving up; I probably miss the required skills to maintain this
&gt;  package and will RFA / O it.

That&#39;s a shame, it&#39;s much nicer (and freer) than conserver..

-- 
see shy jo
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=358028;filename=signature.asc;msg=19">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="20"></a>
<strong>Tags added: patch, security</strong>
Request was from <code>Loic Minier &lt;lool@dooz.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=358028;msg=21">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="22"></a>
<strong>Tags removed: help</strong>
Request was from <code>Loic Minier &lt;lool@dooz.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=358028;msg=23">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=23">mbox</a>, <a href="#22">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="24"></a>
<strong>Tags added: pending</strong>
Request was from <code>Loic Minier &lt;lool@dooz.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=358028;msg=25">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=25">mbox</a>, <a href="#24">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="26"></a>
<strong>Reply sent</strong> to <code>Loic Minier &lt;lool@dooz.org&gt;</code>:<br>
You have taken responsibility.
(<a href="bugreport.cgi?bug=358028;msg=27">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=27">mbox</a>, <a href="#26">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="28"></a>
<strong>Notification sent</strong> to <code>Joey Hess &lt;joeyh@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
(<a href="bugreport.cgi?bug=358028;msg=29">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="30"></a><a name="msg30"></a><a href="#30">Message #30</a> received at 358028-close@bugs.debian.org (<a href="bugreport.cgi?bug=358028;msg=30">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=30">mbox</a>, <a href="mailto:358028@bugs.debian.org?In-Reply-To=%3CE1FsybB-0004j6-FZ%40spohr.debian.org%3E&amp;References=%3CE1FsybB-0004j6-FZ%40spohr.debian.org%3E&amp;body=On%20Wed%2C%2021%20Jun%202006%2002%3A02%3A09%20-0700%20Loic%20Minier%20%3Clool%40dooz.org%3E%20wrote%3A%0A%3E%20Source%3A%20termpkg%0A%3E%20Source-Version%3A%203.3-7%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20termpkg%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive%3A%0A%3E%20%0A%3E%20termnet_3.3-7_i386.deb%0A%3E%20%20%20to%20pool%2Fmain%2Ft%2Ftermpkg%2Ftermnet_3.3-7_i386.deb%0A%3E%20termnetd_3.3-7_i386.deb%0A%3E%20%20%20to%20pool%2Fmain%2Ft%2Ftermpkg%2Ftermnetd_3.3-7_i386.deb%0A%3E%20termpkg_3.3-7.diff.gz%0A%3E%20%20%20to%20pool%2Fmain%2Ft%2Ftermpkg%2Ftermpkg_3.3-7.diff.gz%0A%3E%20termpkg_3.3-7.dsc%0A%3E%20%20%20to%20pool%2Fmain%2Ft%2Ftermpkg%2Ftermpkg_3.3-7.dsc%0A%3E%20ttyd_3.3-7_i386.deb%0A%3E%20%20%20to%20pool%2Fmain%2Ft%2Ftermpkg%2Fttyd_3.3-7_i386.deb%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20358028%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Loic%20Minier%20%3Clool%40dooz.org%3E%20%28supplier%20of%20updated%20termpkg%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.7%0A%3E%20Date%3A%20Mon%2C%2019%20Jun%202006%2020%3A53%3A35%20%2B0200%0A%3E%20Source%3A%20termpkg%0A%3E%20Binary%3A%20termnetd%20ttyd%20termnet%0A%3E%20Architecture%3A%20source%20i386%0A%3E%20Version%3A%203.3-7%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Loic%20Minier%20%3Clool%40dooz.org%3E%0A%3E%20Changed-By%3A%20Loic%20Minier%20%3Clool%40dooz.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20termnet%20%20%20%20-%20Simple%20Telnet%20replacement%20for%20termnetd%0A%3E%20%20termnetd%20%20%20-%20Terminal%20Server%20daemon%0A%3E%20%20ttyd%20%20%20%20%20%20%20-%20Remote%20Modem%20Utility%20for%20Unix%0A%3E%20Closes%3A%20358028%0A%3E%20Changes%3A%20%0A%3E%20%20termpkg%20%283.3-7%29%20unstable%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20SECURITY%3A%20CVE-2006-3100%3A%20Fix%20off%20by%20one%20buffer%20overflow%2C%20thanks%20Joey%20Hess%0A%3E%20%20%20%20%20%20for%20support%21%20%20commbuf%20was%20zero-terminated%20for%20logging%20purposes%20at%0A%3E%20%20%20%20%20%20termnetd%2Ftermnetd.c%3A395%2C%20but%20it%20was%20too%20long%20since%20the%20read%28%29%20at%0A%3E%20%20%20%20%20%20termnetd%2Ftermnetd.c%3A393%20in%20termnetd%28%29.%20%28Closes%3A%20%23358028%29%0A&amp;subject=Re%3A%20Bug%23358028%3A%20fixed%20in%20termpkg%203.3-7">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=lool%40dooz.org" alt="">
<div class="header"><span class="headerfield">From:</span> Loic Minier &lt;lool@dooz.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 358028-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#358028: fixed in termpkg 3.3-7</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 21 Jun 2006 02:02:09 -0700</div>
</div>
<pre class="message">Source: termpkg
Source-Version: 3.3-7

We believe that the bug you reported is fixed in the latest version of
termpkg, which is due to be installed in the Debian FTP archive:

termnet_3.3-7_i386.deb
  to pool/main/t/termpkg/termnet_3.3-7_i386.deb
termnetd_3.3-7_i386.deb
  to pool/main/t/termpkg/termnetd_3.3-7_i386.deb
termpkg_3.3-7.diff.gz
  to pool/main/t/termpkg/termpkg_3.3-7.diff.gz
termpkg_3.3-7.dsc
  to pool/main/t/termpkg/termpkg_3.3-7.dsc
ttyd_3.3-7_i386.deb
  to pool/main/t/termpkg/ttyd_3.3-7_i386.deb



A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 358028@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Loic Minier &lt;lool@dooz.org&gt; (supplier of updated termpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Mon, 19 Jun 2006 20:53:35 +0200
Source: termpkg
Binary: termnetd ttyd termnet
Architecture: source i386
Version: 3.3-7
Distribution: unstable
Urgency: high
Maintainer: Loic Minier &lt;lool@dooz.org&gt;
Changed-By: Loic Minier &lt;lool@dooz.org&gt;
Description: 
 termnet    - Simple Telnet replacement for termnetd
 termnetd   - Terminal Server daemon
 ttyd       - Remote Modem Utility for Unix
Closes: <a href="bugreport.cgi?bug=358028">358028</a>
Changes: 
 termpkg (3.3-7) unstable; urgency=high
 .
   * SECURITY: <a href="https://security-tracker.debian.org/tracker/CVE-2006-3100">CVE-2006-3100</a>: Fix off by one buffer overflow, thanks Joey Hess
     for support!  commbuf was zero-terminated for logging purposes at
     termnetd/termnetd.c:395, but it was too long since the read() at
     termnetd/termnetd.c:393 in termnetd(). (Closes: #<a href="bugreport.cgi?bug=358028">358028</a>)
   * Bump up Standards-Version to 3.7.2.
   * Add ${misc:Depends}.
   * Bump up debhelper compatibility level to 5.
   * Clean up rules.
Files: 
 e58d5dc09df0af5b88f2bc851d7b53d3 566 net optional termpkg_3.3-7.dsc
 95fbcc8964b3ce410cc2671e1ef069a3 5644 net optional termpkg_3.3-7.diff.gz
 f3c65684e80f435a773d8f0e929bc587 20900 net optional ttyd_3.3-7_i386.deb
 8879dbe57e914fb541c452d222722942 34132 net optional termnetd_3.3-7_i386.deb
 34e733a5d0c45b85ca9805482d8064cb 20644 net optional termnet_3.3-7_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)

iD8DBQFEmQZ44VUX8isJIMARAg9TAKCaK9hP/LA9FMuF4FgG704pXd7z1QCfQE8+
3n8u6MdsLbWIAGI0+agjCPQ=
=nE7B
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="31"></a>
<!-- time:1182733278 -->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>. 
 (Mon, 25 Jun 2007 01:01:18 GMT) (<a href="bugreport.cgi?bug=358028;msg=32">full text</a>, <a href="bugreport.cgi?bug=358028;mbox=yes;msg=32">mbox</a>, <a href="#31">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=358028">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:23:12 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
