<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1086145 - (CVE-2015-2721) NSS incorrectly permits skipping of ServerKeyExchange">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1086145">
<meta property="og:description"
      content="RESOLVED (mt) in NSS - Libraries. Last updated 2015-07-06.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1086145 - (CVE-2015-2721) NSS incorrectly permits skipping of ServerKeyExchange</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1086145&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1086145">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1086145">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/yui.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/global.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/util.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"types\":[\"tracking\"],\"flags\":{\"project\":{\"cf_root_cause\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_esr38\":\"39+\",\"cf_tracking_firefox34\":\"+\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox36\":\"-\",\"cf_status_firefox35\":\"wontfix\",\"cf_status_firefox36\":\"wontfix\",\"cf_status_b2g_2_1\":\"fixed\",\"cf_status_firefox_esr31\":\"fixed\",\"cf_status_firefox40\":\"fixed\",\"cf_status_firefox38\":\"wontfix\",\"cf_status_firefox33\":\"wontfix\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox37\":\"wontfix\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox_esr38\":\"fixed\",\"cf_status_b2g_2_0m\":\"fixed\",\"cf_status_b2g_2_2\":\"fixed\",\"cf_status_firefox34\":\"wontfix\",\"cf_status_b2g_1_4\":\"wontfix\",\"cf_tracking_firefox35\":\"+\",\"cf_status_b2g_2_1_s\":\"fixed\",\"cf_status_b2g_2_0\":\"fixed\",\"cf_status_firefox41\":\"fixed\",\"cf_status_firefox38_0_5\":\"wontfix\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox_esr31\":\"39+\",\"cf_status_firefox39\":\"fixed\",\"cf_status_b2g_master\":\"fixed\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\"}},\"comments\":{\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox35\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox34\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox36\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr38\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr31\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1086145;
  BUGZILLA.bug_title = '1086145 - (CVE-2015-2721) NSS incorrectly permits skipping of ServerKeyExchange';
  BUGZILLA.bug_summary = 'NSS incorrectly permits skipping of ServerKeyExchange';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1086145';
  BUGZILLA.bug_keywords = 'sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/field.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/comments.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1086145">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1086145"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1086145 - (CVE-2015-2721) NSS incorrectly permits skipping of ServerKeyExchange">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="jPXz8bBSmBATTTvOJaZHguD9Jb5oJ1KvH9dslapaE4oisrgpUUGtowaORFpnhxQ4zhed3wniP4y3fq1BYdikORrIGDiSMIh3huJ9t4RH7uwlheAgHBa5fn4IE2L5AXTRz2Gva6TTtqYt48u7H2mFhOyJxEsvaxVFrT6Bq0tQVo94d7QxRetAFnA8huxzVh80LLQ3zNmjxxa6NNcyHFCrZq7J3xmK7tGPEEMra25VeGWGiXnuorNDxDngsUZdk6A6">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1086145" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622517-cA7CRjRVetAW3A0VRRWmZGqWwCXuYGq07xuoTwU4gn8">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1086145" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1086145" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1086145">Bug 1086145</a>
          <span class="edit-hide">(CVE-2015-2721)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2014-10-21 00:28 PDT" data-time="1413876533">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2015-04-16 11:38 PDT" data-time="1429209519">7 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">NSS incorrectly permits skipping of Server<wbr>Key<wbr>Exchange</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            NSS incorrectly permits skipping of ServerKeyExchange

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (NSS :: Libraries, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">NSS
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">NSS</div>
            <div class="description">Network Security Services - a cross-platform
security library (<a href="http://www.mozilla.org/projects/security/pki/nss/">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=NSS"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS&component=Libraries#Libraries" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Libraries
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">NSS :: Libraries</div>
            <div class="description">Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=NSS&amp;component=Libraries"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS" data-component="Libraries"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox33 wontfix, firefox34+ wontfix, firefox35+ wontfix, firefox36- wontfix, firefox37 wontfix, firefox38 wontfix, firefox38.0.5 wontfix, firefox39 fixed, firefox40 fixed, firefox41 fixed, firefox-esr3139+ fixed, firefox-esr3839+ fixed, b2g-v1.4 wontfix, b2g-v2.0 fixed, b2g-v2.0M fixed, b2g-v2.1 fixed, b2g-v2.1S fixed, b2g-v2.2 fixed, b2g-master fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            3.19

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox33</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox34</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox35</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox36</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=equals&amp;v1=-">-</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox37</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox38</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox38.0.5</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox38_0_5&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox39</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox40</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox41</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr31</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=39%2B">39+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr38</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=39%2B">39+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v1.4</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0M</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1S</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.2</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-master</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox33</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox33-dirty">
  <select id="cf_status_firefox33" name="cf_status_firefox33">
        <option value="wontfix"
          id="v1714_cf_status_firefox33" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox34</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox34-dirty">
  <select id="cf_tracking_firefox34" name="cf_tracking_firefox34">
        <option value="+"
          id="v1778_cf_tracking_firefox34" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox34-dirty">
  <select id="cf_status_firefox34" name="cf_status_firefox34">
        <option value="wontfix"
          id="v1785_cf_status_firefox34" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox35</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox35-dirty">
  <select id="cf_tracking_firefox35" name="cf_tracking_firefox35">
        <option value="+"
          id="v1841_cf_tracking_firefox35" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox35-dirty">
  <select id="cf_status_firefox35" name="cf_status_firefox35">
        <option value="wontfix"
          id="v1848_cf_status_firefox35" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox36</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox36-dirty">
  <select id="cf_tracking_firefox36" name="cf_tracking_firefox36">
        <option value="-"
          id="v1949_cf_tracking_firefox36" selected
        >-
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox36-dirty">
  <select id="cf_status_firefox36" name="cf_status_firefox36">
        <option value="wontfix"
          id="v1955_cf_status_firefox36" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox37</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox37-dirty">
  <select id="cf_status_firefox37" name="cf_status_firefox37">
        <option value="wontfix"
          id="v1991_cf_status_firefox37" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox38</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox38-dirty">
  <select id="cf_status_firefox38" name="cf_status_firefox38">
        <option value="wontfix"
          id="v2093_cf_status_firefox38" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox38.0.5</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox38_0_5-dirty">
  <select id="cf_status_firefox38_0_5" name="cf_status_firefox38_0_5">
        <option value="wontfix"
          id="v2242_cf_status_firefox38_0_5" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox39</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox39-dirty">
  <select id="cf_status_firefox39" name="cf_status_firefox39">
        <option value="fixed"
          id="v2163_cf_status_firefox39" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox40</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox40-dirty">
  <select id="cf_status_firefox40" name="cf_status_firefox40">
        <option value="fixed"
          id="v2200_cf_status_firefox40" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox41</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox41-dirty">
  <select id="cf_status_firefox41" name="cf_status_firefox41">
        <option value="fixed"
          id="v2259_cf_status_firefox41" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr31</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr31-dirty">
  <select id="cf_tracking_firefox_esr31" name="cf_tracking_firefox_esr31">
        <option value="39+"
          id="v1761_cf_tracking_firefox_esr31" selected
        >39+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr31-dirty">
  <select id="cf_status_firefox_esr31" name="cf_status_firefox_esr31">
        <option value="fixed"
          id="v1766_cf_status_firefox_esr31" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr38</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr38-dirty">
  <select id="cf_tracking_firefox_esr38" name="cf_tracking_firefox_esr38">
        <option value="39+"
          id="v2144_cf_tracking_firefox_esr38" selected
        >39+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr38-dirty">
  <select id="cf_status_firefox_esr38" name="cf_status_firefox_esr38">
        <option value="fixed"
          id="v2149_cf_status_firefox_esr38" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v1.4</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_1_4-dirty">
  <select id="cf_status_b2g_1_4" name="cf_status_b2g_1_4">
        <option value="wontfix"
          id="v1467_cf_status_b2g_1_4" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0-dirty">
  <select id="cf_status_b2g_2_0" name="cf_status_b2g_2_0">
        <option value="fixed"
          id="v1603_cf_status_b2g_2_0" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0M</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0m-dirty">
  <select id="cf_status_b2g_2_0m" name="cf_status_b2g_2_0m">
        <option value="fixed"
          id="v1914_cf_status_b2g_2_0m" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1-dirty">
  <select id="cf_status_b2g_2_1" name="cf_status_b2g_2_1">
        <option value="fixed"
          id="v1737_cf_status_b2g_2_1" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1S</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1_s-dirty">
  <select id="cf_status_b2g_2_1_s" name="cf_status_b2g_2_1_s">
        <option value="fixed"
          id="v2121_cf_status_b2g_2_1_s" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.2</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_2-dirty">
  <select id="cf_status_b2g_2_2" name="cf_status_b2g_2_2">
        <option value="fixed"
          id="v1878_cf_status_b2g_2_2" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-master</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_master-dirty">
  <select id="cf_status_b2g_master" name="cf_status_b2g_master">
        <option value="fixed"
          id="v2078_cf_status_b2g_master" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: karthikeyan.bhargavan, Assigned: mt)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_438654" ><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=438654" > <span class="fna">mt</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_445246" ><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=445246" > <span class="fna">karthikeyan.bhargavan</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=622637" > <span class="fna">beurdouche</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="17">17 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (<div class="link">
    <a href="https://www.smacktls.com/smack.pdf" target="_blank"
      rel="noreferrer" title="https://www.smacktls.com/smack.pdf"
      class="bug-url" data-safe="1">URL</a>
  </div>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update to NSS 3.19.1"
   href="/show_bug.cgi?id=1166031">1166031</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - export-1024 ciphersuites with 1024-bit server certificates are broken"
   href="/show_bug.cgi?id=1173413">1173413</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1086145&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1086145">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field" id="field-bug_file_loc"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="https://www.smacktls.com/smack.pdf" target="_blank"
      rel="noreferrer" title="https://www.smacktls.com/smack.pdf"
      class="bug-url" data-safe="1">smacktls.com/smack.pdf</a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=610095">610095</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">CVE-2015-4000</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-moderate, Whiteboard: [adv-main39+][adv-esr38.1+][adv-esr31.8+][b2g-adv-main2.2+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2015-2721

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main39+][adv-esr38.1+][adv-esr31.8+][b2g-adv-main2.2+]
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (2 files, 8 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8580964">bug1086145-1.patch</a>
        </div>
        <div>
            <a href="#c38" class="attach-time activity-ref"><span class="rel-time" title="2015-03-20 15:57 PDT" data-time="1426892235">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">12.59 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c40"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426892235"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8580964&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8580964&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8580964">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8580965">bug1086145-2.patch</a>
        </div>
        <div>
            <a href="#c39" class="attach-time activity-ref"><span class="rel-time" title="2015-03-20 15:57 PDT" data-time="1426892260">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">24.37 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c41"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428013510"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8580965&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8580965&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8580965">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8588198">bug1086145-1.patch</a>
        </div>
        <div>
            <a href="#c42" class="attach-time activity-ref"><span class="rel-time" title="2015-04-03 15:37 PDT" data-time="1428100656">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">13.05 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428100656"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c48"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428100656"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8588198&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8588198&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8588198">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8588199">bug1086145-2.patch</a>
        </div>
        <div>
            <a href="#c43" class="attach-time activity-ref"><span class="rel-time" title="2015-04-03 15:38 PDT" data-time="1428100690">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">25.62 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c60"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428605424"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8588199&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8588199&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8588199">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8588820">bug1086145-1.patch</a>
        </div>
        <div>
            <a href="#c51" class="attach-time activity-ref"><span class="rel-time" title="2015-04-06 16:49 PDT" data-time="1428364170">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">16.46 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c51"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428364170"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c52"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428371414"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8588820&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8588820&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8588820">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8589196">bug1086145-1.patch</a>
        </div>
        <div>
            <a href="#c53" class="attach-time activity-ref"><span class="rel-time" title="2015-04-07 10:26 PDT" data-time="1428427606">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">16.46 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c53"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428427606"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c54"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428431298"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8589196&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8589196&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8589196">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8589306">bug1086145-1.patch</a>
        </div>
        <div>
            <a href="#c58" class="attach-time activity-ref"><span class="rel-time" title="2015-04-07 14:28 PDT" data-time="1428442083">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.51 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c59"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428442083"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8589306&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8589306&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8589306">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8591024">bug1086145-1.patch</a>
        </div>
        <div>
            <a href="#c62" class="attach-time activity-ref"><span class="rel-time" title="2015-04-10 12:58 PDT" data-time="1428695929">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.52 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c62"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428695929"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8591024&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8591024&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8591024">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8591025">bug1086145-2.patch</a>
        </div>
        <div>
            <a href="#c63" class="attach-time activity-ref"><span class="rel-time" title="2015-04-10 12:59 PDT" data-time="1428695952">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">43.40 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c63"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428695952"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8591025&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8591025&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8591025">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8591135">bug1086145-2.patch</a>
        </div>
        <div>
            <a href="#c67" class="attach-time activity-ref"><span class="rel-time" title="2015-04-10 16:07 PDT" data-time="1428707272">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">46.59 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c67"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428707272"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c68"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428708353"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8591135&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8591135&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8591135">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="Y9D4XvJ31ga5FgsMmySgnCe3KgvtSJpLy34aw1JcRZ5xunT2">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9475497" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" ><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" ><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 00:28 PDT" data-time="1413876533">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="9475497">User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.104 Safari/537.36

Steps to reproduce:

We have been performing systematic state machine tests on NSS, OpenSSL, and other SSL implementations, and we found some unexpected behaviours in NSS (not all are immediately exploitable.) We will report the other weirdnesses in due course, but here's one that seems to break False Start's forward secrecy guarantee.

The core issue is that the NSS client allows an ECDHE_ECDSA exchange where the server does not send its ServerKeyExchange message. In this case, NSS will take
the (long-term) EC key from the ECDSA certificate, and use that instead of the
server's ephemeral parameters. This violates the TLS protocol and also has some security implications for forward secrecy.

The application at the client (e.g. the browser) still thinks it is engaged in an ECDHE exchange, but in fact it has been silently downgraded to a non-forward secret mixed-ECDH exchange. Consequently, if False Start is enabled, the client will start sending data encrypted under the (non forward-secret) connection keys. This breaks some of the changes of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Re-enable TLS False Start"
   href="/show_bug.cgi?id=942729">Bug942729</a> (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Re-enable TLS False Start"
   href="/show_bug.cgi?id=942729">https://bugzilla.mozilla.org/show_bug.cgi?id=942729</a>).

To test this behavior, we used Chrome or Firefox to connect to Gmail (which uses ECDHE-ECDSA) via a network proxy. We allow all messages to pass through, but block the ServerKeyExchange going from google to the browser. The browser still completes the handshake and starts sending data. 

The culprit is in the beginning of ssl3_SendClientKeyExchange in ssl3con.c:

if (ss-&gt;sec.peerKey == NULL) {
	serverKey = CERT_ExtractPublicKey(ss-&gt;sec.peerCert);
        .....
}






Expected results:

One would expect the client to kill the handshake when it receives the ServerHelloDone without having received a ServerKeyExchange in an ECDHE exchange.

A similar behavior occurs for DHE, but requires the server to send a DH-key certificate (which is much rarer in practice.)</pre></div><div class="change-set" id="c1"><div class="comment" data-id="9475847" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 01:03 PDT" data-time="1413878633">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9475847">I believe the root causes are different than what Karthikeyan suggests:

1. 
    static SECStatus
    ssl3_HandleServerHelloDone(sslSocket *ss)
    {
        [...]

        SSL3WaitState ws          = ss-&gt;ssl3.hs.ws;

        [...]

        if (ws != wait_hello_done  &amp;&amp;
------&gt;     ws != wait_server_cert &amp;&amp;
------&gt;	    ws != wait_server_key  &amp;&amp;
------&gt;     ws != wait_cert_request) {
	    SSL3_SendAlert(ss, alert_fatal, unexpected_message);
	    PORT_SetError(SSL_ERROR_RX_UNEXPECTED_HELLO_DONE);
	    return SECFailure;
        }

        rv = ssl3_SendClientSecondRound(ss);

        return rv;
    }

The three lines prefixed with &quot;------&gt;&quot; are wrong. The *only* time we should accept ServerHelloDone is when ss-&gt;ssl3.hs.ws == wait_hello_done. More generally, whenever we process a received message, we need to ensure that ss-&gt;ssl3.hs.ws is in the wait_* state for that specific message. Whenever we process a message, we need to ensure ss-&gt;ssl3.hs.ws is modified to be the next state. We need to be careful about the cases where the next state is ambiguous (e.g. the optional CertificateStatus message).

If this is done, then I think that the line that Karthikeyan pointed out would not be problematic.

2.

    ssl3_SendClientKeyExchange(sslSocket *ss)
    {
        [...]
        if (ss-&gt;sec.peerKey == NULL) {
	    serverKey = CERT_ExtractPublicKey(ss-&gt;sec.peerCert);
            [...]
        } else {
            [...]
        }

        [...]

        switch (ss-&gt;ssl3.hs.kea_def-&gt;exchKeyType) {
            [...]
        case kt_ecdh:
	    rv = ssl3_SendECDHClientKeyExchange(ss, serverKey);
	    break;
            [...]

        [...]
    }

instead of checking &quot;if (ss-&gt;sec.peerKey == NULL)&quot;, NSS should be checking &quot;ss-&gt;ssl3.hs.kea_def-&gt;exchKeyType&quot; and verifying that for ss-&gt;sec.peerKey is non-NULL for key exchange types other than RSA.

Further, the subjectPublicKeyInfo of the certificate will identify the type of the key:

    * id-ecPublicKey - either ECDH or ECDSA
    * id-ecDH - ECDH only

Note that there is no &quot;ECDSA only&quot; type, based on a quick look at the specs. Instead, according to the spec, ECDSA-only is indicated by id-ecPublicKey with keyUsage restricted to digitalSignature. But, neither NSS, nor the applications using it, verify that the keyUsage extension of the certificate is compatible with the way the key is being used.

However, I think if problem #1 is fixed then problem #2 probably won't occur.</pre></div><div class="change-set" id="c2"><div class="comment" data-id="9475850" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 01:07 PDT" data-time="1413878820">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9475850">Note that this behavior is probably pretty bad for renegotiation, because some state from the previous handshake's Certificate &amp; ServerKeyExchange probably carries over into the next handshake if the Certificate and/or ServerKeyExchange messages are skipped.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="9475871" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" ><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" ><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 01:13 PDT" data-time="1413879236">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9475871">Yes, these are the other problematic state machine features I was referring to.
NSS currently allows the ServerHelloDone immediately after ServerHello and in all these other cases too, marked by ---&gt; and these should probably be disallowed (unless there are some use cases I am unaware of).

Other notes:

- If a client receives ServerHelloDone without having received ServerCertificate/ServerKeyExchange, it will accept the ServerHelloDone, but would fail at the line I pointed out in SendClientKeyExchange 

- If a client does not receive a ServerCertificate but then receives a ServerKeyExchange, it fails in HandleServerKeyExchange (where peerCert is checked, for signing)

- If a client receives a ServerCertificate and then a CertificateRequest; ServerHelloDone, it accepts them, asks the user for his certificate, and tries to calculate the ClientKeyExchange. In some cases this will go through (ECDSA cert). In others, it wont go through, but the client will already have been prompted for a certificate.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="9475879" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" ><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" ><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 01:16 PDT" data-time="1413879385">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="9475879">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c2">comment #2</a>)
<span class="quote">&gt; Note that this behavior is probably pretty bad for renegotiation, because
&gt; some state from the previous handshake's Certificate &amp; ServerKeyExchange
&gt; probably carries over into the next handshake if the Certificate and/or
&gt; ServerKeyExchange messages are skipped.</span >

We've been trying to test renegotiation scenarios and trying to see what is leftover between handshakes, but this is more difficult to reproduce through a browser.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="9475925" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 01:27 PDT" data-time="1413880037">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="9475925">static SECStatus
ssl3_HandleServerKeyExchange(sslSocket *ss, SSL3Opaque *b, PRUint32 length)
{
    [...]

        if (ss-&gt;ssl3.hs.ws != wait_server_key &amp;&amp;
------&gt;	    ss-&gt;ssl3.hs.ws != wait_server_cert) {
	    errCode = SSL_ERROR_RX_UNEXPECTED_SERVER_KEY_EXCH;
	    desc    = unexpected_message;
	    goto alert_loser;
        }
        if (ss-&gt;sec.peerCert == NULL) {
	    errCode = SSL_ERROR_RX_UNEXPECTED_SERVER_KEY_EXCH;
	    desc    = unexpected_message;
	    goto alert_loser;
        }

The line marked &quot;------&gt;&quot; is wrong, but the (ss-&gt;sec.peerCert == NULL) check and others probably make it a style issue more than a substantive one.


    static SECStatus
    ssl3_HandleCertificateRequest(sslSocket *ss, SSL3Opaque *b, PRUint32 length)
    {
        [...]

        if (ss-&gt;ssl3.hs.ws != wait_cert_request &amp;&amp;
            ss-&gt;ssl3.hs.ws != wait_server_key) {

        [...]
    }

There's no reason to have this flexibility here. Instead, we should determine from the cipher suite's key exchange algorithm whether a ServerKeyExchange is expected or not, and accept the CertificateRequest message only in the correct state.

    static SECStatus
    ssl3_HandleClientHello(sslSocket *ss, SSL3Opaque *b, PRUint32 length)
    {
        [...]

        if ((ss-&gt;ssl3.hs.ws != wait_client_hello) &amp;&amp;
	    (ss-&gt;ssl3.hs.ws != idle_handshake)) {
    }

This looks wrong too, because it seems like we should only accept ClientHello in the wait_client_hello state. In particular, does something bad happen if the server sends the client a ClientHello before the client sends the server a ClientHello? The worst case scenerio would be that the server sending a ClientHello would cause the client to switch roles; this would be bad because in the server role we usually don't even require a certificate from the peer! IIRC, I tested that a long time ago and couldn't get a bad thing to happen because there was no certificate configured and/or there was no server session cache configured. However, that might not be the case for DTLS, and maybe I'm misremembering or maybe I tested it wrong.

Regardless, when the socket is configured in the client role, we shouldn't be processing ClientHello messages at all.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="9475989" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 01:48 PDT" data-time="1413881308">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="9475989">Karthikeyan, do you agree that this seems to only be possible for ECDSA keys?

(In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c4">comment #4</a>)
<span class="quote">&gt; We've been trying to test renegotiation scenarios and trying to see what is
&gt; leftover between handshakes, but this is more difficult to reproduce through
&gt; a browser.</span >

See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Create loopback test framework for libssl"
   href="/show_bug.cgi?id=702322">bug 702322</a> for an abandoned framework for precisely controlling the state machine in tests. See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Loopback tests for asynchronous certificate validation in libssl"
   href="/show_bug.cgi?id=736734">bug 736734</a> for some example tests. Also, I think recently some similar GTest-based framework was checked into NSS; I suspect that that newer framework may work better.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="9476070" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" ><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" ><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 02:13 PDT" data-time="1413882802">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="9476070">Since Firefox (and Chromium) on Android apparently depend on OpenSSL, I'll list a couple of funny features in the OpenSSL client implementation.

- During an ECDHE (DHE) handshake, OpenSSL allows a silent failover to static ECDH (DH) in the same way as NSS above (i.e. skip the ServerKeyExchange message.)

- During an RSA (note: not RSA_EXPORT) handshake, OpenSSL client allows an ephemeral RSA handshake. That is, the server can send a ServerKeyExchange message with signed ephemeral RSA parameters (say a small modulus and exponent) and the client will replace the server's public key with the ephemeral RSA public key. Hence, the client is doing an RSA_EXPORT handshake, even though it expected to do an RSA handshake,

- If the server skips the ServerCertificate and sends a ServerKeyExchange, OpenSSL will try its best to process the message, and fail deep inside the signature verification

There are other unexpected behaviours in the OpenSSL server implementation, but I am guessing that is not so relevant here.</pre></div><div class="change-set" id="a37871_1689"><div class="change" id="aa37871_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a37871_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a37871_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a37871_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a37871_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 11:00 PDT" data-time="1413914404">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="9479485" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a37871_1689"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 11:09 PDT" data-time="1413914956">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="9479485">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c6">comment #6</a>)
<span class="quote">&gt; Karthikeyan, do you agree that this seems to only be possible for ECDSA keys?</span >

I missed this question before.

Yes, the behavior I am speaking about occurs *only* if the server certificate (peerCert) contains a key that may be used in the current DHE/ECDHE certificate. This means either a DH-Key certificate (which I have never seen, but someone may know of?) or more likely an ECDSA certificate. If the server or m-i-t-m provided an RSA/DSA certificate, the sendDHClientKeyExchange or sendECDHClientKeyExchange will fail.


<span class="quote">&gt; 
&gt; (In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c4">comment #4</a>)
&gt; &gt; We've been trying to test renegotiation scenarios and trying to see what is
&gt; &gt; leftover between handshakes, but this is more difficult to reproduce through
&gt; &gt; a browser.
&gt; 
&gt; See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Create loopback test framework for libssl"
   href="/show_bug.cgi?id=702322">bug 702322</a> for an abandoned framework for precisely controlling the
&gt; state machine in tests. See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Loopback tests for asynchronous certificate validation in libssl"
   href="/show_bug.cgi?id=736734">bug 736734</a> for some example tests. Also, I think
&gt; recently some similar GTest-based framework was checked into NSS; I suspect
&gt; that that newer framework may work better.</span ></pre></div><div class="change-set" id="c9"><div class="comment" data-id="9495428" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a37871_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-23 23:58 PDT" data-time="1414133933">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="9495428">In private email, I suggested that the researchers try the reverse-handshake race condition attack from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c5">comment 5</a> against other implementations. Karthikeyan replied:

<span class="quote">&gt; On NSS, I tried a few such cases (e.g. sending an empty ServerCertificate to see if it
&gt; would treat it as a ClientCertificate. It works to an extent, but HandleNoCertificate
&gt; checks that it is not running on a Server.</span >

It isn't clear to me what you mean, because there's no such check in ssl3_HandleNoCertificate.

Besides trying an empty ServerCertificate message, I suggest also trying one with a certificate having the id-kp-clientAuth EKU that chains up to a root that you trust (your own custom trust anchor, marked as trusted for client certs in the browser). Note that in some cases it might be easy to get an id-kp-clientAuth certificate from a trusted CA, so that would e a serious problem.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="9495485" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a37871_1689"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-24 00:18 PDT" data-time="1414135139">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="9495485">
<span class="quote">&gt; It isn't clear to me what you mean, because there's no such check in
&gt; ssl3_HandleNoCertificate.</span >

You're right, the check is in HandleCertificate. It took me a minute to negate
the conditional below in my head:

if (!(isTLS &amp;&amp; isServer)) {
            desc = bad_certificate;
            goto alert_loser;
        }


<span class="quote">&gt; Besides trying an empty ServerCertificate message, I suggest also trying one
&gt; with a certificate having the id-kp-clientAuth EKU that chains up to a root
&gt; that you trust (your own custom trust anchor, marked as trusted for client
&gt; certs in the browser). Note that in some cases it might be easy to get an
&gt; id-kp-clientAuth certificate from a trusted CA, so that would e a serious
&gt; problem.</span >

I'll get Antoine to look at this, he understands certificates much better than me.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="9495660" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a37871_1689"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-24 01:01 PDT" data-time="1414137689">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="9495660">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c9">comment #9</a>)
<span class="quote">&gt; Besides trying an empty ServerCertificate message, I suggest also trying one
&gt; with a certificate having the id-kp-clientAuth EKU that chains up to a root
&gt; that you trust (your own custom trust anchor, marked as trusted for client
&gt; certs in the browser). Note that in some cases it might be easy to get an
&gt; id-kp-clientAuth certificate from a trusted CA, so that would e a serious
&gt; problem.</span >

I looked at the code and it seems that this could work. Building a test server now...</pre></div><div class="change-set" id="c12"><div class="comment" data-id="9499584" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a37871_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-24 15:22 PDT" data-time="1414189363">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="9499584">(In reply to Antoine Delignat-Lavaud from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c11">comment #11</a>)
<span class="quote">&gt; (In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from comment
&gt; #9)
&gt; &gt; Besides trying an empty ServerCertificate message, I suggest also trying one
&gt; &gt; with a certificate having the id-kp-clientAuth EKU</span >

Note that this shouldn't work with any recent Firefox, because Firefox has been hard-coded to validate for the id-kp-serverAuth EKU since Firefox 11-ish. Please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - remove the SSL thread (nsSSLThread)"
   href="/show_bug.cgi?id=674147#c57">bug 674147 comment 57</a>, which is relevant to this. Prior to the fix for that bug, the code in Firefox looked like this:

    certUsage = isServer ? certUsageSSLClient : certUsageSSLServer;
    certificateusage = isServer ? certificateUsageSSLClient : certificateUsageSSLServer;

    if (!nsNSSComponent::globalConstFlagUsePKIXVerification) {
        rv = CERT_VerifyCertNow(CERT_GetDefaultCertDB(), peerCert, checksig, certUsage,
                                pinarg);
    }
    else {
        [...]

        rv = CERT_PKIXVerifyCert(peerCert, certificateusage,
                                survivingParams-&gt;GetRawPointerForNSS(),
                                cvout, pinarg);
    }

    if ( rv == SECSuccess &amp;&amp; !isServer ) {
        /* cert is OK.  This is the client side of an SSL connection.
        * Now check the name field in the cert against the desired hostname.
        * NB: This is our only defense against Man-In-The-Middle (MITM) attacks!
        */
        if (hostname &amp;&amp; hostname[0])
            rv = CERT_VerifyCertName(peerCert, hostname);
        else
            rv = SECFailure;

        [...]

It is more likely that Firefox 10 or older versions would be exploitable by such an inversion of roles caused by losing a race in sending ClientHello.

Also note that if your exploit fails because of a crash due to the fact that the session cache wasn't configured (as I mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - remove the SSL thread (nsSSLThread)"
   href="/show_bug.cgi?id=674147#c57">bug 674147 comment 57</a>), then you can try configuring NSS with the SSL_NO_CACHE option, which might get around that bug. In recent versions of Firefox, that flag is controlled by the security.ssl.disable_session_identifiers option in about:config. In <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add a pref to disable SSL Session cache (Disable sending session IDs and sending session tickets)"
   href="/show_bug.cgi?id=967977">bug 967977</a>, it was noted that the Tor Browser Bundle was previously patching NSS to disable session caching. So, if your exploit doesn't work against Firefox 10 or earlier versions, your exploit might work against older versions of the Tor Browser Bundle. Please let me know what you find out.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="9499613" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a37871_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-24 15:30 PDT" data-time="1414189816">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="9499613">[Tracking Requested - why for this release]:
This seems like a serious issue because websites that use ECC keys are likely expecting them to only be used for ECDSA key exchange, not ECDH key exchange. That means that they are likely less concerned about disclosing their private key after the certificate has expired, since no data is supposed to be encrypted by those keys (however, see <a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=610095">bug 610095</a>). Because of the non-secure fallback logic in Firefox (and Chrome), an attacker will be able to silently cause the browser to encrypt the data with the key, and then re-try with a successful handshake, with the intent of stealing the server's private key later.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; nobody</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=isnotempty">tracking-firefox34</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Component: Security &rarr; Libraries</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div><div class="change">Product: Core &rarr; NSS</div><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=610095">610095</a></div><div class="change">Target Milestone: --- &rarr; 3.17.3</div><div class="change">Version: Trunk &rarr; trunk</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="9499620" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a37871_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-24 15:31 PDT" data-time="1414189883">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="9499620">Note that this affects all versions of NSS and all versions of all Mozilla products, but I didn't set all the status/tracking flags because I'm not sure which B2G-related flags are relvant.</pre><div class="activity"><div class="change">OS: Mac OS X &rarr; All</div><div class="change">Hardware: x86 &rarr; All</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="9518098" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a37871_1689"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 08:58 PDT" data-time="1414598325">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="9518098">[Tracking Requested - why for this release]:</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=isnotempty">status-b2g-v1.4</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=isnotempty">status-firefox33</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=isnotempty">status-firefox36</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=isnotempty">tracking-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=isnotempty">tracking-firefox35</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=isnotempty">tracking-firefox36</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=34%2B">34+</a></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="9519609" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a37871_1689"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 12:37 PDT" data-time="1414611445">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="9519609">Dan - Is a fix planned for the Firefox 34 time frame?</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="9527287" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a37871_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-30 17:47 PDT" data-time="1414716470">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="9527287">That's a better question for the NSS/PKI team. tagging Richard as a first guess.</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz) &rarr; needinfo?(rlb)</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="9532623" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a37871_1689"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-01 00:29 PDT" data-time="1414826986">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="9532623">I don't know if this bug report is the right place for this, but since I've been reporting state machine bugs, I'll continue to add them on this thread, since it seems to be a good place to sort out all these issues in one go.

We've been testing renegotiation behavior on various TLS implementations and one of the scenarios flagged the following behaviour in NSS.

During renegotiation, NSS accepts Application Data from the peer (and this is normal in TLS).
However, it continue to accept Application Data between Change Cipher Spec and Finished, that is, after the new keys have been installed, but before the new security context has been authenticated by the peer.
This feels like dangerous behavior, although not easily exploitable on the web.

The dangerous scenario is when an NSS TLS client is connected to a malicious server, then the server renegotiates but presents the valid certificate of an honest server. It can arbitrarily tamper with the new handshake and proceed all the way to ServerCCS, but it won't be able to forge a valid ServerFinished. However, if the client starts accepting Application Data before ServerFinished, it may be fooled into
accepting data thinking it is talking to the honest server S. 

The above scenario may become exploitable when:
- A client application is willing to accept different server identities during the initial handshake and renegotiation (E.g. the first is anonymous or uses a compromised cert, but the second uses a strong cert)
- The attacker is able to obtain and inject application data (out-of-order) before the ServerFinished.
  (This could happen, e.g. if the connection is using DTLS)

If it seems worth doing, I could try finding a concrete exploit on NSS/DTLS, but perhaps it would be simpler if we agreed this should be fixed. That is, no Application Data should be accepted between CCS and Finished (on the first or any subsequent handshake).

-K.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="9533484" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a37871_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-01 14:50 PDT" data-time="1414878629">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="9533484">(In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c18">comment #18</a>)
<span class="quote">&gt; - A client application is willing to accept different server identities
&gt; during the initial handshake and renegotiation (E.g. the first is anonymous
&gt; or uses a compromised cert, but the second uses a strong cert)</span >

I suggest that browsers implement the suggestion in <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Do not allow the server to change certificates during TLS renegotiation"
   href="/show_bug.cgi?id=978831">bug 978831</a> so that this never happens. This is one of multiple reasons to fix <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Do not allow the server to change certificates during TLS renegotiation"
   href="/show_bug.cgi?id=978831">bug 978831</a>.

<span class="quote">&gt; - The attacker is able to obtain and inject application data (out-of-order)
&gt; before the ServerFinished.
&gt;   (This could happen, e.g. if the connection is using DTLS)
&gt; 
&gt; If it seems worth doing, I could try finding a concrete exploit on NSS/DTLS,
&gt; but perhaps it would be simpler if we agreed this should be fixed. That is,
&gt; no Application Data should be accepted between CCS and Finished (on the
&gt; first or any subsequent handshake).</span >

I agree that that seems like a good idea too, worthy of its own bug.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="9533886" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a37871_1689"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-01 22:55 PDT" data-time="1414907722">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="9533886">The DTLS spec seems to agree (<a rel="nofollow" href="https://tools.ietf.org/html/rfc6347#section-4.1">https://tools.ietf.org/html/rfc6347#section-4.1</a>)

   Note that in the special case of a rehandshake on an existing
   association, it is safe to process a data packet immediately, even if
   the ChangeCipherSpec or Finished messages have not yet been received
   provided that either the rehandshake resumes the existing session or
   that it uses exactly the same security parameters as the existing
   association.  In any other case, the implementation MUST wait for the
   receipt of the Finished message to prevent downgrade attack.

A second class of attack may arise that does not involve switching server identities
(it's reminiscent of the classic renegotiation attack):
- A malicious client M connects to an honest server S and sends some data D
- An honest client C independently connects to the same server S
- M intercepts the handshake and sends it as a renegotiation over its own (encrypted) connection.
- M changes C's ClientHello to add a Renegotiation Indication extension, but otherwise makes no changes
- M sends C's CCS but drops C's ClientFinished
- M instead sends C's Application Data D' (e.g if using False start with DTLS) to the server.

If the server is accepting Application Data before finished during renegotiation (NSS), it will decrypt the packet and may release it to the application. Now the malicious client's data D and the good clients's D'
have been concatenated at the server. 

This scenario is effectively the same as Ray and Dispensa's renegotiation attack. The key is that the Secure Renego countermeasure only kicks in at the Finished message; if an attacker could bypass that the 
attack reappears.

The first important pre-condition for the above &quot;attack&quot; scenario is that the malicious client M should be able to get a good client's encrypted application data D' before having to send it a ServerFinished. This could easily happen during False Start. 

A second pre-condition is that the honest server should be willing to read the application data even though it appeared out of order. I am guessing this may happen during DTLS, but I don't have an easy way of testing it. In any case, I am pretty sure the server will decrypt the message using the new keys, whether or not it delivers it to the application. In some cases, since the new keys have not yet been authenticated, this may become an attack vector for some computational attacks. 

-Karthik

PS: Should I copy these comments over to a new bug, or shall I keep them here?</pre></div><div class="change-set" id="c21"><div class="comment" data-id="9601335" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a37871_1689"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a37871_1689"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-17 12:23 PST" data-time="1416255781">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="9601335">Given that we're at the end of the 34 beta cycle, I'm marking this bug as wontfix for 34.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a2981259_280903"><div class="change" id="aa2981259_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a2981259_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2981259_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2981259_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a2981259_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-24 11:36 PST" data-time="1416857792">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=34%2B">34+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=35%2B">35+</a></div></div></div><div class="change-set" id="c22"><div class="comment" data-id="9631285" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_373085" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/0f471505131b1c419602ba75cfa91397?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_373085" id="a2981259_280903"><a class="email " href="/user_profile?user_id=373085" > <span class="fna">Richard Barnes [:rbarnes]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-24 12:49 PST" data-time="1416862186">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="9631285">Yeah, looks like we've missed the 34 window.  I'll get someone to take a look at this for 35.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rlb)</span></div></div></div><div class="change-set" id="c23"><div class="comment" data-id="9735054" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_272375" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/d5497c1ef1eb10029cff0fef1764e7fa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_272375" id="a2981259_280903"><a class="email " href="/user_profile?user_id=272375" > <span class="fna">Lukas Blakk [:lsblakk] use ?needinfo</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-26 16:41 PST" data-time="1419640918">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="9735054">Richard, we're nearing the end of the 35 cycle with only one beta left on Mon Dec 29th - is there any news for this issue, are there options for a low risk resolution?</pre><div class="activity"><div class="change">Flags: needinfo?(rlb)</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="9735400" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a2981259_280903"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-27 01:40 PST" data-time="1419673235">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="9735400">I guess there are two levels of resolution that seem reasonable here.

As bsmith points out, the NSS state machine is asking for trouble (and will probably lead to new bugs in the future) but designing and implementing a new conservative state machine is probably a bit of work. 

In the short term, just fixing the ECDHE-&gt;ECDH fallback should fix the most egregious case above.
In addition, preventing application data between CCS and Finished during renegotiation seems like an easy fix?</pre></div><div class="change-set" id="c25"><div class="comment" data-id="9744409" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_272375" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/d5497c1ef1eb10029cff0fef1764e7fa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_272375" id="a2981259_280903"><a class="email " href="/user_profile?user_id=272375" > <span class="fna">Lukas Blakk [:lsblakk] use ?needinfo</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-31 10:55 PST" data-time="1420052114">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="9744409">Those options sound good, but at this stage in the cycle they will have to be for 36 and not 35. We only have an RC remaining and cannot take on speculative patches.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=isnotempty">status-firefox37</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=35%2B">35+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a></div></div></div><div class="change-set" id="c26"><div class="comment" data-id="9759412" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a2981259_280903"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-01-06 11:54 PST" data-time="1420574094">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="9759412">A heads up, two similar rollback attacks on openssl are due to be patched in openssl-1.0.1k (Jan 8th).
Notably the ECDHE-&gt;ECDH rollback in openssl will be disclosed as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3572">CVE-2014-3572</a></pre></div><div class="change-set" id="c27"><div class="comment" data-id="9805389" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2981259_280903"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-01-16 08:52 PST" data-time="1421427139">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="9805389">What is the plan for 36 wrt this bug? Thanks</pre></div><div class="change-set" id="c28"><div class="comment" data-id="9857987" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2981259_280903"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-01-29 07:12 PST" data-time="1422544370">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="9857987">No activity on this. I am going to untrack it.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=isnotempty">tracking-firefox36</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=equals&amp;v1=%2B">+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=equals&amp;v1=-">-</a></div></div></div><div class="change-set" id="c29"><div class="comment" data-id="9858789" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a2981259_280903"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-01-29 09:53 PST" data-time="1422553989">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="9858789">If it would help push this along, I could propose a patch. 

Alternatively, I could set a student to hunt for more attacks, which would not be very productive, considering that we already know that the state machine in NSS has bugs.</pre></div><div class="change-set" id="c30"><div class="comment" data-id="9858795" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2981259_280903"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-01-29 09:54 PST" data-time="1422554054">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="9858795">(In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c29">comment #29</a>)
<span class="quote">&gt; If it would help push this along, I could propose a patch. </span >
Yes, it would help a lot.</pre></div><div class="change-set" id="c31"><div class="comment" data-id="9858801" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a2981259_280903"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a2981259_280903"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-01-29 09:55 PST" data-time="1422554109">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="9858801"><span class="quote">&gt; &gt; If it would help push this along, I could propose a patch. 
&gt; Yes, it would help a lot.</span >

We'll get on it.</pre></div><div class="change-set" id="a11470166_75935"><div class="change" id="aa11470166_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a11470166_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a11470166_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11470166_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11470166_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a11470166_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 17:38 PST" data-time="1425346699">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=isnotempty">status-b2g-master</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=isnotempty">status-firefox36</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=isnotempty">status-firefox38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=isnotempty">status-firefox39</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="9977613" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_294742" id="a11470166_75935"><img src="https://secure.gravatar.com/avatar/fa2ffb0f9916d4637d0b0a71415e6734?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_294742" id="a11470166_75935"><a class="email " href="/user_profile?user_id=294742" > <span class="fna">Benjamin Kerensa [:bkerensa]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 22:18 PST" data-time="1425363536">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="9977613">I'll leave this alone for ESR until we see what the plan is here</pre></div><div class="change-set" id="a11550637_14661"><div class="change" id="aa11550637_14661">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a11550637_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11550637_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11550637_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a11550637_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 15:59 PST" data-time="1425427170">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">CVE-2015-4000</a></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="10041560" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_272375" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/d5497c1ef1eb10029cff0fef1764e7fa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_272375" id="a11550637_14661"><a class="email " href="/user_profile?user_id=272375" > <span class="fna">Lukas Blakk [:lsblakk] use ?needinfo</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-17 12:06 PDT" data-time="1426619175">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="10041560">With no assignee and no plan of action on this bug, given that ESR 38 is 8 weeks away, there's no reason to track this for ESR 31 since we're a week away from the 37 RC and this is very unlikely to be fixed in time.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=-">-</a></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="10052033" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 10:36 PDT" data-time="1426786605">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="10052033">Discussed on the call today.  I'm going to have a crack at fixing the state machine.

I don't know that I understand enough of how this is playing up to generate a unit test, but I'll see if I can build something.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; martin.thomson</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="10052743" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a11550637_14661"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 12:59 PDT" data-time="1426795190">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="10052743">Thanks Martin, we'd be happy to provide a FlexTLS server (and client) to test against for compliance and non-compliance to the protocol state machine.</pre></div><div class="change-set" id="c36"><div class="comment" data-id="10053352" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 15:13 PDT" data-time="1426803237">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="10053352">OK, so I've done an initial bit of analysis, and I think that Brian's original analysis in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c1">comment 1</a> wasn't quite correct.  The states from which ServerHelloDone is accepted are indeed correct, since those messages are optional in TLS.  However, I believe that we need additional discipline when the inbound message skips an optional message.

As mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c5">comment 5</a>, we need to be checking the negotiated key agreement to determine whether skipping ServerKeyExchange is permitted.  If the key agreement requires the message, then the skip should be disallowed.  The same logic applies to Certificate also.  It seems valid to always allow skipping of CertificateRequest.

In all cases, an attacker that induces this sort of error can only benefit if they can also subsequently falsify the Finished message.  I will concede might be made feasible by the secondary effects of monkeying with ordering, as Brian described regarding the original issue.

I'm going to add the extra checks for Certificate and ServerKeyExchange; then I'll look more into fortifying the second order problems.

(Note that the point regarding application data between CCS and Finished doesn't bother me, as long as we only report the new status after Finished is verified.  That is, the data might as well belong to the previous generation of application data until the application is told that the new regime is in place.)</pre><div class="activity"><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="10058773" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 14:46 PDT" data-time="1426887992">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="10058773">First cut done: <a rel="nofollow" href="https://codereview.appspot.com/218070043/">https://codereview.appspot.com/218070043/</a></pre><div class="activity"><div class="change">Flags: needinfo?(wtc)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="10059101" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 15:57 PDT" data-time="1426892235">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8580964"
         class="attachment patch obsolete"
         data-id="8580964" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-1.patch">
      <meta itemprop="contentSize" content="12896">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8580964">
          <a class="link" href="attachment.cgi?id=8580964&amp;action=diff">
        <span id="att-8580964-description" itemprop="description">bug1086145-1.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8580964&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8580964">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-38" data-comment-id="10059101">See also rietveld.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580964&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8580964</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="10059102" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 15:57 PDT" data-time="1426892260">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8580965"
         class="attachment patch obsolete"
         data-id="8580965" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-2.patch">
      <meta itemprop="contentSize" content="24958">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8580965">
          <a class="link" href="attachment.cgi?id=8580965&amp;action=diff">
        <span id="att-8580965-description" itemprop="description">bug1086145-2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8580965&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8580965">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580965&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8580965</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="10113790" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a11550637_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-02 15:22 PDT" data-time="1428013371">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="10113790">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8580964" name="attach_8580964" title="bug1086145-1.patch">attachment 8580964</a> <a href="/attachment.cgi?id=8580964&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8580964&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8580964'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8580964" name="attach_8580964" title="bug1086145-1.patch">attachment 8580964</a> <a href="/attachment.cgi?id=8580964&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8580964&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8580964'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I reviewed this patch at <a rel="nofollow" href="https://codereview.appspot.com/218070043/">https://codereview.appspot.com/218070043/</a>.
I suggested some changes.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580964&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8580964</a> -
        Flags: review?(wtc) &rarr; review+</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="10113795" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a11550637_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-02 15:25 PDT" data-time="1428013510">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="10113795">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8580965" name="attach_8580965" title="bug1086145-2.patch">attachment 8580965</a> <a href="/attachment.cgi?id=8580965&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8580965&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8580965'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8580965" name="attach_8580965" title="bug1086145-2.patch">attachment 8580965</a> <a href="/attachment.cgi?id=8580965&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8580965&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8580965'>[review]</a>:
-----------------------------------------------------------------

Eric, could you review the tests that Martin added? Thanks.

My feedback+ indicates an approval for checkin (and an extremely
cursory review) rather than a review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580965&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8580965</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8580965&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8580965</a> -
        Flags: review?(ekr)</div><div class="change">
        <a href="/attachment.cgi?id=8580965&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8580965</a> -
        Flags: feedback+</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="10117852" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 15:37 PDT" data-time="1428100656">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8588198"
         class="attachment patch obsolete"
         data-id="8588198" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-1.patch">
      <meta itemprop="contentSize" content="13366">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8588198">
          <a class="link" href="attachment.cgi?id=8588198&amp;action=diff">
        <span id="att-8588198-description" itemprop="description">bug1086145-1.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8588198&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8588198">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-42" data-comment-id="10117852">Wan-Teh did say that he was happy with this, but I'd feel much better if this had a second round of checking given the extent of the changes.  Rietveld is already updated.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580964&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8580964</a> -
        Attachment is obsolete: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8588198&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588198</a> -
        Flags: review+</div><div class="change">
        <a href="/attachment.cgi?id=8588198&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588198</a> -
        Flags: feedback?(wtc)</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="10117854" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a11550637_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a11550637_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 15:38 PDT" data-time="1428100690">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8588199"
         class="attachment patch obsolete"
         data-id="8588199" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-2.patch">
      <meta itemprop="contentSize" content="26231">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8588199">
          <a class="link" href="attachment.cgi?id=8588199&amp;action=diff">
        <span id="att-8588199-description" itemprop="description">bug1086145-2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8588199&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8588199">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580965&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8580965</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8580965&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8580965</a> -
        Flags: <span class="activity-deleted">review?(ekr)</span></div><div class="change">
        <a href="/attachment.cgi?id=8588199&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8588199</a> -
        Flags: review?(ekr)</div></div></div><div class="change-set" id="a14224223_438654"><div class="change" id="aa14224223_438654">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14224223_438654"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14224223_438654">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a14224223_438654">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 15:39 PDT" data-time="1428100756">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Disable NSS silent fallback to non-forward secret ciphersuites (or disable False Start) &rarr; NSS incorrectly permits skipping of ServerKeyExchange</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="10117932" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a14224223_438654"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 16:03 PDT" data-time="1428102193">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="10117932">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588198" name="attach_8588198" title="bug1086145-1.patch">attachment 8588198</a> <a href="/attachment.cgi?id=8588198&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588198&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588198'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588198" name="attach_8588198" title="bug1086145-1.patch">attachment 8588198</a> <a href="/attachment.cgi?id=8588198&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588198&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588198'>[review]</a>:
-----------------------------------------------------------------

::: lib/ssl/ssl3con.c
&#64;&#64; +6646,5 &#64;&#64;
<span class="quote">&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveRecvBufLock(ss) );
&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveSSL3HandshakeLock(ss) );
&gt;  
&gt; +    if (ss-&gt;ssl3.hs.ws != wait_server_key ||
&gt; +        ss-&gt;sec.peerCert == NULL) {</span >

I think the ss-&gt;sec.peerCert case should be either removed here.

When could ss-&gt;sec.peerCert be NULL here? The only place that sets ssl3.hs.ws = wait_server_key is ssl3_AuthCertificate, and that only happens after the certificate has already been set.

&#64;&#64; +9840,5 &#64;&#64;
<span class="quote">&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveRecvBufLock(ss) );
&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveSSL3HandshakeLock(ss) );
&gt;  
&gt; +    if ((isServer &amp;&amp; ss-&gt;ssl3.hs.ws != wait_client_cert) ||
&gt; +        (!isServer &amp;&amp; ss-&gt;ssl3.hs.ws != wait_server_cert)) {</span >

Is isn't necessary to check isServer here. ss-&gt;ssl3.hs.ws = wait_client_cert is only set by ssl3_SendServerHelloSequence, and ss-&gt;ssl3.hs.ws = wait_server_cert is only set by ssl3_HandleServerHello.

IMO, it is better not to add these redundant checks.

::: lib/ssl/sslsecur.c
&#64;&#64; +399,5 &#64;&#64;
<span class="quote">&gt;      }
&gt;  
&gt; +    /* Require a strong, forward-secret key exchange. */
&gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; +      !ss-&gt;ssl3.hs.kea_def-&gt;is_limited;</span >

I believe the old code was correct, and the old code was better because it made it more clear exactly which key exchange algorithms are being whitelisted. It's safer to explicitly whitelist the allowed KEAs than to allow any non-limited ephemeral key exchange algorithm, when considering that we may add new kinds of ephemeral key exchange in the future.

Also, there should be a follow-up bug to remove the non-ECC DHE_* algorithms from the whitelist, because they are generally not safe for False Start.</pre></div><div class="change-set" id="c45"><div class="comment" data-id="10117961" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a14224223_438654"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 16:14 PDT" data-time="1428102891">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="10117961">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588198" name="attach_8588198" title="bug1086145-1.patch">attachment 8588198</a> <a href="/attachment.cgi?id=8588198&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588198&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588198'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588198" name="attach_8588198" title="bug1086145-1.patch">attachment 8588198</a> <a href="/attachment.cgi?id=8588198&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588198&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588198'>[review]</a>:
-----------------------------------------------------------------

::: lib/ssl/ssl3con.c
&#64;&#64; +6586,5 &#64;&#64;
<span class="quote">&gt; +    } else if (ss-&gt;ssl3.hs.kea_def-&gt;ephemeral) {
&gt; +        ss-&gt;ssl3.hs.ws = wait_server_key;
&gt; +    } else {
&gt; +        ss-&gt;ssl3.hs.ws = wait_cert_request;
&gt; +    }</span >

I would expect it to be organized like this:

if (/*cipher suite uses certs*/) {
  ss-&gt;ssl3.hs.ws = wait_server_cert;
} else if (ss-&gt;ssl3.hs.kea_def-&gt;ephemeral) {
  /* anonymous DH and similar do not use a Certificate
   * message */
  ss-&gt;ssl3.hs.ws = wait_server_key;
} else {
  /* A comment explaining which types of cipher suites this
   * case applies to.
   */
  ss-&gt;ssl3.hs.ws = wait_cert_request;
} else {
  /* Some cipher suites don't use certificates at all, and
   * aren't allowed to request a client certificate. */
  ss-&gt;ssl3.hs.ws = wait_hello_done;
}

In particular:

1. NIT: Order the conditions so that wait_server_cert appears before wait_server_key and wait_server_key before wait_cert_request, to be consistent with the on-the-wire order of those messages.

2. I'm not convinced that &quot;ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != sign_null&quot; is the best wait to determine whether the cipher suite requires the server to send a Certificate message. Isn't there a clearer way to determine that? If not, documenting the reasoning in a comment would be useful.

3. It seems questionable to me to allow a Certificate-less server to request a certificate from a client at all. It is worth documenting here which kinds of cipher suites need that treatment, if any.

4. It's worth ensuring that cipher suites that shouldn't be allowed to request a client certificate aren't allowed to request one.</pre></div><div class="change-set" id="c46"><div class="comment" data-id="10117988" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a14224223_438654"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 16:22 PDT" data-time="1428103351">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="10117988">I haven't had a chance to review yet, just noting that it would be good to coordinating patching/disclosure so that we can land this to Chrome at an appropriate time as well.</pre></div><div class="change-set" id="c47"><div class="comment" data-id="10118027" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a14224223_438654"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 16:40 PDT" data-time="1428104412">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="10118027">Additional items, perhaps better done in follow-up bugs:

1. It seems like the check of ss-&gt;ssl3.hs.ws in ssl3_HandleClientHello should be moved up towards the top of the function.

2. It isn't clear how the code prevents a client from accepting a ClientHello from the server instead of a ServerHello as described above.</pre></div><div class="change-set" id="c48"><div class="comment" data-id="10123231" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14224223_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 15:43 PDT" data-time="1428360195">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="10123231">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588198" name="attach_8588198" title="bug1086145-1.patch">attachment 8588198</a> <a href="/attachment.cgi?id=8588198&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588198&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588198'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588198" name="attach_8588198" title="bug1086145-1.patch">attachment 8588198</a> <a href="/attachment.cgi?id=8588198&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588198&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588198'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I reviewed this patch at <a rel="nofollow" href="https://codereview.appspot.com/218070043/">https://codereview.appspot.com/218070043/</a>

::: lib/ssl/sslsecur.c
&#64;&#64; +399,5 &#64;&#64;
<span class="quote">&gt;      }
&gt;  
&gt; +    /* Require a strong, forward-secret key exchange. */
&gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; +      !ss-&gt;ssl3.hs.kea_def-&gt;is_limited;</span >

I agree it is safer to revert to the whitelist of the old code here. In my code review at <a rel="nofollow" href="https://codereview.appspot.com/218070043/">https://codereview.appspot.com/218070043/</a> I noted that we need to disallow the &quot;anon&quot; cipher suites, which are also ephemeral. So the new code seems more error-prone.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588198&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588198</a> -
        Flags: feedback?(wtc) &rarr; feedback+</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="10123404" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 16:34 PDT" data-time="1428363263">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="10123404">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c44">comment #44</a>)
<span class="quote">&gt; &gt; +    if (ss-&gt;ssl3.hs.ws != wait_server_key ||
&gt; &gt; +        ss-&gt;sec.peerCert == NULL) {
&gt; 
&gt; I think the ss-&gt;sec.peerCert case should be either removed here.</span >

You are correct.  I was only doing refactoring based on local information.

<span class="quote">&gt; IMO, it is better not to add these redundant checks.</span >

I guess we disagree then.  If these get merged into the one state, then this is fine.

(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c45">comment #45</a>)
[...]
<span class="quote">&gt; &gt; +    } else if (ss-&gt;ssl3.hs.kea_def-&gt;ephemeral) {
&gt; &gt; +        ss-&gt;ssl3.hs.ws = wait_server_key;
&gt; &gt; +    } else {
&gt; &gt; +        ss-&gt;ssl3.hs.ws = wait_cert_request;
&gt; &gt; +    }
&gt; 
&gt; I would expect it to be organized like this:
&gt; 
&gt; if (/*cipher suite uses certs*/) {
&gt;   ss-&gt;ssl3.hs.ws = wait_server_cert;
&gt; } else if (ss-&gt;ssl3.hs.kea_def-&gt;ephemeral) {
&gt;   /* anonymous DH and similar do not use a Certificate
&gt;    * message */
&gt;   ss-&gt;ssl3.hs.ws = wait_server_key;
&gt; } else {
&gt;   /* A comment explaining which types of cipher suites this
&gt;    * case applies to.
&gt;    */
&gt;   ss-&gt;ssl3.hs.ws = wait_cert_request;
&gt; } else {
&gt;   /* Some cipher suites don't use certificates at all, and
&gt;    * aren't allowed to request a client certificate. */
&gt;   ss-&gt;ssl3.hs.ws = wait_hello_done;
&gt; }</span >

That final else can't be reached if you accept that sign_null is the right signal.  And I don't have any alternative.  So you are describing what I constructed, sans explanatory text, which I'll add.
 
<span class="quote">&gt; 3. It seems questionable to me to allow a Certificate-less server to request
&gt; a certificate from a client at all. It is worth documenting here which kinds
&gt; of cipher suites need that treatment, if any.</span >

I thought about that but considered it less of a correctness issue than simply a strictness one.

Technically, with the signature_algorithms extension we can have an anon_DH suite where the server requests a client certificate.  That might sound perverse, but I didn't want to add more spaghetti to what is already an immense pile.  I think that the only place that needs to go is in 2 out of three of the alternatives in ssl3_HandleServerKeyExchange (kt_rsa always corresponds to sign_rsa there).

However, I just looked and it looks like we would explode if someone tried to do anon_DH in any form other than ECDH because there is a consistency check between the certificate and the key exchange.  This is currently safe because we don't support any of those cipher suites.

<span class="quote">&gt; 4. It's worth ensuring that cipher suites that shouldn't be allowed to
&gt; request a client certificate aren't allowed to request one.</span >

I guess that I could check for (ssl3_ExtensionNegotiated(ss, ssl_signature_algorithms_xtn) || ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != sign_null) in both places.  Thoughts?

(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c47">comment #47</a>)
<span class="quote">&gt; Additional items, perhaps better done in follow-up bugs:
&gt; 
&gt; 1. It seems like the check of ss-&gt;ssl3.hs.ws in ssl3_HandleClientHello
&gt; should be moved up towards the top of the function.</span >

I'll do that.

<span class="quote">&gt; 2. It isn't clear how the code prevents a client from accepting a
&gt; ClientHello from the server instead of a ServerHello as described above.</span >

Well, the checks I have on the certificate help a little.  But I think that you are right to ask this question.  It seems that a client would accept a ClientHello from a server and make it some part of the way through a handshake.  I don't expect it to get very far, not even as far as Certificate messages, but it might trip some edge cases on the way.  It's easy to prevent.</pre></div><div class="change-set" id="c50"><div class="comment" data-id="10123430" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 16:47 PDT" data-time="1428364020">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="10123430"><span class="quote">&gt; &gt; +    /* Require a strong, forward-secret key exchange. */
&gt; &gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; &gt; +      !ss-&gt;ssl3.hs.kea_def-&gt;is_limited;
&gt; 
&gt; I agree it is safer to revert to the whitelist of the old code here. In my
&gt; code review at <a rel="nofollow" href="https://codereview.appspot.com/218070043/">https://codereview.appspot.com/218070043/</a> I noted that we
&gt; need to disallow the &quot;anon&quot; cipher suites, which are also ephemeral. So the
&gt; new code seems more error-prone.</span >

Error-prone only because I screwed up and added a potential downgrade from authenticated to unauthenticated modes ? :)

I actually disagree on both points now that I've considered it.

If the client offered an unauthenticated cipher suite, then this is actually fine as-is.  That downgrade is possible anyway with a straight MitM, a far easier downgrade than the theoretical risk that makes us avoid static key exchange modes.  Why deny those clients the performance advantage when they clearly aren't losing anything they weren't prepared to give up in the first place?

As for the relative merits of deciding based on properties vs. an explicit list, I prefer the properties, precisely because that is more maintainable.

My current code says this:

    /* Recommend only if there is a strong, forward-secrecy-capable suite.
     * Suites using kt_dh don't count (without named group support).
     * Note: This also excludes all export cipher suites. */
    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
      !ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != kt_dh;


We might consider restoring kt_dh if someone implements the named group extension for DHE, but I'm not holding my breath there.</pre></div><div class="change-set" id="c51"><div class="comment" data-id="10123435" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 16:49 PDT" data-time="1428364170">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8588820"
         class="attachment patch obsolete"
         data-id="8588820" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-1.patch">
      <meta itemprop="contentSize" content="16860">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8588820">
          <a class="link" href="attachment.cgi?id=8588820&amp;action=diff">
        <span id="att-8588820-description" itemprop="description">bug1086145-1.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8588820&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8588820">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-51" data-comment-id="10123435">r=wtc

Note that I'm happy to update this if the discussion continues to reach a different conclusion.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588198&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588198</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8588820&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588820</a> -
        Flags: review+</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="10123756" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14224223_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 18:50 PDT" data-time="1428371414">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="10123756">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588820" name="attach_8588820" title="bug1086145-1.patch">attachment 8588820</a> <a href="/attachment.cgi?id=8588820&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588820&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588820'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588820" name="attach_8588820" title="bug1086145-1.patch">attachment 8588820</a> <a href="/attachment.cgi?id=8588820&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8588820&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588820'>[review]</a>:
-----------------------------------------------------------------

I spotted a bug. Please see the comment marked with &quot;IMPORTANT&quot;.

::: lib/ssl/ssl3con.c
&#64;&#64; +288,5 &#64;&#64;
<span class="quote">&gt;  { /* indexed by SSL3KeyExchangeAlgorithm */
&gt; +    /* kea            exchKeyType signKeyType is_limited limit tls_keygen ephemeral */
&gt; +    {kea_null,           kt_null, sign_null,  PR_FALSE,   0, PR_FALSE, PR_FALSE},
&gt; +    {kea_rsa,            kt_rsa,  sign_rsa,   PR_FALSE,   0, PR_FALSE, PR_FALSE},
&gt; +    {kea_rsa_export,     kt_rsa,  sign_rsa,   PR_TRUE,  512, PR_FALSE, PR_FALSE},</span >

We need to set ephemeral=PR_TRUE for kea_rsa_export.
We no longer allow weak RSA certificates. For RSA
certificates we allow, the ServerKeyExchange message
is required.

::: lib/ssl/sslsecur.c
&#64;&#64; +401,5 &#64;&#64;
<span class="quote">&gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.
&gt; +     * Suites using kt_dh don't count (without named group support).
&gt; +     * Note: This also excludes all export cipher suites. */
&gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; +      !ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != kt_dh;</span >

IMPORTANT: there is an extraneous '!' at the beginning of this line.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588820&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588820</a> -
        Flags: feedback-</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="10126773" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 10:26 PDT" data-time="1428427606">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8589196"
         class="attachment patch obsolete"
         data-id="8589196" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-1.patch">
      <meta itemprop="contentSize" content="16858">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8589196">
          <a class="link" href="attachment.cgi?id=8589196&amp;action=diff">
        <span id="att-8589196-description" itemprop="description">bug1086145-1.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8589196&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8589196">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-53" data-comment-id="10126773">r=wtc; with snafus removed.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588820&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8588820</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8589196&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8589196</a> -
        Flags: review+</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="10127094" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14224223_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 11:28 PDT" data-time="1428431298">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="10127094">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8589196" name="attach_8589196" title="bug1086145-1.patch">attachment 8589196</a> <a href="/attachment.cgi?id=8589196&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8589196&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8589196'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8589196" name="attach_8589196" title="bug1086145-1.patch">attachment 8589196</a> <a href="/attachment.cgi?id=8589196&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8589196&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8589196'>[review]</a>:
-----------------------------------------------------------------

Martin, I believe your conditional expression in SSL_RecommendedCanFalseStart
still has a bug. Please see my comments marked with &quot;IMPORTANT&quot; or &quot;BUG?&quot;.
I hope I didn't misunderstand the code.

::: lib/ssl/ssl3con.c
&#64;&#64; +6582,5 &#64;&#64;
<span class="quote">&gt;  
&gt;      ss-&gt;ssl3.hs.isResuming = PR_FALSE;
&gt; +    if (ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != sign_null) {
&gt; +        /* All current cipher suites other than those with sign_null (i.e.,
&gt; +         * anon_dh suites) require a certificate, so use that signal. */</span >

Nit: anon_dh =&gt; dh_anon

&#64;&#64; +6648,5 &#64;&#64;
<span class="quote">&gt;  		SSL_GETPID(), ss-&gt;fd));
&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveRecvBufLock(ss) );
&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveSSL3HandshakeLock(ss) );
&gt;  
&gt; +    if (ss-&gt;ssl3.hs.ws != wait_server_key) {</span >

The ss-&gt;sec.peerCert == NULL test in the original code seems to detect that we received a ServerKeyExchange message without first receiving a Certificate message. In the new code, I agree this test can be removed. (It doesn't really matter, but that test would be incompatible with the &quot;anon&quot; cipher suites.)

&#64;&#64; +7652,5 &#64;&#64;
<span class="quote">&gt;      PORT_Assert( ss-&gt;ssl3.initialized );
&gt;  
&gt; +    if (!ss-&gt;sec.isServer ||
&gt; +        ((ss-&gt;ssl3.hs.ws != wait_client_hello) &amp;&amp;
&gt; +         (ss-&gt;ssl3.hs.ws != idle_handshake))) {</span >

Nit: (I know these come from the original code) we can omit the two pairs of innermost parentheses:

    if (!ss-&gt;sec.isServer ||
        (ss-&gt;ssl3.hs.ws != wait_client_hello &amp;&amp;
         ss-&gt;ssl3.hs.ws != idle_handshake)) {

&#64;&#64; +7665,5 &#64;&#64;
<span class="quote">&gt; +        errCode = SSL_ERROR_RENEGOTIATION_NOT_ALLOWED;
&gt; +        goto alert_loser;
&gt; +    }
&gt; +
&gt; +</span >

Nit: delete one blank line.

&#64;&#64; +9057,5 &#64;&#64;
<span class="quote">&gt;  
&gt;      isTLS = (PRBool)(ss-&gt;ssl3.prSpec-&gt;version &gt; SSL_LIBRARY_VERSION_3_0);
&gt;      isTLS12 = (PRBool)(ss-&gt;ssl3.prSpec-&gt;version &gt;= SSL_LIBRARY_VERSION_TLS_1_2);
&gt;  
&gt; +    if (ss-&gt;ssl3.hs.ws != wait_cert_verify) {</span >

I verified it is safe to remove the ss-&gt;sec.peerCert == NULL test in the original code because we only transition to the wait_cert_verify state when ss-&gt;sec.peerCert is not null.

::: lib/ssl/sslimpl.h
&#64;&#64; +726,5 &#64;&#64;
<span class="quote">&gt;      SSL3KEAType              exchKeyType;
&gt;      SSL3SignType             signKeyType;
&gt; +    /* For export cipher suites:
&gt; +     * is_limited identifies a suite as having a limit on the modulus length.
&gt; +     * key_size_limit provides the corresponding maximum modulus length */</span >

Nit: should the wording be more generic and say &quot;key size&quot; instead of &quot;modulus length&quot;?

&#64;&#64; +731,4 &#64;&#64;
<span class="quote">&gt;      PRBool                   is_limited;
&gt;      int                      key_size_limit;
&gt;      PRBool                   tls_keygen;
&gt; +    /* True if the key exchange for the suite can be ephemeral. */</span >

Nit: does &quot;can be&quot; imply the key exchange method doesn't need to be ephemeral?

::: lib/ssl/sslsecur.c
&#64;&#64; +397,5 &#64;&#64;
<span class="quote">&gt;  	PORT_SetError(SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_SSL2);
&gt;  	return SECFailure;
&gt;      }
&gt;  
&gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.</span >

Super nit: I think you use &quot;Recommend&quot; here because the function is named SSL_RecommendedCanFalseStart. But that function name means it uses the NSS recommended criteria. So ideally we should say &quot;NSS recommends False Start require a strong, forward-secrecy-capable suite&quot;, which can be shortened to &quot;Require a strong, forward-secrecy-capable suite.&quot; Your new wording is a little unclear.

&#64;&#64; +399,5 &#64;&#64;
<span class="quote">&gt;      }
&gt;  
&gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.
&gt; +     * Suites using kt_dh don't count (without named group support).
&gt; +     * Note: This also excludes all export cipher suites. */</span >

IMPORTANT: how does this exclude all export cipher suites? The !is_limited test is gone.

&#64;&#64; +401,5 &#64;&#64;
<span class="quote">&gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.
&gt; +     * Suites using kt_dh don't count (without named group support).
&gt; +     * Note: This also excludes all export cipher suites. */
&gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; +      ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != kt_dh;</span >

1. BUG?: I think we should test exchKeyType instead of signKeyType.
This test should read:
    ss-&gt;ssl3.hs.kea_def-&gt;exchKeyType != kt_dh

Also, this test seems to allow kea_rsa_export, kea_rsa_export_1024,
and all the &quot;anon&quot; key exchange methods.

2. Nit: please indent four spaces relative to the previous line.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8589196&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8589196</a> -
        Flags: review-</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="10127784" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a14224223_438654"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 13:27 PDT" data-time="1428438448">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="10127784">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8589196" name="attach_8589196" title="bug1086145-1.patch">attachment 8589196</a> <a href="/attachment.cgi?id=8589196&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8589196&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8589196'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8589196" name="attach_8589196" title="bug1086145-1.patch">attachment 8589196</a> <a href="/attachment.cgi?id=8589196&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8589196&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8589196'>[review]</a>:
-----------------------------------------------------------------

::: lib/ssl/ssl3con.c
&#64;&#64; +7652,5 &#64;&#64;
<span class="quote">&gt;      PORT_Assert( ss-&gt;ssl3.initialized );
&gt;  
&gt; +    if (!ss-&gt;sec.isServer ||
&gt; +        ((ss-&gt;ssl3.hs.ws != wait_client_hello) &amp;&amp;
&gt; +         (ss-&gt;ssl3.hs.ws != idle_handshake))) {</span >

Does ss-&gt;sec.isServer always get set reliably before ssl3_HandleClientHello is called?

In particular, what if the client does the TCP connection, but the server sends a ClientHello before the client calls ssl3_SendClientHello?

&#64;&#64; +7653,5 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (!ss-&gt;sec.isServer ||
&gt; +        ((ss-&gt;ssl3.hs.ws != wait_client_hello) &amp;&amp;
&gt; +         (ss-&gt;ssl3.hs.ws != idle_handshake))) {
&gt; +        desc    = unexpected_message;</span >

Nit: collapse multiple spaces.

&#64;&#64; +7657,5 &#64;&#64;
<span class="quote">&gt; +        desc    = unexpected_message;
&gt; +        errCode = SSL_ERROR_RX_UNEXPECTED_CLIENT_HELLO;
&gt; +        goto alert_loser;
&gt; +    }
&gt; +    if (ss-&gt;ssl3.hs.ws == idle_handshake  &amp;&amp;</span >

Nit: too many spaces before &quot;&amp;&amp;&quot;

&#64;&#64; +7660,5 &#64;&#64;
<span class="quote">&gt; +    }
&gt; +    if (ss-&gt;ssl3.hs.ws == idle_handshake  &amp;&amp;
&gt; +        ss-&gt;opt.enableRenegotiation == SSL_RENEGOTIATE_NEVER) {
&gt; +        desc    = no_renegotiation;
&gt; +        level   = alert_warning;</span >

ditto unneccessary spaces.

&#64;&#64; +9844,5 &#64;&#64;
<span class="quote">&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveRecvBufLock(ss) );
&gt;      PORT_Assert( ss-&gt;opt.noLocks || ssl_HaveSSL3HandshakeLock(ss) );
&gt;  
&gt; +    if ((isServer &amp;&amp; ss-&gt;ssl3.hs.ws != wait_client_cert) ||
&gt; +        (!isServer &amp;&amp; ss-&gt;ssl3.hs.ws != wait_server_cert)) {</span >

You mentioned that you thought it was unnecessary to revert this change because it didn't matter. Conversely, why add a change that doesn't do anything except make the code less consistent? In particular, note that no other function seems to test isServer when testing ss-&gt;ssl3.hs.ws and this code makes the reader wonder if these impossible states are possible. It seems bad to me.

I'd rather have the changes be limited to fixing the problem or making the logic *more* clear.

::: lib/ssl/sslimpl.h
&#64;&#64; +731,4 &#64;&#64;
<span class="quote">&gt;      PRBool                   is_limited;
&gt;      int                      key_size_limit;
&gt;      PRBool                   tls_keygen;
&gt; +    /* True if the key exchange for the suite can be ephemeral. */</span >

s/can be/is/

::: lib/ssl/sslsecur.c
&#64;&#64; +401,5 &#64;&#64;
<span class="quote">&gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.
&gt; +     * Suites using kt_dh don't count (without named group support).
&gt; +     * Note: This also excludes all export cipher suites. */
&gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; +      ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != kt_dh;</span >

Again, why make an change to this code in this patch that is unnecessary for fixing this bug? If you think this code is unclear or you think the false start criteria are wrong, that should be discussed and fixed in a separate bug.

I think by now it is clear that the previous version of the code was less error-prone, given that there have been two errors in the attempts to improve it.

Also, the original code took a whitelisting approach to deciding which specific cipher suites to enable, whereas the new code takes more of a blacklisting approach. The usual style is to prefer the whitelisting approach.

Regarding your argument that it is OK to false start for anonymous cipher suites: I'm not disagreeing with that, but making that improvement is outside the scope of this bug so why discuss that here?

Again, in general, changes should be restricted to what is needed to fix the bug, especially with a security bug like this one.</pre></div><div class="change-set" id="c56"><div class="comment" data-id="10127892" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 13:52 PDT" data-time="1428439975">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="10127892">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c54">comment #54</a>)
<span class="quote">&gt; &gt; +    /* True if the key exchange for the suite can be ephemeral. */
&gt; 
&gt; Nit: does &quot;can be&quot; imply the key exchange method doesn't need to be
&gt; ephemeral?</span >

Yes.  It is entirely possible to supply a static key in ServerKeyExchange.  NSS provides the same ephemeral key for export cipher suites, as well as ECDHE.  The latter know has an option to generate a new key pair for every connection, but that's only recent.

Of course, the definition of ephemeral is something that is debatable too.  Some people insist on a definition that allows only one use.  Others insist that it's OK to say that something is ephemeral as long as the key doesn't get stored or reused too much (where stored and reused have varying degrees of flexibility).
 
<span class="quote">&gt; &gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.
&gt; 
&gt; Super nit: I think you use &quot;Recommend&quot; here because the function is named
&gt; SSL_RecommendedCanFalseStart. But that function name means it uses the NSS
&gt; recommended criteria. So ideally we should say &quot;NSS recommends False Start
&gt; require a strong, forward-secrecy-capable suite&quot;, which can be shortened to
&gt; &quot;Require a strong, forward-secrecy-capable suite.&quot; Your new wording is a
&gt; little unclear.</span >

I've reworded to:
    /* Recommend false start only if there is a strong, forward-secrecy-capable
     * suite.  Export cipher suites definitely aren't strong enough.  Suites
     * using kt_dh key exchange can't guarantee that they are strong enough. */
 
<span class="quote">&gt; IMPORTANT: how does this exclude all export cipher suites? The !is_limited
&gt; test is gone.</span >

I obviously screwed up this one, didn't I.
 
<span class="quote">&gt; &#64;&#64; +401,5 &#64;&#64;
&gt; &gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; &gt; +      ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != kt_dh;
&gt; 
&gt; 1. BUG?: I think we should test exchKeyType instead of signKeyType.
&gt; This test should read:
&gt;     ss-&gt;ssl3.hs.kea_def-&gt;exchKeyType != kt_dh</span >

Good catch.  If this were a good language, type checking would have prevented this from compiling.

<span class="quote">&gt; Also, this test seems to allow kea_rsa_export, kea_rsa_export_1024,
&gt; and all the &quot;anon&quot; key exchange methods.</span >

The export thing is a mistake.

As I noted in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c50">comment 50</a>, I see no reason not to allow false start for &quot;anon&quot; methods.

    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
        !ss-&gt;ssl3.hs.kea_def-&gt;is_limited &amp;&amp;
        ss-&gt;ssl3.hs.kea_def-&gt;exchKeyType != kt_dh;</pre></div><div class="change-set" id="c57"><div class="comment" data-id="10128004" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 14:10 PDT" data-time="1428441056">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="10128004">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c55">comment #55</a>)
<span class="quote">&gt; Does ss-&gt;sec.isServer always get set reliably before ssl3_HandleClientHello
&gt; is called?</span >

Yes.  Though the logic is a little hard to follow.  SSL_ResetHandshake is passed an 'asServer' flag, which determines whether ssl2_BeginServerHandshake() or ssl2_BeginClientHandshake() is called next.  Those each set the flag differently.

The main thing that this check prevents is a ClientHello being sent by the server on an existing connection.
 
<span class="quote">&gt; In particular, what if the client does the TCP connection, but the server
&gt; sends a ClientHello before the client calls ssl3_SendClientHello?</span >

Who starts the TCP connection is not something that libssl seems to care about.  It only really cares about the role.

<span class="quote">&gt; ::: lib/ssl/sslimpl.h
&gt; &#64;&#64; +731,4 &#64;&#64;
&gt; &gt;      PRBool                   is_limited;
&gt; &gt;      int                      key_size_limit;
&gt; &gt;      PRBool                   tls_keygen;
&gt; &gt; +    /* True if the key exchange for the suite can be ephemeral. */
&gt; 
&gt; s/can be/is/</span >

&quot;can be&quot; is more correct.
 
<span class="quote">&gt; ::: lib/ssl/sslsecur.c
&gt; &#64;&#64; +401,5 &#64;&#64;
&gt; &gt; +    /* Recommend only if there is a strong, forward-secrecy-capable suite.
&gt; &gt; +     * Suites using kt_dh don't count (without named group support).
&gt; &gt; +     * Note: This also excludes all export cipher suites. */
&gt; &gt; +    *canFalseStart = ss-&gt;ssl3.hs.kea_def-&gt;ephemeral &amp;&amp;
&gt; &gt; +      ss-&gt;ssl3.hs.kea_def-&gt;signKeyType != kt_dh;
&gt; 
&gt; Again, why make an change to this code in this patch that is unnecessary for
&gt; fixing this bug? If you think this code is unclear or you think the false
&gt; start criteria are wrong, that should be discussed and fixed in a separate
&gt; bug.
&gt; 
&gt; I think by now it is clear that the previous version of the code was less
&gt; error-prone, given that there have been two errors in the attempts to
&gt; improve it.</span >

I'm taking it out.</pre></div><div class="change-set" id="c58"><div class="comment" data-id="10128086" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 14:28 PDT" data-time="1428442083">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8589306"
         class="attachment patch obsolete"
         data-id="8589306" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-1.patch">
      <meta itemprop="contentSize" content="15885">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8589306">
          <a class="link" href="attachment.cgi?id=8589306&amp;action=diff">
        <span id="att-8589306-description" itemprop="description">bug1086145-1.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8589306&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8589306">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8589196&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8589196</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8589306&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8589306</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="10128172" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14224223_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 14:42 PDT" data-time="1428442965">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="10128172">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8589306" name="attach_8589306" title="bug1086145-1.patch">attachment 8589306</a> <a href="/attachment.cgi?id=8589306&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8589306&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8589306'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8589306" name="attach_8589306" title="bug1086145-1.patch">attachment 8589306</a> <a href="/attachment.cgi?id=8589306&amp;action=edit" title="bug1086145-1.patch">[details]</a> <a href="/attachment.cgi?id=8589306&amp;action=diff" title="bug1086145-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8589306'>[review]</a>:
-----------------------------------------------------------------

r=wtc.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8589306&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8589306</a> -
        Flags: review?(wtc) &rarr; review+</div></div></div><div class="change-set" id="c60"><div class="comment" data-id="10137896" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14224223_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-09 11:50 PDT" data-time="1428605424">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="10137896">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588199" name="attach_8588199" title="bug1086145-2.patch">attachment 8588199</a> <a href="/attachment.cgi?id=8588199&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8588199&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588199'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588199" name="attach_8588199" title="bug1086145-2.patch">attachment 8588199</a> <a href="/attachment.cgi?id=8588199&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8588199&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8588199'>[review]</a>:
-----------------------------------------------------------------

r=wtc. Overall this looks great. I found only one bug: the error_code_ member in tls_agent.h needs to be initialized by the constructor. Most of my comments are just nits. I marked two comments as &quot;IMPORTANT&quot;.

::: external_tests/README
&#64;&#64; +22,5 &#64;&#64;
<span class="quote">&gt;    ssl_gtest -d ${SSLGTESTDIR}
&gt;  
&gt; +Where $SSLGTESTDIR is a directory with a database containing:
&gt; + - an RSA certificate called server (with its private keys)
&gt; + - an ECDSA certificate called ecdsa (with its private keys)</span >

Nit: I know this comes from the original text, but each certificate should have just one private key (singular).

&#64;&#64; +30,2 &#64;&#64;
<span class="quote">&gt;  
&gt; +  tests_results/security/$(hostname).${NUMBER}/ssl_gtests</span >

Nit: we should use curly braces {} instead of parentheses around the |hostname| variable, right?

::: external_tests/ssl_gtest/ssl_loopback_unittest.cc
&#64;&#64; -158,5 &#64;&#64;
<span class="quote">&gt; -
&gt; -  client_-&gt;CheckVersion(SSL_LIBRARY_VERSION_TLS_1_1);
&gt; -}
&gt; -
&gt; -TEST_P(TlsConnectGeneric, ConnectTLS_1_2_Only) {</span >

Please confirm these two tests were not deleted by accident.

&#64;&#64; +176,5 &#64;&#64;
<span class="quote">&gt;  
&gt; +TEST_P(TlsConnectGeneric, ConnectEcdsa) {
&gt; +  SetupEcdsa();
&gt; +  Connect();
&gt; +  client_-&gt;CheckAuthType(ssl_auth_ecdsa);</span >

Nit: should we also call client_-&gt;CheckVersion()? See line 47 in the TlsConnectGeneric.Connect test.

::: external_tests/ssl_gtest/ssl_skip_unittest.cc
&#64;&#64; +9,5 &#64;&#64;
<span class="quote">&gt; +#include &quot;tls_parser.h&quot;
&gt; +#include &quot;tls_filter.h&quot;
&gt; +#include &quot;tls_connect.h&quot;
&gt; +
&gt; +namespace nss_test {</span >

Please add a comment to summarize what this file is testing.

&#64;&#64; +13,5 &#64;&#64;
<span class="quote">&gt; +namespace nss_test {
&gt; +
&gt; +class TlsHandshakeSkipFilter : public TlsRecordFilter {
&gt; + public:
&gt; +  TlsHandshakeSkipFilter(uint8_t handshake_type)</span >

Nit: please document that |handshake_type| specifies the handshake message to skip.

&#64;&#64; +16,5 &#64;&#64;
<span class="quote">&gt; + public:
&gt; +  TlsHandshakeSkipFilter(uint8_t handshake_type)
&gt; +      : handshake_type_(handshake_type),
&gt; +        changed_(false) {}
&gt; + protected:</span >

Nit: add a blank line before &quot;protected:&quot;.

&#64;&#64; +17,5 &#64;&#64;
<span class="quote">&gt; +  TlsHandshakeSkipFilter(uint8_t handshake_type)
&gt; +      : handshake_type_(handshake_type),
&gt; +        changed_(false) {}
&gt; + protected:
&gt; +  virtual bool FilterRecord(uint8_t content_type, uint16_t version,</span >

Nit: please document what this method does.

&#64;&#64; +55,5 &#64;&#64;
<span class="quote">&gt; +        output_offset += entire_length;
&gt; +      } else {
&gt; +        std::cerr &lt;&lt; &quot;Dropping handshake: &quot;
&gt; +                  &lt;&lt; static_cast&lt;unsigned&gt;(handshake_type_) &lt;&lt; std::endl;
&gt; +        changed_ = true;</span >

IMPORTANT: it is strange that we set |changed_| to true if handshake_type == handshake_type_. I would expect &quot;changed&quot; to mean handshake_type != handshake_type_. This is worth a comment.

&#64;&#64; +64,5 &#64;&#64;
<span class="quote">&gt; +  }
&gt; +
&gt; + private:
&gt; +  uint8_t handshake_type_;
&gt; +  bool changed_;</span >

Please document |changed_|.

Does it need to be a member variable? Can it be a local variable in the FilterRecord() method?

&#64;&#64; +84,5 &#64;&#64;
<span class="quote">&gt; +      server_-&gt;SetPacketFilter(filter);
&gt; +    }
&gt; +    ConnectExpectFail();
&gt; +    ASSERT_EQ(kTlsAlertFatal, alert_recorder-&gt;level());
&gt; +    ASSERT_EQ(alert, alert_recorder-&gt;description());</span >

Nit: use EXPECT_EQs.

&#64;&#64; +122,5 &#64;&#64;
<span class="quote">&gt; +TEST_P(TlsSkipTest, SkipCertAndKeyExch) {
&gt; +  auto chain = new ChainedPacketFilter();
&gt; +  chain-&gt;Add(new TlsHandshakeSkipFilter(kTlsHandshakeCertificate));
&gt; +  chain-&gt;Add(new TlsHandshakeSkipFilter(kTlsHandshakeServerKeyExchange));
&gt; +  ServerSkipTest(chain);</span >

Interesting ... is it easy to verify both handshake messages are skipped? Because just skipping ServerKeyExchange will also result in SSL_ERROR_RX_UNEXPECTED_HELLO_DONE.

It seems that this will require us to record the handshake wait state at the time the handshake fails.

::: external_tests/ssl_gtest/tls_agent.cc
&#64;&#64; +78,5 &#64;&#64;
<span class="quote">&gt;    ASSERT_EQ(SECSuccess, rv);
&gt;    SetState(CONNECTING);
&gt;  }
&gt;  
&gt;  void TlsAgent::EnableSomeECDHECiphers() {</span >

Nit: in your naming convention, ECDHE should be spelled &quot;Ecdhe&quot;.

&#64;&#64; +125,5 &#64;&#64;
<span class="quote">&gt;  }
&gt;  
&gt; +void TlsAgent::CheckAuthType(SSLAuthType type) const {
&gt; +  ASSERT_EQ(CONNECTED, state_);
&gt; +  ASSERT_EQ(type, csinfo_.authAlgorithm);</span >

Nit: EXPECT_EQ is more appropriate than ASSERT_EQ here.
You don't need to change this now, but we probably should
make a pass through this file in the future to change
some of these ASSERT_EQs to EXPECT_EQs.

EXPECT_EQ will not abort the test if it fails. It is
more appropriate when you are interested in seeing how
badly the code is broken. ASSERT_EQ is appropriate if
it is meaningless for the test to go on when the check
fails, for example, if the rest of the test would deference
a null pointer or access array elements outside the
array bounds.

::: external_tests/ssl_gtest/tls_agent.h
&#64;&#64; +40,5 &#64;&#64;
<span class="quote">&gt;          pr_fd_(nullptr),
&gt;          adapter_(nullptr),
&gt;          ssl_fd_(nullptr),
&gt;          role_(role),
&gt;          state_(INIT) {</span >

IMPORTANT: The constructor should initialize the new error_code_ member.

::: external_tests/ssl_gtest/tls_connect.cc
&#64;&#64; +106,5 &#64;&#64;
<span class="quote">&gt;    Init();
&gt;  }
&gt;  
&gt; +void TlsConnectTestBase::SetupEcdsa() {
&gt; +  Reset(&quot;ecdsa&quot;, kt_ecdh);</span >

Nit: based on the source code in sslt.h:
<a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/ssl/sslt.h#36">http://mxr.mozilla.org/nss/source/lib/ssl/sslt.h#36</a>

we should use ssl_kea_ecdh instead of kt_ecdh, and similarly ssl_kea_rsa instead of kt_rsa. The kt_xxx symbols are now macros defined for backward compatibility.

::: external_tests/ssl_gtest/tls_connect.h
&#64;&#64; +40,5 &#64;&#64;
<span class="quote">&gt;    // Initialize client and server.
&gt;    void Init();
&gt;    // Re-initialize client and server.
&gt; +  void Reset(const std::string&amp; server_name = &quot;server&quot;,
&gt; +             SSLKEAType kea = kt_rsa);</span >

Nit: I know we don't need to follow the Google C++ Style Guide, but that style guide forbids default arguments. It would be nice to avoid them unless we disagree with the rationale.

&#64;&#64; +51,5 &#64;&#64;
<span class="quote">&gt;    void Connect();
&gt;    // Connect and expect it to fail.
&gt;    void ConnectExpectFail();
&gt;  
&gt; +  // Setup to use ECDSA on the server and some ECDSA suites.</span >

Nit: use ECDSA =&gt; use an ECDSA certificate ?

ECDSA suites =&gt; ECDHE suites ?

::: external_tests/ssl_gtest/tls_filter.h
&#64;&#64; +44,5 &#64;&#64;
<span class="quote">&gt;    TlsHandshakeFilter() {}
&gt;  
&gt; +  // Reads the length from the record header.
&gt; +  // This also reads the DTLS fragment information and checks it.
&gt; +  static bool ReadLength(TlsParser&amp; parser, uint16_t version, uint32_t *length);</span >

Nit: should |parser| be a const reference?

In Google's Style Guide, if the function needs to modify |parser|, |parser| should be declared as a pointer.

::: external_tests/ssl_gtest/tls_parser.h
&#64;&#64; +31,5 &#64;&#64;
<span class="quote">&gt;  const uint8_t kTlsAlertHandshakeFailure = 0x28;
&gt;  const uint8_t kTlsAlertIllegalParameter = 0x2f;
&gt;  const uint8_t kTlsAlertDecodeError = 0x32;
&gt;  const uint8_t kTlsAlertUnsupportedExtension = 0x6e;
&gt;  const uint8_t kTlsAlertNoApplicationProtocol = 0x78;</span >

Nit: since both TLS 1.2 and IANA (<a rel="nofollow" href="http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-6">http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-6</a>) specify the alert message codes in decimal, I think decimal is better than hexadecimal here.

::: tests/cert/cert.sh
&#64;&#64; +970,5 &#64;&#64;
<span class="quote">&gt; +n
&gt; +CERTSCRIPT
&gt; +  if [ &quot;$RET&quot; -ne 0 ]; then
&gt; +     echo &quot;return value is $RET&quot;
&gt; +     Exit 6 &quot;Fatal - failed to create server cert for ssl_gtests&quot;</span >

Nit: server cert =&gt; rsa server cert

&#64;&#64; +985,5 &#64;&#64;
<span class="quote">&gt;  CERTSCRIPT
&gt;  
&gt;    if [ &quot;$RET&quot; -ne 0 ]; then
&gt;       echo &quot;return value is $RET&quot;
&gt; +     Exit 6 &quot;Fatal - failed to create ecdsa cert for ssl_gtests&quot;</span >

Nit: ecdsa cert =&gt; ecdsa server cert</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588199&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8588199</a> -
        Flags: review+</div></div></div><div class="change-set" id="c61"><div class="comment" data-id="10142828" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 12:11 PDT" data-time="1428693103">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="10142828">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c60">comment #60</a>)
<span class="quote">&gt; ::: external_tests/ssl_gtest/ssl_loopback_unittest.cc
&gt; &gt; -TEST_P(TlsConnectGeneric, ConnectTLS_1_2_Only) {
&gt; 
&gt; Please confirm these two tests were not deleted by accident.</span >

Yes, this is intentional.  These replicate TEST_P(TlsConnectGeneric, Connect)

<span class="quote">&gt; &gt; +        std::cerr &lt;&lt; &quot;Dropping handshake: &quot;
&gt; &gt; +                  &lt;&lt; static_cast&lt;unsigned&gt;(handshake_type_) &lt;&lt; std::endl;
&gt; &gt; +        changed_ = true;
&gt; 
&gt; IMPORTANT: it is strange that we set |changed_| to true if handshake_type ==
&gt; handshake_type_. I would expect &quot;changed&quot; to mean handshake_type !=
&gt; handshake_type_. This is worth a comment.</span >

Done.  Note that if we don't find handshake_type_ we don't change the record at all.

<span class="quote">&gt; Does it need to be a member variable? Can it be a local variable in the
&gt; FilterRecord() method?</span >

I've added a comment explaining why.  You have to track this state across invocations (the filter is called multiple times).  You have to know if a message is dropped so that the DTLS sequence number can be adjusted.

<span class="quote">&gt; &#64;&#64; +122,5 &#64;&#64;
&gt; &gt; +TEST_P(TlsSkipTest, SkipCertAndKeyExch) {
&gt; &gt; +  auto chain = new ChainedPacketFilter();
&gt; &gt; +  chain-&gt;Add(new TlsHandshakeSkipFilter(kTlsHandshakeCertificate));
&gt; &gt; +  chain-&gt;Add(new TlsHandshakeSkipFilter(kTlsHandshakeServerKeyExchange));
&gt; &gt; +  ServerSkipTest(chain);
&gt; 
&gt; Interesting ... is it easy to verify both handshake messages are skipped?
&gt; Because just skipping ServerKeyExchange will also result in
&gt; SSL_ERROR_RX_UNEXPECTED_HELLO_DONE.</span >
&gt;
<span class="quote">&gt; It seems that this will require us to record the handshake wait state at the
&gt; time the handshake fails.</span >

Yeah, I don't see much value in creating the API to expose that.  Maybe if this were new code, I'd design for test a little more, but this is NSS.

<span class="quote">&gt; Nit: EXPECT_EQ is more appropriate than ASSERT_EQ here.
&gt; You don't need to change this now, but we probably should
&gt; make a pass through this file in the future to change
&gt; some of these ASSERT_EQs to EXPECT_EQs.
&gt; 
&gt; EXPECT_EQ will not abort the test if it fails. It is
&gt; more appropriate when you are interested in seeing how
&gt; badly the code is broken. ASSERT_EQ is appropriate if
&gt; it is meaningless for the test to go on when the check
&gt; fails, for example, if the rest of the test would deference
&gt; a null pointer or access array elements outside the
&gt; array bounds.</span >

I didn't really know - I was largely copying what was already there.  I did a quick pass through and changed them all.  It's only the point at which we can't connect that we have a problem.

<span class="quote">&gt; IMPORTANT: The constructor should initialize the new error_code_ member.</span >

Thanks.

<span class="quote">&gt; In Google's Style Guide, if the function needs to modify |parser|, |parser|
&gt; should be declared as a pointer.</span >

Ahh, Google Style.  Trying really hard to make C++ less bad.  That's a lost cause.</pre></div><div class="change-set" id="c62"><div class="comment" data-id="10143065" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 12:58 PDT" data-time="1428695929">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8591024"
         class="attachment patch"
         data-id="8591024" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-1.patch">
      <meta itemprop="contentSize" content="15892">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8591024">
          <a class="link" href="attachment.cgi?id=8591024&amp;action=diff">
        <span id="att-8591024-description" itemprop="description">bug1086145-1.patch</span></a>
        — <a href="attachment.cgi?id=8591024&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8591024">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-62" data-comment-id="10143065">r=wtc, just uploading what I plan to land.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8589306&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8589306</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8591024&amp;action=edit"
           title="bug1086145-1.patch"
           class=""
        >Attachment #8591024</a> -
        Flags: review+</div></div></div><div class="change-set" id="c63"><div class="comment" data-id="10143067" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 12:59 PDT" data-time="1428695952">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8591025"
         class="attachment patch obsolete"
         data-id="8591025" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-2.patch">
      <meta itemprop="contentSize" content="44441">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8591025">
          <a class="link" href="attachment.cgi?id=8591025&amp;action=diff">
        <span id="att-8591025-description" itemprop="description">bug1086145-2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8591025&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8591025">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-63" data-comment-id="10143067">r=wtc</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588199&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8588199</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8588199&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8588199</a> -
        Flags: <span class="activity-deleted">review?(ekr)</span></div><div class="change">
        <a href="/attachment.cgi?id=8591025&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8591025</a> -
        Flags: review+</div></div></div><div class="change-set" id="c64"><div class="comment" data-id="10143448" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a14224223_438654"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 14:22 PDT" data-time="1428700976">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="10143448">This is clearly not fixed in 3.17.3</pre><div class="activity"><div class="change">Target Milestone: 3.17.3 &rarr; ---</div></div></div><div class="change-set" id="c65"><div class="comment" data-id="10143474" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14224223_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14224223_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 14:27 PDT" data-time="1428701224">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="10143474">Note: this was published some time ago:

<a rel="nofollow" href="https://www.smacktls.com/smack.pdf">https://www.smacktls.com/smack.pdf</a></pre></div><div class="change-set" id="a14825734_1689"><div class="change" id="aa14825734_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a14825734_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14825734_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14825734_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a14825734_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 14:44 PDT" data-time="1428702267">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">URL: <a href="https://www.smacktls.com/smack.pdf" target="_blank" rel="noreferrer"
           class="bug-url" data-safe="1"
        >https://www.smacktls.com/smack.pdf</a></div></div></div><div class="change-set" id="c66"><div class="comment" data-id="10143799" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14825734_1689"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 15:41 PDT" data-time="1428705719">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="10143799">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8591025" name="attach_8591025" title="bug1086145-2.patch">attachment 8591025</a> <a href="/attachment.cgi?id=8591025&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8591025&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8591025'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8591025" name="attach_8591025" title="bug1086145-2.patch">attachment 8591025</a> <a href="/attachment.cgi?id=8591025&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8591025&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8591025'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I suggest two small changes.

::: external_tests/ssl_gtest/ssl_skip_unittest.cc
&#64;&#64; +65,5 &#64;&#64;
<span class="quote">&gt; +        output_offset += entire_length;
&gt; +      } else {
&gt; +        std::cerr &lt;&lt; &quot;Dropping handshake: &quot;
&gt; +                  &lt;&lt; static_cast&lt;unsigned&gt;(handshake_type_) &lt;&lt; std::endl;
&gt; +        // We only need to report a that the output contains changed data if we</span >

Nit: report a that =&gt; report that

::: external_tests/ssl_gtest/tls_connect.h
&#64;&#64; +40,5 &#64;&#64;
<span class="quote">&gt;    // Initialize client and server.
&gt;    void Init();
&gt;    // Re-initialize client and server.
&gt; +  void Reset(const std::string&amp; server_name, SSLKEAType kea);
&gt; +  void Reset(); // With the RSA server certificate.</span >

Nit: the Google Style Guide also recommends against this kind of method overloading. Please revert to using default arguments until the NSS team decides which style guide we should follow in the C++ code. Sorry about this.</pre></div><div class="change-set" id="c67"><div class="comment" data-id="10143882" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14825734_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 16:07 PDT" data-time="1428707272">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8591135"
         class="attachment patch"
         data-id="8591135" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1086145-2.patch">
      <meta itemprop="contentSize" content="47705">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8591135">
          <a class="link" href="attachment.cgi?id=8591135&amp;action=diff">
        <span id="att-8591135-description" itemprop="description">bug1086145-2.patch</span></a>
        — <a href="attachment.cgi?id=8591135&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086145&attachment=8591135">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-67" data-comment-id="10143882">I made some bigger changes that I hope you will approve of.  SetupEcdsa is now ResetEcdsa() and ResetRsa() replaces Reset().  Now Reset() is private and there is less chance now that mismatched arguments can be passed to it.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8591025&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8591025</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8591135&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8591135</a> -
        Flags: review+</div></div></div><div class="change-set" id="c68"><div class="comment" data-id="10143944" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a14825734_1689"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-10 16:25 PDT" data-time="1428708353">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="10143944">Comment on <span class=""><a href="/attachment.cgi?id=8591135" name="attach_8591135" title="bug1086145-2.patch">attachment 8591135</a> <a href="/attachment.cgi?id=8591135&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8591135&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8591135'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">bug1086145</a>-2.patch

Review of <span class=""><a href="/attachment.cgi?id=8591135" name="attach_8591135" title="bug1086145-2.patch">attachment 8591135</a> <a href="/attachment.cgi?id=8591135&amp;action=edit" title="bug1086145-2.patch">[details]</a> <a href="/attachment.cgi?id=8591135&amp;action=diff" title="bug1086145-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086145&amp;attachment=8591135'>[review]</a>:
-----------------------------------------------------------------

r=wtc. Thanks.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8591135&amp;action=edit"
           title="bug1086145-2.patch"
           class=""
        >Attachment #8591135</a> -
        Flags: review+</div></div></div><div class="change-set" id="c69"><div class="comment" data-id="10164246" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14825734_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-16 10:13 PDT" data-time="1429204411">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-69" data-comment-id="10164246">Reminder to Ryan to check with Chrome release managers about the timing of this landing.</pre><div class="activity"><div class="change">Flags: needinfo?(ryan.sleevi)</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="10164277" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14825734_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-16 10:19 PDT" data-time="1429204771">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="10164277">Discussed on the NSS call.  NSS release 3.19 (Beta in a few days).  Firefox release 39 (June 30).  Chrome release 43/44 (Ryan to provide information).</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rlb)</span></div></div></div><div class="change-set" id="c71"><div class="comment" data-id="10164682" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14825734_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-16 11:38 PDT" data-time="1429209519">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="10164682"><a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/6b4770c76bc8">https://hg.mozilla.org/projects/nss/rev/6b4770c76bc8</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/1865635f5df5">https://hg.mozilla.org/projects/nss/rev/1865635f5df5</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2015-04-16 11:38 PDT" data-time="1429209519">7 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; 3.19</div></div></div><div class="change-set" id="c72"><div class="comment" data-id="10165524" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a14825734_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-16 14:20 PDT" data-time="1429219211">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="10165524">[Tracking Requested - why for this release]: Support for ESR31 is dropped when Fx40 ships, so this needs 39+ tracking status AFAICT?</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=isnotempty">status-b2g-v2.1S</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=isnotempty">status-firefox37</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=isnotempty">status-firefox38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=-">-</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=%3F">?</a></div></div></div><div class="change-set" id="c73"><div class="comment" data-id="10167254" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a14825734_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-17 02:19 PDT" data-time="1429262387">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="10167254">(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c72">comment #72</a>)
<span class="quote">&gt; [Tracking Requested - why for this release]: Support for ESR31 is dropped
&gt; when Fx40 ships, so this needs 39+ tracking status AFAICT?</span >

38 is the next ESR</pre></div><div class="change-set" id="c74"><div class="comment" data-id="10169990" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a14825734_1689"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-17 13:04 PDT" data-time="1429301083">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="10169990">and ESR31 and ESR38 overlap for two releases.</pre></div><div class="change-set" id="c75"><div class="comment" data-id="10171150" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a14825734_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-17 18:03 PDT" data-time="1429319036">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-75" data-comment-id="10171150">For reference, here's a summary of current NSS versions across supported release branches. Not sure if we want to update to 3.19 across the board or create some combination of point releases.

esr38: NSS_3_18_RTM
b2g37: NSS_3_17_4_RTM
b2g34: NSS_3_17_2_RTM
b2g32: NSS_3_17_2_RTM
b2g30: NSS_3_16_2_3_RTM
esr31: NSS_3_16_2_3_RTM</pre></div><div class="change-set" id="c76"><div class="comment" data-id="10171159" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a14825734_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a14825734_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-17 18:10 PDT" data-time="1429319408">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="10171159">(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c75">comment #75</a>)
<span class="quote">&gt; For reference, here's a summary of current NSS versions across supported
&gt; release branches. Not sure if we want to update to 3.19 across the board or
&gt; create some combination of point releases.</span >

There are other changes in 3.19 that will need some soak time before we can be confident that they are safe to take.  Once that resolves, this can be opened.  There is also another bug under embargo with a prepared patch that could land in 3.19 in the near future (though a backport is still a possibility).</pre></div><div class="change-set" id="a15867233_1584"><div class="change" id="aa15867233_1584">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a15867233_1584"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1584" id="a15867233_1584"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15867233_1584"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15867233_1584">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a15867233_1584">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-22 16:02 PDT" data-time="1429743766">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c77"><div class="comment" data-id="10259908" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a15867233_1584"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a15867233_1584"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-12 11:11 PDT" data-time="1431454269">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="10259908">Martin, any thoughts for how we want to handle backporting this fix to older branches? See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c75">comment 75</a> for the various NSS versions currently in use across our supported releases.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=isnotempty">status-b2g-v1.4</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=isnotempty">status-b2g-master</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox38_0_5&amp;o1=isnotempty">status-firefox38.0.5</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox38_0_5&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: needinfo?(martin.thomson)</div></div></div><div class="change-set" id="a17577800_75935"><div class="change" id="aa17577800_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a17577800_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a17577800_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a17577800_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a17577800_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a17577800_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-12 11:12 PDT" data-time="1431454333">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=isnotempty">status-firefox39</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c78"><div class="comment" data-id="10260270" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a17577800_75935"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a17577800_75935"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-12 12:23 PDT" data-time="1431458588">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-78" data-comment-id="10260270">We might suggest that we simply upgrade those older releases to a newer version of NSS.  3.18 has proven to be quite stable so far, so the risk might be acceptable.  3.19 might be a little too new.

The tests are the problem for back ports.  We might be able to just land the code without the tests.

I'll bring it up on the NSS call this week and get back to you with an answer.</pre></div><div class="change-set" id="c79"><div class="comment" data-id="10275268" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a17577800_75935"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a17577800_75935"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-15 16:00 PDT" data-time="1431730832">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-79" data-comment-id="10275268">My proposed plan is to take 3.19 all the way back.  <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">Bug 1138554</a> is coming on Monday and that will need to be ported too.  3.19 went RTM on April 30, and has been in Firefox since well before then.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.thomson)</span></div></div></div><div class="change-set" id="a18102288_438654"><div class="change" id="aa18102288_438654">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a18102288_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_438654" id="a18102288_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18102288_438654"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18102288_438654">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a18102288_438654">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-18 12:53 PDT" data-time="1431978821">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update to NSS 3.19.1"
   href="/show_bug.cgi?id=1166031">1166031</a></div></div></div><div class="change-set" id="c80"><div class="comment" data-id="10281624" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a18102288_438654"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a18102288_438654"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-18 13:42 PDT" data-time="1431981736">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-80" data-comment-id="10281624">What is 1166031?</pre></div><div class="change-set" id="c81"><div class="comment" data-id="10312492" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a18102288_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a18102288_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-26 15:27 PDT" data-time="1432679260">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-81" data-comment-id="10312492">Cancelling this.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ryan.sleevi)</span></div></div></div><div class="change-set" id="c82"><div class="comment" data-id="10312503" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a18102288_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a18102288_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-26 15:30 PDT" data-time="1432679424">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-82" data-comment-id="10312503">:dveditz, can we mark this public?  It's in m-c, aurora, and soon beta.</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a18897993_1689"><div class="change" id="aa18897993_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a18897993_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a18897993_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18897993_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18897993_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a18897993_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-27 17:55 PDT" data-time="1432774526">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=39%2B">39+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=39%2B">39+</a></div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c83"><div class="comment" data-id="10318471" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a18897993_1689"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a18897993_1689"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-27 18:11 PDT" data-time="1432775472">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="10318471">Note that NSS 3.19 only landed in Chrome today, and is not part of any of our Dev or Beta channels.

Opening this bug was a non-issue because the attack itself was described in the SMACK-TLS preprint (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c65">Comment #65</a>), and NSS 3.19 was announced.

Few follow-up questions:
- Was there a CVE attached to this, dveditz? <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c26">Comment 26</a> suggested it was only OpenSSL that got a CVE
- NSS 3.19 release notes didn't flag this as a security issue [other than this was hidden], except the SMACK-TLS paper describes how this could cause issues for cookie disclosure + false start (wouldn't that be a High-Severity issue? It is using Chrome's severity ranking)</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a19129746_75935"><div class="change" id="aa19129746_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a19129746_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a19129746_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a19129746_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a19129746_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a19129746_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-30 10:17 PDT" data-time="1433006279">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=isnotempty">status-b2g-v2.1S</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c84"><div class="comment" data-id="10332229" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a19129746_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a19129746_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-01 10:37 PDT" data-time="1433180276">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-84" data-comment-id="10332229">Good questions, Ryan, thanks.

I should have made it clear when I opened the bug that I was doing so because the attack and paper were already public, not simply because the patch had landed (as implied by the request in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c82">comment 82</a>).

You're right that the NSS implementation requires a separate CVE. We'll use <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2721">CVE-2015-2721</a>

<span class="quote">&gt; - NSS 3.19 release notes didn't flag this as a security issue [other than
&gt; this was hidden], except the SMACK-TLS paper describes how this could cause
&gt; issues for cookie disclosure + false start (wouldn't that be a High-Severity
&gt; issue? It is using Chrome's severity ranking)</span >

I don't do the NSS release notes so I can't help you there, but this bug is rated &quot;sec-high&quot; and will definitely get a Firefox security advisory.</pre><div class="activity"><div class="change">Alias: CVE-2015-2721</div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c85"><div class="comment" data-id="10332301" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a19129746_75935"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a19129746_75935"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-01 10:52 PDT" data-time="1433181140">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-85" data-comment-id="10332301">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c83">comment #83</a>)
<span class="quote">&gt; - NSS 3.19 release notes didn't flag this as a security issue [other than
&gt; this was hidden], except the SMACK-TLS paper describes how this could cause
&gt; issues for cookie disclosure + false start (wouldn't that be a High-Severity
&gt; issue? It is using Chrome's severity ranking)</span >

The actual exploit here isn't that interesting.  The paper talks it up more than it deserves.  At best, a break in authentication can be turned into a break of the key exchange.  In retrospect, I'd downgrade this to sec-moderate.</pre></div><div class="change-set" id="c86"><div class="comment" data-id="10339172" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a19129746_75935"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a19129746_75935"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-02 19:15 PDT" data-time="1433297744">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-86" data-comment-id="10339172">The SMACK paper (section V-C) demonstrates that the bug disables forward secrecy for False Start data.
I hope we don't talk it up more than that!

In the past, lack of forward secrecy has been considered serious enough to disable false start altogether (see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disable TLS False Start"
   href="/show_bug.cgi?id=920248">bug 920248</a>). However, we do agree that the bug does not &quot;break&quot; the normal authentication and confidentiality guarantees of TLS, and it does require an active network attacker, and so sec-moderate would seem to be appropriate.</pre></div><div class="change-set" id="a20078722_36541"><div class="change" id="aa20078722_36541">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a20078722_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a20078722_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a20078722_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a20078722_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a20078722_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-10 09:54 PDT" data-time="1433955255">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - export-1024 ciphersuites with 1024-bit server certificates are broken"
   href="/show_bug.cgi?id=1173413">1173413</a></div></div></div><div class="change-set" id="a20872991_1689"><div class="change" id="aa20872991_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a20872991_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a20872991_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a20872991_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a20872991_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a20872991_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-19 14:32 PDT" data-time="1434749524">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="a20876931_280903"><div class="change" id="aa20876931_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a20876931_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a20876931_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a20876931_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a20876931_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a20876931_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-19 15:37 PDT" data-time="1434753464">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main39+][adv-esr38.1+][adv-esr31.8+]</div></div></div><div class="change-set" id="a22333504_465475"><div class="change" id="aa22333504_465475">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465475" id="a22333504_465475"><img src="https://secure.gravatar.com/avatar/53109391fab4917418886daa163a6b41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_465475" id="a22333504_465475"><a class="email disabled" href="/user_profile?user_id=465475" > <span class="fna">Christiane Ruetten [INACTIVE]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a22333504_465475"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a22333504_465475">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086145#a22333504_465475">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-06 12:13 PDT" data-time="1436210037">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main39+][adv-esr38.1+][adv-esr31.8+] &rarr; [adv-main39+][adv-esr38.1+][adv-esr31.8+][b2g-adv-main2.2+]</div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1086145&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>