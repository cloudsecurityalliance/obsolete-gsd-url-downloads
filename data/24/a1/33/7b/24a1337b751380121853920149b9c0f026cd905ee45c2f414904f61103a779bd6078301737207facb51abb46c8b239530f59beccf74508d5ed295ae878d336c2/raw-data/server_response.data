
IBM SECURITY ADVISORY

First Issued: Thu Jun 12 16:24:51 CDT 2014
Updated: Tue Jul  1 12:35:38 CDT 2014
Update: Corrected public key URL.
Updated: Wed Jul  2 15:20:29 CDT 2014
Update: Added published advisory OpenSSL signature file.
Updated: Thu Jul  3 07:42:49 CDT 2014
Update: Renamed tar file for TNC compliancy
|Updated: Mon Jul  7 14:26:45 CDT 2014
|Update: Corrected APAR Availability

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/ntp_advisory.asc
https://aix.software.ibm.com/aix/efixes/security/ntp_advisory.asc
ftp://aix.software.ibm.com/aix/efixes/security/ntp_advisory.asc

===============================================================================
                           VULNERABILITY SUMMARY

VULNERABILITY:   Network Time Protocol (NTP) vulnerability in AIX

PLATFORMS:       AIX 5.3, 6.1 and 7.1 releases
                 VIOS 2.2.*

SOLUTION:        Apply the fix as described below.

THREAT:          See below

CVE Numbers:     CVE-2013-5211 CVSS=5.0

Reboot required?    NO
Workarounds?        YES

===============================================================================
                           DETAILED INFORMATION

I. DESCRIPTION 
   
    The monlist feature in ntpd in NTP allows remote attackers to
    cause a denial of service (traffic amplification) via forged
    (1) REQ_MON_GETLIST or (2) REQ_MON_GETLIST_1 requests.

II. CVSS

    CVSS Base Score: 5.0
    CVSS Temporal Score: See http://xforce.iss.net/xforce/xfdb/90143 for the current score
    CVSS Environmental Score*: Undefined
    CVSS String: (AV:N/AC:L/Au:N/C:N/I:N/A:P)

III. PLATFORM VULNERABILITY ASSESSMENT

    The following fileset levels are vulnerable:

    NTPv3:

    AIX Fileset         Lower Level  Upper Level   KEY
    -------------------------------------------------------
    bos.net.tcp.client  5.3.12.0     5.3.12.10     key_w_fs
    bos.net.tcp.client  6.1.7.0      6.1.7.20      key_w_fs
    bos.net.tcp.client  6.1.8.0      6.1.8.17      key_w_fs
    bos.net.tcp.client  6.1.9.0      6.1.9.1       key_w_fs 
    bos.net.tcp.client  7.1.1.0      7.1.1.20      key_w_fs
    bos.net.tcp.client  7.1.2.0      7.1.2.17      key_w_fs
    bos.net.tcp.client  7.1.3.0      7.1.3.2       key_w_fs

    AIX Fileset (VIOS)  Lower Level         Upper Level
    ---------------------------------------------------------
    bos.net.tcp.client  6.1.7.0(2.2.1.0)    6.1.7.20(2.2.1.8)
    bos.net.tcp.client  6.1.8.0(2.2.2.0)    6.1.8.17(2.2.2.4)
    bos.net.tcp.client  6.1.9.0(2.2.3.0)    6.1.9.1 (2.2.3.2)

    NTPv4:

    AIX Fileset         Lower Level   Upper Level   KEY
    --------------------------------------------------------
    ntp.rte             6.1.6.0       6.1.6.1       key_w_fs
    ntp.rte             7.1.0.0       7.1.0.1       key_w_fs

    AIX Fileset (VIOS)  Lower Level         Upper Level
    --------------------------------------------------------
    ntp.rte             6.1.6.0(2.2.1.0)    6.1.6.1(2.2.1.8)
    ntp.rte             6.1.6.0(2.2.2.0)    6.1.6.1(2.2.2.4)
    ntp.rte             6.1.6.0(2.2.3.0)    6.1.6.1(2.2.3.2)

    NOTE: To find out whether the affected filesets are installed on your
    systems, refer to the lslpp command found in AIX user's guide.

IV. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to the problem:

        NOTE: APARs are only applicable to NTPv3. For NTPv4 refer to steps mentioned
        in FIXES section under NTPv4 heading below.

        AIX Level        APAR number     Availability      KEY
        -------------------------------------------------------------
|       5.3.12           IV59636         NOW (ifix-only)   key_w_apar
|       6.1.8            IV58068         12/31/2014 SP6    key_w_apar
|       6.1.9            IV56213         10/24/2014 SP4    key_w_apar
|       7.1.2            IV55365         12/31/2014 SP6    key_w_apar
|       7.1.3            IV56324         10/24/2014 SP4    key_w_apar

        VIOS Level       APAR number     Availability
        ---------------------------------------------------
|       2.2.2            IV58068         12/31/2014 2.2.2.5
|       2.2.3            IV56213         10/24/2014 2.2.3.4

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IV59636
        http://www.ibm.com/support/docview.wss?uid=isg1IV58068
        http://www.ibm.com/support/docview.wss?uid=isg1IV56213
        http://www.ibm.com/support/docview.wss?uid=isg1IV55365
        http://www.ibm.com/support/docview.wss?uid=isg1IV56324

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        NTPv3 (Network Time Protocol Version 3)
        =======================================

        Fixes for NTPv3 are available.  The fixes can be downloaded via ftp
        from:

        ftp://aix.software.ibm.com/aix/efixes/security/ntp_fix.tar

        The link above is to a tar file containing this signed
        advisory, fix packages, and OpenSSL signatures for each package.
        The fixes below include prerequisite checking. This will
        enforce the correct mapping between the fixes and AIX
        Technology Levels.

        AIX Level   Interim Fix (*.Z)            KEY
        --------------------------------------------------
        5.3.12.9    IV59636s9a.140423.epkg.Z     key_w_fix
        6.1.7.9     IV58413s9a.140421.epkg.Z     key_w_fix
        6.1.8.4     IV58068s4a.140421.epkg.Z     key_w_fix
        6.1.9.2     IV56213s1a.140421.epkg.Z     key_w_fix
        7.1.1.9     IV56575s9a.140421.epkg.Z     key_w_fix
        7.1.2.4     IV55365s4a.140421.epkg.Z     key_w_fix
        7.1.3.2     IV56324s2a.140522.epkg.Z     key_w_fix

        VIOS Level  Interim Fix (*.Z)
        ------------------------------------
        2.2.1.8     IV58413s9a.140421.epkg.Z
        2.2.2.4     IV58068s4a.140421.epkg.Z
        2.2.3.2     IV56213s1a.140421.epkg.Z

        To extract the fixes from the tar file:
        tar xvf ntp_fix.tar 
        cd ntp_ifix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the
        "openssl dgst -sha256 file" command as the followng:

        openssl dgst -sha256                                             filename                 KEY
        ----------------------------------------------------------------------------------------------------
        ed2aa3b4f2076fd24808e20ef32ff7ee70d2c0ff39092954045ef7163b80541a IV59636s9a.140423.epkg.Z key_w_csum
        a319f02951cbb95a028f75de2548df53c8ad159383b67df5264f8c25fc202cc5 IV58413s9a.140421.epkg.Z key_w_csum
        3cdd922dae20c9ffab304badbbe6f8fd893bc057515ecc860aa5afca8867261f IV58068s4a.140421.epkg.Z key_w_csum
        014f4cf77b7c3dd0ad94191211da197c6be5b900224db1ec25f5b5bf3506f690 IV56213s1a.140421.epkg.Z key_w_csum
        4de291d684a6eec060398086637d0fe7441aaa2e84618313d4662f2ed564a879 IV56575s9a.140421.epkg.Z key_w_csum
        649feede9f57aa537b09f350cddbcc1d7a16b782a935bc7a5b4ffbd47bce7fb3 IV55365s4a.140421.epkg.Z key_w_csum
        8ec8d0ed64d21642a9d95e43545daca1d9ac910730ee351a3d01fbd5d30c8acd IV56324s2a.140522.epkg.Z key_w_csum

        These sums should match exactly. The OpenSSL signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security at
        security-alert@austin.ibm.com and describe the discrepancy.

        openssl dgst -sha1 -verify <pubkey_file> -signature <ifix_file>.sig <ifix_file>

        openssl dgst -sha1 -verify <pubkey_file> -signature <advisory_file>.sig <advisory_file>

        Published advisory OpenSSL signature file location:
 
        http://aix.software.ibm.com/aix/efixes/security/ntp_advisory.asc.sig
        https://aix.software.ibm.com/aix/efixes/security/ntp_advisory.asc.sig
        ftp://aix.software.ibm.com/aix/efixes/security/ntp_advisory.asc.sig


        NTPv4 (Network Time Protocol Version 4)
        =======================================

        A fix is available, and it can be downloaded from:

        https://www14.software.ibm.com/webapp/iwm/web/reg/download.do?source=aixbp&lang=en_US&S_PKG=NTPv4&cp=UTF-8

    C. FIX AND INTERIM FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        NTPv3 (Network Time Protocol Version 3)
        =======================================

        To preview a fix installation:

        installp -a -d fix_name -p all  # where fix_name is the name of the
                                        # fix package being previewed.
        To install a fix package:

        installp -a -d fix_name -X all  # where fix_name is the name of the
                                        # fix package being installed.

        Interim fixes have had limited functional and regression
        testing but not the full regression testing that takes place
        for Service Packs; however, IBM does fully support them.

        Interim fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview an interim fix installation:

        emgr -e ipkg_name -p         # where ipkg_name is the name of the
                                     # interim fix package being previewed.

        To install an interim fix package:

        emgr -e ipkg_name -X         # where ipkg_name is the name of the
                                     # interim fix package being installed.

        NTPv4 (Network Time Protocol Version 4) AIX 6.1
        ===============================================

        NTPv4 Install images v6.1.6.2 for AIX 6.1 ntp4-6.1.6.2.tar

    	To extract the fixes from the tar file 
    	tar -xvf ntp4-6.1.6.2.tar

        To preview the fix installation:

        cd ntp4-6.1.6.2
        installp -apYd . ntp

        To install the fix package:

        cd ntp4-6.1.6.2
        installp -aXYd . ntp
    
        For NTPv4 use on AIX 6.1, please follow steps in link 

        http://publib.boulder.ibm.com/infocenter/aix/v6r1/topic/com.ibm.aix.files/doc/aixfiles/ntp.htm?resultof=%22%6e%74%70%34%22%20

        IMPORTANT: The fix will not take affect until any running xntpd
        servers have been stopped and restarted with the following
        commands:
 
        stopsrc -s xntpd
        startsrc -s xntpd

        NTPv4 (Network Time Protocol Version 4) AIX 7.1
        ===============================================

        NTPv4 Install images v7.1.0.2 for AIX 7.1 ntp4-7.1.0.2.tar

        To extract the fixes from the tar file  
					
    	tar -xvf ntp4-7.1.0.2.tar
	
        To preview the fix installation:

        cd ntp4-7.1.0.2
        installp -apYd . ntp

        To install the fix package:

        cd ntp4-7.1.0.2
        installp -aXYd . ntp
        
        For NTPv4 use on AIX 7.1, please follow steps in link 

        http://publib.boulder.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.files/doc/aixfiles/ntp.htm?resultof=%22%6e%74%70%34%22%20

        IMPORTANT: The fix will not take affect until any running xntpd
        servers have been stopped and restarted with the following
        commands:
 
        stopsrc -s xntpd
        startsrc -s xntpd

V. WORKAROUNDS

    Use noquery in your default restrictions to block all status queries.

    Or

    Use disable monitor to disable the ntpdc -c monlist command while still 
    allowing other status queries.  

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:

        http://www.ibm.com/systems/support

    and click on the "My notifications" link.

    To view previously issued advisories, please visit:

        http://www14.software.ibm.com/webapp/set2/subscriptions/onvdq

    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com

    To obtain the OpenSSL public key that can be used to verify the
    signed advisories and ifixes:

        Download the key from our web page:

        http://www.ibm.com/systems/resources/systems_p_os_aix_security_pubkey.txt

    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:

        A. Send an email with "get key" in the subject line to:

            security-alert@austin.ibm.com

        B. Download the key from a PGP Public Key Server. The key ID is:

            0x28BFAA12

    Please contact your local IBM AIX support center for any assistance.

VII. ACKNOWLEDGMENTS:

    IBM discovered and fixed this vulnerability as part of its
    commitment to secure the AIX operating system.

VIII. REFERENCES:

    Complete CVSS Guide: http://www.first.org/cvss/cvss-guide.html
    On-line Calculator V2: http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
    X-Force Vulnerability Database: http://xforce.iss.net/xforce/xfdb/
    CVE-2013-5211: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-5211

    *The CVSS Environment Score is customer environment specific and will
    ultimately impact the Overall CVSS Score. Customers can evaluate the
    impact of this vulnerability in their environments by accessing the links
    in the Reference section of this Flash.

    Note: According to the Forum of Incident Response and Security Teams
    (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry
    open standard designed to convey vulnerability severity and help to
    determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES
    "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE
    RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY
    VULNERABILITY.
