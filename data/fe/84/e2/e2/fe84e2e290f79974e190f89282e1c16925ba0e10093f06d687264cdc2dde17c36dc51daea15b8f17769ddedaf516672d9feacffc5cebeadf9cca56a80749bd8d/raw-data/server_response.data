<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Bug 784947 – Evince's DVI exporter is susceptible to a command injection attack</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://bugzilla.gnome.org/" rel="Top"/>
<link href="showdependencytree.cgi?id=784947&amp;hide_resolved=1" rel="Show" title="Dependency Tree"/>
<link href="show_bug.cgi?format=multiple&amp;id=784947" rel="Show" title="Printer-Friendly Version"/>
<link href="skins/standard/global.css" rel="alternate stylesheet" title="Classic"/><link href="js/yui/assets/skins/sam/autocomplete.css" rel="stylesheet" type="text/css"/><link href="js/yui/assets/skins/sam/calendar.css" rel="stylesheet" type="text/css"/><link href="skins/standard/global.css" rel="stylesheet" type="text/css"/><link href="skins/standard/show_bug.css" rel="stylesheet" type="text/css"/><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css" rel="stylesheet"
        type="text/css" >
<![endif]-->
<link href="skins/contrib/Gnome/global.css" rel="stylesheet" title="Gnome" type="text/css"/>
<script src="js/yui/yahoo-dom-event/yahoo-dom-event.js" type="text/javascript"></script><script src="js/yui/cookie/cookie-min.js" type="text/javascript"></script><script src="js/yui/datasource/datasource-min.js" type="text/javascript"></script><script src="js/yui/connection/connection-min.js" type="text/javascript"></script><script src="js/yui/json/json-min.js" type="text/javascript"></script><script src="js/yui/autocomplete/autocomplete-min.js" type="text/javascript"></script><script src="js/yui/calendar/calendar-min.js" type="text/javascript"></script><script src="js/global.js" type="text/javascript"></script>
<script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 50
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 784947 – Evince\'s DVI exporter is susceptible to a command injection attack",  
                             "show_bug.cgi?id=784947" );
        document.title = "Bug 784947 – Evince\'s DVI exporter is susceptible to a command injection attack";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 784947 – Evince\'s DVI exporter is susceptible to a command injection attack", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script src="js/util.js" type="text/javascript"></script><script src="js/field.js" type="text/javascript"></script>
<link href="./search_plugin.cgi" rel="search" title="GNOME Bugzilla" type="application/opensearchdescription+xml"/>
<link href="images/favicon.ico" rel="shortcut icon"/><link href="extensions/TraceParser/web/style.css" rel="stylesheet" type="text/css"/>
</head>
<body class="bugzilla-gnome-org bz_bug bz_status_RESOLVED bz_product_evince bz_component_backends bz_bug_784947 yui-skin-sam" onload="">
<div id="header">
<div id="banner">
</div>
<table border="0" cellpadding="0" cellspacing="0" id="titles">
<tr>
<td id="title">
<p>GNOME Bugzilla – Bug 784947</p>
</td>
<td id="subtitle">
<p class="subheader">Evince's DVI exporter is susceptible to a command injection attack</p>
</td>
<td id="information">
<p class="header_addl_info">Last modified: 2017-11-27 21:24:25 UTC</p>
</td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" class="bz_default_hidden" id="lang_links_container"><tr><td>
</td></tr></table>
<ul class="links"><li><a href="./">Home</a></li></ul>
</div>
<div id="bugzilla-body">
<div style="margin-bottom: 50px; margin-top: 50px; padding: 40px; text-align: center; background-color: rgb(74,134,207); border: rgb(57,104,161); color: rgb(255,255,255); line-height: 300%;">After an <a href="https://wiki.gnome.org/Initiatives/DevelopmentInfrastructure" style="color: rgb(255,255,255);">evaluation</a>, GNOME has moved from Bugzilla to <a href="https://gitlab.gnome.org/" style="color: rgb(255,255,255);">GitLab</a>. <a href="https://wiki.gnome.org/GitLab" style="color: rgb(255,255,255);">Learn more about GitLab</a>. <br/><span style="background-color: #EE0000; font-size: xx-large;"><b>No new issues can be reported in GNOME Bugzilla anymore.</b></span>
<br/><span style="background-color: #EE0000; font-size: xx-large;"><b>To report an issue in a GNOME project, <a href="https://gitlab.gnome.org/GNOME" style="color: rgb(255,255,255);">go to GNOME GitLab</a></b>.</span><br/>Do <b>not</b> go to GNOME Gitlab for: <a href="https://sourceforge.net/p/bluefish/tickets" style="color: rgb(255,255,255);">Bluefish</a>, <a href="https://github.com/doxygen/doxygen/issues" style="color: rgb(255,255,255);">Doxygen</a>, <a href="https://bugs.gnucash.org/" style="color: rgb(255,255,255);">GnuCash</a>, <a href="https://gitlab.freedesktop.org/gstreamer/" style="color: rgb(255,255,255);">GStreamer</a>, <a href="https://github.com/afcowie/java-gnome/issues" style="color: rgb(255,255,255);">java-gnome</a>, <a href="https://github.com/ldtp/ldtp2/issues" style="color: rgb(255,255,255);">LDTP</a>, <a href="https://gitlab.freedesktop.org/NetworkManager/NetworkManager/issues" style="color: rgb(255,255,255);">NetworkManager</a>, <a href="https://github.com/tomboy-notes/tomboy/issues" style="color: rgb(255,255,255);">Tomboy</a>.</div>
<script type="text/javascript">
<!--

//-->
</script>
<form action="process_bug.cgi" id="changeform" method="post" name="changeform">
<input name="delta_ts" type="hidden" value="2017-11-27 21:24:25"/>
<input name="longdesclength" type="hidden" value="17"/>
<input name="id" type="hidden" value="784947"/>
<input name="token" type="hidden" value="1626108469-v8hSL3gYY-nA6al1HzXbj1-OBgn2TcsJMEWlkoTI7YM"/>
<div class="bz_alias_short_desc_container edit_form">
<a href="show_bug.cgi?id=784947"><b>Bug 784947</b></a> -<span class="bz_default_hidden" id="summary_alias_container"> 
        (<span id="alias_nonedit_display">CVE-2017-1000159</span>) 
      <span id="short_desc_nonedit_display">Evince's DVI exporter is susceptible to a command injection attack</span>
</span>
<div id="summary_alias_input">
<table id="summary">
<tr>
<td colspan="2">(CVE-2017-1000159)
          </td>
</tr>
<tr><th class="field_label" id="field_label_short_desc">
<label accesskey="s" for="short_desc">
<a class="field_help_link" href="page.cgi?id=fields.html#short_desc" title="The bug summary is a short sentence which succinctly describes what the bug is about.">Summary:</a>
</label>
</th>
<td>Evince's DVI exporter is susceptible to a command injection attack
          </td>
</tr>
</table>
</div>
</div>
<script type="text/javascript">
    hideAliasAndSummary('Evince\'s DVI exporter is susceptible to a command injection attack', 'CVE-2017-1000159');
  </script>
<table class="edit_form">
<tr>
<td class="bz_show_bug_column" id="bz_show_bug_column_1">
<table>
<tr>
<th class="field_label">
<a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
<td id="bz_field_status">
<span id="static_bug_status">RESOLVED
          FIXED
      </span>
</td>
</tr>
<tr>
<td class="bz_section_spacer" colspan="2"></td>
</tr>
<tr><th class="field_label" id="field_label_product">
<a class="field_help_link" href="describecomponents.cgi" title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list.">Product:</a>
</th>
<td class="field_value" id="field_container_product">evince</td>
</tr>
<tr class="bz_default_hidden"><th class="field_label" id="field_label_classification">
<a class="field_help_link" href="page.cgi?id=fields.html#classification" title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.">Classification:</a>
</th>
<td class="field_value" id="field_container_classification">Core</td>
</tr>
<tr><th class="field_label" id="field_label_component">
<a class="field_help_link" href="describecomponents.cgi?product=evince" title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.">Component:</a>
</th>
<td class="field_value" id="field_container_component">backends</td>
</tr>
<tr><th class="field_label" id="field_label_version">
<label for="version">
<a class="field_help_link" href="page.cgi?id=fields.html#version" title="The version field defines the version of the software the bug was found in.">Version:</a>
</label>
</th>
<td>git master
  </td>
</tr>
<tr><th class="field_label" id="field_label_rep_platform">
<label accesskey="h" for="rep_platform">
<a class="field_help_link" href="page.cgi?id=fields.html#rep_platform" title='The hardware platform the bug was observed on. Note: When searching, selecting the option "All" only finds bugs whose value for this field is literally the word "All".'>Hardware:</a>
</label>
</th>
<td class="field_value">Other
       Linux
      </td>
</tr>
<tr>
<td class="bz_section_spacer" colspan="2"></td>
</tr>
<tr>
<th class="field_label">
<label accesskey="i" for="priority">
<a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
<td>Normal
       normal
      </td>
</tr>
<tr>
<th class="field_label">
<label for="target_milestone">
<a href="page.cgi?id=fields.html#target_milestone">
            Target Milestone</a></label>:
        </th><td>---
  </td>
</tr>
<tr>
<th class="field_label">
<a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
<td><span class="vcard"><span class="fn">Evince Maintainers</span>
</span>
</td>
</tr>
<tr><th class="field_label" id="field_label_qa_contact">
<label accesskey="q" for="qa_contact">
<a class="field_help_link" href="page.cgi?id=fields.html#qa_contact" title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.">QA Contact:</a>
</label>
</th>
<td><span class="vcard"><span class="fn">Evince Maintainers</span>
</span>
</td>
</tr>
<script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'evince-maint\x40gnome.bugs',
        'evince-maint\x40gnome.bugs');
    </script>
<tr>
<td class="bz_section_spacer" colspan="2"></td>
</tr>
<tr><th class="field_label" id="field_label_bug_file_loc">
<label accesskey="u" for="bug_file_loc">
<a class="field_help_link" href="page.cgi?id=fields.html#bug_file_loc" title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.">URL:</a>
</label>
</th>
<td>
<span id="bz_url_input_area">
</span>
</td>
</tr>
<tr><th class="field_label" id="field_label_status_whiteboard">
<label accesskey="w" for="status_whiteboard">
<a class="field_help_link" href="page.cgi?id=fields.html#status_whiteboard" title="Each bug has a free-form single line text entry box for adding tags and status information.">Whiteboard:</a>
</label>
</th><td colspan="2">CVE-2017-1000159  
  </td>
</tr>

<tr>
<td class="bz_section_spacer" colspan="2"></td>
</tr>
<tr><th class="field_label" id="field_label_dependson">
<a class="field_help_link" href="page.cgi?id=fields.html#dependson" title="The bugs listed here must be resolved before this bug can be resolved.">Depends on:</a>
</th>
<td>
<span id="dependson_input_area">
</span>
</td>
</tr>
<tr><th class="field_label" id="field_label_blocked">
<a class="field_help_link" href="page.cgi?id=fields.html#blocked" title="This bug must be resolved before the bugs listed in this field can be resolved.">Blocks:</a>
</th>
<td>
<span id="blocked_input_area">
</span>
</td>
</tr>
<tr>
<th> </th>

</tr>
</table>
</td>
<td>
<div class="bz_column_spacer"> </div>
</td>
<td class="bz_show_bug_column" id="bz_show_bug_column_2">
<table cellpadding="3" cellspacing="1">
<tr>
<th class="field_label">
      Reported:
    </th>
<td>2017-07-14 10:55 UTC by <span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</td>
</tr>
<tr>
<th class="field_label">
      Modified:
    </th>
<td>2017-11-27 21:24 UTC 
    </td>
</tr>

<tr>
<td class="bz_section_spacer" colspan="2"></td>
</tr>
<tr><th class="field_label" id="field_label_see_also">
<a class="field_help_link" href="page.cgi?id=fields.html#see_also" title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.">See Also:</a>
</th>
<td class="field_value" id="field_container_see_also"></td>
</tr>
<tr><th class="field_label" id="field_label_cf_gnome_target">
<a class="field_help_link" href="page.cgi?id=fields.html#cf_gnome_target" title="A custom Drop Down field in this installation of GNOME Bugzilla.">GNOME target:</a>
</th>
<td class="field_value" colspan="2" id="field_container_cf_gnome_target">---</td>
</tr>
<tr><th class="field_label" id="field_label_cf_gnome_version">
<a class="field_help_link" href="page.cgi?id=fields.html#cf_gnome_version" title="A custom Drop Down field in this installation of GNOME Bugzilla.">GNOME version:</a>
</th>
<td class="field_value" colspan="2" id="field_container_cf_gnome_version">---</td>
</tr>
<tr>
<td class="bz_section_spacer" colspan="2"></td>
</tr>
</table>
</td>
</tr>
<tr>
<td colspan="3">
<hr id="bz_top_half_spacer"/>
</td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" id="bz_big_form_parts"><tr>
<td>
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>
<br/>
<table cellpadding="4" cellspacing="0" id="attachment_table">
<tr id="a0">
<th align="left" colspan="3">
      Attachments
    </th>
</tr>
<tr class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden" id="a1">
<td valign="top">
<a href="attachment.cgi?id=355583" title="View the content of the attachment">
<b><span class="bz_obsolete">potential patch. It's untested, however.</span></b></a>
<span class="bz_attach_extra_info">
              (1.60 KB,
                patch)

            <br/>
<a href="#attach_355583" title="Go to the comment associated with the attachment">2017-07-14 11:09 UTC</a>,

            <span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
</td>
<td class="bz_attach_status" valign="top">none
          </td>
<td valign="top">
<a href="attachment.cgi?id=355583&amp;action=edit">Details</a>  |
    <a href="review?bug=784947&amp;attachment=355583">Review</a>
</td>
</tr>
<tr class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden" id="a2">
<td valign="top">
<a href="attachment.cgi?id=356237" title="View the content of the attachment">
<b><span class="bz_obsolete">[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm</span></b></a>
<span class="bz_attach_extra_info">
              (3.57 KB,
                patch)

            <br/>
<a href="#attach_356237" title="Go to the comment associated with the attachment">2017-07-23 17:38 UTC</a>,

            <span class="vcard">astian
</span>
</span>
</td>
<td class="bz_attach_status" valign="top">none
          </td>
<td valign="top">
<a href="attachment.cgi?id=356237&amp;action=edit">Details</a>  |
    <a href="review?bug=784947&amp;attachment=356237">Review</a>
</td>
</tr>
<tr class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden" id="a3">
<td valign="top">
<a href="attachment.cgi?id=356238" title="View the content of the attachment">
<b><span class="bz_obsolete">[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity</span></b></a>
<span class="bz_attach_extra_info">
              (5.45 KB,
                patch)

            <br/>
<a href="#attach_356238" title="Go to the comment associated with the attachment">2017-07-23 17:39 UTC</a>,

            <span class="vcard">astian
</span>
</span>
</td>
<td class="bz_attach_status" valign="top">none
          </td>
<td valign="top">
<a href="attachment.cgi?id=356238&amp;action=edit">Details</a>  |
    <a href="review?bug=784947&amp;attachment=356238">Review</a>
</td>
</tr>
<tr class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden" id="a4">
<td valign="top">
<a href="attachment.cgi?id=356239" title="View the content of the attachment">
<b><span class="bz_obsolete">[PATCH 3/3][RFC] Add a mechanism for exporters to report failure</span></b></a>
<span class="bz_attach_extra_info">
              (4.94 KB,
                patch)

            <br/>
<a href="#attach_356239" title="Go to the comment associated with the attachment">2017-07-23 17:40 UTC</a>,

            <span class="vcard">astian
</span>
</span>
</td>
<td class="bz_attach_status" valign="top">none
          </td>
<td valign="top">
<a href="attachment.cgi?id=356239&amp;action=edit">Details</a>  |
    <a href="review?bug=784947&amp;attachment=356239">Review</a>
</td>
</tr>
<tr class="bz_contenttype_text_plain bz_patch" id="a5">
<td valign="top">
<a href="attachment.cgi?id=356282" title="View the content of the attachment">
<b>patch</b></a>
<span class="bz_attach_extra_info">
              (1.69 KB,
                patch)

            <br/>
<a href="#attach_356282" title="Go to the comment associated with the attachment">2017-07-24 08:18 UTC</a>,

            <span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
</td>
<td class="bz_attach_status" valign="top">committed
          </td>
<td valign="top">
<a href="attachment.cgi?id=356282&amp;action=edit">Details</a>  |
    <a href="review?bug=784947&amp;attachment=356282">Review</a>
</td>
</tr>

</table>
<br/>
</td>
<td>
</td>
</tr></table>
<div id="comments"><script src="js/comments.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>
<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table cellpadding="0" cellspacing="0" class="bz_comment_table"><tr>
<td>
<div class="bz_comment bz_first_comment" id="c0">
<div class="bz_first_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c0">Description</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-14 10:55:29 UTC
        </span>
</div>
<pre class="bz_comment_text">With <a class="bz_bug_link bz_status_RESOLVED bz_closed" href="show_bug.cgi?id=441319" title="RESOLVED FIXED - evince does not print dvi files">bug 441319</a> came a DVI backend.

It's exporter (which seems to be triggered when printing to a PDF file) eventually calls g_spawn_command_line_sync with user supplied input, i.e. the filename of the file.

        command_line = g_strdup_printf ("dvipdfm %s -o %s \"%s\"", /* dvipdfm -s 1,2,.., -o exporter_filename dvi_filename */
                                        dvi_document-&gt;exporter_opts-&gt;str,
                                        dvi_document-&gt;exporter_filename,
                                        dvi_document-&gt;context-&gt;filename);


If the file is cleverly named, it might be able to cause a command injection.

$ cat boom.tex 
\documentclass{article}
\begin{document}
Boom
\end{document}
$ dvilualatex boom.tex
...
$ cp boom.dvi  '/tmp/foo";touch boom;bar"'
$ evince /tmp/foo*boom*\;bar\"

Thread 1 "evince" hit Breakpoint 1, g_spawn_command_line_sync (
    command_line=0x55a324e9eb40 "dvipdfm -s 1, -o /tmp/evince_print.pdf.0ZO72Y \"/tmp/foo\";touch boom;bar\"\"", standard_output=0x0, 
    standard_error=0x0, exit_status=0x7fff1f9f8d8c, error=0x7fff1f9f8d90) at /build/glib2.0-prJhLS/glib2.0-2.48.2/./glib/gspawn.c:716
716	/build/glib2.0-prJhLS/glib2.0-2.48.2/./glib/gspawn.c: No such file or directory.
(gdb) p command_line
$1 = (const gchar *) 0x55a324e9eb40 "dvipdfm -s 1, -o /tmp/evince_print.pdf.0ZO72Y \"/tmp/foo\";touch boom;bar\"\""
(gdb) 

g_spawn_command_line_sync seems to call g_shell_parse_argv () which then results in something like

[pid   666] execve("/usr/bin/dvipdfm", ["dvipdfm", "-s", "1,", "-o", "/tmp/evince_print.pdf.U5B12Y", "/tmp/foo;touch", "boom;bar"], [/* 76 vars */]) = 0

Now it only added an unexpected parameter. But it seems likely that dvipdfm's -D switch is able to cause more harm (quoting from the documentation <a href="http://texdoc.net/texmf-dist/doc/dvipdfm/dvipdfm.pdf">http://texdoc.net/texmf-dist/doc/dvipdfm/dvipdfm.pdf</a>):

The user must specify the command line required to invoke an external program
to perform this conversion. The command line required to invoke the conversion
program is specified using the -D command line (or configuration file) option. The string passed to the -D command line option is a C-style string that is parsed by dvipdfm . Within the string, expansions are performed as described in
Table 5. For example, to use GhostScript, one might use the command line
-D "cat %i | gs -q -sDEVICE=pdfwrite -sOutputFile=%o - -c quit"

So if we managed to rename our document to something including -D and a scary command line, we might be screwed.

An easy mitigation for now, I think, is to call  g_shell_quote  instead of manually trying to escape as it's done now.

In [74]: fmt = "dvipdfm %s -o %s \"%s\""

In [75]: fn = '/tmp/foo";$(touch boom);bar"'

In [76]: GLib.shell_parse_argv(fmt % (1,2,fn))
Out[76]: (True, argvp=['dvipdfm', '1', '-o', '2', '/tmp/foo;$(touch', 'boom);bar'])

In [77]: GLib.shell_parse_argv(fmt % (1,2,GLib.shell_quote(fn)))
Out[77]: (True, argvp=['dvipdfm', '1', '-o', '2', "'/tmp/foo;$(touch", "boom);bar'"])

In [78]: 

In addition, it seems to be clever to using absolute file paths instead in order to prevent a file named '-D foo' sneaking in. Because the g_shell_quote wouldn't prevent dvipdfm being called with a file name '-D foo' which then might cause the trouble mentioned above.

NB: g_spawn_command_line_sync does not seem to actually go through /bin/sh like a system() call would. Instead it seems to set up its own argv and calls execve.</pre>
</div><div class="bz_comment" id="c1">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c1">Comment 1</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-14 11:09:30 UTC
        </span>
</div>
<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=355583" name="attach_355583" title="potential patch. It's untested, however.">attachment 355583</a> <a href="attachment.cgi?id=355583&amp;action=edit" title="potential patch. It's untested, however.">[details]</a></span> <a href="review?bug=784947&amp;attachment=355583">[review]</a>
potential patch. It's untested, however.

I've quickly cooked up this patch.
It seems innocent to me.
I couldn't build it due to missing dependencies *sigh*.
I also didn't use g_autofree which might be appropriate here. But I don't know how well that is indeed supported.</pre>
</div><div class="bz_comment" id="c2">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c2">Comment 2</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-16 22:41:27 UTC
        </span>
</div>
<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=784947#c0">comment #0</a>)
<span class="quote">&gt; in order to prevent a file named '-D foo' sneaking in. Because the
&gt; g_shell_quote wouldn't prevent dvipdfm being called with a file name
&gt; '-D foo' which then might cause the trouble mentioned above.</span>

dvipdfm (xdvipdfmx, from Debian package "textlive-binaries") seems to
support the usual "--" to stop parsing options.  So maybe one just needs
to do: dvipdfm %s -o %s -- '%s'</pre>
</div><div class="bz_comment" id="c3">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c3">Comment 3</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-23 17:36:25 UTC
        </span>
</div>
<pre class="bz_comment_text"><a href="show_bug.cgi?id=784947#c0">comment #0</a>:
<span class="quote">&gt; Now it only added an unexpected parameter. But it seems likely that
&gt; dvipdfm's -D switch is able to cause more harm</span>

Yup.

  $ cat inclusion.tex
  foo bar baz
  \special{psfile=/etc/hosts}
  \bye
  $ dviluatex inclusion.tex
  $ cp inclusion.dvi lame.dvi
  'inclusion.dvi' -&gt; 'lame.dvi'
  $ cp inclusion.dvi 'lame.dvi" -D "gnome-calculator'
  $ evince 'lame.dvi" -D "gnome-calculator'

In Evince, open the print dialog and click "Preview".  Watch the
calculator pop up.

The patch you posted does break the injection.  However, as mentioned,
the command should be "dvipdfm %s -o %s -- %s".  It's not strictly
necessary to patch this bug (even if the input file is named "-Dfoo",
the lack of another argument to act as input file will make dvipdfm try
to read from stdin and get nothing), but it's the correct thing to do.</pre>
</div><div class="bz_comment" id="c4">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c4">Comment 4</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-23 17:38:33 UTC
        </span>
</div>
<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=356237" name="attach_356237" title="[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm">attachment 356237</a> <a href="attachment.cgi?id=356237&amp;action=edit" title="[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm">[details]</a></span> <a href="review?bug=784947&amp;attachment=356237">[review]</a>
[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm

This is an alternative patch in which I took what seems to me the safest
route and used g_spawn_sync, instead of trying to escape any argument.
Additionally, I added a hackish error reporting mechanism more intended
as an RFC than as a definitive solution.</pre>
</div><div class="bz_comment" id="c5">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c5">Comment 5</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-23 17:39:25 UTC
        </span>
</div>
<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=356238" name="attach_356238" title="[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity">attachment 356238</a> <a href="attachment.cgi?id=356238&amp;action=edit" title="[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity">[details]</a></span> <a href="review?bug=784947&amp;attachment=356238">[review]</a>
[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity

Tried to clarify the code a bit by tweaking the comments and renaming
some variables.  (Also fixed some whitespace brokenness nearby.)</pre>
</div><div class="bz_comment" id="c6">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c6">Comment 6</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-23 17:40:31 UTC
        </span>
</div>
<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=356239" name="attach_356239" title="[PATCH 3/3][RFC] Add a mechanism for exporters to report failure">attachment 356239</a> <a href="attachment.cgi?id=356239&amp;action=edit" title="[PATCH 3/3][RFC] Add a mechanism for exporters to report failure">[details]</a></span> <a href="review?bug=784947&amp;attachment=356239">[review]</a>
[PATCH 3/3][RFC] Add a mechanism for exporters to report failure

Probably not for merging as is.

Trying the same injection with the patched binary you will see the
previewer pop in and immediately out and a Gtk-CRITICAL in the console.
Apparently this is because the "distiller" invoked by dvipdfm fails to
parse /etc/hosts as a PostScript file causing dvipdfm itself to fail,
and when it does so, it removes the output file.  Evince still assumes
that export went OK and that the file exists: there doesn't seem to be a
way for the exporter in the backend to inform the frontend that the
export failed.  This hacky patch lets Evince show an error message.</pre>
</div><div class="bz_comment" id="c7">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c7">Comment 7</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-23 17:48:01 UTC
        </span>
</div>
<pre class="bz_comment_text"><a href="show_bug.cgi?id=784947#c4">comment #4</a>:
<span class="quote">&gt; Additionally, I added a hackish error reporting mechanism more intended
&gt; as an RFC than as a definitive solution.</span>

This is wrong, the error reporting thing is in patch 3 only.</pre>
</div><div class="bz_comment" id="c8">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c8">Comment 8</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-24 08:17:22 UTC
        </span>
</div>
<pre class="bz_comment_text">(In reply to astian from <a href="show_bug.cgi?id=784947#c3">comment #3</a>)
<span class="quote">&gt; <a href="show_bug.cgi?id=784947#c0">comment #0</a>:
&gt; &gt; Now it only added an unexpected parameter. But it seems likely that
&gt; &gt; dvipdfm's -D switch is able to cause more harm
&gt; 
&gt; Yup.</span>
thanks for confirming both the existence of the vulnerability and the soundness of the proposed patch.

<span class="quote">&gt; The patch you posted does break the injection.  However, as mentioned,
&gt; the command should be "dvipdfm %s -o %s -- %s".</span>
With either escaped arguments or a manually built argv, of course.
You seem to opt for the latter.  I think it's too complex for what it achieves but YMMV.  Let me attach a patch which includes the "--" separation so that we have the options at hand to discuss them.

I like your idea about propagating the error.  I feel it should rather be a separate issue to discuss so that we can concentrate on the injection vulnerability here.  Do you mind creating a new issue and proposing a patch there?</pre>
</div><div class="bz_comment" id="c9">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c9">Comment 9</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-07-24 08:18:00 UTC
        </span>
</div>
<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=356282" name="attach_356282" title="patch">attachment 356282</a> <a href="attachment.cgi?id=356282&amp;action=edit" title="patch">[details]</a></span> <a href="review?bug=784947&amp;attachment=356282">[review]</a>
patch</pre>
</div><div class="bz_comment" id="c10">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c10">Comment 10</a>
</span>
<span class="bz_comment_user">
<span class="vcard">astian
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-03 09:45:29 UTC
        </span>
</div>
<pre class="bz_comment_text">bump</pre>
</div><div class="bz_comment" id="c11">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c11">Comment 11</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Carlos Garcia Campos</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-05 05:56:06 UTC
        </span>
</div>
<pre class="bz_comment_text">Comment on <span class=""><a href="attachment.cgi?id=356282" name="attach_356282" title="patch">attachment 356282</a> <a href="attachment.cgi?id=356282&amp;action=edit" title="patch">[details]</a></span> <a href="review?bug=784947&amp;attachment=356282">[review]</a>
patch

<span class="quote">&gt;From 1040ffa506ffa35c2ee4959b090c1b1cb554cd86 Mon Sep 17 00:00:00 2001
&gt;From: Tobias Mueller &lt;<a href="mailto:muelli@cryptobitch.de">muelli@cryptobitch.de</a>&gt;
&gt;Date: Fri, 14 Jul 2017 12:52:14 +0200
&gt;Subject: [PATCH] dvi: Mitigate command injection attacks by quoting filename</span>
&gt;
<span class="quote">&gt;With commit <a href="https://git.gnome.org/browse/evince/commit/?id=1fcca0b8041de0d6074d7e17fba174da36c65f99">1fcca0b8041de0d6074d7e17fba174da36c65f99</a> came a DVI backend.
&gt;It exports to PDF via the dvipdfm tool.
&gt;It calls that tool with the filename of the currently loaded document.
&gt;If that filename is cleverly crafted, it can escape the currently
&gt;used manual quoting of the filname.</span>

filname -&gt; filename.

<span class="quote">&gt;  Instead of manually quoting the
&gt;filename, we use g_shell_quote.  To further harden the call to dvipdfm
&gt;we use "--" to separate options from filenames.</span>
&gt;
<span class="quote">&gt;<a class="bz_bug_link bz_status_RESOLVED bz_closed" href="show_bug.cgi?id=784947" title="RESOLVED FIXED - Evince's DVI exporter is susceptible to a command injection attack">https://bugzilla.gnome.org/show_bug.cgi?id=784947</a>
&gt;---
&gt; backend/dvi/dvi-document.c | 8 +++++---
&gt; 1 file changed, 5 insertions(+), 3 deletions(-)</span>
&gt;
<span class="quote">&gt;diff --git a/backend/dvi/dvi-document.c b/backend/dvi/dvi-document.c
&gt;index cbb3f8a..6b93de7 100644
&gt;--- a/backend/dvi/dvi-document.c
&gt;+++ b/backend/dvi/dvi-document.c
&gt;@@ -300,12 +300,14 @@ dvi_document_file_exporter_end (EvFileExporter *exporter)
&gt; 	gboolean success;
&gt; 	
&gt; 	DviDocument *dvi_document = DVI_DOCUMENT(exporter);
&gt;+	gchar* quoted_filename = g_shell_quote (dvi_document-&gt;context-&gt;filename);
&gt; 	
&gt;-	command_line = g_strdup_printf ("dvipdfm %s -o %s \"%s\"", /* dvipdfm -s 1,2,.., -o exporter_filename dvi_filename */
&gt;+	command_line = g_strdup_printf ("dvipdfm %s -o %s -- %s", /* dvipdfm -s 1,2,.., -o exporter_filename dvi_filename */
&gt; 					dvi_document-&gt;exporter_opts-&gt;str,
&gt; 					dvi_document-&gt;exporter_filename,
&gt;-					dvi_document-&gt;context-&gt;filename);
&gt;-	
&gt;+					quoted_filename);
&gt;+	g_free (quoted_filename);
&gt;+
&gt; 	success = g_spawn_command_line_sync (command_line,
&gt; 					     NULL,
&gt; 					     NULL,
&gt;-- 
&gt;2.7.4</span>
&gt;

Ok, this looks like a simpler solution. I agree we could probably handle and report errors, but I would move that to a different bug.</pre>
</div><div class="bz_comment" id="c12">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c12">Comment 12</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-05 12:40:10 UTC
        </span>
</div>
<pre class="bz_comment_text">pushed as 350404c76dc8601e2cdd2636490e2afc83d3090e

It would be a shame for the other effort to bitrot, so please open a new bug so that we can discuss this further.</pre>
</div><div class="bz_comment" id="c13">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c13">Comment 13</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-05 12:41:40 UTC
        </span>
</div>
<pre class="bz_comment_text">Comment on <span class="bz_obsolete"><a href="attachment.cgi?id=356238" name="attach_356238" title="[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity">attachment 356238</a> <a href="attachment.cgi?id=356238&amp;action=edit" title="[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity">[details]</a></span> <a href="review?bug=784947&amp;attachment=356238">[review]</a>
[PATCH 2/3] dvi: Rename a few exporter-related variables for clarity

marking this patch as obsolete for this bug report. Please open a new bug with these patches so that we can discuss the good idea of error propagation.</pre>
</div><div class="bz_comment" id="c14">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c14">Comment 14</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-05 12:41:53 UTC
        </span>
</div>
<pre class="bz_comment_text">Comment on <span class="bz_obsolete"><a href="attachment.cgi?id=356237" name="attach_356237" title="[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm">attachment 356237</a> <a href="attachment.cgi?id=356237&amp;action=edit" title="[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm">[details]</a></span> <a href="review?bug=784947&amp;attachment=356237">[review]</a>
[PATCH 1/3] dvi: Use g_spawn_sync to call dvipdfm

marking this patch as obsolete for this bug report. Please open a new bug with these patches so that we can discuss the good idea of error propagation.</pre>
</div><div class="bz_comment" id="c15">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c15">Comment 15</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Tobias Mueller</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-05 12:42:00 UTC
        </span>
</div>
<pre class="bz_comment_text">Comment on <span class="bz_obsolete"><a href="attachment.cgi?id=356239" name="attach_356239" title="[PATCH 3/3][RFC] Add a mechanism for exporters to report failure">attachment 356239</a> <a href="attachment.cgi?id=356239&amp;action=edit" title="[PATCH 3/3][RFC] Add a mechanism for exporters to report failure">[details]</a></span> <a href="review?bug=784947&amp;attachment=356239">[review]</a>
[PATCH 3/3][RFC] Add a mechanism for exporters to report failure

marking this patch as obsolete for this bug report. Please open a new bug with these patches so that we can discuss the good idea of error propagation.</pre>
</div><div class="bz_comment" id="c16">
<div class="bz_comment_head">
<span class="bz_comment_number">
<a href="show_bug.cgi?id=784947#c16">Comment 16</a>
</span>
<span class="bz_comment_user">
<span class="vcard"><span class="fn">Hanno Böck</span>
</span>
</span>
<span class="bz_comment_user_images">
</span>
<span class="bz_comment_time">
          2017-08-23 16:41:44 UTC
        </span>
</div>
<pre class="bz_comment_text">This issue got CVE-2017-1000159 assigned.</pre>
</div>
<script type="text/javascript">
  function traceparser_toggle_trace(link, trace_id) {
    var trace = document.getElementById('trace_' + trace_id);
    bz_toggleClass(trace, 'bz_default_hidden');
    if (link.innerHTML == '+') { link.innerHTML = '&mdash;'; }
    else { link.innerHTML = '+'; }
  }
</script>
</td>
<td>
</td>
</tr></table>
</div>
<hr/>
</form>
<hr/>

<br/>
</div>
<div id="footer">
<div class="intro"></div>
<ul id="useful-links">
<li id="links-actions"><ul class="links">
<li><a href="./">Home</a></li>
<li><span class="separator">| </span><span style="text-decoration:line-through"><a href="">New</a></span></li>
<li><span class="separator">| </span><a href="page.cgi?id=browse.html&amp;product=evince">Browse</a></li>
<li><span class="separator">| </span><a href="query.cgi">Search</a></li>
<li class="form">
<span class="separator">| </span>
<form action="buglist.cgi" method="get" onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
<input id="no_redirect_bottom" name="no_redirect" type="hidden" value="0"/>
<script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
<input class="txt" id="quicksearch_bottom" name="quicksearch" title="Quick Search" type="text" value=""/>
<input class="btn" id="find_bottom" type="submit" value="Search"/></form>
<a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>
<li><span class="separator">| </span><a href="page.cgi?id=reports.html">Reports</a></li>
<li>
<span class="separator">| </span>
<a href="http://www.bugzilla.org/docs/4.4/en/html/bug_page.html" target="_blank">Help</a>
</li>
<li id="mini_login_container_bottom">
<span class="separator">| </span>
<a href="show_bug.cgi?id=784947&amp;GoAheadAndLogIn=1" id="login_link_bottom" onclick="return show_mini_login_form('_bottom')">Log In</a>
<form action="show_bug.cgi?id=784947" class="mini_login bz_default_hidden" id="mini_login_bottom" method="POST" onsubmit="return check_mini_login_fields( '_bottom' );">
<input class="bz_login" id="Bugzilla_login_bottom" name="Bugzilla_login" onfocus="mini_login_on_focus('_bottom')" title="Login"/>
<input class="bz_password" id="Bugzilla_password_bottom" name="Bugzilla_password" title="Password" type="password"/>
<input class="bz_password bz_default_hidden bz_mini_login_help" id="Bugzilla_password_dummy_bottom" onfocus="mini_login_on_focus('_bottom')" title="Password" type="text" value="password"/>
<input checked="" class="bz_remember" id="Bugzilla_remember_bottom" name="Bugzilla_remember" type="checkbox" value="on"/>
<label for="Bugzilla_remember_bottom">Remember</label>
<input name="Bugzilla_login_token" type="hidden" value=""/>
<input id="log_in_bottom" name="GoAheadAndLogIn" type="submit" value="Log in"/>
<script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_bottom');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_bottom');
              }, 200);
          });
    }
    </script>
<a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
</form>
</li>
<li id="forgot_container_bottom">
<span class="separator">| </span>
<a href="show_bug.cgi?id=784947&amp;GoAheadAndLogIn=1#forgot" id="forgot_link_bottom" onclick="return show_forgot_form('_bottom')">Forgot Password</a>
<form action="token.cgi" class="mini_forgot bz_default_hidden" id="forgot_form_bottom" method="post">
<label for="login_bottom">Login:</label>
<input id="login_bottom" name="loginname" size="20" type="text"/>
<input id="forgot_button_bottom" type="submit" value="Reset Password"/>
<input name="a" type="hidden" value="reqpw"/>
<input id="token_bottom" name="token" type="hidden" value="1626108469-cCt9FIp-OHMc7Nw1HKdv6t5qyXp2abgfuxnXviox9WQ"/>
<a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
</form>
</li>
</ul>
</li>
</ul>
<div class="outro"></div>
</div>
</body>
</html>