    
<!DOCTYPE html>
<html>
<head>
                            <title>CVE-2021-26074 - Broken authentication in Atlassian Connect Spring Boot (ACSB) - Security - Atlassian Documentation</title>
    
        

                        
    
                        
    

                
    
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="https://confluence.atlassian.com">

    <meta id="atlassian-token" name="atlassian-token" content="6654b143d28d886d4085882df272fbd6aebb7973">

<meta id="confluence-cluster-node-id" name="confluence-cluster-node-id" value="51616aeb">
<meta id="confluence-cluster-node-name" name="confluence-cluster-node-name" value="i-01159eb0305cac8ff-ipp-10.226.27.95">

<meta id="confluence-space-key" name="confluence-space-key" content="SECURITY">
<script type="text/javascript">
        var contextPath = '';
</script>

    

    <meta name="confluence-request-time" content="1635633243620">
        
            <script type="text/x-template" title="create-draft">
    <div class="publisher-dialog">
        <form action="#" method="post" class="aui create-draft-dialog">
            <div>
                <label for="create-draft-title">Title</label>
                <input class="text" type="text" id="create-draft-title" name="title" title="Title">
            </div>
        </form>
    </div>
</script>

<script type="text/x-template" title="publisher-dialog-page1">
    <div class="publisher-dialog">
        <div class="publisher-dialog-comment">
            <form action="#" method="post" class="aui publish-comment-form">
                <div>
                    <label for="publish-comment">Version Comment</label>
                    <input class="text" type="text" id="publish-comment" name="publish-comment" title="Version Comment">
                </div>
            </form>
        </div>
        <div class="publisher-dialog-pages">
            <table class="aui">
                <tr>
                    <th class="publisher-dialog-pages-title">Page Title</th>
                </tr>
            </table>
        </div>
    </div>
</script>

<script type="text/x-template" title="publisher-dialog-page2">
    <div class="publisher-dialog">
        <div class="publisher-dialog-progress">
            <div class="publisher-dialog-progress-icon"></div><span class="publisher-dialog-progress-message">Progress ...</span>
        </div>
        <div class="publisher-dialog-pages-progress">
            <table class="aui">
                <tr>
                    <th class="publisher-dialog-pages-title">Page Title</th>
                    <th class="publisher-dialog-pages-status">Changes in Original</th>
                </tr>
            </table>
        </div>
    </div>
</script>

<script type="text/x-template" title="publisher-dialog-page">
    <tr>
        <td class="publisher-dialog-pages-title"><a href="{1}" target="_blank">{0}</a></td>
    </tr>
</script>

<script type="text/x-template" title="publisher-dialog-page-progress">
    <tr>
        <td class="publisher-dialog-pages-title"><a href="{1}" target="_blank">{0}</a></td>
        <td class="publisher-dialog-pages-status">{2}<a href="{3}" target="_blank">{4}</a></td>
    </tr>
</script>
    
        
            <style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-discovered-plugin-features" content="$discoveredList">
            <meta name="ajs-keyboardshortcut-hash" content="be61f67f9c6d0b10a22fc2ade1f09271">
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="20000">
            <script type="text/x-template" title="gliffy-webpanel-footer">
        <div class="gliffy-webpanel-footer"><span></span></div>
</script>


            
    
    
            <meta name="ajs-page-title" content="CVE-2021-26074 - Broken authentication in Atlassian Connect Spring Boot (ACSB)">
            <meta name="ajs-latest-published-page-title" content="CVE-2021-26074 - Broken authentication in Atlassian Connect Spring Boot (ACSB)">
            <meta name="ajs-space-name" content="Security">
            <meta name="ajs-page-id" content="1051986106">
            <meta name="ajs-latest-page-id" content="1051986106">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-parent-page-title" content="Articles">
            <meta name="ajs-parent-page-id" content="951406100">
            <meta name="ajs-space-key" content="SECURITY">
            <meta name="ajs-max-number-editors" content="12">
            <meta name="ajs-macro-placeholder-timeout" content="5000">
            <meta name="ajs-jira-metadata-count" content="-1">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-can-remove-page-hierarchy" content="false">
            <meta name="ajs-browse-page-tree-mode" content="view">
            <meta name="ajs-shared-drafts" content="false">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-base-url" content="https://confluence.atlassian.com">
            <meta name="ajs-version-number" content="7.4.13">
            <meta name="ajs-build-number" content="8402">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-remote-user-key" content="">
            <meta name="ajs-remote-user-has-licensed-access" content="false">
            <meta name="ajs-remote-user-has-browse-users-permission" content="false">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-current-user-avatar-uri-reference" content="/images/icons/profilepics/anonymous.svg">
            <meta name="ajs-static-resource-url-prefix" content="/s/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/_">
            <meta name="ajs-global-settings-attachment-max-size" content="146800640">
            <meta name="ajs-global-settings-quick-search-enabled" content="true">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="draggable.disabled,confluence-monitoring.enable,applinks.v3.ui,captcha-level.easy,confluence.onboarding.bypass,cst-search-key,com.atlassian.analytics.auto.whitelist.grow.events,clc.quick.create,confluence.view.edit.transition,cql.search.screen,confluence-inline-comments-resolved,frontend.editor.v4,http.session.registrar,nps.survey.inline.dialog,confluence.efi.onboarding.new.templates,frontend.editor.v4.compatibility,atlassian.cdn.static.assets,pdf-preview,previews.sharing,previews.versions,file-annotations,confluence.efi.onboarding.rich.space.content,collaborative-audit-log,previews.conversion-service,editor.ajax.save,read.only.mode,graphql,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentReplyEvent,previews.trigger-all-file-types,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentCreateEvent,attachment.extracted.text.extractor,lucene.caching.filter,confluence.table.resizable,notification.batch,previews.sharing.pushstate,confluence-inline-comments-rich-editor,site-wide.synchrony.opt-in,file-annotations.likes,gatekeeper-ui-v2,v2.content.name.searcher,mobile.supported.version,pulp,confluence-inline-comments,confluence-inline-comments-dangling-comment,quick-reload-inline-comments-flags">
            <meta name="ajs-atl-token" content="6654b143d28d886d4085882df272fbd6aebb7973">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-user-date-pattern" content="dd MMM yyyy">
            <meta name="ajs-access-mode" content="READ_WRITE">
            <meta name="ajs-render-mode" content="READ_WRITE">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="/s/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/28/_/favicon.ico">
    <link rel="icon" type="image/x-icon" href="/s/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/28/_/favicon.ico">

<link rel="search" type="application/opensearchdescription+xml" href="/opensearch/osd.action" title="Atlassian Documentation"/>
    
                    
            <meta name="ajs-create-issue-metadata-show-discovery" content="false">
            

    <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\u0022\u0022";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources.test-mode"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.applinks-help-paths"]="{\u0022entries\u0022:{\u0022applinks.docs.root\u0022:\u0022https://confluence.atlassian.com/display/APPLINKS-060/\u0022,\u0022applinks.docs.diagnostics.troubleshoot.sslunmatched\u0022:\u0022SSL+and+application+link+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthsignatureinvalid\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthtimestamprefused\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.delete.entity.link\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.adding.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.administration.guide\u0022:\u0022Application+Links+Documentation\u0022,\u0022applinks.docs.oauth.security\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.troubleshoot.application.links\u0022:\u0022Troubleshoot+application+links\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unknownerror\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.trusted.apps\u0022:\u0022Configuring+Trusted+Applications+authentication+for+an+application+link\u0022,\u0022applinks.docs.diagnostics.troubleshoot.authlevelunsupported\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.ssluntrusted\u0022:\u0022SSL+and+application+link+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unknownhost\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.delete.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.link.applications\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthproblem\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.migration\u0022:\u0022Update+application+links+to+use+OAuth\u0022,\u0022applinks.docs.relocate.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.administering.entity.links\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.upgrade.application.link\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.diagnostics.troubleshoot.connectionrefused\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.oauth\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.insufficient.remote.permission\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.configuring.application.link.auth\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.diagnostics\u0022:\u0022Application+links+diagnostics\u0022,\u0022applinks.docs.configured.authentication.types\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.adding.entity.link\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unexpectedresponse\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.basic\u0022:\u0022Configuring+Basic+HTTP+Authentication+for+an+Application+Link\u0022,\u0022applinks.docs.diagnostics.troubleshoot.authlevelmismatch\u0022:\u0022OAuth+troubleshooting+guide\u0022}}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.applinks-types"]="{\u0022crowd\u0022:\u0022Crowd\u0022,\u0022confluence\u0022:\u0022Confluence\u0022,\u0022fecru\u0022:\u0022FishEye / Crucible\u0022,\u0022stash\u0022:\u0022Stash\u0022,\u0022jira\u0022:\u0022Jira\u0022,\u0022refapp\u0022:\u0022Reference Application\u0022,\u0022bamboo\u0022:\u0022Bamboo\u0022,\u0022generic\u0022:\u0022Generic Application\u0022}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.entity-types"]="{\u0022singular\u0022:{\u0022refapp.charlie\u0022:\u0022Charlie\u0022,\u0022fecru.project\u0022:\u0022Crucible Project\u0022,\u0022fecru.repository\u0022:\u0022FishEye Repository\u0022,\u0022stash.project\u0022:\u0022Stash Project\u0022,\u0022generic.entity\u0022:\u0022Generic Project\u0022,\u0022confluence.space\u0022:\u0022Confluence Space\u0022,\u0022bamboo.project\u0022:\u0022Bamboo Project\u0022,\u0022jira.project\u0022:\u0022Jira Project\u0022},\u0022plural\u0022:{\u0022refapp.charlie\u0022:\u0022Charlies\u0022,\u0022fecru.project\u0022:\u0022Crucible Projects\u0022,\u0022fecru.repository\u0022:\u0022FishEye Repositories\u0022,\u0022stash.project\u0022:\u0022Stash Projects\u0022,\u0022generic.entity\u0022:\u0022Generic Projects\u0022,\u0022confluence.space\u0022:\u0022Confluence Spaces\u0022,\u0022bamboo.project\u0022:\u0022Bamboo Projects\u0022,\u0022jira.project\u0022:\u0022Jira Projects\u0022}}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.authentication-types"]="{\u0022com.atlassian.applinks.api.auth.types.BasicAuthenticationProvider\u0022:\u0022Basic Access\u0022,\u0022com.atlassian.applinks.api.auth.types.TrustedAppsAuthenticationProvider\u0022:\u0022Trusted Applications\u0022,\u0022com.atlassian.applinks.api.auth.types.CorsAuthenticationProvider\u0022:\u0022CORS\u0022,\u0022com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider\u0022:\u0022OAuth\u0022,\u0022com.atlassian.applinks.api.auth.types.TwoLeggedOAuthAuthenticationProvider\u0022:\u0022OAuth\u0022,\u0022com.atlassian.applinks.api.auth.types.TwoLeggedOAuthWithImpersonationAuthenticationProvider\u0022:\u0022OAuth\u0022}";
WRM._unparsedData["com.atlassian.confluence.plugins.synchrony-interop:synchrony-status-banner-loader.synchrony-status"]="false";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details"]="{\u0022daysBeforeLicenseExpiry\u0022:0,\u0022daysBeforeMaintenanceExpiry\u0022:0,\u0022showLicenseExpiryBanner\u0022:false,\u0022showMaintenanceExpiryBanner\u0022:false,\u0022renewUrl\u0022:null,\u0022salesUrl\u0022:null}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-search-ui-plugin:confluence-search-ui-plugin-resources.i18n-data"]="{\u0022search.ui.recent.link.text\u0022:\u0022View more recently visited\u0022,\u0022search.ui.filter.space.category.input.label\u0022:\u0022Find space categories...\u0022,\u0022search.ui.search.results.empty\u0022:\u0022We couldn\u005Cu0027\u005Cu0027t find anything matching \u005C\u0022{0}\u005C\u0022.\u0022,\u0022search.ui.filter.clear.selected\u0022:\u0022Clear selected items\u0022,\u0022search.ui.content.name.search.items.panel.load.all.top.items.button.text\u0022:\u0022Show more app results...\u0022,\u0022search.ui.filter.space.archive.label\u0022:\u0022Search archived spaces\u0022,\u0022search.ui.filter.label\u0022:\u0022filter\u0022,\u0022search.ui.filter.contributor.button.text\u0022:\u0022Contributor\u0022,\u0022search.ui.filter.date.all.text\u0022:\u0022Any time\u0022,\u0022search.ui.filter.space.current.label\u0022:\u0022CURRENT\u0022,\u0022search.ui.clear.input.button.text\u0022:\u0022Clear text\u0022,\u0022search.ui.search.results.clear.button\u0022:\u0022clear your filters.\u0022,\u0022search.ui.filter.date.hour.text\u0022:\u0022The past day\u0022,\u0022help.search.ui.link.title\u0022:\u0022Search tips\u0022,\u0022search.ui.filters.heading\u0022:\u0022Filter by\u0022,\u0022search.ui.filter.label.input.label\u0022:\u0022Find labels...\u0022,\u0022search.ui.recent.items.anonymous\u0022:\u0022Start exploring. Your search results will appear here.\u0022,\u0022search.ui.filter.date.month.text\u0022:\u0022The past month\u0022,\u0022search.ui.input.label\u0022:\u0022Search\u0022,\u0022search.ui.search.result\u0022:\u0022{0,choice,1#{0} search result|1\u005Cu003c{0} search results}\u0022,\u0022search.ui.infinite.scroll.button.text\u0022:\u0022More results\u0022,\u0022search.ui.filter.date.button.text\u0022:\u0022Date\u0022,\u0022search.ui.filter.date.week.text\u0022:\u0022The past week\u0022,\u0022search.ui.filter.label.button.text\u0022:\u0022Label\u0022,\u0022search.ui.input.alert\u0022:\u0022Hit enter to search\u0022,\u0022search.ui.result.subtitle.calendar\u0022:\u0022Team calendar\u0022,\u0022search.ui.filter.no.result.text\u0022:\u0022We can\u005Cu0027\u005Cu0027t find anything matching your search\u0022,\u0022search.ui.filter.date.heading\u0022:\u0022Last modified within\u0022,\u0022search.ui.result.subtitle.user\u0022:\u0022User profile\u0022,\u0022search.ui.filter.contributor.input.label\u0022:\u0022Find people...\u0022,\u0022search.ui.filter.content.type.button.text\u0022:\u0022Type\u0022,\u0022search.ui.filter.space.input.label\u0022:\u0022Find spaces...\u0022,\u0022search.ui.filter.date.year.text\u0022:\u0022The past year\u0022,\u0022search.ui.advanced.search.link.text\u0022:\u0022Advanced search\u0022,\u0022search.ui.filter.space.button.text\u0022:\u0022Space\u0022,\u0022search.ui.generic.error\u0022:\u0022Something went wrong. Refresh the page, or contact your admin if this keeps happening.\u0022,\u0022search.ui.recent.spaces\u0022:\u0022Recent Spaces\u0022,\u0022search.ui.search.results.clear.line2\u0022:\u0022Try a different search term or\u0022,\u0022search.ui.filter.space.category.button.text\u0022:\u0022Space category\u0022,\u0022search.ui.search.results.clear.line1\u0022:\u0022We couldn\u005Cu0027\u005Cu0027t find anything matching your search.\u0022,\u0022search.ui.content.name.search.items.panel.load.all.top.items.admin.button.text\u0022:\u0022Show more settings and app results...\u0022,\u0022search.ui.recent.pages\u0022:\u0022Recently visited\u0022,\u0022search.ui.search.result.anonymous\u0022:\u0022{0,choice,1#{0} search result|1\u005Cu003c{0} search results}. Have an account? {1}Log in{2} to expand your search.\u0022,\u0022search.ui.recent.items.empty\u0022:\u0022Start exploring. Pages and spaces you\u005Cu0027\u005Cu0027ve visited recently will appear here.\u0022,\u0022search.ui.result.subtitle.space\u0022:\u0022Space\u0022,\u0022search.ui.filter.space.init.heading\u0022:\u0022recent spaces\u0022}";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script>
<link type="text/css" rel="stylesheet" href="/s/64f5dd6d32bc8d992a9cbdaba5ef1f67-CDN/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/63b20e9a5a6d2ed9c4fe67bd9a933b37/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all">
<link type="text/css" rel="stylesheet" href="/s/2cdb7f5eb8453d8f3b4ac4b2bcd20f04-CDN/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/c773a10807bea330a3b595d8aa2e00bd/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop,main,page,viewcontent,atl.comments,atl.general,-_super/batch.css?gatekeeper-ui-v2=true&amp;highlightactions=true&amp;scm-display-getting-started=false" data-wrm-key="atl.confluence.plugins.pagetree-desktop,main,page,viewcontent,atl.comments,atl.general,-_super" data-wrm-batch-type="context" media="all">
<link type="text/css" rel="stylesheet" href="/s/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/28/_/styles/colors.css" media="all">
<link type="text/css" rel="stylesheet" href="/s/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/10/_/styles/custom.css?spaceKey=SECURITY" media="all">
<script type="text/javascript" src="/s/7f483f6cf5d3d13229bbd88b536b61a0-CDN/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/63b20e9a5a6d2ed9c4fe67bd9a933b37/_/download/contextbatch/js/_super/batch.js?locale=en-GB" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script>
<script type="text/javascript" src="/s/97b93e3d1bc32a87512c445ed5811754-CDN/-h6vz9k/8402/45c55aec607bd3c0b24eb377ecd790d998a06033/c773a10807bea330a3b595d8aa2e00bd/_/download/contextbatch/js/atl.confluence.plugins.pagetree-desktop,main,page,viewcontent,atl.comments,atl.general,-_super/batch.js?gatekeeper-ui-v2=true&amp;highlightactions=true&amp;locale=en-GB&amp;scm-display-getting-started=false" data-wrm-key="atl.confluence.plugins.pagetree-desktop,main,page,viewcontent,atl.comments,atl.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script>

    

        
    

        
        <meta name="ajs-site-title" content="Atlassian Documentation" />
            
    <!-- ADM-76246 - Add Google Webmaster Tools site verification code to Custom HTML on CAC -->
<meta name="google-site-verification" content="WJJ7tHb2VT43pW6XPfWrJWJecm-VO42XsG7KVG_Dp8E" />
<script src="//cdn.optimizely.com/js/10828395850.js"></script>

<script>
if (typeof window['ace'] == 'undefined') {
    document.write('<script type="text/javascript" src="https://ace-cdn.atlassian.com/stp/current/analytics/js/atl-analytics.min.js"><' + '/script>');
    document.write('<script type="text/javascript">ace.analytics.Initializer.initWithPageAnalytics(\'9nfqb81km3\');<' + '/script>');
}
</script>

<script class="SL_swap” id=”transifex_live_js"></script>

<!-- SL:swap-start:id:transifex-live-js-head -->
<script type="text/javascript"></script>
<!-- SL:swap-end -->

    
                <link rel="canonical" href="https://confluence.atlassian.com/pages/viewpage.action?pageId=1051986106">
        <link rel="shortlink" href="https://confluence.atlassian.com/x/ugi0Pg">
    <meta name="wikilink" content="[SECURITY:CVE-2021-26074 - Broken authentication in Atlassian Connect Spring Boot (ACSB)]">
    <meta name="page-version" content="4">
    <meta name="ajs-page-version" content="4">

</head>

    
<body      id="com-atlassian-confluence" class="theme-default  aui-layout aui-theme-default">

        
            <div id='stp-licenseStatus-banner'></div>
            <script>
    var spaceConfigElement = document.getElementById('sv-space-config');
    if (spaceConfigElement) {
        var cssClasses = spaceConfigElement.getAttribute('content');
        document.body.className += ' ' + cssClasses;
    }
</script>
            <meta name="ajs-is-scroll-viewport-available" content="true">
    <ul id="assistive-skip-links" class="assistive">
    <li><a href="#title-heading">Skip to content</a></li>
    <li><a href="#breadcrumbs">Skip to breadcrumbs</a></li>
    <li><a href="#header-menu-bar">Skip to header menu</a></li>
    <li><a href="#navigation">Skip to action menu</a></li>
    <li><a href="#quick-search-query">Skip to quick search</a></li>
</ul>
<div id="page">
<div id="full-height-container">
    <div id="header-precursor">
        <div class="cell">
            
                            </div>
    </div>
        





<header id="header" role="banner">
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}"><div role="application"><div class="app-switcher-loading">Loading&hellip;</div></div></div></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="/"><img src="/download/attachments/163938305/atl.site.logo?version=2&amp;modificationDate=1364459793393&amp;api=v2" alt="Atlassian Documentation" /></a></h1><ul class="aui-nav">
                            <li>
            
        
        
<a  id="space-directory-link" href="/spacedirectory/view.action"  class=" aui-nav-imagelink"   title="Spaces">
            <span>Spaces</span>
    </a>
        </li>
                                <li class="aui-buttons">
            </li>
</ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                        <li>
        <div id="search-ui" class="aui-quicksearch dont-default-focus header-quicksearch"><input id="quick-search-query" aria-label="Search" placeholder="Search" type="text" /><div id="quick-search-alert" role="alert">Hit enter to search</div><aui-spinner size="small"></aui-spinner></div>
    </li>
        <li>
            
        <a id="help-menu-link" class="aui-nav-link aui-dropdown2-trigger aui-dropdown2-trigger-arrowless" href="#" aria-haspopup="true" aria-owns="help-menu-link-content" title="Help">
        <span class="aui-icon aui-icon-small aui-iconfont-question-filled">Help</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                                <ul  id="help-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
        
            
<a  id="confluence-help-link" href="https://docs.atlassian.com/confluence/docs-74/" class="    "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a>
</li>
                                            <li>
    
                
<a  id="keyboard-shortcuts-link" href="#" class="    "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a>
</li>
                                            <li>
    
            
<a  id="feed-builder-link" href="/dashboard/configurerssfeed.action" class="    "      title="Create your custom RSS feed." >
        Feed Builder
</a>
</li>
                                            <li>
    
            
<a  id="whats-new-menu-link" href="https://confluence.atlassian.com/display/DOC/Confluence+7.4+Release+Notes" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li>
    
                
<a  id="gadget-directory-link" href="#" class="   user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a>
</li>
                                            <li>
    
            
<a  id="confluence-about-link" href="/aboutconfluencepage.action" class="    "      title="Get more information about Confluence" >
        About Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
    </li>
        <li>
                
    
    </li>
        <li>
            
    </li>
        <li>
                                            <li>
        
            
<a  id="login-link" href="/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D1051986106" class="   user-item login-link "      title="" >
        Log in
</a>
</li>
                        
    </li>
    </ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>
    

    
    	<div class="ia-splitter">
    		<div class="ia-splitter-left">
    			<div class="ia-fixed-sidebar">
                                            
                            <div class="acs-side-bar ia-scrollable-section"><div class="acs-side-bar-space-info tipsy-enabled" data-configure-tooltip="Edit space details"><div class="avatar"><div class="space-logo" data-key="SECURITY" data-name="Security" data-entity-type="confluence.space"><div class="avatar-img-container"><div class="avatar-img-wrapper"><a href="/display/SECURITY/Atlassian+Security" title="Security"><img class="avatar-img" src="/images/logo/default-space-logo.svg" alt="Security"></a></div></div></div></div><div class="space-information-container"><div class="name"><a href="/display/SECURITY/Atlassian+Security" title="Security">Security</a></div><div class="flyout-handle icon aui-icon aui-icon-small aui-iconfont-edit"></div></div></div><div class="acs-side-bar-content"><div class="acs-nav-wrapper"><div class="acs-nav" data-has-create-permission="false" data-quick-links-state="hide" data-page-tree-state="null" data-nav-type="page-tree"><div class="acs-nav-sections"></div></div></div><div class="ia-secondary-container tipsy-enabled" data-tree-type="page-tree"><div class="ia-secondary-header"><h5 class="ia-secondary-header-title page-tree"><span class="icon"></span><span class="label">Page tree</span></h5></div><div class="ia-secondary-content">


<div class="plugin_pagetree conf-macro output-inline" data-hasbody="false" data-macro-name="pagetree">

        
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="" />
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false&amp;expandCurrent=true&amp;placement=sidebar" />
        <input type="hidden" name="treePageId" value="1051986106" />

        <input type="hidden" name="noRoot" value="false" />
        <input type="hidden" name="rootPageId" value="229839985" />

        <input type="hidden" name="rootPage" value="" />
        <input type="hidden" name="startDepth" value="0" />
        <input type="hidden" name="spaceKey" value="SECURITY" />

        <input type="hidden" name="i18n-pagetree.loading" value="Loading..." />
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page." />
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information." />
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D1051986106&amp;permissionViolation=true" />
        <input type="hidden" name="mobile" value="false" />
        <input type="hidden" name="placement" value="sidebar" />

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="951406100" />
                                    <input type="hidden" name="ancestorId" value="229839985" />
                                    </fieldset>
    </fieldset>
</div>
</div></div></div><div class="hidden"><a href="/collector/pages.action?key=SECURITY" id="space-pages-link"></a><script type="text/x-template" title="logo-config-content"><h2>Space Details</h2><div class="personal-space-logo-hint">Your profile picture is used as the logo for your personal space. <a href="/users/profile/editmyprofilepicture.action" target="_blank">Change your profile picture</a>.</div></script></div></div><div class="space-tools-section"><div id="space-tools-menu-additional-items" class="hidden"><div data-label="Browse pages" data-class="" data-href="/pages/reorderpages.action?key=SECURITY">Browse pages</div></div><button id="space-tools-menu-trigger"  class=" aui-dropdown2-trigger aui-button aui-button-subtle tipsy-enabled aui-dropdown2-trigger-arrowless " aria-controls="space-tools-menu" aria-haspopup="true" role="button" data-aui-trigger><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure</span><span class="aui-button-label">Space tools</span><span class="aui-icon "></span></button><div id="space-tools-menu" class="aui-dropdown2 aui-style-default space-tools-dropdown" role="menu" aria-hidden="true" data-aui-alignment="top left"><div role="application"></div></div><a class="expand-collapse-trigger aui-icon aui-icon-small aui-iconfont-chevron-double-left"></a></div>
                    
                        			</div>
    		</div>
        <!-- \#header -->

            
    
        <div id="main" class=" aui-page-panel">
                        <div id="main-header">
                        
    <div id="navigation" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                            
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action aui-dropdown2-trigger-arrowless aui-button aui-button-subtle ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-label="More options" aria-owns="action-menu" data-container="#navigation">
            <span>
                                    <span class="aui-icon aui-icon-small aui-iconfont-more" aria-label="More options"></span>
                                
            </span>
        </a>         <div id="action-menu" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-primary"                         class="section-primary first">
                                                    <li>

    
        
    
                                                        
    
    
            <a  id="view-attachments-link" href="/pages/viewpageattachments.action?pageId=1051986106" rel="nofollow" class="action-view-attachments"  accessKey="t"  title="View Attachments" >
                        <span>
                                A<u>t</u>tachments (0)
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a  id="action-view-history-link" href="/pages/viewpreviousversions.action?pageId=1051986106" rel="nofollow" class="action-view-history"   title="" >
                        <span>
                                Page History
            </span>        </a>
    </li>
                                                <li>

    
            
    
                                                        
    
    
            <a  id="who-can-view-button-ak-button" href="#" rel="nofollow" class="who-can-view-link"   title="" >
                        <span>
                                People who can view
            </span>        </a>
    </li>
                                        </ul>
                </div>
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-secondary"                         class="section-secondary">
                                                    <li>

    
        
    
                                                        
    
    
            <a  id="view-page-info-link" href="/pages/viewinfo.action?pageId=1051986106" rel="nofollow" class="action-view-info"   title="" >
                        <span>
                                Page Information
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a  id="view-in-hierarchy-link" href="/pages/reorderpages.action?key=SECURITY&amp;openId=1051986106#selectedPageInHierarchy" rel="nofollow" class=""   title="" >
                        <span>
                                View in Hierarchy
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a  id="action-view-source-link" href="/plugins/viewsource/viewpagesrc.action?pageId=1051986106" rel="nofollow" class="action-view-source popup-link"   title="" >
                        <span>
                                View Source
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a  id="action-export-word-link" href="/exportword?pageId=1051986106" rel="nofollow" class="action-export-word"   title="" >
                        <span>
                                Export to Word
            </span>        </a>
    </li>
                                        </ul>
                </div>
                    </div>
    </li>
            </ul>
    </div>

            
            <div id="title-heading" class="pagetitle with-breadcrumbs">
                
                                    <div id="breadcrumb-section">
                        
    
    
    <ol id="breadcrumbs">
                                        
                        
        <li class="first" >
                        
                            <span class=""><a href="/collector/pages.action?key=SECURITY">Pages</a></span>
                                                                                    
                        
        <li>
                        
                            <span class=""><a href="/display/SECURITY/Atlassian+Security">Atlassian Security</a></span>
                                                                                    
                        
        <li>
                        
                            <span class=""><a href="/display/SECURITY/Articles">Articles</a></span>
                                                                    </ol>


                    </div>
                
                
        <a href="#page-banner-end" class="assistive">Skip to end of banner</a>
<div id="page-banner-start" class="assistive"></div>

                    
            <div id="page-metadata-banner"><ul class="banner"><li id="system-content-items" class="noprint"><a href="" title="Unrestricted" id="content-metadata-page-restrictions-hidden" class="hidden"></a></li><li class="page-metadata-item noprinthas-button"  id="content-metadata-jira-wrapper"><a href="" title="" id="content-metadata-jira" class="aui-button aui-button-subtle content-metadata-jira tipsy-disabled hidden"><span>Jira links</span></a></li></ul></div>
            

<a href="#page-banner-start" class="assistive">Go to start of banner</a>
<div id="page-banner-end" class="assistive"></div>
    

                <h1 id="title-text" class="with-breadcrumbs">
                                                <a href="/pages/viewpage.action?pageId=1051986106">CVE-2021-26074 - Broken authentication in Atlassian Connect Spring Boot (ACSB)</a>
                                    </h1>
            </div>
        </div><!-- \#main-header -->
        
        

        <div id="sidebar-container">
                                                </div><!-- \#sidebar-container -->

        
    

        




            
    

                                
    

    
    
        
    
    
                    
    

    

    
            
        

    
    

    
            
        



    
<div id="content" class="page view">
    


<div id="action-messages">
                        </div>



            <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
            

        
                            
    

                    

        
        <a href="#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
            <li class="page-metadata-modification-info">
                
        
    
        
    
        
            
            Created by <span class='author'>     <a href="    /display/~amithal@atlassian.com
"
                       class="url fn"
                            >Alisha</a></span>, last modified on <a class='last-modified' title='Show changes' href='/pages/diffpagesbyversion.action?pageId=1051986106&amp;selectedPageVersions=3&amp;selectedPageVersions=4'>May 07, 2021</a>
                </li>
        </ul>
    </div>


<a href="#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>

        
                                            
        <div id="main-content" class="wiki-content">
                           
        <h3 id="CVE202126074BrokenauthenticationinAtlassianConnectSpringBoot(ACSB)-Description"><strong><span style="color: rgb(23,43,77);">Description</span></strong></h3><p>Atlassian Connect Spring Boot is a <a href="https://search.maven.org/search?q=g:com.atlassian.connect AND a:atlassian-connect-spring-boot-starter" class="external-link" rel="nofollow">Java Spring Boot package</a> for building Atlassian Connect apps. Authentication between Atlassian products and the Atlassian Connect Spring Boot app occurs with a server-to-server JWT or a context JWT. Atlassian Connect Spring Boot versions between 1.1.0 - 2.1.2 erroneously accept context JWTs in lifecycle endpoints (such as installation) where only server-to-server JWTs should be accepted, permitting an attacker to send authenticated re-installation events to an app. This is fixed in version 2.1.3.<br/><br/></p><p><strong style="font-size: 16.0px;letter-spacing: -0.006em;">Affected versions</strong></p><ul><li><p><strong>1.1.0 - 2.1.2</strong></p></li></ul><h3 id="CVE202126074BrokenauthenticationinAtlassianConnectSpringBoot(ACSB)-Fixedversions"><strong>Fixed versions</strong></h3><ul><li><p><strong>2.1.3</strong></p></li></ul><h3 id="CVE202126074BrokenauthenticationinAtlassianConnectSpringBoot(ACSB)-Severity"><strong>Severity</strong></h3><p><span style="color: rgb(23,43,77);">This is an independent assessment and you should evaluate its applicability to your own IT environment.</span></p><p>CVSS v3 score: 9.1 =&gt; Critical severity</p><p><strong>Exploitability Metrics</strong></p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 2.0px;"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Attack Vector</th><td class="confluenceTd">Network</td></tr><tr><th class="confluenceTh">Attack Complexity</th><td class="confluenceTd">Low</td></tr><tr><th class="confluenceTh">Privileges Required</th><td class="confluenceTd">Low</td></tr><tr><th class="confluenceTh">User Interaction</th><td class="confluenceTd">None</td></tr></tbody></table></div><p><strong><br/>Scope Metric</strong></p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 2.0px;"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Scope</th><td class="confluenceTd">Changed</td></tr></tbody></table></div><p><strong><br/>Impact Metrics</strong></p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 2.0px;"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Confidentiality</th><td class="confluenceTd">High</td></tr><tr><th class="confluenceTh">Integrity</th><td class="confluenceTd">Low</td></tr><tr><th class="confluenceTh">Availability</th><td class="confluenceTd">Low</td></tr></tbody></table></div><p><a href="https://asecurityteam.bitbucket.io/cvss_v3/#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L" class="external-link" rel="nofollow">https://asecurityteam.bitbucket.io/cvss_v3/#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L</a></p><p><br/></p>

                
        
    
        </div>

                        
    



<div id="labels-section" class="pageSection group">
    <div class="labels-section-content content-column" entityid="1051986106" entitytype="page">
	<div class="labels-content">
		
    <ul class="label-list label-list-right ">
            <li class="no-labels-message">
            No labels
        </li>
            </ul>

    </div>
</div>
</div>
        
		
            




            
        








                        
    
<div id="comments-section" class="pageSection group">
        
    



</div>
        


                
    
            
</div>

    

    




    
    

    
    
    


    
<div id="space-tools-web-items" class="hidden">
                <div data-label="Overview" data-href="/spaces/viewspacesummary.action?key=SECURITY">Overview</div>
            <div data-label="Content Tools" data-href="/pages/reorderpages.action?key=SECURITY">Content Tools</div>
            <div data-label="Apps" data-href="/spaces/scroll-viewport/config.action?key=SECURITY#/list">Apps</div>
    </div>
        



            </div><!-- \#main -->
            
    
    
        
            
            

<div id="footer" role="contentinfo">
    <section class="footer-body">

                                                    
        

        <ul id="poweredby">
            <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link" rel="nofollow">Atlassian Confluence</a> <span id='footer-build-information'>7.4.13</span> <span id='footer-cluster-node'>(i-01159eb0305cac8ff-ipp-10.226.27.95: 51616aeb)</span></li>
            <li class="print-only">Printed by Atlassian Confluence 7.4.13</li>
            <li class="noprint"><a href="https://support.atlassian.com/help/confluence" class="hover-footer-link" rel="nofollow">Report a bug</a></li>
            <li class="noprint"><a href="https://www.atlassian.com/company" class="hover-footer-link" rel="nofollow">Atlassian News</a></li>
        </ul>

        

        <div id="footer-logo"><a href="http://www.atlassian.com/" rel="nofollow">Atlassian</a></div>

                    <!-- 
Google Analytics is no longer embedded directly into CAC pages from this location. We now capture Google Analytics events via Segment IO, a third party analytics service.
Additionally, the Scroll Viewports plugin which is now installed on CAC does not respect the settings in this Custom HTML section, and does its own handling of JS snippets via the custom ADG Brand theme for the Viewport plugin.

As such, I have removed the ga.js API integration from this area, and additionally I have removed the custom GA event tracking which was added in ADM-19936 and ADM-26328.
&lt;3 Joe Clark, 2015-10-19
-->

<script type="text/javascript">
AJS.$("#poweredby").append("<li class='noprint'>" + (getCookie("JSESSIONID") != null ? new RegExp("node\\d").exec(getCookie("JSESSIONID")) : "") + "<li>");

// This logic adds banners to the top of KB articles if they meet the
// KCS banner criteria (see CST-20821). This approach is necessary to reach
// parity with the scrollviewport theme. These banners are only visible
// to Atlassians and contractors after if they are in the necessary Confluence group.
//
// IMPORTANT: To prevent scope leakage, this should be a self executing function.
(function () {
    
    // Helper that injects a new alert at the top of the article's main content.
    function injectAlertMacro(title, content) {
        const newMacro = $(
            '<div class="confluence-information-macro confluence-information-macro-warning conf-macro output-block" data-hasbody="true" data-macro-name="warning">' +
            '   <p class="title" />' +
            '   <span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon" />' +
            '   <div class="confluence-information-macro-body">' +
            '       <p />' +
            '   </div>' +
            '</div>'
        );

        newMacro.find(".title").text(title);
        newMacro.find(".confluence-information-macro-body > p").append(content);
        $('#main-content').prepend(newMacro);
    }

    // Helper that injects a new note at the top of the article's main content.
    function injectNoteMacro(title, content) {
        const newMacro = $(
            '<div class="confluence-information-macro confluence-information-macro-note conf-macro output-block" data-hasbody="true" data-macro-name="note">' +
            '   <p class="title" />' +
            '   <span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" />' +
            '   <div class="confluence-information-macro-body">' +
            '       <p />' +
            '   </div>' +
            '</div>'
        );

        newMacro.find(".title").text(title);
        newMacro.find(".confluence-information-macro-body > p").append(content);
        $('#main-content').prepend(newMacro);
    }

    // Add a variety of banners to the top of a KB article to match the SV theme.
    function addKCSBanners() {
        const labels = $(".aui-label").map(function () {
            return this.innerText.toLowerCase()
        }).toArray();

        let hasKcsLabel = false;
        if (labels && labels.length > 0) {
            for(const label of labels) {
                if (label.startsWith("kcs-")) {
                    hasKcsLabel = true;
                    break;
                }
            }
        }

        if (labels.includes("kcs-archived")) {
            injectNoteMacro(
                "For Atlassian eyes only",
                $("<span>This article is <b>Archived</b> and cannot be shared with customers.</span>")
            )
        } else if (labels.includes("kcs-wip") || labels.includes("kcs-not-validated")) {
            injectNoteMacro(
                "For Atlassian eyes only",
                $("<span>This article is <b>Work In Progress</b> and cannot be shared with customers.</span>")
            )
        } else if (labels.includes("kcs-reviewme")) {
            injectNoteMacro(
                "For Atlassian eyes only",
                $("<span>This article is <b>Not Validated</b> and cannot be shared with customers.</span>")
            )
        } else if($("#content-metadata-page-restrictions.restricted").length > 0 && $("#content-metadata-page-restrictions.aui-iconfont-locked").length > 0) {
            injectNoteMacro(
                "For Atlassian eyes only",
                $("<span>This article is <b>Internal</b> only and cannot be shared with customers.</span>")
            )
        }

        // The KB article has kcs label(s) and at the same time it is external. This should not happen if it happens
        // we need to mark the KB article as Invalid
        if (hasKcsLabel && $("#content-metadata-page-restrictions.restricted").length == 0) {
            injectAlertMacro(
                "For Atlassian eyes only",
                $("<span>This article is in an <b>Invalid</b> state, it is public but has KCS labels. Please remove the labels or restrict visibility to the to the 'ssam-managed-cac-dl-atlassians' group.</span>")
            )
        }

        if (labels.includes("kcs-flagged")) {
            injectAlertMacro(
                "This article requires fixes",
                $("<span>This article has been <b>Flagged</b> for fixing. Use caution when using it and fix it if you have Publisher rights.</span>")
            )
        }
    }

    $(document).ready(function () {
        // Validate that the space key exists and belongs to a KB space.
        const spaceKey = $('meta#confluence-space-key').attr('content');
        if (!(typeof spaceKey === "string") || !spaceKey.toUpperCase().endsWith("KB")) {
            return;
        }

        // Removes the edit labels button within the article draft view
        // https://hello.atlassian.net/browse/CST-23128
        $('#rte-button-labels').remove();

        // Expected SSAM group on CAC
        const cacAtlassianGroup = 'ssam-managed-cac-dl-atlassians';

        // We need to check if the user is in the correct group to view the banner on the KB article
        fetch(`${AJS.contextPath()}/rest/api/user/memberof?key=${AJS.params.remoteUserKey}`, {
            credentials: 'same-origin',
        })
            .then(response => response.json())
            .then(function(data) {
                const groups = data.results;

                for(let i = 0; i < groups.length; i++) {
                    if (groups[i].name === cacAtlassianGroup) {
                        return addKCSBanners();
                    }
                }
            });
    });
})();
</script>
        
    </section>
</div>

    
</div>

</div><!-- \#full-height-container -->
</div><!-- \#page -->

    <span style="display:none;" id="confluence-server-performance">{"serverDuration": 96, "requestCorrelationId": "000931682eb1eb32"}</span>
</body>
</html>
    
