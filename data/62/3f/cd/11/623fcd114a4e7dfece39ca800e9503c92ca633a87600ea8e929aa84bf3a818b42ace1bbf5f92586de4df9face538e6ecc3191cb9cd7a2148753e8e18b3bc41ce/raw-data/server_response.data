<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag -->
<title>OLED Side Channel - Summary October 2019 | invd blog</title>
<meta name="generator" content="Jekyll" />
<meta property="og:title" content="OLED Side Channel - Summary October 2019" />
<meta name="author" content="Christian Reitter" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="During security research in April 2019, I have discovered that the common OLED SSD1306-like displays used in many cryptocurrency hardware wallets and other embedded devices are leaking information about the display contents towards the USB interface from which the device is powered. This represents an interesting side channel that had so far not been discovered by other vendors and researchers." />
<meta property="og:description" content="During security research in April 2019, I have discovered that the common OLED SSD1306-like displays used in many cryptocurrency hardware wallets and other embedded devices are leaking information about the display contents towards the USB interface from which the device is powered. This represents an interesting side channel that had so far not been discovered by other vendors and researchers." />
<link rel="canonical" href="https://blog.inhq.net/posts/oled-side-channel-status-summary/" />
<meta property="og:url" content="https://blog.inhq.net/posts/oled-side-channel-status-summary/" />
<meta property="og:site_name" content="invd blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-29T19:41:49+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="OLED Side Channel - Summary October 2019" />
<script type="application/ld+json">
{"description":"During security research in April 2019, I have discovered that the common OLED SSD1306-like displays used in many cryptocurrency hardware wallets and other embedded devices are leaking information about the display contents towards the USB interface from which the device is powered. This represents an interesting side channel that had so far not been discovered by other vendors and researchers.","@type":"BlogPosting","datePublished":"2019-10-29T19:41:49+01:00","url":"https://blog.inhq.net/posts/oled-side-channel-status-summary/","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.inhq.net/posts/oled-side-channel-status-summary/"},"author":{"@type":"Person","name":"Christian Reitter"},"headline":"OLED Side Channel - Summary October 2019","dateModified":"2019-10-29T19:41:49+01:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.inhq.net/feed.xml" title="invd blog" /><script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  _paq.push(['setSecureCookie', true]);
  _paq.push(['setVisitorCookieTimeout', 60 * 60 * 24 * 90]);
  _paq.push(['setReferralCookieTimeout', 60 * 60 * 24 * 90]);
  _paq.push(['appendToTrackingUrl', 'bots=1']);
  (function() {
    var u="https://mato.inhq.net/";
    _paq.push(['setTrackerUrl', u+'m']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'mat.js'; s.parentNode.insertBefore(g,s);
  })();
  </script></head>
<body><header class="site-header"><noscript><img src="https://mato.inhq.net/m?rec=1&bots=1&idsite=1" alt="" style="position:absolute; visibility:hidden" /></noscript><div class="wrapper"><a class="site-title" rel="author" href="/">invd blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
        <a class="page-link" href="/archive/">Archive</a><a class="page-link" href="/cve/">CVEs</a><a class="page-link" href="/consulting/">Consulting</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">OLED Side Channel - Summary October 2019</h1>
    <p class="post-meta"><time class="dt-published" datetime="2019-10-29T19:41:49+01:00" itemprop="datePublished">
        Oct 29, 2019
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Christian Reitter</span></span><br/>ID:
        
          
          <span>CVE-2019-14353</span>,
          
          <span>CVE-2019-14354</span>,
          
          <span>CVE-2019-14355</span>,
          
          <span>CVE-2019-14356</span>,
          
          <span>CVE-2019-14357</span>,
          
          
          <span title="CVE-2019-14358,CVE-2019-14359,CVE-2019-14360,CVE-2019-18673">[...]</span>
        <br/>
      Related articles:
      <a href="/posts/oled-side-channel-part2/">OLED Side Channel Observations and Mitigation</a>
          </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>During security research in April 2019, I have discovered that the common OLED SSD1306-like displays used in many cryptocurrency hardware wallets and other embedded devices are <b>leaking information</b> about the display contents towards the USB interface from which the device is powered. 
This represents an interesting side channel that had so far not been discovered by other vendors and researchers.</p>

<div id="toc-container">
  <h2 class="no_toc">Contents</h2>
<ul id="markdown-toc">
  <li><a href="#consulting" id="markdown-toc-consulting">Consulting</a></li>
  <li><a href="#technical-background" id="markdown-toc-technical-background">Technical background</a></li>
  <li><a href="#security-implications-attack-scenario-mitigations" id="markdown-toc-security-implications-attack-scenario-mitigations">Security implications, attack scenario, mitigations</a>    <ul>
      <li><a href="#practical-impact" id="markdown-toc-practical-impact">Practical impact</a></li>
    </ul>
  </li>
  <li><a href="#disclosure-coordination" id="markdown-toc-disclosure-coordination">Disclosure Coordination</a>    <ul>
      <li><a href="#cves" id="markdown-toc-cves">CVEs</a></li>
      <li><a href="#detailed-timeline" id="markdown-toc-detailed-timeline">Detailed timeline</a></li>
      <li><a href="#bug-bounty" id="markdown-toc-bug-bounty">Bug bounty</a></li>
      <li><a href="#acknowledgements" id="markdown-toc-acknowledgements">Acknowledgements</a></li>
    </ul>
  </li>
</ul>

</div>

<h2 id="consulting">Consulting</h2>

<p><i>I’m a freelance Security Consultant and currently available for new projects.
  If you are looking for assistance to secure your projects or organization, <a href="/consulting">get in touch</a>.</i></p>

<h2 id="technical-background">Technical background</h2>
<p>Illuminating the OLED pixels takes a comparably large amount of current per pixel and this type of display illuminates pixels on a line-by-line basis. As a result, there is a strong electrical side channel for the display contents through the current fluctuations on the USB power line that can be measured without hardware modifications to the device itself.</p>

<p>Here is a graphical representation of the effect on an unmodified KeepKey, traced over 2½ display cycles:</p>

<figure role="group">
<img src="/assets/images/resized/600/sca_keepkey_oled_graph_keepkey_schema1.jpg" alt="KeepKey device and oscilloscope trace with corresponding OLED screen overlay" srcset="    /assets/images/resized/600/sca_keepkey_oled_graph_keepkey_schema1.jpg 600w,    /assets/images/resized/1150/sca_keepkey_oled_graph_keepkey_schema1.jpg 1150w, /assets/images/sca_keepkey_oled_graph_keepkey_schema1.jpg 1328w" sizes="(min-width: 1150px) 1150px, (min-width: 600px) 600px" class="" />
<figcaption>KeepKey device and oscilloscope trace with corresponding OLED screen overlay</figcaption>
</figure>

<h2 id="security-implications-attack-scenario-mitigations">Security implications, attack scenario, mitigations</h2>
<p>The side channel is relevant since the security design of this class of devices is built to some degree on the assumption that the display contents are readable by the user, but unreadable to other involved electronics. If this confidentiality assumption does not hold in practice, there is the possibility that malicious equipment is able to recover significant portions of PIN codes or BIP39 mnemonic words.</p>

<p>Many of the relevant technical aspects and implications are described in the <a href="https://blog.trezor.io/details-of-the-oled-vulnerability-and-its-mitigation-d331c4e2001a">Trezor blog article on the issue</a> that I have co-written.</p>

<p>I will present more details and attack scenario considerations via additions to this post and later articles.</p>

<h3 id="practical-impact">Practical impact</h3>
<p>Power analysis shows this correlation on the BIP39 secret word display of the Trezor One.</p>

<p><code>weird</code> (yellow) vs. <code>cram</code> (orange):</p>

<figure role="group">
<img src="/assets/images/resized/600/sca_t1_oled_graph_mnemonic_1.jpg" alt="" srcset="    /assets/images/resized/600/sca_t1_oled_graph_mnemonic_1.jpg 600w, /assets/images/sca_t1_oled_graph_mnemonic_1.jpg 1024w" sizes="(min-width: 1150px) 1150px, (min-width: 600px) 600px" class="" />
<figcaption></figcaption>
</figure>

<p><br />
<code>weird</code> (yellow) vs. <code>zoo</code> (orange):</p>

<figure role="group">
<img src="/assets/images/resized/600/sca_t1_oled_graph_mnemonic_2.jpg" alt="" srcset="    /assets/images/resized/600/sca_t1_oled_graph_mnemonic_2.jpg 600w,    /assets/images/resized/1150/sca_t1_oled_graph_mnemonic_2.jpg 1150w, /assets/images/sca_t1_oled_graph_mnemonic_2.jpg 1529w" sizes="(min-width: 1150px) 1150px, (min-width: 600px) 600px" class="" />
<figcaption></figcaption>
</figure>

<p><br />
<code>century</code> (yellow) vs. <code>cram</code> (orange):</p>

<figure role="group">
<img src="/assets/images/resized/600/sca_t1_oled_graph_mnemonic_3.jpg" alt="" srcset="    /assets/images/resized/600/sca_t1_oled_graph_mnemonic_3.jpg 600w,    /assets/images/resized/1150/sca_t1_oled_graph_mnemonic_3.jpg 1150w, /assets/images/sca_t1_oled_graph_mnemonic_3.jpg 1600w" sizes="(min-width: 1150px) 1150px, (min-width: 600px) 600px" class="" />
<figcaption></figcaption>
</figure>

<h2 id="disclosure-coordination">Disclosure Coordination</h2>
<p>From April to August 2019, I’ve analyzed a number of devices for their susceptibility to this attack and responsibly disclosed the issue to the affected vendors. Coordinating the disclosure of a hardware vulnerability among multiple competing vendors is not a straightforward process and there were a number of challenges along the way. I may write about them at some point in the future.</p>

<h3 id="cves">CVEs</h3>
<p>I initially requested a CVE ID from MITRE in July.</p>

<p>Due to <a href="https://cve.mitre.org/cve/cna/rules.html#Appendix_C_counting_decisions">CVE Numbering Authority rules</a>, the vulnerability was split into individual CVEs on a per-vendor basis:</p>

<table>
  <thead>
    <tr>
      <th>CVE</th>
      <th>product</th>
      <th>notes</th>
      <th>vendor reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CVE-2019-14353</td>
      <td><b>SatoshiLabs Trezor One</b></td>
      <td> </td>
      <td><a href="https://blog.trezor.io/details-of-the-oled-vulnerability-and-its-mitigation-d331c4e2001a">article</a></td>
    </tr>
    <tr>
      <td>CVE-2019-14354</td>
      <td><b>Ledger Nano S</b>, <b>Ledger Nano X</b></td>
      <td> </td>
      <td><a href="https://donjon.ledger.com/oled-vuln/">article</a></td>
    </tr>
    <tr>
      <td>CVE-2019-14355</td>
      <td><b>ShapeShift KeepKey</b></td>
      <td> </td>
      <td><a href="https://medium.com/shapeshift-stories/shapeshift-security-update-5b0dd45c93db">article</a></td>
    </tr>
    <tr>
      <td>CVE-2019-14356</td>
      <td><b>Coldcard MK1</b>, <b>Coldcard MK2</b></td>
      <td> </td>
      <td><a href="https://blog.coinkite.com/noise-troll/">article</a></td>
    </tr>
    <tr>
      <td>CVE-2019-14357</td>
      <td><b>Mooltipass Mini</b></td>
      <td> </td>
      <td><a href="https://github.com/limpkin/mooltipass/blob/master/CVE-2019-14357_statement.md">article</a></td>
    </tr>
    <tr>
      <td>CVE-2019-14358</td>
      <td><b>Archos Safe-T</b></td>
      <td> </td>
      <td>-</td>
    </tr>
    <tr>
      <td>CVE-2019-14359</td>
      <td><b>REAL Security BC Vault One</b></td>
      <td><i>minor security impact due to lack of secrets on the screen</i></td>
      <td><a href="https://bc-vault.com/2019/08/our-response-to-cve-2019-14359">article</a></td>
    </tr>
    <tr>
      <td>CVE-2019-14360</td>
      <td><b>Hyundai-Pay Kasse HK-1000</b></td>
      <td> </td>
      <td>-</td>
    </tr>
    <tr>
      <td>CVE-2019-18673</td>
      <td><b>Shift Cryptosecurity BitBox02</b></td>
      <td> </td>
      <td><a href="https://shiftcrypto.ch/bitbox02/threat-model/#non-invasive-attacks">reference</a></td>
    </tr>
  </tbody>
</table>

<h4 id="other-products">Other products</h4>
<p>There are at least two additional products that may be affected in some form, but the vendors have not shown any interest in the issue.</p>

<h3 id="detailed-timeline">Detailed timeline</h3>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-04-08</td>
      <td>Information leak first discovered during Trezor One research</td>
    </tr>
    <tr>
      <td>2019-04-08</td>
      <td>Initial disclosure to SatoshiLabs</td>
    </tr>
    <tr>
      <td>2019-04-29</td>
      <td>Received KeepKey hardware</td>
    </tr>
    <tr>
      <td>2019-05-02</td>
      <td>Initial disclosure to ShapeShift (KeepKey)</td>
    </tr>
    <tr>
      <td>2019-05-04</td>
      <td>First communication attempt with Archos</td>
    </tr>
    <tr>
      <td>2019-05-07</td>
      <td>Initial disclosure to Ledger for Nano S, reference to Nano X</td>
    </tr>
    <tr>
      <td>2019-05-08</td>
      <td>Initial disclosure to Mooltipass</td>
    </tr>
    <tr>
      <td>2019-05-08</td>
      <td>Initial disclosure to Coinkite</td>
    </tr>
    <tr>
      <td>2019-05-09</td>
      <td>Initial disclosure to REAL Security</td>
    </tr>
    <tr>
      <td>2019-05-12</td>
      <td>First communication attempt with Hyundai-Pay</td>
    </tr>
    <tr>
      <td>2019-05-15</td>
      <td>Ledger informed of initial Nano X results</td>
    </tr>
    <tr>
      <td>2019-05-29</td>
      <td>Ledger requests 90 days embargo (starting from early May)</td>
    </tr>
    <tr>
      <td>2019-07-23</td>
      <td>CVE assignment requested</td>
    </tr>
    <tr>
      <td>2019-07-28</td>
      <td>CVEs assigned by MITRE</td>
    </tr>
    <tr>
      <td>2019-08-07 12:00h CEST</td>
      <td>End of the coordinated embargo date, public disclosure</td>
    </tr>
  </tbody>
</table>

<p><i>This list is incomplete and will be extended</i>.</p>

<h3 id="bug-bounty">Bug bounty</h3>
<p>SatoshiLabs and Ledger have provided a bug bounty.</p>

<h3 id="acknowledgements">Acknowledgements</h3>

<h4 id="hardware">Hardware</h4>
<p>During this research, I have received a test device from the following vendors:</p>
<ul>
  <li>1x Nano X from Ledger</li>
  <li>1x BC Vault from REAL Security</li>
  <li>1x Mooltipass from Stephan Electronics</li>
  <li>1x BitBox02 from Shift Cryptosecurity</li>
</ul>

<p>This was done mainly to speed up the analysis on devices with slow shipping or difficult availability.</p>

<p>Relevant hardware gifts from previous research:</p>
<ul>
  <li>SatoshiLabs - multiple Trezor One devices</li>
  <li>ShapeShift - 3x KeepKey devices (part of a previous bug bounty)</li>
</ul>

  </div>


  <a class="u-url" href="/posts/oled-side-channel-status-summary/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half"><ul class="contact-list">
          <li class="p-name">
            <b>Christian Reitter</b>
          </li></ul></div>

      <div class="footer-col one-half">
        <p>Information security and other interests.</p>
      </div>
    </div>

    <div class="social-ref"><ul class="social-ref-list"><li><a rel="me" href="https://github.com/invd" title="invd"><svg class="svg-icon grey"><use xlink:href="/assets/minima-icons.svg#github"></use></svg></a></li><li><a href="/feed.xml" title="rss"><svg class="svg-icon grey"><use xlink:href="/assets/minima-icons.svg#rss"></use></svg></a></li></ul>
</div>

  </div>
</footer>
</body>

</html>
