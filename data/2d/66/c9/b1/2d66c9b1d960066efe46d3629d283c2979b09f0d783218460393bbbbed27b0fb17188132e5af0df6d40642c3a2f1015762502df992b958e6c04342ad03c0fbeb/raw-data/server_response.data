<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1303418 - (CVE-2016-9064) Addons update must verify IDs match between current and update versions">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1303418">
<meta property="og:description"
      content="VERIFIED (andrew.swan) in Toolkit - Add-ons Manager. Last updated 2017-09-21.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1303418 - (CVE-2016-9064) Addons update must verify IDs match between current and update versions</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1303418&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1303418">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1303418">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/yui.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/global.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/util.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox51\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr45\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox49\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox52\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox50\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"tracking\":{\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox50\":\"+\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox52\":\"+\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox_esr45\":\"50+\",\"cf_tracking_firefox49\":\"+\",\"cf_status_firefox49\":\"wontfix\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr45\":\"verified\",\"cf_status_firefox52\":\"verified\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox50\":\"verified\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox51\":\"verified\",\"cf_tracking_firefox51\":\"+\",\"cf_status_thunderbird_esr91\":\"---\"},\"project\":{\"cf_root_cause\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_tracking_firefox_sumo\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1303418;
  BUGZILLA.bug_title = '1303418 - (CVE-2016-9064) Addons update must verify IDs match between current and update versions';
  BUGZILLA.bug_summary = 'Addons update must verify IDs match between current and update versions';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1303418';
  BUGZILLA.bug_keywords = 'addon-compat, sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/field.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/comments.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1303418">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1303418"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1303418 - (CVE-2016-9064) Addons update must verify IDs match between current and update versions">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="ieUZU8d2kiHGJYOREPdyOf46GzoXhT1hubwk1jPDHnr6jY941jrKLTfNNISylF9jDs6BSsKPiOKSivaX8iyQYpUYxyIL7QNajX3lAPaqIEMTXxhDcmY0PG18d0o3xvG6redrW31x9ku6VXLRpEso6Y4oEWR0stmSSk4q2C9Whs9b4EHWyR7nhXvglBBbrUX1iLDpQyaaLyYDh4n3ujLsR4NLnbFeBhVO6N9i3aYfpFFJJ7JJUXfxeIUPxq1DtNG6">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1303418" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623054-SlTPV48OMJXbCdWGko3PwFW4DTm_jewjxkymCv1nDGE">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1303418" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1303418" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1303418">Bug 1303418</a>
          <span class="edit-hide">(CVE-2016-9064)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2016-09-16 11:46 PDT" data-time="1474051580">5 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2016-09-23 03:26 PDT" data-time="1474626365">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Addons update must verify IDs match between current and update versions</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Addons update must verify IDs match between current and update versions

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Toolkit :: Add-ons Manager, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Toolkit
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Toolkit</div>
            <div class="description">The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. (<a href="https://wiki.mozilla.org/Modules/Toolkit">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Add-ons Manager
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Toolkit :: Add-ons Manager</div>
            <div class="description">The management and update windows for extensions and themes (add-ons).</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Add-ons%20Manager&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Add-ons%20Manager&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit&amp;component=Add-ons%20Manager"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit" data-component="Add-ons Manager"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            critical

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox52&quot;:&quot;verified&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_status_firefox50&quot;:&quot;verified&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;P1&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;id&quot;:1303418,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox51&quot;:&quot;+&quot;,&quot;cf_status_firefox51&quot;:&quot;verified&quot;,&quot;keywords&quot;:[&quot;addon-compat&quot;,&quot;sec-high&quot;],&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_tracking_firefox50&quot;:&quot;+&quot;,&quot;flags&quot;:[{&quot;name&quot;:&quot;needinfo&quot;,&quot;status&quot;:&quot;?&quot;},{&quot;name&quot;:&quot;in-testsuite&quot;,&quot;status&quot;:&quot;+&quot;}],&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox52&quot;:&quot;+&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla52&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr45&quot;:&quot;verified&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox49&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox49&quot;:&quot;+&quot;,&quot;cf_tracking_firefox_esr45&quot;:&quot;50+&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla52

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox49</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox49&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr45</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=50%2B">50+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox50</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox51</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox51&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox52</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox49</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox49-dirty">
  <select id="cf_tracking_firefox49" name="cf_tracking_firefox49">
        <option value="+"
          id="v2778_cf_tracking_firefox49" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox49-dirty">
  <select id="cf_status_firefox49" name="cf_status_firefox49">
        <option value="wontfix"
          id="v2786_cf_status_firefox49" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr45</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr45-dirty">
  <select id="cf_tracking_firefox_esr45" name="cf_tracking_firefox_esr45">
        <option value="50+"
          id="v2694_cf_tracking_firefox_esr45" selected
        >50+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr45-dirty">
  <select id="cf_status_firefox_esr45" name="cf_status_firefox_esr45">
        <option value="verified"
          id="v2549_cf_status_firefox_esr45" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox50</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox50-dirty">
  <select id="cf_tracking_firefox50" name="cf_tracking_firefox50">
        <option value="+"
          id="v2833_cf_tracking_firefox50" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox50-dirty">
  <select id="cf_status_firefox50" name="cf_status_firefox50">
        <option value="verified"
          id="v2842_cf_status_firefox50" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox51</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox51-dirty">
  <select id="cf_tracking_firefox51" name="cf_tracking_firefox51">
        <option value="+"
          id="v2901_cf_tracking_firefox51" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox51-dirty">
  <select id="cf_status_firefox51" name="cf_status_firefox51">
        <option value="verified"
          id="v2911_cf_status_firefox51" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox52</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox52-dirty">
  <select id="cf_tracking_firefox52" name="cf_tracking_firefox52">
        <option value="+"
          id="v2960_cf_tracking_firefox52" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox52-dirty">
  <select id="cf_status_firefox52" name="cf_status_firefox52">
        <option value="verified"
          id="v2970_cf_status_firefox52" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: jvehent, Assigned: aswan, NeedInfo)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_561655" ><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=561655" > <span class="fna">aswan</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-hide" id="field-qa_contact"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact"><div class="vcard vcard_1689" ><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_469465" ><img src="https://secure.gravatar.com/avatar/b9b9662b5c966927b5cbff7f42bf323e?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email disabled" href="/user_profile?user_id=469465" > <span class="fna">jvehent</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_372685" ><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=372685" > <span class="fna">mixedpuppy</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-hide"
>
    <div class="name">NeedInfo From:
    </div>


  
    <div class=" container"><div class="flags edit-hide">
        <div class="flag"><div class="vcard vcard_600837" ><a class="email " href="/user_profile?user_id=600837" > <span class="fna">sheikhnuman78</span></a>
</div>
            <a href="#c44"
            class=" activity-ref"
          ><span class="rel-time" title="2017-08-22 16:18 PDT" data-time="1503443932">4 years ago</span></a>
        </div>
  </div>
    </div>

  
</div><div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo" id="-help-link" class="help">NeedInfo:
        </a>
    </div>


  
    <div class=" container">
        <button type="button" id="needinfo-scroll" class="secondary">Update</button>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="23">23 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ESR-45/Tor Browser certificate pinning bypass for addons.mozilla.org and other built-in sites"
   href="/show_bug.cgi?id=1303127">CVE-2016-5284</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Unlisted add-ons susceptible to MITM attack over HTTPS when updateKey not used"
   href="/show_bug.cgi?id=1304117">1304117</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Remove built-in certificate requirement for addon updates (no security updates for corporate or AntiVirus users)"
   href="/show_bug.cgi?id=1308251">CVE-2020-12421</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1303418&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1303418">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: addon-compat, sec-high, Whiteboard: [adv-main50+][adv-esr45.5+] triaged)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2016-9064

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=addon-compat&amp;resolution=---">addon-compat</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main50+][adv-esr45.5+] triaged
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c35"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1474909107"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1461240">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1461240-dirty">
      <select id="flag-1461240" name="flag-1461240"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files, 4 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8792131">quick hack</a>
        </div>
        <div>
            <a href="#c2" class="attach-time activity-ref"><span class="rel-time" title="2016-09-16 15:01 PDT" data-time="1474063282">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">5.10 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8792131&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8792131&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792131">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8792164">quick hack</a>
        </div>
        <div>
            <a href="#c6" class="attach-time activity-ref"><span class="rel-time" title="2016-09-16 16:43 PDT" data-time="1474069404">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">16.52 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8792164&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8792164&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792164">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8792595">Don't allow upgrades that change the addon ID</a>
        </div>
        <div>
            <a href="#c11" class="attach-time activity-ref"><span class="rel-time" title="2016-09-19 11:02 PDT" data-time="1474308157">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">30.03 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8792595&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8792595&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792595">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8792645">Don't allow upgrades that change the addon ID</a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2016-09-19 13:25 PDT" data-time="1474316748">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">36.31 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_91159" ><span class="fn">mossop</span>
</div>:
              <a href="#a266627_91159"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1474316748"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8792645&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8792645&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792645">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8792666">Don't allow upgrades that change the addon ID</a>
        </div>
        <div>
            <a href="#c17" class="attach-time activity-ref"><span class="rel-time" title="2016-09-19 14:14 PDT" data-time="1474319676">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">36.22 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_561655" ><span class="fn">aswan</span>
</div>:
              <a href="#a268148_561655"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1474319728"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_506302" ><span class="fn">gchang</span>
</div>:
              <a href="#c37"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1474662367"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a511016_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1474388907"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8792666&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8792666&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792666">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8794374">Don't allow upgrades that change the addon ID</a>
        </div>
        <div>
            <a href="#c31" class="attach-time activity-ref"><span class="rel-time" title="2016-09-23 13:21 PDT" data-time="1474662108">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">35.36 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1474662522"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8794374&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8794374&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8794374">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8795925">Don't allow upgrades that change the addon ID</a>
        </div>
        <div>
            <a href="#c39" class="attach-time activity-ref"><span class="rel-time" title="2016-09-28 15:59 PDT" data-time="1475103548">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div></span>
        </div>
        <div class="attach-info">35.30 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_451704" ><span class="fn">lizzard</span>
</div>:
              <a href="#c41"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1475103600"
            >
              approval-mozilla-esr45+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8795925&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8795925&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8795925">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="b6Ak5y7Mfq48dW3K1p0L2TAmPAC0cPtYKx0b8Z1h8pnlwn8t">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="11716029" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_469465" ><img src="https://secure.gravatar.com/avatar/b9b9662b5c966927b5cbff7f42bf323e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_469465" ><a class="email disabled" href="/user_profile?user_id=469465" > <span class="fna">Julien Vehent</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 11:46 PDT" data-time="1474051580">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="11716029">&#64;movrcx reported [1] a vulnerability in the addons update process that allows a Man-In-The-Middle attack to replace an installed addon with a fraudulent version. The attacker needs to first obtain a valid signature for a fraudulent addon, which can be done without review, then hijack the call between the user and AMO to replace the response from /update/VersionCheck.php with the IDs of the fraudulent addon.

This attack works because Firefox does not currently verify that the updated addon ID matches the installed addon ID. Adding this check will require the attacker to break into the AMO service or steal the developer access to AMO to sign a fraudulent addon with the same IDs as the target addon.

The ID verification should be implemented in Firefox.

[1] <a rel="nofollow" href="https://hackernoon.com/tor-browser-exposed-anti-privacy-implantation-at-mass-scale-bd68e9eb1e95#.ey0pm84bd">https://hackernoon.com/tor-browser-exposed-anti-privacy-implantation-at-mass-scale-bd68e9eb1e95#.ey0pm84bd</a></pre></div><div class="change-set" id="c1"><div class="comment" data-id="11716427" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" ><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" ><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 14:45 PDT" data-time="1474062314">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="11716427">Is this different, or worse, in 49 than it is in 48?</pre></div><div class="change-set" id="c2"><div class="comment" data-id="11716450" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" ><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 15:01 PDT" data-time="1474063282">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8792131"
         class="attachment patch obsolete"
         data-id="8792131" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content=".">
      <meta itemprop="contentSize" content="5221">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8792131">
          <a class="link" href="attachment.cgi?id=8792131&amp;action=diff">
        <span id="att-8792131-description" itemprop="description">quick hack</span></a> (obsolete)
        — <a href="attachment.cgi?id=8792131&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792131">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-2" data-comment-id="11716450">MozReview-Commit-ID: JHINo8ShmeI</pre></div><div class="change-set" id="c3"><div class="comment" data-id="11716538" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" ><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 15:51 PDT" data-time="1474066294">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="11716538">Support for changing IDs was explicitly added in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Mechanism for changing an extension GUID via updates"
   href="/show_bug.cgi?id=412819">bug 412819</a>, but AMO no longer supports changing IDs (not deliberately anyway).  Consensus (between Andy and me so far) is to remove this support from Firefox rather than try to design a method for securely changing an ID.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="11716553" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_189742" ><img src="https://secure.gravatar.com/avatar/3bd14a58b7b755d332e388e1646ba037?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_189742" ><a class="email " href="/user_profile?user_id=189742" > <span class="fna">Jorge Villalobos [:jorgev] (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 15:57 PDT" data-time="1474066665">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="11716553">AMO has never really supported changing the ID, but it has been possible for non-AMO add-ons through the update mechanism. I don't think that changing IDs is a very common use case, and there are other ways to do it than via automatic updates (at least with legacy APIs), so I also support this change.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="11716563" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" ><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" ><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 16:08 PDT" data-time="1474067331">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="11716563">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8792131" name="attach_8792131" title="quick hack">attachment 8792131</a> <a href="/attachment.cgi?id=8792131&amp;action=edit" title="quick hack">[details]</a> <a href="/attachment.cgi?id=8792131&amp;action=diff" title="quick hack">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792131'>[review]</a>
quick hack

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8792131" name="attach_8792131" title="quick hack">attachment 8792131</a> <a href="/attachment.cgi?id=8792131&amp;action=edit" title="quick hack">[details]</a> <a href="/attachment.cgi?id=8792131&amp;action=diff" title="quick hack">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792131'>[review]</a>:
-----------------------------------------------------------------

Surprised that this is rated so highly, the only way of circumventing I can think of involves either compromising AMO itself or getting a built-in CA to issue you a valid cert for AMO and then MITM.

::: toolkit/mozapps/extensions/internal/XPIProvider.jsm
&#64;&#64; +6641,5 &#64;&#64;
<span class="quote">&gt;    }
&gt;  
&gt;    let install = new AddonInstall(aAddon._installLocation, url,
&gt; +                                 aUpdate.updateHash, releaseNotesURI, aAddon,
&gt; +                                 null, aAddon.id);</span >

No need for the extra parameter, the AddonInstall already has the existing add-on to compare against here.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="11716595" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" ><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" ><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 16:43 PDT" data-time="1474069404">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8792164"
         class="attachment patch obsolete"
         data-id="8792164" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content=".">
      <meta itemprop="contentSize" content="16920">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8792164">
          <a class="link" href="attachment.cgi?id=8792164&amp;action=diff">
        <span id="att-8792164-description" itemprop="description">quick hack</span></a> (obsolete)
        — <a href="attachment.cgi?id=8792164&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792164">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-6" data-comment-id="11716595">MozReview-Commit-ID: JHINo8ShmeI</pre></div><div class="change-set" id="a17828_561655"><div class="change" id="aa17828_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a17828_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a17828_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a17828_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a17828_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a17828_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 16:43 PDT" data-time="1474069408">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792131&amp;action=edit"
           title="quick hack"
           class=""
        >Attachment #8792131</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="11716596" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a17828_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a17828_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 16:46 PDT" data-time="1474069563">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="11716596">The test isn't quite passing yet and I think that this has now orphaned some code that can be pruned as well but here's the work-in-progress before I step away for a little while...</pre></div><div class="change-set" id="a18067_397635"><div class="change" id="aa18067_397635">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a18067_397635"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_397635" id="a18067_397635"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18067_397635"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18067_397635">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a18067_397635">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 16:47 PDT" data-time="1474069647">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: addons-security, client-services-security &rarr; toolkit-core-security</div><div class="change">Component: Security &rarr; Add-ons Manager</div><div class="change">Product: addons.mozilla.org &rarr; Toolkit</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="11716623" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a18067_397635"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a18067_397635"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 17:21 PDT" data-time="1474071685">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="11716623">This patch checks that the downloaded add-on (.xpi) matches the ID of the thing it's supposed to be updating. Would it be worthwhile to check the metadata returned by versioncheck and not even download the thing if it doesn't match?

I mean in addition (multi-layer security); the install-time check is a good thing.

Signed update.rdf responses means it came from us, even if TLS gets MITM'd.
 * prevents changing the hash to match a different add-on
 * prevents changing the download URL to point to a different download server
 (signing these is another set of bugs)

But a MITM could still substitute one signed update.rdf for another
 * version check prevents downgrade attack (I think we do this already)
 * ID check could prevent substitution

Currently the add-on ID doesn't appear in the body of the update.rdf, but it is part of &quot;urn:mozilla:extension:%ADDON-ID%&quot; in the RDF junk. We could pull it out of there, but if we want to do this it might be worth adding &lt;em:id&gt; in the body next to &lt;em:version&gt; to make things easier (Server-side change required).</pre></div><div class="change-set" id="a20122_1689"><div class="change" id="aa20122_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a20122_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a20122_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a20122_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a20122_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a20122_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 17:21 PDT" data-time="1474071702">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a> &rarr; <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c9"><div class="comment" data-id="11716636" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a20122_1689"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a20122_1689"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 17:40 PDT" data-time="1474072851">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="11716636">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c8">comment #8</a>)
<span class="quote">&gt; Currently the add-on ID doesn't appear in the body of the update.rdf, but it
&gt; is part of &quot;urn:mozilla:extension:%ADDON-ID%&quot; in the RDF junk. We could pull
&gt; it out of there, but if we want to do this it might be worth adding &lt;em:id&gt;
&gt; in the body next to &lt;em:version&gt; to make things easier (Server-side change
&gt; required).</span >

We do already ID check the &quot;urn:mozilla:extension:%ADDON-ID%&quot; since that is what allows you to embed update info for multiple add-ons in the same file.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="11716695" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a20122_1689"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a20122_1689"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-16 18:51 PDT" data-time="1474077066">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="11716695">Not sure how much work the id in the RDF is, probably pretty easy. I feel like the better thing to focus on might be <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Add-on update metadata needs to use content-signing"
   href="/show_bug.cgi?id=1303183">bug 1303183</a> though.</pre></div><div class="change-set" id="a95851_1689"><div class="change" id="aa95851_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a95851_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a95851_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a95851_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a95851_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a95851_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-17 14:23 PDT" data-time="1474147431">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">toolkit-core-security</span></div></div></div><div class="change-set" id="a101624_1689"><div class="change" id="aa101624_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a101624_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a101624_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a101624_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a101624_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a101624_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-17 16:00 PDT" data-time="1474153204">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ESR-45/Tor Browser certificate pinning bypass for addons.mozilla.org and other built-in sites"
   href="/show_bug.cgi?id=1303127">CVE-2016-5284</a></div></div></div><div class="change-set" id="c11"><div class="comment" data-id="11720120" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a101624_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a101624_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 11:02 PDT" data-time="1474308157">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8792595"
         class="attachment patch obsolete"
         data-id="8792595" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content=".">
      <meta itemprop="contentSize" content="30755">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8792595">
          <a class="link" href="attachment.cgi?id=8792595&amp;action=diff">
        <span id="att-8792595-description" itemprop="description">Don't allow upgrades that change the addon ID</span></a> (obsolete)
        — <a href="attachment.cgi?id=8792595&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792595">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-11" data-comment-id="11720120">MozReview-Commit-ID: JHINo8ShmeI</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792595&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792595</a> -
        Flags: review?(dtownsend)</div></div></div><div class="change-set" id="a256581_561655"><div class="change" id="aa256581_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a256581_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a256581_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a256581_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a256581_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a256581_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 11:02 PDT" data-time="1474308161">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792164&amp;action=edit"
           title="quick hack"
           class=""
        >Attachment #8792164</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="11720348" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a256581_561655"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a256581_561655"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 12:00 PDT" data-time="1474311631">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="11720348">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8792595" name="attach_8792595" title="Don't allow upgrades that change the addon ID">attachment 8792595</a> <a href="/attachment.cgi?id=8792595&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8792595&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792595'>[review]</a>
Don't allow upgrades that change the addon ID

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8792595" name="attach_8792595" title="Don't allow upgrades that change the addon ID">attachment 8792595</a> <a href="/attachment.cgi?id=8792595&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8792595&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792595'>[review]</a>:
-----------------------------------------------------------------

::: toolkit/mozapps/extensions/internal/XPIProvider.jsm
&#64;&#64; +5820,5 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (this.existingAddon &amp;&amp; this.addon.id != this.existingAddon.id) {
&gt; +      let err = new Error(`Refusing to upgrade addon ${this.existingAddon.id} to new ID {this.addon.id}`);
&gt; +      return Promise.reject([AddonManager.ERROR_INCORRECT_ID, err]);
&gt; +    }</span >

If I'm reading this right then you could potentially fool this by using a multipackage XPI with the right ID which then installs a different add-on. We should probably always reject multipackage XPIs when there is an existing add-on being updated.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792595&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792595</a> -
        Flags: <span class="activity-deleted">review?(dtownsend)</span></div></div></div><div class="change-set" id="c13"><div class="comment" data-id="11720471" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a256581_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a256581_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 12:36 PDT" data-time="1474313762">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="11720471">(In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c12">comment #12</a>)
<span class="quote">&gt; If I'm reading this right then you could potentially fool this by using a
&gt; multipackage XPI with the right ID which then installs a different add-on.
&gt; We should probably always reject multipackage XPIs when there is an existing
&gt; add-on being updated.</span >

Is the concern about a &quot;regular&quot; addon having an upgrade that points to a multipackage xpi?  Or an addon that originally came from a multipackage xpi being upgraded to ... something?
For the first case, the test should fail since this.addon is the multipackage xpi, and its id property will be null or undefined, which won't match the existing addon id.  I can add a test for this, or did I misunderstand the issue?</pre></div><div class="change-set" id="c14"><div class="comment" data-id="11720501" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a256581_561655"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_91159" id="a256581_561655"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 12:43 PDT" data-time="1474314211">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="11720501">(In reply to Andrew Swan [:aswan] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c13">comment #13</a>)
<span class="quote">&gt; (In reply to Dave Townsend [:mossop] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c12">comment #12</a>)
&gt; &gt; If I'm reading this right then you could potentially fool this by using a
&gt; &gt; multipackage XPI with the right ID which then installs a different add-on.
&gt; &gt; We should probably always reject multipackage XPIs when there is an existing
&gt; &gt; add-on being updated.
&gt; 
&gt; Is the concern about a &quot;regular&quot; addon having an upgrade that points to a
&gt; multipackage xpi?  Or an addon that originally came from a multipackage xpi
&gt; being upgraded to ... something?
&gt; For the first case, the test should fail since this.addon is the
&gt; multipackage xpi, and its id property will be null or undefined, which won't
&gt; match the existing addon id.  I can add a test for this, or did I
&gt; misunderstand the issue?</span >

multipackage XPIs don't have to have an ID in the root install.rdf but they can and my brief glance suggests it gets passed all the way through to here, so add a test for that case and then if I'm right fix it so it doesn't work.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="11720603" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a256581_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a256581_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 13:25 PDT" data-time="1474316748">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8792645"
         class="attachment patch obsolete"
         data-id="8792645" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content=".">
      <meta itemprop="contentSize" content="37177">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8792645">
          <a class="link" href="attachment.cgi?id=8792645&amp;action=diff">
        <span id="att-8792645-description" itemprop="description">Don't allow upgrades that change the addon ID</span></a> (obsolete)
        — <a href="attachment.cgi?id=8792645&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792645">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-15" data-comment-id="11720603">MozReview-Commit-ID: JHINo8ShmeI</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792645&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792645</a> -
        Flags: review?(dtownsend)</div></div></div><div class="change-set" id="a265173_561655"><div class="change" id="aa265173_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a265173_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a265173_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a265173_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a265173_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a265173_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 13:25 PDT" data-time="1474316753">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792595&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792595</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a266627_91159"><div class="change" id="aa266627_91159">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_91159" id="a266627_91159"><img src="https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_91159" id="a266627_91159"><a class="email " href="/user_profile?user_id=91159" > <span class="fna">Dave Townsend [:mossop]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a266627_91159"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a266627_91159">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a266627_91159">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 13:50 PDT" data-time="1474318207">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792645&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792645</a> -
        Flags: review?(dtownsend) &rarr; review+</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="11720738" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a266627_91159"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a266627_91159"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 14:10 PDT" data-time="1474319452">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="11720738">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8792645" name="attach_8792645" title="Don't allow upgrades that change the addon ID">attachment 8792645</a> <a href="/attachment.cgi?id=8792645&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8792645&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792645'>[review]</a>
Don't allow upgrades that change the addon ID

[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Quite easily, but this bug is already public and comments in the bug explain the problem clearly.  However, this bug is about adding defense-in-depth so a real exploit would involve other steps, as detailed in the bug description.

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Yes, but see above.

Which older supported branches are affected by this flaw?
This bug has existed for some time, it is present on all currently supported branches.

If not all supported branches, which bug introduced the flaw?

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
The actual code change should be easy to backport, the tests use test code that has been modified recently that may take more effort.

How likely is this patch to cause regressions; how much testing does it need?
The change is simple and straightforward enough that it is unlikely to cause unintended regressions.  The risk is more that somebody somewhere is relying on the previous insecure behavior, but we can handle that if it arises by helping anybody affected to find a supported way to manage addon upgrades.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792645&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792645</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="11720751" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a266627_91159"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a266627_91159"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 14:14 PDT" data-time="1474319676">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8792666"
         class="attachment patch"
         data-id="8792666" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content=".">
      <meta itemprop="contentSize" content="37093">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8792666">
          <a class="link" href="attachment.cgi?id=8792666&amp;action=diff">
        <span id="att-8792666-description" itemprop="description">Don't allow upgrades that change the addon ID</span></a>
        — <a href="attachment.cgi?id=8792666&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8792666">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-17" data-comment-id="11720751">Updated to fix eslint errors

MozReview-Commit-ID: JHINo8ShmeI</pre></div><div class="change-set" id="a268101_561655"><div class="change" id="aa268101_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a268101_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a268101_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a268101_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a268101_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a268101_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 14:14 PDT" data-time="1474319681">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792645&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792645</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8792645&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792645</a> -
        Flags: <span class="activity-deleted">sec-approval?</span></div></div></div><div class="change-set" id="a268148_561655"><div class="change" id="aa268148_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a268148_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a268148_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a268148_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a268148_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a268148_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 14:15 PDT" data-time="1474319728">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: review+</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="11720911" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a268148_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a268148_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-19 15:15 PDT" data-time="1474323354">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11720911"><a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=e2465c50bdeb">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=e2465c50bdeb</a></pre></div><div class="change-set" id="a337200_561655"><div class="change" id="aa337200_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a337200_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a337200_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a337200_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a337200_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a337200_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-20 09:26 PDT" data-time="1474388780">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: <span class="activity-deleted">sec-approval?</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="11722952" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a337200_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a337200_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-20 09:28 PDT" data-time="1474388907">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11722952">Comment on <span class=""><a href="/attachment.cgi?id=8792666" name="attach_8792666" title="Don't allow upgrades that change the addon ID">attachment 8792666</a> <a href="/attachment.cgi?id=8792666&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8792666&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792666'>[review]</a>
Don't allow upgrades that change the addon ID

see <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c16">comment 16</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="11723214" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a337200_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a337200_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-20 11:00 PDT" data-time="1474394447">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="11723214">Dan, I got the impression over the weekend that there was some urgency to this, but bugzilla tells me is needs sec-approval to land.  Note that the bug is already public.
Also, Mossop's earlier comment clarified a bit about the format of update manifests, I'm happy to answer further questions if there are any.</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="11723305" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_579912" id="a337200_561655"><img src="https://secure.gravatar.com/avatar/917af040c424d0ef320ef3a917199775?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_579912" id="a337200_561655"><a class="email " href="/user_profile?user_id=579912" > <span class="fna">Joshua Yabut</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-20 11:28 PDT" data-time="1474396109">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="11723305">I posted a restricted bug about this process and the proposed fix. I think it's important enough to look at before pushing changes. Thanks!

<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Insufficient ID checking of add-ons during the signing (and also auto-update) process"
   href="/show_bug.cgi?id=1304112">https://bugzilla.mozilla.org/show_bug.cgi?id=1304112</a></pre></div><div class="change-set" id="a348445_397635"><div class="change" id="aa348445_397635">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a348445_397635"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_397635" id="a348445_397635"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a348445_397635"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a348445_397635">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a348445_397635">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-20 12:33 PDT" data-time="1474400025">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: triaged</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="11726463" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452035" id="a348445_397635"><img src="https://secure.gravatar.com/avatar/b722826f7bbb8baab22b6699065eb15c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_452035" id="a348445_397635"><a class="email " href="/user_profile?user_id=452035" > <span class="fna">Selena Deckelmann :selenamarie :selena</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-21 10:23 PDT" data-time="1474478626">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="11726463">(In reply to Andrew Swan [:aswan] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c20">comment #20</a>)
<span class="quote">&gt; Dan, I got the impression over the weekend that there was some urgency to
&gt; this, but bugzilla tells me is needs sec-approval to land.  Note that the
&gt; bug is already public.
&gt; Also, Mossop's earlier comment clarified a bit about the format of update
&gt; manifests, I'm happy to answer further questions if there are any.</span >

I pinged Dan about this and he would like to see this uplifted to 50, but it's not urgent for 49 because of HPKP being enabled on the add-on update servers. I'm guessing based on his schedule, he'll get to the sec-review next week. 

Sorry about the undue urgency, and thank you for the patch.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="11726488" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a348445_397635"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a348445_397635"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-21 10:30 PDT" data-time="1474479017">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="11726488">Tracking across current versions.  
If we end up doing a 49.0.1 this may be a candidate for uplift to release, but we should wait for sec approval and maybe test on 50 first.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox49&amp;o1=isnotempty">tracking-firefox49</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox49&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=isnotempty">tracking-firefox50</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox51&amp;o1=isnotempty">tracking-firefox51</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox51&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=isnotempty">tracking-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c24"><div class="comment" data-id="11729946" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a348445_397635"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a348445_397635"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 09:42 PDT" data-time="1474562562">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="11729946">Please go ahead and check in.

I'm not against pushing this to a 49 point release if we're confident in it after testing, but this bug doesn't need to be the trigger for a 49 point release. We'll want this on the ESR branch as well.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=50%2B">50+</a></div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="a511016_1689"><div class="change" id="aa511016_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a511016_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a511016_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a511016_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a511016_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a511016_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 09:43 PDT" data-time="1474562596">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="11730022" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a511016_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a511016_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 09:58 PDT" data-time="1474563513">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="11730022"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/7e4ddc2eb91dc8973ff7ff0b1a56f8fe0d62cacf">https://hg.mozilla.org/integration/mozilla-inbound/rev/7e4ddc2eb91dc8973ff7ff0b1a56f8fe0d62cacf</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418">Bug 1303418</a> Don't allow upgrades that change the addon ID r=mossop</pre></div><div class="change-set" id="c26"><div class="comment" data-id="11730042" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a511016_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a511016_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 10:03 PDT" data-time="1474563792">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="11730042">As of earlier this week, the attached patch applied cleanly to aurora and it was good on try:
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=6b289af413bd&amp;selectedJob=27684834">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=6b289af413bd&amp;selectedJob=27684834</a>

Uplift to beta/release is going to take a little more work, I'll try to have a patch ready to test today.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="11730233" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a511016_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a511016_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 10:52 PDT" data-time="1474566753">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="11730233"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/f162c05861744c9e6125a936fdf2ffcedfd3d68f">https://hg.mozilla.org/integration/mozilla-inbound/rev/f162c05861744c9e6125a936fdf2ffcedfd3d68f</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418">Bug 1303418</a> Follow-up to fix fat-fingered graft r=me</pre></div><div class="change-set" id="c28"><div class="comment" data-id="11730234" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_510726" id="a511016_1689"><img src="https://secure.gravatar.com/avatar/4c5aee4c6938e29b1576314d2de9c6e7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_510726" id="a511016_1689"><a class="email " href="/user_profile?user_id=510726" > <span class="fna">Pulsebot</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 10:52 PDT" data-time="1474566754">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="11730234">Pushed by <a href="mailto:aswan&#64;mozilla.com">aswan&#64;mozilla.com</a>:
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/f162c0586174">https://hg.mozilla.org/integration/mozilla-inbound/rev/f162c0586174</a>
Follow-up to fix fat-fingered graft r=me</pre></div><div class="change-set" id="a550157_1689"><div class="change" id="aa550157_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a550157_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a550157_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a550157_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a550157_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 20:35 PDT" data-time="1474601737">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Unlisted add-ons susceptible to MITM attack over HTTPS when updateKey not used"
   href="/show_bug.cgi?id=1304117">1304117</a></div></div></div><div class="change-set" id="c29"><div class="comment" data-id="11732169" data-no="29"
       data-tags="bugherder">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a550157_1689"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 03:26 PDT" data-time="1474626365">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="11732169"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/7e4ddc2eb91d">https://hg.mozilla.org/mozilla-central/rev/7e4ddc2eb91d</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/f162c0586174">https://hg.mozilla.org/mozilla-central/rev/f162c0586174</a></pre><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2016-09-23 03:26 PDT" data-time="1474626365">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla52</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="11732171" data-no="30"
       data-tags="bugherder">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a550157_1689"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 03:26 PDT" data-time="1474626369">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="11732171"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/7e4ddc2eb91d">https://hg.mozilla.org/mozilla-central/rev/7e4ddc2eb91d</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/f162c0586174">https://hg.mozilla.org/mozilla-central/rev/f162c0586174</a></pre></div><div class="change-set" id="c31"><div class="comment" data-id="11733988" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a550157_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 13:21 PDT" data-time="1474662108">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8794374"
         class="attachment patch"
         data-id="8794374" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="beta-patch">
      <meta itemprop="contentSize" content="36213">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8794374">
          <a class="link" href="attachment.cgi?id=8794374&amp;action=diff">
        <span id="att-8794374-description" itemprop="description">Don't allow upgrades that change the addon ID</span></a>
        — <a href="attachment.cgi?id=8794374&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8794374">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-31" data-comment-id="11733988">MozReview-Commit-ID: JHINo8ShmeI</pre></div><div class="change-set" id="c32"><div class="comment" data-id="11734001" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a550157_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 13:26 PDT" data-time="1474662367">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="11734001">Comment on <span class=""><a href="/attachment.cgi?id=8792666" name="attach_8792666" title="Don't allow upgrades that change the addon ID">attachment 8792666</a> <a href="/attachment.cgi?id=8792666&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8792666&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792666'>[review]</a>
Don't allow upgrades that change the addon ID

Approval Request Comment
[Feature/regressing bug #]:
This is a long-standing bug

[User impact if declined]:
The patch adds extra defense against a particular security vulnerability.  Without the patch, we won't have the extra protection.

[Describe test coverage new/current, TreeHerder]:
Tests are included in the patch

[Risks and why]: 
The changes are confined to the processing of addon upgrades and are unlikely to cause unintended regressions.  The larger risk is if any addon developers are relying on the ability to change addon ids during an upgrade.  As discussed in the bug, this is a risk that the add-ons team judges to be acceptable.

[String/UUID change made/needed]:
n/a</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="11734013" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a550157_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 13:28 PDT" data-time="1474662522">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="11734013">Comment on <span class=""><a href="/attachment.cgi?id=8794374" name="attach_8794374" title="Don't allow upgrades that change the addon ID">attachment 8794374</a> <a href="/attachment.cgi?id=8794374&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8794374&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8794374'>[review]</a>
Don't allow upgrades that change the addon ID

see <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Addons update must verify IDs match between current and update versions"
   href="/show_bug.cgi?id=1303418#c32">comment 32</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8794374&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8794374</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="11737585" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a550157_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-26 08:52 PDT" data-time="1474905142">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="11737585">Comment on <span class=""><a href="/attachment.cgi?id=8794374" name="attach_8794374" title="Don't allow upgrades that change the addon ID">attachment 8794374</a> <a href="/attachment.cgi?id=8794374&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8794374&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8794374'>[review]</a>
Don't allow upgrades that change the addon ID

Sec-high, Beta50+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8794374&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8794374</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="11737782" data-no="35"
       data-tags="bugherder uplift">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a550157_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-26 09:58 PDT" data-time="1474909107">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="11737782"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/27ce6db0b235">https://hg.mozilla.org/releases/mozilla-beta/rev/27ce6db0b235</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite+</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="11738064" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a550157_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-26 11:15 PDT" data-time="1474913742">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="11738064">Hi Andrew, Dan pointed out that esr45 is affected and therefore we will need a patch for uplift to ESR45.5. Please go ahead and nominate that.</pre><div class="activity"><div class="change">Flags: needinfo?(aswan)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="11739162" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_506302" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/58cce0c47d9c6efb7d83bc34b9d79816?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_506302" id="a550157_1689"><a class="email disabled" href="/user_profile?user_id=506302" > <span class="fna">Gerry Chang [:gchang]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-26 17:18 PDT" data-time="1474935490">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="11739162">Comment on <span class=""><a href="/attachment.cgi?id=8792666" name="attach_8792666" title="Don't allow upgrades that change the addon ID">attachment 8792666</a> <a href="/attachment.cgi?id=8792666&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8792666&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8792666'>[review]</a>
Don't allow upgrades that change the addon ID

Sec-high, take it in 51 aurora</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8792666&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8792666</a> -
        Flags: approval-mozilla-aurora? &rarr; approval-mozilla-aurora+</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="11739626" data-no="38"
       data-tags="bugherder uplift">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a550157_1689"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-27 00:09 PDT" data-time="1474960143">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="11739626"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/3a82ff00dbb8">https://hg.mozilla.org/releases/mozilla-aurora/rev/3a82ff00dbb8</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/9911bd94e79f">https://hg.mozilla.org/releases/mozilla-aurora/rev/9911bd94e79f</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c39"><div class="comment" data-id="11745354" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a550157_1689"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a550157_1689"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-28 15:59 PDT" data-time="1475103548">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8795925"
         class="attachment patch"
         data-id="8795925" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="esr45.patch">
      <meta itemprop="contentSize" content="36143">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8795925">
          <a class="link" href="attachment.cgi?id=8795925&amp;action=diff">
        <span id="att-8795925-description" itemprop="description">Don't allow upgrades that change the addon ID</span></a>
        — <a href="attachment.cgi?id=8795925&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1303418&attachment=8795925">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-39" data-comment-id="11745354">This try run is a little wacky (no linux debug build?) but
the updated test in this patch does pass on all the other
platforms.

<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=ad03f80ca99d">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=ad03f80ca99d</a></pre></div><div class="change-set" id="a1052020_561655"><div class="change" id="aa1052020_561655">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a1052020_561655"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_561655" id="a1052020_561655"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1052020_561655"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1052020_561655">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a1052020_561655">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-28 16:00 PDT" data-time="1475103600">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(aswan)</span></div><div class="change">
        <a href="/attachment.cgi?id=8795925&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8795925</a> -
        Flags: approval-mozilla-esr45?</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="11750044" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_522000" id="a1052020_561655"><img src="https://secure.gravatar.com/avatar/ec561b842650e65a4a312f6e5bcae35a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_522000" id="a1052020_561655"><a class="email " href="/user_profile?user_id=522000" > <span class="fna">Vasilica Tamas, QA [:vtamas]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-30 06:50 PDT" data-time="1475243405">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="11750044">Verified as fixed on Firefox 52.0a1 (2016-09-28/29), Firefox 51.0a2 (2016-09-28/29), Firefox 50.0b2 unbranded build (20160926162149) under Windows 10 64-bit, Windows 7 64-bit and Ubuntu 16.04 32-bit. Tested various scenarios and we confirm that the add-on/webextension is not updated to a new version with different ID.

Covered the following cases:
 - unlisted add-on (with id specified in the install.rdf) cannot be updated if the ids don't match 
 - unlisted webext (with id specified in the manifest.json) cannot be updated if the ids don't match
 - unlisted webext (with id NOT specified in the manifest.json) cannot be updated if the ids don't match (webext 1 without id -&gt; webext 2 without id, webext 1 without id -&gt; webext 2 with id)


Based on this testing I am marking this bug as Verified.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a1540591_189742"><div class="change" id="aa1540591_189742">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_189742" id="a1540591_189742"><img src="https://secure.gravatar.com/avatar/3bd14a58b7b755d332e388e1646ba037?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_189742" id="a1540591_189742"><a class="email " href="/user_profile?user_id=189742" > <span class="fna">Jorge Villalobos [:jorgev] (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1540591_189742"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1540591_189742">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a1540591_189742">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-10-04 07:42 PDT" data-time="1475592171">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=addon-compat&amp;resolution=---">addon-compat</a></div></div></div><div class="change-set" id="c41"><div class="comment" data-id="11780160" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a1540591_189742"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a1540591_189742"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-10-12 10:52 PDT" data-time="1476294776">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="11780160">Comment on <span class=""><a href="/attachment.cgi?id=8795925" name="attach_8795925" title="Don't allow upgrades that change the addon ID">attachment 8795925</a> <a href="/attachment.cgi?id=8795925&amp;action=edit" title="Don't allow upgrades that change the addon ID">[details]</a> <a href="/attachment.cgi?id=8795925&amp;action=diff" title="Don't allow upgrades that change the addon ID">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1303418&amp;attachment=8795925'>[review]</a>
Don't allow upgrades that change the addon ID

Sec-high issue, fixed in beta 50, let's take this for esr45.5.0.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8795925&amp;action=edit"
           title="Don't allow upgrades that change the addon ID"
           class=""
        >Attachment #8795925</a> -
        Flags: approval-mozilla-esr45? &rarr; approval-mozilla-esr45+</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="11783515" data-no="42"
       data-tags="bugherder uplift">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1540591_189742"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1540591_189742"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-10-13 11:02 PDT" data-time="1476381747">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="11783515"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr45/rev/00c2b7baaa0b">https://hg.mozilla.org/releases/mozilla-esr45/rev/00c2b7baaa0b</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c43"><div class="comment" data-id="11797448" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_522000" id="a1540591_189742"><img src="https://secure.gravatar.com/avatar/ec561b842650e65a4a312f6e5bcae35a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_522000" id="a1540591_189742"><a class="email " href="/user_profile?user_id=522000" > <span class="fna">Vasilica Tamas, QA [:vtamas]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-10-19 06:17 PDT" data-time="1476883033">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="11797448">Verified as fixed on Firefox 45.4.1 esr tinderbox-build (20161018094221) under Windows 10 64-bit, Ubuntu 16.04 32-bit and Mac OS X 10.10.4. 
Confirm that an add-on/webextension is not updated to a new version with different ID.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a4671754_280903"><div class="change" id="aa4671754_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4671754_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4671754_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4671754_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4671754_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a4671754_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-09 12:28 PST" data-time="1478723334">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: triaged &rarr; [adv-main50+][adv-esr45.5+] triaged</div></div></div><div class="change-set" id="a4754194_280903"><div class="change" id="aa4754194_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4754194_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4754194_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4754194_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4754194_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a4754194_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-10 11:22 PST" data-time="1478805774">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2016-9064</div></div></div><div class="change-set" id="a8405004_1689"><div class="change" id="aa8405004_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a8405004_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a8405004_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8405004_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8405004_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a8405004_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-22 17:29 PST" data-time="1482456584">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Remove built-in certificate requirement for addon updates (no security updates for corporate or AntiVirus users)"
   href="/show_bug.cgi?id=1308251">CVE-2020-12421</a></div></div></div><div class="change-set" id="a28221016_495955"><div class="change" id="aa28221016_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a28221016_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a28221016_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a28221016_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a28221016_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#a28221016_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-09 02:56 PDT" data-time="1502272596">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set ca-600837" id="c44"><div class="comment" data-id="12589676" data-no="44"
       data-tags="spam">
    
    <table class="layout-table change-head " id="ch-44" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600837" id="a28221016_495955"><img src="https://secure.gravatar.com/avatar/0a421cc02e547cab3f4405a5221515ae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600837" id="a28221016_495955"><a class="email " href="/user_profile?user_id=600837" > <span class="fna">Numan Sheikh</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1303418#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-22 16:18 PDT" data-time="1503443932">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags"><span class="comment-tag">spam</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-44"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="sheikhnuman78 [4 years ago]">
            Comment hidden (spam)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-44"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="12589676" style="display:none">a vulnerability in the addons update process that allows a Man-In-The-Middle attack to replace an installed addon with a fraudulent version. The attacker needs to first obtain a valid signature for a fraudulent addon, which can be done without review, then hijack the call between the user and AMO to replace the response from /update/VersionCheck.php with the IDs of the fraudulent addon.

This attack works because Firefox does not currently verify that the updated addon ID matches the installed addon ID. Adding this check will require the attacker to break into the AMO service or steal the developer access to AMO to sign a fraudulent addon with the same IDs as the target addon.

The ID verification should be implemented in Firefox.

[1] <a rel="nofollow" href="http://www.nbalivemobile.net/nba-live-mobile-hack/">http://www.nbalivemobile.net/nba-live-mobile-hack/</a>
[2] <a rel="nofollow" href="http://www.nbalivemobile.net/nba-2k17-hack/">http://www.nbalivemobile.net/nba-2k17-hack/</a></pre><div class="activity" style="display:none"><div class="change">Flags: needinfo?(sheikhnuman78)</div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1303418&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>