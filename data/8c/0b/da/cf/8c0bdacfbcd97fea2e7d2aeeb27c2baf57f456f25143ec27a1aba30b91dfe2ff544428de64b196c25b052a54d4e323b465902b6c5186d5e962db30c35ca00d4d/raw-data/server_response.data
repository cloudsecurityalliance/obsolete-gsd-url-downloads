<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/neutron/+bug/1398779/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1398779 “radvd &gt;= 2.0 blocks router update processing” : Bugs : neutron</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1398779" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1398779/bug.atom" title="Bug 1398779 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="In radvd 2.0+, daemonization code was rewritten, switching from libdaemon's daemon_fork() to Linux daemon() call.

If no logging method (-m option) is passed to radvd, and the default logging method is used (which is L_STDERR_SYSLOG), then daemon() is called with (1, 1) arguments, meaning no chroot (fine) and not closing stderr (left there for logging) (not fine). So execute() call that spawns radvd and expects it to daemonize and return code never actually completes, blocked on stderr.

The ..." />
      <meta property="og:description" content="In radvd 2.0+, daemonization code was rewritten, switching from libdaemon's daemon_fork() to Linux daemon() call.

If no logging method (-m option) is passed to radvd, and the default logging method is used (which is L_STDERR_SYSLOG), then daemon() is called with (1, 1) arguments, meaning no chroot (fine) and not closing stderr (left there for logging) (not fine). So execute() call that spawns radvd and expects it to daemonize and return code never actually completes, blocked on stderr.

The ..." />
    

    
    
      <meta property="og:title" content="Bug #1398779 “radvd &gt;= 2.0 blocks router update processing” : Bugs : neutron" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1398779" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["access-control", "api", "api-ref", "auto-allocated-topology", "baremetal", "db", "deprecation", "dns", "doc", "fullstack", "functional-tests", "fwaas", "gate-failure", "in-stable-icehouse", "ipv6", "l2-pop", "l3-bgp", "l3-dvr-backlog", "l3-ha", "l3-ipam-dhcp", "lbaas", "lib", "linuxbridge", "loadimpact", "logging", "low-hanging-fruit", "metering", "mitaka-backport-potential", "needs-attention", "newton-backport-potential", "newton-rc-potential", "ocata-backport-potential", "ocata-rc-potential", "opnfv", "ops", "ovn", "ovn-octavia-provider", "ovs", "ovs-fw", "ovs-lib", "pike-backport-potential", "py34", "qos", "queens-backport-potential", "rfe", "rfe-approved", "rfe-confirmed", "rfe-postponed", "rfe-triaged", "sg-fw", "sriov-pci-pt", "tempest", "troubleshooting", "trunk", "unittest", "usability", "vpnaas", "xenial"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/neutron/+bug/1398779/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/neutron"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/neutron">neutron</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/neutron">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/neutron">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/neutron">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/neutron">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/neutron">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/neutron">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    radvd &gt;= 2.0 blocks router update processing
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1398779 reported by
      <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka</a>
      <time title="2014-12-03 11:26:52 UTC" datetime="2014-12-03T11:26:52.464008+00:00">on 2014-12-03</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">14</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 2 people</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1726439">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/neutron/+bug/1398779/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1726439">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/neutron">neutron</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/neutron/+bug/1398779/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/neutron/+bug/1398779/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1726439">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ihar-hrachyshka">Ihar Hrachyshka</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/neutron/+milestone/2015.1.0">neutron 2015.1.0 "kilo"</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1726439">
     <td colspan="7"><form action="/neutron/+bug/1398779/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/neutron">neutron</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-12-03 11:26:52 UTC" datetime="2014-12-03T11:26:52.464008+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-12-03 11:59:28 UTC" datetime="2014-12-03T11:59:28.807640+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-12-03 11:27:27 UTC" datetime="2014-12-03T11:27:27.820600+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-12-03 11:59:28 UTC" datetime="2014-12-03T11:59:28.807640+00:00">2014-12-03</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-12-18 14:27:56 UTC" datetime="2014-12-18T14:27:56.858435+00:00">2014-12-18</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="neutron.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="neutron.target.option.package" name="neutron.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="neutron.target.distribution" name="neutron.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="neutron.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="neutron.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="neutron.target.package"
                         name="neutron.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;neutron.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('neutron.target.package');
              var select_menu = Y.DOM.byId('neutron.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-neutron-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": null, "step_title": "Search by name", "header": "Select a package", "vocabulary_filters": [], "show_create_team": false, "input_element": "neutron.target.package", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "DistributionPackage", "show_widget_id": "show-widget-neutron-target-package"};
        var show_widget_id = 'show-widget-neutron-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="neutron.target.option.product" name="neutron.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="neutron" id="neutron.target.product"
                         name="neutron.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;neutron.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('neutron.target.product');
              var select_menu = Y.DOM.byId('neutron.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-neutron-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_assign_me_button": false, "extra_no_results_message": null, "picker_type": "default", "selected_value_metadata": null, "remove_team_text": "Remove team", "selected_value": "neutron", "step_title": "Search", "header": "Select a project", "vocabulary_filters": [], "show_create_team": false, "input_element": "neutron.target.product", "assign_me_text": "Pick me", "remove_person_text": "Remove person", "show_remove_button": false, "vocabulary_name": "Product", "show_widget_id": "show-widget-neutron-target-product"};
        var show_widget_id = 'show-widget-neutron-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="neutron.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="neutron.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="neutron.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="neutron.status" name="neutron.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="neutron.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          neutron 2015.1.0
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="neutron.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="neutron.assignee.assign_to_me" name="neutron.assignee.option" value="neutron.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="neutron.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="neutron.assignee.assigned_to" name="neutron.assignee.option" value="neutron.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="neutron.assignee.assigned_to">
              Ihar Hrachyshka (ihar-hrachyshka)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="neutron.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="neutron.comment_on_change" name="neutron.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1741198">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/neutron/juno/+bug/1398779/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/neutron/juno">Juno</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/neutron/juno/+bug/1398779/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/neutron/juno/+bug/1398779/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1741198">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ihar-hrachyshka">Ihar Hrachyshka</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/neutron/+milestone/2014.2.2">neutron 2014.2.2</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1741198">
     <td colspan="7"><form action="/neutron/juno/+bug/1398779/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/neutron/juno">neutron juno</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~apevec" class="sprite person">Alan Pevec</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2015-01-07 12:13:08 UTC" datetime="2015-01-07T12:13:08.129919+00:00">2015-01-07</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2015-01-07 12:13:18 UTC" datetime="2015-01-07T12:13:18.665742+00:00">2015-01-07</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2015-01-07 12:13:58 UTC" datetime="2015-01-07T12:13:58.740882+00:00">2015-01-07</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2015-01-07 12:13:18 UTC" datetime="2015-01-07T12:13:18.665742+00:00">2015-01-07</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2015-02-05 15:49:13 UTC" datetime="2015-02-05T15:49:13.259078+00:00">2015-02-05</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="neutron_juno.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="neutron_juno.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="neutron_juno.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="neutron_juno.status" name="neutron_juno.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="neutron_juno.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          neutron 2014.2.2
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="neutron_juno.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="neutron_juno.assignee.assign_to_me" name="neutron_juno.assignee.option" value="neutron_juno.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="neutron_juno.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="neutron_juno.assignee.assigned_to" name="neutron_juno.assignee.option" value="neutron_juno.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="neutron_juno.assignee.assigned_to">
              Ihar Hrachyshka (ihar-hrachyshka)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="neutron_juno.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="neutron_juno.comment_on_change" name="neutron_juno.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/neutron/+bug/1398779/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/neutron/+bug/1398779/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/neutron/+bug/1398779/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>In radvd 2.0+, daemonization code was rewritten, switching from libdaemon&#x27;s daemon_fork() to Linux daemon() call.</p>
<p>If no logging method (-m option) is passed to radvd, and the default logging method is used (which is L_STDERR_SYSLOG), then daemon() is called with (1, 1) arguments, meaning no chroot (fine) and not closing stderr (left there for logging) (not fine). So execute() call that spawns radvd and expects it to daemonize and return code never actually completes, blocked on stderr.</p>
<p>The fix is to pass e.g. -m syslog to radvd to make it close stderr and return.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            Tags:
          </span>
          <span id="tag-list">
            <a class="official-tag" href="/neutron/+bugs?field.tag=ipv6">ipv6</a>
          </span>
          
          <a href="+edit" title="Edit tags" id="tags-trigger" class="sprite edit action-icon">Edit</a>
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
    
    <time title="2014-12-03 11:27:26 UTC" datetime="2014-12-03T11:27:26.747228+00:00">on 2014-12-03</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Ihar Hrachyshka (ihar-hrachyshka)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ihar-hrachyshka" class="sprite person">Ihar Hrachyshka (ihar-hrachyshka)</a>
    
    <time title="2014-12-03 11:59:16 UTC" datetime="2014-12-03T11:59:16.709590+00:00">on 2014-12-03</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: ipv6 juno-backport-potential
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1398779/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-03T11:59:30.544110+00:00" title="2014-12-03 11:59:30 UTC">on 2014-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1398779/comments/1">
                <strong>Fix proposed to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1398779/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.openstack.org/138688">https:/<wbr />/review.<wbr />openstack.<wbr />org/138688</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: master
Review: https://review.openstack.org/138688</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~salvatore-orlando" class="sprite person">Salvatore Orlando (salvatore-orlando)</a>
    
    <time title="2014-12-08 16:23:38 UTC" datetime="2014-12-08T16:23:38.757358+00:00">on 2014-12-08</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; kilo-1
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1398779/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-13T07:46:29.890733+00:00" title="2014-12-13 07:46:29 UTC">on 2014-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1398779/comments/2">
                <strong>Fix merged to neutron (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1398779/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/138688">https:/<wbr />/review.<wbr />openstack.<wbr />org/138688</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=72d41174765540bb7672b545c336fb7aaad075e8">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=72d41174765<wbr />540bb7672b545c3<wbr />36fb7aaad075e8</a><br />
Submitter: Jenkins<br />
Branch:    master</p>
<p>commit 72d41174765540b<wbr />b7672b545c336fb<wbr />7aaad075e8<br />
Author: Ihar Hrachyshka &lt;email address hidden&gt;<br />
Date:   Wed Dec 3 12:44:57 2014 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;radvd: pass -m syslog to avoid thread lock for radvd 2.0+</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since radvd 2.0, the daemon does not use daemon_fork() function from<br />
&nbsp;&nbsp;&nbsp;&nbsp;libdaemon, but instead calls Linux daemon() function directly. It also<br />
&nbsp;&nbsp;&nbsp;&nbsp;passes (1, 1) arguments when logging method (-m) is either stderr (the<br />
&nbsp;&nbsp;&nbsp;&nbsp;default) or stderr_syslog. The second argument&#x27;s value = 1 means that<br />
&nbsp;&nbsp;&nbsp;&nbsp;stderr is not closed and left there for (some) log messages.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For neutron, it means that corresponding execute() call that spawns<br />
&nbsp;&nbsp;&nbsp;&nbsp;radvd and expects the invoked process to close stderr does not ever get<br />
&nbsp;&nbsp;&nbsp;&nbsp;completed. The current thread that spawned radvd is locked waiting for<br />
&nbsp;&nbsp;&nbsp;&nbsp;radvd to exit, which does not ever occur unless the process crashes or<br />
&nbsp;&nbsp;&nbsp;&nbsp;receives a signal.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since L3 agent gives exclusive access to updates queue for each router<br />
&nbsp;&nbsp;&nbsp;&nbsp;to one of processing threads only, it means that the thread that got to<br />
&nbsp;&nbsp;&nbsp;&nbsp;serve a radvd-powered subnet will not proceed and not update any new<br />
&nbsp;&nbsp;&nbsp;&nbsp;ports or other changes to the router anymore.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Passing -m syslog makes radvd 2.0+ close stderr and return to execute()<br />
&nbsp;&nbsp;&nbsp;&nbsp;caller, proceeding with router update processing. The same arguments<br />
&nbsp;&nbsp;&nbsp;&nbsp;should work for old (pre 2.0) versions of radvd too, so passing them<br />
&nbsp;&nbsp;&nbsp;&nbsp;uncondition<wbr />ally.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;We could instead use -m logfile and pass appropriate -l &lt;logfile&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;argument to radvd to make it log to a log file located in router&#x27;s<br />
&nbsp;&nbsp;&nbsp;&nbsp;namespace storage path. Though that would be not in line with what<br />
&nbsp;&nbsp;&nbsp;&nbsp;dnsmasq processes currently do for dhcp agent, where we log all messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;to syslog, so sticking to syslog for radvd for consistency.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I131db0639bc46d<wbr />332ed48faa2bbe6<wbr />8a214264062<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: #1398779</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/138688
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=72d41174765540bb7672b545c336fb7aaad075e8
Submitter: Jenkins
Branch:    master

commit 72d41174765540bb7672b545c336fb7aaad075e8
Author: Ihar Hrachyshka &lt;ihrachys@redhat.com&gt;
Date:   Wed Dec 3 12:44:57 2014 +0100

    radvd: pass -m syslog to avoid thread lock for radvd 2.0+
    
    Since radvd 2.0, the daemon does not use daemon_fork() function from
    libdaemon, but instead calls Linux daemon() function directly. It also
    passes (1, 1) arguments when logging method (-m) is either stderr (the
    default) or stderr_syslog. The second argument's value = 1 means that
    stderr is not closed and left there for (some) log messages.
    
    For neutron, it means that corresponding execute() call that spawns
    radvd and expects the invoked process to close stderr does not ever get
    completed. The current thread that spawned radvd is locked waiting for
    radvd to exit, which does not ever occur unless the process crashes or
    receives a signal.
    
    Since L3 agent gives exclusive access to updates queue for each router
    to one of processing threads only, it means that the thread that got to
    serve a radvd-powered subnet will not proceed and not update any new
    ports or other changes to the router anymore.
    
    Passing -m syslog makes radvd 2.0+ close stderr and return to execute()
    caller, proceeding with router update processing. The same arguments
    should work for old (pre 2.0) versions of radvd too, so passing them
    unconditionally.
    
    We could instead use -m logfile and pass appropriate -l &lt;logfile&gt;
    argument to radvd to make it log to a log file located in router's
    namespace storage path. Though that would be not in line with what
    dnsmasq processes currently do for dhcp agent, where we log all messages
    to syslog, so sticking to syslog for radvd for consistency.
    
    Change-Id: I131db0639bc46d332ed48faa2bbe68a214264062
    Closes-Bug: #1398779
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1398779/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-13T20:06:42.785535+00:00" title="2014-12-13 20:06:42 UTC">on 2014-12-13</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1398779/comments/3">
                <strong>Fix proposed to neutron (stable/juno)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1398779/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/juno<br />
Review: <a rel="nofollow" href="https://review.openstack.org/141575">https:/<wbr />/review.<wbr />openstack.<wbr />org/141575</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/juno
Review: https://review.openstack.org/141575</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-12-18 14:27:55 UTC" datetime="2014-12-18T14:27:55.894304+00:00">on 2014-12-18</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/neutron/+bug/1398779/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-01-05T18:51:56.578094+00:00" title="2015-01-05 18:51:56 UTC">on 2015-01-05</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/neutron/+bug/1398779/comments/4">
                <strong>Fix merged to neutron (stable/juno)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/neutron/+bug/1398779/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/141575">https:/<wbr />/review.<wbr />openstack.<wbr />org/141575</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/neutron/commit/?id=6c490a984af690e732f8b96a18493ac1afef892f">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />neutron/<wbr />commit/<wbr />?id=6c490a984af<wbr />690e732f8b96a18<wbr />493ac1afef892f</a><br />
Submitter: Jenkins<br />
Branch:    stable/juno</p>
<p>commit 6c490a984af690e<wbr />732f8b96a18493a<wbr />c1afef892f<br />
Author: Ihar Hrachyshka &lt;email address hidden&gt;<br />
Date:   Wed Dec 3 12:44:57 2014 +0100</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;radvd: pass -m syslog to avoid thread lock for radvd 2.0+</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since radvd 2.0, the daemon does not use daemon_fork() function from<br />
&nbsp;&nbsp;&nbsp;&nbsp;libdaemon, but instead calls Linux daemon() function directly. It also<br />
&nbsp;&nbsp;&nbsp;&nbsp;passes (1, 1) arguments when logging method (-m) is either stderr (the<br />
&nbsp;&nbsp;&nbsp;&nbsp;default) or stderr_syslog. The second argument&#x27;s value = 1 means that<br />
&nbsp;&nbsp;&nbsp;&nbsp;stderr is not closed and left there for (some) log messages.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For neutron, it means that corresponding execute() call that spawns<br />
&nbsp;&nbsp;&nbsp;&nbsp;radvd and expects the invoked process to close stderr does not ever get<br />
&nbsp;&nbsp;&nbsp;&nbsp;completed. The current thread that spawned radvd is locked waiting for<br />
&nbsp;&nbsp;&nbsp;&nbsp;radvd to exit, which does not ever occur unless the process crashes or<br />
&nbsp;&nbsp;&nbsp;&nbsp;receives a signal.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since L3 agent gives exclusive access to updates queue for each router<br />
&nbsp;&nbsp;&nbsp;&nbsp;to one of processing threads only, it means that the thread that got to<br />
&nbsp;&nbsp;&nbsp;&nbsp;serve a radvd-powered subnet will not proceed and not update any new<br />
&nbsp;&nbsp;&nbsp;&nbsp;ports or other changes to the router anymore.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Passing -m syslog makes radvd 2.0+ close stderr and return to execute()<br />
&nbsp;&nbsp;&nbsp;&nbsp;caller, proceeding with router update processing. The same arguments<br />
&nbsp;&nbsp;&nbsp;&nbsp;should work for old (pre 2.0) versions of radvd too, so passing them<br />
&nbsp;&nbsp;&nbsp;&nbsp;uncondition<wbr />ally.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;We could instead use -m logfile and pass appropriate -l &lt;logfile&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;argument to radvd to make it log to a log file located in router&#x27;s<br />
&nbsp;&nbsp;&nbsp;&nbsp;namespace storage path. Though that would be not in line with what<br />
&nbsp;&nbsp;&nbsp;&nbsp;dnsmasq processes currently do for dhcp agent, where we log all messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;to syslog, so sticking to syslog for radvd for consistency.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Juno changes:<br />
&nbsp;&nbsp;&nbsp;&nbsp;- tests: we need to construct RouterInfo to get router namespace name.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I131db0639bc46d<wbr />332ed48faa2bbe6<wbr />8a214264062<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: #1398779<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 72d41174765540b<wbr />b7672b545c336fb<wbr />7aaad075e8)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/141575
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=6c490a984af690e732f8b96a18493ac1afef892f
Submitter: Jenkins
Branch:    stable/juno

commit 6c490a984af690e732f8b96a18493ac1afef892f
Author: Ihar Hrachyshka &lt;ihrachys@redhat.com&gt;
Date:   Wed Dec 3 12:44:57 2014 +0100

    radvd: pass -m syslog to avoid thread lock for radvd 2.0+
    
    Since radvd 2.0, the daemon does not use daemon_fork() function from
    libdaemon, but instead calls Linux daemon() function directly. It also
    passes (1, 1) arguments when logging method (-m) is either stderr (the
    default) or stderr_syslog. The second argument's value = 1 means that
    stderr is not closed and left there for (some) log messages.
    
    For neutron, it means that corresponding execute() call that spawns
    radvd and expects the invoked process to close stderr does not ever get
    completed. The current thread that spawned radvd is locked waiting for
    radvd to exit, which does not ever occur unless the process crashes or
    receives a signal.
    
    Since L3 agent gives exclusive access to updates queue for each router
    to one of processing threads only, it means that the thread that got to
    serve a radvd-powered subnet will not proceed and not update any new
    ports or other changes to the router anymore.
    
    Passing -m syslog makes radvd 2.0+ close stderr and return to execute()
    caller, proceeding with router update processing. The same arguments
    should work for old (pre 2.0) versions of radvd too, so passing them
    unconditionally.
    
    We could instead use -m logfile and pass appropriate -l &lt;logfile&gt;
    argument to radvd to make it log to a log file located in router's
    namespace storage path. Though that would be not in line with what
    dnsmasq processes currently do for dhcp agent, where we log all messages
    to syslog, so sticking to syslog for radvd for consistency.
    
    Juno changes:
    - tests: we need to construct RouterInfo to get router namespace name.
    
    Change-Id: I131db0639bc46d332ed48faa2bbe68a214264062
    Closes-Bug: #1398779
    (cherry picked from commit 72d41174765540bb7672b545c336fb7aaad075e8)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-juno
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~apevec" class="sprite person">Alan Pevec (apevec)</a>
    
    <time title="2015-01-07 12:13:25 UTC" datetime="2015-01-07T12:13:25.476870+00:00">on 2015-01-07</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        removed: in-stable-juno juno-backport-potential
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2015-04-30 09:31:50 UTC" datetime="2015-04-30T09:31:50.462695+00:00">on 2015-04-30</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in neutron: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        kilo-1 &#8594; 2015.1.0
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/neutron/+bug/1398779/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/neutron/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/neutron/+bug/1398779/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/neutron/+bug/1398779/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/neutron/+bug/1398779/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/neutron/+bug/1398779/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/neutron/+bug/1398779/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/neutron/+bug/1398779/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/neutron/+bug/1398779/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/neutron/+bug/1398779/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  
  


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1398779", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1398779"}, "information_type_data": {"PUBLIC": {"description": "Everyone can see this information.\n", "name": "Public", "is_private": false, "order": 0, "description_css_class": "choice-description", "value": "PUBLIC"}, "PUBLICSECURITY": {"description": "Everyone can see this security related information.\n", "name": "Public Security", "is_private": false, "order": 1, "description_css_class": "choice-description", "value": "PUBLICSECURITY"}, "USERDATA": {"description": "Only shared with users permitted to see private user information.\n", "name": "Private", "is_private": true, "order": 3, "description_css_class": "choice-description", "value": "USERDATA"}, "PRIVATESECURITY": {"description": "Only the security group can see this information.\n ", "name": "Private Security", "is_private": true, "order": 2, "description_css_class": "choice-description", "value": "PRIVATESECURITY"}}, "total_comments_and_activity": 23, "bug_is_private": false, "related_features": {}, "first visible_recent_comment": -36, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1398779", "web_link": "https://bugs.launchpad.net/bugs/1398779", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1398779, "private": false, "information_type": "Public", "name": null, "title": "radvd \u003e= 2.0 blocks router update processing", "description": "In radvd 2.0+, daemonization code was rewritten, switching from libdaemon's daemon_fork() to Linux daemon() call.\n\nIf no logging method (-m option) is passed to radvd, and the default logging method is used (which is L_STDERR_SYSLOG), then daemon() is called with (1, 1) arguments, meaning no chroot (fine) and not closing stderr (left there for logging) (not fine). So execute() call that spawns radvd and expects it to daemonize and return code never actually completes, blocked on stderr.\n\nThe fix is to pass e.g. -m syslog to radvd to make it close stderr and return.", "owner_link": "https://bugs.launchpad.net/api/devel/~ihar-hrachyshka", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/bug_tasks", "duplicate_of_link": null, "date_created": "2014-12-03T11:26:52.464008+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/subscriptions", "date_last_updated": "2015-04-30T09:31:51.864777+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 14, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/attachments", "security_related": false, "latest_patch_uploaded": null, "tags": ["ipv6"], "date_last_message": "2015-01-05T18:51:56.578094+00:00", "number_of_duplicates": 0, "message_count": 5, "users_affected_count": 2, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/users_unaffected", "users_affected_count_with_dupes": 2, "other_users_affected_count_with_dupes": 2, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1398779/linked_merge_proposals", "http_etag": "\"0474a1995ca8e7fb85ccb7f38f7f5432639876e4-595516a791c8160a19f0c87cc984094c0c63d92a\""}, "bugtask_data": {"1741198": {"assignee_vocabulary": "AllUserTeamsParticipation", "user_can_unassign": false, "bugtask_path": "/neutron/juno/+bug/1398779", "assignee_value": "ihar-hrachyshka", "user_can_edit_status": true, "bug_title": "radvd \u003e= 2.0 blocks router update processing", "user_can_edit_milestone": false, "prefix": "neutron_juno", "form_row_id": "task1741198", "target_is_product": false, "user_can_edit_importance": false, "assignee_is_team": false, "delete_link": "https://bugs.launchpad.net/neutron/juno/+bug/1398779/+delete", "user_can_edit_assignee": false, "milestone_widget_items": "[]", "status_widget_items": "[]", "status_value": "Fix Released", "importance_value": "High", "hide_assignee_team_selection": true, "user_can_delete": false, "row_id": "tasksummary1741198", "assignee_vocabulary_filters": [], "targetname": "neutron juno", "importance_widget_items": "[]", "milestone_value": "https://bugs.launchpad.net/api/devel/neutron/+milestone/2014.2.2", "id": 1741198}, "1726439": {"assignee_vocabulary": "AllUserTeamsParticipation", "user_can_unassign": false, "bugtask_path": "/neutron/+bug/1398779", "assignee_value": "ihar-hrachyshka", "user_can_edit_status": true, "bug_title": "radvd \u003e= 2.0 blocks router update processing", "user_can_edit_milestone": false, "prefix": "neutron", "form_row_id": "task1726439", "target_is_product": true, "user_can_edit_importance": false, "assignee_is_team": false, "delete_link": "https://bugs.launchpad.net/neutron/+bug/1398779/+delete", "user_can_edit_assignee": false, "milestone_widget_items": "[]", "status_widget_items": "[]", "status_value": "Fix Released", "importance_value": "High", "hide_assignee_team_selection": true, "user_can_delete": false, "row_id": "tasksummary1726439", "assignee_vocabulary_filters": [], "targetname": "neutron", "importance_widget_items": "[]", "milestone_value": "https://bugs.launchpad.net/api/devel/neutron/+milestone/2015.1.0", "id": 1726439}}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/neutron/+bug/1398779", "web_link": "https://bugs.launchpad.net/neutron/+bug/1398779", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1398779", "milestone_link": "https://bugs.launchpad.net/api/devel/neutron/+milestone/2015.1.0", "status": "Fix Released", "importance": "High", "assignee_link": "https://bugs.launchpad.net/api/devel/~ihar-hrachyshka", "bug_target_display_name": "neutron", "bug_target_name": "neutron", "bug_watch_link": null, "date_assigned": "2014-12-03T11:27:27.820600+00:00", "date_created": "2014-12-03T11:26:52.464008+00:00", "date_confirmed": "2014-12-03T11:59:28.807640+00:00", "date_incomplete": null, "date_in_progress": "2014-12-03T11:59:28.807640+00:00", "date_closed": "2014-12-18T14:27:56.858435+00:00", "date_left_new": "2014-12-03T11:59:28.807640+00:00", "date_triaged": "2014-12-03T11:59:28.807640+00:00", "date_fix_committed": "2014-12-13T07:46:27.845988+00:00", "date_fix_released": "2014-12-18T14:27:56.858435+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~ihar-hrachyshka", "target_link": "https://bugs.launchpad.net/api/devel/neutron", "title": "Bug #1398779 in neutron: \"radvd \u003e= 2.0 blocks router update processing\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/neutron/+bug/1398779/related_tasks", "is_complete": true, "http_etag": "\"4b31c7a1556f2ed2b768e1a3f18ea31a2a11c4d4-b250003ec278b2ddb8dd4b6f8ffe7baa43c5c526\""}, "initial_comment_batch_offset": 41};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 59 queries/external actions issued in 1.43 seconds

    Features: {'app.maintenance_message': None, 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'bugs.nominations.bug_supervisors_can_target': 'on', 'baselayout.careers_link.disabled': None, 'hard_timeout': '9000', 'js.yui_version': None, 'profiling.enabled': None}

    r0d8de2b

    -->

</html>

