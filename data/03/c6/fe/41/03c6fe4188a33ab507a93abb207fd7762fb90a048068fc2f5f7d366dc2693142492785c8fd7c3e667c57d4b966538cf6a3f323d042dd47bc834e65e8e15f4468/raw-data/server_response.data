<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">    
    <title>OpenPSA PHP Objection Injection | 0dd - The Zero (0) Day Division</title> 
    <meta name="description" content="Attacker Can Perform PHP Object Injection Attacks In An OpenPSA Form">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Titillium+Web:400,100,300,500,700|Gugi" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="canonical" href="http://0dd.zone/2018/05/31/OpenPSA-Object-Injection/">
    <link rel="alternate" type="application/rss+xml" title="0dd - The Zero (0) Day Division Feed" href="http://0dd.zone/feed.xml">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-118750407-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-118750407-1');
    </script>
</head>
<body>
    <div id="top-line"></div>
    <nav id="top" class="site-navigation">
        <div class="inner">
            <button id="menu-toggle" aria-expanded="false">Menu</button>
            <div class="nav-menu">
                <ul class="menu">
                
                  
                  
                  <li class="">
                    <a class="" href="/">Home</a>
                  </li>
                
                  
                  
                  <li class="">
                    <a class="" href="/team/">Team</a>
                  </li>
                
                  
                  
                  <li class="">
                    <a class="" href="/statistics/">Statistics</a>
                  </li>
                
                  
                  
                  <li class="">
                    <a class="" href="/tags/">Archive</a>
                  </li>
                
                  
                  
                  <li class="">
                    <a class="" href="/feed.xml">RSS</a>
                  </li>
                
                  <li id="search-menu">
                      <a href="/search">Search</a>
                  </li>
                </ul>
            </div>
            <!-- Search function -->
            <div id="search-container">
                <form action="/search" method="get">
                    <input class="search-input" placeholder="Search a post..." type="text" id="search-box" name="query">
                    <button type="submit" class="search-button fa-search square fill-horizontal">
                </form>
            </div>
        </div>
    </nav>

    <header class="site-banner">
        <div class="inner">
            <h1 class="site-title"><a href="/">0dd - The Zero (0) Day Division</a></h1>
            <p class="site-description">The Zero (0) Day Division is a group of security professionals working towards a common goal; securing open-source projects.
</p>
        </div>
    </header>

    <div class="site-content">
    <div class="inner">
        <main class="site-main">
            <article class="post">
                <header class="entry-header"> 
                    <h1 class="entry-title">OpenPSA PHP Objection Injection</h1>
                    <div class="entry-meta">
                        <time class="published" datetime="2018-05-31">May 31, 2018</time> <span class="middot">&middot;</span> <span class="post-author">Sajeeb Lohani</span> <span class="middot">&middot;</span> <span class="post-author">CVE-2018-1000525</span> 
                    </div>
                </header>
                <div class="entry-content">
                    <h2>The Issue</h2>

<p>PHP Object Deserialization Injection attacks utilise the <code class="highlighter-rouge">unserialize</code> function within PHP. The deserialisation of the PHP object can trigger certain methods within the object, allowing the attacker to perform unauthorised actions like execution of code, disclosure of information, etc.</p>

<p>The OpenPSA project overly trusted user input when processing the data obtained from a form.</p>

<!--more-->

<h2>Where the Issue Occurred</h2>
<p>Displayed below is the code within the OpenPSA project, in the <code class="highlighter-rouge">openpsa/lib/midcom/services/auth/frontend/form.php</code> file, where the user input is passed into the <code class="highlighter-rouge">unserialize</code> function:</p>
<pre style="background:#000;color:#f8f8f8"><span style="color:#e28964">if</span> (<span style="color:#3e87e3">$request</span><span style="color:#e28964">-&gt;</span>request<span style="color:#e28964">-&gt;</span>has(<span style="color:#65b042">'restore_form_data'</span>)) { 
    <span style="color:#e28964">foreach</span> (<span style="color:#3e87e3">$request</span><span style="color:#e28964">-&gt;</span>request<span style="color:#e28964">-&gt;</span>get(<span style="color:#65b042">'restored_form_data'</span>, []) <span style="color:#e28964">as</span> <span style="color:#3e87e3">$key</span><span style="color:#e28964"> =&gt;</span> <span style="color:#3e87e3">$string</span>) { 
        <span style="color:#3e87e3">$value</span> = <span style="color:#3e87e3">@unserialize</span>(base64_decode(<span style="color:#3e87e3">$string</span>)); 
        <span style="color:#3e87e3">$request</span><span style="color:#e28964">-&gt;</span>request<span style="color:#e28964">-&gt;</span>set(<span style="color:#3e87e3">$key</span>, <span style="color:#3e87e3">$value</span>); 
    } 
    <span style="color:#3e87e3">$request</span><span style="color:#e28964">-&gt;</span>overrideGlobals(); 
} 
</pre>

<h2>Disclosure Timeline</h2>

<ul>
  <li>Issue Reported: 29th May 2018</li>
  <li>Issue Resolved: 30th May 2018</li>
  <li>Blog Post Published: 31st May 2018</li>
  <li>Applied for CVE: 24th June 2018</li>
</ul>

                </div>
                <footer class="entry-footer">
                    <div class="share-post">
                        <span>Share</span>
                        <a class="fa-twitter" target="_blank" href="https://twitter.com/intent/tweet?text=OpenPSA%20PHP%20Objection%20Injection&amp;url=http://0dd.zone/2018/05/31/OpenPSA-Object-Injection/"><span class="screen-reader-text">Twitter</span></a>
                        <a class="fa-facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://0dd.zone/2018/05/31/OpenPSA-Object-Injection/&amp;t=OpenPSA%20PHP%20Objection%20Injection"><span class="screen-reader-text">Facebook</span></a>
                        <a class="fa-google-plus" target="_blank" href="http://plus.google.com/share?url=http://0dd.zone/2018/05/31/OpenPSA-Object-Injection/"><span class="screen-reader-text">Google+</span></a>
                    </div>
                    
                    <div class="tag-links">
                        <a href="/tags/index.html#php" title="Pages tagged php" rel="tag">php</a><a href="/tags/index.html#object+injection" title="Pages tagged object injection" rel="tag">object injection</a>
                    </div>
                    
                </footer>
            </article>
            <nav class="post-navigation">
                <h2 class="screen-reader-text">Post navigation</h2>
                
                <div class="nav-previous">
                    <div class="nav-inside">
                        <div class="nav-before">Previous</div>
                        <div class="nav-title"><a href="/2018/05/31/Froxlor-Object-Injection/">Froxlor PHP Objection Injection</a></div>
                        <div class="nav-date">May 31, 2018</div>
                    </div>
                </div>
                
                
                <div class="nav-next">
                    <div class="nav-inside">
                        <div class="nav-before">Next</div>
                        <div class="nav-title"><a href="/2018/05/31/TripleA-XXE/">TripleA XXE</a></div>
                        <div class="nav-date">May 31, 2018</div>
                    </div>
                </div>
                
            </nav>
            
        </main>
        <aside class="sidebar">

    <section class="widget widget-recent-posts">
        <h2 class="widget-title">Latest Posts</h2>
        <ul class="recent-posts">
            
            <li class="recent-item"><a href="/2018/10/28/zoneminder-Object-Injection/">ZoneMinder PHP Objection Injection</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/zoneminder-Object-Injection-2/">ZoneMinder PHP Objection Injection (2)</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/xr3player-XXE/">XR3Player XXE</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/uml-designer-XXE/">UML Designer XXE</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/ubilling-Object-Injection/">UBilling PHP Objection Injection</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/runelite-XXE-MitM/">RunElite XXE</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/microweber-XSS/">Microweber XSS</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/megamek-Object-Injection/">MegaMek Java Objection Injection</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/k9mail-XXE-MitM/">K9Mail XXE</a> <span>October 28, 2018</span></li>
            
            <li class="recent-item"><a href="/2018/10/28/hapi-fhir-XXE/">HAPI FHIR XXE</a> <span>October 28, 2018</span></li>
            
        </ul>
    </section>

    
    
    <section class="widget widget-tags">
        <h2 class="widget-title">Tags</h2>
        <div class="tagcloud">
            
            <a href="/tags/#file+delete">file delete</a>
            
            <a href="/tags/#file+write">file write</a>
            
            <a href="/tags/#java">java</a>
            
            <a href="/tags/#local+file+disclosure">local file disclosure</a>
            
            <a href="/tags/#object+injection">object injection</a>
            
            <a href="/tags/#php">php</a>
            
            <a href="/tags/#rce">rce</a>
            
            <a href="/tags/#sql+injection">sql injection</a>
            
            <a href="/tags/#xml+dos">xml dos</a>
            
            <a href="/tags/#xss">xss</a>
            
            <a href="/tags/#xxe">xxe</a>
            
        </div>
    </section>

</aside>

    </div>
</div>


    <footer class="site-footer">
    <div class="inner">
        <div class="site-info">
            &copy; 2019 <a href="/">0dd - The Zero (0) Day Division</a> and/or its affiliates. All rights reserved.<br>
        </div>
    </div>
</footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script type="text/javascript" src="/js/custom.js"></script>

</body>
</html>
