<!DOCTYPE html>
















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Microsoft Security Bulletin MS02-018 - Critical" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-018" />

	<meta name="twitter:card" content="summary" />

	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="BetaFred" />
<meta name="breadcrumb_path" content="/security-updates/breadcrumb/toc.json" />
<meta name="depot_name" content="Security.security-updates" />
<meta name="document_id" content="f30af97e-138e-f74d-6d5d-c1794bb7a018" />
<meta name="document_version_independent_id" content="18acba6a-5e70-ace9-0e07-302aa4b1a245" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/security-updates/blob/df90e84771fe2a477f4e352e78bc7c2899ef1116/security-updates/SecurityBulletins/2002/ms02-018.md" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="BetaFred" />
<meta name="ms.date" content="10/11/2017" />
<meta name="ms.service" content="security-updates" />
<meta name="ms.topic" content="article" />
<meta name="ms:assetid" content="ms02-018" />
<meta name="ms:contentKeyID" content="61221912" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/en-us/library/ms02-018(v=Security.10)" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-018.md" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="Title" content="Microsoft Security Bulletin MS02-018 - Critical" />
<meta name="TOCTitle" content="MS02-018" />
<meta name="updated_at" content="2019-12-03 01:16 AM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="../../toc.json" />
<meta name="word_count" content="11885" />


<link href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-018" rel="canonical">
	<title>Microsoft Security Bulletin MS02-018 - Critical | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/46dad2a9.site-ltr.css ">

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-018.md',
			extendBreadcrumb: true,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
			contributors: [
						{ name: "BetaFred", url: "https://github.com/BetaFred" },
						{ name: "mdressman", url: "https://github.com/mdressman" },
						{ name: "Santoshtambe", url: "https://github.com/Santoshtambe" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>

	<script src="/_themes/docs.theme/master/en-us/_themes/global/5cce29c0.deprecation.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/bb2ae21c.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div hidden id="cookie-consent-holder"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">
Download Microsoft Edge					</a>
					<a href="https://docs.microsoft.com/en-US/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">
More info					</a>
				</div>
			</div>

		</div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="is-hidden"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet padding-xs font-size-sm display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button button button-clear button-sm" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button button-clear button-sm has-inner-focus" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
								<li id="contenteditbtn" hidden>
									<a href="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-018.md"  class=" button button-clear button-sm has-inner-focus" title="Edit This Document" data-bi-name="edit">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button button-clear button-sm button-block justify-content-flex-start has-inner-focus" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button  button button-clear button-sm is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button  button button-clear button-sm is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



							

								<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
									<li>
										<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2019-12-03T01:16:00Z" data-article-date-source="git">12/03/2019</time>
									</li>
											<li class="readingTime">59 minutes to read</li>
										<li class="contributors-holder">
											<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
																<li class="facepile-item">
																	<a href="https://github.com/BetaFred" title="BetaFred" aria-label="BetaFredGithub profile" data-src="https://github.com/BetaFred.png?size=32" data-contributor-name="BetaFred" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/BetaFred.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">B</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/mdressman" title="mdressman" aria-label="mdressmanGithub profile" data-src="https://github.com/mdressman.png?size=32" data-contributor-name="mdressman" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/mdressman.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">m</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/Santoshtambe" title="Santoshtambe" aria-label="SantoshtambeGithub profile" data-src="https://github.com/Santoshtambe.png?size=32" data-contributor-name="Santoshtambe" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/Santoshtambe.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-blue"aria-hidden="true">S</span>
																	</a>
																</li>
											</ul>
										</li>
								</ul>

								<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>


							<!-- <content> -->
								<p>Security Bulletin</p>
<h1 id="microsoft-security-bulletin-ms02-018---critical">Microsoft Security Bulletin MS02-018 - Critical</h1>
<h2 id="cumulative-patch-for-internet-information-services-q319733">Cumulative Patch for Internet Information Services (Q319733)</h2>
<p>Published: April 10, 2002 | Updated: February 28, 2003</p>
<p><strong>Version:</strong> 1.4</p>
<p><strong>Originally posted:</strong> April 10, 2002</p>
<p><strong>Updated:</strong> February 28th, 2003</p>
<h4 id="summary">Summary</h4>
<p><strong>Who should read this bulletin:</strong>
Customers hosting web servers using Microsoft® Windows NT® 4.0, Windows® 2000, or Windows XP.</p>
<p><strong>Impact of vulnerability:</strong>
Ten new vulnerabilities, the most serious of which could enable code of an attacker's choice to be run on a server.</p>
<p><strong>Recommendation:</strong>
Customers using any of the affected products should install the patch immediately.</p>
<p><strong>Maximum Severity Rating:</strong>
Critical</p>
<p><strong>Affected Software:</strong></p>
<ul>
<li>Microsoft Internet Information Server 4.0</li>
<li>Microsoft Internet Information Services 5.0</li>
<li>Microsoft Internet Information Services 5.1</li>
</ul>
<p><strong>Note:</strong> Beta versions of .NET Server <strong>after</strong> Build 3605 contains fixes for all of the vulnerabilities affecting IIS 6.0. As discussed in the FAQ, Microsoft is working directly with the small number of customers who are using the .NET Server beta version in production environments to provide immediate remediation for them.</p>
<h3 id="general-information">General Information</h3>
<h2 id="technical-details">Technical details</h2>
<p><strong>Technical description:</strong></p>
<p>This patch is a cumulative patch that includes the functionality of all security patches released for IIS 4.0 since Windows NT 4.0 <a href="http://support.microsoft.com/kb/241211" data-linktype="external">Service Pack 6a</a>, and all security patches released to date for IIS 5.0 and 5.1. A complete listing of the patches superseded by this patch is provided below, in the section titled &quot;Additional information about this patch&quot;. Before applying the patch, system administrators should take note of the caveats discussed in the same section.</p>
<p>In addition to including previously released security patches, this patch also includes fixes for the following newly discovered security vulnerabilities affecting IIS 4.0, 5.0 and/or 5.1:</p>
<ul>
<li>A buffer overrun vulnerability involving the operation of the chunked encoding transfer mechanism via Active Server Pages in IIS 4.0 and 5.0. An attacker who exploited this vulnerability could overrun heap memory on the system, with the result of either causing the IIS service to fail or allowing code to be run on the server.</li>
<li>A Microsoft-discovered vulnerability that is related to the preceding one, but which lies elsewhere within the ASP data transfer mechanism. It could be exploited in a similar manner as the preceding vulnerability, and would have the same scope. However, it affects IIS 4.0, 5.0, and 5.1.</li>
<li>A buffer overrun involving how IIS 4.0, 5.0 and 5.1 process HTTP header information in certain cases. IIS performs a safety check prior to parsing the fields in HTTP headers, to ensure that expected delimiter fields are present and in reasonable places. However, it is possible to spoof the check, and convince IIS that the delimiters are present even when they are not. This flaw could enable an attacker to create an URL whose HTTP header field values would overrun a buffer used to process them.</li>
<li>A Microsoft-discovered buffer overrun vulnerability in IIS 4.0, 5.0 and 5.1 that results from an error in safety check that is performed during server-side includes. In some cases, a user request for a web page is properly processed by including the file into an ASP script and processing it. Prior to processing the include request, IIS performs an operation on the user-specified file name, designed to ensure that the file name is valid and sized appropriately to fit in a static buffer. However, in some cases it could be possible to provide a bogus, extremely long file name in a way that would pass the safety check, thereby resulting in a buffer overrun.</li>
<li>A buffer overrun affecting the HTR ISAPI extension in IIS 4.0 and 5.0. By sending a series of specially malformed HTR requests, it could be possible to either cause the IIS service to fail or, under a very difficult operational scenario, to cause code to run on the server.</li>
<li>A denial of service vulnerability involving the way IIS 4.0, 5.0, and 5.1 handle an error condition from ISAPI filters. At least one ISAPI filter (which ships as part of FrontPage Server Extensions and ASP.NET), and possibly others, generate an error when a request is received containing an URL that exceeds the maximum length set by the filter. In processing this error, the filter replaces the URL with a null value. A flaw results because IIS attempts to process the URL in the course of sending the error message back to the requester, resulting in an access violation that causes the IIS service to fail.</li>
<li>A denial of service vulnerability involving the way the FTP service in IIS 4.0, 5.0 and 5.1 handles a request for the status of the current FTP session. If an attacker were able to establish an FTP session with an affected server, and levied a status request that created a particular error condition, a flaw in the FTP code would prevent it from correctly reporting the error. Other code within the FTP service would then attempt to use uninitialized data, with an access violation as the result. This would result in the disruption of not only FTP services, but also of web services.</li>
<li>A trio of <a href="http://www.microsoft.com/technet/archive/security/news/crssite.mspx" data-linktype="external">Cross-Site Scripting</a> (CSS) vulnerabilities affecting IIS 4.0, 5.0 and 5.1: one involving the results page that's returned when searching the IIS Help Files, one involving HTTP error pages; and one involving the error message that's returned to advise that a requested URL has been redirected. All of these vulnerabilities have the same scope and effect: an attacker who was able to lure a user into clicking a link on his web site could relay a request containing script to a third-party web site running IIS, thereby causing the third-party site's response (still including the script) to be sent to the user. The script would then render using the security settings of the third-party site rather than the attacker's.</li>
</ul>
<p><strong>Mitigating factors:</strong></p>
<p>Buffer overrun in Chunked Encoding transfer:</p>
<ul>
<li>On default installations of IIS 5.0 and 5.1, exploiting the vulnerability to run code would grant the attacker the privileges of the IWAM_<em>computername</em> account, which has only the privileges commensurate with those of an interactively logged-on unprivileged user.</li>
<li>The vulnerability requires that Active Server Pages (ASP) be enabled on the system in order to be exploited. Version 1.0 of the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> removes ASP by default, and the current version (version 2.1) removes it by default if Static Web Server has been selected.</li>
<li>The <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool can be configured to prevent chunked encoding requests. If this has been done, the vulnerability could not be exploited.</li>
</ul>
<p>Microsoft-discovered variant of Chunked Encoding buffer overrun:</p>
<ul>
<li>This vulnerability is subject to exactly the same mitigating factors as the buffer overrun in the Chunked Encoding transfer, with one exception. The URLScan tool could not be used to protect against the vulnerability.</li>
</ul>
<p>Buffer Overrun in HTTP header handling:</p>
<ul>
<li>On default installations of IIS 5.0 and 5.1, exploiting the vulnerability to run code would grant the attacker the privileges of the IWAM_<em>computername</em> account, which has only the privileges commensurate with those of an interactively logged-on unprivileged user.</li>
<li>The vulnerability requires that Active Server Pages (ASP) be enabled on the system in order to be exploited. Version 1.0 of the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> removes ASP by default, and the current version (version 2.1) removes it by default if Static Web Server has been selected.</li>
<li>The <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool's default ruleset would likely limit the attacker to using this vulnerability for denial of service attacks only.</li>
</ul>
<p>Buffer Overrun in ASP Server-Side Include Function:</p>
<ul>
<li>On default installations of IIS 5.0 and 5.1, exploiting the vulnerability to run code would grant the attacker the privileges of the IWAM_<em>computername</em> account, which has only the privileges commensurate with those of an interactively logged-on user.</li>
<li>The vulnerability requires that Active Server Pages (ASP) be enabled on the system in order to be exploited. Version 1.0 of the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> removes ASP by default, and the current version (version 2.1) removes it by default if Static Web Server has been selected.</li>
<li>The <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool's default ruleset would likely limit the attacker to using this vulnerability for denial of service attacks only.</li>
</ul>
<p>Buffer overrun in HTR ISAPI extension:</p>
<ul>
<li>Microsoft has long recommended disabling the HTR ISAPI extension. Systems on which this has been done would be at no risk from the vulnerability. (All versions of the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disable HTR support by default).</li>
<li>The <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool, if using its default ruleset, would prevent this vulnerability from being exploited to run code on the server even if HTR support was enabled.</li>
<li>The vulnerability could only be used to run code on the server if the attacker knew the locations of certain information in memory. In practice, the most likely such situation would occur if the web server had never served any web content since being rebooted. In all other cases, it would only be possible to use the vulnerability for denial of service attacks.</li>
<li>On default installations of IIS 5.0 and 5.1, exploiting the vulnerability to run code would grant the attacker the privileges of the IWAM_<em>computername</em> account, which has only the privileges commensurate with those of an interactively logged-on user.</li>
<li>If the vulnerability were used in a denial of service attack, normal operation could be restored on an IIS 4.0 server by restarting the IIS service; on IIS 5.0 and higher, the service would automatically restart itself.</li>
</ul>
<p>Access violation in URL error handling:</p>
<ul>
<li>An IIS 4.0 server could be put back into normal operation by restarting the service. An IIS 5.0 or 5.1 server would automatically restart the service.</li>
<li>The vulnerability could only be used for denial of service attacks. There is no capability to use the vulnerability to gain privileges on the system.</li>
<li>The sole ISAPI filter known to generate the error that results in the access violation ships only as part of FrontPage Server Extensions and ASP.NET. ASP.NET is not installed by default, and FPSE can be uninstalled if desired.</li>
</ul>
<p>Denial of service via FTP Status request:</p>
<ul>
<li>The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables FTP support by default.</li>
<li>An IIS 4.0 server could be put back into normal operation by restarting the service. An IIS 5.0 or 5.1 server would automatically restart the service.</li>
<li>The vulnerability could only be used for denial of service attacks. There is no capability to use the vulnerability to gain privileges on the system.</li>
</ul>
<p>Cross-site Scripting in IIS Help File search facility, HTTP Error Page, and Redirect Response message:</p>
<ul>
<li>The vulnerabilities could only be exploited if the attacker could entice another user into visiting a web page and clicking a link on it, or opening an HTML mail.</li>
<li>The Redirect Response vulnerability could only be exploited if the user was running a browser other than Internet Explorer. IE does not actually render the text in the Redirect Response, but instead recognizes it by its response header and processes the redirect without displaying any text.</li>
</ul>
<p><strong>Severity Rating:</strong></p>
<p>Buffer overrun in ASP Chunked Encoding data transfer mechanism:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Microsoft-discovered variant of ASP Chunked Encoding buffer overrun:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Buffer Overrun in HTTP Header Handling:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Buffer Overrun in ASP Server-Side Include Function:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Buffer overrun in HTR ISAPI extension:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Access violation in URL error handling:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Denial of service via FTP status request:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>Cross-site Scripting in IIS Help File search facility:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
</tbody>
</table>
<p>Cross-site Scripting in HTTP Error Page:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
</tbody>
</table>
<p>Cross-site Scripting in Redirect Response message:</p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>None</td>
<td>None</td>
<td>Low</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>None</td>
<td>None</td>
<td>Low</td>
</tr>
<tr>
<td><strong>IIS 5.1</strong></td>
<td>None</td>
<td>None</td>
<td>Low</td>
</tr>
</tbody>
</table>
<p>The above <a href="http://technet.microsoft.com/security/bulletin/rating" data-linktype="external">assessment</a> is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.</p>
<p><strong>Vulnerability identifiers:</strong></p>
<ul>
<li>Buffer overrun in Chunked Encoding mechanism: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0079" data-linktype="external">CAN-2002-0079</a></li>
<li>Microsoft-discovered variant of Chunked Encoding buffer overrun: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0147" data-linktype="external">CAN-2002-0147</a></li>
<li>Buffer Overrun in HTTP Header handling: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0150" data-linktype="external">CAN-2002-0150</a></li>
<li>Buffer Overrun in ASP Server-Side Include Function: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0149" data-linktype="external">CAN-2002-0149</a></li>
<li>Buffer overrun in HTR ISAPI extension: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0071" data-linktype="external">CAN-2002-0071</a></li>
<li>Access violation in URL error handling: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0072" data-linktype="external">CAN-2002-0072</a></li>
<li>Denial of service via FTP status request: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0073" data-linktype="external">CAN-2002-0073</a></li>
<li>Cross-site Scripting in IIS Help File search facility: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0074" data-linktype="external">CAN-2002-0074</a></li>
<li>Cross-site Scripting in HTTP Error Page: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0148" data-linktype="external">CAN-2002-0148</a></li>
<li>Cross-site Scripting in Redirect Response message: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0075" data-linktype="external">CAN-2002-0075</a></li>
</ul>
<p><strong>Tested Versions:</strong></p>
<p>The following table indicates which of the currently supported versions of IIS are affected by the vulnerabilities. Versions prior to IIS 4.0 are no longer supported and may or may not be affected by these vulnerabilities. IIS 6.0 is a beta product and is therefore not intended for use in production systems. A small number of customers are deploying IIS 6.0 servers in product environments as part of a joint program with Microsoft, and patches will be delivered directly to them.</p>
<table>
<thead>
<tr>
<th></th>
<th>IIS 4.0</th>
<th>IIS 5.0</th>
<th>IIS 5.1</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Buffer overrun in Chunked Encoding mechanism</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><strong>Microsoft-discovered variant of Chunked Encoding buffer overrun</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Buffer Overrun in HTTP Header handling</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Buffer Overrun in ASP Server-Side Include Function</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Buffer overrun in HTR ISAPI extension</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><strong>Access violation in URL error handling</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Denial of service via FTP status request</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Cross-site Scripting in IIS Help File search</strong></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Cross-site Scripting in HTTP Error Page</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>Cross-site Scripting in Redirect Response message</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<h2 id="frequently-asked-questions">Frequently asked questions</h2>
<p><strong>What vulnerabilities are eliminated by this patch?</strong><br/>
This is a cumulative patch that, when applied, eliminates most security vulnerabilities affecting Internet Information Server (IIS) 4.0 (exceptions are listed below in the Caveats section) and all vulnerabilities affecting Internet Information Service 5.0 and 5.1. In addition to eliminating previously discussed vulnerabilities, it also eliminates several new ones:</p>
<ul>
<li>A vulnerability that could enable an attacker to gain control over a web server running IIS 4.0 or 5.0.</li>
<li>A Microsoft-discovered vulnerability with the same risk and effect as the preceding vulnerability, but which affects IIS 4.0, 5.0, and 5.1.</li>
<li>A vulnerability that could enable an attacker to gain control over a web server running IIS 4.0 or 5.0.</li>
<li>A Microsoft-discovered vulnerability that could enable an attacker to gain control over a web server running IIS 4.0, 5.0 or 5.1.</li>
<li>A vulnerability that could, under unusual conditions, enable an attacker to gain control over a web server running IIS 4.0 or 5.0.</li>
<li>A vulnerability that could enable an attacker to prevent an IIS 4.0, 5.0 or 5.1 web server from providing service.</li>
<li>A vulnerability that could enable an attacker to prevent an FTP server on an IIS 4.0, 5.0, or 5.1 server from providing service.</li>
<li>Three vulnerabilities that could enable an attacker to &quot;bounce&quot; web content to another user's browser session through an IIS 4.0, 5.0 or 5.1 web server.</li>
</ul>
<p><strong>What products do IIS 4.0, 5.0, and 5.1 ship with?</strong></p>
<ul>
<li>Internet Information Server 4.0 ships as part of the Windows NT 4.0 Option Pack (NTOP)</li>
<li>Internet Information Service 5.0 ships as part of Windows 2000 Datacenter Server, Advanced Server, Server and Professional.</li>
<li>Internet Information Service 5.1 ships as part of Windows XP Professional. It does not ship as part of Windows XP Home Edition.</li>
</ul>
<p><strong>Do IIS 4.0, 5.0 and 5.1 run by default?</strong></p>
<ul>
<li>IIS 4.0 runs by default when the NTOP is installed on a Windows NT 4.0 server. It does not run by default when the NTOP is installed on a Windows NT 4.0 workstation, unless Peer Web Services were already running when it was installed.</li>
<li>IIS 5.0 runs by default on all Windows 2000 server products. It does not run by default on Windows 2000 Professional.</li>
<li>IIS 5.1 does not run by default on Windows XP.</li>
</ul>
<p><strong>Does the patch include any other fixes?</strong><br/>
Yes. In addition to eliminating the security vulnerabilities discussed above, the patch also includes a small number of fixes for issues that aren't security vulnerabilities. These are documented in Microsoft Knowledge Base article Q319733</p>
<p><strong>Some of the vulnerabilities apply to certain versions of IIS, but not to others. How do I know whether I need a patch for my version?</strong><br/>
If you're running any of the affected products, you should install the patch. The patch will only apply the fixes for the vulnerabilities affecting your version of IIS.</p>
<p><strong>Above and beyond staying up to date on patches, are there any other steps I should take to maintain the security of my web server?</strong><br/>
The single most important step you can take to keep your web server secure is to use the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a>. The tool will ensure that your server is configured securely and will install the <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool to provide continuing protection while the server is operating.
In addition, there are small number of vulnerabilities affecting IIS 4.0 that cannot be eliminated via software patches. Instead, they require administrative action. All such vulnerabilities are listed below in the Caveats section.</p>
<p><strong>Can these patches be installed on systems running Personal Web Server or Peer Web Services?</strong><br/>
In some cases, they can. If you are running either Personal Web Server or Peer Web Services, please consult Microsoft Knowledge Base Article <a href="http://support.microsoft.com/directory/article.asp?id=kb;en-us;q307439" data-linktype="external">Q307439</a> for specific information.</p>
<p><strong>Why haven't you discussed IIS 6.0 in the context of these vulnerabilities?</strong><br/>
We typically don't discuss beta products in security bulletins. By definition, beta products are incomplete; they're intended for evaluation purposes and shouldn't be used in production systems. A small number of customers are engaged in production deployments of IIS 6.0 in conjunction with Microsoft, and we are delivering fixes directly to them.</p>
<p><strong>Buffer Overrun in Chunked Encoding Transfer (CVE-CAN-2002-0079)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">buffer overrun</a> vulnerability affecting IIS 4.0 and 5.0. By sending a specially chosen request to an affected web server, an attacker could either disrupt web services or gain the ability to run a program on the server. Such a program would run with full system privileges in IIS 4.0, and with fewer but nevertheless significant privileges in IIS 5.0
Customers who have used the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> to configure their servers as static web servers are already protected against the vulnerability. Likewise, the <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a>tool can be configured to block the vulnerability, and affected mechanism itself can be disabled. However, because of the seriousness of the vulnerability, we do recommend that all customers install the patch, including those who have already taken these steps.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because of an arithmetic error in the ISAPI extension that implements the Active Server Pages (ASP) functionality. Specifically, the error lies in a function that enables data to be uploaded to a web server via chunked encoding, and causes IIS to allocate a buffer of the wrong size to hold incoming data, with the result that the data could overrun the end of the buffer.</p>
<p><strong>What is an ISAPI extension?</strong><br/>
<a href="https://msdn2.microsoft.com/en-us/library/ms525172.aspx" data-linktype="external">ISAPI</a> (Internet Services Application Programming Interface) is a technology that enables web developers to extend the functionality of their web servers by writing custom code that provides new services for a web server. Such code can be implemented in either of two forms:</p>
<ul>
<li>As an <a href="http://msdn2.microsoft.com/en-us/library/ms524610.aspx" data-linktype="external">ISAPI filter</a>, -- a <a href="http://msdn2.microsoft.com/en-us/library/ms682589.aspx" data-linktype="external">dynamic link library</a> (.dll) that uses ISAPI to respond to events that occur on the server.</li>
<li>As an <a href="http://msdn2.microsoft.com/en-us/library/ms525172.aspx" data-linktype="external">ISAPI extension</a> -- a dynamic link library that uses ISAPI to provide a set of web functions above and beyond those natively provided by IIS.</li>
</ul>
<p>In the case of this vulnerability, the affected code is an ISAPI extension that implements scripting via Active Server Pages.</p>
<p><strong>What are Active Server Pages?</strong><br/>
<a href="http://msdn2.microsoft.com/en-us/default.aspx" data-linktype="external">Active Server Pages</a> (ASP) is a technology that allows web servers to dynamically generate web applications. One way to visualize Active Server Pages is consider them to be programs that resides on the web server; when a user requests an ASP page, the ASP ISAPI extension processes the ASP page, generates an HTML page, and sends it to the user. The vulnerability in this case doesn't involve the ASP technology per se, but instead involves an error in how a standard type of data transfer operation called chunked encoding is implemented in ASP.</p>
<p><strong>What is chunked encoding?</strong><br/>
Web servers frequently need the ability to accept data from a user. For instance, when a visitor to a web site fills in a form and submits it, the data needs to be uploaded to the server so it can be processed. In cases like this, the amount of data that will be transferred is known in advance, and the server can allocate a buffer of the right size. However, in other scenarios, it's impossible to know beforehand how much data will need to be transferred. For instance, an application might be generating data as it runs, and there might be no way to know exactly how much data it will produce.
The <a href="http://support.microsoft.com/default.aspx?scid=http://www.rfc-editor.org/rfc/rfc2068.txt" data-linktype="external">HTTP protocol specification</a> provides a way to handle data like this, through a process called chunked encoding. In chunked encoding, the client generates a variable-sized quantity of data called a chunk; it then tells the web server how big the chunk is and sends it. The server allocates a buffer to accommodate the incoming chunk, then receives and processes it. As the client generates additional data, it continues agglomerating it into chunks and delivering them to the server.</p>
<p><strong>What's wrong with the way IIS 4.0 and 5.0 perform chunked encoding transfers?</strong><br/>
There's an arithmetic error in the IIS 4.0 and 5.0 Active Server Pages implementations, that causes them to miscalculate the size of the buffer that's needed for an incoming chunk and allocate one that's too small. The result is that the data in the chunk can overlap the end of the buffer and overwrite other data in system memory, potentially allowing the operation of IIS to be modified.</p>
<p><strong>How much data could be overwritten?</strong><br/>
By design, the client can specify a chunk of any size - if the server can't accommodate a chunk that large, it should send an error message to the client. However, in addition to causing the wrong-sized buffer to be allocated, the arithmetic error also prevents IIS 4.0 and 5.0 from placing any real limits on the size of a chunk. As a result, it would be possible for a client to send a chunk that would overwrite most or all of the memory on the system
This is a critical point, because it goes to the heart of why this vulnerability poses such a serious threat to servers. This vulnerability is an example of so-called heap overrun; these are frequently difficult or impossible to exploit, because of the dynamic nature of system memory. Data on the server can change locations from one moment to the next, impeding the attacker's ability to overwrite selected programs or data. However, in this case, the attacker wouldn't need to know where programs were located, but could instead simply overwrite large portions of system memory indiscriminately.</p>
<p><strong>What would this enable an attacker to do?</strong><br/>
An attacker who exploited this vulnerability could use it for either of two purposes.</p>
<ul>
<li>Service disruption. By overrunning the buffer with random data, the attacker could corrupt program code and cause the IIS service to fail, thereby preventing the server from providing useful service.</li>
<li>Change the operation of the server. By overrunning the buffer with carefully selected data, the attack could overwrite program code on the server with new program code, in essence modifying the functionality of the server software.</li>
</ul>
<p><strong>Who could exploit the vulnerability?</strong><br/>
Any user who was able to establish a web session with an affected server could exploit the vulnerability.</p>
<p><strong>If the vulnerability were exploited to cause the IIS service to fail, what would be needed to restore normal operation?</strong><br/>
On IIS 4.0, the administrator would need to restart the IIS service. On IIS 5.0, the service would automatically restart itself.</p>
<p><strong>Why could the vulnerability only be used to cause the IIS service to fail? If the attacker were able to overwrite system memory indiscriminately, why not overwrite all memory on the server and cause the entire operating system to fail?</strong><br/>
Windows NT 4.0, Windows 2000 and Windows XP operate in <em>protected mode</em>. In protected mode, processes can only write to sections of memory they own. As a result, it would not be possible for the attacker to overwrite the memory belonging to the operating system.</p>
<p><strong>If the vulnerability were exploited to change the operation of the server software, what would the attacker be able to do?</strong><br/>
In a nutshell, the attacker's code would gain the privileges of the software that called it - the ASP ISAPI extension, ASP.DLL. The privileges that the attacker could gain would depend on the version of IIS in use on the server:</p>
<ul>
<li>On IIS 4.0, ASP.DLL runs by default in-process - that is, as part of the IIS Service, which runs as part of the operating system itself. As a result, exploiting the vulnerability on a default IIS 4.0 installation would give the attacker complete control over the server.</li>
<li>On IIS 5.0, ASP.DLL runs by default out-of-process - that is, in the security context of a special user account called the Web Application Manager. (Web administrators may know this account better as IWAM_<em>computername</em>, where <em>computername</em> is the name of the server). This account has significantly fewer privileges than the IIS service.</li>
</ul>
<p><strong>What privileges does the Web Application Manager have?</strong><br/>
Essentially, the account has the same privileges as those of an unprivileged user who was able to log onto the server interactively. It would not enable an attacker to take administrative action, reconfigure the server, or access important files such as the Security Account Manager database.
Nevertheless, it is important not to underestimate the damage that could be caused using even these privileges. Even these privileges could be used to cause significant damage. Worse, the vulnerability could potentially give an attacker a beachhead from which to conduct additional attacks and try to obtain additional privileges.</p>
<p><strong>I'm running IIS 4.0. Can I configure ASP.DLL to run out-of-process?</strong><br/>
Yes. Microsoft has long recommended that, whenever possible, IIS 4.0 should be configured to run ASP.DLL and other components out-of-process. This not only improves security, but stability as well. There is, however, a performance penalty associated with running out of process.</p>
<p><strong>I don't use Active Server Pages. Would disabling the functionality altogether protect my server?</strong><br/>
Yes. In fact, Version 1.0 of the IIS Lockdown Tool disabled ASP by default. The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">current version of the Tool</a>, version 2.1, provides a number of different server roles. Selecting &quot;Static Web Server&quot; will disable ASP by default.</p>
<p><strong>I've deployed the URLScan Tool on my server. Will it protect my system against this vulnerability?</strong><br/>
By default, it would not. However, it would be possible add a rule that would block chunked encoding requests. Just add an entry to the [DenyHeaders] section of URLScan.ini that reads &quot;Transfer-Encoding:&quot;. (Note: the quotes should not be included in the entry, but there is a colon at the end of the word &quot;Encoding&quot;)
Microsoft has release an updated version of the URLScan that implements this rule by default, as well as improving the protection the tool can provide. The updated tool is available for download at <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">http://www.microsoft.com/technet/security/tools/urlscan.mspx</a>.</p>
<p><strong>How does the patch eliminate this vulnerability?</strong><br/>
The patch eliminates the arithmetic error that causes the vulnerability.</p>
<p><strong>Microsoft-discovered variant of Chunked Encoding buffer overrun (CVE-CAN-2002-0147)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This vulnerability is identical to the preceding one in scope, effect, and remediation. There are only two significant differences:</p>
<ul>
<li>This vulnerability affects additional versions of IIS. Specifically, it affects IIS 4.0, 5.0 and 5.1.</li>
<li>It cannot be blocked by URLScan.</li>
</ul>
<p><strong>What causes this vulnerability?</strong><br/>
This vulnerability results because of a handling error in the allocation of buffers for data transfers. Although it involves a similar functionality as preceding one, and has the same overall effect, there are nevertheless some important differences between the two vulnerabilities.</p>
<p><strong>What are the differences between this vulnerability and the preceding one?</strong><br/>
There are two primary differences. First, where IIS 5.1 is not affected by the preceding one, it is affected by this one. Second, unlike the preceding vulnerability, this one could not be blocked via URLScan.</p>
<p><strong>How was this vulnerability found?</strong><br/>
Microsoft discovered this vulnerability through code inspection as part of the investigation of the preceding one.</p>
<p><strong>Buffer Overrun in ASP Server-Side Include Function (CVE-CAN-2002-0149)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">buffer overrun</a> vulnerability affecting IIS 4.0, 5.0 and 5.1. By sending a specially chosen request to an affected web server, an attacker could either disrupt web services or gain the ability to run a program on the server. Such a program would run with full system privileges in IIS 4.0, and with fewer but nevertheless significant privileges in IIS 5.0 and 5.1
Customers who have used the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> to configure their servers as static web servers are already protected against the vulnerability. Likewise, the <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a>tool, when deployed with the default ruleset, would make it difficult to use the vulnerability to gain control of the server, and likely reduce it to a denial of service attack only.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because of a logic error in a function that handles server-side file includes for Active Server Pages. The result of the error is that the function could conclude that it is safe to store the name of a specified server-side file in a particular buffer, when in actuality the filename is longer than the buffer</p>
<p><strong>What are server-side file includes?</strong><br/>
Frequently, developers need to be able to incorporate a file into a program - for instance, as a way of reusing existing code. File includes provide a way to do this. The developer specifies what file should be included in the program, and at what point, and the contents of the file are treated as though they were part of the program.
ASP, like most programming languages, supports file includes. In the case of ASP, the included files come from the web server itself, so they're known as server-side file includes. When an ASP script runs, a pre-processing step handles any file includes, after which point the ASP ISAPI filter processes the result.</p>
<p><strong>Can a visitor to a web site request a server-side include?</strong><br/>
No. After all, a web site visitor should never actually be involved in the operation of ASP scripts - all processing should occur on the server. However, it is possible for user actions to have the effect of causing a file include on the server to happen. This vulnerability involves the operation of IIS when this is done, and in a particular way.</p>
<p><strong>What's wrong with how IIS handles server-side includes?</strong><br/>
In some cases, requesting a particular web page will cause it to be included within an ASP script as part of its processing. Because this involves putting user input into a buffer, IIS always performs a check beforehand, designed to make sure the input is valid. Specifically, it performs an operation on the file name that should only succeed if the file name is valid.
A security vulnerability results because it's possible to levy a request that includes a very long, invalid file name, but do it in a way that has two effects. First, the ASP ISAPI extension concludes that the filename needs to be processed as part of an ASP file, and does a server-side include. Second, the filename evades the safety check. The result is that the file name - which is longer than the buffer allocated to hold it - causes a buffer overrun in the ASP file when it's processed.</p>
<p><strong>What would the vulnerability enable an attacker to do?</strong><br/>
An attacker who exploited this vulnerability could use it for either of two purposes:</p>
<ul>
<li>Service disruption. By overrunning the buffer with random data, the attacker could corrupt program code and cause the IIS service to fail, thereby preventing the server from providing useful service.</li>
<li>Change the operation of the server. By overrunning the buffer with carefully selected data, the attack could overwrite program code on the server with new program code, in essence modifying the functionality of the server software.</li>
</ul>
<p><strong>Who could exploit the vulnerability?</strong><br/>
Any user who could establish a session with an affected web server could exploit the vulnerability.</p>
<p><strong>If the vulnerability were exploited to cause the IIS server to fail, what would be needed to restore normal operation?</strong><br/>
On IIS 4.0, the administrator would need to restart the IIS service. On IIS 5.0 and 5.1, the service would automatically restart itself.</p>
<p><strong>If the vulnerability were exploited to change the operation of the server software, what would the attacker be able to do?</strong><br/>
If exploited in this way, the attacker could gain the same privileges as discussed above:</p>
<ul>
<li>On IIS 4.0, the attacker could gain complete control over the server</li>
<li>On IIS 5.0 and 5.1, the attacker could gain the privileges associated with the Web Application Manager - essentially, those of an unprivileged user.</li>
</ul>
<p><strong>Would the IIS Lockdown Tool help protect my server?</strong><br/>
The vulnerability could only be exploited if Active Server Pages are enabled on the server. Version 1.0 of the IIS Lockdown Tool disables ASP by default. The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">current version of the Tool</a>, version 2.1, provides a number of different server roles. Selecting &quot;Static Web Server&quot; disables ASP by default.</p>
<p><strong>Would the URLScan tool protect my system against this vulnerability?</strong><br/>
It wouldn't offer total protection, but it would significantly reduce the scope of the vulnerability. By default, URLScan blocks all URLs that contain non-ASCII data. This would not prevent an attacker from causing the service to fail - overrunning the buffer with virtually any data would accomplish that goal. However, it would make it difficult to exploit the vulnerability to alter the operation of the server software, because the attacker would need to construct valid executable code using only ASCII data.</p>
<p><strong>How was this vulnerability found?</strong><br/>
Microsoft discovered this vulnerability as part of a security review.</p>
<p><strong>How does the patch eliminate the vulnerability?</strong><br/>
The patch correct the truncation error, thereby ensuring that the URLs under discussion here will not be passed to the function.</p>
<p><strong>Buffer Overrun in HTTP Header Handling (CVE-CAN-2002-0150)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">buffer overrun</a> vulnerability affecting IIS 4.0, 5.0 and 5.1. By sending a specially chosen request to an affected web server, an attacker could either disrupt web services or gain the ability to run a program on the server. Such a program would run with full system privileges in IIS 4.0, and with fewer but nevertheless significant privileges in IIS 5.0 and 5.1.
Customers who have used the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> to configure their servers as static web servers are already protected against the vulnerability. Likewise, the <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a>tool, when deployed with the default ruleset, would prevent this vulnerability from being used to gain control of the server, and reduce it to a denial of service attack only.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because of an error that occurs when Active Server Pages parse HTTP header information. An initial check is performed, with the goal of ensuring that required delimiters are present in the information and in reasonable locations before moving the information in a buffer for processing. However, the check can be spoofed, with a buffer overrun as the result.</p>
<p><strong>What are HTTP headers?</strong><br/>
When a client sends a request to a web server, it needs a way to give the web server specific information about the request. For instance, it needs to indicate how data in the request has been formatted, what web browser the client is using, what action the server should perform, and so on. All of this information is specified via fields in the request known as <a href="http://msdn2.microsoft.com/en-us/library/aa287673(vs.71).aspx" data-linktype="external">HTTP headers</a>.</p>
<p><strong>What's wrong with the way IIS handles HTTP headers?</strong><br/>
When IIS receives an HTTP request, it must parse the headers so it can interpret them and take the appropriate action. This is done by breaking the headers into their constituent parts and putting each in a buffer; IIS determines where each of the parts ends by looking for a delimiting character.</p>
<p>IIS checks before performing this operation, to make sure that the delimiting characters are really present, and located at appropriate places within the request. However, by constructing a request in a particular way, it's possible to spoof this check, and make IIS conclude that the delimiting characters are present when in fact they aren't.</p>
<p><strong>Why does this result in a security vulnerability?</strong><br/>
The purpose of the check is to ensure that IIS never copies more information into the buffer than it's designed to hold. However, by spoofing the checks, this protection could be bypassed, resulting in a buffer overrun.
Specifically, suppose an attacker sent a request that contained a large amount of data within the HTTP header fields. Ordinarily, IIS would detect that the data didn't contain the expected delimiters, and that the fields were therefore too large to fit safely in the buffers. It would therefore reject the request. However, if the request was constructed to exploit this vulnerability, IIS would incorrectly conclude that the request was well-formed, and would copy the fields into the buffer, thereby overrunning it.</p>
<p><strong>What would the vulnerability enable an attacker to do?</strong><br/>
An attacker who exploited this vulnerability could use it for either of two purposes.</p>
<ul>
<li>Service disruption. By overrunning the buffer with random data, the attacker could corrupt program code and cause the IIS service to fail, thereby preventing the server from providing useful service.</li>
<li>Change the operation of the server. By overrunning the buffer with carefully selected data, the attack could overwrite program code on the server with new program code, in essence modifying the functionality of the server software.</li>
</ul>
<p><strong>Who could exploit the vulnerability?</strong><br/>
Any user who could establish a session with an affected web server could exploit the vulnerability.</p>
<p><strong>If the vulnerability were exploited to cause the IIS server to fail, what would be needed to restore normal operation?</strong><br/>
On IIS 4.0, the administrator would need to restart the IIS service. On IIS 5.0 and 5.1, the service would automatically restart itself.</p>
<p><strong>If the vulnerability were exploited to change the operation of the server software, what would the attacker be able to do?</strong><br/>
If exploited in this way, the attacker could gain the same privileges as discussed above:</p>
<ul>
<li>On IIS 4.0, the attacker could gain complete control over the server</li>
<li>On IIS 5.0 and 5.1, the attacker could gain the privileges associated with the Web Application Manager - essentially, those of an unprivileged user.</li>
</ul>
<p><strong>Would the IIS Lockdown Tool help protect my server?</strong><br/>
The vulnerability could only be exploited if Active Server Pages are enabled on the server. Version 1.0 of the IIS Lockdown Tool disables ASP by default. The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">current version of the Tool</a>, version 2.1, provides a number of different server roles. Selecting &quot;Static Web Server&quot; disables ASP by default.</p>
<p><strong>Would the URLScan tool protect my system against this vulnerability?</strong><br/>
It wouldn't offer total protection, but it would significantly reduce the scope of the vulnerability. By default, URLScan blocks all URLs that contain non-ASCII data. This would not prevent an attacker from causing the service to fail - overrunning the buffer with virtually any data would accomplish that goal. However, it would make it difficult to exploit the vulnerability to alter the operation of the server software, because the attacker would need to construct valid executable code using only ASCII data.</p>
<p><strong>How does the patch eliminate the vulnerability?</strong><br/>
The patch corrects the checking mechanism, and ensures that it's performed correctly in all cases.</p>
<p><strong>Buffer overrun in HTR ISAPI extension (CVE-CAN-2002-0071)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">buffer overrun</a> vulnerability affecting IIS 4.0 and 5.0. By sending a specially chosen request to an affected web server, an attacker could cause it to temporarily stop providing web services or, in very unusual cases, could gain control of the server.
There are a number of factors that tend to reduce the severity of this vulnerability:</p>
<ul>
<li>The most likely effect of exploiting this vulnerability would be to disrupt service on the web server. While it would be possible to use the vulnerability to gain control over the server, it would in most cases require fortuitous circumstances for the attacker.</li>
<li>The component containing the vulnerability is removed by default by the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a>.</li>
<li>The <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a>tool's default configuration would prevent the vulnerability from being exploited.</li>
</ul>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because the ISAPI extension that implements HTR scripting contains an off-by-one error when calculating the size of a buffer for storing an input value. If a request for an HTR script were malformed in a particular way, it would be possible to abuse the miscalculation and conduct a buffer overrun attack. In the least serious case, this could result in the failure of the IIS service; in the most serious case (which would be difficult to exploit), it could allow code to be run on the server.</p>
<p><strong>What is .HTR?</strong><br/>
HTR is a first-generation advanced scripting technology delivered as part of IIS 2.0. HTR was never widely adopted, largely because a far superior technology, <a href="http://msdn2.microsoft.com/en-us/library/aa286483.aspx" data-linktype="external">Active Server Pages</a> (.ASP), was introduced in IIS 4.0 and became popular before customers had invested significant development resources in HTR. However, all versions of IIS through version 5.1 do provide support for HTR, for purposes of backward compatibility.
Microsoft has long advocated that customers disable HTR on their web servers, unless there is a business-critical need for the technology. By default, the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disable HTR support, by unmapping the HTR ISAPI extension.</p>
<p><strong>Are there any widespread uses for HTR?</strong><br/>
Virtually the only purpose for which HTR technology is still used today is web-based password management services. IIS ships with a set of HTR scripts that, if deployed, make it possible for users to change their Windows NT passwords via a web server, and make it possible for administrators to perform password management through the web.
In eneral, Microsoft recommends against performing password management over the web. However, for customers who must do this, we recommend converting any needed HTR scripts to ASP.</p>
<p><strong>What's wrong with the HTR ISAPI extension?</strong><br/>
When the HTR ISAPI extension receives a request to run a script, it calculates the size of the buffer that's needed to contain the request. However, it miscalculates this value, with the result that it creates a buffer one byte smaller than needed. By sending a series of HTR requests, all malformed in particular ways, it could be possible to use the vulnerability to overwrite memory on the server.</p>
<p><strong>What would this enable an attacker to do?</strong><br/>
An attacker could exploit this vulnerability in either of two ways. By sending a series of requests that simply overran the buffer with random data, the attacker could cause the service to fail. However, by carefully selecting the data, it could be possible - although operationally difficult - to modify the operation of the IIS service to perform tasks of the attacker's choice.</p>
<p><strong>If the attacker used this vulnerability to cause the service to fail, what would be the result?</strong><br/>
If exploited against an IIS 4.0 server, the attack would prevent the server from handling web requests until the administrator restarted the IIS service. If exploited against an IIS 5.0 or 5.1 server, the outage would be only temporary, as the IIS service would automatically restart itself. In either case, any web sessions that were underway when the service failed would be terminated.</p>
<p><strong>If the attacker used this vulnerability to modify the operation of the service, would what be the result?</strong><br/>
If exploited in this way, the attacker could gain the same privileges as discussed above:</p>
<ul>
<li>On IIS 4.0, the attacker could gain complete control over the server</li>
<li>On IIS 5.0, the attacker could gain the privileges associated with the Web Application Manager - essentially, those of an unprivileged user.</li>
</ul>
<p><strong>How difficult would it be to exploit the vulnerability to gain control over the server?</strong><br/>
Like the vulnerability discussed above, this is a heap overrun. However, this one would be more difficult to exploit. For instance, it would be more difficult from a technical standpoint to write an exploit tool that takes advantage of a one-byte heap overrun.
Even if an exploit tool were available, the vulnerability could only be exploited under certain conditions. In practical terms, most of these conditions would only be present if the server hadn't serviced any web requests since the last time it was booted, and even then the attacker would need specific information about the software running on the server. Note, however, that none of these factors would be impossible to overcome, given the right circumstances.</p>
<p><strong>I've run the IIS Lockdown Tool. Am I vulnerable to this issue?</strong><br/>
By default, the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables support for HTR. The vulnerability could not be exploited against a server on which HTR support was disabled.</p>
<p><strong>I have URLScan running. Am I vulnerable to this issue?</strong><br/>
URLScan's default ruleset would prevent this vulnerability from being exploited, even if the server was otherwise vulnerable. We do, however, recommend applying the patch on any server on which HTR is enabled, even if URLScan is protecting it.</p>
<p><strong>I'm running a system that's susceptible to the vulnerability. What should I do?</strong><br/>
The best course of action is to remove HTR support altogether, by unmapping the HTR ISAPI extension. (The simplest way to do this is via the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a>). We recommend retaining HTR support only if there's a business-critical need for it.
Even after removing HTR, we still recommend applying the patch. First, it fixes vulnerabilities in addition to this one. Second, applying the patch will ensure that the server would still be protected even if HTR support were inadvertently re-enabled at some future point.</p>
<p><strong>How does the patch eliminate the vulnerability?</strong><br/>
The patch corrects the miscalculation in the HTR ISAPI extension, and ensures that it allocates a buffer that matches the size of the incoming request.</p>
<p><strong>Access violation in URL error handling (CVE-CAN-2002-0072)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">denial of service</a> vulnerability affecting IIS 4.0, 5.0 and 5.1. By exploiting this vulnerability, an attacker could temporarily prevent a web server from providing web services.
The vulnerability would not allow any data on the system to be compromised, nor would it enable the attacker to gain any privileges on the system. Microsoft's investigations to date suggest that this vulnerability only occurs in cases where Front Page Server Extensions (FPSE) or ASP.NET are installed on the system, although it is possible that it may also occur under other conditions as well.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability occurs because IIS incorrectly handles the error condition that results when one of the ISAPI filters installed by Front Page Server Extensions and ASP.NET receives an URL that exceeds the maximum allowable length. Although the problem lies within IIS, and therefore could also occur in cases involving additional ISAPI filters, Microsoft's investigations to date have not revealed any others in which this occurs.</p>
<p><strong>What's an ISAPI filter?</strong><br/>
As discussed above, an ISAPI filter is a .dll installed to extend the functionality available through a web server. The specific filter at issue in this case is one installed by FPSE and ASP.NET, although others could also be involved as well.</p>
<p><strong>What is FPSE?</strong><br/>
<a href="http://msdn2.microsoft.com/en-us/aa167867(office.11).aspx" data-linktype="external">FrontPage Server Extensions</a> (FPSE) is a set of tools that can be installed on a web server to allow authorized personnel to manage the server, add or change content, and perform other tasks.</p>
<p><strong>What is ASP.NET?</strong><br/>
<a href="http://msdn2.microsoft.com/en-us/default.aspx" data-linktype="external">ASP.NET</a> is a development platform that allows web applications to be built easily and rapidly. ASP.NET can be thought of as a superset of ASP -- existing ASP programs can be ported directly to ASP.NET, but it also provides new, extended functionality.</p>
<p><strong>What's wrong with FPSE and ASP.NET?</strong><br/>
Nothing. The problem in this case involves how IIS handles a particular type of error condition that can be generated by ISAPI filters. It happens that the only ISAPI filters Microsoft has identified so far that actually generate the error condition are associated with FPSE and ASP.NET. However, the problem doesn't lie in the ISAPI filter, but rather in the way IIS handles the error condition.
What's the error condition, and why does it cause the IIS service to fail? The error in this case occurs when either of the ISAPI filters receive a request containing an URL that exceeds the maximum length. When this happens, the filter fails the request, and sets the URL to a null value. The vulnerability results because IIS, before sending the response back to the requester, tries to use the URL. This causes an access violation that results in the failure of the IIS service.</p>
<p><strong>What would this enable an attacker to do?</strong><br/>
An attacker who exploited this vulnerability would be able to cause the IIS service to fail. This would have the effect of terminating any sessions that were in process at the time, and preventing any new ones until the service was restarted.</p>
<p><strong>How might an attacker exploit the vulnerability?</strong><br/>
An attacker could exploit the vulnerability by sending to an affected server a request that would be processed by either of the ISAPI filters mentioned above, and including an URL that exceeds the maximum length for the filter. (Likewise, if there were other ISAPI filters installed on the system that can generate the same error condition, the attacker could send a request to one of them).</p>
<p><strong>What would be required to resume normal operation?</strong><br/>
On IIS 4.0, the operator would need to restart the service. On IIS 5.0 and 5.1, the service would automatically restart itself.</p>
<p><strong>Could the attacker gain any other privileges on the server via this vulnerability?</strong><br/>
No. This is strictly a denial of service vulnerability; there is no capability to change content on the server, manage it, or take any other actions.</p>
<p><strong>I haven't installed FPSE on my server. Could I be affected by the vulnerability?</strong><br/>
Some of the Server Extensions install as part of IIS 4.0, 5.0 and 5.1 by default, and others must be installed separately. The ISAPI filter at issue here installs by default, so a server would be affected unless the administrator had removed FPSE. (FPSE can be removed via the Add/Remove Programs applet in Control Panel). Even if FPSE has been removed, keep in mind that it could be possible for a server to have other ISAPI filters installed that would generate the error condition that causes IIS to fail.</p>
<p><strong>I haven't installed ASP.NET on my server. Could I be affected by the vulnerability?</strong><br/>
ASP.NET does not install by default as part of IIS. However, even if ASP.NET is not installed on the system, FPSE would be, as discussed in the preceding paragraph.</p>
<p><strong>How does the patch eliminate this vulnerability?</strong><br/>
The patch cause IIS to check the URL when processing the error at issue here, and to not attempt to process it.</p>
<p><strong>Denial of service via FTP status request (CVE-CAN-2002-0073)</strong></p>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">denial of service</a> vulnerability affecting IIS 4.0, 5.0 and 5.1. By exploiting this vulnerability, an attacker could temporarily prevent a web server from providing web services.
The vulnerability could only be exploited if the web server were also configured to provide FTP services. IIS 4.0 installs FTP services by default, but IIS 5.0 and 5.1 do not. The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables FTP support by default. The vulnerability would not allow any data on the system to be compromised, nor would it enable the attacker to gain any privileges on the system.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because the FTP implementation in IIS 4.0, 5.0 and 5.1 does not correctly handle a request for the status of the connection, if the request has been malformed in a particular way. Receiving such a request would result in the failure of the IIS service.</p>
<p><strong>What is FTP?</strong><br/>
File Transfer Protocol (FTP) is an industry standard protocol (specified in <a href="http://www.ietf.org/rfc/rfc959.txt" data-linktype="external">RFC 959</a>) that allows users to post files to or retrieve files from a server. All versions of IIS include an implementation of the protocol.</p>
<p><strong>What's wrong with the FTP implementation in IIS 4.0, 5.0 and 5.1?</strong><br/>
They contain an error in the way they handle a request for the status of an ongoing FTP connection. Specifically, including certain characters in the request creates an error condition, but this fact isn't correctly reported back to the software module that relayed the user's request. The result is that the calling module uses uninitialized data, thereby causing an access violation.</p>
<p><strong>What would this enable an attacker to do?</strong><br/>
FTP services are provided by the IIS service itself, so an attacker who exploited this vulnerability would be able to disrupt not only FTP services but web services as well. This would have the effect of terminating any sessions that were in effect at the time of the attack.</p>
<p><strong>Who could exploit this vulnerability?</strong><br/>
Any user who was able to establish an FTP session with an affected server could exploit the vulnerability. The status request that contains the flaw can only be levied as part of an already existing session.</p>
<p><strong>What would be required to resume normal operation?</strong><br/>
On an IIS 4.0 server, the operator would need to restart the IIS service. On IIS 5.0 and 5.1 servers, the service would automatically restart itself.</p>
<p><strong>What's the significance of the need for the attacker to be able to establish a session with the server?</strong><br/>
It means that an attacker could not simply conduct a &quot;drive-by&quot; attack and send data to the server. The FTP service would need to be enabled and running, and the attacker would either need logon credentials, or the server would need to be configured to allow anonymous logon.</p>
<p><strong>Does FTP install and run by default?</strong><br/>
It is enabled and running by default as part of IIS 4.0, but not as part of IIS 5.0 or 5.1. It's also worth noting that the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables FTP by default.</p>
<p><strong>If FTP is running, is anonymous logon enabled by default?</strong><br/>
Yes. It's always a good idea to consider whether you really want to allow anonymous access to your FTP server, and to disable it if this isn't the case.</p>
<p><strong>How does the patch eliminate the vulnerability?</strong><br/>
The patch causes the FTP service to correctly handle the command at issue here.</p>
<p><strong>Cross-site Scripting in IIS Help File search facility, Redirect Response message, and HTTP Error Page (CVE-CAN-2002-0074, 0075, 0148)</strong></p>
<p><strong>What's the scope of these vulnerabilities?</strong><br/>
These are all cross-site scripting vulnerabilities. The scope and effect of all of them is the same -- through these vulnerabilities, it could be possible for an attacker to send a request to an affected server that would cause a web page containing script to be sent to another user. The script would execute within the user's browser as though it had come from the third-party site. This would let it run using the security settings appropriate to the third-part web site, as well as allowing the attacker to access any data belonging to the site.
The vulnerability could only be exploited if the user opened an HTML mail or visited a malicious user's web site - the code could not be &quot;injected&quot; into an existing session. In one of the two cases here, even if an attacker did exploit the vulnerability, it would have no effect on a user running IE. What causes the vulnerability? Certain web services provided by IIS don't properly validate all inputs before using them, and are consequently vulnerable to <a href="http://www.microsoft.com/technet/archive/security/news/crssite.mspx" data-linktype="external">Cross-Site Scripting</a> (CSS).</p>
<p><strong>What's Cross-Site Scripting?</strong><br/>
<a href="http://www.microsoft.com/technet/archive/security/news/crssite.mspx" data-linktype="external">CSS</a> is a security vulnerability that potentially enables a malicious user to &quot;inject&quot; code into a user's session with a web site. Unlike most security vulnerabilities, CSS doesn't apply to any single vendor's products - instead, it can affect any software that runs on a web server and doesn't follow defensive programming practices. In early 2000, Microsoft and <a href="http://www.cert.org/" data-linktype="external">CERT</a> worked together to inform the software industry of the issue and lead an industry-wide response to it.</p>
<p><strong>How does CSS work?</strong><br/>
A good description is available in the form of an <a href="http://www.microsoft.com/technet/archive/security/news/exsumcs.mspx" data-linktype="external">executive summary</a> and a <a href="http://www.microsoft.com/technet/archive/security/news/crsstfaq.mspx" data-linktype="external">FAQ</a>. However, at a high level of detail, here's how CSS works. Suppose Web Site A offers a search feature that lets a user type a word or phrase to search for. If the user typed &quot;banana&quot; in as the search phrase, the site would search for the phrase, then generate a web page saying &quot;I'm sorry, but I can't find the word 'banana'&quot;. It would send the web page to his browser, which would then parse the page and display it.
Now suppose that, instead of entering &quot;banana&quot; as the search phrase, the user entered something like &quot;banana ‹SCRIPT› ‹Alert('Hello');› ‹/SCRIPT›&quot;. If the search feature were written to blindly use whatever search phrase it's provided, it would search for the entire string, and create a web page saying &quot;I'm sorry, but I can't find the word &quot;banana ‹SCRIPT› ‹Alert('Hello');› ‹/SCRIPT›&quot;&quot;. However, all of the text beginning with &quot;‹SCRIPT›&quot; and ending with &quot;‹/SCRIPT›&quot; is actually program code, so when the page was processed, a dialogue box would be displayed by the user's browser, saying &quot;Hello&quot;.
So far, this example has only shown how a user could &quot;relay&quot; code off a web server and make it run on his own machine. That's not a security vulnerability. However, it's possible for a malicious web site operator to invoke this vulnerability to run on the computer of a user who visits his site. If Web Site B were operated by a malicious user who was able to entice the user into visiting it and clicking a hyperlink, Web Site B could go to Web Site A, fill in the search page with malicious script, and submit it on behalf of the user. The resulting page would return to the user (since the user, having clicked on the hyperlink, was ultimately the requester), and process on the user's machine.</p>
<p><strong>What could the script do on the user's machine?</strong><br/>
The script from Web Site B (the attacker's site) would run on the user's machine as though it had come from Web Site A. In practical terms, this would mean two things:</p>
<ul>
<li>It would run using the security settings on the user's machine that were appropriate to Web Site A.</li>
<li>The script from Web Site B would be able to access cookies and any other data on the user's system that belonged to Web Site A.</li>
</ul>
<p><strong>Would it matter what browser the user was using?</strong><br/>
No. The important point here is that the problem lies with the software on the web server, not with the browser. The vulnerability could potentially occur anytime software on the web server blindly uses whatever inputs it's provided. Instead, it should filter out any inputs that aren't appropriate. In the example above, the search engine should strip out any characters that could be used to inject script into the search process, such as &quot;&quot;. A full description of the characters that should be filtered is available in Knowledge Base article <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;252985&amp;sd=tech" data-linktype="external">Q252985</a>.</p>
<p><strong>What's wrong with IIS?</strong><br/>
Three services provided by IIS don't properly filter their inputs, and as a result could be used in a cross-site scripting attack. The services are:</p>
<ul>
<li>A search facility that allows IIS help files to be searched. The facility is only provided in IIS 5.0 and 5.1, so only these versions are affected by the vulnerability.</li>
<li>A message that's returned when someone requests a web page that's been moved to a new location. (Such a message is known as a redirect response). The versions of this message that are produced by IIS 4.0, 5.0 and 5.1 are affected by the vulnerability. However, a successful attack could only be carried out via this message if the target of the attack was running a browser other than Internet Explorer.</li>
<li>Several error messages that are returned when a user's request for a web page results in an error. The default versions of these messages produced in IIS 4.0 and 5.0 are affected by the vulnerability.</li>
</ul>
<p><strong>What would these vulnerabilities enable an attacker to do?</strong><br/>
The vulnerabilities would allow an attacker who operated a web site and was able to lure another user into clicking a link on it to carry out a cross-site scripting attack via another web site that was running IIS. As discussed above, this would enable the attacker to run script in the user's browser using the security settings of the other web site (the one running IIS), and to access cookies and other data belonging to it.</p>
<p><strong>You said above that one of the vulnerabilities could only be exploited if the user was using a browser other than IE. Why is this?</strong><br/>
In the case of the error message that's returned when a web page has been moved, IE doesn't actually display the text in the error message. Instead, it processes information elsewhere in the server's response and immediately takes the user to the new page. As a result, it's not susceptible to the cross-site scripting error. Other browsers may or may not work similarly, depending on how they implement the handling of redirect responses.</p>
<p><strong>Does this vulnerability provide any way for the attacker to harm my web site?</strong><br/>
No. The attacker couldn't take any action against your site, but would be able to use your site as an unwitting accomplice in an attack against people who may visit your site.</p>
<p><strong>You said that the point of the attack would be for the attacker to get script running in the user's browser using the security settings of my web site. What specific capabilities would the attacker gain by doing this?</strong><br/>
It would vary from site to site, based on what <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/zone_ovr.mspx" data-linktype="external">Security Zone</a> the attacker's site and yours were placed in.</p>
<ul>
<li>If they were both in the same zone (and by default, all web sites reside in the Internet Zone unless the user moves them), they would both be subject to exactly the same security restrictions and the attacker would gain nothing through the vulnerability.</li>
<li>If the user had put the attacker's site into a more restricted zone than yours, the attacker would gain the ability for his script to do anything on the user's computer that script from your site could do.</li>
<li>If the user had put your site into a more restricted zone than yours, the attacker would actually lose capabilities through the attack.</li>
</ul>
<p>It's important to note, however, that regardless of the security settings, the attacker's script would always be able to access cookies and any other data on the user's system belonging to the third-party site. This is because, as far as the browser can tell, the attacker is the third-party site.</p>
<p><strong>How does the patch eliminate the vulnerability?</strong><br/>
The patch eliminates the vulnerability by ensuring that both of the services discussed above properly filter their inputs before using them.</p>
<h2 id="patch-availability">Patch availability</h2>
<p><strong>Download locations for this patch</strong></p>
<ul>
<li><p>Microsoft IIS 4.0:</p>
<ul>
<li><p>Windows NT 4.0 Workstation, Windows NT 4.0 Server, or Windows NT 4.0 Server, Enterprise Edition:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?displaylang=en&amp;familyid=7dd8f695-fa97-4378-b57b-7bccf3533be3" data-linktype="external">http://www.microsoft.com/Downloads/details.aspx?displaylang=en&amp;FamilyID=7DD8F695-FA97-4378-B57B-7BCCF3533BE3</a></p>
</li>
<li><p>Windows NT 4.0 Server, Terminal Server Edition:</p>
<p>Included in the <a href="http://support.microsoft.com/kb/317636" data-linktype="external">Windows NT Server 4.0, Terminal Server Edition Security Rollup Package</a></p>
</li>
</ul>
</li>
<li><p>Microsoft IIS 5.0:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?displaylang=en&amp;familyid=7dd8f695-fa97-4378-b57b-7bccf3533be3" data-linktype="external">http://www.microsoft.com/Downloads/details.aspx?displaylang=en&amp;FamilyID=7DD8F695-FA97-4378-B57B-7BCCF3533BE3</a></p>
</li>
<li><p>Microsoft IIS 5.1:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?familyid=c87bad03-a4b8-4199-8259-8a37af61ef63&amp;displaylang=en" data-linktype="external">https://www.microsoft.com/download/details.aspx?FamilyID=c87bad03-a4b8-4199-8259-8a37af61ef63&amp;DisplayLang=en</a></p>
</li>
</ul>
<h4 id="additional-information-about-this-patch">Additional information about this patch</h4>
<p><strong>Installation platforms:</strong></p>
<ul>
<li>The IIS 4.0 patch can be installed on systems running Windows NT 4.0 <a href="http://support.microsoft.com/kb/241211" data-linktype="external">Service Pack 6a</a>.</li>
<li>The Windows NT Server 4.0, Terminal Server Edition Security Rollup Package can be installed on Windows NT 4.0 Terminal Service Edition <a href="https://www.microsoft.com/download/details.aspx?familyid=7ad5e590-56c5-49c2-bfb9-e5bb988f1ac7&amp;displaylang=en" data-linktype="external">Service Pack 6</a>.</li>
<li>The IIS 5.0 patch can be installed on systems running Windows 2000 <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp1/default.mspx" data-linktype="external">Service Pack 1</a> or <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx" data-linktype="external">Service Pack 2</a>.</li>
<li>The IIS 5.1 patch can be installed on systems running Windows XP Professional <a href="http://www.microsoft.com/windowsxp/downloads/updates/sp1/default.mspx" data-linktype="external">Gold</a>.</li>
</ul>
<p><strong>Inclusion in future service packs:</strong></p>
<ul>
<li>No additional service packs are planned for Windows NT 4.0.</li>
<li>The IIS 5.0 fixes will be included in Windows 2000 Service Pack 3.</li>
<li>The IIS 5.1 fixes will be included in Windows XP Service Pack 1.</li>
</ul>
<p><strong>Reboot needed:</strong></p>
<ul>
<li>IIS 4.0: A reboot can be avoid by stopping the IIS service, installing the patch with the /z switch, then restarting the service. Knowledge Base article Q319733 provides additional information on this procedure.</li>
<li>IIS 5.0: No.</li>
<li>IIS 5.1: No. (In some cases, a pop-up dialogue may say that the system needs to be rebooted in order for the patch installation process to be completed. This dialogue, if it appears, can be ignored)</li>
</ul>
<p><strong>Superseded patches:</strong></p>
<ul>
<li>IIS 4.0 and 5.0: This patch supersedes the one provided in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-044" data-linktype="external">MS01-044</a>. (This is the previous cumulative patch for IIS 4.0 and 5.0, and supersedes additional patches)</li>
<li>IIS 5.1: None</li>
<li>The Windows NT Sever 4.0, Terminal Server Edition Security Roll-up Package supersedes the patches provided in the following security bulletins:
<ul>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-041" data-linktype="external">MS99-041</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-046" data-linktype="external">MS99-046</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-056" data-linktype="external">MS99-056</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-060" data-linktype="external">MS99-060</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-005" data-linktype="external">MS00-005</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-006" data-linktype="external">MS00-006</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-007" data-linktype="external">MS00-007</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-021" data-linktype="external">MS00-021</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-027" data-linktype="external">MS00-027</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-029" data-linktype="external">MS00-029</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-040" data-linktype="external">MS00-040</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-047" data-linktype="external">MS00-047</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-052" data-linktype="external">MS00-052</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-083" data-linktype="external">MS00-083</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-087" data-linktype="external">MS00-087</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-091" data-linktype="external">MS00-091</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-094" data-linktype="external">MS00-094</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-100" data-linktype="external">MS00-100</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-003" data-linktype="external">MS01-003</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-008" data-linktype="external">MS01-008</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-009" data-linktype="external">MS01-009</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-017" data-linktype="external">MS01-017</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-033" data-linktype="external">MS01-033</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-040" data-linktype="external">MS01-040</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-041" data-linktype="external">MS01-041</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-052" data-linktype="external">MS01-052</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms02-001" data-linktype="external">MS02-001</a>.</li>
</ul>
</li>
</ul>
<p><strong>Verifying patch installation:</strong></p>
<p>IIS 4.0:</p>
<p>Windows NT 4.0 Workstation, Server and Server, Enterprise Edition:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q319733.</p>
</li>
<li><p>To verify the individual files, consult the file manifest in Knowledge Base article Q319733.</p>
</li>
</ul>
<p>Windows NT 4.0 Terminal Server Edition:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q317636.</p>
</li>
</ul>
<p>IIS 5.0:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP3\Q319733.</p>
</li>
<li><p>To verify the individual files, use the date/time and version information provided in the following registry key:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP3\Q319733\Filelist.</p>
</li>
</ul>
<p>IIS 5.1:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q319733.</p>
</li>
<li><p>To verify the individual files, use the date/time and version information provided in the following registry key:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q319733\Filelist.</p>
</li>
</ul>
<p><strong>Caveats:</strong></p>
<ol>
<li><p>The fixes for four vulnerabilities affecting IIS 4.0 servers are not included in the patch, because they require administrative action rather than a software change. Administrators should ensure that in addition to applying this patch, they also have taken the administrative action discussed in the following bulletins:</p>
<ul>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-028" data-linktype="external">MS00-028</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-025" data-linktype="external">MS00-025</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-025" data-linktype="external">MS99-025</a> (which discusses the same issue as Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms98-004" data-linktype="external">MS98-004</a>)</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-013" data-linktype="external">MS99-013</a></li>
</ul>
</li>
<li><p>The patch does not include fixes for vulnerabilities involving non-IIS products like Front Page Server Extensions and Index Server, even though these products are closely associated with IIS and typically installed on IIS servers. At this writing, the bulletins discussing these vulnerabilities are:</p>
<ul>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-043" data-linktype="external">MS01-043</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-025" data-linktype="external">MS01-025</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-084" data-linktype="external">MS00-084</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-018" data-linktype="external">MS00-018</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-006" data-linktype="external">MS00-006</a></li>
</ul>
<p>There is, however, one exception. The fix for the vulnerability affecting Index Server which is discussed in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-033" data-linktype="external">MS01-033</a> is included in this patch. We have included it because of the seriousness of the issue for IIS servers.</p>
</li>
<li><p>Customers using IIS 4.0 should ensure that they have followed the correct installation order before installing this or any security patch. Specifically, customers should ensure that Windows NT 4.0 Service Pack 6a has been applied (or re-applied) after installing the IIS 4.0 service.</p>
</li>
<li><p>Customers using Site Server should be aware that a previously documented issue involving intermittent authentication errors has been determined to affect this and a small number of other patches. Microsoft Knowledge Base article <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;q317815" data-linktype="external">Q317815</a>discusses the issue and how resolve it.</p>
</li>
</ol>
<p><strong>Localization:</strong></p>
<p>Localized versions of this patch are available at the locations discussed in &quot;Patch Availability&quot;.</p>
<p><strong>Obtaining other security patches:</strong></p>
<p>Patches for other security issues are available from the following locations:</p>
<ul>
<li>Security patches are available from the <a href="http://go.microsoft.com/fwlink/?linkid=21129" data-linktype="external">Microsoft Download Center</a>, and can be most easily found by doing a keyword search for &quot;security_patch&quot;.</li>
</ul>
<h4 id="other-information">Other information:</h4>
<p><strong>Acknowledgments</strong></p>
<p>Microsoft <a href="http://technet.microsoft.com/security/bulletin/policy" data-linktype="external">thanks</a> the following people for reporting this issue to us and working with us to protect customers:</p>
<ul>
<li>eEye Digital Security (<a href="http://www.eeye.com/" data-linktype="external">http://www.eeye.com</a>) for reporting the buffer overrun in the ASP chunked encoding implementation.</li>
<li>Serge Mister of Entrust, Inc., (<a href="http://www.entrust.com/" data-linktype="external">http://www.entrust.com</a>) for reporting the buffer overrun affecting the HTTP header handling.</li>
<li>Dave Aitel of @Stake (<a href="http://www.atstake.com/" data-linktype="external">http://www.atstake.com</a>) and Peter Grundl of KPMG for reporting the buffer overrun in the HTR ISAPI extension.</li>
<li>Dave Aitel of @Stake (<a href="http://www.atstake.com/" data-linktype="external">http://www.atstake.com</a>) for reporting the access violation in URL error handling.</li>
<li>Joe Smith (jsm1th@hotmail.com) and zenomorph ( admin@cgisecurity.com) of <a href="http://www.cgisecurity.com/" data-linktype="external">http:// www.cgisecurity.com</a>) for reporting the cross-site scripting vulnerability in the IIS Help File search facility.</li>
<li>Keigo Yamazaki of the LAC SNS Team (<a href="http://www.lac.co.jp/security" data-linktype="external">http://www.lac.co.jp/security/</a>) for reporting the cross-site scripting vulnerability affecting redirect response messages.</li>
<li>Thor Larholm of <a href="http://www.jubii.dk/" data-linktype="external">Jubii A/S</a> for reporting the cross-site scripting vulnerability affecting HTTP error pages.</li>
</ul>
<p><strong>Support:</strong></p>
<ul>
<li>Microsoft Knowledge Base article Q319733 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the <a href="http://support.microsoft.com/?scid=fh;en-us;kbhowto" data-linktype="external">Microsoft Online Support</a> web site.</li>
<li>Technical support is available from <a href="http://support.microsoft.com/directory/question.asp?sd=gn&amp;fr=0" data-linktype="external">Microsoft Product Support Services</a>. There is no charge for support calls associated with security patches.</li>
</ul>
<p><strong>Security Resources:</strong> The <a href="http://www.microsoft.com/technet/security/default.mspx" data-linktype="external">Microsoft TechNet Security</a> Web Site provides additional information about security in Microsoft products.</p>
<p><strong>Disclaimer:</strong></p>
<p>The information provided in the Microsoft Knowledge Base is provided &quot;as is&quot; without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.</p>
<p><strong>Revisions:</strong></p>
<ul>
<li>V1.0 (April 10, 2002): Bulletin Created.</li>
<li>V1.1 (April 11, 2002): Bulletin updated to note that IIS 4.0 systems do not need to be rebooted after installing the patch.</li>
<li>V1.2 (April 12, 2002): Caveat added to document Site Server authentication issue.</li>
<li>V1.3 (May 6, 2002): Bulletin updated to advise availability of Windows NT 4.0 Server, Terminal Server Edition Security Rollup Package.</li>
<li>V1.4 (February 28, 2003): Updated download links to Windows Update.</li>
</ul>
<p><em>Built at 2014-04-18T13:49:36Z-07:00</em></p>

							<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none font-size-h4 margin-bottom-xs">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->



						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>

						<div
							class="font-size-sm right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Page Actions">

							<div id="affixed-right-container" class="doc-outline is-vertically-scrollable">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
