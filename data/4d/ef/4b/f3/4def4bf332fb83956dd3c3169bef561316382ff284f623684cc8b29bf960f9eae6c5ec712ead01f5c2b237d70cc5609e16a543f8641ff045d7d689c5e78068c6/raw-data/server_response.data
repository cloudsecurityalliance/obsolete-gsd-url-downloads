<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>7df7ec13b1d222ac3a66797fbe432605ea8f973f - device/google/dragon - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/device/google/dragon/%2B/7df7ec13b1d222ac3a66797fbe432605ea8f973f">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/device/">device</a> / <a class="Breadcrumbs-crumb" href="/device/google/">google</a> / <a class="Breadcrumbs-crumb" href="/device/google/dragon/">dragon</a> / <span class="Breadcrumbs-crumb">7df7ec13b1d222ac3a66797fbe432605ea8f973f</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>7df7ec13b1d222ac3a66797fbe432605ea8f973f</td><td><span>[<a href="/device/google/dragon/+log/7df7ec13b1d222ac3a66797fbe432605ea8f973f">log</a>]</span> <span>[<a href="/device/google/dragon/+archive/7df7ec13b1d222ac3a66797fbe432605ea8f973f.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Andy Hung &lt;hunga@google.com&gt;</td><td>Tue Jul 18 14:57:51 2017 -0700</td></tr><tr><th class="Metadata-title">committer</th><td>android-build-team Robot &lt;android-build-team-robot@google.com&gt;</td><td>Tue Aug 22 23:11:44 2017 +0000</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/">47a6ffe7becdd3968bb1deb9fec3469bb4954ea0</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f%5E">90ff43cde176145ff0a02ed85eff985583fbec7a</a> <span>[<a href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Fix audio record pre-processing

proc_buf_out consistently initialized.
intermediate scratch buffers consistently initialized.
prevent read failure from overwriting memory.

Test: POC, CTS, camera record
Bug: 62873231
Change-Id: <a href="https://android-review.googlesource.com/#/q/Ie26e12a419a5819c1c5c3a0bcf1876d6d7aca686">Ie26e12a419a5819c1c5c3a0bcf1876d6d7aca686</a>
(cherry picked from commit 6d7b330c27efba944817e647955da48e54fd74eb)
</pre><ul class="DiffTree"><li><a href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/audio/hal/audio_hw.c">audio/hal/audio_hw.c</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f%5E%21/#F0">diff</a>]</span></li></ul><div class="DiffSummary">1 file changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 47a6ffe7becdd3968bb1deb9fec3469bb4954ea0</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - Android.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/Android.mk">Android.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - AndroidProducts.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/AndroidProducts.mk">AndroidProducts.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - BoardConfig.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/BoardConfig.mk">BoardConfig.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - CleanSpec.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/CleanSpec.mk">CleanSpec.mk</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - DragonKeyboard/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/DragonKeyboard/">DragonKeyboard/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - aosp_dragon.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/aosp_dragon.mk">aosp_dragon.mk</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - audio/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/audio/">audio/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - audio_effects.conf"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/audio_effects.conf">audio_effects.conf</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - audio_policy_configuration.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/audio_policy_configuration.xml">audio_policy_configuration.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - audio_policy_volumes_drc.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/audio_policy_volumes_drc.xml">audio_policy_volumes_drc.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - bcmdhd.cal"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/bcmdhd.cal">bcmdhd.cal</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - bluetooth/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/bluetooth/">bluetooth/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - board-info.txt"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/board-info.txt">board-info.txt</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - com.nvidia.nvsi.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/com.nvidia.nvsi.xml">com.nvidia.nvsi.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - config.fs"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/config.fs">config.fs</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - crash_collector/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/crash_collector/">crash_collector/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - device.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/device.mk">device.mk</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - dump_bq25892.sh"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/dump_bq25892.sh">dump_bq25892.sh</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - dumpstate/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/dumpstate/">dumpstate/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - enctune.conf"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/enctune.conf">enctune.conf</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - factory-images/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/factory-images/">factory-images/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - fstab.dragon"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/fstab.dragon">fstab.dragon</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - fstab.dragon.nocrypt"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/fstab.dragon.nocrypt">fstab.dragon.nocrypt</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - health/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/health/">health/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - init.dragon.rc"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/init.dragon.rc">init.dragon.rc</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - init.dragon.usb.rc"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/init.dragon.usb.rc">init.dragon.usb.rc</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - init.recovery.dragon.rc"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/init.recovery.dragon.rc">init.recovery.dragon.rc</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - init_regions.sh"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/init_regions.sh">init_regions.sh</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - lights/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/lights/">lights/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - manifest.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/manifest.xml">manifest.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - media_codecs.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/media_codecs.xml">media_codecs.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - media_codecs_performance.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/media_codecs_performance.xml">media_codecs_performance.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - media_profiles.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/media_profiles.xml">media_profiles.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - mixer_paths_0.xml"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/mixer_paths_0.xml">mixer_paths_0.xml</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - overlay/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/overlay/">overlay/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - power/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/power/">power/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - product.mk"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/product.mk">product.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - proprietary-blobs.txt"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/proprietary-blobs.txt">proprietary-blobs.txt</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - recovery/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/recovery/">recovery/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - releasetools.py"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/releasetools.py">releasetools.py</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - rt5677_elf_vad"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/rt5677_elf_vad">rt5677_elf_vad</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - seccomp_policy/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/seccomp_policy/">seccomp_policy/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - self-extractors/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/self-extractors/">self-extractors/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - sensor_hub/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/sensor_hub/">sensor_hub/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - sepolicy/"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/sepolicy/">sepolicy/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - speakerdsp.ini"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/speakerdsp.ini">speakerdsp.ini</a></li><li class="FileList-item FileList-item--executableFile" title="Executable file - touchfwup.sh"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/touchfwup.sh">touchfwup.sh</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - tune-thermal-gov.sh"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/tune-thermal-gov.sh">tune-thermal-gov.sh</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - ueventd.dragon.rc"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/ueventd.dragon.rc">ueventd.dragon.rc</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - vendor_owner_info.txt"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/vendor_owner_info.txt">vendor_owner_info.txt</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - vendorsetup.sh"><a class="FileList-itemLink" href="/device/google/dragon/+/7df7ec13b1d222ac3a66797fbe432605ea8f973f/vendorsetup.sh">vendorsetup.sh</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>