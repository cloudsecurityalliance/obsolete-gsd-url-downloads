<!doctype html>
<html lang="en-US" style="margin:0px !important">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
  
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110011290-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110011290-1');
</script>
  
<!-- Global site tag (gtag.js) - Google Ads: 749377018 --> 
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-749377018"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'AW-749377018'); </script>  
	
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

	
<!-- Bootstrap Latest compiled and minified CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  
  	<title>Virtual Media Vulnerability in BMC Opens Servers to Remote Attack - Eclypsium </title>
<link rel="alternate" hreflang="en" href="/2019/09/03/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack/">
<meta name="description" content="Eclypsium research identified 47,000 servers with BMCs exposed to the Internet that are vulnerable to remote attacks. The USBAnywhere vulnerability allows an attacker to easily connect to a server and virtually mount any USB device of their choosing to the server remotely over any network including the Internet. ">
<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<link rel="canonical" href="/2019/09/03/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack/">
<meta name="author" content="Eclypsium">
<meta property="og:url" content="/2019/09/03/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack/">
<meta property="og:site_name" content="Eclypsium">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Virtual Media Vulnerability in BMC Opens Servers to Remote Attack - Eclypsium ">
<meta property="og:description" content="Eclypsium research identified 47,000 servers with BMCs exposed to the Internet that are vulnerable to remote attacks. The USBAnywhere vulnerability allows an attacker to easily connect to a server and virtually mount any USB device of their choosing to the server remotely over any network including the Internet. ">
<meta property="og:image" content="/wp-content/uploads/2019/09/feature-image-usbanywhere.jpg">
<meta property="og:image:secure_url" content="/wp-content/uploads/2019/09/feature-image-usbanywhere.jpg">
<meta property="og:image:width" content="1520">
<meta property="og:image:height" content="1000">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Virtual Media Vulnerability in BMC Opens Servers to Remote Attack - Eclypsium ">
<meta name="twitter:description" content="Eclypsium research identified 47,000 servers with BMCs exposed to the Internet that are vulnerable to remote attacks. The USBAnywhere vulnerability allows an attacker to easily connect to a server and virtually mount any USB device of their choosing to the server remotely over any network including the Internet. ">
<meta name="twitter:image:src" content="/wp-content/uploads/2019/09/feature-image-usbanywhere-1024x674.jpg">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Virtual Media Vulnerability in BMC Opens Servers to Remote Attack Comments Feed" href="/2019/09/03/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=5.8.1" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-horizontal-list-0-css" href="/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.min.css?ver=1" type="text/css" media="all">
<link rel="stylesheet" id="eclypsium-style-css" href="/wp-content/themes/eclypsium-10-28-21a/style.css?ver=5.8.1" type="text/css" media="all">
<script type="text/javascript" id="wpml-browser-redirect-js-extra">
/* <![CDATA[ */
var wpml_browser_redirect_params = {"pageLanguage":"en","languageUrls":{"en_us":"\/2019\/09\/03\/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack\/","en":"\/2019\/09\/03\/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack\/","us":"\/2019\/09\/03\/usbanywhere-bmc-vulnerability-opens-servers-to-remote-attack\/"},"cookie":{"name":"_icl_visitor_lang_js","domain":"wp.eclypsium.io","path":"\/","expiration":24}};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/sitepress-multilingual-cms/dist/js/browser-redirect/app.js?ver=4.4.12" id="wpml-browser-redirect-js"></script>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/1673"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.1">
<link rel="shortlink" href="/?p=1673">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2019%2F09%2F03%2Fusbanywhere-bmc-vulnerability-opens-servers-to-remote-attack%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2019%2F09%2F03%2Fusbanywhere-bmc-vulnerability-opens-servers-to-remote-attack%2F&#038;format=xml">
<meta name="generator" content="WPML ver:4.4.12 stt:1,28;">
<link rel="pingback" href="/xmlrpc.php"><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><link rel="preload" as="style" href="/wp-content/plugins/code-prettify/prettify/prettify.css"><link rel="icon" href="/wp-content/uploads/2018/12/e-150x150.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2018/12/e-300x300.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/12/e-300x300.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/12/e-300x300.png">
  
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>	
	
	

	
	
<script src="/wp-content/themes/eclypsium-10-28-21a/js/eclypsium-main.js"></script>

	
<!-- Google Roboto Font -->
<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400;700;900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:100,300,400,700,900&amp;display=swap" rel="stylesheet">
	
	

</head>

<body class="post-template-default single single-post postid-1673 single-format-standard">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">
		<div class="site-branding">

		
		
		</div><!-- .site-branding -->

		<nav id="site-navigation" class="main-navigation">
		</nav><!-- #site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">


<div id="single-post">
<div class="nav-padding"></div>

	


<div id="main-nav" class="container-fluid no-pm d-none d-md-block">
	<div class="container">
		<div class="row no-pm justify-content-center">
			<div id="menu-top" class="col-lg-10 no-pm">
				
				<div id="nav-logo-container">
					<a href="/"><img id="nav-logo" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-ps.svg"></a>
				</div>
				<div id="nav-links-container">
					<div id="nav-links-top">
						<a class="nav-link-small" href="/blog/">BLOG</a>
						<a class="nav-link-small" href="/contact/">CONTACT US</a>						
					</div>
					<div id="nav-links-bottom-container">
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/enterprise-firmware-security/">PRODUCT</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/enterprise-firmware-security/endpoints/">ENDPOINTS</a>
                <a class="nav-link-sub" href="/enterprise-firmware-security/servers/">SERVERS<br></a>
								<a class="nav-link-sub" href="/enterprise-firmware-security/network/">NETWORK <br>DEVICES</a>
								<a class="nav-link-sub" href="/enterprise-firmware-security/platform/">PLATFORM &amp; <br>INTEGRATIONS</a>								
							</div>
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/solutions/">SOLUTIONS</a>
							<div class="nav-sub-pages">
                
                
								<a class="nav-link-sub" href="/solutions/identify/">IDENTIFY</a>
								<a class="nav-link-sub" href="/solutions/verify/">VERIFY</a>
								<a class="nav-link-sub" href="/solutions/fortify/">FORTIFY</a>
								<a class="nav-link-sub" href="/solutions/zero-trust/">ZERO TRUST</a>  
								<a class="nav-link-sub" href="/solutions/supply-chain-risk-management/">SUPPLY CHAIN</a>
                
								<a class="nav-link-sub" href="/risk-assessment/">DEVICE HEALTH</a>								
								<a class="nav-link-sub" href="/remote-work/">REMOTE WORK</a>
								<a class="nav-link-sub" href="/travel/">HIGH-RISK <br>TRAVEL</a>

							</div>
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/resources/">RESOURCES</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/know-your-own-device/">KNOW YOUR <br>OWN DEVICE</a>	                
								<a class="nav-link-sub" href="/firmware-threat-report/">THREAT REPORT</a> 
								<a class="nav-link-sub" href="/resources/#solutionbriefs">SOLUTION BRIEFS</a>								
								<a class="nav-link-sub" href="/resources/#productbriefs">PRODUCT BRIEFS</a>								
								<a class="nav-link-sub" href="/resources/#whitepapers">WHITE PAPERS</a>	
								<a class="nav-link-sub" href="/resources/#videos">VIDEOS</a>
								<a class="nav-link-sub" href="/resources/#bestpractices">BEST PRACTICES</a>
							</div>
							
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/company/">COMPANY</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/events/">EVENTS</a>
								<a class="nav-link-sub" href="/news/">NEWS ROOM</a>
								<a class="nav-link-sub" href="/news#pressreleases">PRESS RELEASES</a>
								<a class="nav-link-sub" href="/careers/">CAREERS</a>
								<a class="nav-link-sub" href="/company#contact">CONTACT US</a>
								
							</div>
						</div>
					</div>
				</div>
        
        <div class="nav-request-btn-container">
						<a class="nav-request-btn" href="/demo/">REQUEST A DEMO</a>						
        </div>
				<!--
				<div class="nav-search-container">
					<img id="search-icon" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-search.svg">
					<input id="search-input" class=""  placeholder="Search ..." />
				</div>
				-->
				
			</div>
		</div>
	</div>	
</div>


<div id="mobile-nav" class="container-fluid no-pm">
	<div class="container">
		<div class="row no-pm">
			<div class="col-3 no-pm">

				<div id="mobile-nav-logo-container">
					<a href="/"><img id="nav-logo-mobile" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-ps.svg"></a>
				</div>
			
			
			</div>
      
      <div class="col-6 no-pm wrapper-center">
					<a class="nav-request-btn" href="/demo/">REQUEST A DEMO</a>						
	    </div>	
        
      <div class="col-3 no-pm ">

				<div class="mobile-nav-dot-container ">
					<div class="mobile-dots" tabIndex="1"></div>				
				</div>
			</div>

		</div>
		
		<div class="mobile-nav-bottom">
			<div class="row no-pm">
				<div class="col-12">
					<a class="nav-link-small" href="/blog/">BLOG</a>
					<a class="nav-link-small" href="/contact/">CONTACT US</a>                    
        </div>
			</div>	


			<div class="row no-pm divider-20 nav-link-big-container">
				<div class="col-6 col-md-3">
					<a class="nav-link-big-mobile" href="/enterprise-firmware-security/">PRODUCT</a>
					<div class="nav-sub-pages">
          
						<a class="nav-link-sub" href="/enterprise-firmware-security/endpoints/">ENDPOINTS</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/servers/">SERVERS</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/network/">NETWORK <br>DEVICES</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/platform/">PLATFORM &amp; <br>INTEGRATIONS</a>
          
          </div>
					<br><br>
					<a class="nav-link-big-mobile" href="/solutions/">SOLUTIONS</a>
					<div class="nav-sub-pages">
            
								<a class="nav-link-sub" href="/solutions/identify/">IDENTIFY</a>
								<a class="nav-link-sub" href="/solutions/verify/">VERIFY</a>
								<a class="nav-link-sub" href="/solutions/fortify/">FORTIFY</a>
								<a class="nav-link-sub" href="/solutions/zero-trust/">ZERO TRUST</a>  
								<a class="nav-link-sub" href="/solutions/supply-chain-risk-management/">SUPPLY CHAIN</a>
                
								<a class="nav-link-sub" href="/risk-assessment/">DEVICE HEALTH</a>								
								<a class="nav-link-sub" href="/remote-work/">REMOTE WORK</a>
								<a class="nav-link-sub" href="/travel/">HIGH-RISK <br>TRAVEL</a>
            
					</div>
					<br>


				</div>
				<div class="col-6 col-md-3 inline">
					<a class="nav-link-big-mobile" href="/company/">COMPANY</a>
					
					<div class="nav-sub-pages">
						<a class="nav-link-sub" href="/events/">EVENTS</a>						
						<a class="nav-link-sub" href="/news/">NEWS ROOM</a>
						<a class="nav-link-sub" href="/news#pressreleases">PRESS RELEASES</a>
						<a class="nav-link-sub" href="/careers/">CAREERS</a>
						<a class="nav-link-sub" href="/company/#contact">CONTACT US</a>
					</div>
					<br>
					<a class="nav-link-big-mobile" href="/resources/">RESOURCES</a>
					<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/know-your-own-device/">KNOW YOUR <br>OWN DEVICE</a>
            
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/firmware-threat-report/">THREAT REPORT</a>            							
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#solutionbriefs">SOLUTION BRIEFS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#productbriefs">PRODUCT BRIEFS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#whitepapers">WHITE PAPERS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#videos">VIDEOS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#bestpractices">BEST PRACTICES</a>						
						
					</div>
          
          <div class="divider-40"></div>
          

				</div>			
			</div>	
		</div>
	</div>
</div>	







	

<div class="container-fluid  no-pm">
	<div class="row no-pm">
		<div class="col-lg-12">

			<div class="container">
				<div class="row">
					<div class="col-lg-12 wrapper-center">




					</div>
				</div>
			</div>	
			
			
		</div>
	</div>
	

	</div>

			
		
	
	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		


  



<article id="post-1673" class="post-1673 post type-post status-publish format-standard has-post-thumbnail hentry category-research">
	<header class="entry-header bkgd-ltgrey">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 wrapper-center">

					<h1 class="entry-title">Virtual Media Vulnerability in BMC Opens Servers to Remote Attack</h1>						<div class="entry-meta">
							<span class="posted-on"><time class="entry-date published navy" datetime="2019-09-03T06:00:40-04:00">September 3, 2019</time><time class="updated" datetime="2019-09-19T15:42:51-04:00">September 19, 2019</time></span>&nbsp&nbsp&nbsp/&nbsp&nbsp&nbsp<span class="byline"> <span class="author vcard navy">Eclypsium</span></span>						</div><!-- .entry-meta -->
										</div>
				</div>
			</div>	

	</header><!-- .entry-header -->

	
	<div class="container-fluid no-pm bkgd-ltgrey wrapper-thumbnail"><div class="row no-pm"><div class="col-lg-12 no-pm"><div class="container"><div class="row"><div class="col-lg-12 wrapper-center no-pm">
			<div class="post-thumbnail">
				<img width="1520" height="1000" src="/wp-content/uploads/2019/09/feature-image-usbanywhere.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt loading="lazy" srcset="/wp-content/uploads/2019/09/feature-image-usbanywhere.jpg 1520w, /wp-content/uploads/2019/09/feature-image-usbanywhere-300x197.jpg 300w, /wp-content/uploads/2019/09/feature-image-usbanywhere-768x505.jpg 768w, /wp-content/uploads/2019/09/feature-image-usbanywhere-1024x674.jpg 1024w" sizes="(max-width: 1520px) 100vw, 1520px">			</div><!-- .post-thumbnail -->

		<img class="img-fluid" src="/wp-content/themes/eclypsium-10-28-21a/img/feature-image-shadow.png">  
                  <div class="bkgd-navy blog-email-sub-container">    
                    <div class="blog-email-wrapper cta">
                      <span class="white bold">Subscribe to Eclypsium’s Threat Report</span> 
                    </div>

                    <div class="blog-email-wrapper subbtn">
                        <!--[if lte IE 8]>
                      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
                      <![endif]-->
                      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
                      <script>
                        hbspt.forms.create({
                        portalId: "5610435",
                        formId: "8c6fcf7e-8993-484e-aebd-eedf458d6c21"
                      });
                      </script>
                    </div>
                  </div>
  
                </div></div></div></div></div></div>	
	
	
	<div class="entry-content">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
		
		
<p><a class="bold" href="/wp-content/uploads/2019/08/USBAnywhere.pdf">Download the PDF &gt;</a></p>



<p>Most security professionals are appropriately wary of unknown USB devices, and would (hopefully) never pick up an unknown, untrusted USB drive and plug it into their computer. However, our research has uncovered new vulnerabilities, which we collectively dubbed USBAnywhere, in the baseboard management controllers (BMCs) of Supermicro servers, which can <strong><em>allow an attacker to easily connect to a server and virtually mount any USB device of their choosing to the server, remotely over any network including the Internet</em></strong>. At the time of writing, we found at least 47,000 systems with their BMCs exposed to the Internet and using the relevant protocol. It is important to remember that these are only the BMCs that are directly exposed to the Internet. The same issues can be easily exploited by attackers who gain access to a corporate network.</p>



<p>Security researchers and others interested in the technical details of the vulnerabilities will want to visit our GitHub repository at <a href="https://github.com/eclypsium/USBAnywhere">https://github.com/eclypsium/USBAnywhere</a>.</p>



<h2>Introduction</h2>



<p>By design, BMCs are intended to allow administrators to perform out-of-band management of a server, and as a result are highly privileged components. In this case, the problem stems from several issues in the way that BMCs on Supermicro X9, X10 and X11 platforms implement virtual media, an ability to remotely connect a disk image as a virtual USB CD-ROM or floppy drive. When accessed remotely, the virtual media service allows plaintext authentication, sends most traffic unencrypted, uses a weak encryption algorithm for the rest, and is susceptible to an authentication bypass. These issues allow an attacker to easily gain access to a server, either by capturing a legitimate user’s authentication packet, using default credentials, and in some cases, without any credentials at all.</p>



<p>Once connected, the virtual media service allows the attacker to interact with the host system as a raw USB device. This means attackers can attack the server in the same way as if they had physical access to a USB port, such as loading a new operating system image or using a keyboard and mouse to modify the server, implant malware, or even disable the device entirely. The combination of easy access and straightforward attack avenues can allow unsophisticated attackers to remotely attack some of an organization’s most valuable assets.</p>



<h2>Gaining Remote USB Access</h2>



<p>Normally, access to the virtual media service is facilitated by a small Java application served by the BMC’s web interface. This application then connects to the virtual media service listening on TCP port 623 on the BMC.&nbsp; The service uses a custom packet-based format to authenticate the client and transport USB packets between client and server.</p>



<p>Our analysis of the authentication revealed the following issues:</p>



<ul><li><strong>Plaintext Authentication</strong><br>While the Java application uses a unique session ID for authentication, the service also allows the client to use a plaintext username and password.</li></ul>



<ul><li><strong>Unencrypted network traffic</strong><br>Encryption is available but must be requested by the client. The Java application provided with the affected systems use this encryption for the initial authentication packet but then use unencrypted packets for all other traffic.<br><br></li><li><strong>Weak encryption</strong><br>When encryption is used, the payload is encrypted with RC4 using a fixed key compiled into the BMC firmware. This key is shared across all Supermicro BMCs. RC4 has multiple published cryptographic weaknesses and has been prohibited from use in TLS (RFC7465).</li></ul>



<ul><li><strong>Authentication Bypass</strong> (X10 and X11 platforms only)<br>After a client has properly authenticated to the virtual media service and then disconnected, some of the service’s internal state about that client is incorrectly left intact.&nbsp; As the internal state is linked to the client’s socket file descriptor number, a new client that happens to be assigned the same socket file descriptor number by the BMC’s OS inherits this internal state.&nbsp; In practice, this allows the new client to inherit the previous client’s authorization even when the new client attempts to authenticate with incorrect credentials.</li></ul>



<p>Taken together, these weaknesses open several scenarios for an attacker to gain unauthorized access to virtual media. In the simplest case, an attacker could simply try the well-known default username and password for the BMC. However, even if the default password was changed, an attacker could still easily gain access. If a valid administrator had used virtual media since the BMC was last powered off, the authentication bypass vulnerability would allow an attacker to connect even without the proper username and password. Given that BMCs are intended to be always available, it is particularly rare for a BMC to be powered off or reset. As a result, the authentication bypass vulnerability is likely to be applicable unless the server has been physically unplugged or the building loses power.</p>



<p>Alternatively, the attacker could intercept traffic to the virtual media service and decrypt it with the fixed key stored both on the BMC and in the Java application. This last example would, of course, require the attacker to be in a position to intercept traffic.</p>



<p><strong><em>A scan of TCP port 623 across the Internet revealed 47,339 BMCs from over 90 different countries with the affected virtual media service publicly accessible.</em></strong></p>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="513" src="/wp-content/uploads/2019/08/usbanywhere_diagram-1024x513.png" alt class="wp-image-1702" srcset="/wp-content/uploads/2019/08/usbanywhere_diagram-1024x513.png 1024w, /wp-content/uploads/2019/08/usbanywhere_diagram-300x150.png 300w, /wp-content/uploads/2019/08/usbanywhere_diagram-768x385.png 768w, /wp-content/uploads/2019/08/usbanywhere_diagram.png 1520w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h2>Raw USB Access to Host System</h2>



<p>Once authenticated, the user can access a virtual USB hub on the BMC. This virtual hub supports up to 5 virtual downstream devices that can be configured in almost any fashion.&nbsp;</p>



<p>Normally, when a new USB is attached to a host, the new device presents the host with “descriptors” to identify the type of device and its configuration. For example, these descriptors are how a system can distinguish between a USB CD-ROM drive versus a printer versus a WiFi adapter and load the corresponding device drivers. The user is then able to interact with the host system by sending and receiving data over the USB endpoints defined by those descriptors.</p>



<p>However, the devices within the virtual USB hub of the Supermicro devices rely on software on the BMC to provide these descriptors. <strong><em>Consequently, the BMC hardware allows the software to be any USB device.</em></strong> This is how the Java application can be a virtual CD-ROM drive.</p>



<p>When coupled with frameworks such as <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://github.com/usb-tools/Facedancer" target="_blank">Facedancer</a>, which allow users to implement USB devices in software, an attacker can emulate any device they need. Such a combination of functionality could allow an attacker to boot the machine from a malicious USB image, exfiltrate data over a USB mass storage device, or use a virtual <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://shop.hak5.org/products/usb-rubber-ducky-deluxe" target="_blank">USB Rubber Ducky</a> that rapidly performs a sequence of carefully crafted keystrokes to perform virtually any other type of hacking against the BMC, the firmware, or the server it manages. In the following <a href="https://youtu.be/8UI7oicMisY">video</a>, our researchers demonstrate a proof-of-concept data exfiltration attack using Facedancer. <br></p>



<h2>Best Practices for Securing BMCs</h2>



<p>It is important to note that BMCs should never be directly exposed to the Internet. While the underlying issues described here would apply to connections over any network, direct exposure to the Internet greatly increases the likelihood of an attack.</p>



<p>BMCs are some of the most privileged components in enterprise technology today. With the ability to provide remote, out-of-band management for servers, BMCs provide virtually omnipotent control over a server and its contents. BMCs have also become one of the most active areas of security research due to their importance and reputation for being riddled with vulnerabilities. While it is well-known security best practice to isolate BMCs on their own private and secured network segment, it is also well-known that many organizations forget or ignore this step. A simple SHODAN scan reveals that there are at least 92,000 BMCs that are easily discoverable on the Internet at the time of this writing. </p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="380" src="/wp-content/uploads/2019/08/usbanywhere_shodan-1024x380.png" alt class="wp-image-1710" srcset="/wp-content/uploads/2019/08/usbanywhere_shodan-1024x380.png 1024w, /wp-content/uploads/2019/08/usbanywhere_shodan-300x111.png 300w, /wp-content/uploads/2019/08/usbanywhere_shodan-768x285.png 768w, /wp-content/uploads/2019/08/usbanywhere_shodan.png 1751w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<p>Given the speed with which new BMC vulnerabilities are being discovered and their incredible potential impact, there is no reason for enterprises to risk exposing them directly to the Internet.&nbsp;</p>



<p>BMCs that are not exposed to the Internet should also be carefully monitored for vulnerabilities and threats. While organizations are often fastidious at applying patches for their software and operating systems, the same is often not true for the firmware in their servers. <br><br><strong>Furthermore, this research should serve as a stark reminder that some BMC vulnerabilities can be easily abused even by unsophisticated attackers</strong>. While historically firmware attacks required either physical presence or an initial compromise of the OS, modern firmware and remote management functionality has increased the attack surface to include remote attacks directly against firmware.&nbsp; In this case, attackers with little more than a free tool to emulate a USB device can remotely gain full control over an enterprise server.  Just as applying application and OS security updates has become a critical part of maintaining IT infrastructure, keeping abreast of firmware security updates and deploying them regularly is required to defend against casual attacks targeting system firmware.<br></p>



<h2>Mitigation</h2>



<p>Supermicro quickly responded to disclosures from Eclypsium and collaborated with the Eclypsium team to develop a fix for the vulnerabilities described herein. Supermicro has committed to providing firmware updates for their X9, X10 and X11 platforms. Organizations using the Supermicro X9, X10 and X11 platforms are encouraged to visit Supermicro’s <a href="https://www.supermicro.com/support/security_center.cfm">Security Center</a> and <a href="https://www.supermicro.com/support/security_BMC_virtual_media.cfm">Virtual Media Vulnerability details page</a> for information on updating BMC firmware on these platforms.</p>



<p>In addition to vendor-supplied updates, organizations should adopt tools to proactively ensure the integrity of their firmware and identify vulnerabilities, missing protections, and any malicious implants in their firmware.<br></p>



<h2>Summary</h2>



<p>Through these vulnerabilities, an attacker can bypass authentication to access virtual media or, alternatively, intercept virtual media traffic to recover BMC credentials and capture data sent over virtual media devices.&nbsp; Further, the affected systems are shipped with default BMC credentials that have been found to be frequently unchanged, even on Internet-connected BMCs. Once credentials are obtained, an attacker can then perform any of a large number of USB-based attacks against the server remotely including data exfiltration, booting from untrusted OS images, or direct manipulation of the system via a virtual keyboard and mouse.</p>



<p>This vulnerability further highlights the importance of monitoring and securing servers beyond the scope of the operating system and applications they run. Servers have an exceedingly broad firmware attack surface, of which BMCs are but one example. Network adapters, physical ports, drives, processors and chipsets, and dozens of other components rely on firmware that contain exploitable vulnerabilities. Threats operating at this level can easily subvert traditional security measures and put the device, the system it is part of, and the integrity of all data stored on that system at risk. Monitoring firmware integrity and deploying firmware security updates are fundamental measures to build solid server security.<br></p>



<h2>Disclosure Timeline</h2>



<p></p><p style="font-size:75%;"><strong>2019-06-19</strong>: Eclypsium reports vulnerability to Supermicro<br><strong>2019-07-09</strong>: Eclypsium reports additional findings to Supermicro<br><strong>2019-07-29</strong>: Supermicro acknowledges report and develops a fix<br><strong>2019-08-16</strong>: Eclypsium notifies CERT/CC due to large number of public systems affected<br><strong>2019-08-16</strong>: Supermicro confirms intent to publicly release firmware by September 3rd<br><strong>2019-08-21</strong>: Eclypsium attempts to notify CERT/CC for the second time<br><strong>2019-08-23</strong>: Eclypsium notifies network operators whose networks contain affected, Internet-accessible BMCs<br>
<strong>2019-08-23</strong>: Eclypsium discovers that Supermicro X9 platforms are also affected<br>
<strong>2019-09-03</strong>: Eclypsium publishes vulnerability details and presents at Open Source Firmware Conference.</p><p></p>
				</div>
			</div>
		</div>	
					
	</div><!-- .entry-content -->
	

	<footer class="entry-footer section">
		
		
		<div class="container-fluid no-pm  wrapper-thumbnail"><div class="row no-pm"><div class="col-lg-12 no-pm"><div class="container"><div class="row"><div class="col-lg-12 wrapper-center "><span class="cat-links">Posted in <a href="/category/research/" rel="category tag">Research</a></span></div></div></div></div></div></div>
		
		
		
		
	</footer><!-- .entry-footer -->
</article><!-- #post-1673 -->
<div class="container-fluid no-pm bkgd-ltgrey post-nav"><div class="row no-pm"><div style="text-align:right" class="col-5">&laquo;&nbsp;<a href="/2019/08/10/screwed-drivers-signed-sealed-delivered/" rel="prev">Screwed Drivers &#8211; Signed, Sealed, Delivered</a></div><div class="col-2 wrapper-center">|</div><div class="col-5"><a href="/2019/10/23/protecting-system-firmware-storage/" rel="next">Protecting System Firmware Storage</a>&nbsp;&raquo;</div></div></div>
			
			

			
			
		</main><!-- #main -->
	</div><!-- #primary -->
</div>

	</div><!-- #content -->

	<footer id="colophon" class="site-footer">
		<div class="site-info">

			<div class="footer container-fluid">
				
				
				<div class="row no-pm">
					<div class="col-lg-12 wrapper-center">
							<div id="backtotop" class="navy"><img width="16" height="10" class="footer-arrow" src="/wp-content/themes/eclypsium-10-28-21a/img/arrow-up-blue.svg"><br>
						<b>Back to Top</b></div>
					</div>
				</div>	
				
				
				<div class="row no-pm divider-30">
					<div class="col-lg-12">
						<a class="orange bold" href="https://info.eclypsium.com/subscribe">Subscribe to Below the Surface</a><br><span style="color:#c4c4c4">A firmware and hardware threat report from our research team.</span>
						
					</div>
				</div>	
				
				<div class="row no-pm divider-40">
					<div class="col-lg-12">

						<a href="https://www.linkedin.com/company/eclypsium" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-li.svg"><img< a>
						<a href="https://twitter.com/eclypsium" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-tw.svg"><img< a>
						<a href="https://www.facebook.com/Eclypsium/" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-fb.svg"><img< a>

							
						
					</img<></a></img<></a></img<></a></div>
				</div>	
				
			<div class="row no-pm divider-10">
					<div class="col-lg-12">
					<a class href="/privacy/">Privacy Policy</a><br><br>					
				</div>
				</div>	
							
				<div class="row no-pm">
					<div class="col-lg-12">
						<div id="copyright">&copy;<script type="text/javascript">document.write(new Date().getFullYear())</script> Eclypsium, Inc.</div>
					</div>
				</div>	
				<div class="row no-pm">
					<div class="col-lg-12">
							<a href="/"><img class="footer-logo" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-grey.svg"></a>
					</div>
				</div>	
				

			</div>
		
		
		</div><!-- .site-info -->
	</footer><!-- #colophon -->


</div><!-- #page -->

<script type="text/javascript" id="code-prettify-js-extra">
/* <![CDATA[ */
var codePrettifyLoaderBaseUrl = "\/wp-content\/plugins\/code-prettify\/prettify";
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/code-prettify/prettify/run_prettify.js?ver=1.4.0" id="code-prettify-js"></script>
<script type="text/javascript" src="/wp-content/themes/eclypsium-10-28-21a/js/navigation.js?ver=20151215" id="eclypsium-navigation-js"></script>
<script type="text/javascript" src="/wp-content/themes/eclypsium-10-28-21a/js/skip-link-focus-fix.js?ver=20151215" id="eclypsium-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="/wp-includes/js/wp-embed.min.js?ver=5.8.1" id="wp-embed-js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
<script type="text/javascript" language="javascript">
  var sf14gv = 32633;
  (function() {
    var sf14g = document.createElement('script');
    sf14g.src = 'https://tracking.leadlander.com/lt.min.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sf14g, s);
  })();
</script>		
	
<script> (function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://lftracker.leadfeeder.com/lftracker_v1_DzLR5a5nBBW8BoQ2.js'); })(); </script>
	
<!-- Start of HubSpot Embed Code
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5610435.js"></script>
<!-- End of HubSpot Embed Code -->

		
</body>
</html>
