<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1228754 - (CVE-2016-1958) Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1228754">
<meta property="og:description"
      content="VERIFIED (gijskruitbosch+bugs) in Firefox - Address Bar. Last updated 2018-01-17.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1228754 - (CVE-2016-1958) Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1228754&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1228754">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1228754">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/yui.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/global.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/util.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_webcompat_priority\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_status_firefox47\":\"verified\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox45\":\"verified\",\"cf_status_firefox_esr78\":\"---\",\"cf_status_firefox46\":\"verified\"}},\"types\":[\"tracking\"],\"comments\":{\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1228754;
  BUGZILLA.bug_title = '1228754 - (CVE-2016-1958) Show about:blank (placeholder \"Search or enter address\" in the URL bar) using javascript URI scheme (spoof)';
  BUGZILLA.bug_summary = 'Show about:blank (placeholder \"Search or enter address\" in the URL bar) using javascript URI scheme (spoof)';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1228754';
  BUGZILLA.bug_keywords = 'csectype-spoof, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/field.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/comments.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1228754">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1228754"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1228754 - (CVE-2016-1958) Show about:blank (placeholder &amp;quot;Search or enter address&amp;quot; in the URL bar) using javascript URI scheme (spoof)">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="EPyAHdT8HHSYlHOnRGA36MDWOWKrDXgee4Hk9l9VDw4AErJK6UmsLvW80vt7Htt8dJP6IXBJxmu4DLpqfOB6wQB9xBItKNsNPXnTZT5uzw7SinZLNpGA6dNPfP6QiyfeFKO5uLH0btfo7psFLgg9qXV31xjnouEykZRRSKZ8Vy2kWeFuf3HdOiw7SEJzTvuh2mdiwyPZc5x08WfsDnsGnSvF01Qq0cxQflbYmFbGkMzyYMhbwiCrG9seggeSejlb">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1228754" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622841-BY4cyszVgsLefqvQEvNEYQChJ3G827ezdAJ8Z85ui9E">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1228754" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1228754" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1228754">Bug 1228754</a>
          <span class="edit-hide">(CVE-2016-1958)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2015-11-28 08:52 PST" data-time="1448729535">6 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2016-02-21 09:39 PST" data-time="1456076373">6 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Firefox :: Address Bar, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Firefox
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Firefox</div>
            <div class="description">For bugs in  Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Core">Core</a> product. Bugs for developer tools (F12) should be filed in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools">DevTools</a> product.  (<a href="https://wiki.mozilla.org/Modules/All#Firefox">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox&component=Address%20Bar#Address%20Bar" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Address Bar
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Firefox :: Address Bar</div>
            <div class="description">For bugs in the Firefox "Smart Location Bar" (aka Awesome Bar) UI element, including the bookmark and history autocomplete matching behavior.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Address%20Bar&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Address%20Bar&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox&amp;component=Address%20Bar"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox" data-component="Address Bar"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            42 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-spoof&quot;,&quot;sec-moderate&quot;],&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;id&quot;:1228754,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;}],&quot;cf_status_firefox45&quot;:&quot;verified&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_status_firefox46&quot;:&quot;verified&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;target_milestone&quot;:&quot;Firefox 47&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox47&quot;:&quot;verified&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            Firefox 47

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox45</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox46</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox47</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox45</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox45-dirty">
  <select id="cf_status_firefox45" name="cf_status_firefox45">
        <option value="verified"
          id="v2488_cf_status_firefox45" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox46</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox46-dirty">
  <select id="cf_status_firefox46" name="cf_status_firefox46">
        <option value="verified"
          id="v2564_cf_status_firefox46" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox47</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox47-dirty">
  <select id="cf_status_firefox47" name="cf_status_firefox47">
        <option value="verified"
          id="v2612_cf_status_firefox47" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: qab, Assigned: Gijs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=159069" > <span class="fna">Gijs</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=550582" > <span class="fna">qab</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_334927" ><img src="https://secure.gravatar.com/avatar/fa60148022a230fe1bacc441549b1c66?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=334927" > <span class="fna">adw</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="17">17 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Depends on 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Unwanted content still loaded using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1253179">1253179</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - URI spoof when opening page in a new tab with a moz-action URI"
   href="/show_bug.cgi?id=1250482">1250482</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Page doesn't load completely when using document.write and failing to call document.close"
   href="/show_bug.cgi?id=1253178">1253178</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Full URL spoof using javascript URI scheme"
   href="/show_bug.cgi?id=1247968">CVE-2020-6808</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1228754&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1228754">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-spoof, sec-moderate, Whiteboard: [adv-main45+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2016-1958

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main45+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a7434979_280903"
            class="rel-time-title activity-ref"
            title="6 years ago"
        data-time="1454351840"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1334230">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1334230-dirty">
      <select id="flag-1334230" name="flag-1334230"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug must be fixed for Firefox Sync 1.7" for="flag_type-708">blocking-fx-sync1.7</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-708-dirty">
      <select id="flag_type-708" name="flag_type-708"
        title="This bug must be fixed for Firefox Sync 1.7"
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (10 files, 2 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8693222">FF-urlhider.html</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2015-11-28 08:52 PST" data-time="1448729535">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">1.61 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8693222&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8693223"
              title="Screenshot of the resulting 'spoofed' page"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Screenshot of the resulting 'spoofed' page
            </a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2015-11-28 08:54 PST" data-time="1448729698">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">7.26 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8693223&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8695015">A test case that works for Firefox nightly v45.0a1</a>
        </div>
        <div>
            <a href="#c10" class="attach-time activity-ref"><span class="rel-time" title="2015-12-02 16:06 PST" data-time="1449101175">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">1.08 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8695015&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8697230">FF-URL-SPOOF.html</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2015-12-10 03:31 PST" data-time="1449747117">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">459 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8697230&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8697231"
              title="Screenshot of the spoofed url, its stuck loading but we control document"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Screenshot of the spoofed url, its stuck loading but we control document
            </a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2015-12-10 03:38 PST" data-time="1449747481">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">10.09 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8697231&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8697236">A better PoC (fixed the indefinite 'connecting' and other things)</a>
        </div>
        <div>
            <a href="#c17" class="attach-time activity-ref"><span class="rel-time" title="2015-12-10 04:18 PST" data-time="1449749913">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">1.02 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8697236&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8699189"
              title="Screenshot of the full url spoof"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Screenshot of the full url spoof
            </a>
        </div>
        <div>
            <a href="#c23" class="attach-time activity-ref"><span class="rel-time" title="2015-12-16 13:30 PST" data-time="1450301418">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">29.96 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8699189&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8718889">Patch v1</a>
        </div>
        <div>
            <a href="#c35" class="attach-time activity-ref"><span class="rel-time" title="2016-02-12 08:41 PST" data-time="1455295282">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.13 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8718889&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8718889&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8718889">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8719441">Patch v2</a>
        </div>
        <div>
            <a href="#c39" class="attach-time activity-ref"><span class="rel-time" title="2016-02-15 02:57 PST" data-time="1455533840">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.56 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_20209" ><span class="fn">bzbarsky</span>
</div>:
              <a href="#c40"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1455533840"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_240353" ><span class="fn">mak</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1455717717"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8719441&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8719441&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8719441">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8720530">Patch v3</a>
        </div>
        <div>
            <a href="#c45" class="attach-time activity-ref"><span class="rel-time" title="2016-02-17 15:06 PST" data-time="1455750396">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.21 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_240353" ><span class="fn">mak</span>
</div>:
              <a href="#c47"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1455750396"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8720530&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8720530&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8720530">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8723072">Patch for beta</a>
        </div>
        <div>
            <a href="#c58" class="attach-time activity-ref"><span class="rel-time" title="2016-02-24 08:36 PST" data-time="1456331789">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.38 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c58"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1456331789"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c60"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1456331789"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8723072&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8723072&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8723072">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8723075">Patch for aurora</a>
        </div>
        <div>
            <a href="#c59" class="attach-time activity-ref"><span class="rel-time" title="2016-02-24 08:42 PST" data-time="1456332168">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.53 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c59"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1456332168"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#a7679214_495955"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1456332168"
            >
              approval-mozilla-aurora+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8723075&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8723075&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8723075">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="m4l2smekHyi9sLn0Ha6zmxZCmKACTGbhlkuCd7kS8xf56IEp">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="10971273" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-28 08:52 PST" data-time="1448729535">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8693222"
         class="attachment"
         data-id="8693222" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="FF-urlhider.html">
      <meta itemprop="contentSize" content="1645">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8693222" itemprop="contentUrl">
        <span id="att-8693222-description" itemprop="description">FF-urlhider.html</span></a>
        — <a href="attachment.cgi?id=8693222&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="10971273">User Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0
Build ID: 20151029151421

Steps to reproduce:

View attached file 'FF-urlhider.html' and simply click the innocent looking anchor tag.


Actual results:

We end up in a completely empty URL address yet we control its documents content.


Expected results:

The problem here is that we are able to hide the URL from the user and make it seem like they visited a trusted website. Since we control the content displayed then this kind of bug could easily be used to perform social engineering/phishing attacks.

If the address bar is set to an absolute empty 'about:blank' (which displays nothing in the address bar except 'search or enter address' then its contents should reflect that and be empty, otherwise its a security risk.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="10971276" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-28 08:54 PST" data-time="1448729698">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8693223"
         class="attachment"
         data-id="8693223" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="ffhidescr.png">
      <meta itemprop="contentSize" content="7435">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8693223" itemprop="contentUrl">
        <span id="att-8693223-description" itemprop="description">Screenshot of the resulting 'spoofed' page</span></a>
        — <a href="attachment.cgi?id=8693223&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a85307_159069"><div class="change" id="aa85307_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a85307_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a85307_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a85307_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a85307_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a85307_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-29 08:34 PST" data-time="1448814842">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Hiding URL bar using javascript URI scheme (spoof) &rarr; Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="10978371" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a85307_159069"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a85307_159069"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-01 10:23 PST" data-time="1448994234">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="10978371">I'm not sure if this is something going wrong with the displaying of the URL bar in the front end, or if it could be some kind of document navigation issue. mwobensmith said he confirmed this issue.</pre><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="10978393" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a85307_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a85307_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-01 10:31 PST" data-time="1448994711">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="10978393">(In reply to Andrew McCreight [:mccr8] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c2">comment #2</a>)
<span class="quote">&gt; I'm not sure if this is something going wrong with the displaying of the URL
&gt; bar in the front end, or if it could be some kind of document navigation
&gt; issue. mwobensmith said he confirmed this issue.</span >

The key to this bug is the passed variable 'q', when we first click and we are directed to 'javascript:q;..etc' 'q' is defined as the anchor tag but after we do location.reload() (within the javascript scheme) the 'q' variable is no longer defined thus throwing and error and we end up in the blank url.</pre></div><div class="change-set" id="a265349_159069"><div class="change" id="aa265349_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a265349_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a265349_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a265349_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a265349_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-01 10:34 PST" data-time="1448994884">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="10983239" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a265349_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a265349_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-02 14:39 PST" data-time="1449095984">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="10983239">OK, so stepping through this carefully:

1)  There is a click on a javascript: URI (ignoring the obfuscation bit for the user).  This sets the page url to javascript:stuff, sets the favicon to the Google favicon using the &lt;link rel=&quot;favicon&quot;&gt;, sets the tab title via the document title.

2)  A timer is started to do location.reload().  But you can achieve the same effect by simply taking out that call from the testcase and clicking the reload button yourself, for convenience.

3)  In LoadHistoryEntry(), there is a CreateAboutBlankContentViewer call, with this comment:

12001       // We're loading a URL that will execute script from inside asyncOpen.
12002       // Replace the current document with about:blank now to prevent
12003       // anything from the current document from leaking into any JavaScript
12004       // code in the URL.

This was added to prevent back/forward to javascript: URLs from running script in the context of some random page.  But in this case the upshot is that we change the docshell's mContentViewer.  Note that we do NOT call Show() on it at this point, so we're still showing the previous document viewer.  This is exactly the state we would be in if we had started getting data for a new document but hadn't started layout on it yet.  Note that the docshell's current URI is about:blank at this point.

4) We go to run the javascript: URL.  The fact that it throws isn't even all that important.  You could wrap the whole thing in a try/catch and it would have the same behavior.  The important part is that it does not return a string, so doesn't produce a new document, so nothing else in the docshell changes.

Note that even without the reload() call we have a tab with the Google url and favicon.

Note further that even without all this stuff a page could window.open(&quot;about:blank&quot;, &quot;_self&quot;) and then inject content into there, right?

We _could_ try to do something in nsJSProtocolHandler wherein if we don't plan to load any data and the current content viewer on the docshell is not showing and was created by CreateAboutBlankContentViewer we would just go ahead and Show() it.  In this testcase that means that an actual blank page would be showing in the browser window.

We could even put this Show() call on a runnable that docshell posts after doing the InternalLoad(), assuming that content viewer is still current at that point (which would imply that the script didn't return a string).  

That would be good for maintaining our internal invariants in some sane way, but wouldn't address the spoofing issue, imo.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="c7"><div class="comment" data-id="10983357" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-02 15:11 PST" data-time="1449097914">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="10983357"><span class="quote">&gt; Note further that even without all this stuff a page could window.open(&quot;about:blank&quot;, &quot;_self&quot;) and then inject content into there, right?
&gt; </span >

The only difference between this bug and using window.open is that the placeholder 'Search or enter address' only occurs when using the bug described here, but if we use window.open() the address URL will be visibly  'about:blank'</pre></div><div class="change-set" id="c8"><div class="comment" data-id="10983386" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a265349_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a265349_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-02 15:19 PST" data-time="1449098353">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="10983386"><span class="quote">&gt; the address URL will be visibly  'about:blank'</span >

OK.  Gijs, why is the UI not managing that in this case?</pre></div><div class="change-set" id="c9"><div class="comment" data-id="10983446" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-02 15:42 PST" data-time="1449099756">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="10983446">Interestingly, testing this on FF nightly 45.0a1 the document completely freezes (with the 'red' clicked anchor tag frozen) right clicking does not work.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="10983520" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-02 16:06 PST" data-time="1449101175">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8695015"
         class="attachment"
         data-id="8695015" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="FF-urlhiderv2.html">
      <meta itemprop="contentSize" content="1104">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8695015" itemprop="contentUrl">
        <span id="att-8695015-description" itemprop="description">A test case that works for Firefox nightly v45.0a1</span></a>
        — <a href="attachment.cgi?id=8695015&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-10" data-comment-id="10983520">With a few adjustments to the original testcase (that worked for FF v42.0) we can make it work on the latest nightly</pre></div><div class="change-set" id="c11"><div class="comment" data-id="10984388" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a265349_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-03 00:51 PST" data-time="1449132699">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="10984388">(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c8">comment #8</a>)
<span class="quote">&gt; &gt; the address URL will be visibly  'about:blank'
&gt; 
&gt; OK.  Gijs, why is the UI not managing that in this case?</span >

I don't know offhand, but I can look into it.</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="10984393" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a265349_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-03 00:53 PST" data-time="1449132797">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="10984393">(to be clear, I expected the placeholder would always be shown for about:blank, also for the window.open case, and the fact that it doesn't in that case is surprising to me. I don't know if it's deliberate, or just something that happens to 'work' right now.)</pre></div><div class="change-set" id="c13"><div class="comment" data-id="10985773" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a265349_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-03 09:39 PST" data-time="1449164376">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="10985773">(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c8">comment #8</a>)
<span class="quote">&gt; &gt; the address URL will be visibly  'about:blank'
&gt; 
&gt; OK.  Gijs, why is the UI not managing that in this case?</span >

<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/eec9a0bfd929a68237f0ef799a9d8f28c4749296/browser/base/content/browser.js#2363-2368">https://dxr.mozilla.org/mozilla-central/rev/eec9a0bfd929a68237f0ef799a9d8f28c4749296/browser/base/content/browser.js#2363-2368</a>

IOW, if there's a content opener, we will not replace about:blank, but we will in all other cases. I think this is because this used to be the new tab page, and so if you opened the new tab page you wouldn't want there to be anything in there. We kept this for about:blank because some people overrode the default new tab page with about:blank because they didn't like it and/or it was slower, so it stayed in the list.

It seems like rather than just for openers, we would also want to do this if a page changed its own window to be about:blank. I think that would require exposing that on docshell somehow, unless there's already some way to determine that that I'm not aware of... Perhaps the progress listeners could figure this out and set a flag?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="10998512" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-10 03:31 PST" data-time="1449747117">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8697230"
         class="attachment"
         data-id="8697230" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="FF-URL-SPOOF.html">
      <meta itemprop="contentSize" content="459">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8697230" itemprop="contentUrl">
        <span id="att-8697230-description" itemprop="description">FF-URL-SPOOF.html</span></a>
        — <a href="attachment.cgi?id=8697230&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-14" data-comment-id="10998512">I have managed to come up with a test case that demonstrate full url spoofing. The only condition is that our spoofed url will end with an invalid url char. This bug also involves the user hitting the back button (which in this case will most likely occur naturally because of the error page)

PoC:
1. Open Poc page attached
2. Click anchor tag
3. After error is displayed, press back

We end up in the URL '<a rel="nofollow" href="https://facebook.com">https://facebook.com</a>;' (note the semicolon) 

Not sure if this needs a seperate report since its based off of the javascript URI scheme behavior discussed here.
Tested on Firefox v42</pre></div><div class="change-set" id="c15"><div class="comment" data-id="10998515" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-10 03:38 PST" data-time="1449747481">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8697231"
         class="attachment"
         data-id="8697231" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="fbspoof.png">
      <meta itemprop="contentSize" content="10336">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8697231" itemprop="contentUrl">
        <span id="att-8697231-description" itemprop="description">Screenshot of the spoofed url, its stuck loading but we control document</span></a>
        — <a href="attachment.cgi?id=8697231&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c16"><div class="comment" data-id="10998520" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-10 03:42 PST" data-time="1449747765">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="10998520">Works on latest nightly v45.0a1</pre></div><div class="change-set" id="c17"><div class="comment" data-id="10998546" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-10 04:18 PST" data-time="1449749913">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8697236"
         class="attachment"
         data-id="8697236" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="FF-URL-SPOOFv2.html">
      <meta itemprop="contentSize" content="1047">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8697236" itemprop="contentUrl">
        <span id="att-8697236-description" itemprop="description">A better PoC (fixed the indefinite 'connecting' and other things)</span></a>
        — <a href="attachment.cgi?id=8697236&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-17" data-comment-id="10998546">Tested on FFv42 and FF Nightly v45.0a1</pre></div><div class="change-set" id="c18"><div class="comment" data-id="11002572" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a265349_159069"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a265349_159069"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-12 15:54 PST" data-time="1449964462">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11002572">We can achieve an actual full URL spoof (without the need to put invalid characters) by simply changing the latest testcase that uses '<a rel="nofollow" href="https://facebook.com">https://facebook.com</a>`' with '<a rel="nofollow" href="http:https://facebook.com">http:https://facebook.com</a>', this will result in the URL address displaying '<a rel="nofollow" href="https://facebook.com">https://facebook.com</a>' with its document controlled by us.</pre></div><div class="change-set" id="a1234970_550582"><div class="change" id="aa1234970_550582">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1234970_550582"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1234970_550582">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a1234970_550582">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-12 15:55 PST" data-time="1449964505">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof) &rarr; Full URL spoof using javascript URI scheme</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="11009709" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-16 01:42 PST" data-time="1450258961">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11009709">(In reply to Abdulrahman Alqabandi from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c18">comment #18</a>)
<span class="quote">&gt; We can achieve an actual full URL spoof (without the need to put invalid
&gt; characters) by simply changing the latest testcase that uses
&gt; '<a rel="nofollow" href="https://facebook.com">https://facebook.com</a>`' with '<a rel="nofollow" href="http:https://facebook.com">http:https://facebook.com</a>', this will result
&gt; in the URL address displaying '<a rel="nofollow" href="https://facebook.com">https://facebook.com</a>' with its document
&gt; controlled by us.</span >

Correction, the URL displayed in that case is 'https//facebook.com'</pre></div><div class="change-set" id="c20"><div class="comment" data-id="11011204" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-16 10:11 PST" data-time="1450289476">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="11011204">Would this be considered a high risk bug given the new information?</pre><div class="activity"><div class="change">Flags: needinfo?(continuation)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="11011243" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a1234970_550582"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-16 10:17 PST" data-time="1450289863">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="11011243">I'm not sure. Maybe Dan can answer that.</pre><div class="activity"><div class="change">Flags: needinfo?(continuation) &rarr; needinfo?(dveditz)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="11011846" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-16 12:52 PST" data-time="1450299161">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="11011846">May I also add that its possible to spoof a website completely (char per char) if the targeted website triggers a &quot;This Connection is Untrusted&quot; error when visited through the HTTPS URI scheme. (AKA about:certerror?e=nssBadCert&amp;...etc)

PoC:

Simply modify the test case in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c17">comment #17</a> where instead of navigating to '<a rel="nofollow" href="https://www.facebook.com">https://www.facebook.com</a>`' we have it go to '<a rel="nofollow" href="https://qabandi.com/">https://qabandi.com/</a>' (this site does not use trusted certs) which will give us the desired error page.

Follow the same steps and the URL bar will end up displaying '<a rel="nofollow" href="https://qabandi.com/">https://qabandi.com/</a>' with the document controlled by us.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="11011989" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-16 13:30 PST" data-time="1450301418">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8699189"
         class="attachment"
         data-id="8699189" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="FF-urlspoof-f.png">
      <meta itemprop="contentSize" content="30677">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8699189" itemprop="contentUrl">
        <span id="att-8699189-description" itemprop="description">Screenshot of the full url spoof</span></a>
        — <a href="attachment.cgi?id=8699189&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c24"><div class="comment" data-id="11014774" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-17 11:34 PST" data-time="1450380880">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="11014774">I guess to sum it up, what we are able to do is spoof the location only if some sort of error page is shown when visiting the target url. (or IOW, when the browser navigates to some sort of 'about:{error-page}') This does not seem to work when we navigate to a website normally (due to existing security measures mentioned in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c6">Comment 6</a> I assume)</pre></div><div class="change-set" id="c25"><div class="comment" data-id="11014794" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a1234970_550582"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-17 11:42 PST" data-time="1450381332">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="11014794">I'll clear the rating so it gets looked at again at our next security triage meeting.</pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></span></div></div></div><div class="change-set" id="c26"><div class="comment" data-id="11057295" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-07 19:21 PST" data-time="1452223318">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="11057295">Is it possible to get an update on this?</pre><div class="activity"><div class="change">Flags: needinfo?(continuation)</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="11060121" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a1234970_550582"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-08 13:43 PST" data-time="1452289412">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="11060121">Sorry, with the end of the year we haven't had a chance to look at this in the triage meeting yet.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(continuation)</span></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="11101447" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1234970_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1234970_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-22 23:34 PST" data-time="1453534445">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="11101447">Here is a small bug that I believe is due to the faulty behavior described here.

PoC:

&lt;a id='q' href='moz-action:switchtab,' target='_blank'&gt;click&lt;/a&gt;
&lt;script&gt;q.onclick=$=&gt;{
	setTimeout($=&gt;{alert('View the new tab and check the url\n\n\n\nby:&#64;qab')},33);
}&lt;/script&gt;

<a rel="nofollow" href="http://js.do/code/80600">http://js.do/code/80600</a>

For some reason the new tab contains the same url as the opener (once you switch tabs)</pre></div><div class="change-set" id="a5622305_280903"><div class="change" id="aa5622305_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a5622305_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a5622305_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5622305_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5622305_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a5622305_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-01 10:37 PST" data-time="1454351840">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="11155463" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a5622305_280903"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a5622305_280903"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-10 13:11 PST" data-time="1455138711">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="11155463">Gijs, can you look at this some more? This has been sitting around for a few months. Thanks!</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="11155606" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5622305_280903"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5622305_280903"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-10 13:52 PST" data-time="1455141139">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="11155606">(In reply to Andrew McCreight [:mccr8] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c29">comment #29</a>)
<span class="quote">&gt; Gijs, can you look at this some more? This has been sitting around for a few
&gt; months. Thanks!</span >

Yes, I assumed it was waiting for a new sec rating and verification of the new suggestion in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c22">comment #22</a>. FWIW, the end-result and requirements (user presses back button) seem fairly similar to <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - address bar spoofing using location.protocol and history.back"
   href="/show_bug.cgi?id=1245264">bug 1245264</a> (which might help in terms of the sec rating), but the cause is different. Ni for updated sec rating.

Anyway, in terms of looking at this, it seems <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c22">comment #22</a> changes the mechanics on our side enough that I'm not entirely sure if the same issue I identified in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c13">comment #13</a> is still causing what's going on there, though it doesn't help that it's 10pm and Nightly keeps crashing when I try to use the browser debugger.

Really, Marco might be a better person to investigate this.

Marco might also know the answer to the question at the tail end of <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c13">comment #13</a> about how we determine whether about:blank is a user load or not (even if that does turn out to not be relevant for the change in STR from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c22">comment #22</a>). Yes, we could trivially remove about:blank from that set of pages, but it seems likely that new-tab-url-replacement add-ons will just add it back, and that wouldn't actually fix the security issue with that.</pre><div class="activity"><div class="change">Component: Untriaged &rarr; Location Bar</div><div class="change">Flags: needinfo?(mak77)</div><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div><div class="change">Flags: needinfo?(continuation)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="11155709" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a5622305_280903"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a5622305_280903"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-10 14:21 PST" data-time="1455142864">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="11155709">Would like to point out that according to ( <a rel="nofollow" href="https://wiki.mozilla.org/Security_Severity_Ratings">https://wiki.mozilla.org/Security_Severity_Ratings</a> .) 'sec-high' is the recommended rating for a &quot;Spoofing of full URL bar or bypass of SSL integrity checks.&quot;</pre></div><div class="change-set" id="c32"><div class="comment" data-id="11160613" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5622305_280903"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5622305_280903"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 02:46 PST" data-time="1455274000">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="11160613">I just made some more time to look at this. When I use the testcase and steps from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c22">comment #22</a>, the &lt;browser&gt;'s currentURI is wrong. It should be pointing to about:blank, or, failing that, the URI that originally opened about:blank, and instead I get the URI from which we went back (so <a rel="nofollow" href="https://qabandi.com/">https://qabandi.com/</a>). The browser's documentURI is correct (about:blank), as is the document element's nodePrincipal.

Boris, that seems like a docshell issue. Am I missing something?</pre><div class="activity"><div class="change">Flags: needinfo?(mak77) &rarr; needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="11161134" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a5622305_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a5622305_280903"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 06:33 PST" data-time="1455287625">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="11161134">Sounds like it, but it also sounds like something different from the original issue reported in this bug (the one I analyzed in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c6">comment 6</a>).  Seems like we should get a new bug filed on the interaction involving session history, and probably ask Olli whether he can take a look.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="a6564856_159069"><div class="change" id="aa6564856_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6564856_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a6564856_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6564856_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6564856_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a6564856_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 08:26 PST" data-time="1455294391">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Full URL spoof using javascript URI scheme"
   href="/show_bug.cgi?id=1247968">CVE-2020-6808</a></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="11161616" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6564856_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6564856_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 08:27 PST" data-time="1455294463">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="11161616">(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c33">comment #33</a>)
<span class="quote">&gt; Sounds like it, but it also sounds like something different from the
&gt; original issue reported in this bug (the one I analyzed in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c6">comment 6</a>). 
&gt; Seems like we should get a new bug filed on the interaction involving
&gt; session history, and probably ask Olli whether he can take a look.</span >

Done, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Full URL spoof using javascript URI scheme"
   href="/show_bug.cgi?id=1247968">bug 1247968</a>.

Updating the summary back to the original issue at hand and looking at that again. :-\</pre></div><div class="change-set" id="a6564939_159069"><div class="change" id="aa6564939_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6564939_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a6564939_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6564939_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6564939_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a6564939_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 08:27 PST" data-time="1455294474">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Full URL spoof using javascript URI scheme &rarr; Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="11161656" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6564939_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6564939_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 08:41 PST" data-time="1455295282">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8718889"
         class="attachment patch obsolete"
         data-id="8718889" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="force-show-about-blank.txt">
      <meta itemprop="contentSize" content="2179">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8718889">
          <a class="link" href="attachment.cgi?id=8718889&amp;action=diff">
        <span id="att-8718889-description" itemprop="description">Patch v1</span></a> (obsolete)
        — <a href="attachment.cgi?id=8718889&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8718889">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-35" data-comment-id="11161656">This forces about:blank to be shown in these cases, AFAICT. This depends on us actually using wyciwyg to identify cases where we construct these documents based on something other than just the user requesting that URI. I'd like to know if that is a sane assumption.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8718889&amp;action=edit"
           title="Patch v1"
           class=""
        >Attachment #8718889</a> -
        Flags: review?(mak77)</div><div class="change">
        <a href="/attachment.cgi?id=8718889&amp;action=edit"
           title="Patch v1"
           class=""
        >Attachment #8718889</a> -
        Flags: review?(bzbarsky)</div></div></div><div class="change-set" id="a6566290_159069"><div class="change" id="aa6566290_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6566290_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6566290_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a6566290_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 08:50 PST" data-time="1455295825">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; gijskruitbosch+bugs</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="11161701" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 08:54 PST" data-time="1455296083">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="11161701">(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c35">comment #35</a>)
<span class="quote">&gt; Created <span class="bz_obsolete"><a href="/attachment.cgi?id=8718889" name="attach_8718889" title="Patch v1">attachment 8718889</a> <a href="/attachment.cgi?id=8718889&amp;action=edit" title="Patch v1">[details]</a> <a href="/attachment.cgi?id=8718889&amp;action=diff" title="Patch v1">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8718889'>[review]</a>
&gt; Patch v1
&gt; 
&gt; This forces about:blank to be shown in these cases</span >

Err, specifically, I tested <span class=""><a href="/attachment.cgi?id=8695015" name="attach_8695015" title="A test case that works for Firefox nightly v45.0a1">attachment 8695015</a> <a href="/attachment.cgi?id=8695015&amp;action=edit" title="A test case that works for Firefox nightly v45.0a1">[details]</a></span> which produces the empty URL bar on current nightly. I don't think this will help for the later testcases covered in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Full URL spoof using javascript URI scheme"
   href="/show_bug.cgi?id=1247968">bug 1247968</a></pre></div><div class="change-set" id="c37"><div class="comment" data-id="11162440" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a6566290_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a6566290_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-12 12:34 PST" data-time="1455309274">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="11162440">I don't understand what that patch is trying to do and what problem it's actually solving and why...  I assume in this case aURI is falsy?  What is gBrowser.currentURI?  Is it wycywig:about:blank or some such?

Why can we not just set canOmitURI to false if uri.spec != originalURI.spec ?

All that said, how is this all different from clicking a link opening a popup that then navigates the _parent_ to about:blank?  In that situation, what will show up in the URL bar with the patch?  Without the patch?</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="11163726" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-13 09:44 PST" data-time="1455385451">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="11163726">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8718889" name="attach_8718889" title="Patch v1">attachment 8718889</a> <a href="/attachment.cgi?id=8718889&amp;action=edit" title="Patch v1">[details]</a> <a href="/attachment.cgi?id=8718889&amp;action=diff" title="Patch v1">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8718889'>[review]</a>
Patch v1

(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c37">comment #37</a>)
<span class="quote">&gt; I don't understand what that patch is trying to do</span >

Address <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c8">comment #8</a> - force about:blank to show up instead of an empty address bar. This was the original problem reported in this bug.

<span class="quote">&gt; and what problem it's
&gt; actually solving and why...  I assume in this case aURI is falsy?</span >

IIRC yes, from: <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/d719ac4bcbec13e0ba13a41547788e3bf365c679/browser/base/content/tabbrowser.xml#667-668,678-680,687-688">https://dxr.mozilla.org/mozilla-central/rev/d719ac4bcbec13e0ba13a41547788e3bf365c679/browser/base/content/tabbrowser.xml#667-668,678-680,687-688</a>

but it doesn't matter much if it's that or gBrowser.currentURI that's producing the wyciwyg URL here.

<span class="quote">&gt;  What is
&gt; gBrowser.currentURI?  Is it wycywig:about:blank or some such?</span >

More or less, IIRC wyciwyg:/0/about:blank or whatever. But I can't seem to reproduce this again, though it could be because my build state is a bit messed up at the minute. I'm traveling this weekend and I don't think I'll be able to dive into detail on this before late on Sunday, or Monday.

<span class="quote">&gt; Why can we not just set canOmitURI to false if uri.spec != originalURI.spec ?</span >

We could, I think. Are there other cases that that would catch?

<span class="quote">&gt; All that said, how is this all different from clicking a link opening a
&gt; popup that then navigates the _parent_ to about:blank?  In that situation,
&gt; what will show up in the URL bar with the patch?  Without the patch?</span >

Well, it turns out that AFAICT I messed up the ternary in the patch and so it just does the wrong thing (pretty much always shows the URI, when it shouldn't do that for e.g. just opening a new tab). I'll clear review and keep needinfo to look at this again on Monday. Not sure how I missed that. :-\</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8718889&amp;action=edit"
           title="Patch v1"
           class=""
        >Attachment #8718889</a> -
        Flags: <span class="activity-deleted">review?(mak77)</span></div><div class="change">
        <a href="/attachment.cgi?id=8718889&amp;action=edit"
           title="Patch v1"
           class=""
        >Attachment #8718889</a> -
        Flags: <span class="activity-deleted">review?(bzbarsky)</span></div></div></div><div class="change-set" id="c39"><div class="comment" data-id="11165639" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-15 02:57 PST" data-time="1455533840">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8719441"
         class="attachment patch obsolete"
         data-id="8719441" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="force-show-about-blank.txt">
      <meta itemprop="contentSize" content="3646">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8719441">
          <a class="link" href="attachment.cgi?id=8719441&amp;action=diff">
        <span id="att-8719441-description" itemprop="description">Patch v2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8719441&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8719441">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-39" data-comment-id="11165639">Right, after having a few days to ponder this one, this seems like a more correct fix. It fixes both the original testcase and the case described by Boris in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c37">comment 37</a> (pre-patch: empty location bar; post-patch: 'about:blank').

I fixed a number of other cases where we check hasContentOpener. I don't know if hasContentOpener is really still useful, but we can figure that out in a followup; I'd rather not accidentally introduce a different security issue while we're fixing this one...

Boris/Marco, does this look safe/sensible to you?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8718889&amp;action=edit"
           title="Patch v1"
           class=""
        >Attachment #8718889</a> -
        Attachment is obsolete: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div><div class="change">
        <a href="/attachment.cgi?id=8719441&amp;action=edit"
           title="Patch v2"
           class=""
        >Attachment #8719441</a> -
        Flags: review?(mak77)</div><div class="change">
        <a href="/attachment.cgi?id=8719441&amp;action=edit"
           title="Patch v2"
           class=""
        >Attachment #8719441</a> -
        Flags: review?(bzbarsky)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="11169021" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a6566290_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a6566290_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-16 10:35 PST" data-time="1455647728">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="11169021">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8719441" name="attach_8719441" title="Patch v2">attachment 8719441</a> <a href="/attachment.cgi?id=8719441&amp;action=edit" title="Patch v2">[details]</a> <a href="/attachment.cgi?id=8719441&amp;action=diff" title="Patch v2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8719441'>[review]</a>
Patch v2

Ah, this is much clearer.  At least it directly compares the two things we care about: the URI we're going to show and the URI of the origin involved, if any.

r=me.

As for removing browser.hasContentOpener, I suspect the only case where it probably matters is if you open an about:blank tab (or other initial page URI) and then evaluate window.open(location.href) from a click handler (for the about:blank case this would be a handler attached via the console or something).  I think with this patch, and on tip, the new window shows &quot;about:blank&quot; in the url bar, but if we dropped the hasContentOpener check it might show &quot;&quot; (because the principal and URI would in fact match, afaict).  I'm not sure how much we care about this edge case...</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8719441&amp;action=edit"
           title="Patch v2"
           class=""
        >Attachment #8719441</a> -
        Flags: review?(bzbarsky) &rarr; review+</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="11169678" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a6566290_159069"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-16 13:15 PST" data-time="1455657311">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="11169678">I'm going to mark this sec-moderate. Showing a blank URL bar instead of about:blank is a little confusing, but isn't really claiming anything false. (The stronger spoof in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c22">comment 22</a> has been split into a separate bug.)</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div><div class="change">Flags: <span class="activity-deleted">needinfo?(continuation)</span></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          
            <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c42"><div class="comment" data-id="11171893" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6566290_159069"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-17 06:01 PST" data-time="1455717717">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="11171893">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8719441" name="attach_8719441" title="Patch v2">attachment 8719441</a> <a href="/attachment.cgi?id=8719441&amp;action=edit" title="Patch v2">[details]</a> <a href="/attachment.cgi?id=8719441&amp;action=diff" title="Patch v2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8719441'>[review]</a>
Patch v2

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8719441" name="attach_8719441" title="Patch v2">attachment 8719441</a> <a href="/attachment.cgi?id=8719441&amp;action=edit" title="Patch v2">[details]</a> <a href="/attachment.cgi?id=8719441&amp;action=diff" title="Patch v2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8719441'>[review]</a>:
-----------------------------------------------------------------

How hard would be to write a test for this? Based on the change sounds like something that could be easily reverted inadvertently.
Does the test for <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Full URL spoof using javascript URI scheme"
   href="/show_bug.cgi?id=1247968">bug 1247968</a> cover this one as well?

As a side note,

::: browser/base/content/browser.js
&#64;&#64; +6387,5 &#64;&#64;
<span class="quote">&gt;  
&gt;    return true;
&gt;  }
&gt;  
&gt; +function isEmptyPageReallyEmpty(browser = gBrowser.selectedBrowser,</span >

this needs a nice javadoc explaining why it exists and when it is supposed to be used. We should not really expect devs hitting it having to do code archeology and go through all of this bug.

I'd also suggest to rename it to something more meaningful, for example something like checkEmptyPageIdentity or such, otherwise the code where it appears becomes a little bit more obscure.

&#64;&#64; +6389,5 &#64;&#64;
<span class="quote">&gt;  }
&gt;  
&gt; +function isEmptyPageReallyEmpty(browser = gBrowser.selectedBrowser,
&gt; +                                uri = browser.currentURI) {
&gt; +  if (browser.hasContentOpener) {</span >

Please add a comment before each heuristic explaining why it's a good way to distinguish valid empty pages from invalid ones. Again, we don't want people to guess or go through the whole discussion.

&#64;&#64; +6397,5 &#64;&#64;
<span class="quote">&gt; +  if (contentPrincipal.URI) {
&gt; +    return contentPrincipal.URI.equals(uri);
&gt; +  }
&gt; +  let ssm = Services.scriptSecurityManager;
&gt; +  return ssm.isSystemPrincipal(contentPrincipal);</span >

Sorry, this last heuristic is a little bit unclear to me, which are the cases hitting it?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8719441&amp;action=edit"
           title="Patch v2"
           class=""
        >Attachment #8719441</a> -
        Flags: review?(mak77) &rarr; feedback+</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="11171930" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-17 06:19 PST" data-time="1455718770">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="11171930">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c42">comment #42</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8719441" name="attach_8719441" title="Patch v2">attachment 8719441</a> <a href="/attachment.cgi?id=8719441&amp;action=edit" title="Patch v2">[details]</a> <a href="/attachment.cgi?id=8719441&amp;action=diff" title="Patch v2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8719441'>[review]</a>
&gt; Patch v2
&gt; 
&gt; Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8719441" name="attach_8719441" title="Patch v2">attachment 8719441</a> <a href="/attachment.cgi?id=8719441&amp;action=edit" title="Patch v2">[details]</a> <a href="/attachment.cgi?id=8719441&amp;action=diff" title="Patch v2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8719441'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; How hard would be to write a test for this? Based on the change sounds like
&gt; something that could be easily reverted inadvertently.</span >

I'll have a look. I wouldn't expect it to be particularly difficult necessarily.

<span class="quote">&gt; Does the test for <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Full URL spoof using javascript URI scheme"
   href="/show_bug.cgi?id=1247968">bug 1247968</a> cover this one as well?</span >

There is no test there, but the cause of the issue there is different, AFAICT, so I'd expect the fix and test to be different, too.

<span class="quote">&gt; As a side note,
&gt; 
&gt; ::: browser/base/content/browser.js
&gt; &#64;&#64; +6387,5 &#64;&#64;
&gt; &gt;  
&gt; &gt;    return true;
&gt; &gt;  }
&gt; &gt;  
&gt; &gt; +function isEmptyPageReallyEmpty(browser = gBrowser.selectedBrowser,
&gt; 
&gt; this needs a nice javadoc explaining why it exists and when it is supposed
&gt; to be used. We should not really expect devs hitting it having to do code
&gt; archeology and go through all of this bug.
&gt; 
&gt; I'd also suggest to rename it to something more meaningful, for example
&gt; something like checkEmptyPageIdentity or such, otherwise the code where it
&gt; appears becomes a little bit more obscure.</span >

We're not really checking 'identity', though, are we? We're essentially checking &quot;does the web control the contents of this page&quot;, except that if people use an add-on to explicitly set the new tab page to a web URI, we're clearing the location bar for that, too. I think that's a bad idea, but it means that naming the method &quot;isPageControlledByWeb&quot; doesn't really work. Maybe &quot;pageURIMatchesPrincipal&quot;.

<span class="quote">&gt; &#64;&#64; +6397,5 &#64;&#64;
&gt; &gt; +  if (contentPrincipal.URI) {
&gt; &gt; +    return contentPrincipal.URI.equals(uri);
&gt; &gt; +  }
&gt; &gt; +  let ssm = Services.scriptSecurityManager;
&gt; &gt; +  return ssm.isSystemPrincipal(contentPrincipal);
&gt; 
&gt; Sorry, this last heuristic is a little bit unclear to me, which are the
&gt; cases hitting it?</span >

There are a number of different principal implementations. Some of them have URIs (normal web pages, and null principals have a moz-null-principal URI). However, not all of them do - and in particular, the system principal has no URI, and expanded principals do not have a single URI either (their .URI property is null). The code implies that we only think the page is empty / the URI matches the principal if the principal is the system principal. AIUI web code shouldn't normally be able to cause a page to be created that has an expanded principals. Add-ons might be able to; I'm not sure. Either way, restricting the case where we think a tab is empty/not-web-controllable, when it has no URI, to cases where it has the system principal seemed safest.</pre></div><div class="change-set" id="c44"><div class="comment" data-id="11171949" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6566290_159069"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-17 06:30 PST" data-time="1455719408">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="11171949">(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c43">comment #43</a>)
<span class="quote">&gt; We're not really checking 'identity', though, are we?</span >

I know identity is not a perfect word, but at least it clarifies the kind of check. We are checking if the empty page is really what it asserts to be, like an identity check.
Another name could be checkEmptyPageOrigin? (but again, origin has lots of meanings in our codebase)

<span class="quote">&gt; Maybe &quot;pageURIMatchesPrincipal&quot;.</span >

if not that we're also checking other stuff, like contentOpener, and system principal doesn't really match anything. I was thinking of something a little bit more generic.

<span class="quote">&gt; &gt; &#64;&#64; +6397,5 &#64;&#64;
&gt;  Either way,
&gt; restricting the case where we think a tab is empty/not-web-controllable,
&gt; when it has no URI, to cases where it has the system principal seemed safest.</span >

yep, I agree. Also putting a sum up of your comment above the heuristic would be nice :)</pre></div><div class="change-set" id="c45"><div class="comment" data-id="11173913" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-17 15:06 PST" data-time="1455750396">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8720530"
         class="attachment patch"
         data-id="8720530" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="force-show-about-blank.txt">
      <meta itemprop="contentSize" content="8411">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8720530">
          <a class="link" href="attachment.cgi?id=8720530&amp;action=diff">
        <span id="att-8720530-description" itemprop="description">Patch v3</span></a>
        — <a href="attachment.cgi?id=8720530&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8720530">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-45" data-comment-id="11173913">I noticed from running the test in e10s that in e10s, contentPrincipal is null if we switch selection to an unloaded tab that has about:blank in it but has never had any state changes to tell us what's loaded. So I had to make an exception for that. :-(</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8719441&amp;action=edit"
           title="Patch v2"
           class=""
        >Attachment #8719441</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8720530&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8720530</a> -
        Flags: review?(mak77)</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="11173941" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-17 15:13 PST" data-time="1455750819">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="11173941">Comment on <span class=""><a href="/attachment.cgi?id=8720530" name="attach_8720530" title="Patch v3">attachment 8720530</a> <a href="/attachment.cgi?id=8720530&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8720530&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8720530'>[review]</a>
Patch v3

Review of <span class=""><a href="/attachment.cgi?id=8720530" name="attach_8720530" title="Patch v3">attachment 8720530</a> <a href="/attachment.cgi?id=8720530&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8720530&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8720530'>[review]</a>:
-----------------------------------------------------------------

::: browser/base/content/test/urlbar/browser_urlbar_blanking.js
&#64;&#64; +21,5 &#64;&#64;
<span class="quote">&gt; +    content.document.querySelector('a').click();
&gt; +  });
&gt; +  yield browserLoaded;
&gt; +  ok(gURLBar.value.startsWith(&quot;javascript&quot;), &quot;The URL bar should have the JS URI&quot;);
&gt; +  SimpleTest.expectUncaughtException(true);</span >

In case it's not obvious: loading the 'broken' JS URI causes an exception here that the test framework complains about otherwise.</pre></div><div class="change-set" id="c47"><div class="comment" data-id="11175745" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6566290_159069"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-18 07:08 PST" data-time="1455808127">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="11175745">Comment on <span class=""><a href="/attachment.cgi?id=8720530" name="attach_8720530" title="Patch v3">attachment 8720530</a> <a href="/attachment.cgi?id=8720530&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8720530&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8720530'>[review]</a>
Patch v3

Review of <span class=""><a href="/attachment.cgi?id=8720530" name="attach_8720530" title="Patch v3">attachment 8720530</a> <a href="/attachment.cgi?id=8720530&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8720530&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8720530'>[review]</a>:
-----------------------------------------------------------------

::: browser/base/content/browser.js
&#64;&#64; +6427,5 &#64;&#64;
<span class="quote">&gt; +  if (!contentPrincipal &amp;&amp; uri.spec == &quot;about:blank&quot;) {
&gt; +    // Need to specialcase this because of how tabbrowser switches selected
&gt; +    // tabs before it's heard anything from that tab, so there's no
&gt; +    // contentPrincipal in the e10s case.
&gt; +    return true;</span >

So we can assume this is safe cause browser never got the contentPrincipal from the child, thus it's unlikely the child tried to forge it?

I'd rephrase to:
&quot;Need to specialcase this because, in the e10s case, tabbrowser caches the contentPrincipal when it gets it from the child process LocationChange listener. If it never heard anything about this browser, it won't have a contentPrincipal for it yet. In such a case it's unlikely the child may have forged a fake empty location.&quot;

::: browser/base/content/test/urlbar/browser_urlbar_blanking.js
&#64;&#64; +21,5 &#64;&#64;
<span class="quote">&gt; +    content.document.querySelector('a').click();
&gt; +  });
&gt; +  yield browserLoaded;
&gt; +  ok(gURLBar.value.startsWith(&quot;javascript&quot;), &quot;The URL bar should have the JS URI&quot;);
&gt; +  SimpleTest.expectUncaughtException(true);</span >

yeah, please add a comment above the expectUncaughtException, it's clear only to whoever wrote the test. Moreover the &quot;broken&quot; js is not visible in the test file since it's in another file.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8720530&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8720530</a> -
        Flags: review?(mak77) &rarr; review+</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="11176626" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-18 11:02 PST" data-time="1455822122">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="11176626">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c47">comment #47</a>)
<span class="quote">&gt; Comment on <span class=""><a href="/attachment.cgi?id=8720530" name="attach_8720530" title="Patch v3">attachment 8720530</a> <a href="/attachment.cgi?id=8720530&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8720530&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8720530'>[review]</a>
&gt; Patch v3
&gt; 
&gt; Review of <span class=""><a href="/attachment.cgi?id=8720530" name="attach_8720530" title="Patch v3">attachment 8720530</a> <a href="/attachment.cgi?id=8720530&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8720530&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8720530'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; ::: browser/base/content/browser.js
&gt; &#64;&#64; +6427,5 &#64;&#64;
&gt; &gt; +  if (!contentPrincipal &amp;&amp; uri.spec == &quot;about:blank&quot;) {
&gt; &gt; +    // Need to specialcase this because of how tabbrowser switches selected
&gt; &gt; +    // tabs before it's heard anything from that tab, so there's no
&gt; &gt; +    // contentPrincipal in the e10s case.
&gt; &gt; +    return true;
&gt; 
&gt; So we can assume this is safe cause browser never got the contentPrincipal
&gt; from the child, thus it's unlikely the child tried to forge it?
&gt; 
&gt; I'd rephrase to:
&gt; &quot;Need to specialcase this because, in the e10s case, tabbrowser caches the
&gt; contentPrincipal when it gets it from the child process LocationChange
&gt; listener. If it never heard anything about this browser, it won't have a
&gt; contentPrincipal for it yet. In such a case it's unlikely the child may have
&gt; forged a fake empty location.&quot;</span >

I was not happy with this, so I kept digging. Basically, it turns out this is <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Tabs can lack contentPrincipal in e10s when stopping an about:blank load from chrome"
   href="/show_bug.cgi?id=1249362">bug 1249362</a>. I'll make the check specific to e10s as well, reference that bug, and the e10s team can hopefully fix that separately. Many thanks to mconley for helping me sort this one out.</pre></div><div class="change-set" id="c49"><div class="comment" data-id="11176794" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6566290_159069"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-18 11:39 PST" data-time="1455824342">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="11176794">I actually thought it was on purpose exactly because the parent process was waiting for the principal from the content process... Good that we can fix it.</pre></div><div class="change-set" id="c50"><div class="comment" data-id="11179113" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-19 05:31 PST" data-time="1455888682">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="11179113"><a rel="nofollow" href="https://hg.mozilla.org/integration/fx-team/rev/30c194c260a7">https://hg.mozilla.org/integration/fx-team/rev/30c194c260a7</a></pre></div><div class="change-set" id="c51"><div class="comment" data-id="11179482" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a6566290_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-19 07:51 PST" data-time="1455897086">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="11179482">(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c50">comment #50</a>)
<span class="quote">&gt; <a rel="nofollow" href="https://hg.mozilla.org/integration/fx-team/rev/30c194c260a7">https://hg.mozilla.org/integration/fx-team/rev/30c194c260a7</a></span >

This tripped up some other tests that open about:blank in a new tab and expect that tab to be treated as 'empty'. So I pushed a followup:

<a rel="nofollow" href="https://hg.mozilla.org/integration/fx-team/rev/ae5d37aea5c8">https://hg.mozilla.org/integration/fx-team/rev/ae5d37aea5c8</a>

--- a/browser/base/content/browser.js
+++ b/browser/base/content/browser.js
&#64;&#64; -6438,20 +6438,23 &#64;&#64; function checkEmptyPageOrigin(browser = 
       !contentPrincipal &amp;&amp; uri.spec == &quot;about:blank&quot;) {
     // Need to specialcase this because of how stopping an about:blank
     // load from chrome on e10s causes a permanently null contentPrincipal,
     // see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Tabs can lack contentPrincipal in e10s when stopping an about:blank load from chrome"
   href="/show_bug.cgi?id=1249362">bug 1249362</a>.
     return true;
   }
   // Not all principals have URIs...
   if (contentPrincipal.URI) {
+    if (uri.spec == &quot;about:blank&quot; &amp;&amp; contentPrincipal.isNullPrincipal) {
+      return true;
+    }
     return contentPrincipal.URI.equals(uri);
   }
   // ... so for those that don't have them, enforce that the page has the
-  // system principal (this matches e.g. on about:blank).
+  // system principal (this matches e.g. on about:home).
   let ssm = Services.scriptSecurityManager;
   return ssm.isSystemPrincipal(contentPrincipal);
 }

bz, I *think* this is accurate (if not, please let me know!), but is there an easier way to do this? (could be a followup) I'm assuming not because we essentially want to say something like &quot;does this URI match this principal&quot; which doesn't work so well for about:blank / the null principal, because anybody can open it...

Ugh, and that comment should quote about:newtab, not about:home. I can fix that in a DONTBUILD push, I guess, assuming that this fix is correct.</pre><div class="activity"><div class="change">Flags: needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="11179497" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a6566290_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a6566290_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-19 07:54 PST" data-time="1455897269">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="11179497">That seems fine, yes, since a nullprincipal about:blank is clearly one that a web page did not open (and can't control).</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="c53"><div class="comment" data-id="11182675" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_135518" id="a6566290_159069"><img src="https://secure.gravatar.com/avatar/2b6c1ba0915a97a81d59ca1e101e6d74?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_135518" id="a6566290_159069"><a class="email " href="/user_profile?user_id=135518" > <span class="fna">Phil Ringnalda (:philor)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-21 09:39 PST" data-time="1456076373">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="11182675"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/30c194c260a7">https://hg.mozilla.org/mozilla-central/rev/30c194c260a7</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/ae5d37aea5c8">https://hg.mozilla.org/mozilla-central/rev/ae5d37aea5c8</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2016-02-21 09:39 PST" data-time="1456076373">6 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=isnotempty">status-firefox47</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; Firefox 47</div></div></div><div class="change-set" id="a7434979_280903"><div class="change" id="aa7434979_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a7434979_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a7434979_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7434979_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7434979_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a7434979_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-22 10:08 PST" data-time="1456164514">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="a7463635_1689"><div class="change" id="aa7463635_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7463635_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a7463635_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7463635_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7463635_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a7463635_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-22 18:06 PST" data-time="1456193170">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="11187383" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a7463635_1689"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a7463635_1689"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-23 04:44 PST" data-time="1456231472">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="11187383">Does the fix work for the little bug mentioned in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c28">Comment 28</a> also?</pre></div><div class="change-set" id="c55"><div class="comment" data-id="11187447" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a7463635_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a7463635_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-23 05:19 PST" data-time="1456233585">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="11187447">(In reply to Abdulrahman Alqabandi from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c54">comment #54</a>)
<span class="quote">&gt; Does the fix work for the little bug mentioned in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c28">Comment 28</a> also?</span >

No. That's a separate issue caused by the use of a moz-action URI. This is what happens when too many separate things get stuck into a single bugreport. :-\

I'll file a separate bug about this.</pre></div><div class="change-set" id="a7504320_159069"><div class="change" id="aa7504320_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a7504320_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a7504320_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7504320_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7504320_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a7504320_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-23 05:24 PST" data-time="1456233855">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - URI spoof when opening page in a new tab with a moz-action URI"
   href="/show_bug.cgi?id=1250482">1250482</a></div></div></div><div class="change-set" id="c56"><div class="comment" data-id="11187956" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a7504320_159069"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a7504320_159069"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-23 08:00 PST" data-time="1456243208">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="11187956"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/f4da8a4682a8">https://hg.mozilla.org/mozilla-central/rev/f4da8a4682a8</a></pre></div><div class="change-set" id="c57"><div class="comment" data-id="11189581" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a7504320_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a7504320_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-23 14:58 PST" data-time="1456268319">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="11189581">I'll try to put up a patch for uplift tomorrow.</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c58"><div class="comment" data-id="11191724" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a7504320_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a7504320_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-24 08:36 PST" data-time="1456331789">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8723072"
         class="attachment patch"
         data-id="8723072" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="placeholder-spoof.txt">
      <meta itemprop="contentSize" content="8586">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8723072">
          <a class="link" href="attachment.cgi?id=8723072&amp;action=diff">
        <span id="att-8723072-description" itemprop="description">Patch for beta</span></a>
        — <a href="attachment.cgi?id=8723072&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8723072">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-58" data-comment-id="11191724">Approval Request Comment
[Feature/regressing bug #]: n/a
[User impact if declined]: security issue with the location bar being emptied too eagerly, potentially leading to user confusion as to who controls the content area
[Describe test coverage new/current, TreeHerder]: comes with tests, has been on Nightly for a while, the url bar has decent test coverage already;
[Risks and why]: low-ish, as it is a fairly focused change, it has tests, and the URL bar has reasonable test coverage in general, but obviously it's starting to get late-ish in this cycle.
[String/UUID change made/needed]: no</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div><div class="change">
        <a href="/attachment.cgi?id=8723072&amp;action=edit"
           title="Patch for beta"
           class=""
        >Attachment #8723072</a> -
        Flags: review+</div><div class="change">
        <a href="/attachment.cgi?id=8723072&amp;action=edit"
           title="Patch for beta"
           class=""
        >Attachment #8723072</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="11191763" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a7504320_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a7504320_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-24 08:42 PST" data-time="1456332168">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8723075"
         class="attachment patch"
         data-id="8723075" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="placeholder-spoof.txt">
      <meta itemprop="contentSize" content="8733">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8723075">
          <a class="link" href="attachment.cgi?id=8723075&amp;action=diff">
        <span id="att-8723075-description" itemprop="description">Patch for aurora</span></a>
        — <a href="attachment.cgi?id=8723075&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1228754&attachment=8723075">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-59" data-comment-id="11191763">Approval Request Comment
[Feature/regressing bug #]: n/a
[User impact if declined]: security issue with the location bar being emptied too eagerly, potentially leading to user confusion as to who controls the content area
[Describe test coverage new/current, TreeHerder]: comes with tests, has been on Nightly for a while, the url bar has decent test coverage already;
[Risks and why]: low, as it is a fairly focused change, it has tests, and the URL bar has reasonable test coverage in general.
[String/UUID change made/needed]: no</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8723075&amp;action=edit"
           title="Patch for aurora"
           class=""
        >Attachment #8723075</a> -
        Flags: review+</div><div class="change">
        <a href="/attachment.cgi?id=8723075&amp;action=edit"
           title="Patch for aurora"
           class=""
        >Attachment #8723075</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="a7679171_495955"><div class="change" id="aa7679171_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a7679171_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a7679171_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7679171_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7679171_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a7679171_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-25 05:58 PST" data-time="1456408706">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=isnotempty">status-firefox45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=isnotempty">status-firefox46</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c60"><div class="comment" data-id="11194810" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a7679171_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a7679171_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-25 05:59 PST" data-time="1456408745">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="11194810">Comment on <span class=""><a href="/attachment.cgi?id=8723072" name="attach_8723072" title="Patch for beta">attachment 8723072</a> <a href="/attachment.cgi?id=8723072&amp;action=edit" title="Patch for beta">[details]</a> <a href="/attachment.cgi?id=8723072&amp;action=diff" title="Patch for beta">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1228754&amp;attachment=8723072'>[review]</a>
Patch for beta

Taking it for the reasons that Gijs exposed + 45 is an esr
Should be in 45 beta 10</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8723072&amp;action=edit"
           title="Patch for beta"
           class=""
        >Attachment #8723072</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="a7679214_495955"><div class="change" id="aa7679214_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a7679214_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a7679214_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7679214_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7679214_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a7679214_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-25 05:59 PST" data-time="1456408749">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8723075&amp;action=edit"
           title="Patch for aurora"
           class=""
        >Attachment #8723075</a> -
        Flags: approval-mozilla-aurora? &rarr; approval-mozilla-aurora+</div></div></div><div class="change-set" id="c61"><div class="comment" data-id="11194853" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a7679214_495955"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a7679214_495955"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-25 06:15 PST" data-time="1456409715">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="11194853"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/91ddff279311">https://hg.mozilla.org/releases/mozilla-aurora/rev/91ddff279311</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/80ce3f1ffe03">https://hg.mozilla.org/releases/mozilla-beta/rev/80ce3f1ffe03</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=isnotempty">status-firefox45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=isnotempty">status-firefox46</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a8067431_280903"><div class="change" id="aa8067431_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8067431_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a8067431_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8067431_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8067431_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a8067431_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-29 17:49 PST" data-time="1456796966">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main45+]</div></div></div><div class="change-set" id="a8159681_280903"><div class="change" id="aa8159681_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a8159681_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8159681_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8159681_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a8159681_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-01 19:26 PST" data-time="1456889216">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2016-1958</div></div></div><div class="change-set" id="c62"><div class="comment" data-id="11211260" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428011" id="a8159681_280903"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 07:46 PST" data-time="1456933606">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="11211260">This is what I see in the latest nightly using the testcase in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c10">comment 10</a> - <a rel="nofollow" href="http://i.imgur.com/Ht87gOM.png">http://i.imgur.com/Ht87gOM.png</a>
Thoughts?</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c63"><div class="comment" data-id="11211265" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a8159681_280903"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 07:48 PST" data-time="1456933722">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="11211265">(In reply to Paul Silaghi, QA [:pauly] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c62">comment #62</a>)
<span class="quote">&gt; This is what I see in the latest nightly using the testcase in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c10">comment 10</a> -
&gt; <a rel="nofollow" href="http://i.imgur.com/Ht87gOM.png">http://i.imgur.com/Ht87gOM.png</a>
&gt; Thoughts?</span >

Looks good to me? The problem was that the URL bar would display nothing. Now it explicitly says about:blank. AIUI that's the desired behaviour here.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="11211284" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428011" id="a8159681_280903"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 07:53 PST" data-time="1456934018">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="11211284">(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c63">comment #63</a>)
<span class="quote">&gt; Now it explicitly says about:blank. AIUI that's the desired behaviour here.</span >
Ok, but the content is still loaded.
Moreover, the tab circle spins forever. And the Inspector is frozen.
Still expected?</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c65"><div class="comment" data-id="11211321" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a8159681_280903"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 08:01 PST" data-time="1456934466">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="11211321">(In reply to Paul Silaghi, QA [:pauly] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c64">comment #64</a>)
<span class="quote">&gt; (In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c63">comment #63</a>)
&gt; &gt; Now it explicitly says about:blank. AIUI that's the desired behaviour here.
&gt; Ok, but the content is still loaded.</span >

Yes. It's perfectly legitimate for a web site to do:

var w = window.open(&quot;about:blank&quot;, &quot;_blank&quot;);

w.document.appendChild(w.document.createElement('p'));
w.querySelector('p').textContent = &quot;Hello&quot;;

or whatever. Not much we can do about that without breaking the internet.

<span class="quote">&gt; Moreover, the tab circle spins forever.</span >

It doesn't in your screenshot.

<span class="quote">&gt; And the Inspector is frozen.</span >

Also no inspector in your screenshot.

<span class="quote">&gt; Still expected?</span >

Both of these also happened before this fix, no, or are they regressions?

Both of these seem like issues that could be worth followups if you can distill down why/when they happen from the original testcase.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c66"><div class="comment" data-id="11211366" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428011" id="a8159681_280903"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 08:16 PST" data-time="1456935386">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="11211366">Thanks for clarifications.

(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c65">comment #65</a>)
<span class="quote">&gt; Not much we can do about that without breaking the internet.</span >
FWIW, Google Chrome doesn't load the content.
 
<span class="quote">&gt; Both of these also happened before this fix, no, or are they regressions?</span >
Yes, both happened before the fix too.

Based on comments 62-65, marking this as verified on FX 45, 46.0a2 (2016-03-02), 47.0a1 (2016-03-02) Win 7</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=isnotempty">status-firefox45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=isnotempty">status-firefox46</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=isnotempty">status-firefox47</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="c67"><div class="comment" data-id="11211448" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a8159681_280903"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 08:37 PST" data-time="1456936647">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="11211448">(In reply to Paul Silaghi, QA [:pauly] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c66">comment #66</a>)
<span class="quote">&gt; Thanks for clarifications.
&gt; 
&gt; (In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c65">comment #65</a>)
&gt; &gt; Not much we can do about that without breaking the internet.
&gt; FWIW, Google Chrome doesn't load the content.</span >

I'm not entirely sure what would cause different behaviour in Chrome. It's possible they don't let you refresh javascript URIs. Probably worth a followup bug as well.

<span class="quote">&gt; &gt; Both of these also happened before this fix, no, or are they regressions?
&gt; Yes, both happened before the fix too.</span >

OK, please CC me on any followup bugs you file.</pre></div><div class="change-set" id="c68"><div class="comment" data-id="11213788" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a8159681_280903"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 19:37 PST" data-time="1456976256">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="11213788">The tab circling happens (for some reason) whenever we do a document.write() (possible bug?), I used window.stop() to fix this in the test case in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c17">Comment 17</a> (please test all test cases mentioned)

Also, in my opinion, 'about:blank' should always reflect a blank document, if it contains a document created by '<a rel="nofollow" href="http://localhost">http://localhost</a>' then the url should change to '<a rel="nofollow" href="http://localhost">http://localhost</a>'</pre></div><div class="change-set" id="c69"><div class="comment" data-id="11214092" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a8159681_280903"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428011" id="a8159681_280903"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 23:31 PST" data-time="1456990313">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-69" data-comment-id="11214092">(In reply to Abdulrahman Alqabandi from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c68">comment #68</a>)
<span class="quote">&gt; test case in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c17">Comment 17</a></span >
I believe that was filed as a separate issue and it's not fixed yet.</pre></div><div class="change-set" id="a8262136_428011"><div class="change" id="aa8262136_428011">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a8262136_428011"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428011" id="a8262136_428011"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8262136_428011"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8262136_428011">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a8262136_428011">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 23:54 PST" data-time="1456991671">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Page doesn't load completely when using document.write and failing to call document.close"
   href="/show_bug.cgi?id=1253178">1253178</a></div></div></div><div class="change-set" id="a8262141_428011"><div class="change" id="aa8262141_428011">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a8262141_428011"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428011" id="a8262141_428011"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8262141_428011"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8262141_428011">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a8262141_428011">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-02 23:54 PST" data-time="1456991676">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Unwanted content still loaded using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1253179">1253179</a></div></div></div><div class="change-set" id="c70"><div class="comment" data-id="11214691" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8262141_428011"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a8262141_428011"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-03 04:43 PST" data-time="1457009000">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="11214691">(In reply to Abdulrahman Alqabandi from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c68">comment #68</a>)
<span class="quote">&gt; Also, in my opinion, 'about:blank' should always reflect a blank document,
&gt; if it contains a document created by '<a rel="nofollow" href="http://localhost">http://localhost</a>' then the url should
&gt; change to '<a rel="nofollow" href="http://localhost">http://localhost</a>'</span >

This is an interesting proposal, but not the reality in any other browser, either:

<a rel="nofollow" href="http://jsbin.com/rexaqatado/edit?html,js,output">http://jsbin.com/rexaqatado/edit?html,js,output</a>

being a trivial testcase (on both Chrome and IE on Windows, the location bar there shows about:blank, as it does for us).

I don't know if this stuff is specced at all, but it seems worth converging on with other browsers if a change does need to be made. Probably worth taking up with the relevant w3c/whatwg working groups.</pre></div><div class="change-set" id="c71"><div class="comment" data-id="11214867" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a8262141_428011"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a8262141_428011"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-03 05:57 PST" data-time="1457013471">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="11214867"><span class="quote">&gt; I don't know if this stuff is specced at all</span >

It is.  What we do now follows the current spec.</pre></div><div class="change-set" id="c72"><div class="comment" data-id="11214868" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a8262141_428011"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a8262141_428011"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-03 05:58 PST" data-time="1457013506">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="11214868">Well, I mean the URL bar is not specced, so I guess we can do whatever we want there.  But observable things about the document and window like location.href and document.URL are.</pre></div><div class="change-set" id="c73"><div class="comment" data-id="11214939" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8262141_428011"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a8262141_428011"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-03 06:30 PST" data-time="1457015410">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="11214939">(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Show about:blank (placeholder &quot;Search or enter address&quot; in the URL bar) using javascript URI scheme (spoof)"
   href="/show_bug.cgi?id=1228754#c72">comment #72</a>)
<span class="quote">&gt; Well, I mean the URL bar is not specced, so I guess we can do whatever we
&gt; want there.  But observable things about the document and window like
&gt; location.href and document.URL are.</span >

Right, I assumed that we were specifically talking about what we show users. As an engineer, making the location bar value be different from location.href irks me, but it's pretty clear that if mozilla.org controls the content of about:blank, that it's more useful to display mozilla.org than to display about:blank. Yes, if you go to the URL bar and hit enter you don't get the same document, but that has always been true and is also true for about:blank...

As I noted earlier, it seems all the browsers behave the same right now, but I don't really see a good reason not to change that (beyond engineer-me-being-irked :-) ).</pre></div><div class="change-set" id="a25851341_1689"><div class="change" id="aa25851341_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a25851341_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a25851341_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a25851341_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a25851341_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1228754#a25851341_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 14:47 PDT" data-time="1474580876">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1228754&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>