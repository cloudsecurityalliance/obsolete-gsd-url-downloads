<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Elastic Stack 5.4.1 and 5.3.3 Security updates - Security Announcements - Discuss the Elastic Stack</title>
    <meta name="description" content="X-Pack 5.4.1 privilege escalation (ESA-2017-06) 

X-Pack 5.4.1 has been released which fixes a privilege escalation bug in the run_as functionality. This bug prevents transitioning into the specified user specified in a &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.0.beta7 - https://github.com/discourse/discourse version 436edbb51a15c634e65c0d7cdccdb4ce9aecd8f1">
<link rel="icon" type="image/png" href="https://aws1.discourse-cdn.com/elastic/optimized/3X/5/d/5ded4d26a9eb0b035f2650d43025d92144c19f9c_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="https://aws1.discourse-cdn.com/elastic/optimized/3X/b/e/be7f366b9210b4959de9e84ea1f93ea746631491_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://discuss.elastic.co/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://discuss.elastic.co","potentialAction":{"@type":"SearchAction","target":"https://discuss.elastic.co/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.elastic.co/opensearch.xml" title="Discuss the Elastic Stack Search">

      <link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_30475bec156c2db4fc0eed5672900bd58f9e48a4.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_24_b919e3de1838296d0a853ef2a32c366b47362ded.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="24" data-theme-name="discourse-tag-sidebar"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_19_d9f830a66faa3d29ef78bbc207171773e9ebd0bb.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="19" data-theme-name="elastic suggester"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_17_268cd07054cdb38ea7e9f1c5313a5dcc900123eb.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="17" data-theme-name="icon header links"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_20_7574547e27de64ed16659f56bef7cf0d43bbbd7b.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="20" data-theme-name="unformatted code detector"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_6_c94b2b9c45b1d832b27fd0e09114653ab0736b39.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="6" data-theme-name="house ads"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_2_6c4fc70b8f8842114a858f51741a58b764ae1290.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="elastic"/>
    <script type="application/ld+json">
	{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "Elastic",
		"url": "https://www.elastic.co/",
		"logo": "https://www.elastic.co/static/img/logo-elastic.png",
		"sameAs": ["https://www.facebook.com/elastic.co",
			"https://twitter.com/elastic",
			"https://plus.google.com/105178019064686397293",
			"https://www.youtube.com/user/elasticsearch",
			"https://www.linkedin.com/company/elasticsearch"
		]
	}
</script>
<meta name="google-site-verification" content="DomjkVg_vXHmIOm6fe3rZEhQ5tCXZl9fb-H-SNkCKaY">
<meta name="google-site-verification" content="ifAAE_mkvVVDx_RVqNrCqZMXKqZKxdt_XZIYL33pjtE">

<script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async=""></script><script src="https://sea2.discourse-cdn.com/elastic/theme-javascripts/d741a84477ff74dead88fe5447f0de9e5421cb4c.js?__ws=discuss.elastic.co"></script>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Elastic Stack 5.4.1 and 5.3.3 Security updates&#39;" href="https://discuss.elastic.co/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952.rss" />
    <meta property="og:site_name" content="Discuss the Elastic Stack" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://aws1.discourse-cdn.com/elastic/original/3X/5/4/5461df8fd2fe783981b0180332821184b729980e.png" />
<meta property="og:image" content="https://aws1.discourse-cdn.com/elastic/original/3X/5/4/5461df8fd2fe783981b0180332821184b729980e.png" />
<meta property="og:url" content="https://discuss.elastic.co/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952" />
<meta name="twitter:url" content="https://discuss.elastic.co/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952" />
<meta property="og:title" content="Elastic Stack 5.4.1 and 5.3.3 Security updates" />
<meta name="twitter:title" content="Elastic Stack 5.4.1 and 5.3.3 Security updates" />
<meta property="og:description" content="X-Pack 5.4.1 privilege escalation (ESA-2017-06)  X-Pack 5.4.1 has been released which fixes a privilege escalation bug in the run_as functionality. This bug prevents transitioning into the specified user specified in a run_as request. If a role has been created using a template that contains the _user properties, the behavior of run_as will be incorrect. Additionally if the run_as user specified does not exist, the transition will not happen.  Generally when using the run as functionality a user..." />
<meta name="twitter:description" content="X-Pack 5.4.1 privilege escalation (ESA-2017-06)  X-Pack 5.4.1 has been released which fixes a privilege escalation bug in the run_as functionality. This bug prevents transitioning into the specified user specified in a run_as request. If a role has been created using a template that contains the _user properties, the behavior of run_as will be incorrect. Additionally if the run_as user specified does not exist, the transition will not happen.  Generally when using the run as functionality a user..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />
<meta property="article:published_time" content="2017-06-01T16:29:34+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Elastic Stack 5.4.1 and 5.3.3 Security updates","mainEntity":{"@type":"Question","name":"Elastic Stack 5.4.1 and 5.3.3 Security updates","text":"X-Pack 5.4.1 privilege escalation (ESA-2017-06)\n\nX-Pack 5.4.1 has been released which fixes a privilege escalation bug in the run_as functionality. This bug prevents transitioning into the specified user specified in a run_as request. If a role has been created using a template that contains the _us&hellip;","upvoteCount":1,"answerCount":0,"dateCreated":"2017-06-01T16:29:34.207Z","author":{"@type":"Person","name":"Josh Bressers"}}}</script>
  </head>
  <body class="crawler">
    

<script src="https://sea2.discourse-cdn.com/elastic/theme-javascripts/bdc1b1e37d244d4763213dab881ad9e09713c98e.js?__ws=discuss.elastic.co"></script>
<link rel="apple-touch-icon" sizes="57x57" href="https://www.elastic.co/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.elastic.co/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.elastic.co/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.elastic.co/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.elastic.co/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.elastic.co/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.elastic.co/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.elastic.co/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.elastic.co/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://www.elastic.co/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.elastic.co/favicon-32x32.png?v=2">
<link rel="icon" type="image/png" sizes="96x96" href="https://www.elastic.co/favicon-96x96.png?v=2">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.elastic.co/favicon-16x16.png?v=2">
<link rel="manifest" href="https://www.elastic.co/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="https://www.elastic.co/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">



<script src="https://sea2.discourse-cdn.com/elastic/theme-javascripts/964f12d361c19ec0d18738f29bf05e70411deabf.js?__ws=discuss.elastic.co"></script>
    <header>
      <a href="/">
          <img src="https://aws1.discourse-cdn.com/elastic/original/3X/1/8/18a14d80f0e626d44a1b531df11869baea5c9cf4.png" alt="Discuss the Elastic Stack" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952">Elastic Stack 5.4.1 and 5.3.3 Security updates</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.elastic.co/c/announcements/5" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Announcements</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.elastic.co/c/announcements/security-announcements/31" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #BF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Security Announcements</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Elastic'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://aws1.discourse-cdn.com/elastic/original/3X/1/8/18a14d80f0e626d44a1b531df11869baea5c9cf4.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://discuss.elastic.co/u/joshbressers'><span itemprop='name'>joshbressers</span></a>
            (Josh Bressers)
          </span>

          <link itemprop="mainEntityOfPage" href="https://discuss.elastic.co/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-06-01T16:29:34Z' class='post-time'>
                June 1, 2017,  4:29pm
              </time>
              <meta itemprop='dateModified' content='2017-06-01T16:29:34Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><strong>X-Pack 5.4.1 privilege escalation (ESA-2017-06)</strong></p>
<p>X-Pack 5.4.1 has been released which fixes a privilege escalation bug in the run_as functionality. This bug prevents transitioning into the specified user specified in a run_as request. If a role has been created using a template that contains the _user properties, the behavior of run_as will be incorrect. Additionally if the run_as user specified does not exist, the transition will not happen.<br>
Generally when using the run as functionality a user will transition to a different user. This bug will cause the role query to execute as the user which authenticated to Elasticsearch, not the user specified via run as. This could result in a query returning incorrect or unexpected results.</p>
<p>If you are not using run_as functionality or the _user properties you are not affected by this issue.</p>
<p><strong>Affected versions</strong><br>
X-Pack Security 5.0.0 to 5.4.0 is affected by this flaw</p>
<p><strong>Solution and Mitigations</strong><br>
If you are affected by this issue, we suggest you upgrade your Elastic Stack to version 5.4.1<br>
If you are unable to upgrade, removing use of the {{_user.username}} placeholder and ensuring the run_as setting cannot be modified by untrusted users is a valid solution.</p>
<p><strong>CVE ID:</strong> CVE-2017-8438</p>
<hr>
<p><strong>Kibana 5.4.1 Cross Site Scripting (ESA-2017-07)</strong></p>
<p>Kibana 5.4.1 has been released which fixes a cross site scripting bug in the Time Series Visual Builder. This bug could allow an attacker to construct a visualization in such a way that when viewed by another Kibana user could leak sensitive information from or perform destructive actions on behalf of the Kibana user.</p>
<p><strong>Affected versions</strong><br>
Kibana 5.4.0 is affected by this flaw</p>
<p><strong>Solution and Mitigations</strong><br>
We strongly advise users to update to Kibana version 5.4.1.<br>
If you are unable to upgrade at this time, the Time Series Visual Builder can be disabled by adding ‘metrics.enabled: false’ to your kibana.yml configuration file. Note that this will trigger an optimize cycle when you next start Kibana.</p>
<p><strong>CVE ID:</strong> CVE-2017-8439</p>
<hr>
<p><strong>Kibana 5.4.1 and 5.3.3 Cross Site Scripting (ESA-2017-08)</strong></p>
<p>Kibana 5.4.1 and 5.3.3 have been released which fix a cross site scripting bug in the Discover page. An attacker who is able to insert arbitrary data into elasticsearch that when viewed by another Kibana user on the Discover page could leak sensitive information from or perform destructive actions on behalf of the Kibana user.</p>
<p><strong>Affected versions</strong><br>
Kibana versions between 5.3.0 and 5.4.0 are affected by this flaw</p>
<p><strong>Solution and Mitigations</strong><br>
We strongly advise users to update to Kibana version 5.4.1 or 5.3.3.</p>
<p><strong>CVE ID:</strong> CVE-2017-8440</p>
<p>Elastic would like to thank Thomas Gøytil for reporting this issue.</p>
<hr>
<p><strong>X-Pack 5.4.1 and 5.3.3 improper DLS alias enforcement (ESA-2017-09)</strong></p>
<p>X-Pack 5.4.1 and 5.3.3 have been released with a fix for a bug in the way Document Level Security is applied to index aliases. This bug could allow a user with restricted permissions to view data they should not have access to when performing certain operations against an index alias.</p>
<p><strong>Affected versions</strong><br>
X-Pack Security 5.0.0 to 5.4.0 is affected by this flaw</p>
<p><strong>Solution and Mitigations</strong><br>
If you are affected by this issue, we suggest you upgrade your Elastic Stack to version 5.4.1 or 5.3.3.</p>
<p>If you are unable to upgrade, the shard request cache can be disabled for indices that use aliases. Instructions to disable the request cache can be found <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.4/shard-request-cache.html#_enabling_and_disabling_caching">here</a></p>
<p><strong>CVE ID:</strong> CVE-2017-8441</p>
        </div>

        <meta itemprop='headline' content='Elastic Stack 5.4.1 and 5.3.3 Security updates'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="1" />
           <span class='post-likes'>1 Like</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

            <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                  <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                    <a href="https://discuss.elastic.co/t/how-to-solve-kibana5-4-0-loophole/241955/3" itemscope itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                      <meta itemprop='url' content='https://discuss.elastic.co/t/how-to-solve-kibana5-4-0-loophole/241955/3'>
                      <span itemprop='name'>How to solve kibana5.4.0 Loophole</span>
                    </a>
                    <meta itemprop='position' content='2'>
                  </div>
            </div>
      </div>
      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Elastic'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://aws1.discourse-cdn.com/elastic/original/3X/1/8/18a14d80f0e626d44a1b531df11869baea5c9cf4.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://discuss.elastic.co/u/system'><span itemprop='name'>system</span></a>
            (system)
              closed 
          </span>

          <link itemprop="mainEntityOfPage" href="https://discuss.elastic.co/t/elastic-stack-5-4-1-and-5-3-3-security-updates/87952">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2017-07-06T13:46:12Z' class='post-time'>
                July 6, 2017,  1:46pm
              </time>
              <meta itemprop='dateModified' content='2017-07-06T13:46:12Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          
        </div>

        <meta itemprop='headline' content='Elastic Stack 5.4.1 and 5.3.3 Security updates'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <div id="copyright">
	<p>
		© 2020. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="https://www.elastic.co/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="https://www.elastic.co/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="https://www.elastic.co/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
		<li><a href="https://www.elastic.co/brand" id="footer_brand">Brand</a></li>
		<li><a href="https://www.elastic.co/community/codeofconduct" id="codeofconduct">Code of Conduct</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div>

<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a id="footer_facebook" target="_blank" href="http://www.facebook.com/elastic.co"></a></li>
					
						<li class="twitter grayscale"><a id="footer_twitter" target="_blank" href="https://www.twitter.com/elastic"></a></li>
					
						<li class="linkedin grayscale"><a id="footer_linkedin" target="_blank" href="https://www.linkedin.com/company/elastic-co"></a></li>
						
						<li class="xing grayscale"><a id="footer_xing" target="_blank" href="https://www.xing.com/companies/elastic.co"></a></li>
					    <li class="youtube grayscale"><a id="footer_youtube" target="_blank" href="https://www.youtube.com/user/elasticsearch"></a></li>
						
				</ul>
			</div>
		</section>
	</div>
    
  </body>
  
</html>
