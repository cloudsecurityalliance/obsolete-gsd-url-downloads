<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<title>0005846: A heap-buffer-overflow vulneribility in function EXTRACTOR_dvi_extract_method in dvi_extractor.c - MantisBT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/default.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/status_config.php?cache_key=afd635dc40a2230c44ffa411a667f877" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/dropzone-5.5.0.min.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/bootstrap-3.4.1.min.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/font-awesome-4.7.0.min.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/fonts.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/bootstrap-datetimepicker-4.17.47.min.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/ace.min.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/ace-mantis.css" />
	<link rel="stylesheet" type="text/css" href="https://bugs.gnunet.org/css/ace-skins.min.css" />

	<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: full-text search" href="https://bugs.gnunet.org/browser_search_plugin.php?type=text"/>
	<link rel="search" type="application/opensearchdescription+xml" title="MantisBT: search by Issue Id" href="https://bugs.gnunet.org/browser_search_plugin.php?type=id"/>
	<script type="text/javascript" src="/javascript_config.php?cache_key=afd635dc40a2230c44ffa411a667f877"></script>
	<script type="text/javascript" src="/javascript_translations.php?cache_key=9b492efd30a8c9756069638e8e51a59a"></script>
	<script type="text/javascript" src="/js/jquery-2.2.4.min.js"></script>
	<script type="text/javascript" src="/js/dropzone-5.5.0.min.js"></script>
	<script type="text/javascript" src="/js/common.js"></script>
</head>
<body id="view-issue-page" class="skin-3">
<style>
* { font-family: "Open Sans"; } 
h1, h2, h3, h4, h5 { font-family: "Open Sans"; } 
</style>
<div id="navbar" class="navbar navbar-default navbar-collapse navbar-fixed-top noprint"><div id="navbar-container" class="navbar-container"><button id="menu-toggler" type="button" class="navbar-toggle menu-toggler pull-left hidden-lg hidden-md" data-target="#sidebar"><span class="sr-only">Toggle sidebar</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div class="navbar-header"><a href="/my_view_page.php" class="navbar-brand"><span class="smaller-75"> MantisBT </span></a><button type="button" class="navbar-toggle navbar-toggle collapsed pull-right hidden-sm hidden-md hidden-lg" data-toggle="collapse" data-target=".navbar-buttons,.navbar-menu"><span class="sr-only">Toggle user menu</span><i class="fa fa-user ace-icon fa-2x white" ></i> </button></div><div class="navbar-buttons navbar-header navbar-collapse collapse"><ul class="nav ace-nav">
<li class="grey" id="dropdown_projects_menu">
<a data-toggle="dropdown" href="#" class="dropdown-toggle">
&#160;libextractor&#160;
<i class="fa fa-angle-down ace-icon bigger-110" ></i>
</a>
<ul id="projects-list" class=" dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-close">
<li><div class="projects-searchbox"><input class="search form-control input-md" placeholder="Search" /></div></li>
<li class="divider"></li>
<li><div class="scrollable-menu">
<ul class="list dropdown-yellow no-margin">
<li><a class="project-link" href="/set_project.php?project_id=0">All Projects</a></li>
<li class="divider"></li>
<li><a class="project-link" href="/set_project.php?project_id=29">Anastasis</a></li>
<li><a class="project-link" href="/set_project.php?project_id=6">doodle</a></li>
<li><a class="project-link" href="/set_project.php?project_id=13">GNUnet</a></li>
<li><a class="project-link" href="/set_project.php?project_id=13;16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gnunet-fuse</a></li>
<li><a class="project-link" href="/set_project.php?project_id=13;15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gnunet-gtk</a></li>
<li><a class="project-link" href="/set_project.php?project_id=13;30">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gnunet-www</a></li>
<li><a class="project-link" href="/set_project.php?project_id=13;26">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secushare</a></li>
<li><a class="project-link" href="/set_project.php?project_id=28">libeufin</a></li>
<li><a class="project-link" href="/set_project.php?project_id=7">libextractor</a></li>
<li><a class="project-link" href="/set_project.php?project_id=10">libmicrohttpd</a></li>
<li><a class="project-link" href="/set_project.php?project_id=23">Taler</a></li>
</ul>
</div>
</li>
</ul>
</li>
<li class="grey"><a data-toggle="dropdown" href="#" class="dropdown-toggle"><i class="fa fa-user ace-icon fa-2x white" ></i> <span class="user-info">anonymous</span><i class="fa fa-angle-down ace-icon" ></i></a><ul class="user-menu dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-close"><li><a href="https://bugs.gnunet.org/issues_rss.php?"><i class="fa fa-rss-square orange ace-icon" ></i> RSS</a></li><li class="divider"></li><li><a href="/logout_page.php"><i class="fa fa-sign-out ace-icon" ></i> Logout</a></li></ul></li></ul></div></div></div><div class="main-container" id="main-container">
<div id="sidebar" class="sidebar sidebar-fixed responsive compact "><ul class="nav nav-list"><li>
<a href="/my_view_page.php">
<i class="fa fa-dashboard menu-icon" ></i>
<span class="menu-text"> My View </span>
</a>
<b class="arrow"></b>
</li>
<li class="active">
<a href="/view_all_bug_page.php">
<i class="fa fa-list-alt menu-icon" ></i>
<span class="menu-text"> View Issues </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/changelog_page.php">
<i class="fa fa-retweet menu-icon" ></i>
<span class="menu-text"> Change Log </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/roadmap_page.php">
<i class="fa fa-road menu-icon" ></i>
<span class="menu-text"> Roadmap </span>
</a>
<b class="arrow"></b>
</li>
<li>
<a href="/plugin.php?page=Source/index">
<i class="fa fa-code-fork menu-icon" ></i>
<span class="menu-text"> Repositories </span>
</a>
<b class="arrow"></b>
</li>
</ul><div id="sidebar-btn" class="sidebar-toggle sidebar-collapse"><i data-icon2="ace-icon fa fa-angle-double-right" data-icon1="ace-icon fa fa-angle-double-left"
		class="ace-icon fa fa-angle-double-left"></i></div></div><div class="main-content">
<div id="breadcrumbs" class="breadcrumbs noprint">
<ul class="breadcrumb">
 <li><i class="fa fa-user home-icon active" ></i>Anonymous </li>
<div class="btn-group btn-corner">
	<a href="/login_page.php?return=%2Fview.php%3Fid%3D5846" class="btn btn-primary btn-xs">Login</a>
	<a href="/signup_page.php" class="btn btn-primary btn-xs">Signup for a new account</a>
</div>
</ul>
<div id="nav-search" class="nav-search"><form class="form-search" method="post" action="/jump_to_bug.php"><span class="input-icon"><input type="text" name="bug_id" autocomplete="off" class="nav-search-input" placeholder="Issue #"><i class="fa fa-search ace-icon nav-search-icon" ></i></span></form></div>
</div>
  <div class="page-content">
<div class="row">
<div class="col-md-12 col-xs-12"><div class="widget-box widget-color-blue2"><div class="widget-header widget-header-small"><h4 class="widget-title lighter"><i class="fa fa-bars ace-icon" ></i>View Issue Details</h4></div><div class="widget-body"><div class="widget-toolbox padding-8 clearfix noprint"><div class="btn-group pull-left"><a class="btn btn-primary btn-white btn-round btn-sm" href="#bugnotes">Jump to Notes</a><a class="btn btn-primary btn-white btn-round btn-sm" href="#history">Jump to History</a></div><div class="btn-group pull-right"></div></div><div class="widget-main no-padding"><div class="table-responsive"><table class="table table-bordered table-condensed"><tfoot><tr class="noprint"><td colspan="6"><div class="btn-group"></div></td></tr></tfoot><tbody><tr class="bug-header"><th class="bug-id category" width="15%">ID</th><th class="bug-project category" width="20%">Project</th><th class="bug-category category" width="15%">Category</th><th class="bug-view-status category" width="15%">View Status</th><th class="bug-date-submitted category" width="15%">Date Submitted</th><th class="bug-last-modified category" width="20%">Last Update</th></tr><tr class="bug-header-data"><td class="bug-id">0005846</td><td class="bug-project">libextractor</td><td class="bug-category">extract</td><td class="bug-view-status">public</td><td class="bug-date-submitted">2019-08-21 09:31</td><td class="bug-last-modified">2021-01-30 15:33</td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="hidden"></tr><tr><th class="bug-reporter category">Reporter</th><td class="bug-reporter"><a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>&nbsp;</td><th class="bug-assigned-to category">Assigned To</th><td class="bug-assigned-to"><a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>&nbsp;</td><td colspan="2">&#160;</td></tr><tr><th class="bug-priority category">Priority</th><td class="bug-priority">high</td><th class="bug-severity category">Severity</th><td class="bug-severity">minor</td><th class="bug-reproducibility category">Reproducibility</th><td class="bug-reproducibility">always</td></tr><tr><th class="bug-status category">Status</th><td class="bug-status"><i class="fa fa-square fa-status-box status-90-fg" ></i> closed</td><th class="bug-resolution category">Resolution</th><td class="bug-resolution">fixed</td><td colspan="2">&#160;</td></tr><tr><th class="bug-platform category">Platform</th><td class="bug-platform">linux</td><th class="bug-os category">OS</th><td class="bug-os">ubuntu</td><th class="bug-os-build category">OS Version</th><td class="bug-os-build">16.4</td></tr><tr><th class="bug-product-version category">Product Version</th><td class="bug-product-version">1.9</td><td colspan="4">&#160;</td></tr><tr><th class="bug-target-version category">Target Version</th><td class="bug-target-version">1.10</td><th class="bug-fixed-in-version category">Fixed in Version</th><td class="bug-fixed-in-version">1.10</td><td colspan="2">&#160;</td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="hidden"></tr><tr><th class="bug-summary category">Summary</th><td class="bug-summary" colspan="5">0005846: A heap-buffer-overflow vulneribility in function EXTRACTOR_dvi_extract_method in dvi_extractor.c</td></tr><tr><th class="bug-description category">Description</th><td class="bug-description" colspan="5">In EXTRACTOR_dvi_extract_method function, it read klen from file, so a crafted file can set klen to an invalid value. When exceeding the valid size, it will cause an overflow and trigger a crash in the code.</td></tr><tr><th class="bug-steps-to-reproduce category">Steps To Reproduce</th><td class="bug-steps-to-reproduce" colspan="5">extract -i <a href="mailto:../crashes/EXTRACTOR_dvi_extract_method@dvi">../crashes/EXTRACTOR_dvi_extract_method@dvi</a>_extractor.c_264-5___heap-buffer-overflow</td></tr><tr><th class="bug-tags category">Tags</th><td class="bug-tags" colspan="5"><a class="btn btn-xs btn-primary btn-white btn-round" href="tag_view_page.php?tag_id=24" title="">Error</a></td></tr><tr class="spacer"><td colspan="6"></td></tr><tr class="hidden"></tr></tbody></table></div></div></div></div></div>
<div class="col-md-12 col-xs-12">
<a id="attachments"></a>
<a id="bugnotes"></a>
<div class="space-10"></div>

<div id="bugnotes" class="widget-box widget-color-blue2 ">
<div class="widget-header widget-header-small">
	<h4 class="widget-title lighter">
		<i class="fa fa-comments ace-icon" ></i>		Activities	</h4>
	<div class="widget-toolbar">
		<a data-action="collapse" href="#">
			<i class="fa fa-chevron-up 1 ace-icon bigger-125" ></i>		</a>
	</div>
	</div>
	<div class="widget-body">
	<div class="widget-main no-padding">
	<div class="table-responsive">
	<table class="table table-bordered table-condensed table-striped">
<tr class="bugnote visible-on-hover-toggle" id="c847">
		<td class="category">
		<div class="pull-left padding-2">		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2019-08-21 09:31					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note">
	<div class="well well-xs">
<div id="attachment_preview_847_open" class=" collapse-closed noprint"><a href="file_download.php?file_id=847&amp;type=bug"><i class="fa fa-file-text-o " title="md file icon"></i></a>&#32;<a href="file_download.php?file_id=847&amp;type=bug">EXTRACTOR_dvi_extract_method@dvi_extractor.c_264_heapbufferoverflow.md</a>&#32;(3,815&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_847_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<pre class="bug-attachment-preview-text">## EXTRACTOR_dvi_extract_method@dvi_extractor.c:264-5___heap-buffer-overflow

### description

    An issue was discovered in libextractor 1.1, There is a/an heap-buffer-overflow in function EXTRACTOR_dvi_extract_method at dvi_extractor.c:264-5

### commandline

    extract -i @@ /dev/null

### source

```c
 260   {
 261     char comment[klen + 1];
 262     
 263     comment[klen] = '\0';
&gt; 264    memcpy (comment, &amp;data[15], klen);
 265     if (0 != ec-&gt;proc (ec-&gt;cls, 
 266 		       "dvi",
 267 		       EXTRACTOR_METATYPE_COMMENT,
 268 		       EXTRACTOR_METAFORMAT_C_STRING,
 269 		       "text/plain",

```

### bug report

```txt
=================================================================
==4645==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60b000007220 at pc 0x0000004a2e3d bp 0x7fffec7aa230 sp 0x7fffec7a99e0
READ of size 249 at 0x60b000007220 thread T0
    #0 0x4a2e3c in __asan_memcpy (/src/aflbuild/installed/bin/extract+0x4a2e3c)
    #1 0x7fb9d56bcd59 in EXTRACTOR_dvi_extract_method /src/libextractor/src/plugins/dvi_extractor.c:264:5
    #2 0x7fb9da6dc97f in do_extract /src/libextractor/src/main/extractor.c:582:7
    #3 0x7fb9da6da8c9 in EXTRACTOR_extract /src/libextractor/src/main/extractor.c:661:3
    #4 0x4ec5b3 in main /src/libextractor/src/main/extract.c:983:2
    #5 0x7fb9d97c282f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291
    #6 0x418fd8 in _start (/src/aflbuild/installed/bin/extract+0x418fd8)

0x60b000007220 is located 0 bytes to the right of 112-byte region [0x60b0000071b0,0x60b000007220)
allocated by thread T0 here:
    #0 0x4b9108 in __interceptor_malloc (/src/aflbuild/installed/bin/extract+0x4b9108)
    #1 0x7fb9d56bc53c in EXTRACTOR_dvi_extract_method /src/libextractor/src/plugins/dvi_extractor.c:185:23
    #2 0x7fb9da6dc97f in do_extract /src/libextractor/src/main/extractor.c:582:7
    #3 0x7fb9da6da8c9 in EXTRACTOR_extract /src/libextractor/src/main/extractor.c:661:3

SUMMARY: AddressSanitizer: heap-buffer-overflow (/src/aflbuild/installed/bin/extract+0x4a2e3c) in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c167fff8df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c167fff8e00: fa fa fa fa fa fa fa fa fa fa fd fd fd fd fd fd
  0x0c167fff8e10: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
  0x0c167fff8e20: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa
  0x0c167fff8e30: fa fa fa fa fa fa 00 00 00 00 00 00 00 00 00 00
=&gt;0x0c167fff8e40: 00 00 00 00[fa]fa fa fa fa fa fa fa 00 00 00 00
  0x0c167fff8e50: 00 00 00 00 00 00 00 00 07 fa fa fa fa fa fa fa
  0x0c167fff8e60: fa fa fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c167fff8e70: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c167fff8e80: fd fd fd fd fd fa fa fa fa fa fa fa fa fa fd fd
  0x0c167fff8e90: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==4645==ABORTING

```

### others

    from fuzz project pwd-libextractor-extract-00
    crash name pwd-libextractor-extract-00-00000016-20190817
    Auto-generated by pyspider at 2019-08-17 14:51:38

    please send email to  teamseri0us360@gmail.com if you have any questions.</pre></div>
<div id="attachment_preview_847_closed" class="collapse-section-closed  collapse-open"><a href="file_download.php?file_id=847&amp;type=bug"><i class="fa fa-file-text-o " title="md file icon"></i></a>&#32;<a href="file_download.php?file_id=847&amp;type=bug">EXTRACTOR_dvi_extract_method@dvi_extractor.c_264_heapbufferoverflow.md</a>&#32;(3,815&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_847_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div><div class="well well-xs"><a href="file_download.php?file_id=848&amp;type=bug"><i class="fa fa-file-o " title="unknown file icon"></i></a>&#32;<a href="file_download.php?file_id=848&amp;type=bug">EXTRACTOR_dvi_extract_method@dvi_extractor.c_264-5___heap-buffer-overflow</a>&#32;(112&#32;bytes)<br /></div>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c14800">
		<td class="category">
		<div class="pull-left padding-2">		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2019-08-21 12:10					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=5846#c14800" class="lighter" title="Direct link to note">
				~0014800			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	the data points to a chunk whose size is 129, but when tring to read 249 triggers a heap-over-flow.<br />
pwndbg&gt; malloc_chunk data-0x10<br />
0x6072a0 FASTBIN {<br />
&#160;&#160;prev_size = 0, <br />
&#160;&#160;size = 129, <br />
&#160;&#160;fd = 0xf914f9f9fffe02f7, <br />
&#160;&#160;bk = 0xf9f9f9f9f9f9f9f9, <br />
&#160;&#160;fd_nextsize = 0xe8f9f9fffffffff8, <br />
&#160;&#160;bk_nextsize = 0xf9f9f9f9f9f9f903<br />
}<br />
pwndbg&gt; p klen<br />
$4 = 249	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c849">
		<td class="category">
		<div class="pull-left padding-2">		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2019-08-21 12:11					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">reporter</span>			&#160;
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note">
	<div class="well well-xs">
<div id="attachment_preview_849_open" class=" collapse-closed noprint"><a href="file_download.php?file_id=849&amp;type=bug"><i class="fa fa-file-text-o " title="md file icon"></i></a>&#32;<a href="file_download.php?file_id=849&amp;type=bug">EXTRACTOR_dvi_extract_method@dvi_extractor.c_264_heapbufferoverflow(1).md</a>&#32;(4,210&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_849_open_link" class="collapse-link noprint"><i class="fa fa-chevron-up bigger-120" title="-"></i></a>
<pre class="bug-attachment-preview-text">## EXTRACTOR_dvi_extract_method@dvi_extractor.c:264-5___heap-buffer-overflow

### description

    An issue was discovered in libextractor 1.1, There is a/an heap-buffer-overflow in function EXTRACTOR_dvi_extract_method at dvi_extractor.c:264-5

### commandline

    extract -i @@ /dev/null

### source

```c
 260   {
 261     char comment[klen + 1];
 262     
 263     comment[klen] = '\0';
&gt; 264    memcpy (comment, &amp;data[15], klen);
 265     if (0 != ec-&gt;proc (ec-&gt;cls, 
 266 		       "dvi",
 267 		       EXTRACTOR_METATYPE_COMMENT,
 268 		       EXTRACTOR_METAFORMAT_C_STRING,
 269 		       "text/plain",

```


### debug

```
pwndbg&gt; malloc_chunk data-0x10
0x6072a0 FASTBIN {
  prev_size = 0, 
  size = 129, 
  fd = 0xf914f9f9fffe02f7, 
  bk = 0xf9f9f9f9f9f9f9f9, 
  fd_nextsize = 0xe8f9f9fffffffff8, 
  bk_nextsize = 0xf9f9f9f9f9f9f903
}
pwndbg&gt; p klen
$4 = 249

```

### bug report

```txt
=================================================================
==4645==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60b000007220 at pc 0x0000004a2e3d bp 0x7fffec7aa230 sp 0x7fffec7a99e0
READ of size 249 at 0x60b000007220 thread T0
    #0 0x4a2e3c in __asan_memcpy (/src/aflbuild/installed/bin/extract+0x4a2e3c)
    #1 0x7fb9d56bcd59 in EXTRACTOR_dvi_extract_method /src/libextractor/src/plugins/dvi_extractor.c:264:5
    #2 0x7fb9da6dc97f in do_extract /src/libextractor/src/main/extractor.c:582:7
    #3 0x7fb9da6da8c9 in EXTRACTOR_extract /src/libextractor/src/main/extractor.c:661:3
    #4 0x4ec5b3 in main /src/libextractor/src/main/extract.c:983:2
    #5 0x7fb9d97c282f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291
    #6 0x418fd8 in _start (/src/aflbuild/installed/bin/extract+0x418fd8)

0x60b000007220 is located 0 bytes to the right of 112-byte region [0x60b0000071b0,0x60b000007220)
allocated by thread T0 here:
    #0 0x4b9108 in __interceptor_malloc (/src/aflbuild/installed/bin/extract+0x4b9108)
    #1 0x7fb9d56bc53c in EXTRACTOR_dvi_extract_method /src/libextractor/src/plugins/dvi_extractor.c:185:23
    #2 0x7fb9da6dc97f in do_extract /src/libextractor/src/main/extractor.c:582:7
    #3 0x7fb9da6da8c9 in EXTRACTOR_extract /src/libextractor/src/main/extractor.c:661:3

SUMMARY: AddressSanitizer: heap-buffer-overflow (/src/aflbuild/installed/bin/extract+0x4a2e3c) in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c167fff8df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c167fff8e00: fa fa fa fa fa fa fa fa fa fa fd fd fd fd fd fd
  0x0c167fff8e10: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
  0x0c167fff8e20: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa
  0x0c167fff8e30: fa fa fa fa fa fa 00 00 00 00 00 00 00 00 00 00
=&gt;0x0c167fff8e40: 00 00 00 00[fa]fa fa fa fa fa fa fa 00 00 00 00
  0x0c167fff8e50: 00 00 00 00 00 00 00 00 07 fa fa fa fa fa fa fa
  0x0c167fff8e60: fa fa fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c167fff8e70: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c167fff8e80: fd fd fd fd fd fa fa fa fa fa fa fa fa fa fd fd
  0x0c167fff8e90: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==4645==ABORTING

```


![image](https://note.youdao.com/yws/public/resource/3b7c0127c9c4c2ad0e78cdd349059ec8/xmlnote/64AAF5527F764EC5BFAE55B65EAE74B1/22386)

### others

    from fuzz project pwd-libextractor-extract-00
    crash name pwd-libextractor-extract-00-00000016-20190817
    Auto-generated by pyspider at 2019-08-17 14:51:38

    please send email to  teamseri0us360@gmail.com if you have any questions.</pre></div>
<div id="attachment_preview_849_closed" class="collapse-section-closed  collapse-open"><a href="file_download.php?file_id=849&amp;type=bug"><i class="fa fa-file-text-o " title="md file icon"></i></a>&#32;<a href="file_download.php?file_id=849&amp;type=bug">EXTRACTOR_dvi_extract_method@dvi_extractor.c_264_heapbufferoverflow(1).md</a>&#32;(4,210&#32;bytes)&#32;&nbsp;&nbsp;<a id="attachment_preview_849_closed_link" class="collapse-link noprint"><i class="fa fa-chevron-down bigger-120" title="+"></i></a></div></div>	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
<tr class="bugnote visible-on-hover-toggle" id="c14801">
		<td class="category">
		<div class="pull-left padding-2">		</div>
		<div class="pull-left padding-2">
		<p class="no-margin">
			<i class="fa fa-user grey" ></i> <a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>		</p>
		<p class="no-margin small lighter">
			<i class="fa fa-clock-o grey" ></i>			2019-08-23 09:38					</p>
		<p class="no-margin">
			<span class="label label-sm label-default arrowed-in-right">manager</span>			&#160;
						<i class="fa fa-link grey" ></i>			<a rel="bookmark" href="view.php?id=5846#c14801" class="lighter" title="Direct link to note">
				~0014801			</a>
					</p>
				<div class="clearfix"></div>
		<div class="space-2"></div>
		<div class="btn-group visible-on-hover">
				</div>
		</div>
	</td>
	<td class="bugnote-note bugnote-public">
	Fixed in 1ecee9a..756ba06, thanks for reporting!	</td>
</tr>
<tr class="spacer">
	<td colspan="2"></td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
	<div class="col-md-12 col-xs-12">
		<a id="history"></a>
		<div class="space-10"></div>
	
		<div id="history" class="widget-box widget-color-blue2 ">
	<div class="widget-header widget-header-small">
		<h4 class="widget-title lighter">
			<i class="fa fa-history ace-icon" ></i>			Issue History		</h4>
		<div class="widget-toolbar">
			<a data-action="collapse" href="#">
				<i class="fa fa-chevron-up 1 ace-icon bigger-125" ></i>			</a>
		</div>
	</div>
	<div class="widget-body">
	<div class="widget-main no-padding">
	<div class="table-responsive">
	<table class="table table-bordered table-condensed table-hover table-striped">
		<thead>
			<tr>
				<th class="small-caption">
					Date Modified				</th>
				<th class="small-caption">
					Username				</th>
				<th class="small-caption">
					Field				</th>
				<th class="small-caption">
					Change				</th>
			</tr>
		</thead>
	
		<tbody>
				<tr>
				<td class="small-caption">
					2019-08-21 09:31				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>				</td>
				<td class="small-caption">
					New Issue				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-21 09:31				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>				</td>
				<td class="small-caption">
					Tag Attached: Error				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-21 09:31				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>				</td>
				<td class="small-caption">
					File Added: EXTRACTOR_dvi_extract_method@dvi_extractor.c_264_heapbufferoverflow.md				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-21 09:31				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>				</td>
				<td class="small-caption">
					File Added: EXTRACTOR_dvi_extract_method@dvi_extractor.c_264-5___heap-buffer-overflow				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-21 12:10				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>				</td>
				<td class="small-caption">
					Note Added: 0014800				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-21 12:11				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=1422">jianglin</a>				</td>
				<td class="small-caption">
					File Added: EXTRACTOR_dvi_extract_method@dvi_extractor.c_264_heapbufferoverflow(1).md				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-23 09:38				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Note Added: 0014801				</td>
				<td class="small-caption">
									</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-23 09:38				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Assigned To				</td>
				<td class="small-caption">
					 =&gt; Christian Grothoff				</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-23 09:38				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Status				</td>
				<td class="small-caption">
					new =&gt; resolved				</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-23 09:38				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Resolution				</td>
				<td class="small-caption">
					open =&gt; fixed				</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-23 09:38				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Fixed in Version				</td>
				<td class="small-caption">
					 =&gt; 1.10				</td>
			</tr>
				<tr>
				<td class="small-caption">
					2019-08-23 09:39				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Target Version				</td>
				<td class="small-caption">
					 =&gt; 1.10				</td>
			</tr>
				<tr>
				<td class="small-caption">
					2021-01-30 15:33				</td>
				<td class="small-caption">
					<a href="https://bugs.gnunet.org/view_user_page.php?id=3">Christian Grothoff</a>				</td>
				<td class="small-caption">
					Status				</td>
				<td class="small-caption">
					resolved =&gt; closed				</td>
			</tr>
			</tbody>
	</table>
	</div>
	</div>
	</div>
	</div>
	</div>
	
	</div>
</div>
</div>
<div class="clearfix"></div>
<div class="space-20"></div>
<div class="footer noprint">
<div class="footer-inner">
<div class="footer-content">
<div class="col-md-6 col-xs-12 no-padding">
<address>
<strong>Powered by <a href="https://www.mantisbt.org" title="bug tracking software">MantisBT </a></strong> <br>
<small>Copyright &copy; 2000 - 2021 MantisBT Team</small><br><small>Contact <a href="mailto:mantis@gnunet.org" title="Contact the webmaster via e-mail.">administrator</a> for assistance</small><br>
</address>
</div>
<div class="col-md-6 col-xs-12">
<div class="pull-right" id="powered-by-mantisbt-logo">
<a href="https://www.mantisbt.org" title="Mantis Bug Tracker: a free and open source web based bug tracking system."><img src="/images/mantis_logo.png" width="102" height="35" alt="Powered by Mantis Bug Tracker: a free and open source web based bug tracking system." /></a>
</div>
</div>
</div>
</div>
</div>
<a class="btn-scroll-up btn btn-sm btn-inverse display" id="btn-scroll-up" href="#">
<i class="fa fa-angle-double-up ace-icon icon-only bigger-110" ></i>
</a>
</div>
	<script type="text/javascript" src="/js/bootstrap-3.4.1.min.js"></script>
	<script type="text/javascript" src="/js/moment-with-locales-2.24.0.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap-datetimepicker-4.17.47.min.js"></script>
	<script type="text/javascript" src="/js/typeahead.jquery-1.3.0.min.js"></script>
	<script type="text/javascript" src="/js/list-1.5.0.min.js"></script>
	<script type="text/javascript" src="/js/ace.min.js"></script>
</body>
</html>
