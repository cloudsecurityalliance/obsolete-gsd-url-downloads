<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<title>CRLF Injection - Sercomm VD625 CVE-2021-27132 - CyberTuz</title>
<meta name="description" content="">
<meta name="title" content="">
<meta name="author" content="Tuz">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="https://cybertuz.com/themes/responsiv-clean/assets/images/icon.ico">
<link href="https://cybertuz.com/combine/3b8c554acf2d9e324d07b02809fb55a1-1625846843" rel="stylesheet">
<link href="https://cybertuz.com/combine/0c266449cca14d5a88f8ad0b2679f8a7-1632521634" rel="stylesheet">
<link rel="stylesheet" href="https://cybertuz.com/plugins/code200/eucookielawmadness/assets/cookieconsent.min.css">
<link rel="stylesheet" href="https://cybertuz.com/combine/037a48b63b543b0f35d4ace6e88ddffa-1613074921">
<link rel="stylesheet" href="https://cybertuz.com/plugins/tallpro/blogcomments/assets/main.css">
    </head>
    <body>

        <div style="max-width: 1403px; margin: 0 auto">
            <!-- Header -->
            <header id="layout-header">
                <div class="row">
    <div class="col-sm-9">
        
             <a href="https://cybertuz.com"> <img src="https://cybertuz.com/themes/responsiv-clean/assets/images/logo.png" style="width:100%;"></a>
       
      
    </div>
    <div class="col-sm-3">
        <button type="button" class="sidebar-toggle" onclick="toggleSidebar()">
            <span class="icon-bars">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </span>
            <span class="menu-text">Menu</span>
        </button>
    </div>
</div>            </header>

            <!-- Sidebar -->
            <section id="layout-sidebar">
                <div class="sidebar-close visible-sm visible-xs">
    <a href="javascript:;" onclick="toggleSidebar()" class="close">&times;</a>
</div>
 <a href="https://cybertuz.com"> <img src="https://cybertuz.com/themes/responsiv-clean/assets/images/logo.png" style="width:100%;"></a>

 
     <!-- CyberTuz -->

<div class="sidebar-segment">
    <h2 class="segment-title">Recent posts</h2>
    <ul class="segment-list">
                    <li><a href="https://cybertuz.com/blog/post/crlf-injection-CVE-2021-27132">CRLF Injection - Sercomm VD625 CVE-2021-27132</a></li>
            </ul>
</div>


<div class="sidebar-segment">
    <h2 class="segment-title">Info</h2>
    <ul class="segment-list">       
        <li><a href="https://cybertuz.com/about" >About</a></li>
        <li><a href="https://cybertuz.com/contact">Contact</a></li>
    </ul>
</div>


<div class="sidebar-segment">
    <h2 class="segment-title">Follow me</h2>
    <ul class="segment-list">

        <li><img src="https://cybertuz.com/themes/responsiv-clean/assets/images/twitter.ico" width="20" height="20">    	&nbsp; 	&nbsp; <a href="https://twitter.com/_TuzTheKing_" target="_blank">Twitter</a></li>
        <li><img src="https://cybertuz.com/themes/responsiv-clean/assets/images/linkedin.ico" width="20" height="20">   	&nbsp; 	&nbsp;  <a href="https://www.linkedin.com/in/vasile-adrian-rusz-806590172/" target="_blank">Linkedin</a></li>
        <li><img src="https://cybertuz.com/themes/responsiv-clean/assets/images/rss.ico" width="20" height="20">  	&nbsp; 	&nbsp;   <a href="https://cybertuz.com/blog/rss.xml" target="_blank">RSS Feed</a></li>
    </ul>
</div>            </section>

            <!-- Content -->
            <section id="layout-content">
                
<div class="post-single">
    <article>
                <header class="post-title">
            <h1>CRLF Injection - Sercomm VD625 CVE-2021-27132</h1>
               <span class="published"><i class="icon icon-calendar"></i> Feb 25, 2021</span>  
        </header>
<br>
        <div class="post-content">
            <div class='gutenberg__content wp-embed-responsive'><!-- wp:paragraph -->
<p>An issue was discovered in <strong>Sercomm AGCOMBO VD625-Smart Modem</strong> - Firmware version: <strong>AGSOT_2.1.0</strong>, there is a <strong>CRLF Injection</strong> vulnerability via the header field "<strong>Content-Disposition</strong>".</p>
<!-- /wp:paragraph -->
<!-- wp:group -->
<div class="wp-block-group"><div class="wp-block-group__inner-container"><!-- wp:paragraph -->
<p>The Sercomm AGCOMBO VD625-Smart Modem is a <strong>CPE</strong> (Customer-premises equipment) made by Sercomm for the various <strong>ISPs</strong> (Internet service providers).    The device in which the vulnerability was found is the one for<strong> TIM</strong> (Telecom Italia).</p>
<!-- /wp:paragraph --></div></div>
<!-- /wp:group -->
<!-- wp:image {"align":"center","width":213,"height":185,"sizeSlug":"large","className":"margin-left: 10%;"} -->
<div class="wp-block-image margin-left: 10%;"><figure class="aligncenter size-large is-resized"><img src="/storage/app/media/sercomm/modem-tim-smart-fibra_sercomm-VD625.png" alt="" width="213" height="185"></figure></div>
<!-- /wp:image -->
<!-- wp:paragraph -->
<p>The vulnerability described below refers specifically to the firmware version: <strong>AGSOT_2.1.0</strong> in the image below there are complete information of the device where the vulnerability was found.</p>
<!-- /wp:paragraph -->
<!-- wp:image {"align":"center","sizeSlug":"large"} -->
<div class="wp-block-image"><figure class="aligncenter size-large"><img src="/storage/app/media/sercomm/device_info.png" alt=""></figure></div>
<!-- /wp:image -->
<!-- wp:group -->
<div class="wp-block-group"><div class="wp-block-group__inner-container"><!-- wp:group -->
<div class="wp-block-group"><div class="wp-block-group__inner-container"><!-- wp:paragraph {"align":"left"} -->
<p class="has-text-align-left">The device expose a <strong>web interface</strong> for management, it is possible to create a modified http request to the web server, just putting a .txt or other type of extension in the url of <strong>GET</strong> request, the device thinks it is a download request. Then the system takes the contents of the url that we insert and puts it in the header field "<strong>Content-Disposition</strong>" and the system will try to download this file.</p>
<!-- /wp:paragraph --></div></div>
<!-- /wp:group --></div></div>
<!-- /wp:group -->
<!-- wp:paragraph -->
<p>This header field is not properly sanitized, so it is possible to use the <strong>CRLF technique(\r\n)</strong> to force the header to wrap by inserting a new line and then insert other header fields as desired in the http response.</p>
<!-- /wp:paragraph -->
<!-- wp:image {"sizeSlug":"large"} -->
<figure class="wp-block-image size-large"><img src="/storage/app/media/sercomm/CRLF.png" alt=""></figure>
<!-- /wp:image -->
<!-- wp:paragraph -->
<p>As we can see in the image, we were able to inject the <strong>CRLFInjection cookie</strong> using the CRLF technique (encoding the values \r\n with %0d%0a) in the GET request with the url test.txt. In short, the system takes the url as input and puts it in the "<strong>Content-Disposition</strong>" field and it tries to download the selected "file", but when it finds the <strong>CRLF field</strong> it wraps the header and adds other header fields that we have <strong>concatenated</strong> in the url.</p>
<!-- /wp:paragraph -->
<!-- wp:paragraph -->
<p>While it does not appear to be a serious impact on the system, theoretically a possible attacker could find a way to use it to <strong>compromise the system</strong> by loading malicious code or it could even lead to an<strong> XSS</strong>.</p>
<!-- /wp:paragraph -->
<!-- wp:paragraph -->
<p>The Common Vulnerabilities and Exposures (CVE) Program has assigned the ID CVE-2021-27132 to this issue. This is a record on the <a href="https://cve.mitre.org/cve/">CVE List</a>, which standardizes names for security problems.</p>
<!-- /wp:paragraph -->
<!-- wp:paragraph -->
<p>For more info about CRLF injection:<a href="https://www.acunetix.com/websitesecurity/crl" target="_blank" rel="noreferrer noopener"> </a><a href="https://www.acunetix.com/websitesecurity/crlf-injection/" target="_blank" rel="noreferrer noopener">https://www.acunetix.com/websitesecurity/crlf-injection/</a></p>
<!-- /wp:paragraph -->
<!-- wp:paragraph {"align":"left"} -->
<p class="has-text-align-left">Vulnerability timeline :</p>
<!-- /wp:paragraph -->
<!-- wp:list -->
<ul><li>8/1/2021:     I discovered the Vulnerability.</li><li>13/1/2021:   The vendor was informed about the vulnerability using PSIRT@sercomm.com .</li><li>8/2/2021:     The vendor confirmed the vulnerability, and said will fix it in the next release.</li><li>9/2/2021:     Request CVE ID.</li><li>18/02/2021: Assigned CVE-2021-27132.</li><li>25/02/2021: Public post.</li></ul>
<!-- /wp:list -->
<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph --></div>
        </div>
        
        
        
        
    
        
        
        
        
         <div class="post-content">












<div id="exTab1">	
<ul  class="nav nav-tabs">
			<li class="active">
        <a  href="#1a" data-toggle="tab"><button type="button"  class="btn btn-warning"><i class="icon  icon-comments "></i>&nbsp;Comments</button></a>
			</li>
			<li><a href="#2a" data-toggle="tab"><button type="button" class="btn btn-success"><i class="icon  icon-pencil"></i>&nbsp;Add Comment</button></a>
			</li>
		
		</ul>

			<div class="tab-content clearfix">
			  <div class="tab-pane active" id="1a">
			  
			  <br><br>
		<div class="post-content">
		
			        <center> <h6>There are no comments at the moment .. you can be the first to add a comment!</h6></center>
      
    
    </div>
 
        
				</div>
				<div class="tab-pane" id="2a">
				
				<br>
       <div class="comments-block">
        <form method="POST" action="https://cybertuz.com/blog/post/crlf-injection-CVE-2021-27132" accept-charset="UTF-8" data-request="onComment" id="comment_form" data-request-flash="1" data-request-validate="1"><input name="_session_key" type="hidden" value="o4fsUlpiOtTLv4JLcePpX9BtQBL5Uqb1hznn1AT9"><input name="_token" type="hidden" value="DfjpdQHfSFNjtU775TXoox34EJnxhVDuSi3fJxxI">
    <div data-validate-error></div>

    
    <label for="tallpro_comments_user_name_">
        Your name
        <input type="text" class="form-control name-field" id="tallpro_comments_user_name_" name="user_name"/>
    </label>
    <br>
    <label for="tallpro_comments_user_email_">
        Your Email address
        <input type="text" class="form-control email-field" id="tallpro_comments_user_email_" name="user_email"/>
    </label>
    <br>

    
    <input type="hidden" value="" name="parent_id" />
    <label for="tallpro_comments_comment-text_">
        Comment
        <textarea class="form-control comment-field" id="tallpro_comments_comment-text_" name="comment" cols="50"
                  rows="3"></textarea>
    </label>
    <input name="post_id" type="hidden" value="0">
    <br>
    <div class="g-recaptcha" data-callback="recaptchaCallback" data-sitekey="6Lc4n2YaAAAAALpxCTTyq11U1wiVPSkL9DYXXA5s"></div>
<script type="text/javascript" src="https://www.google.com/recaptcha/api.js?hl="></script>    <button type="submit" data-attach-loading class='btn btn-primary send-comment'>Send</button>
    <br>
    <div id="message"></div>
    <br>
    </form>

    </div>

				</div>
        
			</div>
  </div>














 


 
























    </div>

        <!-- 
        <footer>
            <span class="published"><i class="icon icon-calendar"></i> Feb 25, 2021</span>
                      in
                <span class="category">
                    <i class="icon icon-folder-open"></i>
                                            <a href="https://cybertuz.com/blog/category/cve">CVE</a>                                    </span>
                    </footer>
    </article>
    
    
    <nav class="post-links">
                    </nav> 
    -->
</div>            </section>

            <!-- Footer -->
            <footer id="layout-footer">
                <div class="footer-inner">
    <p class="muted credit">
        <center>&copy;  2021
        &mdash; TuZ </center>
        
    </p>
</div>            </footer>
        </div>

        <!-- Scripts -->
        <script src="https://cybertuz.com/combine/e3373cc901d40e715caed195fe607480-1625846843"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BJHHBJ0LQ8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BJHHBJ0LQ8');
</script>
<script src="https://cybertuz.com/plugins/code200/eucookielawmadness/assets/cookieconsent.min.js"></script>
<script src="https://cybertuz.com/plugins/tallpro/blogcomments/assets/js/comment.js"></script>
<script>
        window.cookieconsent.initialise({
            content: {
                "header":"Cookies used on the website!",
                "message":"This website uses cookies to ensure you get the best experience on our website",
                "dismiss":"Got it",
                "allow":"Allow",
                "deny":"Decline!",
                "link":"More info",
                "href":""
            },
            "position":"bottom",
            "container":"",
            "palette": {
                popup:{"background":"#edeff5","text":"#838391"},
button:{"background":"#4b81e8","text":"#edeff5"},
highlight: {background: '#ffffff', border: '#ffffff', text: '#838391'}
            },
            "theme":"block",
            "elements":{
                header: '<span class="cc-header">{{header}}</span> ',
message: '<span id="cookieconsent:desc" class="cc-message">{{message}}</span>',
messagelink: '<span id="cookieconsent:desc" class="cc-message">{{message}} <a aria-label="learn more about cookies" tabindex="0" class="cc-link" href="{{href}}" target="_blank">{{link}}</a></span>',
dismiss: '<a aria-label="dismiss cookie message" tabindex="0" class="cc-btn cc-dismiss">{{dismiss}}</a>',
allow: '<a aria-label="allow cookies" tabindex="0" class="cc-btn cc-allow">{{allow}}</a>',
deny: '<a aria-label="deny cookies" tabindex="0" class="cc-btn cc-deny">{{deny}}</a>',
link: '<a aria-label="learn more about cookies" tabindex="0" class="cc-link" href="{{href}}" target="_blank">{{link}}</a>',
close: '<span aria-label="dismiss cookie message" tabindex="0" class="cc-close">{{close}}</span>'
            },
            "compliance": {
                'info': '<div class="cc-compliance">{{dismiss}}</div>',
'opt-in': '<div class="cc-compliance cc-highlight">{{dismiss}}{{allow}}</div>',
'opt-out': '<div class="cc-compliance cc-highlight">{{deny}}{{dismiss}}</div>',
            },
            "type":"info",
            "revokable":false,
            "revokeBtn":"<div class=\"cc-revoke {{classes}}\">Cookie Policy<\/div>",
            "static":false,
            "dismissOnScroll":"",
            "dismissOnTimeout":"",

            "cookie.path": "/",
            "cookie.name": "cookieconsent_status",
            "cookie.domain": "",
            "cookie.expiryDays": "365",

            onStatusChange: function(status, chosenBefore) {
                if(status == 'deny'){
                    clearAllCookiesExceptCookieNotice();
                }

                window.location.reload();
            }
        });

        function getCookieDomain() {
            var cookieDomain = "";
            if(cookieDomain.trim() == ""){
                cookieDomain = window.location.hostname;
            }
            return cookieDomain;
        }

        function getCookiePath() {
            var cookiePath =  "/";
            if(cookiePath.trim() == "") {
                cookiePath = "/";
            }
            return cookiePath;
        }

        function clearAllCookiesExceptCookieNotice() {
            var cookies = document.cookie.split(";");
            var cookieDomain = getCookieDomain();
            var cookiePath = getCookiePath();

            for (var i = 0; i < cookies.length; i++) {
                var spcook =  cookies[i].split("=");
                var cookieName = spcook[0].trim();
                if(cookieName != 'cookieconsent_status') {
                     document.cookie = cookieName + "=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain="+cookieDomain+"; path="+cookiePath;
                     document.cookie = cookieName + "=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain=."+cookieDomain+"; path="+cookiePath;
                }
            }
        }</script>    </body>
</html>