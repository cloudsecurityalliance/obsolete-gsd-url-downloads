<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>047eec456943dc082e33220d28abb7df4e089f69 - platform/frameworks/native - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/frameworks/native/%2B/047eec456943dc082e33220d28abb7df4e089f69">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/">frameworks</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/native/">native</a> / <span class="Breadcrumbs-crumb">047eec456943dc082e33220d28abb7df4e089f69</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>047eec456943dc082e33220d28abb7df4e089f69</td><td><span>[<a href="/platform/frameworks/native/+log/047eec456943dc082e33220d28abb7df4e089f69">log</a>]</span> <span>[<a href="/platform/frameworks/native/+archive/047eec456943dc082e33220d28abb7df4e089f69.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Arve Hjønnevåg &lt;arve@android.com&gt;</td><td>Thu Aug 18 15:42:35 2016 -0700</td></tr><tr><th class="Metadata-title">committer</th><td>gitbuildkicker &lt;android-build@google.com&gt;</td><td>Fri Aug 26 10:40:56 2016 -0700</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/">0fac1ccb55e942beb438d4a32e39f5bd263a85b9</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69%5E">d3c6ce463ac91ecbeb2128beb475d31d3ca6ef42</a> <span>[<a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">ServiceManager: Allow system services running as secondary users to add services

This should be reverted when all system services have been cleaned up to not
do this. A process looking up a service while running in the background will
see the service registered by the active user (assuming the service is
registered on every user switch), not the service registered by the user that
the process itself belongs to.

BUG: 30795333
Change-Id: <a href="https://android-review.googlesource.com/#/q/I1b74d58be38ed358f43c163692f9e704f8f31dbe">I1b74d58be38ed358f43c163692f9e704f8f31dbe</a>
(cherry picked from commit e6bbe69ba739c8a08837134437aaccfea5f1d943)
</pre><ul class="DiffTree"><li><a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/cmds/servicemanager/Android.mk">cmds/servicemanager/Android.mk</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69%5E%21/#F0">diff</a>]</span></li><li><a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/cmds/servicemanager/service_manager.c">cmds/servicemanager/service_manager.c</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69%5E%21/#F1">diff</a>]</span></li></ul><div class="DiffSummary">2 files changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 0fac1ccb55e942beb438d4a32e39f5bd263a85b9</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - MODULE_LICENSE_APACHE2"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/MODULE_LICENSE_APACHE2">MODULE_LICENSE_APACHE2</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - NOTICE"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/NOTICE">NOTICE</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - aidl/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/aidl/">aidl/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - build/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/build/">build/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - cmds/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/cmds/">cmds/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - data/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/data/">data/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - docs/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/docs/">docs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - include/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/include/">include/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - libs/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/libs/">libs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - opengl/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/opengl/">opengl/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - services/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/services/">services/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - vulkan/"><a class="FileList-itemLink" href="/platform/frameworks/native/+/047eec456943dc082e33220d28abb7df4e089f69/vulkan/">vulkan/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>