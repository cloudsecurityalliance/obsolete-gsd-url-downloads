<!DOCTYPE html>
















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Microsoft Security Bulletin MS02-028 - Critical" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-028" />

	<meta name="twitter:card" content="summary" />

	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="BetaFred" />
<meta name="breadcrumb_path" content="/security-updates/breadcrumb/toc.json" />
<meta name="depot_name" content="Security.security-updates" />
<meta name="document_id" content="ba379976-9e90-d162-7ebd-db52500619ad" />
<meta name="document_version_independent_id" content="73959fe4-5cb7-70bd-52b3-8871514adfe5" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/security-updates/blob/6dc3a10875edd52e4c959c02578f535867f7c5c4/security-updates/SecurityBulletins/2002/ms02-028.md" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="BetaFred" />
<meta name="ms.date" content="10/11/2017" />
<meta name="ms.service" content="security-updates" />
<meta name="ms.topic" content="article" />
<meta name="ms:assetid" content="ms02-028" />
<meta name="ms:contentKeyID" content="61221922" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/en-us/library/ms02-028(v=Security.10)" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-028.md" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="Title" content="Microsoft Security Bulletin MS02-028 - Critical" />
<meta name="TOCTitle" content="MS02-028" />
<meta name="updated_at" content="2017-11-11 12:46 AM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="../../toc.json" />
<meta name="word_count" content="3358" />


<link href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-028" rel="canonical">
	<title>Microsoft Security Bulletin MS02-028 - Critical | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/46dad2a9.site-ltr.css ">

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-028.md',
			extendBreadcrumb: true,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
			contributors: [
						{ name: "BetaFred", url: "https://github.com/BetaFred" },
						{ name: "Santoshtambe", url: "https://github.com/Santoshtambe" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>

	<script src="/_themes/docs.theme/master/en-us/_themes/global/5cce29c0.deprecation.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/bb2ae21c.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div hidden id="cookie-consent-holder"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">
Download Microsoft Edge					</a>
					<a href="https://docs.microsoft.com/en-US/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">
More info					</a>
				</div>
			</div>

		</div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="is-hidden"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet padding-xs font-size-sm display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button button button-clear button-sm" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button button-clear button-sm has-inner-focus" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
								<li id="contenteditbtn" hidden>
									<a href="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-028.md"  class=" button button-clear button-sm has-inner-focus" title="Edit This Document" data-bi-name="edit">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button button-clear button-sm button-block justify-content-flex-start has-inner-focus" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button  button button-clear button-sm is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button  button button-clear button-sm is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



							

								<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
									<li>
										<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2017-11-11T00:46:00Z" data-article-date-source="git">11/11/2017</time>
									</li>
											<li class="readingTime">16 minutes to read</li>
										<li class="contributors-holder">
											<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
																<li class="facepile-item">
																	<a href="https://github.com/BetaFred" title="BetaFred" aria-label="BetaFredGithub profile" data-src="https://github.com/BetaFred.png?size=32" data-contributor-name="BetaFred" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/BetaFred.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">B</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/Santoshtambe" title="Santoshtambe" aria-label="SantoshtambeGithub profile" data-src="https://github.com/Santoshtambe.png?size=32" data-contributor-name="Santoshtambe" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/Santoshtambe.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">S</span>
																	</a>
																</li>
											</ul>
										</li>
								</ul>

								<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>


							<!-- <content> -->
								<p>Security Bulletin</p>
<h1 id="microsoft-security-bulletin-ms02-028---critical">Microsoft Security Bulletin MS02-028 - Critical</h1>
<h2 id="heap-overrun-in-htr-chunked-encoding-could-enable-web-server-compromise-q321599">Heap Overrun in HTR Chunked Encoding Could Enable Web Server Compromise (Q321599)</h2>
<p>Published: June 12, 2002 | Updated: February 28, 2003</p>
<p><strong>Version:</strong> 2.1</p>
<p><strong>Originally posted:</strong> June 12, 2002</p>
<p><strong>Updated:</strong> February 28th, 2003</p>
<h4 id="summary">Summary</h4>
<p><strong>Who should read this bulletin:</strong>
Customers hosting web servers using Microsoft® Windows NT® 4.0 or Windows® 2000.</p>
<p><strong>Impact of vulnerability:</strong>
Run code of an attacker's choice on the system</p>
<p><strong>Maximum Severity Rating:</strong>
Critical</p>
<p><strong>Recommendation:</strong>
Customers who have a business-critical reason for retaining HTR scripting should apply the patch immediately. All others should ensure HTR is disabled.</p>
<p><strong>Affected Software:</strong></p>
<ul>
<li>Microsoft Internet Information Server 4.0</li>
<li>Microsoft Internet Information Services 5.0</li>
</ul>
<h3 id="general-information">General Information</h3>
<h2 id="technical-details">Technical details</h2>
<p><strong>Technical description:</strong></p>
<p>On June 12, 2002, Microsoft released the original version of this bulletin. On July 1, 2002, the bulletin was updated to revise the severity rating. Specifically, Microsoft has increased the severity rating of this issue to &quot;critical .&quot; The revision is in response to a significant change in the threat environment due to an increased focus on chunked encoding vulnerabilities in general, and the discovery of hostile code attempting to exploit similar vulnerabilities on other platforms. Customers who have already disabled HTR or applied this patch need not take any action. Customers who have not disabled HTR should do so as soon as possible. Alternately, customers who cannot disable HTR should apply the patch immediately.</p>
<p>This patch eliminates a newly discovered vulnerability affecting Internet Information Services. Although Microsoft typically delivers cumulative patches for IIS, in this case we have delivered a patch that eliminates only this new vulnerability, while completing a cumulative patch. When the cumulative patch is customer-ready, we will update this bulletin with information on its availability. The FAQ provides information on the circumstances surrounding the vulnerability, and why we believe releasing a singleton patch immediately is in customers' best interests. To ensure that servers are fully protected against past as well as current vulnerabilities, we strongly recommend installing the previous cumulative patch (discussed in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms02-018" data-linktype="external">MS02-018</a>) before installing this patch.</p>
<p>The vulnerability is similar to the <a href="http://technet.microsoft.com/security/bulletin/ms02-018" data-linktype="external">first vulnerability</a> discussed in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms02-018" data-linktype="external">MS02-018</a>. Like that vulnerability, this one involves a buffer overrun in the Chunked Encoding data transfer mechanism in IIS 4.0 and 5.0, and could likewise be used to overrun heap memory on the system, with the result of either causing the IIS service to fail or allowing code to be run on the server. The chief difference between the vulnerabilities is that the newly discovered one lies in the ISAPI extension that implements HTR - an older, largely obsolete scripting technology - where the previous one lay in the ISAPI extension that implements ASP.</p>
<p><strong>Mitigating factors:</strong></p>
<ul>
<li>Microsoft has long recommended disabling HTR functionality unless there is a business-critical reason for retaining it. Systems on which HTR is disabled would not be at risk from this vulnerability.</li>
<li>The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables HTR by default in all server configurations.</li>
<li>The current version of the <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool provides a means of blocking chunked encoding transfer requests by default.</li>
<li>On default installations of IIS 5.0, exploiting the vulnerability to run code would grant the attacker the privileges of the IWAM_computername account, which has only the privileges commensurate with those of an interactively logged-on unprivileged user.</li>
</ul>
<p><strong>Severity Rating:</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IIS 4.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>Critical</td>
</tr>
<tr>
<td><strong>IIS 5.0</strong></td>
<td>Critical</td>
<td>Critical</td>
<td>Critical</td>
</tr>
</tbody>
</table>
<p>The above <a href="http://technet.microsoft.com/security/bulletin/rating" data-linktype="external">assessment</a> is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. Although the vulnerability would grant varying degrees of control to a successful attacker, depending on the particular version in use, a server configured using any of the Microsoft security checklists or security tools would not have the HTR functionality enabled.</p>
<p><strong>Vulnerability identifier:</strong> <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0364" data-linktype="external">CAN-2002-0364</a></p>
<p><strong>Tested Versions:</strong></p>
<p>Microsoft tested IIS 4.0, 5.0 and 5.1 to assess whether they are affected by these vulnerabilities. Previous versions are no longer <a href="http://support.microsoft.com/directory/discontinue.asp" data-linktype="external">supported</a>, and may or may not be affected by these vulnerabilities. IIS 6.0 is a beta product, and beta products are typically not eligible for security patches; however, we have confirmed that no beta versions of IIS 6.0 are affected by the vulnerability.</p>
<h2 id="frequently-asked-questions">Frequently asked questions</h2>
<p><strong>Why was this bulletin updated?</strong><br/>
On July 1, 2002, we updated this bulletin to advise customers of a revision in the severity rating of this issue. Specifically, we have increased the rating for this issue to &quot;critical&quot; because of new information that materially changes the threat environment. Specifically, we have become aware of increased interest and activity surrounding chunked encoding vulnerabilities in general, and are aware of attempts to exploit similar issues on other platforms. While Microsoft is not currently aware of any attempts to maliciously exploit this specific issue, we feel that this activity constitutes an increased threat. We have proactively revised the severity rating to &quot;critical&quot; to more accurately represent this threat and we are urging all customers to immediately disable HTR mappings if at all possible. Those customers who cannot disable HTR mappings are urged to apply the patch immediately. Customers who have already taken steps to address this issue need not take any action.</p>
<p><strong>Is this a cumulative patch?</strong><br/>
No. This patch eliminates a newly discovered security vulnerability, but it is not cumulative. A cumulative patch for this issue and others is under development, and will be completed shortly. When it is available, we will update this bulletin to provide information on how to obtain it.
Because this patch is not cumulative, we recommend that customers ensure that they have installed the most recent cumulative patch (delivered in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms02-018" data-linktype="external">MS02-018</a>) before installing this patch.</p>
<p><strong>I thought Microsoft's policy was to provide cumulative patches for IIS. Why isn't this patch cumulative?</strong><br/>
Microsoft's normal policy is to provide security fixes for IIS via cumulative patches. In fact, a cumulative patch has been underway for several weeks. However, cumulative patches require extensive testing because of their scope and wide deployment. As a result, the cumulative patch is several weeks away from being customer-ready.
The newly discovered vulnerability is similar to another vulnerability (discussed in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms02-018" data-linktype="external">MS02-018</a>), for which exploit tools are already available. At the same time, eliminating the vulnerability required only a small amount of code change, in a component with few dependencies on other code. As a result, we concluded that there was high value in developing a singleton patch and that we could do so in a much shorter timeframe than usual.</p>
<p><strong>If I don't want to install the patch, is there a workaround procedure for this vulnerability?</strong><br/>
Yes. As discussed below, the vulnerability can be eliminated by disabling a rarely used feature in IIS. Customers who have already disabled this feature don't need to take any additional action.</p>
<p><strong>What's the scope of the vulnerability?</strong><br/>
This is a buffer overrun vulnerability affecting IIS 4.0 and 5.0. By sending a specially chosen request to an affected web server, an attacker could either disrupt web services or gain the ability to run a program on the server. Such a program would run with full system privileges in IIS 4.0, and with fewer but nevertheless significant privileges in IIS 5.0
Microsoft has long recommended that customers remove the functionality that contains the vulnerability unless there is a business-critical reason for retaining it, and customers who have done so would be at no risk from this vulnerability. The <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables this functionality by default. Customers who have retained the functionality but deployed the <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> tool as discussed in Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms02-018" data-linktype="external">MS02-018</a> would likewise be protected against the vulnerability.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because of an arithmetic error in the ISAPI extension that implements the HTR functionality. Specifically, the error lies in a function that enables data to be uploaded to a web server via chunked encoding, and causes IIS to allocate a buffer of the wrong size to hold incoming data, with the result that the data could overrun the end of the buffer.</p>
<p><strong>What is an ISAPI extension?</strong><br/>
<a href="http://msdn.microsoft.com/en-us/library/aa279331(vs.60).aspx" data-linktype="external">ISAPI</a> (Internet Services Application Programming Interface) is a technology that enables web developers to extend the functionality of their web servers by writing custom code that provides new services for a web server. Such code can be implemented in either of two forms:</p>
<ul>
<li>As an <a href="http://msdn2.microsoft.com/en-us/library/ms524610.aspx" data-linktype="external">ISAPI filter</a> -- a <a href="http://msdn2.microsoft.com/en-us/library/ms682589.aspx" data-linktype="external">dynamic link library</a> (.dll) that uses ISAPI to respond to events that occur on the server.</li>
<li>As an <a href="http://msdn2.microsoft.com/en-us/library/ms525172.aspx" data-linktype="external">ISAPI extension</a> -- a dynamic link library that uses ISAPI to provide a set of web functions above and beyond those natively provided by IIS.</li>
</ul>
<p>In the case of this vulnerability, the affected code is an ISAPI extension that implements scripting via HTR.</p>
<p><strong>What is HTR?</strong><br/>
HTR is a first-generation advanced scripting technology delivered as part of IIS 2.0. HTR was never widely adopted, largely because a far superior technology, <a href="http://msdn2.microsoft.com/en-us/default.aspx" data-linktype="external">Active Server Pages</a> (.ASP), was introduced in IIS 4.0 and became popular before customers had invested significant development resources in HTR. However, all versions of IIS through version 5.1 do provide support for HTR, for purposes of backward compatibility.
Microsoft has long advocated that customers disable HTR on their web servers, unless there is a business-critical need for the technology. By default, the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> disables HTR support, by unmapping the HTR ISAPI extension.</p>
<p><strong>Are there any widespread uses for HTR?</strong><br/>
Virtually the only purpose for which HTR technology is still used today is web-based password management services. IIS ships with a set of HTR scripts that, if deployed, make it possible for users to change their Windows NT passwords via a web server, and make it possible for administrators to perform password management through the web.
In general, Microsoft recommends against performing password management over the web. However, for customers who must do this, we recommend converting any needed HTR scripts to ASP.</p>
<p><strong>What is chunked encoding?</strong><br/>
Web servers frequently need the ability to accept data from a user. For instance, when a visitor to a web site fills in a form and submits it, the data needs to be uploaded to the server so it can be processed. In cases like this, the amount of data that will be transferred is known in advance, and the server can allocate a buffer of the right size. However, in other scenarios, it's impossible to know beforehand how much data will need to be transferred. For instance, an application might be generating data as it runs, and there might be no way to know exactly how much data it will produce.
The <a href="http://support.microsoft.com/default.aspx?scid=http://www.rfc-editor.org/rfc/rfc2068.txt" data-linktype="external">HTTP protocol specification</a> provides a way to handle data like this, through a process called chunked encoding. In chunked encoding, the client generates a variable-sized quantity of data called a chunk; it then tells the web server how big the chunk is and sends it. The server allocates a buffer to accommodate the incoming chunk, then receives and processes it. As the client generates additional data, it continues agglomerating it into chunks and delivering them to the server.</p>
<p><strong>What's wrong with the way the HTR ISAPI extension in IIS 4.0 and 5.0 performs chunked encoding transfers?</strong><br/>
There's an arithmetic error in the IIS 4.0 and 5.0 HTR implementations, that causes them to miscalculate the size of the buffer that's needed for an incoming chunk and allocate one that's too small. The result is that the data in the chunk can overlap the end of the buffer and overwrite other data in system memory, potentially allowing the operation of IIS to be modified.</p>
<p><strong>How much data could be overwritten?</strong><br/>
By design, the client can specify a chunk of any size - if the server can't accommodate a chunk that large, it should send an error message to the client. However, in addition to causing the wrong-sized buffer to be allocated, the arithmetic error also prevents IIS 4.0 and 5.0 from placing any real limits on the size of a chunk. As a result, it would be possible for a client to send a chunk that would overwrite most or all of the memory in the IIS process
This is a critical point, because it goes to the heart of why this vulnerability poses a threat to servers. This vulnerability is an example of so-called heap overrun; because of the dynamic nature of system memory, these can be more difficult to exploit than stack overruns and may require more sophisticated skills. Data on the server can change locations from one moment to the next, impeding the attacker's ability to overwrite selected programs or data. However, in this case, the attacker wouldn't need to know where programs were located, but could instead simply overwrite large portions of system memory indiscriminately.</p>
<p><strong>What would this enable an attacker to do?</strong><br/>
An attacker who exploited this vulnerability could use it for either of two purposes.</p>
<ul>
<li>Service disruption. By overrunning the buffer with random data, the attacker could corrupt program code and cause the IIS service to fail, thereby preventing the server from providing useful service.</li>
<li>Change the operation of the server. By overrunning the buffer with carefully selected data, the attack could overwrite program code on the server with new program code, in essence modifying the functionality of the server software.</li>
</ul>
<p><strong>Who could exploit the vulnerability?</strong><br/>
Any user who was able to establish a web session with an affected server could exploit the vulnerability.</p>
<p><strong>If the vulnerability were exploited to cause the IIS service to fail, what would be needed to restore normal operation?</strong><br/>
On IIS 4.0, the administrator would need to restart the IIS service. On IIS 5.0, the service would automatically restart itself.</p>
<p><strong>Why could the vulnerability only be used to cause the IIS service to fail? If the attacker were able to overwrite system memory indiscriminately, why not overwrite all memory on the server and cause the entire operating system to fail?</strong><br/>
Windows NT 4.0, Windows 2000 and Windows XP operate in <em>protected mode</em>. In protected mode, processes can only write to sections of memory they own. As a result, it would not be possible for the attacker to overwrite the memory belonging to the operating system.</p>
<p><strong>If the vulnerability were exploited to change the operation of the server software, what would the attacker be able to do?</strong><br/>
In a nutshell, the attacker's code would gain the privileges of the software that called it - the HTR ISAPI extension. The privileges that the attacker could gain would depend on the version of IIS in use on the server:</p>
<ul>
<li>On IIS 4.0, the HTR ISAPI extension runs by default in-process - that is, as part of the IIS Service, which runs as part of the operating system itself. As a result, exploiting the vulnerability on a default IIS 4.0 installation would give the attacker complete control over the server.</li>
<li>On IIS 5.0, the HTR ISAPI extension runs by default out-of-process - that is, in the security context of a special user account called the Web Application Manager. (Web administrators may know this account better as IWAM_<em>computername</em>, where <em>computername</em> is the name of the server). This account has significantly fewer privileges than the IIS service.</li>
</ul>
<p><strong>What privileges does the Web Application Manager have?</strong><br/>
Essentially, the account has the same privileges as those of an unprivileged user who was able to log onto the server interactively. It would not enable an attacker to take administrative action, reconfigure the server, or access important files such as the Security Account Manager database.
Nevertheless, it is important not to underestimate the damage that could be caused using even these privileges. Even these privileges could be used to cause significant damage. Worse, the vulnerability could potentially give an attacker a beachhead from which to conduct additional attacks and try to obtain additional privileges.</p>
<p><strong>I'm running IIS 4.0. Can I configure the HTR ISAPI extension to run out-of-process?</strong><br/>
You <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/iisref/html/psdk/asp/isgu24c3.asp" data-linktype="external">can</a>. However, a better solution is to disable it altogether.</p>
<p><strong>I used the IIS Lockdown Tool to secure my server. Does it disable the HTR ISAPI extension?</strong><br/>
Yes. All versions of the <a href="http://www.microsoft.com/technet/security/tools/locktool.mspx" data-linktype="external">IIS Lockdown Tool</a> remove the HTR functionality by default, in all server configurations.</p>
<p><strong>I've deployed the URLScan Tool on my server. Will it protect my system against this vulnerability?</strong><br/>
All versions of <a href="http://www.microsoft.com/technet/security/tools/urlscan.mspx" data-linktype="external">URLScan</a> beginning with version 2.5 provide the ability to block chunked encoding requests. There are two variants of URLScan, known as &quot;Baseline URLScan&quot; and &quot;URLScan-SRP&quot;. The latter variant blocks chunked encoding by default. The former can be configured to block chunked encoding, by adding an entry to the [DenyHeaders] section of URLScan.ini that reads &quot;Transfer-Encoding:&quot;. (Note: the quotes should not be included in the entry, but there is a colon at the end of the word &quot;Encoding&quot;).</p>
<p><strong>I've disabled the HTR functionality on my IIS server. Do I need the patch?</strong><br/>
If you've disabled the HTR functionality, you're at no risk from this vulnerability.</p>
<p><strong>How does the patch eliminate this vulnerability?</strong><br/>
The patch eliminates the arithmetic error that causes the vulnerability.</p>
<h2 id="patch-availability">Patch availability</h2>
<p><strong>Download locations for this patch</strong></p>
<ul>
<li><p>Microsoft IIS 4.0:</p>
<p><a href="http://www.microsoft.com/ntserver/remove404.mspx" data-linktype="external">http://www.microsoft.com/ntserver/remove404.mspx</a></p>
</li>
<li><p>Microsoft IIS 5.0:</p>
<p><a href="http://support.microsoft.com/kb/321599" data-linktype="external">http://support.microsoft.com/kb/321599</a></p>
</li>
</ul>
<h4 id="additional-information-about-this-patch">Additional information about this patch</h4>
<p><strong>Installation platforms:</strong></p>
<ul>
<li>The IIS 4.0 patch can be installed on systems running Windows NT 4.0 <a href="http://support.microsoft.com/kb/241211" data-linktype="external">Service Pack 6a</a>.</li>
<li>The IIS 5.0 patch can be installed on systems running Windows 2000 <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp1/default.mspx" data-linktype="external">Service Pack 1</a> or <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx" data-linktype="external">Service Pack 2</a>.</li>
</ul>
<p><strong>Inclusion in future service packs:</strong></p>
<ul>
<li>No additional service packs are planned for Windows NT 4.0.</li>
<li>The IIS 5.0 fix will be included in Windows 2000 Service Pack 3.</li>
</ul>
<p><strong>Reboot needed:</strong></p>
<ul>
<li>IIS 4.0: A reboot can be avoid by stopping the IIS service, installing the patch with the /z switch, then restarting the service. Knowledge Base article Q319733 provides additional information on this procedure.</li>
<li>IIS 5.0: No.</li>
</ul>
<p><strong>Superseded patches:</strong> None.</p>
<p><strong>Verifying patch installation:</strong></p>
<p>IIS 4.0:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q321599.</p>
</li>
<li><p>To verify the individual files, consult the file manifest in Knowledge Base article Q321599.</p>
</li>
</ul>
<p>IIS 5.0:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q321599.</p>
</li>
<li><p>To verify the individual files, use the date/time and version information provided in the following registry key:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q321599\Filelist.</p>
</li>
</ul>
<p><strong>Caveats:</strong></p>
<p>None</p>
<p><strong>Localization:</strong></p>
<p>Localized versions of this patch are available at the locations discussed in &quot;Patch Availability&quot;.</p>
<p><strong>Obtaining other security patches:</strong></p>
<p>Patches for other security issues are available from the following locations:</p>
<ul>
<li>Security patches are available from the <a href="http://go.microsoft.com/fwlink/?linkid=21129" data-linktype="external">Microsoft Download Center</a>, and can be most easily found by doing a keyword search for &quot;security_patch&quot;.</li>
<li>Patches for consumer platforms are available from the <a href="http://windowsupdate.microsoft.com/" data-linktype="external">WindowsUpdate</a> web site</li>
</ul>
<h4 id="other-information">Other information:</h4>
<p><strong>Acknowledgments</strong></p>
<p>Microsoft <a href="http://technet.microsoft.com/security/bulletin/policy" data-linktype="external">thanks</a> <a href="http://www.eeye.com/" data-linktype="external">eEye Digital Security</a> for reporting this issue to us and working with us to protect customers.</p>
<p><strong>Support:</strong></p>
<ul>
<li>Microsoft Knowledge Base article Q321599 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the <a href="http://support.microsoft.com/?scid=fh;en-us;kbhowto" data-linktype="external">Microsoft Online Support</a> web site.</li>
<li>Technical support is available from <a href="http://support.microsoft.com/directory/question.asp?sd=gn&amp;fr=0" data-linktype="external">Microsoft Product Support Services</a>. There is no charge for support calls associated with security patches.</li>
</ul>
<p><strong>Security Resources:</strong> The <a href="http://www.microsoft.com/technet/security/default.mspx" data-linktype="external">Microsoft TechNet Security</a> Web Site provides additional information about security in Microsoft products.</p>
<p><strong>Disclaimer:</strong></p>
<p>The information provided in the Microsoft Knowledge Base is provided &quot;as is&quot; without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.</p>
<p><strong>Revisions:</strong></p>
<ul>
<li>V1.0 (June 12, 2002): Bulletin Created.</li>
<li>V1.1 (June 13, 2002): FAQ item updated.</li>
<li>V1.2 (June 20, 2002): Correction made in the Verifying patch installation for IIS 5.0 section.</li>
<li>V2.0 (July 1, 2002): Severity rating updated to reflect changing threat environment.</li>
<li>V2.1 (February 28, 2003): Updated download links to Windows Update.</li>
</ul>
<p><em>Built at 2014-04-18T13:49:36Z-07:00</em></p>

							<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none font-size-h4 margin-bottom-xs">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->



						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>

						<div
							class="font-size-sm right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Page Actions">

							<div id="affixed-right-container" class="doc-outline is-vertically-scrollable">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
