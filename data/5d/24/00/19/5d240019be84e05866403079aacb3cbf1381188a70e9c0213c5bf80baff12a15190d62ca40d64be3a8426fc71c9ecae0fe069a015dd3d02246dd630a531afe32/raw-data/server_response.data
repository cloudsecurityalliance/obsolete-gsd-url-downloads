<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1435908 - (CVE-2018-5182) Web content can open local files and local folders using drag &amp; drop event">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1435908">
<meta property="og:description"
      content="VERIFIED (arai.unmht) in Core - DOM: Copy &amp; Paste and Drag &amp; Drop. Last updated 2018-11-05.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1435908 - (CVE-2018-5182) Web content can open local files and local folders using drag &amp; drop event</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1435908&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1435908">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1435908">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/yui.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/global.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/util.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox61\":\"verified\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox_esr52\":\"wontfix\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox58\":\"wontfix\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox60\":\"verified\",\"cf_status_firefox59\":\"wontfix\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\"},\"project\":{\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_tracking_firefox_sumo\":\"---\"}},\"comments\":{\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1435908;
  BUGZILLA.bug_title = '1435908 - (CVE-2018-5182) Web content can open local files and local folders using drag & drop event';
  BUGZILLA.bug_summary = 'Web content can open local files and local folders using drag & drop event';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1435908';
  BUGZILLA.bug_keywords = 'sec-low',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/field.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/comments.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1435908">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1435908"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1435908 - (CVE-2018-5182) Web content can open local files and local folders using drag &amp;amp; drop event">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="h9EmciIidz3OW907RxfKsDYINTXz71vMOaQ1qzpCpdJsyoUinZ2cvcoWWDHIc2IIPVGlLTaR7EsxhaQHj2Nacoo2UP9zoYGUdjn9fLIwwxFkFXjOZWnqXCsdusAboaDnazWydd1nY56qppZDUwAEVIgGwtd226suQWNH2Ifu9viiq78OSS7uGhOGYVLhE2G1wwjh72CaMygoMaAwLF3UUmvR6iLQtJfaHfjY3Z6bjk2ALflgko9Cg1E8WZLc4NRs">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1435908" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623295-tWytNh9cZG-gnwMeetf40dKY6WTyEOOPXrsqyX3ASvk">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1435908" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1435908" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1435908">Bug 1435908</a>
          <span class="edit-hide">(CVE-2018-5182)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2018-02-05 16:24 PST" data-time="1517876687">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2018-02-28 03:03 PST" data-time="1519815820">4 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Web content can open local files and local folders using drag &amp; drop event</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Web content can open local files and local folders using drag &amp; drop event

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Copy &amp; Paste and Drag &amp; Drop, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop#DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Copy &amp; Paste and Drag &amp; Drop
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Copy &amp; Paste and Drag &amp; Drop</div>
            <div class="description">All issues with copy-and-paste and drag-and-drop can be reported here, be it with the web API or the platform backends. This includes clipboard issues.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Copy &amp; Paste and Drag &amp; Drop"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            58 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_firefox61&quot;:&quot;verified&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;}],&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox58&quot;:&quot;wontfix&quot;,&quot;id&quot;:1435908,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox60&quot;:&quot;verified&quot;,&quot;keywords&quot;:[&quot;sec-low&quot;],&quot;cf_status_firefox59&quot;:&quot;wontfix&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla60&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla60

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox58</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox59</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox60</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox61</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="wontfix"
          id="v3142_cf_status_firefox_esr52" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox58</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox58-dirty">
  <select id="cf_status_firefox58" name="cf_status_firefox58">
        <option value="wontfix"
          id="v3447_cf_status_firefox58" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox59</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox59-dirty">
  <select id="cf_status_firefox59" name="cf_status_firefox59">
        <option value="wontfix"
          id="v3511_cf_status_firefox59" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox60</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox60-dirty">
  <select id="cf_status_firefox60" name="cf_status_firefox60">
        <option value="verified"
          id="v3568_cf_status_firefox60" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox61</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox61-dirty">
  <select id="cf_status_firefox61" name="cf_status_firefox61">
        <option value="verified"
          id="v3655_cf_status_firefox61" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: jordi.chancel, Assigned: arai)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_310076" ><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=310076" > <span class="fna">arai</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_356614" ><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=356614" > <span class="fna">jordi.chancel</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_434964" ><img src="https://secure.gravatar.com/avatar/331afc283e18d6d28cb7ebb11b2cf5bb?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=434964" > <span class="fna">hsinyi</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="10">10 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-low, Whiteboard: [adv-main60+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-5182

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main60+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c29"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1517989958"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1713264">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1713264-dirty">
      <select id="flag-1713264" name="flag-1713264"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (6 files, 4 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8948559">testcase-drag-drop-local-file-opening.html</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2018-02-05 16:24 PST" data-time="1517876687">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div></span>
        </div>
        <div class="attach-info">1.76 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8948559&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8948603">testcase-drag-drop-local-file-opening-[reduced testcase].html</a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2018-02-05 19:38 PST" data-time="1517888338">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div></span>
        </div>
        <div class="attach-info">1.59 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8948603&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8948663">video-demo.html</a>
        </div>
        <div>
            <a href="#c2" class="attach-time activity-ref"><span class="rel-time" title="2018-02-06 05:01 PST" data-time="1517922068">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div></span>
        </div>
        <div class="attach-info">315 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8948663&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8953059">Apply URL fixup in contentAreaDropListener.</a>
        </div>
        <div>
            <a href="#c7" class="attach-time activity-ref"><span class="rel-time" title="2018-02-22 05:45 PST" data-time="1519307126">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.88 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c8"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1519307126"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8953059&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8953059&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8953059">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8953753">Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.</a>
        </div>
        <div>
            <a href="#c11" class="attach-time activity-ref"><span class="rel-time" title="2018-02-24 07:12 PST" data-time="1519485176">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.14 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8953753&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8953753&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8953753">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8953828">Validate non-URI items when dropping items.</a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2018-02-25 06:12 PST" data-time="1519567935">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.59 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8953828&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8953828&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8953828">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8954278">Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.</a>
        </div>
        <div>
            <a href="#c18" class="attach-time activity-ref"><span class="rel-time" title="2018-02-27 00:23 PST" data-time="1519719821">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">4.67 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c22"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1519719821"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8954278&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8954278&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954278">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8954279">Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.</a>
        </div>
        <div>
            <a href="#c19" class="attach-time activity-ref"><span class="rel-time" title="2018-02-27 00:26 PST" data-time="1519719960">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">6.26 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c23"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1519719960"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8954279&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8954279&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954279">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8954280">Part 3: Pass the triggering principal when opening an URI from location bar drag and drop.</a>
        </div>
        <div>
            <a href="#c20" class="attach-time activity-ref"><span class="rel-time" title="2018-02-27 00:29 PST" data-time="1519720150">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">6.67 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#a1898759_159069"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1519720150"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8954280&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8954280&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954280">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8954281">Part 4: Pass the triggering principal when opening an URI in non-tab browser drag and drop.</a>
        </div>
        <div>
            <a href="#c21" class="attach-time activity-ref"><span class="rel-time" title="2018-02-27 00:31 PST" data-time="1519720290">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_310076" ><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.48 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#a1898848_159069"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1519720290"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8954281&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8954281&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954281">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="6Wo4aC59TCbUC4Ki5Ft6Eszt7QlL6XTiPnzlJoLWGtAZpekM">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="13020535" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_356614" ><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-05 16:24 PST" data-time="1517876687">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8948559"
         class="attachment obsolete"
         data-id="8948559" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="testcase-drag-drop-local-file-opening.html">
      <meta itemprop="contentSize" content="1800">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8948559" itemprop="contentUrl">
        <span id="att-8948559-description" itemprop="description">testcase-drag-drop-local-file-opening.html</span></a> (obsolete)
        — <a href="attachment.cgi?id=8948559&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="13020535">User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:58.0) Gecko/20100101 Firefox/58.0
Build ID: 20180128191252

Steps to reproduce:

-1: Open the Test case in Attachments with Firefox.
-2: Try to Drag and drop the link <a rel="nofollow" href="https://www.bankofamerica.com/">https://www.bankofamerica.com/</a> into the Addressbar or Tab bar.



Actual results:

Firefox loads the local folder: File:///etc/ .

(I will upload a demonstration video)


Expected results:

The testcase works on Firefox 58.0.1 and also on Firefox Beta 59.0b6.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="13020771" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_356614" ><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-05 19:38 PST" data-time="1517888338">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8948603"
         class="attachment"
         data-id="8948603" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="testcase-drag-drop-local-file-opening.html">
      <meta itemprop="contentSize" content="1626">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8948603" itemprop="contentUrl">
        <span id="att-8948603-description" itemprop="description">testcase-drag-drop-local-file-opening-[reduced testcase].html</span></a>
        — <a href="attachment.cgi?id=8948603&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-1" data-comment-id="13020771">reduced testcase</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8948559&amp;action=edit"
           title="testcase-drag-drop-local-file-opening.html"
           class=""
        >Attachment #8948559</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="13021410" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_356614" ><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-06 05:01 PST" data-time="1517922068">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8948663"
         class="attachment"
         data-id="8948663" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Video-Example.html">
      <meta itemprop="contentSize" content="315">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8948663" itemprop="contentUrl">
        <span id="att-8948663-description" itemprop="description">video-demo.html</span></a>
        — <a href="attachment.cgi?id=8948663&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-2" data-comment-id="13021410">Here's the demo video.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="13023578" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" ><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-06 23:52 PST" data-time="1517989958">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="13023578">flagging for a bounty as asked, but this rings a bell. Need to check whether this is a dupe of one qab submitted.</pre><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="13027487" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_356614" ><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_356614" ><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 05:44 PST" data-time="1518097440">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="13027487">More detailed information about Steps to reproduce of this local files / local folders access vulnerability:

A selected content 
(like these: // , //etc/ , //etc/ , //etc///////// , ...) 
on the attacker's webpage can open local files or local folders when this content is dragged and dropped into the addressbar or tab bar.</pre></div><div class="change-set" id="a239163_1689"><div class="change" id="aa239163_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a239163_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a239163_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a239163_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a239163_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a239163_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 10:50 PST" data-time="1518115850">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a742076_356614"><div class="change" id="aa742076_356614">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_356614" id="a742076_356614"><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_356614" id="a742076_356614"><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a742076_356614"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a742076_356614">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a742076_356614">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-14 06:32 PST" data-time="1518618763">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(jordi.chancel)</div></div></div><div class="change-set" id="c5"><div class="comment" data-id="13056448" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a742076_356614"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a742076_356614"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-20 16:04 PST" data-time="1519171496">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="13056448">I was thinking of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Drag and dropping file: URL into new tab with rel=noopener allows opening locally stored files"
   href="/show_bug.cgi?id=1424107">bug 1424107</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files by hooking drag and drop to outside of content"
   href="/show_bug.cgi?id=1379842">bug 1379842</a>. Both are now fixed so obviously this is a separate case. Tooru probably knows what's going on here.</pre><div class="activity"><div class="change">Component: General &rarr; Drag and Drop</div><div class="change">Flags: needinfo?(dveditz) &rarr; needinfo?(arai.unmht)</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a></div></div></div><div class="change-set" id="a1294846_1689"><div class="change" id="aa1294846_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1294846_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1294846_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1294846_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a1294846_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-20 16:05 PST" data-time="1519171533">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; dom-core-security</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="13060187" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 21:24 PST" data-time="1519277075">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="13060187">Currently we're checking the access based on the original string,
but apparently URIFixup that is applied later fixes &quot;//etc/&quot; to &quot;file:///etc/&quot;.
so, I think we should check the access based on fixed-up string, inside contentAreaDropListener.
The change in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Dragging multiple lines of text to the tab bar creates multiple tabs"
   href="/show_bug.cgi?id=1435910">bug 1435910</a> will help making this process easier.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; arai.unmht</div><div class="change">Status: UNCONFIRMED &rarr; ASSIGNED</div><div class="change">Ever confirmed: true</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="13060995" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-22 05:45 PST" data-time="1519307126">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8953059"
         class="attachment patch obsolete"
         data-id="8953059" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="01-Bug_1435908___Apply_URL_fixup_in_content.patch">
      <meta itemprop="contentSize" content="2947">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8953059">
          <a class="link" href="attachment.cgi?id=8953059&amp;action=diff">
        <span id="att-8953059-description" itemprop="description">Apply URL fixup in contentAreaDropListener.</span></a> (obsolete)
        — <a href="attachment.cgi?id=8953059&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8953059">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-7" data-comment-id="13060995">Now ContentAreaDropListener.prototype._validateURI applies URI fixup before checking the uri.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(arai.unmht)</span></div><div class="change">
        <a href="/attachment.cgi?id=8953059&amp;action=edit"
           title="Apply URL fixup in contentAreaDropListener."
           class=""
        >Attachment #8953059</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="13061167" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-22 06:49 PST" data-time="1519310998">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="13061167">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8953059" name="attach_8953059" title="Apply URL fixup in contentAreaDropListener.">attachment 8953059</a> <a href="/attachment.cgi?id=8953059&amp;action=edit" title="Apply URL fixup in contentAreaDropListener.">[details]</a> <a href="/attachment.cgi?id=8953059&amp;action=diff" title="Apply URL fixup in contentAreaDropListener.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8953059'>[review]</a>
Apply URL fixup in contentAreaDropListener.

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8953059" name="attach_8953059" title="Apply URL fixup in contentAreaDropListener.">attachment 8953059</a> <a href="/attachment.cgi?id=8953059&amp;action=edit" title="Apply URL fixup in contentAreaDropListener.">[details]</a> <a href="/attachment.cgi?id=8953059&amp;action=diff" title="Apply URL fixup in contentAreaDropListener.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8953059'>[review]</a>:
-----------------------------------------------------------------

I added some comments to the approach in this patch.

However, I'm worried about this more generally. checkLoadURIStr tries to use fixup anyway (see <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/caps/nsScriptSecurityManager.cpp#1048">https://searchfox.org/mozilla-central/source/caps/nsScriptSecurityManager.cpp#1048</a> and lower). But it apparently doesn't attempt to do fixup if creating the URI initially fails. I think that's the problem we should fix instead. That may also help <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Some web extension API's do not account for shorthand form of file:// url"
   href="/show_bug.cgi?id=1427448">bug 1427448</a>. Unfortunately I don't know how much breaks, and pushing to try risks exposing this set of bugs.

::: dom/base/contentAreaDropListener.js
&#64;&#64; +134,5 &#64;&#64;
<span class="quote">&gt; +        Ci.nsIURIFixup.FIXUP_FLAG_ALLOW_KEYWORD_LOOKUP;
&gt; +    let info = Services.uriFixup.getFixupURIInfo(uriString, fixupFlags);
&gt; +    if (info.fixedURI) {
&gt; +      uriStringToCheck = info.fixedURI.spec;
&gt; +    }</span >

Instead, can you define `uri` earlier and assign info.fixedURI to it, and then not call ioService.newURI if `uri` is non-null?

&#64;&#64; +142,5 &#64;&#64;
<span class="quote">&gt;                        .getService(Components.interfaces.nsIIOService);
&gt;      try {
&gt;        // Check that the uri is valid first and return an empty string if not.
&gt;        // It may just be plain text and should be ignored here
&gt; +      uri = ioService.newURI(uriStringToCheck);</span >

If we're here anyway, use Services.io instead and delete the manual getting of the ioservice.

&#64;&#64; +158,5 &#64;&#64;
<span class="quote">&gt;      if (disallowInherit)
&gt;        flags |= secMan.DISALLOW_INHERIT_PRINCIPAL;
&gt;  
&gt;      let principal = this._getTriggeringPrincipalFromDataTransfer(dataTransfer, false);
&gt; +    secMan.checkLoadURIStrWithPrincipal(principal, uriStringToCheck, flags);</span >

If we're guaranteed a uri instance here, shouldn't we be calling checkLoadURIWithPrincipal?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8953059&amp;action=edit"
           title="Apply URL fixup in contentAreaDropListener."
           class=""
        >Attachment #8953059</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review-</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="13061183" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-22 06:53 PST" data-time="1519311237">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="13061183">To rephrase the top of <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c8">comment 8</a> - I am not sure that only fixing the dnd case here is the best solution. The long-term solution is passing the right principal along so that docshell stops the load and then we can stop doing all these manual checks. :jkt is working on this elsewhere already, and we :arai recently fixed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Drag and dropping file: URL into new tab with rel=noopener allows opening locally stored files"
   href="/show_bug.cgi?id=1424107">bug 1424107</a> - does that not help here? Do we not pass the triggering principal along correctly, or something?</pre></div><div class="change-set" id="c10"><div class="comment" data-id="13061186" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-22 06:54 PST" data-time="1519311271">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="13061186">(sorry for spam)
The generic triggering principal bug :jkt is working on is <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Have openUILinkIn() provide the correct triggeringPrincipal"
   href="/show_bug.cgi?id=1374741">bug 1374741</a>.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="13066293" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-24 07:12 PST" data-time="1519485176">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8953753"
         class="attachment patch obsolete"
         data-id="8953753" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="04-Bug_1435908___Check_non_URI_items_in_nsS.patch">
      <meta itemprop="contentSize" content="3215">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8953753">
          <a class="link" href="attachment.cgi?id=8953753&amp;action=diff">
        <span id="att-8953753-description" itemprop="description">Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.</span></a> (obsolete)
        — <a href="attachment.cgi?id=8953753&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8953753">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-11" data-comment-id="13066293">Okay, stopping early-return for non-URI case fixes the issue.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8953059&amp;action=edit"
           title="Apply URL fixup in contentAreaDropListener."
           class=""
        >Attachment #8953059</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8953753&amp;action=edit"
           title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal."
           class=""
        >Attachment #8953753</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="13066429" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-24 11:46 PST" data-time="1519501615">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="13066429">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8953753" name="attach_8953753" title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.">attachment 8953753</a> <a href="/attachment.cgi?id=8953753&amp;action=edit" title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.">[details]</a> <a href="/attachment.cgi?id=8953753&amp;action=diff" title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8953753'>[review]</a>
Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8953753" name="attach_8953753" title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.">attachment 8953753</a> <a href="/attachment.cgi?id=8953753&amp;action=edit" title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.">[details]</a> <a href="/attachment.cgi?id=8953753&amp;action=diff" title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8953753'>[review]</a>:
-----------------------------------------------------------------

I'm really sorry, I think I must have been confused when I wrote my previous comment.

The nsScriptSecurityManager code will throw if you pass it something that isn't a URI. That means it'll already deny these loads. The only thing that changing nsScriptSecurityManager can do for non-valid URIs is be less strict than it is already (logically speaking - right now it throws, the thing we'd accomplish here is... making it also throw, just later. The change may still make sense for the webextension bug, I'm not sure, but that's a separate discussion.

The reason this patch works for the dnd case is that by removing the URI construction in contentAreaDropListener (which catches the cases where the URI isn't valid and returns early without doing the security check), we stop returning early. So now that code will throw (because checkLoadURI throws). That helps for this case, but it also means _validateURI will start throwing for all the things that aren't intended to be URIs, per the comment (&quot;It may just be plain text and should be ignored here&quot;).

In other words, we could fix this bug by just removing only that block and leaving it at that... but what would that break? Is that comment just outdated and do we already catch errors from validateURI and go &quot;huh, I guess this isn't a URI&quot; ? Or how does it work for the cases where the user drops/pastes plaintext?

(:bz, sorry, I CC'd you because I intended to pass this review on given I'd suggested the approach, and then realized the approach was bogus anyway. Un-CC'ing you myself now would be confusing because you'd get bugmail and then still not be able to access the bug, so leaving you here both for clarity and in case you have suggestions/ideas. Feel free to un-cc.)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8953753&amp;action=edit"
           title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal."
           class=""
        >Attachment #8953753</a> -
        Flags: <span class="activity-deleted">review?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c13"><div class="comment" data-id="13066704" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-25 06:06 PST" data-time="1519567593">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="13066704">here's the list of consumers of _validateURI (reversed call tree)

ContentAreaDropListener.prototype._validateURI
  ContentAreaDropListener.prototype.dropLinks
    browserDragAndDrop.dropLinks
      homeButtonObserver.onDrop =&gt; sets links as homepage
      newTabButtonObserver.onDrop =&gt; opens links in new tabs
      newWindowButtonObserver.onDrop =&gt; opens links in new windows
      tabbrowser-tabs.drop handler =&gt; loads links in tabs
      urlbar._getDroppableItem =&gt; returns null if dropLinks throws
        urlbar.onDragOver =&gt; sets aEvent.dataTransfer.dropEffect to none
        urlbar.onDrop =&gt; sets the first item to the URL bar text
    DownloadsPlacesView.prototype.onDrop =&gt; downloads links
    DownloadsIndicatorView.onDrop =&gt; save links
    nsDocShellTreeOwner::HandleEvent =&gt; opens the first link in current tab
                                        and opens the other links in new tabs
                                        (done by parent. another validation is
                                         done on parent side)
    browser.drop handler =&gt; passes to this.droppedLinkHandler
                            (that is handleDroppedLink,
                             that opens links in new tabs)


So, in almost all cases the callers are going to treat the returned links as URL.
and in that case validating non-URL as URL by fixup is fine.

The only problematic case is urlbar, that sets the dropped text as URL bar content, that can be non-URL at that moment.
I'll try fixing that case.
so that we can just fix ContentAreaDropListener.prototype._validateURI to apply fixup in all cases.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="13066712" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-25 06:10 PST" data-time="1519567854">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="13066712">(In reply to Tooru Fujisawa [:arai] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c13">comment #13</a>)
<span class="quote">&gt;       urlbar._getDroppableItem =&gt; returns null if dropLinks throws
&gt;         urlbar.onDragOver =&gt; sets aEvent.dataTransfer.dropEffect to none
&gt;         urlbar.onDrop =&gt; sets the first item to the URL bar text
&gt;     DownloadsPlacesView.prototype.onDrop =&gt; downloads links
&gt; ...
&gt; The only problematic case is urlbar, that sets the dropped text as URL bar
&gt; content, that can be non-URL at that moment.
&gt; I'll try fixing that case.
&gt; so that we can just fix ContentAreaDropListener.prototype._validateURI to
&gt; apply fixup in all cases.</span >

err, sorry I overlooked that it triggers command after setting the value.
so, just throwing there should also be fine.

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/ecb86060b4c5a9808798b81a57e79e821bb47082/browser/base/content/urlbarBindings.xml#1057-1060">https://searchfox.org/mozilla-central/rev/ecb86060b4c5a9808798b81a57e79e821bb47082/browser/base/content/urlbarBindings.xml#1057-1060</a>
<span class="quote">&gt;       &lt;method name=&quot;onDrop&quot;&gt;
&gt;         &lt;parameter name=&quot;aEvent&quot;/&gt;
&gt;         &lt;body&gt;&lt;![CDATA[
&gt;           let droppedItem = this._getDroppableItem(aEvent);
&gt;           if (droppedItem) {
&gt;             this.value = droppedItem instanceof URL ? droppedItem.href : droppedItem;
&gt;             SetPageProxyState(&quot;invalid&quot;);
&gt;             this.focus();
&gt;             this.handleCommand();</span ></pre></div><div class="change-set" id="c15"><div class="comment" data-id="13066713" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-25 06:12 PST" data-time="1519567935">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8953828"
         class="attachment patch obsolete"
         data-id="8953828" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="01-Bug_1435908___Validate_non_URI_items_whe.patch">
      <meta itemprop="contentSize" content="1633">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8953828">
          <a class="link" href="attachment.cgi?id=8953828&amp;action=diff">
        <span id="att-8953828-description" itemprop="description">Validate non-URI items when dropping items.</span></a> (obsolete)
        — <a href="attachment.cgi?id=8953828&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8953828">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-15" data-comment-id="13066713">Removed the change to nsScriptSecurityManager.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8953753&amp;action=edit"
           title="Check non-URI items in nsScriptSecurityManager::CheckLoadURIStrWithPrincipal."
           class=""
        >Attachment #8953753</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8953828&amp;action=edit"
           title="Validate non-URI items when dropping items."
           class=""
        >Attachment #8953828</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="13069055" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-26 05:49 PST" data-time="1519652969">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="13069055">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8953828" name="attach_8953828" title="Validate non-URI items when dropping items.">attachment 8953828</a> <a href="/attachment.cgi?id=8953828&amp;action=edit" title="Validate non-URI items when dropping items.">[details]</a> <a href="/attachment.cgi?id=8953828&amp;action=diff" title="Validate non-URI items when dropping items.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8953828'>[review]</a>
Validate non-URI items when dropping items.

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8953828" name="attach_8953828" title="Validate non-URI items when dropping items.">attachment 8953828</a> <a href="/attachment.cgi?id=8953828&amp;action=edit" title="Validate non-URI items when dropping items.">[details]</a> <a href="/attachment.cgi?id=8953828&amp;action=diff" title="Validate non-URI items when dropping items.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8953828'>[review]</a>:
-----------------------------------------------------------------

I'm sorry, I think my previous review was not clear:

(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c12">comment #12</a>)
<span class="quote">&gt; In other words, we could fix this bug by just removing only that block and
&gt; leaving it at that... but what would that break? Is that comment just
&gt; outdated and do we already catch errors from validateURI and go &quot;huh, I
&gt; guess this isn't a URI&quot; ? Or how does it work for the cases where the user
&gt; drops/pastes plaintext?</span >

As I suspected, this breaks e.g. dragging &quot;ab cd&quot; to the tabstrip, and having it open a web search (at least, that's what I'm seeing testing this change locally). I imagine similar things break for the other cases. We shouldn't break that.

Taking several steps back...

The proper thing to do here is to check the final URI that's loaded against the original principal that triggered such a load. In Nightly, I think this already happens for the tabstrip ( <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/7208b6a7b11c3ed8c87a7f17c9c30a8f9583e791/browser/base/content/tabbrowser.xml#7656,7673,7681">https://dxr.mozilla.org/mozilla-central/rev/7208b6a7b11c3ed8c87a7f17c9c30a8f9583e791/browser/base/content/tabbrowser.xml#7656,7673,7681</a> ) note that <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c0">comment #0</a> omits 60 - did this get fixed for 60 by <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Drag and dropping file: URL into new tab with rel=noopener allows opening locally stored files"
   href="/show_bug.cgi?id=1424107">bug 1424107</a>?

I am less sure what's happening for the URL bar off-hand. We should ensure that the right triggering principal is passed there, too. Note that I think <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/7208b6a7b11c3ed8c87a7f17c9c30a8f9583e791/browser/base/content/urlbarBindings.xml#1019-1034">https://dxr.mozilla.org/mozilla-central/rev/7208b6a7b11c3ed8c87a7f17c9c30a8f9583e791/browser/base/content/urlbarBindings.xml#1019-1034</a> should be updated to get the triggering principal off the event instead of checking browser.contentPrincipal. We should also somehow pass the triggering principal to handleCommand when executing the load.

We should probably check other callers to see if they execute loads (off-hand based on the reverse calltree in the comment, I expect e.g. the downloads button will do this too) and have similar fixes there.

There are some cases where this isn't a complete fix. Notably, dragging to some other UI elements will not actually execute a load but create a bookmark or similar.

In that case, we still need to do some kind of manual check, I guess. The problem is that in some cases we just want to paste plain text, it seems? We should avoid breaking <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Dragging multiple lines of text to the tab bar creates multiple tabs"
   href="/show_bug.cgi?id=1435910">bug 1435910</a> . If we just fix up every line allowing for search bar fixup, we will always find a link (you can always do a search, of course) which would regress that.

So what I think we should do is both:
1) fix up callsites like the url bar, downloads button etc. to ensure they pass the right triggering principal. This will stop the load at the docshell level.
2) something similar to the first patch on this bug (now marked obsolete) that I r-'d (sorry!). Instead of checking Services.io.newURI, use fixup to get a URI. Pass the typo and search flags like the patch did. However, if the fixup info's `keywordProviderName` is non-empty, pass back the original string. This will mean that we're going to execute a search if allowed, and otherwise we won't find a URL (or, if being very liberal, we'll create a URL from a single word, but that will necessarily be an http URI so loading it should be OK). If we the `keywordProviderName` is empty we've fixed up to have a URI object in `fixedURI`. Pass the URI object (and not the uristring) to scriptSecurityManager.checkLoadURIWithPrincipal (note: not checkLoadURI*String*WithPrincipal), and if successful, pass back that URI's spec (not the original input).

Note that (2) is overly complicated to handle the case where a line just contains a single word. If people drag 'security' to the tabstrip or similar, they'll want a search for 'security', not loading &quot;<a rel="nofollow" href="http://security/">http://security/</a>&quot;, even if that's what fixup will suggest if we don't pass the search keyword flag.

:arai, does that seem sensible? Happy to discuss this more on IRC / vidyo / bugzilla if that's helpful.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8953828&amp;action=edit"
           title="Validate non-URI items when dropping items."
           class=""
        >Attachment #8953828</a> -
        Flags: <span class="activity-deleted">review?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c17"><div class="comment" data-id="13071752" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 00:22 PST" data-time="1519719729">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="13071752">Yes, that plan sounds good.
I've modified code and looks like they're working.


here's the same tree from (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c13">comment #13</a>) with how principal is/was used for each case:

(reverse call tree)
ContentAreaDropListener.prototype._validateURI
  ContentAreaDropListener.prototype.dropLinks
    browserDragAndDrop.dropLinks
      homeButtonObserver.onDrop =&gt; sets links as homepage
        ** doesn't load immediately, we should rely on validation in ContentAreaDropListener **
      newTabButtonObserver.onDrop =&gt; opens links in new tabs
        ** wasn't using triggering principal, FIXED **
      newWindowButtonObserver.onDrop =&gt; opens links in new windows
        ** wasn't using triggering principal, FIXED **
      tabbrowser-tabs.drop handler =&gt; loads links in tabs
        ** is using triggering principal, OK **
      urlbar._getDroppableItem =&gt; returns null if dropLinks throws
        urlbar.onDragOver =&gt; sets aEvent.dataTransfer.dropEffect to none
          ** doesn't use links, OK **
        urlbar.onDrop =&gt; loads a link
          ** wasn't using triggering principal, FIXED **
    DownloadsPlacesView.prototype.onDrop =&gt; downloads links
      ** seems to be using system principal, but I cannot locate the actual call path, NEEDS FIX? **
    DownloadsIndicatorView.onDrop =&gt; save links
      ** is using system principal, NEEDS FIX **
    nsDocShellTreeOwner::HandleEvent =&gt; opens the first link in current tab
                                        and opens the other links in new tabs
                                        (done by parent. another validation is
                                         done on parent side)
      ** is using triggering principal for normal case, OK **
      ** wasn't using triggering principal for non-tab browser, FIXED **
    browser.drop handler =&gt; passes to this.droppedLinkHandler
                            (that is handleDroppedLink,
                             that opens links in new tabs)
      ** is using triggering principal, OK **

Now almost all cases use triggering principal.

Even if we don't validate the URL in ContentAreaDropListener, they can block the loading.
(but the timing is very late, like, new blank tab or new window can be opened, so it's better keeping the validation in ContentAreaDropListener anyway)


The remaining cases are download:
  * library window (DownloadsPlacesView)
  * download indicator button (DownloadsIndicatorView)

for download indicator, it seems to be possible to pass triggering principal
(it's long way tho)

(non-reverse call tree)
DownloadsIndicatorView.onDrop
  saveURL
    internalSave
      internalPersist
        nsWebBrowserPersist::SavePrivacyAwareURI
          nsWebBrowserPersist::SaveURIInternal
            ** uses system principal when creating channel **

for library window, it seems to be hard.
currently download item doesn't have triggering principal information.


then, apart from ContentAreaDropListener,
creating bookmark surely doesn't validate the URL. I'll look into it (but maybe we should leave it to other bug?).


for now, I'll post patches for other already-fixed cases.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="13071757" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 00:23 PST" data-time="1519719821">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8954278"
         class="attachment patch"
         data-id="8954278" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="01-Bug_1435908___Part_1__Get_triggering_pri.patch">
      <meta itemprop="contentSize" content="4787">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8954278">
          <a class="link" href="attachment.cgi?id=8954278&amp;action=diff">
        <span id="att-8954278-description" itemprop="description">Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.</span></a>
        — <a href="attachment.cgi?id=8954278&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954278">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-18" data-comment-id="13071757">This is the main fix that uses fixed-up URI for validation.

Now it does validation only if fixup returns non-search URL.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8953828&amp;action=edit"
           title="Validate non-URI items when dropping items."
           class=""
        >Attachment #8953828</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8954278&amp;action=edit"
           title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string."
           class=""
        >Attachment #8954278</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="13071758" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 00:26 PST" data-time="1519719960">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8954279"
         class="attachment patch"
         data-id="8954279" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="02-Bug_1435908___Part_2__Pass_the_triggerin.patch">
      <meta itemprop="contentSize" content="6410">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8954279">
          <a class="link" href="attachment.cgi?id=8954279&amp;action=diff">
        <span id="att-8954279-description" itemprop="description">Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.</span></a>
        — <a href="attachment.cgi?id=8954279&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954279">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-19" data-comment-id="13071758">This fixes New Tab button and New Window button,

openNewTabWith and openNewWindowWith are modified to receive parameter object,
since some parameters are not used and adding more makes it complicated.

now triggering principal is passed to openLinkIn via them.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954279&amp;action=edit"
           title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop."
           class=""
        >Attachment #8954279</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="13071761" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 00:29 PST" data-time="1519720150">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8954280"
         class="attachment patch"
         data-id="8954280" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="03-Bug_1435908___Part_3__Pass_the_triggerin.patch">
      <meta itemprop="contentSize" content="6835">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8954280">
          <a class="link" href="attachment.cgi?id=8954280&amp;action=diff">
        <span id="att-8954280-description" itemprop="description">Part 3: Pass the triggering principal when opening an URI from location bar drag and drop.</span></a>
        — <a href="attachment.cgi?id=8954280&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954280">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-20" data-comment-id="13071761">This fixed URL bar.

now it passes triggering principal to openUILinkIn.
and also it uses triggering principal for urlSecurityCheck.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954280&amp;action=edit"
           title="Part 3: Pass the triggering principal when opening an URI from location bar drag and drop."
           class=""
        >Attachment #8954280</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="13071765" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1294846_1689"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 00:31 PST" data-time="1519720290">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8954281"
         class="attachment patch"
         data-id="8954281" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="04-Bug_1435908___Part_4__Pass_the_triggerin.patch">
      <meta itemprop="contentSize" content="3560">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8954281">
          <a class="link" href="attachment.cgi?id=8954281&amp;action=diff">
        <span id="att-8954281-description" itemprop="description">Part 4: Pass the triggering principal when opening an URI in non-tab browser drag and drop.</span></a>
        — <a href="attachment.cgi?id=8954281&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1435908&attachment=8954281">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-21" data-comment-id="13071765">I cannot locate the case that this becomes really a problem tho, just fixed at the same time.

If user drops item to xul:browser without tabbrowser, this code will be used
(but there seems to be no such case.  sidebar doesn't accept drop)
now it passes the triggering principal to LoadURI.


For now, that's all I've fixed.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954281&amp;action=edit"
           title="Part 4: Pass the triggering principal when opening an URI in non-tab browser drag and drop."
           class=""
        >Attachment #8954281</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="13074114" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 15:41 PST" data-time="1519774910">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="13074114">Comment on <span class=""><a href="/attachment.cgi?id=8954278" name="attach_8954278" title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.">attachment 8954278</a> <a href="/attachment.cgi?id=8954278&amp;action=edit" title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.">[details]</a> <a href="/attachment.cgi?id=8954278&amp;action=diff" title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8954278'>[review]</a>
Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.

Review of <span class=""><a href="/attachment.cgi?id=8954278" name="attach_8954278" title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.">attachment 8954278</a> <a href="/attachment.cgi?id=8954278&amp;action=edit" title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.">[details]</a> <a href="/attachment.cgi?id=8954278&amp;action=diff" title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8954278'>[review]</a>:
-----------------------------------------------------------------

Thanks, and sorry for the several rounds of review here...</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954278&amp;action=edit"
           title="Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string."
           class=""
        >Attachment #8954278</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review+</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="13074124" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 15:48 PST" data-time="1519775283">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="13074124">Comment on <span class=""><a href="/attachment.cgi?id=8954279" name="attach_8954279" title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.">attachment 8954279</a> <a href="/attachment.cgi?id=8954279&amp;action=edit" title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.">[details]</a> <a href="/attachment.cgi?id=8954279&amp;action=diff" title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8954279'>[review]</a>
Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.

Review of <span class=""><a href="/attachment.cgi?id=8954279" name="attach_8954279" title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.">attachment 8954279</a> <a href="/attachment.cgi?id=8954279&amp;action=edit" title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.">[details]</a> <a href="/attachment.cgi?id=8954279&amp;action=diff" title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1435908&amp;attachment=8954279'>[review]</a>:
-----------------------------------------------------------------

Nice. Can you file a follow-up to just get rid of openNewTab/WindowWith? They seem like useless wrappers at this point. We have too many ways of opening tabs and windows, losing these won't hurt anyone.

::: browser/base/content/utilityOverlay.js
&#64;&#64; +858,4 &#64;&#64;
<span class="quote">&gt;   * &#64;param aShiftKey
&gt;   *        True if shift key is held.  This value is used for the purpose of
&gt;   *        determining whether to open in the background.
&gt; + * &#64;param aParam</span >

Nit: match up with the actual parameter name please. :-)

&#64;&#64; +868,2 &#64;&#64;
<span class="quote">&gt;    if (document.documentElement.getAttribute(&quot;windowtype&quot;) == &quot;navigator:browser&quot;)
&gt; +    aParams.charset = gBrowser.selectedBrowser.characterSet;</span >

The test in <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/browser/base/content/test/general/browser_utilityOverlay.js#93">https://dxr.mozilla.org/mozilla-central/source/browser/base/content/test/general/browser_utilityOverlay.js#93</a> won't like this because `aParams` will be null. So maybe just set a default in the signature, ie `aParams = {}`</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954279&amp;action=edit"
           title="Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop."
           class=""
        >Attachment #8954279</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review+</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="13074125" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1294846_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1294846_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 15:48 PST" data-time="1519775301">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="13074125">(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c23">comment #23</a>)
<span class="quote">&gt; The test in
&gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/browser/base/content/test/">https://dxr.mozilla.org/mozilla-central/source/browser/base/content/test/</a>
&gt; <a href="https://github.com/general/browser_utilityOverlay.js/issues/93">general/browser_utilityOverlay.js#93</a> won't like this because `aParams` will
&gt; be null. So maybe just set a default in the signature, ie `aParams = {}`</span >

Oh, and same thing for the window case, of course.</pre></div><div class="change-set" id="a1898759_159069"><div class="change" id="aa1898759_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1898759_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1898759_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1898759_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1898759_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a1898759_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 15:50 PST" data-time="1519775446">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954280&amp;action=edit"
           title="Part 3: Pass the triggering principal when opening an URI from location bar drag and drop."
           class=""
        >Attachment #8954280</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review+</div></div></div><div class="change-set" id="a1898848_159069"><div class="change" id="aa1898848_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1898848_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1898848_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1898848_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1898848_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a1898848_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 15:52 PST" data-time="1519775535">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8954281&amp;action=edit"
           title="Part 4: Pass the triggering principal when opening an URI in non-tab browser drag and drop."
           class=""
        >Attachment #8954281</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review+</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="13074144" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1898848_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1898848_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 15:57 PST" data-time="1519775848">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="13074144">I think it's fine to deal with the download button / view and library in a follow-up bug given:
- <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c0">comment #0</a> doesn't mention them
- this is sec-low anyway
- fixing the issue in the validation (which I think should help for those consumers, too?)
- number of patches already here,
- how this relates to the openUILinkIn patches + <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Dragging multiple lines of text to the tab bar creates multiple tabs"
   href="/show_bug.cgi?id=1435910">bug 1435910</a> + <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Home button drop handler should urlSecurityCheck all the links in a pipe (|) separated set of URLs dropped on it"
   href="/show_bug.cgi?id=1319157">bug 1319157</a>

so yeah, feel free to land and deal with any remaining issues in follow-ups.</pre></div><div class="change-set" id="c26"><div class="comment" data-id="13074352" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a1898848_159069"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a1898848_159069"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-27 17:37 PST" data-time="1519781854">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="13074352"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/e15580a14db7fabbbf106b008e1055b54e020ad8">https://hg.mozilla.org/integration/mozilla-inbound/rev/e15580a14db7fabbbf106b008e1055b54e020ad8</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908">Bug 1435908</a> - Part 1: Get triggering principal before loop, and use URI fixup to create URI from given string. r=Gijs

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/c04b1745f4ae3fd4f0fcbfcf7733bb6be5f2587f">https://hg.mozilla.org/integration/mozilla-inbound/rev/c04b1745f4ae3fd4f0fcbfcf7733bb6be5f2587f</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908">Bug 1435908</a> - Part 2: Pass the triggering principal when opening an URI from new tab button and new window button drag and drop. r=Gijs

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/5c38100787fc4c3a88d89cdb247b6b9e81c9e796">https://hg.mozilla.org/integration/mozilla-inbound/rev/5c38100787fc4c3a88d89cdb247b6b9e81c9e796</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908">Bug 1435908</a> - Part 3: Pass the triggering principal when opening an URI from location bar drag and drop. r=Gijs

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/9ba48fdeecd533e32fdc8c8f65d8f3c77aaad557">https://hg.mozilla.org/integration/mozilla-inbound/rev/9ba48fdeecd533e32fdc8c8f65d8f3c77aaad557</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908">Bug 1435908</a> - Part 4: Pass the triggering principal when opening an URI in non-tab browser drag and drop. r=Gijs</pre></div><div class="change-set" id="c27"><div class="comment" data-id="13075008" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1898848_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1898848_159069"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-28 03:03 PST" data-time="1519815820">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="13075008"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/e15580a14db7">https://hg.mozilla.org/mozilla-central/rev/e15580a14db7</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/c04b1745f4ae">https://hg.mozilla.org/mozilla-central/rev/c04b1745f4ae</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/5c38100787fc">https://hg.mozilla.org/mozilla-central/rev/5c38100787fc</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/9ba48fdeecd5">https://hg.mozilla.org/mozilla-central/rev/9ba48fdeecd5</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-02-28 03:03 PST" data-time="1519815820">4 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla60</div></div></div><div class="change-set" id="a1995062_1689"><div class="change" id="aa1995062_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1995062_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1995062_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1995062_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1995062_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a1995062_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-28 18:35 PST" data-time="1519871749">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: dom-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="13099830" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1995062_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1995062_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-02 15:13 PST" data-time="1520032435">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="13099830">Letting this ride the trains since it's a sec-low.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="c29"><div class="comment" data-id="13105521" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1995062_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a1995062_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 10:12 PST" data-time="1520273579">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="13105521">Although the effects of this bug are sec-low and does not qualify for a bug bounty, it did trigger us rewriting this code to a safer model that will potentially prevent future security issues. Accordingly we are paying a small bounty as an exception.</pre><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="a2878462_356614"><div class="change" id="aa2878462_356614">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_356614" id="a2878462_356614"><img src="https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_356614" id="a2878462_356614"><a class="email " href="/user_profile?user_id=356614" > <span class="fna">Jordi Chancel</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2878462_356614"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2878462_356614">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a2878462_356614">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-10 23:59 PST" data-time="1520755149">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jordi.chancel)</span></div></div></div><div class="change-set" id="a6993427_280903"><div class="change" id="aa6993427_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a6993427_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a6993427_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6993427_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6993427_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a6993427_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-27 16:01 PDT" data-time="1524870114">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main60+]</div></div></div><div class="change-set" id="a7265384_280903"><div class="change" id="aa7265384_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a7265384_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a7265384_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7265384_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7265384_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a7265384_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-30 19:34 PDT" data-time="1525142071">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-5182</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="13259427" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588744" id="a7265384_280903"><img src="https://secure.gravatar.com/avatar/8641c9f2c9af8263df2208974cf26aab?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588744" id="a7265384_280903"><a class="email " href="/user_profile?user_id=588744" > <span class="fna">Emil Ghitta, QA [:emilghitta]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-07 05:52 PDT" data-time="1525697535">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="13259427">Hi Tooru!

It seems that I can still reproduce the issue described in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c0">comment 0</a> (while using the attachment from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c1">comment 1</a>) using Firefox 61.0a1 (BuildId:20180506220517) and Firefox 60.0 (BuildId:20180430165945) on macOS 10.12.6 and macOS 10.13.3. 

What is the expected behavior after this fix? Am I missing something?

Thanks!</pre><div class="activity"><div class="change">Flags: needinfo?(arai.unmht)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="13259843" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_310076" id="a7265384_280903"><img src="https://secure.gravatar.com/avatar/6b706eda3bfffb0365f10d465e37a53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_310076" id="a7265384_280903"><a class="email " href="/user_profile?user_id=310076" > <span class="fna">Tooru Fujisawa [:arai]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-07 09:06 PDT" data-time="1525709213">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="13259843">(In reply to Emil Ghitta, QA [:emilghitta] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c30">comment #30</a>)
<span class="quote">&gt; Hi Tooru!
&gt; 
&gt; It seems that I can still reproduce the issue described in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c0">comment 0</a> (while
&gt; using the attachment from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web content can open local files and local folders using drag &amp; drop event"
   href="/show_bug.cgi?id=1435908#c1">comment 1</a>) using Firefox 61.0a1
&gt; (BuildId:20180506220517) and Firefox 60.0 (BuildId:20180430165945) on macOS
&gt; 10.12.6 and macOS 10.13.3. </span >

I cannot reproduce.


<span class="quote">&gt; What is the expected behavior after this fix?</span >

Nothing happens.


<span class="quote">&gt; Am I missing something?</span >

any chance you've saved the attachment and opening the local file?
this issue is specific to http/https content.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(arai.unmht)</span></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="13261572" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588744" id="a7265384_280903"><img src="https://secure.gravatar.com/avatar/8641c9f2c9af8263df2208974cf26aab?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588744" id="a7265384_280903"><a class="email " href="/user_profile?user_id=588744" > <span class="fna">Emil Ghitta, QA [:emilghitta]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-08 00:00 PDT" data-time="1525762842">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="13261572">This issue is verified fixed using Firefox 61.0a1 (BuildId:20180506220517) and Firefox 60.0 (BuildId:20180430165945) on macOS 10.12.6 and Ubuntu 16.04 64bit.

Sorry Tooru for raising the &quot;alarm&quot;, my bad!</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=isnotempty">status-firefox61</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a23579975_1689"><div class="change" id="aa23579975_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a23579975_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a23579975_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a23579975_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a23579975_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1435908#a23579975_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-05 14:24 PST" data-time="1541456662">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1435908&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>