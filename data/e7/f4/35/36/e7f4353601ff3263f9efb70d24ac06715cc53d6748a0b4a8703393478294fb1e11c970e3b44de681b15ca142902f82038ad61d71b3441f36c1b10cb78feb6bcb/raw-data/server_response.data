-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Wed Jun 17 10:50:48 CDT 2009
| Updated: Mon Jun 22 16:21:35 CDT 2009
| Updated VIOS levels in advisory

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/libtt_advisory.asc
or
ftp://aix.software.ibm.com/aix/efixes/security/libtt_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX libtt.a rpc.ttdbserver remote buffer overflow
                 vulnerability

PLATFORMS:       AIX 5.2, 5.3, 6.1
                 VIOS 1.3, 1.4, 1.5, 2.1

SOLUTION:        Apply the fix or workaround as described below.

THREAT:          A remote attacker may execute arbitrary code as root.

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   NO
Protected by SED?   NO

                           DETAILED INFORMATION

I. DESCRIPTION

    There is a buffer overflow vulnerability in the ToolTalk library
    libtt.a.  A remote attacker can exploit this vulnerability when
    the rpc.ttdbserver is enabled in /etc/inetd.conf. 

    The successful exploitation of this vulnerability allows a remote
    attacker to execute arbitrary code as the root user.

    The following libraries and executables are vulnerable:

        /usr/dt/lib/libtt.a
        /usr/dt/bin/rpc.ttdbserver

II. PLATFORM VULNERABILITY ASSESSMENT

    Note: To use the following commands on VIOS you must first
    execute:

    oem_setup_env

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L X11.Dt.ToolTalk

    The following fileset levels are vulnerable:

    AIX Fileset        Lower Level       Upper Level
    ------------------------------------------------
    X11.Dt.ToolTalk    5.2.0.105         5.2.0.105
    X11.Dt.ToolTalk    5.3.0.0           5.3.0.0
    X11.Dt.ToolTalk    5.3.0.60          5.3.0.61
    X11.Dt.ToolTalk    5.3.7.0           5.3.7.0
    X11.Dt.ToolTalk    5.3.8.0           5.3.8.0
    X11.Dt.ToolTalk    5.3.9.0           5.3.9.0
    X11.Dt.ToolTalk    5.3.9.0           5.3.9.0
    X11.Dt.ToolTalk    6.1.0.0           6.1.0.0
    X11.Dt.ToolTalk    6.1.1.0           6.1.1.0
    X11.Dt.ToolTalk    6.1.2.0           6.1.2.0
    X11.Dt.ToolTalk    6.1.3.0           6.1.3.0

III. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Availability
        ---------------------------------------------------
        5.2.0               IZ52842            07/22/09
        5.3.0               IZ52843            interm fix only
        5.3.7               IZ52844            11/11/09
        5.3.8               IZ52845            11/11/09
        5.3.9               IZ52846            11/11/09
        5.3.10              IZ52847            11/11/09
        6.1.0               IZ52848            09/23/09
        6.1.1               IZ52849            09/23/09
        6.1.2               IZ52850            09/23/09
        6.1.3               IZ52851            09/23/09

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ52842
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52843
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52844
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52845
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52846
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52847
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52848
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52849
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52850
        http://www.ibm.com/support/docview.wss?uid=isg1IZ52851

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        ftp://aix.software.ibm.com/aix/efixes/security/libtt_fix.tar
        http://aix.software.ibm.com/aix/efixes/security/libtt_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

        AIX Level    VIOS Level      Interim Fix (*.Z)
        -------------------------------------------------------------------
        5.2.0                        IZ52842_10.090617.epkg.Z
        5.3.0 TL5    1.3             IZ52843_05.090617.epkg.Z
        5.3.0 TL6    1.4             IZ52843_06.090617.epkg.Z
        5.3.7        1.5.0, 1.5.1    IZ52844_07.090617.epkg.Z
        5.3.8        1.5.2           IZ52845_08.090617.epkg.Z
        5.3.9                        IZ52846_09.090617.epkg.Z
        5.3.10                       IZ52847_10.090617.epkg.Z
        6.1.0                        IZ52848_00.090617.epkg.Z
        6.1.1                        IZ52849_01.090617.epkg.Z
        6.1.2        2.1.0           IZ52850_02.090617.epkg.Z
        6.1.3        2.1.1           IZ52851_03.090617.epkg.Z

        To extract the fixes from the tar file:

        tar xvf libtt_fix.tar
        cd libtt_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
        32761971bcdd9e69b2bf6b2010d074037b437010  IZ52842_10.090617.epkg.Z
        5008216f62634db3c009516fa68f9ed1753748fb  IZ52843_05.090617.epkg.Z
        45c9a42779a2179da13d34d13891290e1935d434  IZ52843_06.090617.epkg.Z
        e2fa06c867d592a9b0405fd32285abd899fb996d  IZ52844_07.090617.epkg.Z
        74290e4fd31c4e934d27bcf369022b951ae8439d  IZ52845_08.090617.epkg.Z
        8b2daa71185e32491421b305772602de51e6d951  IZ52846_09.090617.epkg.Z
        eae9a835feba6c54c22d33e580fd4b31561758f9  IZ52847_10.090617.epkg.Z
        2325c1095ac18e0dcd233c4cd0cec16b11f38ff2  IZ52848_00.090617.epkg.Z
        d0809e09e92b7cfe49938c8ce22ba71876147b26  IZ52849_01.090617.epkg.Z
        40bd242b97fab9c9d9b54eead089c284849aecdb  IZ52850_02.090617.epkg.Z
        2c041318ba437138d9011b35f38a2605c2a56bf9  IZ52851_03.090617.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following address:

            security-alert@austin.ibm.com

     C. INTERIM FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        Interim fixes have had limited functional and regression
        testing but not the full regression testing that takes place
        for Service Packs; thus, IBM does not warrant the fully
        correct functionality of an interim fix.

        Interim fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview an interim fix installation:

        emgr -e ipkg_name -p         # where ipkg_name is the name of the  
                                     # interim fix package being previewed.

        To install an interim fix package:

        emgr -e ipkg_name -X         # where ipkg_name is the name of the  
                                     # interim fix package being installed.

IV. WORKAROUND

    Remove the entry for rpc.ttdbserver from /etc/inetd.conf and
    refresh inetd so that inetd will no longer run the program.  This
    can be done by running the following command:

    chsubserver -r inetd -C /etc/inetd.conf -d -v 'ttdbserver' -p 'tcp'

    Any remaining instances of rpc.ttdbserver should be killed with
    the following command:

    ps -efl|grep [r]pc.ttdbserver|awk '{x = "kill " $4}{system(x)}'

    NOTE: Removing rpc.ttdbserver from /etc/inetd.conf will disable
    some functionality for all users.

V. OBTAINING FIXES

    AIX security fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security
        or
        ftp://aix.software.ibm.com/aix/efixes/security

    AIX fixes can be downloaded from:

        http://www.ibm.com/eserver/support/fixes/fixcentral/main/pseries/aix

    NOTE: Affected customers are urged to upgrade to the latest
    applicable Technology Level and Service Pack.

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:
 
        A. Download the key from our web page:
 
  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt
 
        B. Download the key from a PGP Public Key Server. The key ID is:
 
            0xADA6EB4D
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    This vulnerability was reported by Adriano Lima
    adriano@risescurity.org and Ramon de Carvalho Valle
    ramon@risesecurity.org.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFKP/ZUP9Qud62m600RArfcAKCyFDYAWY0q0EoxSTZGDucvQHFcsQCfZsD3
v9xFGHfDw0zbjBJmP9C2bJk=
=oxy7
-----END PGP SIGNATURE-----
