<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - TLS session resumption client cert bypass (again) - CVE-2017-7468</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="STYLESHEET" type="text/css" href="https://curl.se/manpage.css">
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">Web Site Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/hsts.html">HSTS</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http2.html">HTTP/2</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/changes.html">Changelog</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/security.html">Security Problems</a>
    <a href="/docs/versions.html">Version Nums</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/manual.html">Tutorial</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">Security Problems</a> / <b>TLS session resumption client cert bypass (again)</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/changes.html">Changelog</a>
<br><a href="/donation.html">Donate</a>
<br><a href="faq.html">FAQ</a>
<br><a href="security.html">Security Problems</a>
<br><a href="/dev/secprocess.html">Security Process</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<h1 id="tls-session-resumption-client-cert-bypass-again">TLS session resumption client cert bypass (again)</h1>
<p>Project curl Security Advisory, April 19th 2017 - <a href="https://curl.se/docs/CVE-2017-7468.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>libcurl would attempt to resume a TLS session even if the client certificate had changed. That is unacceptable since a server by specification is allowed to skip the client certificate check on resume, and may instead use the old identity which was established by the previous certificate (or no certificate).</p>
<p>libcurl supports by default the use of TLS session id/ticket to resume previous TLS sessions to speed up subsequent TLS handshakes. They are used when for any reason an existing TLS connection couldn't be kept alive to make the next handshake faster.</p>
<p>This flaw is a regression and identical to <a href="https://curl.se/docs/CVE-2016-5419.html">CVE-2016-5419</a> reported on August 3rd 2016, but affecting a different version range.</p>
<p>We are not aware of any exploit of this flaw.</p>
<h2 id="info">INFO</h2>
<p>This flaw also affects the curl command line tool.</p>
<p>For version <a href="vuln-7.52.0.html">7.52.0</a>, we rearranged a lot of TLS code to bring support for HTTPS proxies, which unfortunately made us accidentally bring this old flaw back!</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2017-7468 to this issue.</p>
<p>CWE-305: Authentication Bypass by Primary Weakness</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<p>This flaw is relevant for all versions of curl and libcurl that support TLS and client certificates.</p>
<ul>
<li>Affected versions: curl <a href="vuln-7.52.0.html">7.52.0</a> to and including <a href="vuln-7.53.1.html">7.53.1</a></li>
<li>Not affected versions: curl &lt; <a href="vuln-7.52.0.html">7.52.0</a> and &gt;= <a href="vuln-7.54.0.html">7.54.0</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as such!</p>
<h2 id="the-solution">THE SOLUTION</h2>
<p>TLS session resumption is disabled when a client certificate is used so that a subsequent connection attempt to the same server cannot risk getting a previously authenticated session resumed.</p>
<p>A <a href="https://curl.se/CVE-2017-7468.patch">patch for CVE-2017-7468</a> is available.</p>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in order of preference:</p>
<p>A - Upgrade curl and libcurl to version <a href="vuln-7.54.0.html">7.54.0</a></p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Set <code><a href="https://curl.se/libcurl/c/CURLOPT_SSL_SESSIONID_CACHE.html">CURLOPT_SSL_SESSIONID_CACHE</a></code> to 0L when using client certificates</p>
<h2 id="time-line">TIME LINE</h2>
<p>It was <a href="https://github.com/curl/curl/issues/1341">first reported to the curl project</a> on March 21, 2017. We contacted distros@openwall on April 10.</p>
<p>libcurl <a href="vuln-7.54.0.html">7.54.0</a> was released on April 19 2017, coordinated with the publication of this advisory.</p>
<h2 id="credits">CREDITS</h2>
<p>Reported by <a href="mailto:lijian996@users.noreply.github.com">lijian996@users.noreply.github.com</a>. Patch by Ray Satiro.</p>
<p>Thanks a lot!</p>
</div>
</div>
<script defer src="https://www.fastly-insights.com/insights.js?k=8cb1247c-87c2-4af9-9229-768b1990f90b" type="text/javascript"></script>
</body> </html>
