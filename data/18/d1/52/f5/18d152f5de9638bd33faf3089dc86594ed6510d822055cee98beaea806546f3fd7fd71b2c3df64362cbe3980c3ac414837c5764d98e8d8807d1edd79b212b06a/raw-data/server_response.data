<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>ReDoS vulnerability in websocket-extensions &#8211; The If Works</title>

    <link rel="stylesheet" type="text/css" media="all" href="/assets/css/publish.css">
    <link rel="stylesheet" type="text/css" media="all" href="/assets/css/pygments.css">
    <link rel="stylesheet" type="text/css" media="all" href="/assets/css/overrides.css">
    <link rel="alternate" type="application/rss+xml" title="The If Works &raquo; Feed" href="http://feeds.feedburner.com/theifworks">
    
      <link rel="prev" title="Controlling mutation with types" href="/2020/05/12/controlling-mutation-with-types/">
    
    
      <link rel="next" title="Missing TLS certificate verification in Faye" href="/2020/07/31/missing-tls-verification-in-faye/">
    
    <link rel="canonical" href="/2020/06/02/redos-vulnerability-in-websocket-extensions/">
  </head>

  <body class="single single-post single-format-standard">
    <div id="page" class="hfeed site">

      <header id="masthead" class="site-header" role="banner">
        <a class="site-logo" href="https://blog.jcoglan.com/" title="The If Works" rel="home">
          <img src="/assets/images/drawing.jpg" height="100" width="100" alt="The If Works">
        </a>

        <hgroup>
          <h1 class="site-title"><a href="https://blog.jcoglan.com/" title="The If Works" rel="home">The If Works</a></h1>
          <h2 class="site-description">by James Coglan</h2>
        </hgroup>

        <nav role="navigation" class="site-navigation main-navigation">
          <h1 class="assistive-text">Menu</h1>
          <div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
          <div class="menu">
            <ul>
              <li class="page_item"><a href="/software">Open source</a></li>
              <li class="page_item"><a href="/books">Books</a></li>
              <li class="page_item"><a href="/talks">Conference talks</a></li>
              <li class="page_item"><a href="/podcasts">Podcast interviews</a></li>
            </ul>
          </div>
        </nav>
      </header>

      <div id="main" class="site-main">
        <div id="primary" class="content-area">
          <div id="content" class="site-content" role="main">

            <article class="post type-post status-publish format-standard hentry">
  <header class="entry-header">
    <h1 class="entry-title"><p>ReDoS vulnerability in websocket-extensions</p>
</h1>
  </header>

  <div class="entry-content">
    <p>On 1 June 2020 it was reported to me that a regular expression denial of service
(ReDoS) vulnerability exists in the <a href="https://www.npmjs.com/package/websocket-extensions"><code class="language-plaintext highlighter-rouge">websocket-extensions</code> npm package</a>.
This vulnerability was discovered by Robert McLaughlin and has been assigned the
identifier CVE-2020-7662.</p>

<p>In the course of investigating this issue I discovered that the <a href="https://rubygems.org/gems/websocket-extensions">Ruby version of
<code class="language-plaintext highlighter-rouge">websocket-extensions</code></a> contains the same flaw. The vulnerability in this
version has been assigned the identifier CVE-2020-7663.</p>

<p>To mitigate this issue, you should install one of these packages as appropriate
for your system:</p>

<ul>
  <li>version 0.1.4 of the npm package</li>
  <li>version 0.1.5 of the rubygems package</li>
</ul>

<p>All previous versions of these packages are vulnerable.</p>

<p>The ReDoS flaw allows an attacker to exhaust the serverâ€™s capacity to process
incoming requests by sending a WebSocket handshake request containing a header
of the following form:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sec-WebSocket-Extensions: a; b="\c\c\c\c\c\c\c\c\c\c ...
</code></pre></div></div>

<p>That is, a header containing an unclosed string parameter value whose content is
a repeating two-byte sequence of a backslash and some other character. The
parser takes exponential time to reject this header as invalid, and this will
block the processing of any other work on the same thread. Thus if you are
running a single-threaded server, such a request can render your service
completely unavailable.</p>

<p>I would like to thank <a href="https://snyk.io/">Snyk</a> for reporting this issue to me, and my employer
<a href="https://www.dxw.com/">dxw</a> for giving me time to fix it.</p>


  </div>

  <footer class="entry-meta">
    
      Posted on
      <a href="/2020/06/02/redos-vulnerability-in-websocket-extensions/" title="12:00 AM" rel="bookmark"><time class="entry-date" datetime="2020-06-02T00:00:00+00:00" pubdate>June  2, 2020</time></a>.
    
    This entry was posted in
    
      <a href="/category/Faye/" title="View all posts in Faye" rel="category tag">Faye</a>,
    
      <a href="/category/JavaScript/" title="View all posts in JavaScript" rel="category tag">JavaScript</a>,
    
      <a href="/category/Ruby/" title="View all posts in Ruby" rel="category tag">Ruby</a>.
    
    Bookmark the <a href="/2020/06/02/redos-vulnerability-in-websocket-extensions/" title="Permalink to ReDoS vulnerability in websocket-extensions" rel="bookmark">permalink</a>.
  </footer>
</article>

<nav role="navigation" id="nav-below" class="site-navigation post-navigation">
  <h1 class="assistive-text">Post navigation</h1>
  
    <div class="nav-previous"><a href="/2020/05/12/controlling-mutation-with-types/" rel="prev"><span class="meta-nav">&larr;</span> Controlling mutation with types</a></div>
  
  
    <div class="nav-next"><a href="/2020/07/31/missing-tls-verification-in-faye/" rel="next"><span class="meta-nav">&rarr;</span> Missing TLS certificate verification in Faye</a></div>
  
</nav>


          </div>
        </div>

        <div id="secondary" class="widget-area" role="complementary">
  <a href="https://shop.jcoglan.com/building-git/">
    <img style="margin-top: 2em; width: 60%" src="/assets/images/bg.png"><br>
    Buy my book, <i>Building Git</i>
  </a>
</div>

      </div>

      <footer id="colophon" class="site-footer" role="contentinfo">
        <div class="site-info">
          Theme: Publish by <a href="http://kovshenin.com/" rel="designer">Konstantin Kovshenin</a>.
        </div>
      </footer>

    </div>

  </body>
</html>
