<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1493303 “[OSSA 2016-004] Swift proxy memory leak on unfinis...” : Bugs : Ubuntu Cloud Archive</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1493303" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1493303/bug.atom" title="Bug 1493303 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="It looks like the Swift proxy will leak memory if the connection is closed and the full response is not read. This opens for a potential DoS attacks.

Reproduce:

$ swift -A http://localhost:8888/auth/v1.0 -U .. -K .. upload --use-slo --segment-size 1048576 &lt;container&gt; &lt;big-file&gt;
$ curl -H'X-Auth-Token: AUTH_...' &quot;http://localhost:8888/v1/AUTH_../&lt;container&gt;/&lt;big-file&gt;&quot; -m 0.001 &gt; /dev/null

Repeat the curl command a couple of times and you will have more information in netstat and sockstat. ..." />
      <meta property="og:description" content="It looks like the Swift proxy will leak memory if the connection is closed and the full response is not read. This opens for a potential DoS attacks.

Reproduce:

$ swift -A http://localhost:8888/auth/v1.0 -U .. -K .. upload --use-slo --segment-size 1048576 &lt;container&gt; &lt;big-file&gt;
$ curl -H'X-Auth-Token: AUTH_...' &quot;http://localhost:8888/v1/AUTH_../&lt;container&gt;/&lt;big-file&gt;&quot; -m 0.001 &gt; /dev/null

Repeat the curl command a couple of times and you will have more information in netstat and sockstat. ..." />
    

    
    
      <meta property="og:title" content="Bug #1493303 “[OSSA 2016-004] Swift proxy memory leak on unfinis...” : Bugs : Ubuntu Cloud Archive" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1493303" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["a11y", "account-server", "appstream", "bionic", "bisect-done", "bitesize", "cherry-pick", "community-security", "consistency-engine", "container-server", "desktop-file", "disco", "dist-upgrade", "documentation", "ec-erasure-coding", "flakey-test", "focal", "ftbfs", "groovy", "hirsute", "hw-specific", "i18n", "impish", "jammy", "kernel-bug", "low-hanging-fruit", "manpage", "metabug", "middleware", "multiarch", "needs-bisect", "needs-design", "needs-packaging", "needs-reassignment", "object-server", "ops", "package-conflict", "packaging", "patch", "patch-accepted-debian", "patch-accepted-upstream", "patch-forwarded-debian", "patch-forwarded-upstream", "patch-needswork", "patch-rejected", "patch-rejected-debian", "patch-rejected-upstream", "performing-bisect", "proxy-server", "py2-removal", "python3", "qt4-removal", "regression-proposed", "regression-release", "regression-update", "security", "string-fix", "suspend-resume", "systemd-boot", "test", "testcase", "touch", "unmetdeps", "upgrade-software-version", "verification-done-bionic", "verification-done-focal", "verification-done-groovy", "verification-done-hirsute", "verification-done-impish", "verification-done-xenial", "verification-failed-bionic", "verification-failed-groovy", "verification-failed-impish", "verification-failed-xenial", "verification-needed-bionic", "verification-needed-focal", "verification-needed-groovy", "verification-needed-hirsute", "verification-needed-impish", "verification-needed-trusty", "verification-needed-xenial", "wayland", "xenial"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/cloud-archive"><img alt="" width="64" height="64" src="/@@/product-logo" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/cloud-archive">Ubuntu Cloud Archive</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/cloud-archive">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/cloud-archive">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/cloud-archive">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/cloud-archive">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/cloud-archive">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/cloud-archive">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2016-004] Swift proxy memory leak on unfinished read (CVE-2016-0738)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1493303 reported by
      <a href="https://launchpad.net/~o-42mm" class="sprite person">Örjan Persson</a>
      <time title="2015-09-08 10:12:20 UTC" datetime="2015-09-08T10:12:20.569212+00:00">on 2015-09-08</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">288</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 4 people</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr id="tasksummary1907724">
    <td>
      
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1907724">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/swift">OpenStack Object Storage (swift)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/swift/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/swift/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1907724">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary1907855">
    <td>
      
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1907855">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1907855">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr class="highlight" id="tasksummary1902238">
    <td>
      
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1902238">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/cloud-archive">Ubuntu Cloud Archive</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+editstatus" style="float: left" class="value statusINVALID">Invalid</a>
          <a href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1902238">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088091">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/cloud-archive/icehouse">Icehouse</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/cloud-archive/icehouse/+bug/1493303/+editstatus" style="float: left" class="value statusWONTFIX">Won't Fix</a>
          <a href="https://bugs.launchpad.net/cloud-archive/icehouse/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088091">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088089">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/cloud-archive/kilo">Kilo</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/cloud-archive/kilo/+bug/1493303/+editstatus" style="float: left" class="value statusWONTFIX">Won't Fix</a>
          <a href="https://bugs.launchpad.net/cloud-archive/kilo/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088089">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088092">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/cloud-archive/liberty">Liberty</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/cloud-archive/liberty/+bug/1493303/+editstatus" style="float: left" class="value statusWONTFIX">Won't Fix</a>
          <a href="https://bugs.launchpad.net/cloud-archive/liberty/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088092">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088090">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/cloud-archive/mitaka">Mitaka</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/cloud-archive/mitaka/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/cloud-archive/mitaka/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088090">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary1907725">
    <td>
      
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1907725">
        <span class="yui3-activator-data-box">
            <a class="sprite package-source" href="https://bugs.launchpad.net/ubuntu/+source/swift" title="Latest release: 2.25.2-0ubuntu1, uploaded to main on 2021-09-17 11:44:17.970766+00:00 by Chris MacNaughton (chris.macnaughton), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)">swift (Ubuntu)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/+source/swift/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/+source/swift/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1907725">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088087">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/ubuntu/trusty/+source/swift">Trusty</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/trusty/+source/swift/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/trusty/+source/swift/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088087">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088084">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/ubuntu/wily/+source/swift">Wily</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/wily/+source/swift/+bug/1493303/+editstatus" style="float: left" class="value statusWONTFIX">Won't Fix</a>
          <a href="https://bugs.launchpad.net/ubuntu/wily/+source/swift/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088084">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088088">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/ubuntu/xenial/+source/swift">Xenial</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/xenial/+source/swift/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/xenial/+source/swift/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088088">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    
  


        
        
          
  <tr id="tasksummary2088086">
    <td>
      
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/ubuntu/yakkety/+source/swift">Yakkety</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/yakkety/+source/swift/+bug/1493303/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/yakkety/+source/swift/+bug/1493303/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2088086">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>It looks like the Swift proxy will leak memory if the connection is closed and the full response is not read. This opens for a potential DoS attacks.</p>
<p>Reproduce:</p>
<p>$ swift -A <a rel="nofollow" href="http://localhost:8888/auth/v1.0">http://<wbr />localhost:<wbr />8888/auth/<wbr />v1.0</a> -U .. -K .. upload --use-slo --segment-size 1048576 &lt;container&gt; &lt;big-file&gt;<br />
$ curl -H&#x27;X-Auth-Token: AUTH_...&#x27; &quot;<a rel="nofollow" href="http://localhost:8888/v1/AUTH_../">http://<wbr />localhost:<wbr />8888/v1/<wbr />AUTH_..<wbr />/</a>&lt;container&gt;<wbr />/&lt;big-file&gt;<wbr />&quot; -m 0.001 &gt; /dev/null</p>
<p>Repeat the curl command a couple of times and you will have more information in netstat and sockstat. The important part is the -m which sets the max time curl spends at downloading. After that point, it&#x27;ll close the connection.</p>
<p>$ sudo netstat -ant -p | grep :6000<br />
$ cat /proc/net/sockstat</p>
<p>tcp        0      0 127.0.0.1:6000          0.0.0.0:*               LISTEN      1358/python<br />
tcp        0  43221 127.0.0.1:6000          127.0.0.1:48350         FIN_WAIT1   -<br />
tcp        0  43221 127.0.0.1:6000          127.0.0.1:48882         FIN_WAIT1   -<br />
tcp   939820      0 127.0.0.1:48350         127.0.0.1:6000          ESTABLISHED 17897/python<br />
tcp   939820      0 127.0.0.1:48882         127.0.0.1:6000          ESTABLISHED 17890/python<br />
tcp   983041      0 127.0.0.1:48191         127.0.0.1:6000          CLOSE_WAIT  17897/python<br />
tcp   983041      0 127.0.0.1:48948         127.0.0.1:6000          CLOSE_WAIT  17892/python</p>
<p>Restarting the proxy frees up the lingering memory.</p>
<p>This problem did not exist in 2.2.0.</p>
<p>ProblemType: Bug<br />
DistroRelease: Ubuntu 14.04<br />
Package: swift 2.2.2-0ubuntu1~<wbr />cloud0 [origin: Canonical]<br />
ProcVersionSign<wbr />ature: Ubuntu 3.16.0-<wbr />48.64~14.<wbr />04.1-generic 3.16.7-ckt15<br />
Uname: Linux 3.16.0-48-generic x86_64<br />
ApportVersion: 2.14.1-0ubuntu3.12<br />
Architecture: amd64<br />
CrashDB:<br />
&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&quot;impl&quot;<wbr />: &quot;launchpad&quot;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&quot;project&quot;<wbr />: &quot;cloud-archive&quot;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&quot;bug_<wbr />pattern_<wbr />url&quot;: &quot;<a rel="nofollow" href="http://people.canonical.com/~ubuntu-archive/bugpatterns/bugpatterns.xml">http://<wbr />people.<wbr />canonical.<wbr />com/~ubuntu-<wbr />archive/<wbr />bugpatterns/<wbr />bugpatterns.<wbr />xml</a>&quot;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
Date: Tue Sep  8 09:55:05 2015<br />
InstallationDate: Installed on 2015-06-22 (77 days ago)<br />
InstallationMedia: Ubuntu-Server 14.04.2 LTS &quot;Trusty Tahr&quot; - Release amd64 (20150218.1)<br />
PackageArchitec<wbr />ture: all<br />
SourcePackage: swift<br />
UpgradeStatus: No upgrade log present (probably fresh install)</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          <span>See <a href="comments/0">original description</a></span>
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            Tags:
          </span>
          <span id="tag-list">
            <a class="official-tag" href="/cloud-archive/+bugs?field.tag=patch">patch</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=amd64">amd64</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=apport-bug">apport-bug</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=in-feature-crypto">in-feature-crypto</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=in-feature-hummingbird">in-feature-hummingbird</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=in-stable-kilo">in-stable-kilo</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=in-stable-liberty">in-stable-liberty</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=third-party-packages">third-party-packages</a>
            <a class="unofficial-tag" href="/cloud-archive/+bugs?field.tag=trusty">trusty</a>
          </span>
          
          <a href="+edit" title="Edit tags" id="tags-trigger" class="sprite edit action-icon">Edit</a>
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2015-5223" title="OpenStack Object Storage (Swift) befo...">2015-5223</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-0737" title="OpenStack Object Storage (Swift) befo...">2016-0737</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2016-0738" title="OpenStack Object Storage (Swift) befo...">2016-0738</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~o-42mm" class="sprite person">Örjan Persson (o-42mm)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-09-08T10:12:20.569212+00:00" title="2015-09-08 10:12:20 UTC">on 2015-09-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4459119/+files/Dependencies.txt">Dependencies.txt</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4459119">Edit</a>
        (2.3 KiB,
        text/plain; charset="utf-8")
      </li>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4459120/+files/ProcEnviron.txt">ProcEnviron.txt</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4459120">Edit</a>
        (124 bytes,
        text/plain; charset="utf-8")
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~james-page" class="sprite person">James Page (james-page)</a>
    
    <time title="2015-09-17 08:53:46 UTC" datetime="2015-09-17T08:53:46.582396+00:00">on 2015-09-17</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in cloud-archive: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Critical
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Critical &#8594; High
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-09-17T13:02:10.932651+00:00" title="2015-09-17 13:02:10 UTC">on 2015-09-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-09-17T13:04:44.861447+00:00" title="2015-09-17 13:04:44 UTC">on 2015-09-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>From the description it sounds like this bug impacts the stable/kilo and master (liberty) branches, but not the stable/juno branch.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">From the description it sounds like this bug impacts the stable/kilo and master (liberty) branches, but not the stable/juno branch.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-09-25T15:57:30.845676+00:00" title="2015-09-25 15:57:30 UTC">on 2015-09-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@swift-coresec, is this a duplicate of <a href="/bugs/1466549" class="bug-link">bug 1466549</a> ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@swift-coresec, is this a duplicate of bug 1466549 ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-10-13T14:36:28.348397+00:00" title="2015-10-13 14:36:28 UTC">on 2015-10-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@swift-coresec, can you triage this bug report please ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@swift-coresec, can you triage this bug report please ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-10-14T00:16:59.849242+00:00" title="2015-10-14 00:16:59 UTC">on 2015-10-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>On commit fdc8828e8527b6f<wbr />a4997072fb4795e<wbr />4060c68cc0 (tip of master as of the time of this comment), I am unable to reproduce the behavior.  I experimented with a variety of curl timeouts (the -m argument), including the proposed 0.001, but still could not reproduce this.</p>
<p>On a freshly-restarted VM, I did see a small jump in the number of non-TIME_WAIT connections after the first request, but that jump did not occur on the second and subsequent requests, so it appears to be something warming up.</p>
<p>I also checked stable/liberty (47eb6a37) and was unable to reproduce the behavior there either.</p>
<p>I *can* reproduce this on stable/kilo (da428c4f).</p>
<p>I suspect that commit 12d8a53 fixed this, though I have no proof of that.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">On commit fdc8828e8527b6fa4997072fb4795e4060c68cc0 (tip of master as of the time of this comment), I am unable to reproduce the behavior.  I experimented with a variety of curl timeouts (the -m argument), including the proposed 0.001, but still could not reproduce this.

On a freshly-restarted VM, I did see a small jump in the number of non-TIME_WAIT connections after the first request, but that jump did not occur on the second and subsequent requests, so it appears to be something warming up.

I also checked stable/liberty (47eb6a37) and was unable to reproduce the behavior there either.

I *can* reproduce this on stable/kilo (da428c4f).

I suspect that commit 12d8a53 fixed this, though I have no proof of that.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~cschwede" class="sprite person">Christian Schwede (cschwede)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-10-14T08:05:24.835741+00:00" title="2015-10-14 08:05:24 UTC">on 2015-10-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I couldn&#x27;t reproduce this on/after commit 12d8a53, but I could reproduce it on the commits before that.</p>
<p>I had to use a larger timeout to reproduce this (0.01 seconds). I used the following command:</p>
<p>&nbsp;for i in `seq 1 1000`; do curl -H &#x27;X-Auth-Token: AUTH_...&#x27; <a rel="nofollow" href="http://127.0.0.1:8080/v1/AUTH_test/big/bigfile">http://<wbr />127.0.0.<wbr />1:8080/<wbr />v1/AUTH_<wbr />test/big/<wbr />bigfile</a> -m 0.01 &gt; /dev/null ; done</p>
<p>From my point of view this affects all releases before commit 12d8a53, and I would propose to backport 12d8a53 to stable/juno and stable/kilo.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I couldn't reproduce this on/after commit 12d8a53, but I could reproduce it on the commits before that.

I had to use a larger timeout to reproduce this (0.01 seconds). I used the following command:

 for i in `seq 1 1000`; do curl -H 'X-Auth-Token: AUTH_...' http://127.0.0.1:8080/v1/AUTH_test/big/bigfile -m 0.01 &gt; /dev/null ; done

From my point of view this affects all releases before commit 12d8a53, and I would propose to backport 12d8a53 to stable/juno and stable/kilo.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~cschwede" class="sprite person">Christian Schwede (cschwede)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-10-14T08:59:53.739550+00:00" title="2015-10-14 08:59:53 UTC">on 2015-10-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Just to add more light on this: most of the connections on pre-12d8a53 are still not closed after 50 minutes. That definetely does not happen on a branch on or after commit 12d8a53.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Just to add more light on this: most of the connections on pre-12d8a53 are still not closed after 50 minutes. That definetely does not happen on a branch on or after commit 12d8a53.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~matt-0" class="sprite person">Matthew Oliver (matt-0)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-10-14T10:36:31+00:00" title="2015-10-14 10:36:31 UTC">on 2015-10-14</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/9">
                <strong>Re: [Bug 1493303] Re: Swift proxy memory leak on unfinished read</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  <a href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/comments/9/+download">Download full text</a> (6.2 KiB)
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sam and Romain was the author of patch 12d8a53, the patch makes sure<br />
connections are closed. Here is the commit message of the patch:</p>
<p>commit 12d8a53fffea6e4<wbr />bed8ba3d502ce62<wbr />5f5c6710b9<br />
Author: Samuel Merritt &lt;email address hidden&gt;<br />
Date:   Thu Jun 18 12:58:03 2015 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Get better at closing WSGI iterables.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;PEP 333 (WSGI) says: &quot;If the iterable returned by the application has<br />
&nbsp;&nbsp;&nbsp;&nbsp;a close() method, the server or gateway must call that method upon<br />
&nbsp;&nbsp;&nbsp;&nbsp;completion of the current request[.]&quot;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;There&#x27;s a bunch of places where we weren&#x27;t doing that; some of them<br />
&nbsp;&nbsp;&nbsp;&nbsp;matter more than others. Calling .close() can prevent a connection<br />
&nbsp;&nbsp;&nbsp;&nbsp;leak in some cases. In others, it just provides a certain pedantic<br />
&nbsp;&nbsp;&nbsp;&nbsp;smugness. Either way, we should do what WSGI requires.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Noteworthy goofs include:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* If a client is downloading a large object and disconnects halfway<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;through, a proxy -&gt; obj connection may be leaked. In this case,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the WSGI iterable is a SegmentedIterable, which lacked a close()<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method. Thus, when the WSGI server noticed the client disconnect,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it had no way of telling the SegmentedIterable about it, and so<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the underlying iterable for the segment&#x27;s data didn&#x27;t get<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closed.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here, it seems likely (though unproven) that the object server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;would time out and kill the connection, or that a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;ChunkWriteTime<wbr />out would fire down in the proxy server, so the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leaked connection would eventually go away. However, a flurry of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client disconnects could leave a big pile of useless connections.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* If a conditional request receives a 304 or 412, the underlying<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app_iter is not closed. This mostly affects conditional requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for large objects.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The leaked connections were noticed by this patch&#x27;s co-author, who<br />
&nbsp;&nbsp;&nbsp;&nbsp;made the changes to SegmentedIterable. Those changes helped, but did<br />
&nbsp;&nbsp;&nbsp;&nbsp;not completely fix, the issue. The rest of the patch is an attempt to<br />
&nbsp;&nbsp;&nbsp;&nbsp;plug the rest of the holes.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Co-Authored-By: Romain LE DISEZ &lt;email address hidden&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I168e147aae7c17<wbr />28e7e3fdabb7fba<wbr />6f2d747d937<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: #1466549</p>
<p>The first noteworthy goof looks like what we&#x27;re seeing in this bug. This<br />
patch is already in Liberty, but it was applied well after 2.2.0 (Juno) and<br />
Kilo. So it only needs to be backported.</p>
<p>My 2 cents,<br />
Matt</p>
<p>On Wed, Oct 14, 2015 at 7:59 PM, Christian Schwede &lt;<br />
&lt;email address hidden&gt;&gt; wrote:</p>
<p><span class="foldable-quoted">&gt; Just to add more light on this: most of the connections on pre-12d8a53<br />
&gt; are still not closed after 50 minutes. That definetely does not happen<br />
&gt; on a branch on or after commit 12d8a53.<br />
&gt;<br />
&gt; --<br />
&gt; You received this bug notification because you are a member of Swift<br />
&gt; Core security contacts, which is subscribed to the bug report.<br />
&gt; <a rel="nofollow" href="https://bugs.launchpad.net/bugs/1493303">https:/<wbr />/bugs.launchpad<wbr />.net/bugs/<wbr />1493303</a><br />
&gt;<br />
&gt; Title:<br />
&gt;   Swift proxy memory leak on unfinished read<br />
&gt;<br />
&gt; Status in ubuntu-<wbr />cloud-archive:<br />
&gt;   New<br />
&gt; Status in OpenStack Security Advisory:<br />
&gt;   Incomplete<br />
&gt; Status in OpenStack Object Storage (swift):<br />
&gt;   New<br />
&gt; Status in swift package in Ubuntu:<br />
&gt;   New<br />
&gt;<br />
&gt; Bug description:<br />
&gt;   This issue is being treated as a potential security risk under<br />
&gt;   embargo. Pleas...
</span></p></div>
    
    <p>
      <a href="/cloud-archive/+bug/1493303/comments/9">Read more...</a>
    </p>
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sam and Romain was the author of patch 12d8a53, the patch makes sure
connections are closed. Here is the commit message of the patch:

commit 12d8a53fffea6e4bed8ba3d502ce625f5c6710b9
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Thu Jun 18 12:58:03 2015 -0700

    Get better at closing WSGI iterables.

    PEP 333 (WSGI) says: "If the iterable returned by the application has
    a close() method, the server or gateway must call that method upon
    completion of the current request[.]"

    There's a bunch of places where we weren't doing that; some of them
    matter more than others. Calling .close() can prevent a connection
    leak in some cases. In others, it just provides a certain pedantic
    smugness. Either way, we should do what WSGI requires.

    Noteworthy goofs include:

      * If a client is downloading a large object and disconnects halfway
        through, a proxy -&gt; obj connection may be leaked. In this case,
        the WSGI iterable is a SegmentedIterable, which lacked a close()
        method. Thus, when the WSGI server noticed the client disconnect,
        it had no way of telling the SegmentedIterable about it, and so
        the underlying iterable for the segment's data didn't get
        closed.

        Here, it seems likely (though unproven) that the object server
        would time out and kill the connection, or that a
        ChunkWriteTimeout would fire down in the proxy server, so the
        leaked connection would eventually go away. However, a flurry of
        client disconnects could leave a big pile of useless connections.

      * If a conditional request receives a 304 or 412, the underlying
        app_iter is not closed. This mostly affects conditional requests
        for large objects.

    The leaked connections were noticed by this patch's co-author, who
    made the changes to SegmentedIterable. Those changes helped, but did
    not completely fix, the issue. The rest of the patch is an attempt to
    plug the rest of the holes.

    Co-Authored-By: Romain LE DISEZ &lt;romain.ledisez@ovh.net&gt;

    Change-Id: I168e147aae7c1728e7e3fdabb7fba6f2d747d937
    Closes-Bug: #1466549

The first noteworthy goof looks like what we're seeing in this bug. This
patch is already in Liberty, but it was applied well after 2.2.0 (Juno) and
Kilo. So it only needs to be backported.

My 2 cents,
Matt

On Wed, Oct 14, 2015 at 7:59 PM, Christian Schwede &lt;
1493303@bugs.launchpad.net&gt; wrote:

&gt; Just to add more light on this: most of the connections on pre-12d8a53
&gt; are still not closed after 50 minutes. That definetely does not happen
&gt; on a branch on or after commit 12d8a53.
&gt;
&gt; --
&gt; You received this bug notification because you are a member of Swift
&gt; Core security contacts, which is subscribed to the bug report.
&gt; https://bugs.launchpad.net/bugs/1493303
&gt;
&gt; Title:
&gt;   Swift proxy memory leak on unfinished read
&gt;
&gt; Status in ubuntu-cloud-archive:
&gt;   New
&gt; Status in OpenStack Security Advisory:
&gt;   Incomplete
&gt; Status in OpenStack Object Storage (swift):
&gt;   New
&gt; Status in swift package in Ubuntu:
&gt;   New
&gt;
&gt; Bug description:
&gt;   This issue is being treated as a potential security risk under
&gt;   embargo. Please do not make any public mention of embargoed (private)
&gt;   security vulnerabilities before their coordinated publication by the
&gt;   OpenStack Vulnerability Management Team in the form of an official
&gt;   OpenStack Security Advisory. This includes discussion of the bug or
&gt;   associated fixes in public forums such as mailing lists, code review
&gt;   systems and bug trackers. Please also avoid private disclosure to
&gt;   other individuals not already approved for access to this information,
&gt;   and provide this same reminder to those who are made aware of the
&gt;   issue prior to publication. All discussion should remain confined to
&gt;   this private bug report, and any proposed fixes should be added to the
&gt;   bug as attachments.
&gt;
&gt;   It looks like the Swift proxy will leak memory if the connection is
&gt;   closed and the full response is not read. This opens for a potential
&gt;   DoS attacks.
&gt;
&gt;   Reproduce:
&gt;
&gt;   $ swift -A http://localhost:8888/auth/v1.0 -U .. -K .. upload --use-slo
&gt; --segment-size 1048576 &lt;container&gt; &lt;big-file&gt;
&gt;   $ curl -H'X-Auth-Token: AUTH_...' "http://localhost:8888/v1/AUTH_../&lt;container&gt;/&lt;big-file&gt;"
&gt; -m 0.001 &gt; /dev/null
&gt;
&gt;   Repeat the curl command a couple of times and you will have more
&gt;   information in netstat and sockstat. The important part is the -m
&gt;   which sets the max time curl spends at downloading. After that point,
&gt;   it'll close the connection.
&gt;
&gt;   $ sudo netstat -ant -p | grep :6000
&gt;   $ cat /proc/net/sockstat
&gt;
&gt;   tcp        0      0 127.0.0.1:6000          0.0.0.0:*
&gt;  LISTEN      1358/python
&gt;   tcp        0  43221 127.0.0.1:6000          127.0.0.1:48350
&gt;  FIN_WAIT1   -
&gt;   tcp        0  43221 127.0.0.1:6000          127.0.0.1:48882
&gt;  FIN_WAIT1   -
&gt;   tcp   939820      0 127.0.0.1:48350         127.0.0.1:6000
&gt; ESTABLISHED 17897/python
&gt;   tcp   939820      0 127.0.0.1:48882         127.0.0.1:6000
&gt; ESTABLISHED 17890/python
&gt;   tcp   983041      0 127.0.0.1:48191         127.0.0.1:6000
&gt; CLOSE_WAIT  17897/python
&gt;   tcp   983041      0 127.0.0.1:48948         127.0.0.1:6000
&gt; CLOSE_WAIT  17892/python
&gt;
&gt;   Restarting the proxy frees up the lingering memory.
&gt;
&gt;   This problem did not exist in 2.2.0.
&gt;
&gt;   ProblemType: Bug
&gt;   DistroRelease: Ubuntu 14.04
&gt;   Package: swift 2.2.2-0ubuntu1~cloud0 [origin: Canonical]
&gt;   ProcVersionSignature: Ubuntu 3.16.0-48.64~14.04.1-generic 3.16.7-ckt15
&gt;   Uname: Linux 3.16.0-48-generic x86_64
&gt;   ApportVersion: 2.14.1-0ubuntu3.12
&gt;   Architecture: amd64
&gt;   CrashDB:
&gt;    {
&gt;                   "impl": "launchpad",
&gt;                   "project": "cloud-archive",
&gt;                   "bug_pattern_url": "
&gt; http://people.canonical.com/~ubuntu-archive/bugpatterns/bugpatterns.xml",
&gt;                }
&gt;   Date: Tue Sep  8 09:55:05 2015
&gt;   InstallationDate: Installed on 2015-06-22 (77 days ago)
&gt;   InstallationMedia: Ubuntu-Server 14.04.2 LTS "Trusty Tahr" - Release
&gt; amd64 (20150218.1)
&gt;   PackageArchitecture: all
&gt;   SourcePackage: swift
&gt;   UpgradeStatus: No upgrade log present (probably fresh install)
&gt;
&gt; To manage notifications about this bug go to:
&gt; https://bugs.launchpad.net/cloud-archive/+bug/1493303/+subscriptions
&gt;
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-16T16:57:01.634091+00:00" title="2015-11-16 16:57:01 UTC">on 2015-11-16</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/10">
                <strong>Re: Swift proxy memory leak on unfinished read</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4520199/+files/leakreproducer.sh">leakreproducer.sh</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4520199">Edit</a>
        (1.1 KiB,
        text/x-sh)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug can still be reproduced in an easy and consistent manner. I&#x27;ve attached a script reproducing the leaks. It simply spins up a swift SAIO box in vagrant, and then runs the curl command mentioned in this issue. Every time the script is run, more memory is leaked. If the proxy-server is restared, the memory will be freed.</p>
<p>A small note: while the script was provisioning the vagrant box for the first time, apt failed. This was easily fixed:<br />
$ cd vagrant-<wbr />swift-all-<wbr />in-one/<br />
$ vagrant ssh -c &quot;sudo apt-get -f install -y&quot;<br />
$ vagrant provision</p>
<p>Then just rerun the script:<br />
$ cd ..<br />
$ ./leakreproducer.sh</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug can still be reproduced in an easy and consistent manner. I've attached a script reproducing the leaks. It simply spins up a swift SAIO box in vagrant, and then runs the curl command mentioned in this issue. Every time the script is run, more memory is leaked. If the proxy-server is restared, the memory will be freed. 

A small note: while the script was provisioning the vagrant box for the first time, apt failed. This was easily fixed:
$ cd vagrant-swift-all-in-one/
$ vagrant ssh -c "sudo apt-get -f install -y"
$ vagrant provision

Then just rerun the script:
$ cd ..
$ ./leakreproducer.sh

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-18T23:13:01.377015+00:00" title="2015-11-18 23:13:01 UTC">on 2015-11-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I was able to reproduce this on saio instance of 8Go of ram, deployed with openstack-<wbr />swift-2.<wbr />3.0-2.fc23.<wbr />noarch (which doesn&#x27;t have 12d8a53). However it didn&#x27;t cause a noticeable effect since the process was killed and automatically restarted without causing disruption to other services. Also the leak was quickly limited by the maximum number of open file and it took about 42k connections until the process reserved all memory.</p>
<p>Anyway this seems like a duplicate of <a href="/bugs/1466549" class="bug-link">bug 1466549</a> which is already public, can we mark this bug as duplicate and open it ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I was able to reproduce this on saio instance of 8Go of ram, deployed with openstack-swift-2.3.0-2.fc23.noarch (which doesn't have 12d8a53). However it didn't cause a noticeable effect since the process was killed and automatically restarted without causing disruption to other services. Also the leak was quickly limited by the maximum number of open file and it took about 42k connections until the process reserved all memory.

Anyway this seems like a duplicate of bug 1466549 which is already public, can we mark this bug as duplicate and open it ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T11:00:48.733099+00:00" title="2015-11-19 11:00:48 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The problem is not that the machine runs out of memory, the problem is that the kernel runs out of buffer space for the TCP stack. This renders the machine unable to do any form of network communication, including SSH. It will however not get the proxy process killed, as there&#x27;s still plenty of memory left on the machine (just not for TCP). This effectively renders the machine completely unresponsive until it&#x27;s rebooted, or the proxy process is restarted.</p>
<p>dmesg gets filled up with messages like these:<br />
[  276.495010] TCP: out of memory -- consider tuning tcp_mem<br />
[  276.852703] TCP: out of memory -- consider tuning tcp_mem<br />
[  277.996776] TCP: out of memory -- consider tuning tcp_mem<br />
[  278.111035] TCP: out of memory -- consider tuning tcp_mem<br />
[  279.840715] TCP: out of memory -- consider tuning tcp_mem<br />
[  280.421439] TCP: out of memory -- consider tuning tcp_mem<br />
[  281.435703] TCP: out of memory -- consider tuning tcp_mem<br />
[  283.579847] TCP: out of memory -- consider tuning tcp_mem<br />
[  283.616647] TCP: out of memory -- consider tuning tcp_mem<br />
[  283.652761] TCP: out of memory -- consider tuning tcp_mem</p>
<p>These symptons are easily reproduced with the script I posted above, just run it a few times, and the machine will become completely unresponsive. The following line should do the trick:<br />
$ vagrant ssh -c &#x27;for i in {1..100}; do /vagrant/<wbr />leakconnections<wbr />.sh; done&#x27;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The problem is not that the machine runs out of memory, the problem is that the kernel runs out of buffer space for the TCP stack. This renders the machine unable to do any form of network communication, including SSH. It will however not get the proxy process killed, as there's still plenty of memory left on the machine (just not for TCP). This effectively renders the machine completely unresponsive until it's rebooted, or the proxy process is restarted.

dmesg gets filled up with messages like these:
[  276.495010] TCP: out of memory -- consider tuning tcp_mem
[  276.852703] TCP: out of memory -- consider tuning tcp_mem
[  277.996776] TCP: out of memory -- consider tuning tcp_mem
[  278.111035] TCP: out of memory -- consider tuning tcp_mem
[  279.840715] TCP: out of memory -- consider tuning tcp_mem
[  280.421439] TCP: out of memory -- consider tuning tcp_mem
[  281.435703] TCP: out of memory -- consider tuning tcp_mem
[  283.579847] TCP: out of memory -- consider tuning tcp_mem
[  283.616647] TCP: out of memory -- consider tuning tcp_mem
[  283.652761] TCP: out of memory -- consider tuning tcp_mem

These symptons are easily reproduced with the script I posted above, just run it a few times, and the machine will become completely unresponsive. The following line should do the trick:
$ vagrant ssh -c 'for i in {1..100}; do /vagrant/leakconnections.sh; done'
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T14:23:26.332522+00:00" title="2015-11-19 14:23:26 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>That behavior might be related to vagrant networking setup, using a nova instance with fedora kernel didn&#x27;t broke ssh connection (active and new one). I run 5 parallel &quot;while true; curl ...; done&quot; using a public SLO object (no need for token).</p>
<p>Hence the question asked on <a href="/bugs/1466549" class="bug-link">bug 1466549</a> comment #7:<br />
Does that mean that the issue described here is confirmed to be reproducible under most deployments?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">That behavior might be related to vagrant networking setup, using a nova instance with fedora kernel didn't broke ssh connection (active and new one). I run 5 parallel "while true; curl ...; done" using a public SLO object (no need for token).

Hence the question asked on bug 1466549 comment #7:
Does that mean that the issue described here is confirmed to be reproducible under most deployments?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T14:37:26.778962+00:00" title="2015-11-19 14:37:26 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>No, I don&#x27;t think is related to vagrant, we get the same results in our production environment (that&#x27;s why we filed the original ticket, our nodes we upgraded to 2.4.0 sunk after the upgrade). The production environment is running on bare metal, so it shouldn&#x27;t be related to any form of virtualization.</p>
<p>We also tried 2.5.0 in production, and still get the same issues. The last good version for us was 2.2.x, after this we skipped straight to 2.4.0 (I don&#x27;t think ubuntu packaged 2.3.0) and started having problems.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">No, I don't think is related to vagrant, we get the same results in our production environment (that's why we filed the original ticket, our nodes we upgraded to 2.4.0 sunk after the upgrade). The production environment is running on bare metal, so it shouldn't be related to any form of virtualization. 

We also tried 2.5.0 in production, and still get the same issues. The last good version for us was 2.2.x, after this we skipped straight to 2.4.0 (I don't think ubuntu packaged 2.3.0) and started having problems.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T14:59:17.511006+00:00" title="2015-11-19 14:59:17 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Status changed to &#x27;Confirmed&#x27; because the bug affects multiple users.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Status changed to 'Confirmed' because the bug affects multiple users.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T15:10:41.446170+00:00" title="2015-11-19 15:10:41 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hum, if this reproduce in 2.4.0 and 2.5.0 then it may be a different issue than <a href="/bugs/1466549" class="bug-link">bug 1466549</a> for which the fix (12d8a53) is included in those releases...</p>
<p>It seems like the leakreproducer.sh is stressing the proxy-server using localhost, would this be a different scenario compared to external connection ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hum, if this reproduce in 2.4.0 and 2.5.0 then it may be a different issue than bug 1466549 for which the fix (12d8a53) is included in those releases...

It seems like the leakreproducer.sh is stressing the proxy-server using localhost, would this be a different scenario compared to external connection ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T15:30:11.481278+00:00" title="2015-11-19 15:30:11 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>No, it&#x27;s not different compared to an external connection. If leakproducer.sh is run outside of the virtual machine (just change localhost to 192.168.8.80 in the script), the problem still persists.</p>
<p>Another thing which migth be interesting to note is that  after the memory has leaked, it isn&#x27;t freed even if the object-server is stopped. The proxy-server needs to be restarted in order for the memory to be freed.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">No, it's not different compared to an external connection. If leakproducer.sh is run outside of the virtual machine (just change localhost to 192.168.8.80 in the script), the problem still persists.

Another thing which migth be interesting to note is that  after the memory has leaked, it isn't freed even if the object-server is stopped. The proxy-server needs to be restarted in order for the memory to be freed.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-19T18:58:43.121095+00:00" title="2015-11-19 18:58:43 UTC">on 2015-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Andreas, what version of curl are you using?</p>
<p>I&#x27;m not able to see any issues when running leakconnections.sh from my mac (curl 7.43.0), but I did find something when running directly on my precise SAIO (curl 7.22).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Andreas, what version of curl are you using?

I'm not able to see any issues when running leakconnections.sh from my mac (curl 7.43.0), but I did find something when running directly on my precise SAIO (curl 7.22).

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-20T09:07:22.738031+00:00" title="2015-11-20 09:07:22 UTC">on 2015-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m running curl 7.43.0 on ubuntu 15.10. I don&#x27;t think the issue is tied to the curl version though, this happens for us in our production environment when running ffmpeg to transcode videos. When ffmpeg is running it seeks a lot in the stream by opening a new socket with some offset, doing a short read, and then closing the socket. The read and close without consuming the whole object seems to be the key to the problem here.</p>
<p>When running curl from your mac, what output do you get? You should see a lot of lines like these:<br />
curl: (28) Operation timed out after 102 milliseconds with 769995 out of 524288512 bytes received<br />
These are due to curl closing the socket without consuming the whole object, triggering the bug.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm running curl 7.43.0 on ubuntu 15.10. I don't think the issue is tied to the curl version though, this happens for us in our production environment when running ffmpeg to transcode videos. When ffmpeg is running it seeks a lot in the stream by opening a new socket with some offset, doing a short read, and then closing the socket. The read and close without consuming the whole object seems to be the key to the problem here. 

When running curl from your mac, what output do you get? You should see a lot of lines like these:
curl: (28) Operation timed out after 102 milliseconds with 769995 out of 524288512 bytes received
These are due to curl closing the socket without consuming the whole object, triggering the bug. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-11-23T18:25:34.230977+00:00" title="2015-11-23 18:25:34 UTC">on 2015-11-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@notmyname, does your precise SAIO is running with 12d8a53 ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@notmyname, does your precise SAIO is running with 12d8a53 ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-01T14:11:36.023351+00:00" title="2015-12-01 14:11:36 UTC">on 2015-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Any news on this? Can we consider this bug confirmed as it can be consistently reproduced?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Any news on this? Can we consider this bug confirmed as it can be consistently reproduced?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tsuyuzaki-kota" class="sprite person">Kota Tsuyuzaki (tsuyuzaki-kota)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-02T12:34:51.097781+00:00" title="2015-12-02 12:34:51 UTC">on 2015-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>It seems that I can reproduce this with current master (exactly after 12d8a53 ) in 2 environment, one is ubuntu 14.04.02 (3.13.0-48-generic kernel) on AWS and the other is 14.04.01 (3.13.0-36-generic) on my laptop virtual machine.</p>
<p>I didn&#x27;t look at the reason in detail yet but it looks like that we have an issue for that.</p>
<p>My procedure is:</p>
<p>1. upload a 50MB slo object via swift command (i.e. swift upload ---use-slo)<br />
2. Download the slo object via curl, and then stop the download stream via -m (timeout) option<br />
3.  cat /proc/net/sockstat shows as follows:</p>
<p>sockets: used 314<br />
TCP: inuse 20 orphan 0 tw 0 alloc 123 mem 3919 (&lt;- I found the &quot;mem&quot; increased by the curl requests)<br />
UDP: inuse 3 mem 0<br />
UDPLITE: inuse 0<br />
RAW: inuse 0<br />
FRAG: inuse 0 memory 0</p>
<p>4. It looks also increase proxy-server memory usage (confilemed by ps and top command)</p>
<p>It looks that larger number of timeout increased the used memory rapidly. i.e. &quot;-m 0.1&quot; made proxy-server to spend more memory than &quot;-m 0.01&quot; (both of them killed the connections before the task finished)</p>
<p>However, I couldn&#x27;t find CLOSE_WAIT/FIN_WAIT in netstat. (it might be related that I turned on tcp_recycle in sysctl)</p>
<p>Right now I&#x27;m not sure but it might be depends on kernel version because I tested in closer version with reported environment so I&#x27;ll try to make sure another environment if we can reproduce this anytime.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">It seems that I can reproduce this with current master (exactly after 12d8a53 ) in 2 environment, one is ubuntu 14.04.02 (3.13.0-48-generic kernel) on AWS and the other is 14.04.01 (3.13.0-36-generic) on my laptop virtual machine.

I didn't look at the reason in detail yet but it looks like that we have an issue for that.

My procedure is:

1. upload a 50MB slo object via swift command (i.e. swift upload ---use-slo)
2. Download the slo object via curl, and then stop the download stream via -m (timeout) option
3.  cat /proc/net/sockstat shows as follows:

sockets: used 314
TCP: inuse 20 orphan 0 tw 0 alloc 123 mem 3919 (&lt;- I found the "mem" increased by the curl requests)
UDP: inuse 3 mem 0
UDPLITE: inuse 0
RAW: inuse 0
FRAG: inuse 0 memory 0

4. It looks also increase proxy-server memory usage (confilemed by ps and top command)

It looks that larger number of timeout increased the used memory rapidly. i.e. "-m 0.1" made proxy-server to spend more memory than "-m 0.01" (both of them killed the connections before the task finished)

However, I couldn't find CLOSE_WAIT/FIN_WAIT in netstat. (it might be related that I turned on tcp_recycle in sysctl)

Right now I'm not sure but it might be depends on kernel version because I tested in closer version with reported environment so I'll try to make sure another environment if we can reproduce this anytime.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
    
    <time title="2015-12-02 16:44:28 UTC" datetime="2015-12-02T16:44:28.191102+00:00">on 2015-12-02</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-03T00:12:24.599339+00:00" title="2015-12-03 00:12:24 UTC">on 2015-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This is weird. I was able to reproduce the problem; the proxy server accumulates a bunch of open filehandles for dead sockets.</p>
<p>I can see with strace that the sockets in question are used for client &lt;--&gt; proxy communication. We&#x27;re not leaking connections to the storage backends. Also, it looks like someone is trying to clean them up, but is just bad at it. Check this out:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# we have a GET request from the client; the socket is fd 220<br />
&nbsp;&nbsp;&nbsp;&nbsp;accept(4, {sa_family=AF_INET, sin_port=<wbr />htons(38280)<wbr />, sin_addr=<wbr />inet_addr(<wbr />&quot;127.0.<wbr />0.1&quot;)}, [16]) = 220<br />
&nbsp;&nbsp;&nbsp;&nbsp;fcntl(220, F_GETFL)                     = 0x2 (flags O_RDWR)<br />
&nbsp;&nbsp;&nbsp;&nbsp;fcntl(220, F_SETFL, O_RDWR|O_NONBLOCK)  = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;fcntl(220, F_GETFL)                     = 0x802 (flags O_RDWR|O_NONBLOCK)<br />
&nbsp;&nbsp;&nbsp;&nbsp;fcntl(220, F_SETFL, O_RDWR|O_NONBLOCK)  = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;sendto(3, &quot;&lt;139&gt;proxy-server: STDERR: (2834&quot;..., 65, 0, NULL, 0) = 65<br />
&nbsp;&nbsp;&nbsp;&nbsp;accept(4, 0x7fffa0e778c0, [16])         = -1 EAGAIN (Resource temporarily unavailable)<br />
&nbsp;&nbsp;&nbsp;&nbsp;recvfrom(220, &quot;GET /v1/AUTH_<wbr />test/test/<wbr />largefile&quot;<wbr />..., 65536, 0, NULL, NULL) = 160</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# ... removed stuff talking to memcached + storage backends</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# then we try to send something and learn that it&#x27;s shut down, so SIGPIPE<br />
&nbsp;&nbsp;&nbsp;&nbsp;sendto(220, &quot;\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0&quot;..., 65536, 0, NULL, 0) = -1 EPIPE (Broken pipe)<br />
&nbsp;&nbsp;&nbsp;&nbsp;--- SIGPIPE {si_signo=SIGPIPE, si_code=SI_USER, si_pid=28347, si_uid=1000} ---<br />
&nbsp;&nbsp;&nbsp;&nbsp;# stupidly, we try to send it again ang get another SIGPIPE<br />
&nbsp;&nbsp;&nbsp;&nbsp;sendto(220, &quot;\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0\0\0\0\<wbr />0&quot;..., 65536, 0, NULL, 0) = -1 EPIPE (Broken pipe)<br />
&nbsp;&nbsp;&nbsp;&nbsp;--- SIGPIPE {si_signo=SIGPIPE, si_code=SI_USER, si_pid=28347, si_uid=1000} ---</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# attempted cleanup...<br />
&nbsp;&nbsp;&nbsp;&nbsp;shutdown(220, SHUT_RDWR)                = -1 ENOTCONN (Transport endpoint is not connected)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# and now we completely forget about fd 220 and it&#x27;s never mentioned again. there&#x27;s the leak.<br />
&nbsp;&nbsp;&nbsp;&nbsp;poll([{fd=4, events=<wbr />POLLIN|<wbr />POLLPRI|<wbr />POLLERR|<wbr />POLLHUP}<wbr />], 1, 13) = 1 ([{fd=4, revents=POLLIN}])<br />
&nbsp;&nbsp;&nbsp;&nbsp;# ...thousands more lines not mentioning fd 220</p>
<p>What&#x27;s weird here is that eventlet is doing this at least somewhat intentionally. Here&#x27;s an annotated eventlet.<wbr />wsgi.HttpProtoc<wbr />ol.finish(<wbr />):</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;def finish(self):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# this tries to flush any buffers; this is probably what<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# causes the second sendto()/SIGPIPE pair, but I have not<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# verified that.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseHTTPSe<wbr />rver.BaseHTTPRe<wbr />questHandler.<wbr />finish(<wbr />self)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except socket.error as e:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Broken pipe, connection reset by peer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if support.<wbr />get_errno(<wbr />e) not in BROKEN_SOCK:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;raise<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is responsible for the shutdown call. It executes every time;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the try/except above doesn&#x27;t let any exceptions out that would<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# exit this method early.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;greenio.<wbr />shutdown_<wbr />safe(self.<wbr />connection)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Here&#x27;s the fun part: this method call gets executed, but it<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# doesn&#x27;t make any syscalls. Something is causing this to be a no-op,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# but I don&#x27;t know what it is.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;self.connectio<wbr />n.close(<wbr />)</p>
<p>Looks like it might be a bug in eventlet, maybe? I&#x27;m not convinced this bug is fixable from within Swift.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This is weird. I was able to reproduce the problem; the proxy server accumulates a bunch of open filehandles for dead sockets.

I can see with strace that the sockets in question are used for client &lt;--&gt; proxy communication. We're not leaking connections to the storage backends. Also, it looks like someone is trying to clean them up, but is just bad at it. Check this out:


    # we have a GET request from the client; the socket is fd 220
    accept(4, {sa_family=AF_INET, sin_port=htons(38280), sin_addr=inet_addr("127.0.0.1")}, [16]) = 220
    fcntl(220, F_GETFL)                     = 0x2 (flags O_RDWR)
    fcntl(220, F_SETFL, O_RDWR|O_NONBLOCK)  = 0
    fcntl(220, F_GETFL)                     = 0x802 (flags O_RDWR|O_NONBLOCK)
    fcntl(220, F_SETFL, O_RDWR|O_NONBLOCK)  = 0
    sendto(3, "&lt;139&gt;proxy-server: STDERR: (2834"..., 65, 0, NULL, 0) = 65
    accept(4, 0x7fffa0e778c0, [16])         = -1 EAGAIN (Resource temporarily unavailable)
    recvfrom(220, "GET /v1/AUTH_test/test/largefile"..., 65536, 0, NULL, NULL) = 160

    # ... removed stuff talking to memcached + storage backends

    # then we try to send something and learn that it's shut down, so SIGPIPE
    sendto(220, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"..., 65536, 0, NULL, 0) = -1 EPIPE (Broken pipe)
    --- SIGPIPE {si_signo=SIGPIPE, si_code=SI_USER, si_pid=28347, si_uid=1000} ---
    # stupidly, we try to send it again ang get another SIGPIPE
    sendto(220, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"..., 65536, 0, NULL, 0) = -1 EPIPE (Broken pipe)
    --- SIGPIPE {si_signo=SIGPIPE, si_code=SI_USER, si_pid=28347, si_uid=1000} ---

    # attempted cleanup...
    shutdown(220, SHUT_RDWR)                = -1 ENOTCONN (Transport endpoint is not connected)

    # and now we completely forget about fd 220 and it's never mentioned again. there's the leak.
    poll([{fd=4, events=POLLIN|POLLPRI|POLLERR|POLLHUP}], 1, 13) = 1 ([{fd=4, revents=POLLIN}])
    # ...thousands more lines not mentioning fd 220


What's weird here is that eventlet is doing this at least somewhat intentionally. Here's an annotated eventlet.wsgi.HttpProtocol.finish():


    def finish(self):
        try:
            # this tries to flush any buffers; this is probably what
            # causes the second sendto()/SIGPIPE pair, but I have not
            # verified that.
            BaseHTTPServer.BaseHTTPRequestHandler.finish(self)
        except socket.error as e:
            # Broken pipe, connection reset by peer
            if support.get_errno(e) not in BROKEN_SOCK:
                raise
        # This is responsible for the shutdown call. It executes every time;
        # the try/except above doesn't let any exceptions out that would
        # exit this method early.
        greenio.shutdown_safe(self.connection)

        # Here's the fun part: this method call gets executed, but it
        # doesn't make any syscalls. Something is causing this to be a no-op,
        # but I don't know what it is.
        self.connection.close()


Looks like it might be a bug in eventlet, maybe? I'm not convinced this bug is fixable from within Swift.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-03T00:55:59.386604+00:00" title="2015-12-03 00:55:59 UTC">on 2015-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Also, there are two separate issues here. The first is fixed by commit 12d8a53 and concerns a leak of connections from proxy to storage server. This is the one being discussed for backporting. The second is a file descriptor leak for client-to-proxy connections. It is reproducible on master (418f9b21) and may be in Swift, eventlet, somewhere else, or the interaction between any two or more of those.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Also, there are two separate issues here. The first is fixed by commit 12d8a53 and concerns a leak of connections from proxy to storage server. This is the one being discussed for backporting. The second is a file descriptor leak for client-to-proxy connections. It is reproducible on master (418f9b21) and may be in Swift, eventlet, somewhere else, or the interaction between any two or more of those.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-03T01:36:35.517279+00:00" title="2015-12-03 01:36:35 UTC">on 2015-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>never mind... it&#x27;s only reproducible with SLOs and DLOs. Not even regular Swift objects. Something in our SegmentedIterable class is probably the culprit.</p>
<p>feh.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">never mind... it's only reproducible with SLOs and DLOs. Not even regular Swift objects. Something in our SegmentedIterable class is probably the culprit.

feh.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-03T20:17:07.960499+00:00" title="2015-12-03 20:17:07 UTC">on 2015-12-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>git bisect claims it&#x27;s commit 5ca49ca92485b6b<wbr />a868544f12fa524<wbr />d9d7b666c6 that introduced the bug. conveniently, this commit changes a bunch of stuff in SegmentedIterable, validating the guess in comment #25.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">git bisect claims it's commit 5ca49ca92485b6ba868544f12fa524d9d7b666c6 that introduced the bug. conveniently, this commit changes a bunch of stuff in SegmentedIterable, validating the guess in comment #25.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-04T02:02:11.324544+00:00" title="2015-12-04 02:02:11 UTC">on 2015-12-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4529331/+files/leakpatch-1.diff">leakpatch-1.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4529331">Edit</a>
        (496 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Experimentally, this fixes the bug. Having a heck of a time writing a unit test, though. If anyone wants to jump in there, please feel free.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Experimentally, this fixes the bug. Having a heck of a time writing a unit test, though. If anyone wants to jump in there, please feel free.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tsuyuzaki-kota" class="sprite person">Kota Tsuyuzaki (tsuyuzaki-kota)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-07T06:00:23.758452+00:00" title="2015-12-07 06:00:23 UTC">on 2015-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4530760/+files/security_leak_fix.diff">security_leak_fix.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4530760">Edit</a>
        (885 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Awesome Sam!</p>
<p>SegmentItrable never closes its app_iter handle and it causes the handler leak. It makes me sense and I confirmed the leakpatch-1.diff fixed the issue in my environment.</p>
<p>Plus, I tried to improve the fix to be intuitive a bit more (attached). In my patch, SegmentIterable<wbr />.close will attempt to close self.app_iter at first and it will emit GeneratorExit and then, it will close also backend request iter at current_resp.</p>
<p>Anyways, nice work and thanks! :-)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Awesome Sam!

SegmentItrable never closes its app_iter handle and it causes the handler leak. It makes me sense and I confirmed the leakpatch-1.diff fixed the issue in my environment.

Plus, I tried to improve the fix to be intuitive a bit more (attached). In my patch, SegmentIterable.close will attempt to close self.app_iter at first and it will emit GeneratorExit and then, it will close also backend request iter at current_resp.

Anyways, nice work and thanks! :-)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-07T14:17:52.012395+00:00" title="2015-12-07 14:17:52 UTC">on 2015-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@tsuyuzaki-kota we&#x27;ve deployed your patch to some of our servers now. Everything seems to be fixed when running some simple tests that used to trigger the bug! I&#x27;ll let it run for a day or two and see if everything is stable.</p>
<p>Thanks for the good work everybody! :D</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@tsuyuzaki-kota we've deployed your patch to some of our servers now. Everything seems to be fixed when running some simple tests that used to trigger the bug! I'll let it run for a day or two and see if everything is stable.

Thanks for the good work everybody! :D</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2015-12-07 15:27:49 UTC" datetime="2015-12-07T15:27:49.108021+00:00">on 2015-12-07</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~yoshiyaka" class="sprite person">Andreas Andersen (yoshiyaka)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-08T22:42:52.043791+00:00" title="2015-12-08 22:42:52 UTC">on 2015-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ok, so everything is still fine on our servers. It seems like the patch fixed the bug completely :)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ok, so everything is still fine on our servers. It seems like the patch fixed the bug completely :)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-09T20:22:59.698124+00:00" title="2015-12-09 20:22:59 UTC">on 2015-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4532159/+files/socket-leak-2.diff">socket-leak-2.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4532159">Edit</a>
        (5.1 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is a slight modification of Kota&#x27;s patch, plus a unit test.</p>
<p>The modification was only to change &quot;except GeneratorExit:&quot; to &quot;finally:&quot; so that GeneratorExit propagates to any generators enclosing SegmentedIterable. I don&#x27;t know of any right now, but future middlewares could easily introduce them.</p>
<p>Now that we have a unit test, I believe this patch to be ready for review.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is a slight modification of Kota's patch, plus a unit test.

The modification was only to change "except GeneratorExit:" to "finally:" so that GeneratorExit propagates to any generators enclosing SegmentedIterable. I don't know of any right now, but future middlewares could easily introduce them.

Now that we have a unit test, I believe this patch to be ready for review.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-09T21:00:18.151852+00:00" title="2015-12-09 21:00:18 UTC">on 2015-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>It seems like both leaks (proxy to server and client to proxy) have been reported on former <a href="/bugs/1466549" class="bug-link">bug 1466549</a>. I&#x27;ve subscribed the original reporter.</p>
<p>Örjan, I can&#x27;t find your affiliation, if you want to credit your current employer, please let me know.</p>
<p>Here is the impact description to cover both bugs (which will likely get two different CVE):</p>
<p>Title: Swift proxy-server DoS through Large Object<br />
Reporter: Romain LE DISEZ (OVH), Örjan Persson<br />
Products: Swift<br />
Affects: client-proxy: &lt; 2.4.0 (Liberty)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy-server: =&lt; 2.5.0 (Liberty included)</p>
<p>Description:<br />
Romain LE DISEZ from OVH and Örjan Persson independently reported two vulnerabilities in Swift Large Object. By repeatedly requesting and interrupting connections to a Large Object (Dynamic or Static) URL, a remote attacker may exhausts Swift proxy-server resources, potentially resulting in a denial of service. Note that there are two distinct bugs that can exhaust proxy resources, one for client connection (client to proxy), one for servers connection (proxy to server). All Swift setup are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">It seems like both leaks (proxy to server and client to proxy) have been reported on former bug 1466549. I've subscribed the original reporter.

Örjan, I can't find your affiliation, if you want to credit your current employer, please let me know.

Here is the impact description to cover both bugs (which will likely get two different CVE):

Title: Swift proxy-server DoS through Large Object
Reporter: Romain LE DISEZ (OVH), Örjan Persson
Products: Swift
Affects: client-proxy: &lt; 2.4.0 (Liberty)
      proxy-server: =&lt; 2.5.0 (Liberty included)

Description:
Romain LE DISEZ from OVH and Örjan Persson independently reported two vulnerabilities in Swift Large Object. By repeatedly requesting and interrupting connections to a Large Object (Dynamic or Static) URL, a remote attacker may exhausts Swift proxy-server resources, potentially resulting in a denial of service. Note that there are two distinct bugs that can exhaust proxy resources, one for client connection (client to proxy), one for servers connection (proxy to server). All Swift setup are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~o-42mm" class="sprite person">Örjan Persson (o-42mm)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-09T23:11:45.189286+00:00" title="2015-12-09 23:11:45 UTC">on 2015-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Great! Happy to hear that it has been resolved. Kiliaro is my employer.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Great! Happy to hear that it has been resolved. Kiliaro is my employer.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-10T19:46:30.562534+00:00" title="2015-12-10 19:46:30 UTC">on 2015-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Örjan, next description will mention Kiliaro. I just need to figure out what swift release are going to be fixed...<br />
The tip of stable/kilo (463fbe39fa1142<wbr />d2bb9f7c738c6d8<wbr />8d9f77857f1) doesn&#x27;t seems to be in any tags<br />
There is no stable/liberty branch.</p>
<p>According to <a rel="nofollow" href="http://docs.openstack.org/releases/">http://<wbr />docs.openstack.<wbr />org/releases/</a>, it looks like the fix should land in 2.3.1 (for kilo) and 2.5.1 (for liberty).</p>
<p>@swift-coresec, is this following affect line correct ?</p>
<p>Affects: client to proxy: &gt;=2.2.1, &lt;= 2.3.0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;proxy to server: &gt;=2.2.1, &lt;= 2.3.0, &gt;= 2.4.0, &lt;= 2.5.0</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Örjan, next description will mention Kiliaro. I just need to figure out what swift release are going to be fixed...
The tip of stable/kilo (463fbe39fa1142d2bb9f7c738c6d88d9f77857f1) doesn't seems to be in any tags
There is no stable/liberty branch.

According to http://docs.openstack.org/releases/, it looks like the fix should land in 2.3.1 (for kilo) and 2.5.1 (for liberty).

@swift-coresec, is this following affect line correct ? 

Affects: client to proxy: &gt;=2.2.1, &lt;= 2.3.0
                proxy to server: &gt;=2.2.1, &lt;= 2.3.0, &gt;= 2.4.0, &lt;= 2.5.0

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
    
    <time title="2015-12-15 01:18:09 UTC" datetime="2015-12-15T01:18:09.597634+00:00">on 2015-12-15</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Critical
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2015-12-17T23:05:56.670337+00:00" title="2015-12-17 23:05:56 UTC">on 2015-12-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sam, I think the patch is ok, but the test seems to only be testing the implementation of FakeSwift, not the actual change in SegmentedIterable. When only applying the changes from this patch in the test/ directory, unittests still pass.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sam, I think the patch is ok, but the test seems to only be testing the implementation of FakeSwift, not the actual change in SegmentedIterable. When only applying the changes from this patch in the test/ directory, unittests still pass.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-06T17:47:40.025575+00:00" title="2016-01-06 17:47:40 UTC">on 2016-01-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sam what&#x27;s the status of tests?</p>
<p>For everyone, it would be good to review the patch in #31 to see how the patch itself looks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sam what's the status of tests?

For everyone, it would be good to review the patch in #31 to see how the patch itself looks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-08T02:18:59.975372+00:00" title="2016-01-08 02:18:59 UTC">on 2016-01-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4545988/+files/socket-leak-3.diff">socket-leak-3.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4545988">Edit</a>
        (6.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here&#x27;s a patch with a commit message explaining what&#x27;s going on. Since it&#x27;s a fix for a memory leak, the test is fairly crappy, but it&#x27;s something.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here's a patch with a commit message explaining what's going on. Since it's a fix for a memory leak, the test is fairly crappy, but it's something.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-08T18:15:21.092260+00:00" title="2016-01-08 18:15:21 UTC">on 2016-01-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4546358/+files/socket-leak-4.diff">socket-leak-4.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4546358">Edit</a>
        (6.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Let&#x27;s try this again, only without the leftover print statements.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Let's try this again, only without the leftover print statements.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-11T15:09:32.936182+00:00" title="2016-01-11 15:09:32 UTC">on 2016-01-11</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@swift-coresec, please review proposed patch in comment #38. Thanks!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@swift-coresec, please review proposed patch in comment #38. Thanks!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~notmyname" class="sprite person">John Dickinson (notmyname)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-12T00:20:03.825784+00:00" title="2016-01-12 00:20:03 UTC">on 2016-01-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+2 from me</p>
<p>great work, Sam and Kota</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+2 from me

great work, Sam and Kota</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~matt-0" class="sprite person">Matthew Oliver (matt-0)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-12T06:55:34.005467+00:00" title="2016-01-12 06:55:34 UTC">on 2016-01-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+2 from me too, code looks good and test is working.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+2 from me too, code looks good and test is working.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-12T14:43:39.905466+00:00" title="2016-01-12 14:43:39 UTC">on 2016-01-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The patch seems pretty trivial, would it be possible to get backports for stable/kilo and liberty release too ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The patch seems pretty trivial, would it be possible to get backports for stable/kilo and liberty release too ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-13T02:03:30.920336+00:00" title="2016-01-13 02:03:30 UTC">on 2016-01-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4548894/+files/socket-leak-kilo-backport.diff">socket-leak-kilo-backport.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4548894">Edit</a>
        (6.6 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>kilo</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">kilo</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-13T02:03:52.629305+00:00" title="2016-01-13 02:03:52 UTC">on 2016-01-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4548896/+files/socket-leak-liberty-backport.diff">socket-leak-liberty-backport.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4548896">Edit</a>
        (6.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>liberty</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">liberty</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-13T02:59:02.885087+00:00" title="2016-01-13 02:59:02 UTC">on 2016-01-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Samuel.</p>
<p>So iirc, the last three patches only fixe the proxy to server connection leak. For client to proxy leak (<a href="/bugs/1466549" class="bug-link">bug 1466549</a>) the fix only got merged for stable/liberty. The missing stable/kilo backport is proposed here: <a rel="nofollow" href="https://review.openstack.org/#/c/217750/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />217750/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Samuel.

So iirc, the last three patches only fixe the proxy to server connection leak. For client to proxy leak (bug 1466549) the fix only got merged for stable/liberty. The missing stable/kilo backport is proposed here: https://review.openstack.org/#/c/217750/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-13T14:47:07.030897+00:00" title="2016-01-13 14:47:07 UTC">on 2016-01-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@swift-coresec, any chance to get <a rel="nofollow" href="https://review.openstack.org/#/c/217750/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />217750/</a> merged before sending the advance notification ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@swift-coresec, any chance to get https://review.openstack.org/#/c/217750/ merged before sending the advance notification ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/47" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T14:13:58.534258+00:00" title="2016-01-14 14:13:58 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/47"> #47</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is the final impact description for both <a href="/bugs/1493303" class="bug-link">bug 1493303</a> and <a href="/bugs/1466549" class="bug-link">bug 1466549</a>,<br />
If it&#x27;s accurate, I&#x27;d like to send the advance notification asap with a disclosure date set to:<br />
2016-01-20, 1500UTC</p>
<p>Title: Swift proxy-server DoS through Large Object<br />
Reporter: Romain LE DISEZ (OVH), Örjan Persson (Kiliaro)<br />
Products: Swift<br />
Affects: client to proxy: &gt;=2.2.1 &lt;= 2.3.0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy to server: &gt;=2.2.1 &lt;= 2.3.0, &gt;= 2.4.0 &lt;= 2.5.0</p>
<p>Description:<br />
Romain LE DISEZ from OVH and Örjan Persson from Kiliaro independently<br />
reported two vulnerabilities in Swift Large Object. By repeatedly<br />
requesting and interrupting connections to a Large Object (Dynamic or<br />
Static) URL, a remote attacker may exhausts Swift proxy-server<br />
resources, potentially resulting in a denial of service. Note that there<br />
are two distinct bugs that can exhaust proxy resources, one for client<br />
connection (client to proxy), one for servers connection (proxy to<br />
server). All Swift setup are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is the final impact description for both bug 1493303 and bug 1466549,
If it's accurate, I'd like to send the advance notification asap with a disclosure date set to:
2016-01-20, 1500UTC

Title: Swift proxy-server DoS through Large Object
Reporter: Romain LE DISEZ (OVH), Örjan Persson (Kiliaro)
Products: Swift
Affects: client to proxy: &gt;=2.2.1 &lt;= 2.3.0
         proxy to server: &gt;=2.2.1 &lt;= 2.3.0, &gt;= 2.4.0 &lt;= 2.5.0

Description:
Romain LE DISEZ from OVH and Örjan Persson from Kiliaro independently
reported two vulnerabilities in Swift Large Object. By repeatedly
requesting and interrupting connections to a Large Object (Dynamic or
Static) URL, a remote attacker may exhausts Swift proxy-server
resources, potentially resulting in a denial of service. Note that there
are two distinct bugs that can exhaust proxy resources, one for client
connection (client to proxy), one for servers connection (proxy to
server). All Swift setup are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2016-01-14 14:58:46 UTC" datetime="2016-01-14T14:58:46.220186+00:00">on 2016-01-14</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Swift proxy memory leak on unfinished read<br />+ Swift proxy memory leak on unfinished read (CVE-2016-0738)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/48" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alistair-coles" class="sprite person">Alistair Coles (alistair-coles)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T15:05:29.591227+00:00" title="2016-01-14 15:05:29 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/48">
                <strong>Re: Swift proxy memory leak on unfinished read (CVE-2016-0738)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/48"> #48</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+2 for patch at #38 applied to master. Verified that this fixes socket leak with early-terminated dlo and slo downloads (on SAIO on Ubuntu 14.04.2)</p>
<p>There&#x27;s no test for DLO. Not a blocker and possibly redundant since ultimately it is the close call to SegmentedIterable that is being tested.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+2 for patch at #38 applied to master. Verified that this fixes socket leak with early-terminated dlo and slo downloads (on SAIO on Ubuntu 14.04.2)

There's no test for DLO. Not a blocker and possibly redundant since ultimately it is the close call to SegmentedIterable that is being tested.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/49" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alistair-coles" class="sprite person">Alistair Coles (alistair-coles)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T15:14:13.639326+00:00" title="2016-01-14 15:14:13 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/49"> #49</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+2 for the liberty backport at #44</p>
<p>I could not apply the kilo backport at #43:</p>
<p>anc@u128:<wbr />~/0dev/<wbr />swift ((036c2f3...))$ git checkout origin/stable/kilo<br />
HEAD is now at 036c2f3... Get better at closing WSGI iterables.<br />
anc@u128:<wbr />~/0dev/<wbr />swift ((036c2f3...))$ git am ../patches/<wbr />socket-<wbr />leak-kilo-<wbr />backport.<wbr />diff<br />
Applying: Fix memory/socket leak in proxy on truncated SLO/DLO GET<br />
error: patch failed: swift/common/<wbr />request_<wbr />helpers.<wbr />py:431<br />
error: swift/common/<wbr />request_<wbr />helpers.<wbr />py: patch does not apply<br />
Patch failed at 0001 Fix memory/socket leak in proxy on truncated SLO/DLO GET<br />
The copy of the patch that failed is found in:<br />
&nbsp;&nbsp;&nbsp;/home/<wbr />anc/0dev/<wbr />swift/.<wbr />git/rebase-<wbr />apply/patch<br />
When you have resolved this problem, run &quot;git am --continue&quot;.<br />
If you prefer to skip this patch, run &quot;git am --skip&quot; instead.<br />
To restore the original branch and stop patching, run &quot;git am --abort&quot;.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+2 for the liberty backport at #44

I could not apply the kilo backport at #43:

anc@u128:~/0dev/swift ((036c2f3...))$ git checkout origin/stable/kilo
HEAD is now at 036c2f3... Get better at closing WSGI iterables.
anc@u128:~/0dev/swift ((036c2f3...))$ git am ../patches/socket-leak-kilo-backport.diff
Applying: Fix memory/socket leak in proxy on truncated SLO/DLO GET
error: patch failed: swift/common/request_helpers.py:431
error: swift/common/request_helpers.py: patch does not apply
Patch failed at 0001 Fix memory/socket leak in proxy on truncated SLO/DLO GET
The copy of the patch that failed is found in:
   /home/anc/0dev/swift/.git/rebase-apply/patch
When you have resolved this problem, run "git am --continue".
If you prefer to skip this patch, run "git am --skip" instead.
To restore the original branch and stop patching, run "git am --abort".</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/50" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T15:18:56.639680+00:00" title="2016-01-14 15:18:56 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/50"> #50</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Oups, their is now a conflict for stable/kilo backport (proposed in comment #43).</p>
<p>This patch do: in swift/common/<wbr />request_<wbr />helpers.<wbr />py<br />
+    def close(self):<br />
+        &quot;&quot;&quot;<br />
+        Called when the client disconnect. Ensure that the connection to the<br />
+        backend server is closed.<br />
+        &quot;&quot;&quot;<br />
+        close_if_<wbr />possible(<wbr />self.app_<wbr />iter)</p>
<p>While current stable/kilo has:<br />
&nbsp;&nbsp;&nbsp;&nbsp;def close(self):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called when the client disconnect. Ensure that the connection to the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backend server is closed.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.current_resp:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close_<wbr />if_possible(<wbr />self.current_<wbr />resp.app_<wbr />iter)</p>
<p>Samuel, can you please fix that backport?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Oups, their is now a conflict for stable/kilo backport (proposed in comment #43).

This patch do: in swift/common/request_helpers.py
+    def close(self):
+        """
+        Called when the client disconnect. Ensure that the connection to the
+        backend server is closed.
+        """
+        close_if_possible(self.app_iter)

While current stable/kilo has:
    def close(self):
        """         
        Called when the client disconnect. Ensure that the connection to the
        backend server is closed.
        """         
        if self.current_resp:
            close_if_possible(self.current_resp.app_iter)



Samuel, can you please fix that backport?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/51" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~alistair-coles" class="sprite person">Alistair Coles (alistair-coles)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T16:18:17.404958+00:00" title="2016-01-14 16:18:17 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/51"> #51</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4549968/+files/socket-leak-kilo-backport-2.diff">socket-leak-kilo-backport-2.diff</a>
        <a class="sprite edit action-icon" href="/cloud-archive/+bug/1493303/+attachment/4549968">Edit</a>
        (6.3 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think I fixed the conflict with stable/kilo (at 036c2f3) in the attached patch</p>
<p>Sam had better take a look at it to be sure. 036c2f3 added stuff that seemed to allow this patch to be closer to the others i.e. self.current_resp</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think I fixed the conflict with stable/kilo (at 036c2f3) in the attached patch

Sam had better take a look at it to be sure. 036c2f3 added stuff that seemed to allow this patch to be closer to the others i.e. self.current_resp</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/52" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~torgomatic" class="sprite person">Samuel Merritt (torgomatic)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T16:36:06.267551+00:00" title="2016-01-14 16:36:06 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/52"> #52</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The patch in #51 looks good to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The patch in #51 looks good to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/53" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-14T16:49:01.940935+00:00" title="2016-01-14 16:49:01 UTC">on 2016-01-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/53"> #53</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The patch in comment #51 works for me. To sum-up, the upcoming advisory needs those patch to be applied:</p>
<p>&nbsp;- <a rel="nofollow" href="https://review.openstack.org/#/c/217750/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />217750/</a>   (the stable/kilo backport for <a href="/bugs/1466549" class="bug-link">bug 1466549</a>)<br />
&nbsp;- patch in comment #51 (the stable/kilo backport of this bug)<br />
&nbsp;- patch in comment #44 (the stable/liberty backport of this bug)<br />
&nbsp;- patch in comment #38 (the master/mitaka fix of this bug)</p>
<p>No need for stable/liberty or master/mitaka fix for <a href="/bugs/1466549" class="bug-link">bug 1466549</a> since liberty release already has this fix.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The patch in comment #51 works for me. To sum-up, the upcoming advisory needs those patch to be applied:

 - https://review.openstack.org/#/c/217750/   (the stable/kilo backport for bug 1466549)
 - patch in comment #51 (the stable/kilo backport of this bug)
 - patch in comment #44 (the stable/liberty backport of this bug)
 - patch in comment #38 (the master/mitaka fix of this bug)

No need for stable/liberty or master/mitaka fix for bug 1466549 since liberty release already has this fix.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2016-01-14 17:48:41 UTC" datetime="2016-01-14T17:48:41.262715+00:00">on 2016-01-14</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2016-01-20 14:59:18 UTC" datetime="2016-01-20T14:59:18.245502+00:00">on 2016-01-20</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Swift proxy memory leak on unfinished read (CVE-2016-0738)<br />+ [OSSA 2016-004] Swift proxy memory leak on unfinished read<br />+ (CVE-2016-0738)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/54" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-20T15:01:07.470094+00:00" title="2016-01-20 15:01:07 UTC">on 2016-01-20</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/54">
                <strong>Fix proposed to swift (stable/kilo)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/54"> #54</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/kilo<br />
Review: <a rel="nofollow" href="https://review.openstack.org/270234">https:/<wbr />/review.<wbr />openstack.<wbr />org/270234</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/270234</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/55" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-20T15:01:15.525818+00:00" title="2016-01-20 15:01:15 UTC">on 2016-01-20</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/55">
                <strong>Fix proposed to swift (stable/liberty)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/55"> #55</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/liberty<br />
Review: <a rel="nofollow" href="https://review.openstack.org/270235">https:/<wbr />/review.<wbr />openstack.<wbr />org/270235</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/270235</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/56" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-20T15:19:33.406087+00:00" title="2016-01-20 15:19:33 UTC">on 2016-01-20</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/56">
                <strong>Related fix proposed to ossa (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/56"> #56</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Related fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.openstack.org/270241">https:/<wbr />/review.<wbr />openstack.<wbr />org/270241</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Related fix proposed to branch: master
Review: https://review.openstack.org/270241</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/57" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~crichton" class="sprite person">Ubuntu Foundations Team Bug Bot (crichton)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-20T16:22:03.156711+00:00" title="2016-01-20 16:22:03 UTC">on 2016-01-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/57"> #57</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The attachment &quot;leakpatch-1.diff&quot; seems to be a patch.  If it isn&#x27;t, please remove the &quot;patch&quot; flag from the attachment, remove the &quot;patch&quot; tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.</p>
<p>[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The attachment "leakpatch-1.diff" seems to be a patch.  If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: patch
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/58" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-22T03:40:00.390142+00:00" title="2016-01-22 03:40:00 UTC">on 2016-01-22</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/58">
                <strong>Fix merged to swift (stable/kilo)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/58"> #58</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/270234">https:/<wbr />/review.<wbr />openstack.<wbr />org/270234</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/swift/commit/?id=a4c1825a026655b7ed21d779824ae7c25318fd52">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />swift/commit/<wbr />?id=a4c1825a026<wbr />655b7ed21d77982<wbr />4ae7c25318fd52</a><br />
Submitter: Jenkins<br />
Branch:    stable/kilo</p>
<p>commit a4c1825a026655b<wbr />7ed21d779824ae7<wbr />c25318fd52<br />
Author: Samuel Merritt &lt;email address hidden&gt;<br />
Date:   Tue Dec 8 16:36:05 2015 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fix memory/socket leak in proxy on truncated SLO/DLO GET</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnected while consuming an SLO or DLO GET response,<br />
&nbsp;&nbsp;&nbsp;&nbsp;the proxy would leak a socket. This could be observed via strace as a<br />
&nbsp;&nbsp;&nbsp;&nbsp;socket that had shutdown() called on it, but was never closed. It<br />
&nbsp;&nbsp;&nbsp;&nbsp;could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pid&gt; is the pid of a proxy server worker process.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This is due to a memory leak in SegmentedIterable. A SegmentedIterable<br />
&nbsp;&nbsp;&nbsp;&nbsp;has an &#x27;app_iter&#x27; attribute, which is a generator. That generator<br />
&nbsp;&nbsp;&nbsp;&nbsp;references &#x27;self&#x27; (the SegmentedIterable object). This creates a<br />
&nbsp;&nbsp;&nbsp;&nbsp;cyclic reference: the generator refers to the SegmentedIterable, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the SegmentedIterable refers to the generator.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Python can normally handle cyclic garbage; reference counting won&#x27;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;reclaim it, but the garbage collector will. However, objects with<br />
&nbsp;&nbsp;&nbsp;&nbsp;finalizers will stop the garbage collector from collecting them* and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the cycle of which they are part.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For most objects, &quot;has finalizer&quot; is synonymous with &quot;has a __del__<br />
&nbsp;&nbsp;&nbsp;&nbsp;method&quot;. However, a generator has a finalizer once it&#x27;s started<br />
&nbsp;&nbsp;&nbsp;&nbsp;running and before it finishes: basically, while it has stack frames<br />
&nbsp;&nbsp;&nbsp;&nbsp;associated with it**.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnects mid-stream, we get a memory leak. We have<br />
&nbsp;&nbsp;&nbsp;&nbsp;our SegmentedIterable object (call it &quot;si&quot;), and its associated<br />
&nbsp;&nbsp;&nbsp;&nbsp;generator. si.app_iter is the generator, and the generator closes over<br />
&nbsp;&nbsp;&nbsp;&nbsp;si, so we have a cycle; and the generator has started but not yet<br />
&nbsp;&nbsp;&nbsp;&nbsp;finished, so the generator needs finalization; hence, the garbage<br />
&nbsp;&nbsp;&nbsp;&nbsp;collector won&#x27;t ever clean it up.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The socket leak comes in because the generator *also* refers to the<br />
&nbsp;&nbsp;&nbsp;&nbsp;request&#x27;s WSGI environment, which contains wsgi.input, which<br />
&nbsp;&nbsp;&nbsp;&nbsp;ultimately refers to a _socket object from the standard<br />
&nbsp;&nbsp;&nbsp;&nbsp;library. Python&#x27;s _socket objects only close their underlying file<br />
&nbsp;&nbsp;&nbsp;&nbsp;descriptor when their reference counts fall to 0***.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This commit makes SegmentedIterab<wbr />le.close(<wbr />) call<br />
&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />app_iter.<wbr />close()<wbr />, thereby unwinding its generator&#x27;s stack and<br />
&nbsp;&nbsp;&nbsp;&nbsp;making it eligible for garbage collection.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;* in Python &lt; 3.4, at least. See PEP 442.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;** see PyGen_NeedsFina<wbr />lizing(<wbr />) in Objects/genobject.c and also<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />has_finalizer(<wbr />) in Modules/gcmodule.c in Python.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;*** see sock_dealloc() in Modules/<wbr />socketmodule.<wbr />c in Python. See<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;sock_close(<wbr />) in the same file for the other half of the sad story.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This closes CVE-2016-0738.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1493303</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I9b617bfc152dca<wbr />40d1750131d1d81<wbr />4d85c0a88dd<br />
&nbsp;&nbsp;&nbsp;&nbsp;Co-Authored-By: Kota Tsuyuzaki &lt;email address hidden&gt;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/270234
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=a4c1825a026655b7ed21d779824ae7c25318fd52
Submitter: Jenkins
Branch:    stable/kilo

commit a4c1825a026655b7ed21d779824ae7c25318fd52
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Dec 8 16:36:05 2015 -0800

    Fix memory/socket leak in proxy on truncated SLO/DLO GET
    
    When a client disconnected while consuming an SLO or DLO GET response,
    the proxy would leak a socket. This could be observed via strace as a
    socket that had shutdown() called on it, but was never closed. It
    could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where
    &lt;pid&gt; is the pid of a proxy server worker process.
    
    This is due to a memory leak in SegmentedIterable. A SegmentedIterable
    has an 'app_iter' attribute, which is a generator. That generator
    references 'self' (the SegmentedIterable object). This creates a
    cyclic reference: the generator refers to the SegmentedIterable, and
    the SegmentedIterable refers to the generator.
    
    Python can normally handle cyclic garbage; reference counting won't
    reclaim it, but the garbage collector will. However, objects with
    finalizers will stop the garbage collector from collecting them* and
    the cycle of which they are part.
    
    For most objects, "has finalizer" is synonymous with "has a __del__
    method". However, a generator has a finalizer once it's started
    running and before it finishes: basically, while it has stack frames
    associated with it**.
    
    When a client disconnects mid-stream, we get a memory leak. We have
    our SegmentedIterable object (call it "si"), and its associated
    generator. si.app_iter is the generator, and the generator closes over
    si, so we have a cycle; and the generator has started but not yet
    finished, so the generator needs finalization; hence, the garbage
    collector won't ever clean it up.
    
    The socket leak comes in because the generator *also* refers to the
    request's WSGI environment, which contains wsgi.input, which
    ultimately refers to a _socket object from the standard
    library. Python's _socket objects only close their underlying file
    descriptor when their reference counts fall to 0***.
    
    This commit makes SegmentedIterable.close() call
    self.app_iter.close(), thereby unwinding its generator's stack and
    making it eligible for garbage collection.
    
    * in Python &lt; 3.4, at least. See PEP 442.
    
    ** see PyGen_NeedsFinalizing() in Objects/genobject.c and also
       has_finalizer() in Modules/gcmodule.c in Python.
    
    *** see sock_dealloc() in Modules/socketmodule.c in Python. See
        sock_close() in the same file for the other half of the sad story.
    
    This closes CVE-2016-0738.
    
    Closes-Bug: 1493303
    
    Change-Id: I9b617bfc152dca40d1750131d1d814d85c0a88dd
    Co-Authored-By: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-kilo
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-liberty
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/59" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-22T03:41:04.540725+00:00" title="2016-01-22 03:41:04 UTC">on 2016-01-22</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/59">
                <strong>Fix merged to swift (stable/liberty)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/59"> #59</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/270235">https:/<wbr />/review.<wbr />openstack.<wbr />org/270235</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/swift/commit/?id=8c1976aa771f8c43c5dbe676bd9a5efc69f09eae">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />swift/commit/<wbr />?id=8c1976aa771<wbr />f8c43c5dbe676bd<wbr />9a5efc69f09eae</a><br />
Submitter: Jenkins<br />
Branch:    stable/liberty</p>
<p>commit 8c1976aa771f8c4<wbr />3c5dbe676bd9a5e<wbr />fc69f09eae<br />
Author: Samuel Merritt &lt;email address hidden&gt;<br />
Date:   Tue Dec 8 16:36:05 2015 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fix memory/socket leak in proxy on truncated SLO/DLO GET</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnected while consuming an SLO or DLO GET response,<br />
&nbsp;&nbsp;&nbsp;&nbsp;the proxy would leak a socket. This could be observed via strace as a<br />
&nbsp;&nbsp;&nbsp;&nbsp;socket that had shutdown() called on it, but was never closed. It<br />
&nbsp;&nbsp;&nbsp;&nbsp;could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pid&gt; is the pid of a proxy server worker process.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This is due to a memory leak in SegmentedIterable. A SegmentedIterable<br />
&nbsp;&nbsp;&nbsp;&nbsp;has an &#x27;app_iter&#x27; attribute, which is a generator. That generator<br />
&nbsp;&nbsp;&nbsp;&nbsp;references &#x27;self&#x27; (the SegmentedIterable object). This creates a<br />
&nbsp;&nbsp;&nbsp;&nbsp;cyclic reference: the generator refers to the SegmentedIterable, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the SegmentedIterable refers to the generator.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Python can normally handle cyclic garbage; reference counting won&#x27;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;reclaim it, but the garbage collector will. However, objects with<br />
&nbsp;&nbsp;&nbsp;&nbsp;finalizers will stop the garbage collector from collecting them* and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the cycle of which they are part.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For most objects, &quot;has finalizer&quot; is synonymous with &quot;has a __del__<br />
&nbsp;&nbsp;&nbsp;&nbsp;method&quot;. However, a generator has a finalizer once it&#x27;s started<br />
&nbsp;&nbsp;&nbsp;&nbsp;running and before it finishes: basically, while it has stack frames<br />
&nbsp;&nbsp;&nbsp;&nbsp;associated with it**.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnects mid-stream, we get a memory leak. We have<br />
&nbsp;&nbsp;&nbsp;&nbsp;our SegmentedIterable object (call it &quot;si&quot;), and its associated<br />
&nbsp;&nbsp;&nbsp;&nbsp;generator. si.app_iter is the generator, and the generator closes over<br />
&nbsp;&nbsp;&nbsp;&nbsp;si, so we have a cycle; and the generator has started but not yet<br />
&nbsp;&nbsp;&nbsp;&nbsp;finished, so the generator needs finalization; hence, the garbage<br />
&nbsp;&nbsp;&nbsp;&nbsp;collector won&#x27;t ever clean it up.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The socket leak comes in because the generator *also* refers to the<br />
&nbsp;&nbsp;&nbsp;&nbsp;request&#x27;s WSGI environment, which contains wsgi.input, which<br />
&nbsp;&nbsp;&nbsp;&nbsp;ultimately refers to a _socket object from the standard<br />
&nbsp;&nbsp;&nbsp;&nbsp;library. Python&#x27;s _socket objects only close their underlying file<br />
&nbsp;&nbsp;&nbsp;&nbsp;descriptor when their reference counts fall to 0***.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This commit makes SegmentedIterab<wbr />le.close(<wbr />) call<br />
&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />app_iter.<wbr />close()<wbr />, thereby unwinding its generator&#x27;s stack and<br />
&nbsp;&nbsp;&nbsp;&nbsp;making it eligible for garbage collection.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;* in Python &lt; 3.4, at least. See PEP 442.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;** see PyGen_NeedsFina<wbr />lizing(<wbr />) in Objects/genobject.c and also<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />has_finalizer(<wbr />) in Modules/gcmodule.c in Python.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;*** see sock_dealloc() in Modules/<wbr />socketmodule.<wbr />c in Python. See<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;sock_close(<wbr />) in the same file for the other half of the sad story.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This closes CVE-2016-0738.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1493303</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I74ea49eaa7d5c3<wbr />72cdc2399148d54<wbr />95d3007dbd0<br />
&nbsp;&nbsp;&nbsp;&nbsp;Co-Authored-By: Kota Tsuyuzaki &lt;email address hidden&gt;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/270235
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=8c1976aa771f8c43c5dbe676bd9a5efc69f09eae
Submitter: Jenkins
Branch:    stable/liberty

commit 8c1976aa771f8c43c5dbe676bd9a5efc69f09eae
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Dec 8 16:36:05 2015 -0800

    Fix memory/socket leak in proxy on truncated SLO/DLO GET
    
    When a client disconnected while consuming an SLO or DLO GET response,
    the proxy would leak a socket. This could be observed via strace as a
    socket that had shutdown() called on it, but was never closed. It
    could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where
    &lt;pid&gt; is the pid of a proxy server worker process.
    
    This is due to a memory leak in SegmentedIterable. A SegmentedIterable
    has an 'app_iter' attribute, which is a generator. That generator
    references 'self' (the SegmentedIterable object). This creates a
    cyclic reference: the generator refers to the SegmentedIterable, and
    the SegmentedIterable refers to the generator.
    
    Python can normally handle cyclic garbage; reference counting won't
    reclaim it, but the garbage collector will. However, objects with
    finalizers will stop the garbage collector from collecting them* and
    the cycle of which they are part.
    
    For most objects, "has finalizer" is synonymous with "has a __del__
    method". However, a generator has a finalizer once it's started
    running and before it finishes: basically, while it has stack frames
    associated with it**.
    
    When a client disconnects mid-stream, we get a memory leak. We have
    our SegmentedIterable object (call it "si"), and its associated
    generator. si.app_iter is the generator, and the generator closes over
    si, so we have a cycle; and the generator has started but not yet
    finished, so the generator needs finalization; hence, the garbage
    collector won't ever clean it up.
    
    The socket leak comes in because the generator *also* refers to the
    request's WSGI environment, which contains wsgi.input, which
    ultimately refers to a _socket object from the standard
    library. Python's _socket objects only close their underlying file
    descriptor when their reference counts fall to 0***.
    
    This commit makes SegmentedIterable.close() call
    self.app_iter.close(), thereby unwinding its generator's stack and
    making it eligible for garbage collection.
    
    * in Python &lt; 3.4, at least. See PEP 442.
    
    ** see PyGen_NeedsFinalizing() in Objects/genobject.c and also
       has_finalizer() in Modules/gcmodule.c in Python.
    
    *** see sock_dealloc() in Modules/socketmodule.c in Python. See
        sock_close() in the same file for the other half of the sad story.
    
    This closes CVE-2016-0738.
    
    Closes-Bug: 1493303
    
    Change-Id: I74ea49eaa7d5c372cdc2399148d5495d3007dbd0
    Co-Authored-By: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/60" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-22T03:41:14.345222+00:00" title="2016-01-22 03:41:14 UTC">on 2016-01-22</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/60">
                <strong>Fix merged to swift (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/60"> #60</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/270233">https:/<wbr />/review.<wbr />openstack.<wbr />org/270233</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/swift/commit/?id=58359269b0e971e52f0eb7f97221566ca2148014">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />swift/commit/<wbr />?id=58359269b0e<wbr />971e52f0eb7f972<wbr />21566ca2148014</a><br />
Submitter: Jenkins<br />
Branch:    master</p>
<p>commit 58359269b0e971e<wbr />52f0eb7f9722156<wbr />6ca2148014<br />
Author: Samuel Merritt &lt;email address hidden&gt;<br />
Date:   Tue Dec 8 16:36:05 2015 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fix memory/socket leak in proxy on truncated SLO/DLO GET</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnected while consuming an SLO or DLO GET response,<br />
&nbsp;&nbsp;&nbsp;&nbsp;the proxy would leak a socket. This could be observed via strace as a<br />
&nbsp;&nbsp;&nbsp;&nbsp;socket that had shutdown() called on it, but was never closed. It<br />
&nbsp;&nbsp;&nbsp;&nbsp;could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pid&gt; is the pid of a proxy server worker process.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This is due to a memory leak in SegmentedIterable. A SegmentedIterable<br />
&nbsp;&nbsp;&nbsp;&nbsp;has an &#x27;app_iter&#x27; attribute, which is a generator. That generator<br />
&nbsp;&nbsp;&nbsp;&nbsp;references &#x27;self&#x27; (the SegmentedIterable object). This creates a<br />
&nbsp;&nbsp;&nbsp;&nbsp;cyclic reference: the generator refers to the SegmentedIterable, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the SegmentedIterable refers to the generator.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Python can normally handle cyclic garbage; reference counting won&#x27;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;reclaim it, but the garbage collector will. However, objects with<br />
&nbsp;&nbsp;&nbsp;&nbsp;finalizers will stop the garbage collector from collecting them* and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the cycle of which they are part.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For most objects, &quot;has finalizer&quot; is synonymous with &quot;has a __del__<br />
&nbsp;&nbsp;&nbsp;&nbsp;method&quot;. However, a generator has a finalizer once it&#x27;s started<br />
&nbsp;&nbsp;&nbsp;&nbsp;running and before it finishes: basically, while it has stack frames<br />
&nbsp;&nbsp;&nbsp;&nbsp;associated with it**.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnects mid-stream, we get a memory leak. We have<br />
&nbsp;&nbsp;&nbsp;&nbsp;our SegmentedIterable object (call it &quot;si&quot;), and its associated<br />
&nbsp;&nbsp;&nbsp;&nbsp;generator. si.app_iter is the generator, and the generator closes over<br />
&nbsp;&nbsp;&nbsp;&nbsp;si, so we have a cycle; and the generator has started but not yet<br />
&nbsp;&nbsp;&nbsp;&nbsp;finished, so the generator needs finalization; hence, the garbage<br />
&nbsp;&nbsp;&nbsp;&nbsp;collector won&#x27;t ever clean it up.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The socket leak comes in because the generator *also* refers to the<br />
&nbsp;&nbsp;&nbsp;&nbsp;request&#x27;s WSGI environment, which contains wsgi.input, which<br />
&nbsp;&nbsp;&nbsp;&nbsp;ultimately refers to a _socket object from the standard<br />
&nbsp;&nbsp;&nbsp;&nbsp;library. Python&#x27;s _socket objects only close their underlying file<br />
&nbsp;&nbsp;&nbsp;&nbsp;descriptor when their reference counts fall to 0***.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This commit makes SegmentedIterab<wbr />le.close(<wbr />) call<br />
&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />app_iter.<wbr />close()<wbr />, thereby unwinding its generator&#x27;s stack and<br />
&nbsp;&nbsp;&nbsp;&nbsp;making it eligible for garbage collection.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;* in Python &lt; 3.4, at least. See PEP 442.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;** see PyGen_NeedsFina<wbr />lizing(<wbr />) in Objects/genobject.c and also<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />has_finalizer(<wbr />) in Modules/gcmodule.c in Python.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;*** see sock_dealloc() in Modules/<wbr />socketmodule.<wbr />c in Python. See<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;sock_close(<wbr />) in the same file for the other half of the sad story.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This closes CVE-2016-0738.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1493303</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Co-Authored-By: Kota Tsuyuzaki &lt;email address hidden&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Ib86c4c45641485<wbr />ce1034212bf6f53<wbr />bb84f02f612</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/270233
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=58359269b0e971e52f0eb7f97221566ca2148014
Submitter: Jenkins
Branch:    master

commit 58359269b0e971e52f0eb7f97221566ca2148014
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Dec 8 16:36:05 2015 -0800

    Fix memory/socket leak in proxy on truncated SLO/DLO GET
    
    When a client disconnected while consuming an SLO or DLO GET response,
    the proxy would leak a socket. This could be observed via strace as a
    socket that had shutdown() called on it, but was never closed. It
    could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where
    &lt;pid&gt; is the pid of a proxy server worker process.
    
    This is due to a memory leak in SegmentedIterable. A SegmentedIterable
    has an 'app_iter' attribute, which is a generator. That generator
    references 'self' (the SegmentedIterable object). This creates a
    cyclic reference: the generator refers to the SegmentedIterable, and
    the SegmentedIterable refers to the generator.
    
    Python can normally handle cyclic garbage; reference counting won't
    reclaim it, but the garbage collector will. However, objects with
    finalizers will stop the garbage collector from collecting them* and
    the cycle of which they are part.
    
    For most objects, "has finalizer" is synonymous with "has a __del__
    method". However, a generator has a finalizer once it's started
    running and before it finishes: basically, while it has stack frames
    associated with it**.
    
    When a client disconnects mid-stream, we get a memory leak. We have
    our SegmentedIterable object (call it "si"), and its associated
    generator. si.app_iter is the generator, and the generator closes over
    si, so we have a cycle; and the generator has started but not yet
    finished, so the generator needs finalization; hence, the garbage
    collector won't ever clean it up.
    
    The socket leak comes in because the generator *also* refers to the
    request's WSGI environment, which contains wsgi.input, which
    ultimately refers to a _socket object from the standard
    library. Python's _socket objects only close their underlying file
    descriptor when their reference counts fall to 0***.
    
    This commit makes SegmentedIterable.close() call
    self.app_iter.close(), thereby unwinding its generator's stack and
    making it eligible for garbage collection.
    
    * in Python &lt; 3.4, at least. See PEP 442.
    
    ** see PyGen_NeedsFinalizing() in Objects/genobject.c and also
       has_finalizer() in Modules/gcmodule.c in Python.
    
    *** see sock_dealloc() in Modules/socketmodule.c in Python. See
        sock_close() in the same file for the other half of the sad story.
    
    This closes CVE-2016-0738.
    
    Closes-Bug: 1493303
    
    Co-Authored-By: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
    
    Change-Id: Ib86c4c45641485ce1034212bf6f53bb84f02f612
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2016-01-25 15:01:08 UTC" datetime="2016-01-25T15:01:08.330638+00:00">on 2016-01-25</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/61" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~doug-hellmann" class="sprite person">Doug Hellmann (doug-hellmann)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-25T16:29:10.001670+00:00" title="2016-01-25 16:29:10 UTC">on 2016-01-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/61">
                <strong>Fix included in openstack/swift 2.6.0</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/61"> #61</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This issue was fixed in the openstack/swift 2.6.0 release.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This issue was fixed in the openstack/swift 2.6.0 release.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/62" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-25T17:48:25.924983+00:00" title="2016-01-25 17:48:25 UTC">on 2016-01-25</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/62">
                <strong>Fix proposed to swift (feature/crypto)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/62"> #62</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: feature/crypto<br />
Review: <a rel="nofollow" href="https://review.openstack.org/272201">https:/<wbr />/review.<wbr />openstack.<wbr />org/272201</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: feature/crypto
Review: https://review.openstack.org/272201</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/63" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-26T14:14:55.876292+00:00" title="2016-01-26 14:14:55 UTC">on 2016-01-26</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/63">
                <strong>Fix merged to swift (feature/crypto)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/63"> #63</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  <a href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/comments/63/+download">Download full text</a> (30.2 KiB)
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/272201">https:/<wbr />/review.<wbr />openstack.<wbr />org/272201</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/swift/commit/?id=f9b7fd3074b5b0e5d6ea879d4144f7bfeec5d46b">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />swift/commit/<wbr />?id=f9b7fd3074b<wbr />5b0e5d6ea879d41<wbr />44f7bfeec5d46b</a><br />
Submitter: Jenkins<br />
Branch:    feature/crypto</p>
<p>commit e13a03c379273ee<wbr />10e678818078b9c<wbr />40a96a7dc9<br />
Author: Tim Burke &lt;email address hidden&gt;<br />
Date:   Wed Jan 20 16:06:26 2016 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Stop overriding builtin range</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I315f8b554bb9e9<wbr />6659b455f4158f0<wbr />74961bd6498</p>
<p>commit 0a404def7d54d1e<wbr />f1c85c11a378052<wbr />260c4fda4c<br />
Author: John Dickinson &lt;email address hidden&gt;<br />
Date:   Wed Jan 20 15:19:35 2016 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;remove unneeded duplicate dict keys</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I926d7aaa9df093<wbr />418aaae54fe26e8<wbr />f7bc8210645</p>
<p>commit 221f94fdd39fd2d<wbr />cd9a2e5565adcea<wbr />b615d55913<br />
Author: John Dickinson &lt;email address hidden&gt;<br />
Date:   Tue Jan 19 14:50:24 2016 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;authors and changelog updates for 2.6.0</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idd0ff9e70abc07<wbr />73be183c37cd612<wbr />5fe852da7c0</p>
<p>commit 58359269b0e971e<wbr />52f0eb7f9722156<wbr />6ca2148014<br />
Author: Samuel Merritt &lt;email address hidden&gt;<br />
Date:   Tue Dec 8 16:36:05 2015 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fix memory/socket leak in proxy on truncated SLO/DLO GET</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnected while consuming an SLO or DLO GET response,<br />
&nbsp;&nbsp;&nbsp;&nbsp;the proxy would leak a socket. This could be observed via strace as a<br />
&nbsp;&nbsp;&nbsp;&nbsp;socket that had shutdown() called on it, but was never closed. It<br />
&nbsp;&nbsp;&nbsp;&nbsp;could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pid&gt; is the pid of a proxy server worker process.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This is due to a memory leak in SegmentedIterable. A SegmentedIterable<br />
&nbsp;&nbsp;&nbsp;&nbsp;has an &#x27;app_iter&#x27; attribute, which is a generator. That generator<br />
&nbsp;&nbsp;&nbsp;&nbsp;references &#x27;self&#x27; (the SegmentedIterable object). This creates a<br />
&nbsp;&nbsp;&nbsp;&nbsp;cyclic reference: the generator refers to the SegmentedIterable, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the SegmentedIterable refers to the generator.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Python can normally handle cyclic garbage; reference counting won&#x27;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;reclaim it, but the garbage collector will. However, objects with<br />
&nbsp;&nbsp;&nbsp;&nbsp;finalizers will stop the garbage collector from collecting them* and<br />
&nbsp;&nbsp;&nbsp;&nbsp;the cycle of which they are part.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For most objects, &quot;has finalizer&quot; is synonymous with &quot;has a __del__<br />
&nbsp;&nbsp;&nbsp;&nbsp;method&quot;. However, a generator has a finalizer once it&#x27;s started<br />
&nbsp;&nbsp;&nbsp;&nbsp;running and before it finishes: basically, while it has stack frames<br />
&nbsp;&nbsp;&nbsp;&nbsp;associated with it**.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;When a client disconnects mid-stream, we get a memory leak. We have<br />
&nbsp;&nbsp;&nbsp;&nbsp;our SegmentedIterable object (call it &quot;si&quot;), and its associated<br />
&nbsp;&nbsp;&nbsp;&nbsp;generator. si.app_iter is the generator, and the generator closes over<br />
&nbsp;&nbsp;&nbsp;&nbsp;si, so we have a cycle; and the generator has started but not yet<br />
&nbsp;&nbsp;&nbsp;&nbsp;finished, so the generator needs finalization; hence, the garbage<br />
&nbsp;&nbsp;&nbsp;&nbsp;collector won&#x27;t ever clean it up.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The socket leak comes in because the generator *also* refers to the<br />
&nbsp;&nbsp;&nbsp;&nbsp;request&#x27;s WSGI environment, which contains wsgi.input, which<br />
&nbsp;&nbsp;&nbsp;&nbsp;ultimately refers to a _socket object from the standard<br />
&nbsp;&nbsp;&nbsp;&nbsp;library. Python&#x27;s _socket objects only close their underlying file<br />
&nbsp;&nbsp;&nbsp;&nbsp;descriptor when their reference counts fall to 0***.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This commit makes SegmentedIterab<wbr />le.close(<wbr />) call<br />
&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />app_iter.<wbr />close()<wbr />, thereby unwinding its generator&#x27;s stack and<br />
&nbsp;&nbsp;&nbsp;&nbsp;making it eligible for garbage collection.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;* in Python &lt; 3...</p></div>
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/272201
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=f9b7fd3074b5b0e5d6ea879d4144f7bfeec5d46b
Submitter: Jenkins
Branch:    feature/crypto

commit e13a03c379273ee10e678818078b9c40a96a7dc9
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Wed Jan 20 16:06:26 2016 -0800

    Stop overriding builtin range
    
    Change-Id: I315f8b554bb9e96659b455f4158f074961bd6498

commit 0a404def7d54d1ef1c85c11a378052260c4fda4c
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Wed Jan 20 15:19:35 2016 -0800

    remove unneeded duplicate dict keys
    
    Change-Id: I926d7aaa9df093418aaae54fe26e8f7bc8210645

commit 221f94fdd39fd2dcd9a2e5565adceab615d55913
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Tue Jan 19 14:50:24 2016 -0800

    authors and changelog updates for 2.6.0
    
    Change-Id: Idd0ff9e70abc0773be183c37cd6125fe852da7c0

commit 58359269b0e971e52f0eb7f97221566ca2148014
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Dec 8 16:36:05 2015 -0800

    Fix memory/socket leak in proxy on truncated SLO/DLO GET
    
    When a client disconnected while consuming an SLO or DLO GET response,
    the proxy would leak a socket. This could be observed via strace as a
    socket that had shutdown() called on it, but was never closed. It
    could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where
    &lt;pid&gt; is the pid of a proxy server worker process.
    
    This is due to a memory leak in SegmentedIterable. A SegmentedIterable
    has an 'app_iter' attribute, which is a generator. That generator
    references 'self' (the SegmentedIterable object). This creates a
    cyclic reference: the generator refers to the SegmentedIterable, and
    the SegmentedIterable refers to the generator.
    
    Python can normally handle cyclic garbage; reference counting won't
    reclaim it, but the garbage collector will. However, objects with
    finalizers will stop the garbage collector from collecting them* and
    the cycle of which they are part.
    
    For most objects, "has finalizer" is synonymous with "has a __del__
    method". However, a generator has a finalizer once it's started
    running and before it finishes: basically, while it has stack frames
    associated with it**.
    
    When a client disconnects mid-stream, we get a memory leak. We have
    our SegmentedIterable object (call it "si"), and its associated
    generator. si.app_iter is the generator, and the generator closes over
    si, so we have a cycle; and the generator has started but not yet
    finished, so the generator needs finalization; hence, the garbage
    collector won't ever clean it up.
    
    The socket leak comes in because the generator *also* refers to the
    request's WSGI environment, which contains wsgi.input, which
    ultimately refers to a _socket object from the standard
    library. Python's _socket objects only close their underlying file
    descriptor when their reference counts fall to 0***.
    
    This commit makes SegmentedIterable.close() call
    self.app_iter.close(), thereby unwinding its generator's stack and
    making it eligible for garbage collection.
    
    * in Python &lt; 3.4, at least. See PEP 442.
    
    ** see PyGen_NeedsFinalizing() in Objects/genobject.c and also
       has_finalizer() in Modules/gcmodule.c in Python.
    
    *** see sock_dealloc() in Modules/socketmodule.c in Python. See
        sock_close() in the same file for the other half of the sad story.
    
    This closes CVE-2016-0738.
    
    Closes-Bug: 1493303
    
    Co-Authored-By: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
    
    Change-Id: Ib86c4c45641485ce1034212bf6f53bb84f02f612

commit bc4b298b6e208d3188641712c9d66ae82d172c14
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Jan 19 15:33:13 2016 -0800

    Fix a comment's indentation
    
    Change-Id: I34514525b606cf82767ddce7769bc42fa5457717

commit 3a0486e532f22af0d3c8a5c5d78613c22e786ff6
Author: Sivasathurappan Radhakrishnan &lt;siva.radhakrishnan@intel.com&gt;
Date:   Fri Dec 4 17:43:00 2015 +0000

    Deleted comment about part power in FakeRing
    
    Deleted comment about parameter part power in Class FakeRing as its
    behavior got dropped in I8bfc388a04eff6491038991cdfd7686c9d961545.
    
    Change-Id: Iec7d2565a77e48493b0056021066d8d8eab65d0b
    Closes-Bug:  #1488704

commit 999479f9b17b42ccc5da54ce01651960cf7cf970
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Tue Jan 19 10:30:30 2016 -0800

    Bump eventlet min version to 0.17.4
    
    IPv6 support in Swift is dependent on IPv6 support in eventlet.
    eventlet itself only claims support for IPv6 post v0.17
    (https://github.com/eventlet/eventlet/issues/8). This update matches
    the OpenStack global requirements version.
    
    Change-Id: I9d8433cdd3bf7d7a93b8f50b991cc21721a80d22

commit 133a3ea601a3fea84af36a42845f27b8182fd901
Author: Christopher Bartz &lt;bartz@dkrz.de&gt;
Date:   Mon Dec 21 14:17:00 2015 +0100

    Use the correct split_path in handle_request
    
    Change-Id: I86d423309f0b2091ee2e82b2245caf925b6a75ef
    Closes-Bug: #1528189

commit bf10974cdefffdaaebc58d21e8a9912638a0405a
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Wed Dec 16 15:46:13 2015 -0800

    Expose token expiration time in tempauth auth response
    
    Previously, we gave no indication of when a token would expire. Users
    would have to just use it until it stopped working, then re-auth.
    Now, a successful auth response will include a new header,
    X-Auth-Token-Expires, with the number of seconds remaining until the
    token is invalid. This allows the client to attempt to re-auth before
    sending a request that will definitely fail.
    
    For comparison, swauth already uses the X-Auth-Token-Expires header with
    identical semantics. Additionally, Keystone (v2 and v3) already exposes
    expiration times in its JSON responses. The security impact should be
    minimal.
    
    Change-Id: I5a4a74276bc0df6dda94e4bc150065c0d77de0eb

commit 47e226418bad35ccad2a1525f392ba69f6165027
Author: OpenStack Proposal Bot &lt;openstack-infra@lists.openstack.org&gt;
Date:   Mon Jan 18 06:20:14 2016 +0000

    Imported Translations from Zanata
    
    For more information about this automatic import see:
    https://wiki.openstack.org/wiki/Translations/Infrastructure
    
    Change-Id: Ic416c9afc8a1c76f552803a7c70fc905eda7b3cb

commit 5d449471b12c67b31ebb5a383d9bb35bace36213
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Thu Jan 14 17:26:01 2016 -0800

    Remove some Python 2.6 leftovers
    
    Change-Id: I798d08722c90327c66759aa0bb4526851ba38d41

commit 3c0cf549f1e822cce8f905b069b317e676cf306b
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Wed Jan 13 18:08:45 2016 -0800

    Speed up get_more_nodes() when there is an empty zone
    
    The ring has some optimizations in get_more_nodes() so that it can
    find handoffs that span all the regions/zones/et cetera and then stop
    looking. The stopping is the important part.
    
    Previously, it would quickly find a handoff in each unused region,
    then spend way too long looking for more unused regions; the same was
    true for zones, IPs, and so on. Thus, in commit 9cd7c6c, we started
    counting regions and zones, then stopping when we found them all.
    
    This count included all regions and zones in the ring, regardless of
    whether or not there were actually any parts assigned or not. In rings
    with an empty region, i.e. a region for which there are only
    zero-weight devices, get_more_nodes() would be very slow.
    
    This commit ignores devices with no assigned partitions when counting
    regions, zones, and so forth, thus greatly speeding things up.
    
    The output of get_more_nodes() is unchanged. This is purely an
    optimization.
    
    Closes-Bug: 1534303
    
    Change-Id: I4a5c57205e87e1205d40fd5d9458d4114e524332

commit 70047709fc9885df7019f791e17a3240682cc6cb
Author: keliang &lt;ke.liang@easystack.cn&gt;
Date:   Fri Jan 15 00:31:51 2016 +0800

    Drop python 2.6 support
    
    Change-Id: Id6329c863dacb189fccfc304453ed7b6f9607c14

commit a4c2fe95ab2fbe59379a69914ed0fac49c28efbb
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Tue Jan 12 21:26:33 2016 +0100

    Allow to change auditor sleep interval in config
    
    Change-Id: Ic451c5e0b686509f8982ed1bf65a223a2d77b9a0

commit edc823e8030640184071fee4920d34f9a1cc6b3e
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Sun Nov 29 18:46:47 2015 +0100

    Show UTC time in swift-recon.
    
    It's not consistent now for example local time in replication part and
    UTC time at begging of line. Use _ptime in swift-recon for all time
    printing and this function returns UTC now.
    Change-Id: I732d9851db157130a08e825e8093b7e244b63e9c

commit fa5b32d27964478dfcccf71155d2aaa946c561f0
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Tue Jan 12 14:18:30 2016 -0800

    Make object-auditor storage-policy-aware
    
    Previously, the object-auditor would always use a (replication)
    DiskFileManager when walking through AuditLocations, which would cause
    it to skip EC fragment archives with a warning like:
    
        Unexpected file &lt;hash_path&gt;/1452557187.03610#3.data:
        Invalid Timestamp value in filename '1452557187.03610#3.data'
    
    Now, the AuditLocation's policy will be used to find an appropriate
    manager to get the diskfile. Additionally, several .commit()s were added
    to the auditor tests so the .durable will be written, which is required
    when auditing EC fragment archives.
    
    Change-Id: I960e7d696fd9ad704ca1872b4ac821f9078838c7
    Closes-Bug: 1533002

commit 33476460239c9cdb08dd8065d22d84a4717da7be
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Fri Jan 8 16:15:54 2016 -0800

    fixups for ipv6 memcache_servers docs
    
    Change-Id: I20d91c1e276014eaf210fa9eb43788bc17f4e8df

commit d5ff5447be30b44bf4acc8b912b6241a44f710be
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Jan 12 16:42:06 2016 -0800

    Install liberasurecode packages in SAIO.
    
    Change-Id: If673afa2b61a3e388612debf4860d561960963a3

commit 4ffc4ba411f67c8407ba38d082a3a51a96ad7e04
Author: Jonathan Hinson &lt;jlhinson@us.ibm.com&gt;
Date:   Tue Jan 12 11:46:21 2016 -0600

    Functional tests for if-match with multiple etags
    
    Multiple etags can be provided on an if-match or if-none-match
    request. This is currently being tested in the unit tests, but not
    in the functional tests. Since these etags can be modified by
    middleware, we need functional tests to assert multiple-etag
    requests are handled correctly.
    
    Change-Id: Idc409c85e8aa82b59dc2bc28af6ca2617de82699

commit e6194113a3c81563590eabf8f761ccb988bb917c
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Fri Jan 8 16:38:31 2016 -0800

    Validate X-Timestamps
    
    Previously, attempting to PUT a new object with an X-Timestamp header
    less than or equal to zero (ie, for a timestamp on or before 1970-01-01
    00:00:00) would cause the object-server to 500.
    
    While we're at it, cap X-Timestamp at 9999999999 (2286-11-20 17:46:40)
    so we don't get an eleventh digit before the decimal point.
    
    Closes-Bug: 1532471
    Change-Id: I23666ec8a067d829eaf9bfe54bd086c320b3429e

commit 1f3304c5153e01988b8f4493875b6489e93f76d0
Author: Ben Martin &lt;blmartin@us.ibm.com&gt;
Date:   Mon Dec 14 15:28:17 2015 -0600

    Print min_part_hours lockout time remaining
    
    swift-ring-builder currently only displays min_part_hours and
    not the amount of time remaining before a rebalance can occur.
    This information is readily available and has been displayed
    as a quality of life improvement.
    
    Additionally, a bug where the time since the last rebalance
    was always updated when rebalance was called regardless of
    if any partitions were reassigned. This can lead to partitions
    being unable to be reassigned as they never age according to
    the time since last rebalance.
    
    Change-Id: Ie0e2b5e25140cbac7465f31a26a4998beb3892e9
    Closes-Bug: #1526017

commit 167bb5eeb82886d67c1b382417fb22b8ea85f0d3
Author: Timur Alperovich &lt;timuralp@swiftstack.com&gt;
Date:   Wed Dec 16 12:07:27 2015 -0800

    Fix IPv6 handling in MemcacheConnPool.
    
    The patch removes the assumption of IPv4-only addresses in the
    MemcacheConnPool. The changes are around address handling.
    Namely, if a server is specified with an address
    [&lt;address&gt;]:port (port is optional), it is assumed to be an IPv6
    address [1]. If an IPv6 address is specified without "[]", an exception
    is raised as it is impossible to parse such addresses correctly.
    
    For testing, memcache can be configured to listen on the link-local,
    unique-local, or ::1 (equivalent to 127.0.0.1) addresses. Link-local
    addresses are assigned by default to each interface and are of the form
    "fe80::dead:beef". These addresses require a scope ID, which would look
    like "fe80::dead:beef%eth0" (replacing eth0 with the correct interface).
    
    Unique-local addresses are any addresses in the fc00::/7 subnet. To add
    a ULA to an interface use the "ip" utility. For example:
    "ip -6 address add fc01::dead:beef dev eth0". Lastly, and probably
    simplest, memcache can be configured to listen on "::1". The same
    address would be used in the swift configuration, e.g. "[::1]:11211".
    
    Note: only memcached version 1.4.25 or greater supports binding to an
    IPv6 address.
    
    Fixes #1526570
    
    [1] IPv6 host literals:
    https://tools.ietf.org/html/rfc3986#section-3.2.2
    
    Change-Id: I8408143c1d47d24e70df56a08167c529825276a2

commit fb6751d8ba133c57e1ebb76be71a96f2f120b8ca
Author: Paul Dardeau &lt;paul.dardeau@intel.com&gt;
Date:   Fri Jan 8 22:49:05 2016 +0000

    Look for device holes that can be reused when adding new device.
    
    Change-Id: I1980ebdd9dc89848173d8ca2fe2afb74029dcfa2
    Closes-Bug: 1532276

commit b35f3c90bde8a7ccb50440bda5800cbb8274a5a1
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Fri Jan 8 01:29:11 2016 -0800

    Add note COPY with conditional headers
    
    Swift now supports Range header for COPY (or PUT with X-Copy-From)
    to make a partial copied object. This patch adds the note to show
    it obviously supported in Swift community.
    
    Change-Id: I6bf28f0932c90e7b305cd61aabce4ed028ae691e
    Partial-Bug: #1532126

commit 23c7a58f8f1412c28b3a16b79be09c224c9f7d55
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Fri Dec 11 18:26:34 2015 +0900

    Fix ClientException handling in Container Sync
    
    swift/container/sync.py uses swift.common.internal_client.delete_object
    and put_object and expected these methods raise ClientException.
    But delete_object and put_object never raise the exception so this patch
    raises ClientException when urllib2 library raises HTTPError.
    
    Co-Authored-By: Eran Rom &lt;eranr@il.ibm.com&gt;
    Closes-Bug: #1419901
    Change-Id: I58cbf77988979a07998a46d9d81be84d29b0d9bf

commit 6786cdf036b4faabe3928c3d0dd9615d94834801
Author: Harshada Mangesh Kakad &lt;harshadak@metsi.co.uk&gt;
Date:   Thu Dec 31 01:44:00 2015 -0800

    Fixing the deprecated library function.
    
    os.popen() is deprecated since version 2.6. Resolved with use of
    subprocess module.
    
    Change-Id: I4409cdd9edbc1a26d6f99c125c9100fadda5d758
    Partial-Bug: #1529836

commit 85a0a6a28e166bc076cf8786de2b46248d8786a2
Author: Eran Rom &lt;eranr@il.ibm.com&gt;
Date:   Sun Jul 26 13:31:17 2015 +0300

    Container-Sync to iterate only over synced containers
    
    This change introduces a sync_store which holds only containers that
    are enabled for sync. The store is implemented using a directory
    structure that resembles that of the containers directory, but has
    entries only for containers enabled for sync.
    The store is maintained in two ways:
    1. Preemptively by the container server when processing
    PUT/POST/DELETE operations targeted at containers with
    x-container-sync-key / x-container-sync-to
    2. In the background using the containers replicator
    whenever it processes a container set up for sync
    
    The change updates [1]
    [1] http://docs.openstack.org/developer/swift/overview_container_sync.html
    
    Change-Id: I9ae4d4c7ff6336611df4122b7c753cc4fa46c0ff
    Closes-Bug: #1476623

commit e75888b281d59df0889f28d0b32241dac3a34aa2
Author: HugoKuo &lt;tonytkdk@gmail.com&gt;
Date:   Wed Jan 6 14:33:23 2016 +0800

    Add more description for write_affinity_node_count parameter in the doc.
    
    Change-Id: Iad410a2be4f9a2cd5c53e860b9f91993aa7f2369
    Closes-Bug: #1531173

commit f53cf1043d078451c4b9957027bf3af378aa0166
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Tue Jan 5 20:20:15 2016 +0100

    Fixed few misspellings in comments
    
    Change-Id: I8479c85cb8821c48b5da197cac37c80e5c1c7f05

commit 3b1591f235f4b85796917507be5e7fd80365ff9e
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Wed Sep 30 19:08:09 2015 +0200

    swift-init: New option kill-after-timeout
    
    This option send SIGKILL to daemon after kill_wait period.
    When daemon hangs and doesn't respond to SIGTERM/SIGHUP
    there is no way to stop it using swift-init now. Classic
    init scripts in Linux kills hanged process after grace
    period and this patch add same behaviour. This is most
    usefull when using "restart" on hanged daemon.
    
    Change-Id: I8c932b673a0f51e52132df87ea2f4396f4bba9d8

commit 79222e327f9df6335b58e17a6c8dd0dc44b86c17
Author: ChangBo Guo(gcb) &lt;eric.guo@easystack.cn&gt;
Date:   Sat Dec 26 13:13:37 2015 +0800

    Fix AttributeError for LogAdapter
    
    LogAdapter object has no attribute 'warn' but has attribute
    'warning'.
    
    Closes-Bug: #1529321
    Change-Id: I0e0bd0a3dbc4bb5c1f0b343a8809e53491a1da5f

commit 684c4c04592278a280032002b5313b171ee7a4c0
Author: janonymous &lt;janonymous.codevulture@gmail.com&gt;
Date:   Sun Aug 2 22:47:42 2015 +0530

    Python 3 deprecated the logger.warn method in favor of warning
    
    DeprecationWarning: The 'warn' method is deprecated, use 'warning'
    instead
    
    Change-Id: I35df44374c4521b1f06be7a96c0b873e8c3674d8

commit d0a026fcb8e8a9f5475699cc56e1998bdc4cd5ca
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Wed Dec 16 18:50:37 2015 +0900

    Fix duplication for headers in Access-Control-Expose-Headers
    
    There are following problems with Access-Control-Expose-Headers.
    
    * If headers in X-Container-Meta-Access-Control-Expose-Headers are
      configured, the headers are kept with case-sensitive string.
      Then a CORS request comes, the headers are merged into
      Access-Control-Expose-Headers as case-sensitive string even if
      there is a same header which is not case-sensitive string.
    
    * Access-Control-Expose-Headers is handled by a list.
      If X-Container/Object-Meta-XXX is configured in container/object
      and X-Container-Meta-Access-Control-Expose-Headers, same header
      is listed in Access-Control-Expose-Headers.
    
    This patch provides a fix for the problems.
    
    Change-Id: Ifc1c14eb3833ec6a851631cfc23008648463bd81

commit 0bcd7fd50ec0763dcb366dbf43a9696ca3806f15
Author: Bill Huber &lt;wbhuber@us.ibm.com&gt;
Date:   Fri Nov 20 12:09:26 2015 -0600

    Update Erasure Coding Overview doc to remove Beta version
    
    The major functionality of EC has been released for Liberty and
    the beta version of the code has been removed since it is now
    in production.
    
    Change-Id: If60712045fb1af803093d6753fcd60434e637772

commit 84ba24a75640be4212e0f984c284faf4c894e7c6
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Fri Dec 18 11:24:34 2015 +0000

    Fix rst errors so that html docs are complete
    
    rst table format errors don't break the gate job
    but do cause sections of the documents to go missing
    from the html output.
    
    Change-Id: Ic8c9953c93d03dcdafd8f47b271d276c7b356dc3

commit 9fe0e25604dff35db7eab1bca312821a81db6c1d
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Tue Dec 8 22:27:44 2015 -0800

    Sleep enough for trampoline
    
    When running unite test suite in local poor resource environment,
    sometimes test/unit/proxy/test_server.py fails due to a lack of
    waiting time to trampoline of eventlet thread.
    
    This patch enables to sleep 1 more second when it doesn't seem
    to have enough time to tranpoline.
    
    Change-Id: I0bbc8fc245919d3c0a071ff87ff6e20b8d58f9b8

commit 87f7e907ee412f5847f1f9ffca7a566fb148c6b1
Author: Matthew Oliver &lt;matt@oliver.net.au&gt;
Date:   Wed Dec 16 17:19:24 2015 +1100

    Pass HTTP_REFERER down to subrequests
    
    Currently a HTTP_REFERER (Referer) header isn't passed down to
    subrequests. This means *LO subrequests to segment containers
    return a 403 on a *LO GET when accessed by requests using referer
    ACLs.
    Currently the only way around referer access to *LO's is to make the
    segments container world readable.
    
    This change makes sure the referer header is passed into subrequests
    allowing a segments container to only need to be locked down with
    the same referer as the *LO container.
    
    This is a 1 line change to code, but also adds a unit and 2 functional
    functional tests (one for DLO and one for SLO).
    
    Change-Id: I1fa5328979302d9c8133aa739787c8dae6084f54
    Closes-Bug: #1526575

commit e15960a5d86e00a7d420edc4af034b27da0af8fd
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Thu Dec 17 12:08:45 2015 +0000

    Fix incorrect kwarg in auth middleware example
    
    When calling memcache_client.set(), timeout was deprecated
    and is now removed as a keyword arg, use time instead.
    
    Change-Id: Iedbd5b064853ef2b386963246f639fbcd3931cd3

commit 169a7c7f9e12ebc9933bd9ca4592e13b0de8b47b
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Wed Dec 16 15:28:25 2015 +0000

    Fix func test --until-failure and --no-discover options
    
    This patch changes functional test classes to subclass
    unittest2.TestCase rather than unittest.TestCase.
    This fixes errors when attempting to use
    
    tox -e func -- -n &lt;test_path_including_test_method&gt;
    
    and
    
    tox -e func -- --until-failure
    
    Also migrate from using nose.SkipTest to unittest2.SkipTest
    
    Change-Id: I903033f5e01833550b2f2b945894edca4233c4a2
    Closes-Bug: 1526725
    Co-Authored-By: Ganesh Maharaj Mahalingam &lt;ganesh.mahalingam@intel.com&gt;

commit b68311db95860ac1cab585a5ab66bd3b3abb765e
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Tue Dec 15 18:55:41 2015 -0800

    Fix reconciler test to calc lastmodified as UTC
    
    Swift reconciler calculates the last-modified date as UTC but
    current test calculates it as local time zone. It triggers unit
    test failure in non-UTC environment.
    
    This patch fixes the test to calculate the last-modified as UTC
    as well.
    
    Change-Id: Ia0053f350daf2cb8c61ac01a933924b6e4b0cb37
    Closes-Bug: #1526588

commit 1bb665331af92422290fb585de7cb6a2497236e6
Author: Venkateswarlu Pallamala &lt;p.venkatesh551@gmail.com&gt;
Date:   Mon Nov 9 19:22:38 2015 -0800

    remove unused parameters in the method
    
    make the helper methods as private by using convention
    
    Change-Id: I73b9604f8d5a0e85d012aac42b7963b618f5ad97

commit 9d7f71d5754c8b45f8e7c6ab80202de09933afb8
Author: Richard Hawkins &lt;hurricanerix@gmail.com&gt;
Date:   Fri Aug 7 18:14:13 2015 -0500

    Modify functional tests to use ostestr/testr
    
    Defcore uses Tempest, which uses Test Repository.
    This change makes it easier for Defcore to pull functional
    tests from Swift and run them.  Additionally, using testr
    allows tests to be run in parallel.
    
    Concurrency set to 1 for now, &gt;1 causes failures for
    reasons that are still TBD.
    
    With switch to ostestr all the server logs are being sent to stdout
    which makes it completely unreadable. Suppressing the logs by default
    now with a flag to enable it if desired.
    
    Co-Authored-By: John Dickinson &lt;me@not.mn&gt;
    Co-Authored-By: Robert Collins &lt;rbtcollins@hpe.com&gt;
    Co-Authored-By: Matthew Oliver &lt;matt@oliver.net.au&gt;
    Co-Authored-By: Ganesh Maharaj Mahalingam &lt;ganesh.mahalingam@intel.com&gt;
    
    Change-Id: I53ef4a116996a772cf1f3abc2eb0ad60047322d5
    Related-Bug: 1177924

commit 2f4b79233e30d42140bbc07059417443bf7a0757
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Tue Dec 15 15:49:42 2015 +0000

    Minor cleanup of repeated identical test assertions
    
    assertDictContainsSubset is being called multiple times with
    same arguments in a loop. Since assertDictContainsSubset is
    deprecated form python 3.2, replace it with checks on
    individual key, value pairs.
    
    Change-Id: I7089487710147021f26bd77c36accf5751855d68

commit 60b2e02905d57f55169e506f4874b2334a1a68a5
Author: Alistair Coles &lt;alistair.coles@hp.com&gt;
Date:   Mon Oct 5 16:15:29 2015 +0100

    Make ECDiskFile report all fragments found on disk
    
    Refactor the disk file get_ondisk_files logic to enable
    ECDiskfile to gather *all* fragments found on disk (not just those
    with a matching .durable file) and make the fragments available
    via the DiskFile interface as a dict mapping:
    
        Timestamp --&gt; list of fragment indexes
    
    Also, if a durable fragment has been found then the timestamp
    of the durable file is exposed via the diskfile interface.
    
    Co-Authored-By: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
    Change-Id: I55e20a999685b94023d47b231d51007045ac920e

commit 450737f886050e486f518cdce0c97596ccad848d
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Tue Dec 15 11:33:56 2015 +0900

    Fix a typo in development_auth.rst
    
    This patch uses correct name for "CORS".
    
    Change-Id: I5fee5c581a2b3adb7596a273baf05708bfa97f79

commit 40476ea0797690d3a90a9ed91906d26103dfa058
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Mon Dec 14 10:52:22 2015 -0800

    Document pretend_min_part_hours_passed
    
    Added a docstring for the swift-ring-builder CLI command
    "pretend_min_part_hours_passed". This is a dangerous operation, and
    that's why it hasn't been documented, but it can be useful at times.
    It should be made known to those who need it.
    
    Change-Id: I45bdbaacbbdda64c7510453e6d93e6d8563e3ecd

commit 6ade2908cca696ce1b48a7a19f4d460081fa5b0a
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Sun Dec 13 21:13:42 2015 +0100

    Deprecated param timeout removed from memcached
    
    Change-Id: Idf042a79f0db148bf9f28a9e360cb2a3c18d385a

commit 88c9aed7c846402355a3c7831f34f3e833bbdf11
Author: Victor Stinner &lt;vstinner@redhat.com&gt;
Date:   Mon Oct 19 16:19:28 2015 +0200

    Port swift.common.utils.StatsdClient to Python 3
    
    * StatsdClient._send(): on Python 3, encode parts to UTF-8 and
      replace '|' with b'|' to join parts.
    * timing_stats(): replace func.func_name with func.__name__. The
      func_name attribute of functions was removed on Python 3, whereas
      the __name__ attribute is available on Python 2 and Python 3.
    * Fix unit tests to use bytes
    
    Change-Id: Ic279c9b54e91aabcc52587eed7758e268ffb155e

commit ca2dcc371921aa1aded6161287cc03c0940bf198
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Fri Dec 11 18:21:28 2015 +0100

    Deprecated tox -downloadcache option removed
    
    Caching is enabled by default from pip version 6.0
    
    More info:
    https://testrun.org/tox/latest/config.html#confval-downloadcache=path
    https://pip.pypa.io/en/stable/reference/pip_install/#caching
    
    Change-Id: I9451a0f0dee5c5a3c0ca0a52f58bd353602661a2

commit 211758f8cb02298fe16e59bf2954a146c6b24b83
Author: Catherine Northcott &lt;catherine@northcott.nz&gt;
Date:   Thu Nov 5 23:04:14 2015 +1300

    Add support for storage policies to have more than one name
    
    This patch alters storage_policy.py to allow storage policies
    to have multiple names. Now users are able to add a number of
    human-readable aliases for storage policies. Policies now have
    a .name (the default name), .aliases (a string of comma
    seperated aliases), and .aliases_list (a list of all human
    readable names). Policies will always have an .aliases value
    if no aliases are set it will contain the default name.
    The policy docs and tests have been updated to reflect changes
    and policy.get_policy_info has been altered to display the
    name and aliases
    
    Change-Id: I02967ca8d7c790595e5ee551581196aa64552eea

commit 7f636a557296ecc6ae4727700cfcf9f82573bd16
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Mon Nov 30 18:06:09 2015 -0800

    Allow smaller segments in static large objects
    
    The addition of range support for SLO segments (commit 25d5e68)
    required the range size to be at least the SLO minimum segment size
    (default 1 MiB). However, if you're doing something like assembling a
    video of short clips out of a larger one, then you might not need a
    full 1 MiB.
    
    The reason for the 1 MiB restriction was to protect Swift from
    resource overconsumption. It takes CPU, RAM, and internal bandwidth to
    connect to an object server, so it's much cheaper to serve a 10 GiB
    SLO if it has 10 MiB segments than if it has 10 B segments.
    
    Instead of a strict limit, now we apply ratelimiting to small
    segments. The threshold for "small" is configurable and defaults to 1
    MiB. SLO segments may now be as small as 1 byte.
    
    If a client makes SLOs as before, it'll still be able to download the
    objects as fast as Swift can serve them. However, a SLO with a lot of
    small ranges or segments will be slowed down to avoid resource
    overconsumption. This is similar to how DLOs work, except that DLOs
    ratelimit *every* segment, not just small ones.
    
    UpgradeImpact
    
    For operators: if your cluster has enabled ratelimiting for SLO, you
    will want to set rate_limit_under_size to a large number prior to
    upgrade. This will preserve your existing behavior of ratelimiting all
    SLO segments. 5368709123 is a good value, as that's 1 greater than the
    default max object size. Alternately, hold down the 9 key until you
    get bored.
    
    If your cluster has not enabled ratelimiting for SLO (the default), no
    action is needed.
    
    Change-Id: Id1ff7742308ed816038a5c44ec548afa26612b95

commit 73d0f1620a269f990dbd3d2796abf27e9a05e227
Author: Béla Vancsics &lt;vancsics@inf.u-szeged.hu&gt;
Date:   Tue Dec 8 10:17:08 2015 +0100

    Not used parameter
    
    The account variable was not used in the method.
    
    Change-Id: I8e91d7616529f33b615bc52af76bfda01141d364
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-feature-crypto
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/64" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-01-28T16:41:18.967052+00:00" title="2016-01-28 16:41:18 UTC">on 2016-01-28</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/64">
                <strong>Related fix merged to ossa (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/64"> #64</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/270241">https:/<wbr />/review.<wbr />openstack.<wbr />org/270241</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/ossa/commit/?id=606a18e718aed329a9d42d298e3119f0f1974e3d">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />ossa/commit/<wbr />?id=606a18e718a<wbr />ed329a9d42d298e<wbr />3119f0f1974e3d</a><br />
Submitter: Jenkins<br />
Branch:    master</p>
<p>commit 606a18e718aed32<wbr />9a9d42d298e3119<wbr />f0f1974e3d<br />
Author: Tristan Cacqueray &lt;email address hidden&gt;<br />
Date:   Wed Jan 20 10:19:30 2016 -0500</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Adds OSSA-2016-004 (CVE-2016-0737, CVE-2016-0738)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1466549<br />
&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1493303<br />
&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Id7b40ab5101ccb<wbr />d889c4ffc6bd962<wbr />9bb5f2b8d7f</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/270241
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=606a18e718aed329a9d42d298e3119f0f1974e3d
Submitter: Jenkins
Branch:    master

commit 606a18e718aed329a9d42d298e3119f0f1974e3d
Author: Tristan Cacqueray &lt;tdecacqu@redhat.com&gt;
Date:   Wed Jan 20 10:19:30 2016 -0500

    Adds OSSA-2016-004 (CVE-2016-0737, CVE-2016-0738)
    
    Related-Bug: #1466549
    Related-Bug: #1493303
    Change-Id: Id7b40ab5101ccbd889c4ffc6bd9629bb5f2b8d7f
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/65" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-02-09T16:42:48.113890+00:00" title="2016-02-09 16:42:48 UTC">on 2016-02-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/65">
                <strong>Fix proposed to swift (feature/crypto)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/65"> #65</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: feature/crypto<br />
Review: <a rel="nofollow" href="https://review.openstack.org/277950">https:/<wbr />/review.<wbr />openstack.<wbr />org/277950</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: feature/crypto
Review: https://review.openstack.org/277950</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/66" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-02-10T09:55:23.207348+00:00" title="2016-02-10 09:55:23 UTC">on 2016-02-10</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/66">
                <strong>Change abandoned on swift (feature/crypto)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/66"> #66</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by Alistair Coles (&lt;email address hidden&gt;) on branch: feature/crypto<br />
Review: <a rel="nofollow" href="https://review.openstack.org/277950">https:/<wbr />/review.<wbr />openstack.<wbr />org/277950</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by Alistair Coles (alistair.coles@hpe.com) on branch: feature/crypto
Review: https://review.openstack.org/277950</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/67" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-03-08T21:40:44.297993+00:00" title="2016-03-08 21:40:44 UTC">on 2016-03-08</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/67">
                <strong>Fix proposed to swift (feature/hummingbird)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/67"> #67</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: feature/hummingbird<br />
Review: <a rel="nofollow" href="https://review.openstack.org/290148">https:/<wbr />/review.<wbr />openstack.<wbr />org/290148</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: feature/hummingbird
Review: https://review.openstack.org/290148</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/68" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-03-08T23:31:36.064937+00:00" title="2016-03-08 23:31:36 UTC">on 2016-03-08</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/cloud-archive/+bug/1493303/comments/68">
                <strong>Fix merged to swift (feature/hummingbird)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/68"> #68</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  <a href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/comments/68/+download">Download full text</a> (71.7 KiB)
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/290148">https:/<wbr />/review.<wbr />openstack.<wbr />org/290148</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/swift/commit/?id=0f7f1de233919a0b046349a3e31ae7fc8675a1c5">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />swift/commit/<wbr />?id=0f7f1de2339<wbr />19a0b046349a3e3<wbr />1ae7fc8675a1c5</a><br />
Submitter: Jenkins<br />
Branch:    feature/hummingbird</p>
<p>commit d6b4587a554b51b<wbr />a733b151e0d9247<wbr />35b63d07e0<br />
Author: Olga Saprycheva &lt;email address hidden&gt;<br />
Date:   Tue Mar 8 10:57:56 2016 -0600</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Removed redundant file for flake8 check</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I4322978aa20ee7<wbr />31391f7709bbd79<wbr />dee140fc703</p>
<p>commit 643dbce13414053<wbr />0eef2ae62c42fef<wbr />1107f905ed<br />
Author: OpenStack Proposal Bot &lt;email address hidden&gt;<br />
Date:   Tue Mar 8 06:35:49 2016 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Imported Translations from Zanata</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;For more information about this automatic import see:<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a rel="nofollow" href="https://wiki.openstack.org/wiki/Translations/Infrastructure">https:/<wbr />/wiki.openstack<wbr />.org/wiki/<wbr />Translations/<wbr />Infrastructure</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I96b8ff1287bf21<wbr />9c5f8d56a3a4868<wbr />c1063a953f9</p>
<p>commit 83713d37f0331c5<wbr />ce9d377f4b4e872<wbr />4551ae30ca<br />
Author: Daisuke Morita &lt;email address hidden&gt;<br />
Date:   Mon Mar 7 18:30:47 2016 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Missing comments for storage policy parameter</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;There are missing comments about storege_<wbr />policy_<wbr />index so appropriate<br />
&nbsp;&nbsp;&nbsp;&nbsp;comments are added.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I3de3f0e6864e65<wbr />918ca1a13cce70f<wbr />19c23d295f5</p>
<p>commit 2cff2dec3d1c458<wbr />8f5103e39679c43<wbr />b3dded6dcb<br />
Author: Olga Saprycheva &lt;email address hidden&gt;<br />
Date:   Fri Mar 4 15:19:39 2016 -0600</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fixed pep8 and flake8 errors in doc/source/conf.py and updated flake8 commands in tox.ini to test it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I2add370e4cfb55<wbr />d1388e3a8b41f68<wbr />8a7f3f2c621</p>
<p>commit 043fbca6d08648b<wbr />aa314ea2236f1cc<wbr />dca8785f16<br />
Author: Christian Schwede &lt;email address hidden&gt;<br />
Date:   Fri Mar 4 09:33:17 2016 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Remove Erasure Coding beta status from docs</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This removes notes stating support for Erasure coding as beta. Questions<br />
&nbsp;&nbsp;&nbsp;&nbsp;regarding the stability of EC are coming up regularly, and are often referring<br />
&nbsp;&nbsp;&nbsp;&nbsp;to the docs that state EC as still in beta.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Besides this, a note marking statsd support as beta has been removed as well.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: If4fb6a5c4cb741<wbr />d42953db3cee8cb<wbr />17a1d774e15</p>
<p>commit 09c73b86e9255f2<wbr />8fbd4cf571a52c1<wbr />7d549a8f9a<br />
Author: Pete Zaitcev &lt;email address hidden&gt;<br />
Date:   Thu Mar 3 10:24:28 2016 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Fix a crash in exception printout</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Says the number of arguments does not match the number of &#x27;%&#x27;.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I8b5e395a07328f<wbr />b9d4ac7a19f8ed2<wbr />ae1637bee3b</p>
<p>commit fad5fabe0a22e8a<wbr />86635a66523dd3d<wbr />3d3b1fa705<br />
Author: Tim Burke &lt;email address hidden&gt;<br />
Date:   Thu Mar 3 15:07:08 2016 +0000</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;During functional tests, 404 response to a DELETE is successful</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Previously, we would only consider 204 responses successful, which would<br />
&nbsp;&nbsp;&nbsp;&nbsp;cause some spurious gate failures, such as</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<a rel="nofollow" href="http://logs.openstack.org/66/287666/3/check/gate-swift-dsvm-functional/c6d2673/console.html#_2016-03-03_13_41_07_846">http://<wbr />logs.openstack.<wbr />org/66/<wbr />287666/<wbr />3/check/<wbr />gate-swift-<wbr />dsvm-functional<wbr />/c6d2673/<wbr />console.<wbr />html#_2016-<wbr />03-03_13_<wbr />41_07_846</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Ic8c30064792435<wbr />2a297a2781b5006<wbr />4f7657038b4</p>
<p>commit e91de49d6864b37<wbr />94f8dc5acd9c1bf<wbr />0c2f7409d1<br />
Author: Alistair Coles &lt;email address hidden&gt;<br />
Date:   Mon Aug 10 10:30:10 2015 -0500</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Update container on fast-POST</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;This patch makes a number of changes to enable content-type<br />
&nbsp;&nbsp;&nbsp;&nbsp;metadata to be updated when using the fast-POST mode of<br />
&nbsp;&nbsp;&nbsp;&nbsp;operation, as proposed in the associated spec ...</p></div>
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/290148
Committed: https://git.openstack.org/cgit/openstack/swift/commit/?id=0f7f1de233919a0b046349a3e31ae7fc8675a1c5
Submitter: Jenkins
Branch:    feature/hummingbird

commit d6b4587a554b51ba733b151e0d924735b63d07e0
Author: Olga Saprycheva &lt;osapryc@us.ibm.com&gt;
Date:   Tue Mar 8 10:57:56 2016 -0600

    Removed redundant file for flake8 check
    
    Change-Id: I4322978aa20ee731391f7709bbd79dee140fc703

commit 643dbce134140530eef2ae62c42fef1107f905ed
Author: OpenStack Proposal Bot &lt;openstack-infra@lists.openstack.org&gt;
Date:   Tue Mar 8 06:35:49 2016 +0000

    Imported Translations from Zanata
    
    For more information about this automatic import see:
    https://wiki.openstack.org/wiki/Translations/Infrastructure
    
    Change-Id: I96b8ff1287bf219c5f8d56a3a4868c1063a953f9

commit 83713d37f0331c5ce9d377f4b4e8724551ae30ca
Author: Daisuke Morita &lt;morita.daisuke@ntti3.com&gt;
Date:   Mon Mar 7 18:30:47 2016 -0800

    Missing comments for storage policy parameter
    
    There are missing comments about storege_policy_index so appropriate
    comments are added.
    
    Change-Id: I3de3f0e6864e65918ca1a13cce70f19c23d295f5

commit 2cff2dec3d1c4588f5103e39679c43b3dded6dcb
Author: Olga Saprycheva &lt;osapryc@us.ibm.com&gt;
Date:   Fri Mar 4 15:19:39 2016 -0600

    Fixed pep8 and flake8 errors in doc/source/conf.py and updated flake8 commands in tox.ini to test it.
    
    Change-Id: I2add370e4cfb55d1388e3a8b41f688a7f3f2c621

commit 043fbca6d08648baa314ea2236f1ccdca8785f16
Author: Christian Schwede &lt;cschwede@redhat.com&gt;
Date:   Fri Mar 4 09:33:17 2016 +0000

    Remove Erasure Coding beta status from docs
    
    This removes notes stating support for Erasure coding as beta. Questions
    regarding the stability of EC are coming up regularly, and are often referring
    to the docs that state EC as still in beta.
    
    Besides this, a note marking statsd support as beta has been removed as well.
    
    Change-Id: If4fb6a5c4cb741d42953db3cee8cb17a1d774e15

commit 09c73b86e9255f28fbd4cf571a52c17d549a8f9a
Author: Pete Zaitcev &lt;zaitcev@kotori.zaitcev.us&gt;
Date:   Thu Mar 3 10:24:28 2016 -0700

    Fix a crash in exception printout
    
    Says the number of arguments does not match the number of '%'.
    
    Change-Id: I8b5e395a07328fb9d4ac7a19f8ed2ae1637bee3b

commit fad5fabe0a22e8a86635a66523dd3d3d3b1fa705
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Thu Mar 3 15:07:08 2016 +0000

    During functional tests, 404 response to a DELETE is successful
    
    Previously, we would only consider 204 responses successful, which would
    cause some spurious gate failures, such as
    
    http://logs.openstack.org/66/287666/3/check/gate-swift-dsvm-functional/c6d2673/console.html#_2016-03-03_13_41_07_846
    
    Change-Id: Ic8c300647924352a297a2781b50064f7657038b4

commit e91de49d6864b3794f8dc5acd9c1bf0c2f7409d1
Author: Alistair Coles &lt;alistair.coles@hp.com&gt;
Date:   Mon Aug 10 10:30:10 2015 -0500

    Update container on fast-POST
    
    This patch makes a number of changes to enable content-type
    metadata to be updated when using the fast-POST mode of
    operation, as proposed in the associated spec [1].
    
    * the object server and diskfile are modified to allow
      content-type to be updated by a POST and the updated value
      to be stored in .meta files.
    
    * the object server accepts PUTs and DELETEs with older
      timestamps than existing .meta files. This is to be
      consistent with replication that will leave a later .meta
      file in place when replicating a .data file.
    
    * the diskfile interface is modified to provide accessor
      methods for the content-type and its timestamp.
    
    * the naming of .meta files is modified to encode two
      timestamps when the .meta file contains a content-type value
      that was set prior to the latest metadata update; this
      enables consistency to be achieved when rsync is used for
      replication.
    
    * ssync is modified to sync meta files when content-type
      differs between local and remote copies of objects.
    
    * the object server issues container updates when handling
      POST requests, notifying the container server of the current
      immutable metadata (etag, size, hash, swift_bytes),
      content-type with their respective timestamps, and the
      mutable metadata timestamp.
    
    * the container server maintains the most recently reported
      values for immutable metadata, content-type and mutable
      metadata, each with their respective timestamps, in a single
      db row.
    
    * new probe tests verify that replication achieves eventual
      consistency of containers and objects after discrete updates
      to content-type and mutable metadata, and that container-sync
      sync's objects after fast-post updates.
    
    [1] spec change-id: I60688efc3df692d3a39557114dca8c5490f7837e
    
    Change-Id: Ia597cd460bb5fd40aa92e886e3e18a7542603d01

commit 3c61ab4678a7aa9ff256ace4bc97ab449607fd49
Author: asettle &lt;alexandra.settle@rackspace.com&gt;
Date:   Wed Feb 10 17:58:05 2016 +1000

    Operational procedures guide
    
    This is the operational procedures guide that HPE used
    to operate and monitor their public Swift systems.
    It has been made publicly available.
    
    Change-Id: Iefb484893056d28beb69265d99ba30c3c84add2b

commit 8e4347afd59aa30708ef03a78202652aaadda2e9
Author: Takashi Kajinami &lt;kajinamit@nttdata.co.jp&gt;
Date:   Tue Nov 17 16:15:59 2015 +0900

    Fix proxy-server's support for chunked transferring in GET object
    
    Proxy-server now requires Content-Length in the response header
    when getting object and does not support chunked transferring with
    "Transfer-Encoding: chunked"
    
    This doesn't matter in normal swift, but prohibits us from putting
    any middelwares to execute something like streaming processing of
    objects, which can't calculate the length of their response body
    before they start to send their response.
    
    Change-Id: I60fc6c86338d734e39b7e5f1e48a2647995045ef

commit 9dda1c9526c5b3e0ac905985921605d833bef3cc
Author: Takashi Kajinami &lt;kajinamit@nttdata.co.jp&gt;
Date:   Fri Dec 25 10:30:01 2015 +0900

    Update parameters about authtoken middleware in proxy-server.conf.sample
    
    This patch replaces some configration parameters about authtoken
    middleware in proxy-server.conf, which will be deprecated.
    
    The following parameters are to be deprecated.
     auth_admin_prefix, auth_host, auth_port, auth_protocol,
     identity_uri, admin_token, admin_user, admin_password,
     admin_tenant_name
    
    Change-Id: I373734933189c87c4094203b0752dd3762689034

commit 087fa4fa01fc36343f2ce0974d3b36ec0b98afc8
Author: Andreas Jaeger &lt;aj@suse.com&gt;
Date:   Mon Feb 29 20:00:38 2016 +0100

    Remove unused pngmath Sphinx extension
    
    There's no RST file that uses ".. math" and thus
    the pngmath Sphinx extension is not used and can
    get removed.
    
    Change-Id: I3ea4b529025c8ac3c4092f3720124647861e6668

commit 9c5b01e7c7699fbfd221e98ccde1afa9361c8119
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Wed Dec 9 08:08:22 2015 +0000

    Add container quota functional test
    
    This patch provides one container quota functional test.
    
    Change-Id: I16354c15fc434d70f9bb6b9b1e18b09357195c83

commit efdc6ee8dbc434e9189a6b85b924c322c3ff6ae3
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Thu Dec 10 01:15:30 2015 +0000

    Add X-Delete-After and X-Delete-At functional test
    
    This patch provides functional tests for X-Delete-After and X-Delete-At.
    
    Change-Id: I55b0d0584428413aa7a31f66defec55f9b1bbcd9

commit bd93d44bb46350f716f1dfb66fb43c2ab4ad8c50
Author: Takashi Kajinami &lt;kajinamit@nttdata.co.jp&gt;
Date:   Sun Feb 28 13:41:19 2016 +0900

    Make sure all temp files get deleted in test_ringbuilder
    
    This patch makes test_ringbuilder create a temporal directory,
    run ring builder commands under it, and delete it after testing
    for each test cases, to fix temp file leaking.
    
    Change-Id: I6f59fe095ea6485af0e60b5a8e8fc3892e0a0f90

commit 10b5765c60790f8a3ae2a94d6a51736ec2c99ce0
Author: benjkeller &lt;bjkeller@us.ibm.com&gt;
Date:   Thu Feb 25 18:54:00 2016 -0600

    Rename test_object_delete_at_aysnc
    
    This renames test_object_delete_at_aysnc to
    test_object_delete_at_async to match with the function
    async_update which it tests.
    
    Change-Id: I726afcbf08a3449c7af2834e573b97be378a86cd
    Closes-Bug: 1550067

commit 9e53bb47efa28983109da8ceca5d316925bc6804
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Wed Feb 24 09:36:40 2016 -0800

    updated some weird whitespace character to a normal one
    
    Change-Id: I187fb8fc8d10f950bbebc586999eced0bc117432

commit 54e53ae87b6e87229dc77cb7c814ab9733ea7013
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Fri Feb 19 09:30:10 2016 +0000

    Silence SkipTest noise in in-process test teardown
    
    setup_package and teardown_package get called twice when
    running functional tests using nose. With in-process mode
    the first call to teardown_package clears global config
    which causes the test swiftclient to raise a SkipTest error
    during the second call to teardown_package.
    
    To reproduce:
    SWIFT_TEST_IN_PROCESS=1 nosetests ./test/functional/test_account.py
    
    This patch simply tests for config existence before attempting
    to create a test swiftclient in the teardown_package function.
    
    Also fix a related issue whereby in_process flag would be reset to
    False during second call to setup_package, thus causing some of the
    in process cleanup in teardown_package to never be executed.
    
    Change-Id: I074dcd3d39aa46b262632024b047556ca471e8b8

commit 076134784b4eb1c2e55b28218dc0d64a57795d63
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Tue Feb 23 17:28:08 2016 -0800

    Add warn method back to LogAdapter
    
    The change in 684c4c04 to improve py3 support breaks older middleware
    that consumes the SwiftLogger.
    
    Good for Swift code to not to use warn because it's deprecated.
    
    Bad for LogAdapter to not faithfully provide the current python logging
    module API (deprecated or otherwise).
    
    Change-Id: Ib0baf66b7f33f91562867076ff0526a287d8e5a6

commit eb7ca115e6501edd9225dce8784b8b3d3e094bb1
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Feb 23 14:00:34 2016 -0800

    Fix StatsD tests to not use real DNS
    
    In common/test_utils.py, TestStatsdLogging had the majority of its
    test cases calling the real socket.getaddrinfo(), which uses real
    DNS. This is very slightly slower than using a mock getaddrinfo() when
    the machine running the tests has functioning DNS, but on a machine
    with no network connection at all, the tests are excruciatingly slow
    due to timeouts.
    
    This commit mocks things out as appropriate. There's still one user of
    the real getaddrinfo(), but it's for ::1, so that's just local
    resolution based on /etc/hosts.
    
    Timing numbers for "./.unittests test.unit.common.test_utils:TestStatsdLogging":
    
     * network, without this patch: 1.8s
     * no network, without this patch: 221.2s (ouch)
     * network, with this patch: 1.1s
     * no network, with this patch: 1.1s
    
    Change-Id: I1a2d6f24fc9bb928894fb1fd8383516250e29e0c

commit b97adf70ade2982fea5354c55f1eea9f98442fa7
Author: Thiago da Silva &lt;thiago@redhat.com&gt;
Date:   Tue Feb 23 16:23:51 2016 -0500

    fix formatting of bulk operations doc
    
    Change-Id: I247d2867c55d6bbf2288dfb74271f57c6f88b243

commit cfd50212358372694ba0713ff8c3bc313c6f1a92
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Thu Feb 18 21:06:40 2016 -0800

    dry out container unittests
    
    Change Ifcc4392ffa4df485ce3c62a35d0fcc8c93de74aa introduced
    TestContainerController4Replicas as a subclass of
    TestContainerController. And there is duplicated code
    block to override setUp method.
    
    This patch removed the duplicated code block.
    
    Change-Id: Iad0b64cba52554b89dbd959475a2ce7c0d9a20eb

commit 406e8996fb288e9851e02c3f3faa536a9919b28f
Author: Takashi Kajinami &lt;kajinamit@nttdata.co.jp&gt;
Date:   Mon Feb 22 16:10:09 2016 +0900

    Use 201 insted of 200 in PUT test case
    
    There are some unit test cases which assumes 200 as the response
    of PUT request, but 200 is never returned in PUT.
    This patch replaces 200 in PUT by 201, and adapt unit test cases
    to real case.
    
    Change-Id: I35fc7a4fe7fcc5558a9e6c6371105793c2710f3e

commit 5b18455cef57d052df3cda3e9179c923d3aadcad
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Fri Jan 22 07:06:45 2016 +0000

    Add unit tests for checking responses in ContainerController
    
    This patch provides unit tests to check responses for various situation
    in three/four replicas env.
    
    Change-Id: Ifcc4392ffa4df485ce3c62a35d0fcc8c93de74aa

commit 002513d21786df0d6c71e9772ec4688e2c14d8de
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Thu Jan 7 11:56:33 2016 -0800

    Make write-only container access consistent
    
    Previously, if a user could write to (but not read from) a container,
    the behavior for object POST would vary depending on whether
    object_post_as_copy was enabled (403 response) or disabled (202
    response).
    
    Now, POSTs will consistently be allowed, regardless of whether fast-POST
    is enabled.
    
    Change-Id: I1d6dcbc4f5034a322a1073850fc3b059ebb1c0fa

commit 9a6c6b55713f896609b7127560ae99fabbf759e7
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Thu Feb 18 17:38:42 2016 +0100

    Fixed log format in object auditor
    
    Change-Id: I218e08446c5ffda2db7c774ec8bb9d28ce9f63e7

commit 2d55960a221c9934680053873bf1355c4690bb19
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Thu Jan 14 18:31:21 2016 +0000

    Fix inconsistent suffix hashes after ssync of tombstone
    
    Consider two replicas of the same object whose ondisk files
    have diverged due to failures:
    
      A has t2.ts
      B has t1.data, t4.meta
    
    (The DELETE at t2 did not make it to B. The POST at t4 was
    rejected by A.)
    
    After ssync replication the two ondisk file sets will not be
    consistent:
    
      A has t2.ts  (ssync cannot POST t4.meta to this node)
      B has t2.ts, t4.meta (ssync should not delete t4.meta,
                            there may be a t3.data somewhere)
    
    Consequenty the two nodes will report different hashes for the
    object's suffix, and replication will repeat, always with the
    inconsistent outcome. This scenario is reproduced by the probe
    test added in this patch.
    
    (Note that rsync replication does result in (t2.ts, t4.meta)
    on both nodes.)
    
    The solution is to change the way that suffix hashes are
    calculated. Currently the names of *all* files found in each
    object dir are added to the hash.  With this patch the
    timestamps of only those files that could be used to
    construct a valid diskfile are added to the hash. File
    extensions are appended to the timestamp so that in most
    'normal' situations the result of the hashing is the same
    as before this patch. That avoids a storm of hash mismatches
    when this patch is deployed in an existing cluster.
    
    In the problem case described above, t4.meta is no longer
    added to the hash, since it is not useful for constructing
    a diskfile. (Note that t4.meta is not deleted because it
    may become useful should a t3.data be replicated in future).
    
    Closes-Bug: 1534276
    Change-Id: I99e88b8d5f5d9bc22b42112a99634ba942415e05

commit ddeb0cde9fc828fa79dce90df4975f66737ba054
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Wed Feb 17 21:17:34 2016 -0800

    Fix object-server to handle newer ts file
    
    Swift object-server will return 409 Conflict when the incomming
    request X-Timestamp is older than the local disk file to prevent
    wasted data transfer and disk space consumption. However, IFF,
    the local disk file is a tombstone, current object-server will
    write the data in the device and cleanup it according to timestamp
    comparison result in hash_cleanup_list_dir, and then return 201
    Created. That's wasted and far from the semantics in the normal case.
    
    This patch fixes object-server to catch the DiskFileDeleted exception
    at PUT request, and then, set the timestamp from tombstone as
    original_timestamp to be able to compare with request timestamp.
    
    Co-Authored-By: Kazuhiro Miyahara &lt;miyahara.kazuhiro@lab.ntt.co.jp&gt;
    Change-Id: I078c9cb90707a3c320708e76ea42cbfa73e1ea4b
    Closes-Bug: #1546865

commit 878688cae00576ec0bdb0a66eca7ada95e661c0a
Author: Béla Vancsics &lt;vancsics@inf.u-szeged.hu&gt;
Date:   Mon Dec 7 17:02:40 2015 +0100

    Reduce code duplication
    
    Reduced source code by extracting duplicated code
    (swift/common/direct_client.py)
    http://openqa.sed.hu/dashboard/index/5?did=1
    
    Change-Id: I47fa6ae12c646e8e42fb0a46a017971f05d883fc
    Closes-Bug: 1536067

commit c3201f256cf415988a3cb1c42e9c6b7835195fa3
Author: Kazuhiro MIYAHARA &lt;miyahara.kazuhiro@lab.ntt.co.jp&gt;
Date:   Fri Jan 8 18:03:33 2016 +0900

    Remove execute permissions from doc files and swift.conf-sample
    
    Some doc files and swift.conf-sample were added execute permissions in past changes.
    This patch remove execute permissions from them.
    
    Change-Id: Id8844989a8321578e9207566ebd6660f5b9523f0

commit e46d6b17251ab538595b1deb5581360a286b8fd1
Author: Christian Schwede &lt;cschwede@redhat.com&gt;
Date:   Wed Feb 17 20:47:26 2016 +0100

    Add note on using printable chars for swift_hash_path_suffix/prefix
    
    Using unprintable characters for swift_hash_path_prefix/suffix might lead to
    hard problems when parsing of these values changes, for example due to newer
    Python versions or changes in the parsers itself. Let's avoid this and add a
    note that deployers should use printable strings for these values.
    
    Change-Id: I976982b753b6af831ab91d7190f50f8f15bf73bf

commit b8fa48080812ab0f6bac7ae19c0290da08f6a6e4
Author: Donagh McCabe &lt;donagh.mccabe@hp.com&gt;
Date:   Thu Feb 4 16:19:13 2016 +0000

    Added links to API reference and usage guides
    
    Added a link to the API reference (where headers and query
    strings are documented; click the "detail" button to see).
    Also added a reference to Swift section of the OpenStack end
    user guide. This contains some additional details about the API.
    
    No attempt was made to reconcile duplicate information. Instead
    this patch links documents that might otherwise be overlooked.
    However, I fixed text, originally in a table, that had become
    garbled in a prior patch.
    
    Change-Id: I0910cbeb0c8bffc00e510f35585603e7b7a67790

commit aa7204d106ae33eba9219514f31f008510c9db53
Author: Kazuhiro MIYAHARA &lt;miyahara.kazuhiro@lab.ntt.co.jp&gt;
Date:   Fri Feb 12 20:48:34 2016 +0900

    Remove '#! /usr/bin/env python' from unexecutable files
    
    'cli/recon.py' and 'cli/ring_builder_analyzer.py' have '#! /usr/bin/env
    python' in spite of they don't have execute permissions.  This patch
    removes '#! /usr/bin/env python' from them.
    
    Change-Id: I1917ccc84b1673af3d862be1796f54595f94c5ca

commit db87a5a9889d436f2e2aacdc8923d55ca0d3d1ca
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Tue Feb 16 10:52:01 2016 -0800

    Mock sleep in direct_client retry tests
    
    ... and fixup some assertions, and other mocks
    
    Change-Id: Iadf839d1d3d735109fed24049fc3d829776b7b65

commit 8eb30afd7c39f6e6ba031f72c6a61f45b28d37f6
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Tue Feb 16 10:25:39 2016 -0800

    Static methods should be @staticmethods
    
    Change-Id: Ifee5d68e00bbb3571aaac885cdd7490c79732985

commit 4a44e27e00795c5f12176ef346cd2249fca54fd8
Author: Chaozhe.Chen &lt;chaozhe.chen@easystack.cn&gt;
Date:   Tue Feb 16 23:44:27 2016 +0800

    Replace assertEqual(None, *) with assertIsNone in tests
    
    As swift no longer supports Python 2.6, replace assertEqual(None, *)
    with assertIsNone in tests to have more clear messages in case of
    failure.
    
    Change-Id: I94af3e8156ef40465d4f7a2cb79fb99fc7bbda56
    Closes-Bug: #1280522

commit 42f4b3fc1e69a046c1e70e73afe847e4423fa2da
Author: Christian Schwede &lt;cschwede@redhat.com&gt;
Date:   Tue Feb 16 10:08:55 2016 +0000

    Add SwiftHLM to associated projects
    
    Change-Id: I5ea3de34e61f22abec803b35fec8adde18a793e9

commit 025ebf2901d5a972796b73538bb306847d7d06b6
Author: Ankur Gupta &lt;ankur.gupta@intel.com&gt;
Date:   Wed Feb 10 14:36:16 2016 -0600

    Docstring omission in class BaseDiskFileManager.
    
    Added documentation for missing Docstring variables.
    
    Change-Id: I29a53b8141c5607815f234a6123e2289200bca34

commit 4906b4c431edc436f165b163a228b0a221950c79
Author: Janonymous &lt;janonymous.codevulture@gmail.com&gt;
Date:   Tue Jan 12 12:50:43 2016 +0530

    Fix missing txn_id logs in GreenAsyncPile's spawned functions
    
    This commit ensures that the logger thread_locals
    value is passed to and set in _get_conn_response methods
    executed in a green thread.
    
    Added partial bug tag because in bug description a more
    relevant fix is suggested which would fix the bug completely
    but for now this makes sense to add this commit for logging.
    
    Co-Authored-By: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
    Change-Id: I13bbf174fdca89318d69bb0674ed23dc9ec25b9a
    Partial-Bug: #1409302

commit 511a1b8698889c430bf673ed916ae41a96b99c5c
Author: Kazuhiro MIYAHARA &lt;miyahara.kazuhiro@lab.ntt.co.jp&gt;
Date:   Fri Feb 12 19:01:59 2016 +0900

    Remove execute permission from swift/cli/ringbuilder.py
    
    In Change-Id: Ia63f59a8faca1fad990784f27532ca07a2125454,
    'bin/swift-ring-builder' is renamed to 'swift/cli/ringbuilder.py'.
    However, execute permission and '#! /usr/bin/env python' are left on
    the file.
    
    This patch removes execute permission and '#! /usr/bin/env python'
    from the file.
    
    Change-Id: I66370f825ce9ed9a40ec21f2745aa6aff22c8709

commit 973d9358d2e6e029409d1902831b4680e02952c9
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Thu Feb 11 10:20:10 2016 +0100

    Bump PyECLib requirement to &gt;= 1.2.0
    
    This was discussed at last Swift meeting [1] and conclusion was
    to require newest PyECLib version.
    
    [1] http://eavesdrop.openstack.org/meetings/swift/2016/swift.2016-02-10-21.00.log.html#l-268
    
    Depends-On: I0fd58f26bc0a3e7715356ff74344981f22786152
    Change-Id: I54e89d99b48e00e614d2d457814c00354763c83b

commit d3dd137cad896c7f741592e88f076acab2636a3c
Author: Tomas Matlocha &lt;tomas.matlocha@firma.seznam.cz&gt;
Date:   Tue Jan 5 12:32:50 2016 +0100

    Additional info log message for drive-audit
    
    An additional info log message was added for case of
    running drive-audit without failed device unmounting.
    
    Change-Id: I11abee40a712b6c6de65e63626b6f7f0a9c9f4c7

commit c4158bd674f34c8a0648c98974ba474fcd1c2b7a
Author: Sarafraj Singh &lt;Sarafraj.Singh@intel.com&gt;
Date:   Thu Feb 11 20:52:47 2016 +0000

    Fixed params on autocreate_account docstring
    
    ... in proxy.controllers.base
    
    Change-Id: Ic5c27cbf0f19b65fcaa3e6587583f03e56d646a0

commit f56d18e143d0a38584e4c383ea9afe46e67a0af6
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Thu Feb 11 10:59:43 2016 -0800

    Fix typos in comments
    
    Change-Id: I4f98d447bd2ddd8eeb2f4da66d069bd7d6f00dc6

commit cc8dc88b55b44ca2a1fd65c049f3cfec22eb5525
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Thu Feb 4 16:02:42 2016 +0100

    Script for checking sanity of manpages
    
    Change-Id: Ia27b0ecf6a3267eb51f8a6562721dca72f128915

commit bcada66b9065c94cd39498a5330c727cc575a6fe
Author: root &lt;lr699s@att.com&gt;
Date:   Wed Feb 10 09:21:53 2016 -0600

    Removed unused parameter in server.py
    
    The variable max_large_object_get_time is no longer used and was
    removed to reflect the change.
    
    Change-Id: I43051181dcb38245de6d13fab63876e83f46fc39
    Closes-Bug: #1538834

commit b5311f63dbf5787bda3495a58c8ef7a6a557daa4
Author: gh159m &lt;gh159m@att.com&gt;
Date:   Wed Feb 10 10:36:59 2016 -0600

    Removed default value for log_statsd_host
    
    Multiple files and documents showed that log_statsd_host had
    a default value, usually localhost.  This was incorrect, instead
    setting a value for log_statsd_host enables statsd logging.
    
    Removed any reference of log_statsd_host having a default value.
    
    Also changed descriptions to show setting a value enables logging.
    
    Change-Id: I3ca5c0e8b8e4981de3aa6db0c476072b5a59723d
    Closes-Bug: #1542227

commit b98c1c60f9c581c76677c19baae60ae720e3c7f3
Author: Christian Berendt &lt;berendt@b1-systems.de&gt;
Date:   Tue Feb 9 07:32:48 2016 +0100

    Remove executable flag from sample config file
    
    swift.conf-sample should not be executbale
    
    Change-Id: I960058e2af10b43efc6324a7534d9a23c810e39a

commit 81a4355c2d0907035805c300a9fa5aaa6d0e70c4
Author: Christopher Bartz &lt;bartz@dkrz.de&gt;
Date:   Fri Feb 5 09:51:11 2016 +0100

    Adds storage policy option to recon
    
    With this patch, recon gets policy-aware in regard to the hosts to retrieve.
    If no policy is passed and the server_type is object,
    all hosts of all policies are retrieved.
    Previously, recon did only retrieve the hosts of the storage-policy 0.
    
    Change-Id: If5735cd6721eac504aed8aaf3884cb91b6a0fcac
    Closes-Bug: 1541491

commit 87fc21c7cfcce2a3e23a84fddcfd1309cd884716
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Mon Feb 8 15:31:42 2016 +0000

    Speed up functional testing
    
    test/functional/tests.py:TestObjectVersioningUTF8 does not clean
    up the versions files it creates because the class's multiple
    inheritance is such that it does not call the tearDown method in
    TestObjectVersioning.
    
    As a result, any attempt to clean up account containers wastes
    time retrying container delete requests. This occurs either in
    the setUp for TestSloEnv, if the TestSlo class is included in a
    test run, or in the tests.py package tearDown method.
    
    On the author's dev machine this patch reduces the execution
    time of functional tests in tests.py by approx 30% or 1 minute.
    
    Change-Id: I8194672bf2ca82435df5868720b6a55a79b94413

commit 3b94bd45406f9d457d37caa10c856a19c4cec22a
Author: Mingyu Li &lt;li.mingyu@99cloud.net&gt;
Date:   Sun Feb 7 21:41:08 2016 +0800

    Keep the Usage of exit()/sys.exit() Consistent
    
    It's better to keep the usage of exit()/sys.exit() consistent
    in one file. Furthermore, sys.exit() is considered good to be
    used in production code, while exit is for interactive shell.
    
    Change-Id: Ia3092853a648922588e2bc11db37d6decdec1b48

commit f05da4c8fa37a285bb2ca9b45a355dbe57f7add4
Author: janonymous &lt;janonymous.codevulture@gmail.com&gt;
Date:   Sat Feb 6 16:59:57 2016 +0530

    Changing the base version to python2.7 for pep8 checks
    
    tox was taking python3 as it's base version which lead to
    tox pep8 check failing on local env:
    http://paste.openstack.org/show/486183/
    
    Change-Id: Ia822ec5b5e12a1fc30b676f1e6d95e287b9b3368

commit 13edc9a865cd203ddf28a3f782426a1b3b94f7a1
Author: Sarafraj Singh &lt;Sarafraj.Singh@intel.com&gt;
Date:   Fri Feb 5 17:28:26 2016 +0000

    Improved test coverage of form_signature
    
    Added four new test cases to execute path of invalid arguments. This
    improved test coverage of file specified from 80% to 91%.
    
    Change-Id: I63c2e7bab3f01121301d78b687687208a58401c0

commit b173995666b026def3f6558d9a8c972b75449323
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Thu Feb 4 05:18:42 2016 -0800

    Fix missing Accept-Ranges
    
    Since commit 4f2ed8bcd0468f3b69d5fded274d8d6b02ac3d10, the response
    header for GET EC object doesn't include the Accept-Ranges header.
    
    This patch fixes it and also adds a few unittests to prevent regression.
    
    Closes-Bug: #1542168
    
    Change-Id: Ibafe56ac87b14bc0028953e620a653cd68dd3f84

commit d78e861d850db96989f4fb77ad31e3170034f15d
Author: Richard Hawkins &lt;richard.hawkins@rackspace.com&gt;
Date:   Wed Jan 13 13:15:07 2016 -0600

    Add option for label to static web listings
    
    By default listings are rendered with a label of:
    "Listing of /v1/account/container/path"
    
    This change adds a new custom metadata key/value pair
    "X-Container-Meta-Web-Listings-Label: &lt;label&gt;" that
    when set, will cause the following:
    "Listing of &lt;label&gt;/path" to be rendered instead.
    
    Change-Id: I47c5d21834f47e566b380920196926882ff83abf

commit ae632abbd802228ef98a23c98ee49988e7e5b942
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Tue Feb 2 21:58:52 2016 +0100

    Fixed manpages errors.
    
    account-server.conf.5
    105: warning: numeric expression expected (got `)')
    
    container-server.conf.5
    111: warning: numeric expression expected (got `)')
    
    object-expirer.conf.5
    79: warning: numeric expression expected (got `)')
    
    object-server.conf.5
    114: warning: numeric expression expected (got `)')
    
    proxy-server.conf.5
    121: warning: numeric expression expected (got `)')
    331: warning: numeric expression expected (got `[')
    1005: warning: macro `*' not defined
    
    Change-Id: I203dcfde83035e3b1dcb91109b72b5d08bb7840e

commit f2fca9aafa17e45b668c6f76b256927681cc463a
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Tue Feb 2 11:43:44 2016 +0000

    Fix time-shifting of objects PUT with container-sync
    
    When container-sync PUTs an object to a destination container
    it uses the timestamp from the container row rather than the
    actual timestamp of the object being copied. The actual timestamp
    of the object can be newer, so the sync'd object may end up with
    the right content but at the wrong, older, timestamp.
    
    This patch changes the timestamp sent with the sync'd object
    to be that of the actual source object being sent.
    
    Drive-by fix to make code more readable by removing a variable
    rename mid-function, fix a typo and remove a redundant function
    call.
    
    Change-Id: I800e6de4cdeea289864414980a96f5929281da04
    Closes-Bug: #1540884

commit 050e3b35dd88f7b31b6810d9ac88548ef371e3ce
Author: venkatamahesh &lt;venkatamaheshkotha@gmail.com&gt;
Date:   Thu Feb 4 16:47:15 2016 +0530

    Use uppercase 'S' in word "OpenStack"
    
    Change-Id: I4692aa58b5173b1b662d5eee19fac770ae5aaed0

commit e47aaaacf15e8f0c7226400541a97238447a7f56
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Wed Feb 3 12:52:29 2016 -0800

    Stop nesting functions unnecessarily
    
    Change-Id: Iff120d0bac8a075c37bbddcd2bb0fe85145f1749

commit 26327e1e8b1d37faa764ec586f5bee0e1560eea2
Author: Darrell Bishop &lt;darrell@swiftstack.com&gt;
Date:   Thu Jan 21 11:18:18 2016 -0800

    Allow IPv6 addresses/hostnames in StatsD target
    
    The log_statsd_host value can now be an IPv6 address or a hostname
    which only resolves to an IPv6 address.  In both cases, the new
    behavior is to use an AF_INET6 socket on which .sendto() is called
    with the originally-configured hostname (or IP).  This means the
    Swift process is not caching a DNS resolution for the lifetime of
    the process (a good thing).
    
    If a hostname resolves to both an IPv6 or IPv4 address, an AF_INET
    socket is used (i.e. only the IPv4 address will receive the UDP
    packet).
    
    The old behavior is preserved: any invalid IP address literals and
    failures in DNS resolution or actual StatsD packet sending do not
    halt the process or bubble up; they are caught, logged, and
    otherwise ignored.
    
    Change-Id: Ibddddcf140e2e69b08edf3feed3e9a5fa17307cf

commit 2f8e6040470948cf17c5fc5fddd0991a415d2a4c
Author: Eran Rom &lt;eranr@il.ibm.com&gt;
Date:   Wed Feb 3 08:59:53 2016 +0200

    Fixing typo in unit test
    
    The typo does not influence the correctness of the test
    yet its ugly. bhhha.
    
    Change-Id: I62e511bae23523892b87309dd3c50aea61742f2d

commit f27ad34e1d4e5dc306eed3ff620a294a4c301f31
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Tue Feb 2 11:44:39 2016 -0800

    Document use-case for slow option
    
    Change-Id: Iec4087a896a2277179e3720d802cca101fa7ad54

commit 16976a0f14ee2b5f7abc76086f9abfb9f337a655
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Sun Jan 31 10:30:06 2016 +0100

    Changed EC backend from jerasure to liberasurecode in examples and docs
    
    liberasurecode_rs_vand is build-in liberasurecode, so you don't need
    another depedency libjerasure2.
    
    liberasurecode_rs_vand is supported by pyeclib from 1.0.8
    version, so bumping version up.
    
    Closes-Bug: #1534325
    Change-Id: If2d96875694df8fd48c5278395859aaa165cb566

commit 30d74af6534b754e6ad9bfdcbff4ec494277ca83
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Wed Jan 27 13:50:57 2016 +0000

    Insert versioned_writes in correct pipeline position
    
    If not explicitly configured the versioned_writes middleware
    should be auto-inserted in the pipeline after slo and dlo, which
    is where the versioned_writes filter section's comments say it
    should be in proxy-server.conf-sample. At the moment it can end up
    being placed ahead of slo and dlo if they have been explicitly
    configured, which results in the linked bug manifesting.
    
    Closes-Bug: #1537042
    Change-Id: I6ac95a331f4ef0d4887311940acc6f8bc00fb4eb

commit ccdf4a9f309af5fe1401a6e4b776b08c3f6a655c
Author: Christian Schwede &lt;cschwede@redhat.com&gt;
Date:   Tue Feb 2 09:38:55 2016 +0100

    Document slow option in etc/object-server.conf
    
    Change-Id: Ic9940b0b830a468887878f7b0d7ca42c2cbbebd5

commit b19dc1ddecdc68760ca2f5a2b7b4bbdce2199b35
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Mon Feb 1 15:30:59 2016 -0800

    Always fix devices with multiple part-replica assignments
    
    I've found that given a sufficiently bad replica2part2dev table we can
    accidently not entirely fix palcement when more than two replicas of a
    part are assigned to the duplicate devices.
    
    It shows up most on &gt; 3 replica rings when you have two *different*
    devices both holding two replicas.  But you can see it on a three
    replica ring when all three replicas are assigned to the same device.
    
    Change-Id: Ieb213c1a259815a2ed657291242919cda568c7b5

commit c722fa1ab318b233fc11f8e1bd8758dbe33e87bb
Author: dangming &lt;dangming@unitedstack.com&gt;
Date:   Mon Feb 1 16:13:54 2016 +0800

    Fix spelling error
    
    Change-Id: I4a1400c4d383acd59727ada3661a8dffc67825fb

commit c7e5e125003de1a0f288f79783e9a41650e6f686
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Fri Jan 29 14:22:19 2016 +0000

    Enable in-process func tests to optionally use fast-post
    
    Running functional tests in the in-process mode uses
    the default value for proxy-server object_post_as_copy,
    which is True. This patch adds support for an environment
    variable to change this value to False so that the fast-post
    mode is tested when running in-process functional tests.
    
    The patch also adds a new tox environment func-in-process-fast-post
    which forces in-process functional testing with
    object_post_as_copy=False.
    
    The motivation for this change, apart from enabling configurable
    local testing, is to put support in place for an upstream CI job
    that will actually functionally test the fast-post mode, which is
    otherwise only covered by unit tests.
    
    There are currently two gate jobs that run the functional tests:
    
    - gate-swift-dsvm-functional runs the tests *twice* against a
      devstack swift service, once using tempauth and once using
      keystoneauth. The devstack swift service uses the default
      object_post_as_copy=True.
    
    - gate-swift-tox-func runs the func tests in in-process mode
      which also uses tempauth and object_post_as_copy=True. This
      duplicates one of the config scenarios above.
    
    With this change either the gate-swift-tox-func job or a new job
    could run the functional tests using object_post_as_copy=False.
    
    Change-Id: Ia37f6df1dc38e44ef7404fbf0a52f6fc22fae0c2

commit 4ba290bac19b1b6e8f709848fd35cda33b8bd1c4
Author: Qiaowei Ren &lt;qiaowei.ren@intel.com&gt;
Date:   Mon Feb 1 16:44:52 2016 +0800

    Replace exit() by sys.exit()
    
    sys.exit() is considered good to use here.
    
    Change-Id: I365b0dbb50c8f1953b41665ba49145ac6db1b24f

commit 9aff76bd18e609eb657db14f2d60e605ee28d472
Author: Qiaowei Ren &lt;qiaowei.ren@intel.com&gt;
Date:   Mon Feb 1 17:15:32 2016 +0800

    fix typo
    
    informations -&gt; information
    
    Change-Id: I6bcb9bb9fd24b873b49de4a686b223550dd703ac

commit a8e0dc550bf35010595ce791433cd68c4b8d5287
Author: OpenStack Proposal Bot &lt;openstack-infra@lists.openstack.org&gt;
Date:   Sun Jan 31 06:15:17 2016 +0000

    Imported Translations from Zanata
    
    For more information about this automatic import see:
    https://wiki.openstack.org/wiki/Translations/Infrastructure
    
    Change-Id: If1cd20e187720f5ee02c6a1574f612c8a8e26e30

commit 02c06585e6e0403d1a983fccaba5093e3d3fa7c5
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Fri Jan 29 22:46:50 2016 +0100

    Renamed variable for better code readability
    
    Change-Id: I22d8db0dd9edc39672fc9997895a24f669975e15

commit 595ec464e3fdc5a766eee9baa06edd074576c73e
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Fri Jan 29 15:28:56 2016 +0000

    Trivial fix for sphinx warnings
    
    Including a * in the param name causes a sphinx warning,
    messes up the html formatting, and strictly the * isn't part of
    the param name.
    
    Change-Id: I6be6a7aa2a371eaae9f8e501435838c1e15f4a1c

commit cc90834a8ed7bd84440bf132a94978a47ee2f3da
Author: Mingyu Li &lt;li.mingyu@99cloud.net&gt;
Date:   Fri Jan 29 03:48:47 2016 +0900

    A minor modification of the Deployment Guide
    
    In the section of General Service Tuning, there is a sentence
    "Our Storage servers all run together on the same servers".
    The word "servers" is used twice with different meanings, which
    would be a little confusing. This patch makes it more understandable.
    
    Change-Id: I6d806456aeb7d0ecf297c04dacbd271b94a0425c
    Closes-Bug: #1526697

commit a1776b9c1f23fbd604114b377434e4269d2f1a2e
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Thu Jan 28 16:47:37 2016 +0000

    Let equal Timestamps not be unequal
    
    Make the result of Timestamp(x) != Timestamp(x) be False.
    
    In python 2.7 this requires the __ne__ method to be defined [1].
    "The truth of x==y does not imply that x!=y is false." The
    functools.total_ordering decorator does not autocreate a __ne__
    method.
    
    In python 3 the __ne__ method is not required [2]. "By default,
    __ne__() delegates to __eq__() and inverts the result".
    
    This patch puts back the __ne__ method removed in [3]. Whilst no tests
    fail on master with python2.7, they do on this patch [4] and it seems
    dangerous to have this absurd behaviour lurking.
    
    [1] https://docs.python.org/2/reference/datamodel.html#object.__ne__
    [2] https://docs.python.org/3.4/reference/datamodel.html#object.__ne__
    [3] Change-Id: Id26777ac2c780316ff10ef7d954c48cc1fd480b5
    [4] Change-Id: Ia597cd460bb5fd40aa92e886e3e18a7542603d01
    
    Change-Id: I01fbfa310df3c74390f8e8c2e9ffff81bbf05e47

commit c3886eea15f11104764fb201e85202dd871c3027
Author: Thomas Goirand &lt;thomas@goirand.fr&gt;
Date:   Thu Jan 28 09:15:28 2016 +0000

    Fix a few English mistakes in man
    
    These errors are producing lintian warnings, so fixing them
    helps having less errors when checking for Debian packages.
    
    Change-Id: Iff99a8d5f2276515f42d758d110a43cae757db28

commit 400cc707273bab0b70a3cdf5dec1c55c2edc4e22
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Wed Jan 27 15:35:40 2016 +0000

    Remove a print statement from tests
    
    Change-Id: I213b7e4bc4f9e6de76ebab572c377af61072d9c5

commit c871e423ef0bed6c774693af3d54750235d6ce1f
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Fri Jan 22 05:19:06 2016 +0000

    Add unit tests for checking responses in AccountController
    
    This patch provides unit tests to check responses for various situation
    in three/four replicas env.
    
    Change-Id: I1af48728b28da9780a2a78f3110e1c7487047ff8

commit e45d30d6b7b596b80c63e75018ad07582d705ee1
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Wed Jan 27 10:18:37 2016 +0000

    Remove unnecessary code from test_account.py
    
    Change-Id: Ia197ba08a606421244d5b94a900bdc39bc5da647

commit f39cffbb5f7f1853f7f67261c4652b9875d302be
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Tue Jan 26 20:16:08 2016 -0800

    Follow up mem_server diskfile fixes
    
    This is a follow-up patch for change
    https://review.openstack.org/#/c/270422
    
    That patch fixes POST behavior on object mem server and adds
    some tests for last-modified. However, that one doesn't check
    the POST updates the last-modified on object server.
    
    This patch adds assertions to make sure the actual POST semantics.
    
    *bonus* Add docs and cleanup variable name to fit actual instance
    at mem diskfile.
    
    Change-Id: I78185cdfb0ea604b2122821870ec34322236f48d

commit 9ef15453fadb847db0f0fb92e935785b544da3fc
Author: Kazuhiro MIYAHARA &lt;miyahara.kazuhiro@lab.ntt.co.jp&gt;
Date:   Thu Jan 21 14:18:31 2016 +0900

    Fix handling of "Permission Denied" error from NamedTemporaryFile function
    
    If "Permission Denied" has happen in NamedTemporaryFile function in
    dump_recon_cache method, swift will log a message of reference to a variable
    without assignment and not log a message of "Permission Denied".
    This patch fixes the handling and add an unit test.
    
    Co-Authored-By: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
    Change-Id: Iafdd94905e9e9c81f5966a923324b50c18fcf592

commit 01410129dac6903ce7f486997a48e36072fa0401
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Fri Aug 21 18:15:25 2015 -0700

    Make handoffs_first a more useful "mode"
    
    Based on experience using handoffs_first and feedback from other
    operators it has become clear that handoffs_first is only used during
    periods of problematic cluster behavior (e.g. full disks) when
    replication attempts are failing to quickly drain off the partitions
    from the nodes which they have been rebalanced from.
    
    In order to focus on the most important work (getting handoff partitions
    off the node) handoffs_first mode will abort the current replication
    sweep before attempting any primary suffix syncing if any of the handoff
    partitions were not removed for any reason - and start over with
    replication of handoffs jobs as the highest priority.
    
    Note that handoffs_first being enabled will emit a warning on start up,
    even if no handoff jobs fail, because of the negative impact it can have
    during normal operations by dog piling on a node that was temporarily
    unavailable.
    
    Change-Id: Ia324728d42c606e2f9e7d29b4ab5fcbff6e47aea

commit 78cfb137d5d3d6f4770923a1fb086adaa9c0676f
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Wed Nov 11 19:05:09 2015 -0800

    Ring Overview updates
    
    Change-Id: Ic5a8ec5be9fec7fa812fdb7b91890d5fc2fbf967

commit 24227e8bb0d4d369eeab61ab5c20730b4f84b36a
Author: Richard Hawkins &lt;richard.hawkins@rackspace.com&gt;
Date:   Wed Jan 13 10:16:29 2016 -0600

    _get_info_cache should encode unicode metadata
    
    Closes-Bug: 1533768
    Change-Id: I67bbd0e8802d2a34cb3a0b0fafe26bbc62221032

commit fc9a3852e44b2bf1258fcb24a6c12ecfb2795f44
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Mon Jan 25 09:25:20 2016 -0800

    Don't .lower() a literal
    
    It feels silly, and we don't do it for any of the other headers in
    headers_to_container_info.
    
    While we're at it, clean up a stray '
    
    Change-Id: I0745038cc3832a77d064e515c37cacbdcb97c4d9
    Related-Change: Iea3d06de80210e9e504e296d4572583d7ffabeac

commit 5c6576d1eb3c4c042bb46dd48f23d2fd474eba07
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Mon Jan 25 18:20:45 2016 +0100

    Fixed docs: Title underline too short
    
    Change-Id: If96b0e799a4671e7b7f3f5bea2628db75afa9578

commit 9c403d5e1bb1f404445f1731e3ff1b5c034336a6
Author: Victor Stinner &lt;vstinner@redhat.com&gt;
Date:   Mon Oct 19 16:31:12 2015 +0200

    Port swift.common.utils.Timestamp to Python 3
    
    * Fix Timestamp.isoformat(): on Python 3, round manually to use the
      same rounding method than Python 2.
    * Use @functoos.total_ordering on Timestamp instead of the __cmp__()
      special method. On Python 3, the __cmp__() method is no more used,
      and other special methods must be defined (__eq__, __lt__, etc.).
      Only define __eq__() and __lt__() methods but use
      @functools.total_ordering to generate other methods.
    * Fix also a Python 3 issues in swift.common.swob._datetime_property:
      replace (float, int, long) with (float,) + six.integer_types. The
      long type was renamed to int in Python 3.
    
    Change-Id: Id26777ac2c780316ff10ef7d954c48cc1fd480b5

commit c790db89369221473bcbfc23f301424ab8d30d60
Author: Andrew Welleck &lt;awellec@us.ibm.com&gt;
Date:   Mon Jan 25 10:03:18 2016 -0600

    Additional step for Debugging Issues in SAIO
    
    Adding an additional debugging step for the SAIO "Debugging Issues"
    section. Adding step to check if memcache is running and to start
    it if its not.
    
    Change-Id: I0bfa563f595dbefcf907494451fad45e6310db88

commit d47155af262d52c284f262bf6c303d0587000bba
Author: Victor Stinner &lt;vstinner@redhat.com&gt;
Date:   Mon Oct 19 17:22:24 2015 +0200

    Add __next__() methods to utils iterators for py3
    
    On Python 3, next(obj) calls obj.__next__(), not obj.next(). Add an
    alias from __next__() to next() to be compatible with Python 2 and
    Python 3.
    
    Change-Id: Ida104d3bd7cdba557e523f18df43d56847060054

commit 0f8319dceb2d21a9d1ec74f78203b033f25c0969
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Fri Jan 22 13:31:34 2016 -0800

    Use calendar.timegm not time.mktime
    
    time.mktime produces a POSIX timestamp that takes into account the local
    timezone, but we're parsing a Last-Modified header with a known (GMT)
    timezone. As a result, if one proxy-server is configured with a timezone
    other than GMT/UTC, we may have previous versions in the wrong order.
    
    Change-Id: I320e2368b243f4245725e73bfabc7ad19bc5bacb

commit 72d972166ff66d3c5313356c1e1e3984fee9f012
Author: paul luse &lt;paul.e.luse@intel.com&gt;
Date:   Thu Jan 21 13:30:15 2016 -0700

    Update AUTHORS
    
    +Luse core emeritus
    
    Change-Id: Ie175f410ddc24a2d5e64bc191364418a3c450f3f

commit 2f8105e5fcf4ecee2202797ba1ab48fa8fb1a1f6
Author: Alistair Coles &lt;alistair.coles@hpe.com&gt;
Date:   Wed Jan 20 18:14:16 2016 +0000

    Fix bug in mem_diskfile write_metadata method
    
    The mem_diskfile DiskFile.write_metadata method was
    apparently never called in any existing test, as if it
    were it would blow up as reported in the bug.
    
    This patch fixes the method and adds a test that
    exercises it. The test addition itself should be useful
    since it verifies the behaviour of Last-Modified after
    POSTs to an object.
    
    Drive-by fixes for bad docstring and undefined references
    in the _quarantine method.
    
    Change-Id: I17fd62e5f02be5b48bfd9ba7fa25315e30a0a4bf
    Closes-Bug: #1536037

commit e13a03c379273ee10e678818078b9c40a96a7dc9
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Wed Jan 20 16:06:26 2016 -0800

    Stop overriding builtin range
    
    Change-Id: I315f8b554bb9e96659b455f4158f074961bd6498

commit 0a404def7d54d1ef1c85c11a378052260c4fda4c
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Wed Jan 20 15:19:35 2016 -0800

    remove unneeded duplicate dict keys
    
    Change-Id: I926d7aaa9df093418aaae54fe26e8f7bc8210645

commit 221f94fdd39fd2dcd9a2e5565adceab615d55913
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Tue Jan 19 14:50:24 2016 -0800

    authors and changelog updates for 2.6.0
    
    Change-Id: Idd0ff9e70abc0773be183c37cd6125fe852da7c0

commit 58359269b0e971e52f0eb7f97221566ca2148014
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Dec 8 16:36:05 2015 -0800

    Fix memory/socket leak in proxy on truncated SLO/DLO GET
    
    When a client disconnected while consuming an SLO or DLO GET response,
    the proxy would leak a socket. This could be observed via strace as a
    socket that had shutdown() called on it, but was never closed. It
    could also be observed by counting entries in /proc/&lt;pid&gt;/fd, where
    &lt;pid&gt; is the pid of a proxy server worker process.
    
    This is due to a memory leak in SegmentedIterable. A SegmentedIterable
    has an 'app_iter' attribute, which is a generator. That generator
    references 'self' (the SegmentedIterable object). This creates a
    cyclic reference: the generator refers to the SegmentedIterable, and
    the SegmentedIterable refers to the generator.
    
    Python can normally handle cyclic garbage; reference counting won't
    reclaim it, but the garbage collector will. However, objects with
    finalizers will stop the garbage collector from collecting them* and
    the cycle of which they are part.
    
    For most objects, "has finalizer" is synonymous with "has a __del__
    method". However, a generator has a finalizer once it's started
    running and before it finishes: basically, while it has stack frames
    associated with it**.
    
    When a client disconnects mid-stream, we get a memory leak. We have
    our SegmentedIterable object (call it "si"), and its associated
    generator. si.app_iter is the generator, and the generator closes over
    si, so we have a cycle; and the generator has started but not yet
    finished, so the generator needs finalization; hence, the garbage
    collector won't ever clean it up.
    
    The socket leak comes in because the generator *also* refers to the
    request's WSGI environment, which contains wsgi.input, which
    ultimately refers to a _socket object from the standard
    library. Python's _socket objects only close their underlying file
    descriptor when their reference counts fall to 0***.
    
    This commit makes SegmentedIterable.close() call
    self.app_iter.close(), thereby unwinding its generator's stack and
    making it eligible for garbage collection.
    
    * in Python &lt; 3.4, at least. See PEP 442.
    
    ** see PyGen_NeedsFinalizing() in Objects/genobject.c and also
       has_finalizer() in Modules/gcmodule.c in Python.
    
    *** see sock_dealloc() in Modules/socketmodule.c in Python. See
        sock_close() in the same file for the other half of the sad story.
    
    This closes CVE-2016-0738.
    
    Closes-Bug: 1493303
    
    Co-Authored-By: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
    
    Change-Id: Ib86c4c45641485ce1034212bf6f53bb84f02f612

commit d9b22ac51cca579e97ec7bd5a6df3ad7bf56c3bf
Author: Victor Stinner &lt;vstinner@redhat.com&gt;
Date:   Mon Oct 19 16:45:33 2015 +0200

    Port parse_mime_headers() to Python 3
    
    Port swift.common.utils.parse_mime_headers() to Python 3:
    
    * On Python 3, tries to decode headers from UTF-8. If an header was
      was not encoded to UTF-8, decode the header from Latin1.
    * Update the parse_mime_headers() tests: on Python 3, HTTP header
      values are Unicode strings.
    
    This change is a follow-up of the change
    Ia5ee2ead67e36e8c6416183667f64ae255887736.
    
    Change-Id: I042dd13e9eb0e9844ccd832d538cdac84359ed42

commit cec2aa0b4dbf0e1bf2de62945f5abdf494925a8e
Author: Victor Stinner &lt;vstinner@redhat.com&gt;
Date:   Fri Oct 9 17:56:39 2015 +0200

    py3: Use the six module in the xprofile middleware
    
    * Replace bytes_() with a isinstance(content, six.text_type)
      and content.encode('utf-8')
    * Get parse_qs() from six.moves.urllib.parse
    
    Change-Id: I4a506975814bff098ade25c950c154e50dc9626e

commit bc4b298b6e208d3188641712c9d66ae82d172c14
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Jan 19 15:33:13 2016 -0800

    Fix a comment's indentation
    
    Change-Id: I34514525b606cf82767ddce7769bc42fa5457717

commit 6c32da14f48b435aa4e5efea48904bd288a532a2
Author: Victor Stinner &lt;vstinner@redhat.com&gt;
Date:   Mon Oct 19 16:38:24 2015 +0200

    Port FileLikeIter to Python 3
    
    Port FileLikeIter and _MultipartMimeFileLikeObject and
    swift.common.utils to Python 3:
    
    * Add a __next__() alias to the next() method. On Python 3, the
      next() method is no more used, __next__() is required.
    * Use literal byte strings: FileLikeIter _MultipartMimeFileLikeObject
      are written to handle binary files.
    * test_close(): replace .FileLikeIter('abcdef') with
      FileLikeIter([b'a', b'b', b'c']). On Python 3, list(b'abc') returns
      [97, 98, 99], whereas ['a', 'b', 'c'] is returned on Python 2.
    * Update unit FileLikeIter tests to use byte strings.
    
    Change-Id: Ibacddb70b22f624ecd83e374749578feddf8bca8

commit caa127d59a63a25cc6d08e985e536f90300a6156
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Thu Nov 12 11:34:44 2015 -0800

    Monkeypatch everything the same
    
    There's three spots in the code where eventlet monkeypatches
    things. In one place, it was monkeypatching socket and thread; in the
    other two, only socket. This commit monkeypatches socket and thread
    everywhere.
    
    Hopefully, this lets us avoid code that, for example, works in the
    object server but fails in the object updater.
    
    Change-Id: Ia30d069c5ac89f4bfbe52233d03d96738144b614

commit 3a0486e532f22af0d3c8a5c5d78613c22e786ff6
Author: Sivasathurappan Radhakrishnan &lt;siva.radhakrishnan@intel.com&gt;
Date:   Fri Dec 4 17:43:00 2015 +0000

    Deleted comment about part power in FakeRing
    
    Deleted comment about parameter part power in Class FakeRing as its
    behavior got dropped in I8bfc388a04eff6491038991cdfd7686c9d961545.
    
    Change-Id: Iec7d2565a77e48493b0056021066d8d8eab65d0b
    Closes-Bug:  #1488704

commit 999479f9b17b42ccc5da54ce01651960cf7cf970
Author: John Dickinson &lt;me@not.mn&gt;
Date:   Tue Jan 19 10:30:30 2016 -0800

    Bump eventlet min version to 0.17.4
    
    IPv6 support in Swift is dependent on IPv6 support in eventlet.
    eventlet itself only claims support for IPv6 post v0.17
    (https://github.com/eventlet/eventlet/issues/8). This update matches
    the OpenStack global requirements version.
    
    Change-Id: I9d8433cdd3bf7d7a93b8f50b991cc21721a80d22

commit 133a3ea601a3fea84af36a42845f27b8182fd901
Author: Christopher Bartz &lt;bartz@dkrz.de&gt;
Date:   Mon Dec 21 14:17:00 2015 +0100

    Use the correct split_path in handle_request
    
    Change-Id: I86d423309f0b2091ee2e82b2245caf925b6a75ef
    Closes-Bug: #1528189

commit 09b188f03c4a40838ea6b3e54e0714d93077b066
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Thu Jul 16 09:35:37 2015 +0900

    Add functional test for access control (RBAC) with Keystone
    
    This patch adds test cases for PUT, DELETE, GET, HEAD, POST and OPTIONS
    requests to accounts, containers and objects using various combinations
    of users/projects, roles and/or service tokens.
    
    Change-Id: Iea8141ac74ad949a3ae7fa47fda3135d0f2612f6

commit bf10974cdefffdaaebc58d21e8a9912638a0405a
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Wed Dec 16 15:46:13 2015 -0800

    Expose token expiration time in tempauth auth response
    
    Previously, we gave no indication of when a token would expire. Users
    would have to just use it until it stopped working, then re-auth.
    Now, a successful auth response will include a new header,
    X-Auth-Token-Expires, with the number of seconds remaining until the
    token is invalid. This allows the client to attempt to re-auth before
    sending a request that will definitely fail.
    
    For comparison, swauth already uses the X-Auth-Token-Expires header with
    identical semantics. Additionally, Keystone (v2 and v3) already exposes
    expiration times in its JSON responses. The security impact should be
    minimal.
    
    Change-Id: I5a4a74276bc0df6dda94e4bc150065c0d77de0eb

commit f56f29ef7a692b6c3204e25d41eace3d68dceece
Author: Peter Lisák &lt;peter.lisak@firma.seznam.cz&gt;
Date:   Thu Dec 3 16:48:18 2015 +0100

    Add info about state of ring file to default command.
    
    Try to find ring file, load and compare it with builder file, then show result state.
    Examples:
    Ring file object.ring.gz not found, probably it hasn't been written yet
    Ring file object.ring.gz is up-to-date
    Ring file object.ring.gz is obsolete
    Ring file object.ring.gz is invalid: ValueError('string length not a multiple of item size',)
    
    Change-Id: I4d769aa5fe1c2b1167ec088aa372874f7d13ae48

commit 47e226418bad35ccad2a1525f392ba69f6165027
Author: OpenStack Proposal Bot &lt;openstack-infra@lists.openstack.org&gt;
Date:   Mon Jan 18 06:20:14 2016 +0000

    Imported Translations from Zanata
    
    For more information about this automatic import see:
    https://wiki.openstack.org/wiki/Translations/Infrastructure
    
    Change-Id: Ic416c9afc8a1c76f552803a7c70fc905eda7b3cb

commit 165fa1fd40b5e4b13cf5188712593e2275bef821
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Fri Jan 15 11:44:21 2016 -0800

    add test for zero weight region get_more_nodes
    
    Change-Id: If537981e8deadd9c3528dcb30a15011c7781e334

commit 5d449471b12c67b31ebb5a383d9bb35bace36213
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Thu Jan 14 17:26:01 2016 -0800

    Remove some Python 2.6 leftovers
    
    Change-Id: I798d08722c90327c66759aa0bb4526851ba38d41

commit 3c0cf549f1e822cce8f905b069b317e676cf306b
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Wed Jan 13 18:08:45 2016 -0800

    Speed up get_more_nodes() when there is an empty zone
    
    The ring has some optimizations in get_more_nodes() so that it can
    find handoffs that span all the regions/zones/et cetera and then stop
    looking. The stopping is the important part.
    
    Previously, it would quickly find a handoff in each unused region,
    then spend way too long looking for more unused regions; the same was
    true for zones, IPs, and so on. Thus, in commit 9cd7c6c, we started
    counting regions and zones, then stopping when we found them all.
    
    This count included all regions and zones in the ring, regardless of
    whether or not there were actually any parts assigned or not. In rings
    with an empty region, i.e. a region for which there are only
    zero-weight devices, get_more_nodes() would be very slow.
    
    This commit ignores devices with no assigned partitions when counting
    regions, zones, and so forth, thus greatly speeding things up.
    
    The output of get_more_nodes() is unchanged. This is purely an
    optimization.
    
    Closes-Bug: 1534303
    
    Change-Id: I4a5c57205e87e1205d40fd5d9458d4114e524332

commit 70047709fc9885df7019f791e17a3240682cc6cb
Author: keliang &lt;ke.liang@easystack.cn&gt;
Date:   Fri Jan 15 00:31:51 2016 +0800

    Drop python 2.6 support
    
    Change-Id: Id6329c863dacb189fccfc304453ed7b6f9607c14

commit a4c2fe95ab2fbe59379a69914ed0fac49c28efbb
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Tue Jan 12 21:26:33 2016 +0100

    Allow to change auditor sleep interval in config
    
    Change-Id: Ic451c5e0b686509f8982ed1bf65a223a2d77b9a0

commit edc823e8030640184071fee4920d34f9a1cc6b3e
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Sun Nov 29 18:46:47 2015 +0100

    Show UTC time in swift-recon.
    
    It's not consistent now for example local time in replication part and
    UTC time at begging of line. Use _ptime in swift-recon for all time
    printing and this function returns UTC now.
    Change-Id: I732d9851db157130a08e825e8093b7e244b63e9c

commit fa5b32d27964478dfcccf71155d2aaa946c561f0
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Tue Jan 12 14:18:30 2016 -0800

    Make object-auditor storage-policy-aware
    
    Previously, the object-auditor would always use a (replication)
    DiskFileManager when walking through AuditLocations, which would cause
    it to skip EC fragment archives with a warning like:
    
        Unexpected file &lt;hash_path&gt;/1452557187.03610#3.data:
        Invalid Timestamp value in filename '1452557187.03610#3.data'
    
    Now, the AuditLocation's policy will be used to find an appropriate
    manager to get the diskfile. Additionally, several .commit()s were added
    to the auditor tests so the .durable will be written, which is required
    when auditing EC fragment archives.
    
    Change-Id: I960e7d696fd9ad704ca1872b4ac821f9078838c7
    Closes-Bug: 1533002

commit 725a166ebd3fde2c34f2c9578ff6f9911cf206d7
Author: Timur Alperovich &lt;timuralp@swiftstack.com&gt;
Date:   Fri Jan 8 18:42:33 2016 -0800

    Make _get_addr() method a function in utils.
    
    The patch moves the MemcacheConnPool._get_addr() method a function in
    swift.common.utils. The function is renamed to parse_socket_string()
    and the documentation is updated accordingly. The test for it has also
    been moved.
    
    Change-Id: Ida65b2fded28d0a059e668646f5b89714298f348

commit 0647aea9c5fc95f0860758cc54bc23f965da460d
Author: Timur Alperovich &lt;timuralp@swiftstack.com&gt;
Date:   Fri Jan 8 14:54:56 2016 -0800

    Fail early if the memcache address is invalid.
    
    In cases when the memcache address is invalid, we should fail early.
    This patch addresses the cases when the IPv6 addresses are not
    enclosed in "[]". It does not, however, fix the case of an invalid
    hostname. These improvements could also be added to the _get_addr()
    method.
    
    Change-Id: I4743dcda45a1fc1640989325c4a2e1fea591fc69

commit 33476460239c9cdb08dd8065d22d84a4717da7be
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Fri Jan 8 16:15:54 2016 -0800

    fixups for ipv6 memcache_servers docs
    
    Change-Id: I20d91c1e276014eaf210fa9eb43788bc17f4e8df

commit d5ff5447be30b44bf4acc8b912b6241a44f710be
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Tue Jan 12 16:42:06 2016 -0800

    Install liberasurecode packages in SAIO.
    
    Change-Id: If673afa2b61a3e388612debf4860d561960963a3

commit 4ffc4ba411f67c8407ba38d082a3a51a96ad7e04
Author: Jonathan Hinson &lt;jlhinson@us.ibm.com&gt;
Date:   Tue Jan 12 11:46:21 2016 -0600

    Functional tests for if-match with multiple etags
    
    Multiple etags can be provided on an if-match or if-none-match
    request. This is currently being tested in the unit tests, but not
    in the functional tests. Since these etags can be modified by
    middleware, we need functional tests to assert multiple-etag
    requests are handled correctly.
    
    Change-Id: Idc409c85e8aa82b59dc2bc28af6ca2617de82699

commit 1292361176aec385137dd5873c5cc9714de1fa17
Author: Clay Gerrard &lt;clay.gerrard@gmail.com&gt;
Date:   Mon Jan 11 16:25:50 2016 -0800

    functest for x-timestamp validation
    
    Change-Id: I05af7d837af00cd1059a8912df05c131a52ffb90

commit e6194113a3c81563590eabf8f761ccb988bb917c
Author: Tim Burke &lt;tim.burke@gmail.com&gt;
Date:   Fri Jan 8 16:38:31 2016 -0800

    Validate X-Timestamps
    
    Previously, attempting to PUT a new object with an X-Timestamp header
    less than or equal to zero (ie, for a timestamp on or before 1970-01-01
    00:00:00) would cause the object-server to 500.
    
    While we're at it, cap X-Timestamp at 9999999999 (2286-11-20 17:46:40)
    so we don't get an eleventh digit before the decimal point.
    
    Closes-Bug: 1532471
    Change-Id: I23666ec8a067d829eaf9bfe54bd086c320b3429e

commit 1f3304c5153e01988b8f4493875b6489e93f76d0
Author: Ben Martin &lt;blmartin@us.ibm.com&gt;
Date:   Mon Dec 14 15:28:17 2015 -0600

    Print min_part_hours lockout time remaining
    
    swift-ring-builder currently only displays min_part_hours and
    not the amount of time remaining before a rebalance can occur.
    This information is readily available and has been displayed
    as a quality of life improvement.
    
    Additionally, a bug where the time since the last rebalance
    was always updated when rebalance was called regardless of
    if any partitions were reassigned. This can lead to partitions
    being unable to be reassigned as they never age according to
    the time since last rebalance.
    
    Change-Id: Ie0e2b5e25140cbac7465f31a26a4998beb3892e9
    Closes-Bug: #1526017

commit 167bb5eeb82886d67c1b382417fb22b8ea85f0d3
Author: Timur Alperovich &lt;timuralp@swiftstack.com&gt;
Date:   Wed Dec 16 12:07:27 2015 -0800

    Fix IPv6 handling in MemcacheConnPool.
    
    The patch removes the assumption of IPv4-only addresses in the
    MemcacheConnPool. The changes are around address handling.
    Namely, if a server is specified with an address
    [&lt;address&gt;]:port (port is optional), it is assumed to be an IPv6
    address [1]. If an IPv6 address is specified without "[]", an exception
    is raised as it is impossible to parse such addresses correctly.
    
    For testing, memcache can be configured to listen on the link-local,
    unique-local, or ::1 (equivalent to 127.0.0.1) addresses. Link-local
    addresses are assigned by default to each interface and are of the form
    "fe80::dead:beef". These addresses require a scope ID, which would look
    like "fe80::dead:beef%eth0" (replacing eth0 with the correct interface).
    
    Unique-local addresses are any addresses in the fc00::/7 subnet. To add
    a ULA to an interface use the "ip" utility. For example:
    "ip -6 address add fc01::dead:beef dev eth0". Lastly, and probably
    simplest, memcache can be configured to listen on "::1". The same
    address would be used in the swift configuration, e.g. "[::1]:11211".
    
    Note: only memcached version 1.4.25 or greater supports binding to an
    IPv6 address.
    
    Fixes #1526570
    
    [1] IPv6 host literals:
    https://tools.ietf.org/html/rfc3986#section-3.2.2
    
    Change-Id: I8408143c1d47d24e70df56a08167c529825276a2

commit fb6751d8ba133c57e1ebb76be71a96f2f120b8ca
Author: Paul Dardeau &lt;paul.dardeau@intel.com&gt;
Date:   Fri Jan 8 22:49:05 2016 +0000

    Look for device holes that can be reused when adding new device.
    
    Change-Id: I1980ebdd9dc89848173d8ca2fe2afb74029dcfa2
    Closes-Bug: 1532276

commit b35f3c90bde8a7ccb50440bda5800cbb8274a5a1
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Fri Jan 8 01:29:11 2016 -0800

    Add note COPY with conditional headers
    
    Swift now supports Range header for COPY (or PUT with X-Copy-From)
    to make a partial copied object. This patch adds the note to show
    it obviously supported in Swift community.
    
    Change-Id: I6bf28f0932c90e7b305cd61aabce4ed028ae691e
    Partial-Bug: #1532126

commit 23c7a58f8f1412c28b3a16b79be09c224c9f7d55
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Fri Dec 11 18:26:34 2015 +0900

    Fix ClientException handling in Container Sync
    
    swift/container/sync.py uses swift.common.internal_client.delete_object
    and put_object and expected these methods raise ClientException.
    But delete_object and put_object never raise the exception so this patch
    raises ClientException when urllib2 library raises HTTPError.
    
    Co-Authored-By: Eran Rom &lt;eranr@il.ibm.com&gt;
    Closes-Bug: #1419901
    Change-Id: I58cbf77988979a07998a46d9d81be84d29b0d9bf

commit 6786cdf036b4faabe3928c3d0dd9615d94834801
Author: Harshada Mangesh Kakad &lt;harshadak@metsi.co.uk&gt;
Date:   Thu Dec 31 01:44:00 2015 -0800

    Fixing the deprecated library function.
    
    os.popen() is deprecated since version 2.6. Resolved with use of
    subprocess module.
    
    Change-Id: I4409cdd9edbc1a26d6f99c125c9100fadda5d758
    Partial-Bug: #1529836

commit 85a0a6a28e166bc076cf8786de2b46248d8786a2
Author: Eran Rom &lt;eranr@il.ibm.com&gt;
Date:   Sun Jul 26 13:31:17 2015 +0300

    Container-Sync to iterate only over synced containers
    
    This change introduces a sync_store which holds only containers that
    are enabled for sync. The store is implemented using a directory
    structure that resembles that of the containers directory, but has
    entries only for containers enabled for sync.
    The store is maintained in two ways:
    1. Preemptively by the container server when processing
    PUT/POST/DELETE operations targeted at containers with
    x-container-sync-key / x-container-sync-to
    2. In the background using the containers replicator
    whenever it processes a container set up for sync
    
    The change updates [1]
    [1] http://docs.openstack.org/developer/swift/overview_container_sync.html
    
    Change-Id: I9ae4d4c7ff6336611df4122b7c753cc4fa46c0ff
    Closes-Bug: #1476623

commit e75888b281d59df0889f28d0b32241dac3a34aa2
Author: HugoKuo &lt;tonytkdk@gmail.com&gt;
Date:   Wed Jan 6 14:33:23 2016 +0800

    Add more description for write_affinity_node_count parameter in the doc.
    
    Change-Id: Iad410a2be4f9a2cd5c53e860b9f91993aa7f2369
    Closes-Bug: #1531173

commit 3b1591f235f4b85796917507be5e7fd80365ff9e
Author: Ondřej Nový &lt;ondrej.novy@firma.seznam.cz&gt;
Date:   Wed Sep 30 19:08:09 2015 +0200

    swift-init: New option kill-after-timeout
    
    This option send SIGKILL to daemon after kill_wait period.
    When daemon hangs and doesn't respond to SIGTERM/SIGHUP
    there is no way to stop it using swift-init now. Classic
    init scripts in Linux kills hanged process after grace
    period and this patch add same behaviour. This is most
    usefull when using "restart" on hanged daemon.
    
    Change-Id: I8c932b673a0f51e52132df87ea2f4396f4bba9d8

commit 4691d0592ff3deeea2713195312bf1effd5a7a7b
Author: Hisashi Osanai &lt;osanai.hisashi@jp.fujitsu.com&gt;
Date:   Fri Dec 25 14:00:16 2015 +0900

    Add object replicator's succeeded and failed counts in log
    
    account-replicator and container-replicator outputted the
    following info in log.
    info account-replicator: 17 successes, 4 failures
    info container-replicator: 178 successes, 29 failures
    
    But there is no output info for object-replicator. This info
    is important to check replicator's status from log.
    
    So this patch adds object-replicator's succeeded and failed
    counts in log like account-replicator and container-replicator.
    
    Change-Id: I7fbaf161540bdb06c0a65a1032aae83764bd970c

commit 9fe0e25604dff35db7eab1bca312821a81db6c1d
Author: Kota Tsuyuzaki &lt;tsuyuzaki.kota@lab.ntt.co.jp&gt;
Date:   Tue Dec 8 22:27:44 2015 -0800

    Sleep enough for trampoline
    
    When running unite test suite in local poor resource environment,
    sometimes test/unit/proxy/test_server.py fails due to a lack of
    waiting time to trampoline of eventlet thread.
    
    This patch enables to sleep 1 more second when it doesn't seem
    to have enough time to tranpoline.
    
    Change-Id: I0bbc8fc245919d3c0a071ff87ff6e20b8d58f9b8

commit 7f636a557296ecc6ae4727700cfcf9f82573bd16
Author: Samuel Merritt &lt;sam@swiftstack.com&gt;
Date:   Mon Nov 30 18:06:09 2015 -0800

    Allow smaller segments in static large objects
    
    The addition of range support for SLO segments (commit 25d5e68)
    required the range size to be at least the SLO minimum segment size
    (default 1 MiB). However, if you're doing something like assembling a
    video of short clips out of a larger one, then you might not need a
    full 1 MiB.
    
    The reason for the 1 MiB restriction was to protect Swift from
    resource overconsumption. It takes CPU, RAM, and internal bandwidth to
    connect to an object server, so it's much cheaper to serve a 10 GiB
    SLO if it has 10 MiB segments than if it has 10 B segments.
    
    Instead of a strict limit, now we apply ratelimiting to small
    segments. The threshold for "small" is configurable and defaults to 1
    MiB. SLO segments may now be as small as 1 byte.
    
    If a client makes SLOs as before, it'll still be able to download the
    objects as fast as Swift can serve them. However, a SLO with a lot of
    small ranges or segments will be slowed down to avoid resource
    overconsumption. This is similar to how DLOs work, except that DLOs
    ratelimit *every* segment, not just small ones.
    
    UpgradeImpact
    
    For operators: if your cluster has enabled ratelimiting for SLO, you
    will want to set rate_limit_under_size to a large number prior to
    upgrade. This will preserve your existing behavior of ratelimiting all
    SLO segments. 5368709123 is a good value, as that's 1 greater than the
    default max object size. Alternately, hold down the 9 key until you
    get bored.
    
    If your cluster has not enabled ratelimiting for SLO (the default), no
    action is needed.
    
    Change-Id: Id1ff7742308ed816038a5c44ec548afa26612b95
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-feature-hummingbird
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~pratapd" class="sprite person">Pratap D (pratapd)</a>
    
    <time title="2016-06-03 13:51:29 UTC" datetime="2016-06-03T13:51:29.434047+00:00">on 2016-06-03</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/69" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~pratapd" class="sprite person">Pratap D (pratapd)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-06-03T14:02:33.074147+00:00" title="2016-06-03 14:02:33 UTC">on 2016-06-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/69"> #69</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Changed in swift (Ubuntu):</p>
<p>By mistake I changed the status to &quot;Fix released&quot;.</p>
<p>Status needs to be changed to &quot;Confirmed&quot;.<br />
Please change the status to &quot;Confirmed&quot;.</p>
<p>Sorry for the trouble.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Changed in swift (Ubuntu): 

By mistake I changed the status to "Fix released".

Status needs to be changed to "Confirmed".
Please change the status to "Confirmed".

Sorry for the trouble.



</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/70" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2016-06-03T14:17:21.181478+00:00" title="2016-06-03 14:17:21 UTC">on 2016-06-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/70"> #70</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@james-page, it seems like you are the one who can change the &quot;swift (ubuntu)&quot; task status. Please put it back to &quot;confirmed&quot;...</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@james-page, it seems like you are the one who can change the "swift (ubuntu)" task status. Please put it back to "confirmed"...</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~james-page" class="sprite person">James Page (james-page)</a>
    
    <time title="2016-06-03 15:51:01 UTC" datetime="2016-06-03T15:51:01.940789+00:00">on 2016-06-03</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Released &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~james-page" class="sprite person">James Page (james-page)</a>
    
    <time title="2016-06-10 10:09:43 UTC" datetime="2016-06-10T10:09:43.683981+00:00">on 2016-06-10</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Yakkety): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Fix Released
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Xenial): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Fix Released
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Wily): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Triaged
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Vivid): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Won&#x27;t Fix
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Trusty): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Triaged
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~james-page" class="sprite person">James Page (james-page)</a>
    
    <time title="2016-06-10 12:03:41 UTC" datetime="2016-06-10T12:03:41.405875+00:00">on 2016-06-10</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>no longer affects</b>:
      </td>
      <td>
        swift (Ubuntu Vivid)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~james-page" class="sprite person">James Page (james-page)</a>
    
    <time title="2016-09-08 09:39:19 UTC" datetime="2016-09-08T09:39:19.244272+00:00">on 2016-09-08</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in cloud-archive: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Invalid
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Wily): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Won&#x27;t Fix
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Trusty): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Won&#x27;t Fix
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Won&#x27;t Fix &#8594; New
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/cloud-archive/+bug/1493303/comments/71" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ebarretto" class="sprite person">Eduardo Barretto (ebarretto)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-07-06T20:07:06.624889+00:00" title="2020-07-06 20:07:06 UTC">on 2020-07-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/cloud-archive/+bug/1493303/comments/71"> #71</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package swift - 1.13.1-0ubuntu1.5</p>
<p>---------------<br />
swift (1.13.1-0ubuntu1.5) trusty-security; urgency=medium</p>
<p>&nbsp;&nbsp;[ Jamie Strandboge ]<br />
&nbsp;&nbsp;* SECURITY UPDATE: disallow unsafe tempurl operations to point to<br />
&nbsp;&nbsp;&nbsp;&nbsp;unauthorized data<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2015-<wbr />5223.patch: disallow creation of DLO object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manifests if non-safe tempurl request includes X-Object-Manifest header<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2015-5223<br />
&nbsp;&nbsp;&nbsp;&nbsp;- LP: <a href="/bugs/1453948" class="bug-link">#1453948</a></p>
<p>&nbsp;&nbsp;[ Marc Deslauriers ]<br />
&nbsp;&nbsp;* SECURITY UPDATE: DoS via incorrectly closed client connections<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />0737.patch: get better at closing WSGI<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iterables in swift/common/<wbr />middleware/<wbr />dlo.py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swift/<wbr />common/<wbr />middleware/<wbr />slo.py, swift/common/<wbr />request_<wbr />helpers.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swift/<wbr />common/<wbr />swob.py, swift/common/<wbr />utils.py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test/<wbr />unit/common/<wbr />middleware/<wbr />helpers.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test/<wbr />unit/common/<wbr />middleware/<wbr />test_dlo.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test/<wbr />unit/common/<wbr />middleware/<wbr />test_slo.<wbr />py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-0737<br />
&nbsp;&nbsp;* SECURITY UPDATE: DoS via incorrectly closed server connections<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2016-<wbr />0738.patch: fix memory/socket leak in proxy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on truncated SLO/DLO GET in swift/common/<wbr />request_<wbr />helpers.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test/<wbr />unit/common/<wbr />middleware/<wbr />test_slo.<wbr />py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2016-0738<br />
&nbsp;&nbsp;* Thanks to Red Hat for the patch backports!<br />
&nbsp;&nbsp;* debian/<wbr />patches/<wbr />fix-ubuntu-<wbr />tests.patch: disable another test that no<br />
&nbsp;&nbsp;&nbsp;&nbsp;longer works on buildds.</p>
<p>&nbsp;-- Marc Deslauriers &lt;email address hidden&gt;  Tue, 12 Sep 2017 07:36:43 -0400</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package swift - 1.13.1-0ubuntu1.5

---------------
swift (1.13.1-0ubuntu1.5) trusty-security; urgency=medium

  [ Jamie Strandboge ]
  * SECURITY UPDATE: disallow unsafe tempurl operations to point to
    unauthorized data
    - debian/patches/CVE-2015-5223.patch: disallow creation of DLO object
      manifests if non-safe tempurl request includes X-Object-Manifest header
    - CVE-2015-5223
    - LP: #1453948

  [ Marc Deslauriers ]
  * SECURITY UPDATE: DoS via incorrectly closed client connections
    - debian/patches/CVE-2016-0737.patch: get better at closing WSGI
      iterables in swift/common/middleware/dlo.py,
      swift/common/middleware/slo.py, swift/common/request_helpers.py,
      swift/common/swob.py, swift/common/utils.py,
      test/unit/common/middleware/helpers.py,
      test/unit/common/middleware/test_dlo.py,
      test/unit/common/middleware/test_slo.py.
    - CVE-2016-0737
  * SECURITY UPDATE: DoS via incorrectly closed server connections
    - debian/patches/CVE-2016-0738.patch: fix memory/socket leak in proxy
      on truncated SLO/DLO GET in swift/common/request_helpers.py,
      test/unit/common/middleware/test_slo.py.
    - CVE-2016-0738
  * Thanks to Red Hat for the patch backports!
  * debian/patches/fix-ubuntu-tests.patch: disable another test that no
    longer works on buildds.

 -- Marc Deslauriers &lt;marc.deslauriers@ubuntu.com&gt;  Tue, 12 Sep 2017 07:36:43 -0400</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in swift (Ubuntu Trusty): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/cloud-archive/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/cloud-archive/+bug/1493303/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/cloud-archive/+bug/1493303/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/cloud-archive/+bug/1493303/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4529331/+files/leakpatch-1.diff">leakpatch-1.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4529331">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4530760/+files/security_leak_fix.diff">security_leak_fix.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4530760">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4532159/+files/socket-leak-2.diff">socket-leak-2.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4532159">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4545988/+files/socket-leak-3.diff">socket-leak-3.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4545988">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4546358/+files/socket-leak-4.diff">socket-leak-4.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4546358">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4548894/+files/socket-leak-kilo-backport.diff">socket-leak-kilo-backport.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4548894">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4548896/+files/socket-leak-liberty-backport.diff">socket-leak-liberty-backport.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4548896">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4549968/+files/socket-leak-kilo-backport-2.diff">socket-leak-kilo-backport-2.diff</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4549968">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/cloud-archive/+bug/1493303/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4459119/+files/Dependencies.txt">Dependencies.txt</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4459119">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4459120/+files/ProcEnviron.txt">ProcEnviron.txt</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4459120">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/cloud-archive/+bug/1493303/+attachment/4520199/+files/leakreproducer.sh">leakreproducer.sh</a>
        <small>
          (<a href="/cloud-archive/+bug/1493303/+attachment/4520199">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/cloud-archive/+bug/1493303/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1493303", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1493303"}, "information_type_data": {"PUBLIC": {"description": "Everyone can see this information.\n", "name": "Public", "is_private": false, "order": 0, "description_css_class": "choice-description", "value": "PUBLIC"}, "PUBLICSECURITY": {"description": "Everyone can see this security related information.\n", "name": "Public Security", "is_private": false, "order": 1, "description_css_class": "choice-description", "value": "PUBLICSECURITY"}, "USERDATA": {"description": "Only shared with users permitted to see private user information.\n", "name": "Private", "is_private": true, "order": 3, "description_css_class": "choice-description", "value": "USERDATA"}, "PRIVATESECURITY": {"description": "Only the security group can see this information.\n ", "name": "Private Security", "is_private": true, "order": 2, "description_css_class": "choice-description", "value": "PRIVATESECURITY"}}, "total_comments_and_activity": 156, "bug_is_private": false, "related_features": {}, "first visible_recent_comment": 31, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1493303", "web_link": "https://bugs.launchpad.net/bugs/1493303", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1493303, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2016-004] Swift proxy memory leak on unfinished read (CVE-2016-0738)", "description": "It looks like the Swift proxy will leak memory if the connection is closed and the full response is not read. This opens for a potential DoS attacks.\n\nReproduce:\n\n$ swift -A http://localhost:8888/auth/v1.0 -U .. -K .. upload --use-slo --segment-size 1048576 \u003ccontainer\u003e \u003cbig-file\u003e\n$ curl -H'X-Auth-Token: AUTH_...' \"http://localhost:8888/v1/AUTH_../\u003ccontainer\u003e/\u003cbig-file\u003e\" -m 0.001 \u003e /dev/null\n\nRepeat the curl command a couple of times and you will have more information in netstat and sockstat. The important part is the -m which sets the max time curl spends at downloading. After that point, it'll close the connection.\n\n$ sudo netstat -ant -p | grep :6000\n$ cat /proc/net/sockstat\n\ntcp        0      0 127.0.0.1:6000          0.0.0.0:*               LISTEN      1358/python\ntcp        0  43221 127.0.0.1:6000          127.0.0.1:48350         FIN_WAIT1   -\ntcp        0  43221 127.0.0.1:6000          127.0.0.1:48882         FIN_WAIT1   -\ntcp   939820      0 127.0.0.1:48350         127.0.0.1:6000          ESTABLISHED 17897/python\ntcp   939820      0 127.0.0.1:48882         127.0.0.1:6000          ESTABLISHED 17890/python\ntcp   983041      0 127.0.0.1:48191         127.0.0.1:6000          CLOSE_WAIT  17897/python\ntcp   983041      0 127.0.0.1:48948         127.0.0.1:6000          CLOSE_WAIT  17892/python\n\nRestarting the proxy frees up the lingering memory.\n\nThis problem did not exist in 2.2.0.\n\nProblemType: Bug\nDistroRelease: Ubuntu 14.04\nPackage: swift 2.2.2-0ubuntu1~cloud0 [origin: Canonical]\nProcVersionSignature: Ubuntu 3.16.0-48.64~14.04.1-generic 3.16.7-ckt15\nUname: Linux 3.16.0-48-generic x86_64\nApportVersion: 2.14.1-0ubuntu3.12\nArchitecture: amd64\nCrashDB:\n\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"impl\": \"launchpad\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"project\": \"cloud-archive\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"bug_pattern_url\": \"http://people.canonical.com/~ubuntu-archive/bugpatterns/bugpatterns.xml\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\nDate: Tue Sep  8 09:55:05 2015\nInstallationDate: Installed on 2015-06-22 (77 days ago)\nInstallationMedia: Ubuntu-Server 14.04.2 LTS \"Trusty Tahr\" - Release amd64 (20150218.1)\nPackageArchitecture: all\nSourcePackage: swift\nUpgradeStatus: No upgrade log present (probably fresh install)", "owner_link": "https://bugs.launchpad.net/api/devel/~o-42mm", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/bug_tasks", "duplicate_of_link": null, "date_created": "2015-09-08T10:12:20.569212+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/subscriptions", "date_last_updated": "2020-07-07T07:37:04.649486+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 288, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/attachments", "security_related": true, "latest_patch_uploaded": "2016-01-14T16:18:17.404958+00:00", "tags": ["amd64", "apport-bug", "in-feature-crypto", "in-feature-hummingbird", "in-stable-kilo", "in-stable-liberty", "patch", "third-party-packages", "trusty"], "date_last_message": "2020-07-06T20:07:06.624889+00:00", "number_of_duplicates": 0, "message_count": 72, "users_affected_count": 4, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/users_unaffected", "users_affected_count_with_dupes": 4, "other_users_affected_count_with_dupes": 4, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1493303/linked_merge_proposals", "http_etag": "\"0e2e02f1dab9b104fb2abe159986eba09ca4f6e8-e1b6c06ab7aedfa615cb9eb1bcf5a27d0a28dfe3\""}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/cloud-archive/+bug/1493303", "web_link": "https://bugs.launchpad.net/cloud-archive/+bug/1493303", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1493303", "milestone_link": null, "status": "Invalid", "importance": "High", "assignee_link": null, "bug_target_display_name": "Ubuntu Cloud Archive", "bug_target_name": "cloud-archive", "bug_watch_link": null, "date_assigned": null, "date_created": "2015-09-08T10:12:20.569212+00:00", "date_confirmed": null, "date_incomplete": null, "date_in_progress": null, "date_closed": "2016-09-08T09:39:20.279415+00:00", "date_left_new": "2016-09-08T09:39:20.279415+00:00", "date_triaged": null, "date_fix_committed": null, "date_fix_released": null, "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~o-42mm", "target_link": "https://bugs.launchpad.net/api/devel/cloud-archive", "title": "Bug #1493303 in Ubuntu Cloud Archive: \"[OSSA 2016-004] Swift proxy memory leak on unfinished read (CVE-2016-0738)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/cloud-archive/+bug/1493303/related_tasks", "is_complete": true, "http_etag": "\"0d4e586263aca03eb6fb0ebb9bbe08c72fac3f95-3d97dce4c6c9160adc0e9bdc7c5db95822dc27b2\""}, "initial_comment_batch_offset": 41};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 67 queries/external actions issued in 2.04 seconds

    Features: {'app.maintenance_message': None, 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'bugs.nominations.bug_supervisors_can_target': 'on', 'baselayout.careers_link.disabled': None, 'hard_timeout': '9000', 'js.yui_version': None, 'profiling.enabled': None}

    r0d8de2b

    -->

</html>

