<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1073952 - (CVE-2017-7788) CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1073952">
<meta property="og:description"
      content="RESOLVED (fbraun) in Core - DOM: Security. Last updated 2020-05-24.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1073952 - (CVE-2017-7788) CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1073952&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1073952">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1073952">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/yui.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/global.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/util.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\"},\"tracking\":{\"cf_status_firefox_esr78\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox_esr52\":\"fixed\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox55\":\"fixed\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox94\":\"---\"}},\"comments\":{\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1073952;
  BUGZILLA.bug_title = '1073952 - (CVE-2017-7788) CSP can be bypassed with \x3ciframe [sandbox] and [srcdoc]\x3e';
  BUGZILLA.bug_summary = 'CSP can be bypassed with \x3ciframe [sandbox] and [srcdoc]\x3e';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1073952';
  BUGZILLA.bug_keywords = 'sec-low',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/field.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/comments.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1073952">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1073952"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1073952 - (CVE-2017-7788) CSP can be bypassed with &amp;lt;iframe [sandbox] and [srcdoc]&amp;gt;">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="8Zo3V5w9YJD5rFnCgHJnmICvriw0ZHcfyafw4WcXGfYuBDGF3wplons5joUaUAJOYMM13Lqyr99iRaM1rxmWpeirBGEHUMUWoT31EH5AkRN775MyCAgYEWHrVWJOrwXjkXposqIfGPtVSt2dFFBdV90NNtzpeZfMKq3GMEwW8RZCgbKBNOdLKEoiBwHED77OlhefZxu1OIQiJz3hHiRjWBJ5mymWW7RHPmAcBsVNlwlPLyfde9A3dLn6Dfb36lwa">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1073952" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622503-tH4f_uY0TaCUgvN02d4gbGkoWH5swNPrhj0ptyIfpTE">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1073952" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1073952" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1073952">Bug 1073952</a>
          <span class="edit-hide">(CVE-2017-7788)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2014-09-28 06:12 PDT" data-time="1411909939">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2017-03-20 17:51 PDT" data-time="1490057482">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Security, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Security
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Security</div>
            <div class="description">Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Security"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Security"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            35 Branch

        </span>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            x86_64

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Windows 8

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;fixed&quot;,&quot;dupe_of&quot;:null,&quot;target_milestone&quot;:&quot;mozilla55&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;-&quot;,&quot;name&quot;:&quot;sec-bounty&quot;},{&quot;name&quot;:&quot;sec-bounty-hof&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;name&quot;:&quot;in-testsuite&quot;,&quot;status&quot;:&quot;+&quot;}],&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;id&quot;:1073952,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox55&quot;:&quot;fixed&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;keywords&quot;:[&quot;sec-low&quot;]}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla55

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox55</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="fixed"
          id="v3137_cf_status_firefox_esr52" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox55</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox55-dirty">
  <select id="cf_status_firefox55" name="cf_status_firefox55">
        <option value="fixed"
          id="v3183_cf_status_firefox55" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: sdna.muneaki.nishimura, Assigned: freddy)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_428608" ><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=428608" > <span class="fna">freddy</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_507051" ><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=507051" > <span class="fna">sdna.muneaki.nishimura</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="15">15 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Blocks 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Other CSP rules ignored when specifying sandbox 'allow-scripts'"
   href="/show_bug.cgi?id=1377426">CVE-2017-7803</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_ASSIGNED"
   title="ASSIGNED - [meta] Implement Content Security Policy 3.0 per the W3C standard (csp-w3c-3)"
   href="/show_bug.cgi?id=1231788">csp-w3c-3</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1073952&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1073952">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Firefox doesn't correctly apply CSP to the srcdoc-supplied HTML in a sandboxed iframe"
   href="/show_bug.cgi?id=1280308">1280308</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Mozilla Firefox V51.0 CSP Bypass"
   href="/show_bug.cgi?id=1295489">1295489</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Content Security Policy does not apply to SRCDOC sandboxed iframes"
   href="/show_bug.cgi?id=1305076">1305076</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - iframe sandbox with srcdoc bypasses inline script restriction from parent document CSP"
   href="/show_bug.cgi?id=1315952">1315952</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - increase test coverage for sandboxed iframe srcdoc inheriting CSP"
   href="/show_bug.cgi?id=1330920">1330920</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - increase test coverage for sandboxed iframe srcdoc inheriting CSP"
   href="/show_bug.cgi?id=1330920">1330920</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-low, Whiteboard: [reporter-external], [domsecurity-backlog][adv-main55+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2017-7788

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[reporter-external], [domsecurity-backlog][adv-main55+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a3745508_1689"
            class="rel-time-title activity-ref"
            title="7 years ago"
        data-time="1411964626"
      >sec-bounty</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-989872">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-989872-dirty">
      <select id="flag-989872" name="flag-989872"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">tjr</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a178459849_578488"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1590369788"
      >sec-bounty-hof</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">tjr</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag-1975082">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1975082-dirty">
      <select id="flag-1975082" name="flag-1975082"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c83"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1500593641"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1615347">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1615347-dirty">
      <select id="flag-1615347" name="flag-1615347"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files, 16 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8748864">bug_1073952_csp_iframe_srcdoc.patch</a>
        </div>
        <div>
            <a href="#c8" class="attach-time activity-ref"><span class="rel-time" title="2016-05-04 13:53 PDT" data-time="1462395225">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">6.61 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8748864&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8748864&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8748864">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8824419">0001-wip.patch</a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2017-01-06 06:39 PST" data-time="1483713590">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.87 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8824419&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8824419&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8824419">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8825818">0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch</a>
        </div>
        <div>
            <a href="#c17" class="attach-time activity-ref"><span class="rel-time" title="2017-01-11 06:45 PST" data-time="1484145903">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">12.25 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8825818&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8825818&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8825818">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8826149">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch</a>
        </div>
        <div>
            <a href="#c23" class="attach-time activity-ref"><span class="rel-time" title="2017-01-12 03:41 PST" data-time="1484221297">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">12.85 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8826149&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8826149&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8826149">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8826510">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch</a>
        </div>
        <div>
            <a href="#c25" class="attach-time activity-ref"><span class="rel-time" title="2017-01-13 01:20 PST" data-time="1484299212">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">13.65 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c26"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1484299212"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c29"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1484299212"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8826510&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8826510&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8826510">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8829841">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</a>
        </div>
        <div>
            <a href="#c30" class="attach-time activity-ref"><span class="rel-time" title="2017-01-24 05:52 PST" data-time="1485265974">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">13.22 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8829841&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8829841&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8829841">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8829843">0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</a>
        </div>
        <div>
            <a href="#c31" class="attach-time activity-ref"><span class="rel-time" title="2017-01-24 05:56 PST" data-time="1485266168">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.08 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485266168"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8829843&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8829843&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8829843">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8830287">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2017-01-25 05:46 PST" data-time="1485351969">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">12.25 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8830287&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8830287&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830287">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8830288">0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2017-01-25 05:46 PST" data-time="1485352017">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.11 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8830288&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8830288&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830288">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8830289">0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch</a>
        </div>
        <div>
            <a href="#c38" class="attach-time activity-ref"><span class="rel-time" title="2017-01-25 05:48 PST" data-time="1485352122">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">6.65 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8830289&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8830289&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830289">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8830668">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</a>
        </div>
        <div>
            <a href="#c44" class="attach-time activity-ref"><span class="rel-time" title="2017-01-26 02:40 PST" data-time="1485427227">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">12.20 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c47"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485427227"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c49"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485427227"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8830668&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8830668&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830668">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8830670">0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</a>
        </div>
        <div>
            <a href="#c45" class="attach-time activity-ref"><span class="rel-time" title="2017-01-26 02:42 PST" data-time="1485427330">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.11 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_428608" ><span class="fn">freddy</span>
</div>:
              <a href="#c45"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485427330"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8830670&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8830670&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830670">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8830671">0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch</a>
        </div>
        <div>
            <a href="#c46" class="attach-time activity-ref"><span class="rel-time" title="2017-01-26 02:43 PST" data-time="1485427432">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">6.65 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c48"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485427432"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8830671&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8830671&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830671">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8831069">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</a>
        </div>
        <div>
            <a href="#c51" class="attach-time activity-ref"><span class="rel-time" title="2017-01-27 01:05 PST" data-time="1485507920">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">12.20 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_428608" ><span class="fn">freddy</span>
</div>:
              <a href="#c51"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485507920"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8831069&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8831069&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8831069">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8831070">0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</a>
        </div>
        <div>
            <a href="#c52" class="attach-time activity-ref"><span class="rel-time" title="2017-01-27 01:05 PST" data-time="1485507947">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.11 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_428608" ><span class="fn">freddy</span>
</div>:
              <a href="#c52"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485507947"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8831070&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8831070&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8831070">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8831072">0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch</a>
        </div>
        <div>
            <a href="#c53" class="attach-time activity-ref"><span class="rel-time" title="2017-01-27 01:06 PST" data-time="1485507987">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">6.65 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_428608" ><span class="fn">freddy</span>
</div>:
              <a href="#c53"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1485507987"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8831072&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8831072&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8831072">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8848471">Bug 1073952: inherit CSP into iframe sandbox srcdoc</a>
        </div>
        <div>
            <a href="#c60" class="attach-time activity-ref"><span class="rel-time" title="2017-03-17 03:59 PDT" data-time="1489748388">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">59 bytes,
          text/x-review-board-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8848471&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8848472">Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP</a>
        </div>
        <div>
            <a href="#c61" class="attach-time activity-ref"><span class="rel-time" title="2017-03-17 03:59 PDT" data-time="1489748388">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">59 bytes,
          text/x-review-board-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8848472&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8848473">Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal</a>
        </div>
        <div>
            <a href="#c62" class="attach-time activity-ref"><span class="rel-time" title="2017-03-17 03:59 PDT" data-time="1489748388">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_428608" ><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div></span>
        </div>
        <div class="attach-info">59 bytes,
          text/x-review-board-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8848473&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="JuFApDNuMtqQBBjRv5rmgtBkAJRUkPTgTGZ3FpTWS6b8YLbh">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9371132" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_507051" ><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_507051" ><a class="email " href="/user_profile?user_id=507051" > <span class="fna">Muneaki Nishimura</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-28 06:12 PDT" data-time="1411909939">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="9371132">User Agent: Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.124 Safari/537.36

Steps to reproduce:

Open following link.
<a rel="nofollow" href="http://csp.csrf.jp/target.php?body">http://csp.csrf.jp/target.php?body</a>=&lt;a href=&quot;javascript:alert(1)&quot;&gt;xss&lt;/a&gt;

This page has an reflected xss in 'body' parameter in query string but it is protected by CSP &quot;default-src 'self'&quot;.
Even if script code is injected via 'body' in URI, it's execution may be prevented by CSP.


Actual results:

If an attacker opens the page in &lt;iframe sandbox&gt; and he/she injects script code with &lt;iframe srcdoc&gt;, injected script is executed with bypassing it's CSP.

Please see the following proof of concept page. alert(1) may be executed even though the page opened in iframe is protected by CSP.
<a rel="nofollow" href="http://mallory.csrf.jp/cspbypass.html">http://mallory.csrf.jp/cspbypass.html</a>



Expected results:

Script execution in <a rel="nofollow" href="http://csp.csrf.jp/target.php">http://csp.csrf.jp/target.php</a> has to be protected by this site's CSP.
Note that Google Chrome does prevent execution in same situation.</pre></div><div class="change-set" id="a43330_103593"><div class="change" id="aa43330_103593">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_103593" id="a43330_103593"><img src="https://secure.gravatar.com/avatar/08de945228403cb0598d5906e2407a7d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_103593" id="a43330_103593"><a class="email " href="/user_profile?user_id=103593" > <span class="fna">:Gavin Sharp [email: gavin&#64;gavinsharp.com]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a43330_103593"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a43330_103593">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a43330_103593">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-28 18:14 PDT" data-time="1411953269">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Component: Untriaged &rarr; DOM: Security</div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="9372132" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a43330_103593"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a43330_103593"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-28 21:23 PDT" data-time="1411964597">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9372132">The csp.csrf.jp policy is &quot;default-src 'self'&quot; and srcdoc is supposed to be self. It should be blocking inline-script, but the error I see on the console is &quot;Content Security Policy: The page's settings blocked the loading of a resource at self (&quot;&quot;). about:srcdoc:1&quot; Is that what we report for inline-script?

The inner srcdoc origin is the same as the outer origin so it should be inheriting the CSP along with the origin. (Not saying it does, this is my understanding of what we intend to happen.). I wonder if there's some oddness with sandbox unique origins such as they can't be inherited but instead a new unique origin is created.</pre></div><div class="change-set" id="a54687_1689"><div class="change" id="aa54687_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a54687_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a54687_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a54687_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a54687_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a54687_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-28 21:23 PDT" data-time="1411964626">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="a92281_406847"><div class="change" id="aa92281_406847">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406847" id="a92281_406847"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_406847" id="a92281_406847"><a class="email disabled" href="/user_profile?user_id=406847" > <span class="fna">Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a92281_406847"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a92281_406847">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a92281_406847">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 07:50 PDT" data-time="1412002220">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external]</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="9381948" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a92281_406847"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_452604" id="a92281_406847"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-30 10:41 PDT" data-time="1412098915">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9381948">Sid, any input? Is this a limit of what we've implemented of the spec? Or a bug in our implementation?</pre><div class="activity"><div class="change">Flags: needinfo?(sstamm)</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="9382098" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339203" id="a92281_406847"><img src="https://secure.gravatar.com/avatar/acd21cf298169c0b87813c52025ee6e9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339203" id="a92281_406847"><a class="email " href="/user_profile?user_id=339203" > <span class="fna">Sid Stamm [:geekboy or :sstamm]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-30 11:15 PDT" data-time="1412100944">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9382098">It looks like loading the inner iframe in a non-sandboxed context works, so my gut feeling here is that the sandboxed iframe doesn't enforce CSP.  I'm not sure it is limited to srcdoc, since if you load the iframe by itself in a non-sandboxed environment, CSP seems to properly block things.  I think this is a bug in our implementation.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(sstamm)</span></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="9382112" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339203" id="a92281_406847"><img src="https://secure.gravatar.com/avatar/acd21cf298169c0b87813c52025ee6e9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339203" id="a92281_406847"><a class="email " href="/user_profile?user_id=339203" > <span class="fna">Sid Stamm [:geekboy or :sstamm]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-30 11:17 PDT" data-time="1412101052">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="9382112">Or like dan said, maybe the sandboxed iframes don't pass their origins into srcdoc subframes like non-sandboxed ones do.  If that's the case, CSP needs to find the sandboxed iframe's principal for srcdoc subframes.</pre></div><div class="change-set" id="a792582_1689"><div class="change" id="aa792582_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a792582_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a792582_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a792582_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a792582_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a792582_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-07 10:22 PDT" data-time="1412702521">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="9414458" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a792582_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a792582_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-07 10:24 PDT" data-time="1412702678">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="9414458">Calling this sec-low because this is an edge case on CSP (which is already a mitigation against site bugs, but the site has to have a bug first). At worst you get an XSS attack into sandboxed content. Means you can't trust what the content shows any more but it's not running in any context with valuable data.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="9428720" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_507051" id="a792582_1689"><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_507051" id="a792582_1689"><a class="email " href="/user_profile?user_id=507051" > <span class="fna">Muneaki Nishimura</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-09 17:50 PDT" data-time="1412902254">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="9428720">CSP level2 spec clarifies expected behavior of &lt;iframe [srcdoc]&gt; as follows.
<a rel="nofollow" href="http://www.w3.org/TR/CSP11/#processing-model-iframe-srcdoc">http://www.w3.org/TR/CSP11/#processing-model-iframe-srcdoc</a>

It seems UA should follow this spec unless protected document is in a sandoxed iframe.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="9428731" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_507051" id="a792582_1689"><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_507051" id="a792582_1689"><a class="email " href="/user_profile?user_id=507051" > <span class="fna">Muneaki Nishimura</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-09 17:56 PDT" data-time="1412902617">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="9428731">Typo: unless -&gt; even if</pre></div><div class="change-set" id="a3745508_1689"><div class="change" id="aa3745508_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3745508_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3745508_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3745508_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3745508_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a3745508_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 13:37 PST" data-time="1415655447">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty-</div></div></div><div class="change-set" id="a29267875_546015"><div class="change" id="aa29267875_546015">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_546015" id="a29267875_546015"><img src="https://secure.gravatar.com/avatar/d0465b8931b44330f542efbeeae855da?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_546015" id="a29267875_546015"><a class="email " href="/user_profile?user_id=546015" > <span class="fna">BMO Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a29267875_546015"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a29267875_546015">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a29267875_546015">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-02 00:10 PDT" data-time="1441177814">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; dom-core-security</div></div></div><div class="change-set" id="a45734135_363267"><div class="change" id="aa45734135_363267">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a45734135_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a45734135_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a45734135_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a45734135_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a45734135_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-10 13:07 PST" data-time="1457644074">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external] &rarr; [reporter-external], [domsecurity-backlog]</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="11382921" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a45734135_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a45734135_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-05-04 13:53 PDT" data-time="1462395225">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8748864"
         class="attachment patch obsolete"
         data-id="8748864" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1073952_csp_iframe_srcdoc.patch">
      <meta itemprop="contentSize" content="6765">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8748864">
          <a class="link" href="attachment.cgi?id=8748864&amp;action=diff">
        <span id="att-8748864-description" itemprop="description">bug_1073952_csp_iframe_srcdoc.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8748864&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8748864">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-8" data-comment-id="11382921">Hey Dan, I was looking at the part of the spec that defines the nested browsing context for iframe srcdoc [1] and wrote this test that verifies that we apply the top level CSP to the nested browsing context within an iframe srcdoc and also to an iframe srcdoc within an iframe srcdoc.

This bug was filed quite some time ago, so potentially something fixed the issue in the mean time. If I am not missing something, then we could land this test and mark the bug as a WORKSFORME.

[1] <a rel="nofollow" href="https://www.w3.org/TR/CSP/#processing-model-iframe-srcdoc">https://www.w3.org/TR/CSP/#processing-model-iframe-srcdoc</a></pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="11393880" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a45734135_363267"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a45734135_363267"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-05-09 11:35 PDT" data-time="1462818951">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="11393880">It's not WORKSFORME -- the original PoC still reproduces the bug: <a rel="nofollow" href="http://mallory.csrf.jp/cspbypass.html">http://mallory.csrf.jp/cspbypass.html</a>

In the PoC target.php has a CSP of &quot;default-src 'self'&quot;



blocked: <a rel="nofollow" href="http://csp.csrf.jp/target.php?body">http://csp.csrf.jp/target.php?body</a>=&lt;a href=&quot;javascript:alert(1)&quot;&gt;xss&lt;/a&gt;
blocked: <a rel="nofollow" href="http://csp.csrf.jp/target.php?body=%3Ciframe%20srcdoc=%27%3Cscript%3Ealert(0)%3E%3C/script%3E%27%3E%3C/iframe%3E">http://csp.csrf.jp/target.php?body=%3Ciframe%20srcdoc=%27%3Cscript%3Ealert(0)%3E%3C/script%3E%27%3E%3C/iframe%3E</a>

Not blocked: putting the above in a sandboxed iframe. Your test doesn't have any sandbox in it.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="a53292754_363267"><div class="change" id="aa53292754_363267">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a53292754_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a53292754_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a53292754_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a53292754_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a53292754_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 01:44 PDT" data-time="1465202693">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_ASSIGNED"
   title="ASSIGNED - [meta] Implement Content Security Policy 3.0 per the W3C standard (csp-w3c-3)"
   href="/show_bug.cgi?id=1231788">csp-w3c-3</a></div></div></div><div class="change-set" id="a54186219_1689"><div class="change" id="aa54186219_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a54186219_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a54186219_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a54186219_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a54186219_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a54186219_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-16 09:55 PDT" data-time="1466096158">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Firefox doesn't correctly apply CSP to the srcdoc-supplied HTML in a sandboxed iframe"
   href="/show_bug.cgi?id=1280308">1280308</a></div></div></div><div class="change-set" id="a59475960_1689"><div class="change" id="aa59475960_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a59475960_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a59475960_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a59475960_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a59475960_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a59475960_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-16 15:18 PDT" data-time="1471385899">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Mozilla Firefox V51.0 CSP Bypass"
   href="/show_bug.cgi?id=1295489">1295489</a></div></div></div><div class="change-set" id="a62743055_1689"><div class="change" id="aa62743055_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a62743055_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a62743055_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a62743055_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a62743055_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a62743055_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 10:49 PDT" data-time="1474652994">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Content Security Policy does not apply to SRCDOC sandboxed iframes"
   href="/show_bug.cgi?id=1305076">1305076</a></div></div></div><div class="change-set" id="a66817276_1689"><div class="change" id="aa66817276_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a66817276_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a66817276_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a66817276_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a66817276_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a66817276_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-09 13:33 PST" data-time="1478727215">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - iframe sandbox with srcdoc bypasses inline script restriction from parent document CSP"
   href="/show_bug.cgi?id=1315952">1315952</a></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="11861596" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a66817276_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a66817276_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-15 09:15 PST" data-time="1479230115">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="11861596">There are several dupes of this and now an academic paper and a post to the public-webappsec mailing list. We might as well unhide this.
<a rel="nofollow" href="https://lists.w3.org/Archives/Public/public-webappsec/2016Nov/0007.html">https://lists.w3.org/Archives/Public/public-webappsec/2016Nov/0007.html</a></pre><div class="activity"><div class="change">Group: <span class="activity-deleted">dom-core-security</span></div></div></div><div class="change-set" id="a71803321_428608"><div class="change" id="aa71803321_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a71803321_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a71803321_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a71803321_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-06 06:34 PST" data-time="1483713260">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; fbraun</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="11962466" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-06 06:39 PST" data-time="1483713590">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8824419"
         class="attachment patch obsolete"
         data-id="8824419" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-wip.patch">
      <meta itemprop="contentSize" content="2938">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8824419">
          <a class="link" href="attachment.cgi?id=8824419&amp;action=diff">
        <span id="att-8824419-description" itemprop="description">0001-wip.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8824419&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8824419">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-15" data-comment-id="11962466">Christoph, this wip patch is pretty small and I've no great confidence this is right, but hopefully will help discussing it further.

You suggested I take the branch that does the sandbox-check for me and then just probe for the srcdoc case. I got so far.

Then you told me to add the CSP to the newly created principal (line 298/299), but I have absolutely no clue how to do that. I did some search into other code paths that may or may not modify/add CSPs, but couldn't find anything useful.
(Among those: EnsureCSP (does not add, but get a CSP), nsDocument::InitCSP (private), CSP_AppendFromHeader (no header here), …)

Can you take a look?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8824419&amp;action=edit"
           title="0001-wip.patch"
           class=""
        >Attachment #8824419</a> -
        Flags: feedback?(ckerschb)</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="11966363" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a71803321_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-09 00:10 PST" data-time="1483949404">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="11966363">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8824419" name="attach_8824419" title="0001-wip.patch">attachment 8824419</a> <a href="/attachment.cgi?id=8824419&amp;action=edit" title="0001-wip.patch">[details]</a> <a href="/attachment.cgi?id=8824419&amp;action=diff" title="0001-wip.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8824419'>[review]</a>
0001-wip.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8824419" name="attach_8824419" title="0001-wip.patch">attachment 8824419</a> <a href="/attachment.cgi?id=8824419&amp;action=edit" title="0001-wip.patch">[details]</a> <a href="/attachment.cgi?id=8824419&amp;action=diff" title="0001-wip.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8824419'>[review]</a>:
-----------------------------------------------------------------

Freddy, even though I said GetChannelResultPrincipal is the right place to add that code I took a second look and I think it's better to add the code within nsDocShell where we actually set up the iframe and the loadinfo.

if (isSandBoxed) {
  nsAutoCString spec;
  aUri-&gt;GetSpec(spec);
  if (spec.EqualsLiteral(&quot;about:srcdoc&quot;) {
    if (aPrincipalToInherit) {
        nsCOMPtr&lt;nsIContentSecurityPolicy&gt; csp;
        principalToInherit-&gt;GetCsp(getter_AddRefs(csp));
        if (csp) {
          loadingPrincipal-&gt;SetCSP(csp);
        } 
    }
  }
}

Your code is actually pretty close to mine and probably mine needs a little debugging as well. Not sure if about:srcdoc is actually passed as the regular URI here or whether you need to do some GetIntialURI or whathever URI modification methods we provide to actually get to the about:srcdoc. And probably we should only do that for TYPE_SUBDOCUMENT, right?

And now I also see your question, there is no SetCSP anymore, but only EnsureCSP(), which only accepts AppendPolicy. In other words we don't have a mechanism on the principal which would allow to actually 'copy' a CSP from one principal to the other.

As a first step you could try to remove the 'readonly' from
[noscript] readonly attribute nsIContentSecurityPolicy csp;
within nsIPrincipal.idl and then implement the setCSP method on the principal which would then allow us to copy the CSP from one principal to the other. If all of our reasoning is correct, we can then try to find a solution to actually copy the CSP between those principals.

[1] <a rel="nofollow" href="http://searchfox.org/mozilla-central/source/docshell/base/nsDocShell.cpp#10884">http://searchfox.org/mozilla-central/source/docshell/base/nsDocShell.cpp#10884</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8824419&amp;action=edit"
           title="0001-wip.patch"
           class=""
        >Attachment #8824419</a> -
        Flags: <span class="activity-deleted">feedback?(ckerschb)</span></div></div></div><div class="change-set" id="c17"><div class="comment" data-id="11974040" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 06:45 PST" data-time="1484145903">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8825818"
         class="attachment patch obsolete"
         data-id="8825818" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">
      <meta itemprop="contentSize" content="12546">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8825818">
          <a class="link" href="attachment.cgi?id=8825818&amp;action=diff">
        <span id="att-8825818-description" itemprop="description">0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8825818&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8825818">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-17" data-comment-id="11974040">Looking forward to hearing your feedback.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8748864&amp;action=edit"
           title="bug_1073952_csp_iframe_srcdoc.patch"
           class=""
        >Attachment #8748864</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8824419&amp;action=edit"
           title="0001-wip.patch"
           class=""
        >Attachment #8824419</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8825818&amp;action=edit"
           title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8825818</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="11974049" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 06:46 PST" data-time="1484146019">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11974049">Try push: <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=e3970a086952afb05dcc36fbfe0ba42c37c2eff3">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=e3970a086952afb05dcc36fbfe0ba42c37c2eff3</a></pre></div><div class="change-set" id="c19"><div class="comment" data-id="11975072" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 11:23 PST" data-time="1484162620">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11975072">Err <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=e53364d4001065d0bfc656f437249f12adce5c52">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=e53364d4001065d0bfc656f437249f12adce5c52</a></pre></div><div class="change-set" id="c20"><div class="comment" data-id="11976543" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 23:05 PST" data-time="1484204708">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="11976543">All tests green except for a some known &amp; unrelated intermittent failures.</pre></div><div class="change-set" id="c21"><div class="comment" data-id="11976730" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-12 00:58 PST" data-time="1484211498">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="11976730">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8825818" name="attach_8825818" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8825818</a> <a href="/attachment.cgi?id=8825818&amp;action=edit" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8825818&amp;action=diff" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8825818'>[review]</a>
0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch

This needs a caps peer review.
Dan, can you take a look?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8825818&amp;action=edit"
           title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8825818</a> -
        Flags: review?(dveditz)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="11976875" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a71803321_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-12 01:36 PST" data-time="1484213806">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="11976875">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8825818" name="attach_8825818" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8825818</a> <a href="/attachment.cgi?id=8825818&amp;action=edit" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8825818&amp;action=diff" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8825818'>[review]</a>
0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8825818" name="attach_8825818" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8825818</a> <a href="/attachment.cgi?id=8825818&amp;action=edit" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8825818&amp;action=diff" title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8825818'>[review]</a>:
-----------------------------------------------------------------

Overall that already looks pretty good. I would like to see it one more time especially because GetChannelResultPrincipal() is a crucial method in our security system.

::: caps/BasePrincipal.cpp
&#64;&#64; +504,5 &#64;&#64;
<span class="quote">&gt;  NS_IMETHODIMP
&gt; +BasePrincipal::SetCsp(nsIContentSecurityPolicy* aCsp)
&gt; +{
&gt; +  // If CSP was already set, it should not be destroyed!  Instead, it should
&gt; +  // get set anew when a new principal is created.</span >

Please update the comment to:
Never destroy an existing CSP on the principal. This method should only be called in rare cases.

&#64;&#64; +507,5 &#64;&#64;
<span class="quote">&gt; +  // If CSP was already set, it should not be destroyed!  Instead, it should
&gt; +  // get set anew when a new principal is created.
&gt; +  if (mCSP) {
&gt; +    return NS_ERROR_ALREADY_INITIALIZED;
&gt; +    }</span >

MOZ_ASSERT(!mCSP, &quot;do not destroy an existing CSP&quot;):

if (mCSP) {
  return NS_ERROR_ALREADY_INITIALIZED;
}

::: caps/nsIPrincipal.idl
&#64;&#64; +140,4 &#64;&#64;
<span class="quote">&gt;       *
&gt;       * Use this function to query the associated CSP with this principal.
&gt;       */
&gt; +    [noscript] attribute nsIContentSecurityPolicy csp;</span >

Please update the comment on top to:

 * A Content Security Policy associated with this principal.
 * Use this function to query the associated CSP with this principal.
 * Please *only* use this function to *set* a CSP when you know exactly what you are doing. Most likely you want to call ensureCSP instead of setCSP.

::: caps/nsNullPrincipal.cpp
&#64;&#64; +110,5 &#64;&#64;
<span class="quote">&gt;  
&gt;  NS_IMETHODIMP
&gt; +nsNullPrincipal::SetCsp(nsIContentSecurityPolicy* aCsp) {
&gt; +  // If CSP was already set, it should not be destroyed!  Instead, it should
&gt; +  // get set anew when a new principal is created.</span >

Please use the same comment and assertion from BasePrincipal.cpp within this method.

::: caps/nsScriptSecurityManager.cpp
&#64;&#64; +298,5 &#64;&#64;
<span class="quote">&gt; +            if (!principalToInherit) {
&gt; +              principalToInherit = loadInfo-&gt;TriggeringPrincipal();
&gt; +            }
&gt; +            nsCOMPtr&lt;nsIContentSecurityPolicy&gt; originalCsp;
&gt; +            principalToInherit-&gt;GetCsp(getter_AddRefs(originalCsp));</span >

I think you can move this code down after the NullPrincipal creation, so that everything CSP related is blocked together.

&#64;&#64; +310,4 &#64;&#64;
<span class="quote">&gt;                pAttrs.InheritFromNecko(nAttrs);
&gt;                prin = nsNullPrincipal::Create(pAttrs);
&gt;              }
&gt; +            if (originalCsp) {</span >

Please add a comment explaining what we are doing here.

::: caps/nsSystemPrincipal.cpp
&#64;&#64; +72,5 &#64;&#64;
<span class="quote">&gt;  
&gt;  NS_IMETHODIMP
&gt; +nsSystemPrincipal::SetCsp(nsIContentSecurityPolicy* aCsp)
&gt; +{
&gt; +  // CSP on a system principal makes no sense</span >

please add the assertion here as well, we should never even try to set a CSP on the systemPrincipal.

::: dom/security/nsCSPService.cpp
&#64;&#64; +73,4 &#64;&#64;
<span class="quote">&gt;    if (NS_SUCCEEDED(rv) &amp;&amp; match) {
&gt;      return true;
&gt;    }
&gt; +  // about:srcdoc *is* subject to CSP</span >

Generally about: is not subject to CSP, but &quot;about:srcdoc&quot; is.

&#64;&#64; +77,5 &#64;&#64;
<span class="quote">&gt; +  nsAutoCString uriSpec;
&gt; +  aURI-&gt;GetSpec(uriSpec);
&gt; +  if (uriSpec.EqualsLiteral(&quot;about:srcdoc&quot;)) {
&gt; +    return true;
&gt; +  }</span >

That part probably needs to be properly rebased after <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Explicitly use javascript: instead of URI_INHERITS_SECURITY_CONTEXT within subjectToCSP()"
   href="/show_bug.cgi?id=1330035">Bug 1330035</a> has merged into central.

::: dom/security/test/csp/file_iframe_sandbox_srcdoc.html
&#64;&#64; +5,5 &#64;&#64;
<span class="quote">&gt; +  &lt;title&gt;<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a> - CSP should restrict scripts in srcdoc iframe even if sandboxed&lt;/title&gt;
&gt; +&lt;/head&gt;
&gt; +&lt;body&gt;
&gt; +&lt;iframe srcdoc=&quot;&lt;img src=x onerror='alert(9);parent.postMessage({result: `unexpected-csp-violation`}, `*`);'&gt;&quot;
&gt; +        sandbox=&quot;allow-scripts allow-modals&quot;&gt;&lt;/iframe&gt;</span >

why do you need the alert(9); I think that will cause trouble, please remove.

::: dom/security/test/csp/test_iframe_sandbox_srcdoc.html
&#64;&#64; +10,5 &#64;&#64;
<span class="quote">&gt; +&lt;p id=&quot;display&quot;&gt;<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>&lt;/p&gt;
&gt; +&lt;div id=&quot;content&quot; style=&quot;display: none&quot;&gt;
&gt; +
&gt; +
&gt; +&lt;/div&gt;</span >

nit: please move ending tag on the same line as starting tag or remove that whole div block.

&#64;&#64; +27,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +    if(topic === &quot;csp-on-violate-policy&quot;) {
&gt; +      var violationString = SpecialPowers.getPrivilegedProps(SpecialPowers.
&gt; +                             do_QueryInterface(subject, &quot;nsISupportsCString&quot;), &quot;data&quot;);
&gt; +      if (!violationString.includes(&quot;Inline Script&quot;)) {</span >

Please add a small comment why this works.

&#64;&#64; +30,5 &#64;&#64;
<span class="quote">&gt; +                             do_QueryInterface(subject, &quot;nsISupportsCString&quot;), &quot;data&quot;);
&gt; +      if (!violationString.includes(&quot;Inline Script&quot;)) {
&gt; +        return
&gt; +      }
&gt; +        window.testResult(&quot;inline script&quot;);</span >

nit: indendation

In general I think you are better off doing the actual assertion here and just have a finish() function which is shared by the two states.
ok(true, &quot;CSP inherited into sandboxed srcdoc iframe, script blocked.&quot;);

&#64;&#64; +51,5 &#64;&#64;
<span class="quote">&gt; +}
&gt; +
&gt; +addEventListener(&quot;message&quot;, function(e) {
&gt; +  ok(false, &quot;We should not execute JS in srcdoc iframe.&quot;);
&gt; +  testResult(e.data);</span >

and then also from here you could just call finish().</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8825818&amp;action=edit"
           title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8825818</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div></div></div><div class="change-set" id="c23"><div class="comment" data-id="11977167" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-12 03:41 PST" data-time="1484221297">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8826149"
         class="attachment patch obsolete"
         data-id="8826149" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">
      <meta itemprop="contentSize" content="13154">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8826149">
          <a class="link" href="attachment.cgi?id=8826149&amp;action=diff">
        <span id="att-8826149-description" itemprop="description">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8826149&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8826149">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-23" data-comment-id="11977167">Next iteration. Please take a look.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8825818&amp;action=edit"
           title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8825818</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8825818&amp;action=edit"
           title="0001-Bug-1073952-inhereit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8825818</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8826149&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826149</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8826149&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826149</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="11977391" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a71803321_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-12 05:57 PST" data-time="1484229453">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="11977391">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8826149" name="attach_8826149" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8826149</a> <a href="/attachment.cgi?id=8826149&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8826149&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8826149'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8826149" name="attach_8826149" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8826149</a> <a href="/attachment.cgi?id=8826149&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8826149&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8826149'>[review]</a>:
-----------------------------------------------------------------

close, please just fix the coding style within GetChannelResultPrincipal;
1) add comment explaining what you are doing
2) write all the code that belongs to applying the CSP to the freshly created NullPrincipal within one block.

::: caps/nsScriptSecurityManager.cpp
&#64;&#64; +314,5 &#64;&#64;
<span class="quote">&gt; +            uri-&gt;GetSpec(URISpec);
&gt; +            // if sandboxed, about:srcdoc inherits CSP from parent.
&gt; +            if (URISpec.EqualsLiteral(&quot;about:srcdoc&quot;)) {
&gt; +              nsCOMPtr&lt;nsIContentSecurityPolicy&gt; originalCsp;
&gt; +              principalToInherit-&gt;GetCsp(getter_AddRefs(originalCsp));</span >

move the whole querying of the principalToInherit within this if() {} block. No need to query the principalToInherit for non about:srcdoc cases.

::: dom/security/test/csp/test_iframe_sandbox_srcdoc.html
&#64;&#64; +44,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +window.finish = function() {
&gt; +  window.examiner.remove();
&gt; +  SimpleTest.finish();
&gt; +}</span >

just curious: is there any reason you define finish on the window instead of just using
function finish() {}??</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8826149&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826149</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div></div></div><div class="change-set" id="c25"><div class="comment" data-id="11980024" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a71803321_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-13 01:20 PST" data-time="1484299212">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8826510"
         class="attachment patch obsolete"
         data-id="8826510" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">
      <meta itemprop="contentSize" content="13978">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8826510">
          <a class="link" href="attachment.cgi?id=8826510&amp;action=diff">
        <span id="att-8826510-description" itemprop="description">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8826510&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8826510">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-25" data-comment-id="11980024">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c24">comment #24</a>)
<span class="quote">&gt; close, please just fix the coding style within GetChannelResultPrincipal;</span >

Done.

<span class="quote">&gt; 1) add comment explaining what you are doing</span >

I had some comments and added some more. I wasn't exactly sure which part you were referring to.

<span class="quote">&gt; 2) write all the code that belongs to applying the CSP to the freshly
&gt; created NullPrincipal within one block.</span >

Done.

<span class="quote">&gt; ::: caps/nsScriptSecurityManager.cpp
&gt; &#64;&#64; +314,5 &#64;&#64;
&gt; move the whole querying of the principalToInherit within this if() {} block.
&gt; No need to query the principalToInherit for non about:srcdoc cases.</span >

Done
 
<span class="quote">&gt; ::: dom/security/test/csp/test_iframe_sandbox_srcdoc.html
&gt; &#64;&#64; +44,5 &#64;&#64;
&gt; just curious: is there any reason you define finish on the window instead of
&gt; just using
&gt; function finish() {}??</span >

That was copied from some other test. I changed it.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8826149&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826149</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8826149&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826149</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8826510&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826510</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8826510&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826510</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="11980076" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a71803321_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a71803321_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-13 01:25 PST" data-time="1484299515">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="11980076">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8826510" name="attach_8826510" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8826510</a> <a href="/attachment.cgi?id=8826510&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8826510&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8826510'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8826510" name="attach_8826510" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8826510</a> <a href="/attachment.cgi?id=8826510&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8826510&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8826510'>[review]</a>:
-----------------------------------------------------------------

Code looks good but I think you have to update the commit message before landing.

::: caps/BasePrincipal.cpp
&#64;&#64; +441,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +  MOZ_ASSERT(!mCSP, &quot;do not destroy an existing CSP&quot;);
&gt; +  if (mCSP) {
&gt; +    return NS_ERROR_ALREADY_INITIALIZED;
&gt; +    }</span >

nit: indendation, did I missed that the first time around?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8826510&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826510</a> -
        Flags: review?(ckerschb) &rarr; review+</div></div></div><div class="change-set" id="a72391917_363267"><div class="change" id="aa72391917_363267">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a72391917_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a72391917_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a72391917_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a72391917_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a72391917_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-13 02:04 PST" data-time="1484301856">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - increase test coverage for sandboxed iframe srcdoc inheriting CSP"
   href="/show_bug.cgi?id=1330920">1330920</a></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="11981821" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a72391917_363267"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a72391917_363267"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-13 13:39 PST" data-time="1484343597">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="11981821">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c16">comment #16</a>)
<span class="quote">&gt; about:srcdoc. And probably we should only do that for TYPE_SUBDOCUMENT, right?</span >

What about TYPE_DOCUMENT that has a CSP sandbox attribute? Do we have &quot;self&quot; tests for those?

What if the TYPE_DOCUMENT was opened sandboxed from a sandboxed about:srcdoc frame? What if that document is a data: document which inherits the about:srcdoc URL?</pre></div><div class="change-set" id="c28"><div class="comment" data-id="11984472" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a72391917_363267"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a72391917_363267"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-16 01:15 PST" data-time="1484558120">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="11984472">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c27">comment #27</a>)
<span class="quote">&gt; (In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c16">comment #16</a>)
&gt; &gt; about:srcdoc. And probably we should only do that for TYPE_SUBDOCUMENT, right?
&gt; What about TYPE_DOCUMENT that has a CSP sandbox attribute? Do we have &quot;self&quot;
&gt; tests for those?</span >

My current patch adds the CSP to the principal regardless of the load type, as long as it's sandboxed.
We have tests for the CSP sandbox directive in <a rel="nofollow" href="http://searchfox.org/mozilla-central/source/dom/security/test/csp/test_sandbox.html">http://searchfox.org/mozilla-central/source/dom/security/test/csp/test_sandbox.html</a>, but they run in a frame (SUBDOCUMENT). But this shouldn't matter given my patch does not look at the load type.

<span class="quote">&gt; What if the TYPE_DOCUMENT was opened sandboxed from a sandboxed about:srcdoc
&gt; frame? What if that document is a data: document which inherits the
&gt; about:srcdoc URL?</span >

We have tests for nesting in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - increase test coverage for sandboxed iframe srcdoc inheriting CSP"
   href="/show_bug.cgi?id=1330920">bug 1330920</a>, I will add more to those interesting cases you mention.</pre></div><div class="change-set" id="c29"><div class="comment" data-id="11988513" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a72391917_363267"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a72391917_363267"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-17 13:13 PST" data-time="1484687594">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="11988513">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8826510" name="attach_8826510" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8826510</a> <a href="/attachment.cgi?id=8826510&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8826510&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8826510'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8826510" name="attach_8826510" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">attachment 8826510</a> <a href="/attachment.cgi?id=8826510&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[details]</a> <a href="/attachment.cgi?id=8826510&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8826510'>[review]</a>:
-----------------------------------------------------------------

Ouch -- thought I submitted this Friday. Thank goodness BMO saves drafts automatically!

review below is
 - 2 comment nits
 - concern about giving all about: urls a CSP-free-pass
 - not sure the test adequately covers the actual bug, just checks the one initial symptom

For the test case I suppose it's good enough to file another bug saying we need more tests. Or better, add them to the web-platform tests and ensure all the browsers behave the same way.

I'm on the fence about the about: thing being serious enough to nix this review, but I guess that's a &quot;pre-existing condition&quot; and in America that means &quot;it's not my problem&quot; (or something like that). We're running into problems with URI_IS_LOCAL_RESOURCE in other bugs, too; maybe we should only be giving a free pass to  URI_IS_UI_RESOURCE instead. Some about: URLs would inherit that from their underlying chrome/resource base, and others would not. I think about:srcdoc is one that would not which might be a win here -- you wouldn't have to special case it for whitelisting (though we'd still have to do the special &quot;copy the CSP&quot; bit).

Guess that could go in a new but, too.

r=dveditz

::: caps/nsIPrincipal.idl
&#64;&#64; +140,3 &#64;&#64;
<span class="quote">&gt;       * Use this function to query the associated CSP with this principal.
&gt; +     * Please *only* use this function to *set* a CSP when you know exactly what you are doing.
&gt; +     * Most likely you want to call ensureCSP instead of setCSP.</span >

OK on removing the blank line, but I'd add one before the new stuff to make it stand out more. And pare down the opening (no &quot;please&quot;) so the important stuff pops out before people stop paying attention :-)

* DO NOT *set* a CSP unless you know exactly what you are doing (implementing CSP)
* Most likely (etc.)

::: caps/nsSystemPrincipal.cpp
&#64;&#64; +73,5 &#64;&#64;
<span class="quote">&gt;  NS_IMETHODIMP
&gt; +nsSystemPrincipal::SetCsp(nsIContentSecurityPolicy* aCsp)
&gt; +{
&gt; +  // Never destroy an existing CSP on the principal.
&gt; +  // This method should only be called in rare cases.</span >

This is the wrong comment for this case. Maybe &quot;System Principal ignore CSP&quot; or something? Or at least &quot;Cannot set a CSP on the system principal&quot;

::: dom/security/nsCSPService.cpp
&#64;&#64; +73,4 &#64;&#64;
<span class="quote">&gt;    if (NS_SUCCEEDED(rv) &amp;&amp; match) {
&gt;      return true;
&gt;    }
&gt; +  // about is not subject to CSP (futher below), but about:srcdoc *is*.</span >

I'm not sure I'm comfortable giving a blanket pass to about: -- there's no guarantee that it's a &quot;safe local&quot; kind of thing, and in fact it can be remote content (like the content-services plan for about:remote-newtab). Who is going to be 1) including about:, 2) using CSP, and 3) can't add about: to the whitelist?

That's a separate issue from special cases for about:srcdoc though.

::: dom/security/test/csp/file_iframe_sandbox_srcdoc.html^headers^
&#64;&#64; +1,1 &#64;&#64;
<span class="quote">&gt; +content-security-policy: default-src *;</span >

This seems an extremely narrow test. The bug was originally concerned about a script bypass (though the content was still sandboxed so it wasn't XSS), but the investigation showed that sandboxed srcdoc got no CSP at all. Shouldn't we test more than just scripts? What if scripts get blocked for some unrelated reason but we don't enforce the content loading rules? Might also want to add a test that we _didn't_ break srcdoc CSP in the non-sandboxed case.

Have you tested this test on a build without the patch so we know that it fails as expected? Sorry for being picky, but I've been burned by tests that turned out not to be testing anything because of some bug in the test, or because some future regression broke the test into a false-passing state.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8826510&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826510</a> -
        Flags: review?(dveditz) &rarr; review+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="12005667" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a72391917_363267"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a72391917_363267"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-24 05:52 PST" data-time="1485265974">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8829841"
         class="attachment patch obsolete"
         data-id="8829841" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">
      <meta itemprop="contentSize" content="13540">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8829841">
          <a class="link" href="attachment.cgi?id=8829841&amp;action=diff">
        <span id="att-8829841-description" itemprop="description">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8829841&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8829841">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-30" data-comment-id="12005667">The comments you, Dan, raised were very helpful and fixed a CSP bypass that I would have left in.
This also means that I had to change and increase test coverage to verify this is all working well.

For this reason I am merging <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - increase test coverage for sandboxed iframe srcdoc inheriting CSP"
   href="/show_bug.cgi?id=1330920">bug 1330920</a> back into this.

Please review the next iteration, you will note that I added a data URI check and removed the changes to CSPService::subjectToCSP, which makes one of your concerns obsolete.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8829841&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8829841</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8829841&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8829841</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="a73356096_428608"><div class="change" id="aa73356096_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356096_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a73356096_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a73356096_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a73356096_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a73356096_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-24 05:53 PST" data-time="1485266035">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8826510&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc.patch"
           class=""
        >Attachment #8826510</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="12005673" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356096_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356096_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-24 05:56 PST" data-time="1485266168">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8829843"
         class="attachment patch obsolete"
         data-id="8829843" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">
      <meta itemprop="contentSize" content="8276">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8829843">
          <a class="link" href="attachment.cgi?id=8829843&amp;action=diff">
        <span id="att-8829843-description" itemprop="description">0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8829843&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8829843">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-31" data-comment-id="12005673">This is the test that ckerschb originally wrote in this bug.
It now comes with a data URI test case added (and the sandbox attribute was missing).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8829843&amp;action=edit"
           title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8829843</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8829843&amp;action=edit"
           title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8829843</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="a73356266_428608"><div class="change" id="aa73356266_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a73356266_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a73356266_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a73356266_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-24 05:56 PST" data-time="1485266205">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - increase test coverage for sandboxed iframe srcdoc inheriting CSP"
   href="/show_bug.cgi?id=1330920">1330920</a></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="12005713" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73356266_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-24 06:11 PST" data-time="1485267096">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="12005713">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8829841" name="attach_8829841" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8829841</a> <a href="/attachment.cgi?id=8829841&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8829841&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8829841'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8829841" name="attach_8829841" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8829841</a> <a href="/attachment.cgi?id=8829841&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8829841&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8829841'>[review]</a>:
-----------------------------------------------------------------

Besides GetChannelResultPrincipal (and also nsCSPService) nothing changed right?

::: caps/nsScriptSecurityManager.cpp
&#64;&#64; +301,5 &#64;&#64;
<span class="quote">&gt; +          OriginAttributes attrs;
&gt; +          loadInfo-&gt;GetOriginAttributes(&amp;attrs);
&gt; +          attrs.StripAttributes(OriginAttributes::STRIP_ADDON_ID);
&gt; +          prin = nsNullPrincipal::Create(attrs);
&gt; +        }</span >

it seems the whole function uses 4 space indendation, right? please change that back so it's easier to pinpoint your changes.

&#64;&#64; +313,5 &#64;&#64;
<span class="quote">&gt; +        nsresult rv = uri-&gt;SchemeIs(&quot;data&quot;, &amp;isDataURL);
&gt; +        bool isDataDocument = NS_SUCCEEDED(rv) &amp;&amp; isDataURL &amp;&amp;
&gt; +                              loadInfo-&gt;GetExternalContentPolicyType() == nsIContentPolicy::TYPE_DOCUMENT;
&gt; +        // detecting loads ofiframe[srcdoc] and inline documents created with data:
&gt; +        if (URISpec.EqualsLiteral(&quot;about:srcdoc&quot;) || isDataDocument) {</span >

I am slightly confused about all that. So you have to explain. My biggest question is: If a load is of type TYPE_DOCUMENT, then it's a top level load, right? So where should it inherit the CSP from?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8829841&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8829841</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="12009064" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73356266_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 03:35 PST" data-time="1485344150">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12009064">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8829843" name="attach_8829843" title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">attachment 8829843</a> <a href="/attachment.cgi?id=8829843&amp;action=edit" title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">[details]</a> <a href="/attachment.cgi?id=8829843&amp;action=diff" title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8829843'>[review]</a>
0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8829843" name="attach_8829843" title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">attachment 8829843</a> <a href="/attachment.cgi?id=8829843&amp;action=edit" title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">[details]</a> <a href="/attachment.cgi?id=8829843&amp;action=diff" title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8829843'>[review]</a>:
-----------------------------------------------------------------

Can you verify that actually all of your tests run? Since we added back the contentPolicy check within docshell I am worried that for a top_level loads we get 'allowed' twice, once from within docshell and once from within the contentSecuritymanager which would bring your counter out of order.

tests itself look fine, r=me

::: dom/security/test/csp/file_iframe_srcdoc.sjs
&#64;&#64; +35,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +
&gt; +const INNER_DATAURI_IFRAME = `
&gt; +  &lt;iframe sandbox='allow-scripts' src='data:text/html,&lt;script&gt;
&gt; +      alert(1);debugger;parent.parent.parent.postMessage({result: &amp;quot;allowed&amp;quot;}, &amp;quot;*&amp;quot;);</span >

please remove alert(1) and debugger

&#64;&#64; +52,5 &#64;&#64;
<span class="quote">&gt; +function handleRequest(request, response) {
&gt; +  const query = new URLSearchParams(request.queryString);
&gt; +
&gt; +  response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;, false);
&gt; +  response.setHeader(&quot;Content-Security-Policy&quot;, query.get(&quot;csp&quot;), false);</span >

nit: please check if query.get(&quot;csp&quot;) actually returns a string, otherwise you are sending the CSP header but no value. not the end of the world but probably confusing

&#64;&#64; +60,5 &#64;&#64;
<span class="quote">&gt; +    response.write(SIMPLE_IFRAME_SRCDOC);
&gt; +    return;
&gt; +  }
&gt; +
&gt; +  else if (query.get(&quot;action&quot;) === &quot;nested_iframe_srcdoc&quot;) {</span >

nit: remove the else, you already return if the first branch is taken

&#64;&#64; +65,5 &#64;&#64;
<span class="quote">&gt; +    response.write(NESTED_IFRAME_SRCDOC);
&gt; +    return;
&gt; +  }
&gt; +
&gt; +  else if (query.get(&quot;action&quot;) === &quot;nested_iframe_srcdoc_datauri&quot;) {</span >

same here, remove the else.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8829843&amp;action=edit"
           title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8829843</a> -
        Flags: review?(ckerschb) &rarr; review+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="12009328" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 05:30 PST" data-time="1485351042">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12009328"><span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8829841" name="attach_8829841" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8829841</a> <a href="/attachment.cgi?id=8829841&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8829841&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8829841'>[review]</a>
&gt; 0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch
&gt; 
&gt; Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8829841" name="attach_8829841" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8829841</a> <a href="/attachment.cgi?id=8829841&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8829841&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8829841'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; Besides GetChannelResultPrincipal (and also nsCSPService) nothing changed
&gt; right?</span >

Correct

<span class="quote">&gt; 
&gt; ::: caps/nsScriptSecurityManager.cpp
&gt; &#64;&#64; +301,5 &#64;&#64;
&gt; &gt; +          OriginAttributes attrs;
&gt; &gt; +          loadInfo-&gt;GetOriginAttributes(&amp;attrs);
&gt; &gt; +          attrs.StripAttributes(OriginAttributes::STRIP_ADDON_ID);
&gt; &gt; +          prin = nsNullPrincipal::Create(attrs);
&gt; &gt; +        }
&gt; 
&gt; it seems the whole function uses 4 space indendation, right? please change
&gt; that back so it's easier to pinpoint your changes.
&gt; </span >

OK.

<span class="quote">&gt; &#64;&#64; +313,5 &#64;&#64;
&gt; &gt; +        nsresult rv = uri-&gt;SchemeIs(&quot;data&quot;, &amp;isDataURL);
&gt; &gt; +        bool isDataDocument = NS_SUCCEEDED(rv) &amp;&amp; isDataURL &amp;&amp;
&gt; &gt; +                              loadInfo-&gt;GetExternalContentPolicyType() == nsIContentPolicy::TYPE_DOCUMENT;
&gt; &gt; +        // detecting loads ofiframe[srcdoc] and inline documents created with data:
&gt; &gt; +        if (URISpec.EqualsLiteral(&quot;about:srcdoc&quot;) || isDataDocument) {
&gt; 
&gt; I am slightly confused about all that. So you have to explain. My biggest
&gt; question is: If a load is of type TYPE_DOCUMENT, then it's a top level load,
&gt; right? So where should it inherit the CSP from?</span >

Sorry. My local file said TYPE_SUBDOCUMENT, but I forgot to commit the change to include it in the patch file.</pre></div><div class="change-set" id="c36"><div class="comment" data-id="12009361" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 05:46 PST" data-time="1485351969">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8830287"
         class="attachment patch obsolete"
         data-id="8830287" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">
      <meta itemprop="contentSize" content="12545">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8830287">
          <a class="link" href="attachment.cgi?id=8830287&amp;action=diff">
        <span id="att-8830287-description" itemprop="description">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8830287&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830287">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8829841&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8829841</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8829841&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8829841</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8830287&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830287</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="12009365" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 05:46 PST" data-time="1485352017">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8830288"
         class="attachment patch obsolete"
         data-id="8830288" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">
      <meta itemprop="contentSize" content="8304">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8830288">
          <a class="link" href="attachment.cgi?id=8830288&amp;action=diff">
        <span id="att-8830288-description" itemprop="description">0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8830288&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830288">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-37" data-comment-id="12009365">Carrying over ckerschb's r+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830288&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8830288</a> -
        Flags: review?(dveditz)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="12009369" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 05:48 PST" data-time="1485352122">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8830289"
         class="attachment patch obsolete"
         data-id="8830289" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">
      <meta itemprop="contentSize" content="6806">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8830289">
          <a class="link" href="attachment.cgi?id=8830289&amp;action=diff">
        <span id="att-8830289-description" itemprop="description">0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8830289&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830289">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-38" data-comment-id="12009369">This patch should carry the whitespace changes only.
I tested by with &quot;git diff -w&quot;, which omits whitespace changes and thus shows nothing.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8829843&amp;action=edit"
           title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8829843</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8829843&amp;action=edit"
           title="0001-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8829843</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8830289&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8830289</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="12009992" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73356266_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 08:53 PST" data-time="1485363218">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="12009992">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8830287" name="attach_8830287" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8830287</a> <a href="/attachment.cgi?id=8830287&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8830287&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830287'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8830287" name="attach_8830287" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8830287</a> <a href="/attachment.cgi?id=8830287&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8830287&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830287'>[review]</a>:
-----------------------------------------------------------------

::: caps/nsScriptSecurityManager.cpp
&#64;&#64; +312,5 &#64;&#64;
<span class="quote">&gt; +            bool isDataURL = false;
&gt; +            nsresult rv = uri-&gt;SchemeIs(&quot;data&quot;, &amp;isDataURL);
&gt; +            bool isDataDocument = NS_SUCCEEDED(rv) &amp;&amp; isDataURL &amp;&amp;
&gt; +                                  loadInfo-&gt;GetExternalContentPolicyType() == nsIContentPolicy::TYPE_SUBDOCUMENT;
&gt; +            // detecting iframe[srcdoc] and inline documents created with data:</span >

I think this is still not entirely correct. What if a page has a CSP and loads a new window of about:srcdoc. The triggeringPrincipal in that case would be the page that holds the CSP and as such the CSP would be added to the about:srcdoc page which is *not* what we want, right?

I *think* (not entirely certain) that we want a TYPE_SUBDOCUMENT check surrounding all of the CSP quirks code.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830287&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830287</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="12009996" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73356266_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 08:54 PST" data-time="1485363295">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="12009996">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8830289" name="attach_8830289" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">attachment 8830289</a> <a href="/attachment.cgi?id=8830289&amp;action=edit" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[details]</a> <a href="/attachment.cgi?id=8830289&amp;action=diff" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830289'>[review]</a>
0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8830289" name="attach_8830289" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">attachment 8830289</a> <a href="/attachment.cgi?id=8830289&amp;action=edit" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[details]</a> <a href="/attachment.cgi?id=8830289&amp;action=diff" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830289'>[review]</a>:
-----------------------------------------------------------------

Please ask dveditz to review that since I am not a caps peer and this change does not affect csp handling.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830289&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8830289</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div></div></div><div class="change-set" id="c41"><div class="comment" data-id="12010136" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73356266_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 09:18 PST" data-time="1485364735">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="12010136">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c39">comment #39</a>)
<span class="quote">&gt; I think this is still not entirely correct. What if a page has a CSP and
&gt; loads a new window of about:srcdoc. The triggeringPrincipal in that case
&gt; would be the page that holds the CSP and as such the CSP would be added to
&gt; the about:srcdoc page which is *not* what we want, right?</span >

Certainly, about:srcdoc can not be loaded by itself in a new window (exhausting day), but what I am worried about is that GetChannelResultPrincipal() is called frequently and adding a lot of code (e.g. string comparison) that is *not* needed in 99,9% of the time worries me. Maybe we can find some precondition which needs to be met before we do all of that csp quirks.</pre></div><div class="change-set" id="c42"><div class="comment" data-id="12010199" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-25 09:32 PST" data-time="1485365575">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="12010199">For more context, the patch is inserted in a line [1] which is only executed for sandboxed load:
<span class="quote">&gt;         if (!aIgnoreSandboxing &amp;&amp; loadInfo-&gt;GetLoadingSandboxed()) {</span >

I don't think this codepath is really hot, but I'm up to modify the patch to check for whichever case is rarest first.

[1] <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/bf98cd4315b5efa1b28831001ad27d54df7bbb68/caps/nsScriptSecurityManager.cpp#305">http://searchfox.org/mozilla-central/rev/bf98cd4315b5efa1b28831001ad27d54df7bbb68/caps/nsScriptSecurityManager.cpp#305</a></pre></div><div class="change-set" id="c43"><div class="comment" data-id="12012322" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73356266_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-26 01:35 PST" data-time="1485423334">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="12012322">I am slightly worried about adding code to scriptsecurityManger::GetChannelResultPrincipal(). Freddy convinved me that the code is not code because we only execute it for sandboxed loads, but it's still security critical code, so let's make sure we get it right.

Vidyo/IRC discussion notes:

* please surround all of the CSP quirks with if (contentTYpe == TYPE_SUBDOCUMENT)
* bool isData = (NS_SUCCEEDED(aURI-&gt;SchemeIs(&quot;data&quot;, &amp;isData)) &amp;&amp; isData;
* please add more documentation, especially for the data: case, at the moment we only talk about about:srcdoc
* then I am willing to r+ - thanks</pre></div><div class="change-set" id="c44"><div class="comment" data-id="12012451" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-26 02:40 PST" data-time="1485427227">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8830668"
         class="attachment patch obsolete"
         data-id="8830668" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">
      <meta itemprop="contentSize" content="12491">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8830668">
          <a class="link" href="attachment.cgi?id=8830668&amp;action=diff">
        <span id="att-8830668-description" itemprop="description">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8830668&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830668">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-44" data-comment-id="12012451">Updated patch to take feedback from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c43">comment #43</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830287&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830287</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8830668&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830668</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8830668&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830668</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="12012454" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73356266_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73356266_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-26 02:42 PST" data-time="1485427330">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8830670"
         class="attachment patch obsolete"
         data-id="8830670" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">
      <meta itemprop="contentSize" content="8304">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8830670">
          <a class="link" href="attachment.cgi?id=8830670&amp;action=diff">
        <span id="att-8830670-description" itemprop="description">0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8830670&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830670">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-45" data-comment-id="12012454">Updated test (carrying over r+)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830670&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8830670</a> -
        Flags: review+</div></div></div><div class="change-set" id="a73517418_428608"><div class="change" id="aa73517418_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a73517418_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a73517418_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a73517418_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-26 02:42 PST" data-time="1485427357">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830288&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8830288</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8830288&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8830288</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div></div></div><div class="change-set" id="c46"><div class="comment" data-id="12012459" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-26 02:43 PST" data-time="1485427432">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8830671"
         class="attachment patch obsolete"
         data-id="8830671" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">
      <meta itemprop="contentSize" content="6806">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8830671">
          <a class="link" href="attachment.cgi?id=8830671&amp;action=diff">
        <span id="att-8830671-description" itemprop="description">0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8830671&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8830671">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-46" data-comment-id="12012459">whitespace-change only, so the function is properly using 2 spaces for indent. Confirmed through &quot;diff -w&quot;.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830289&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8830289</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8830671&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8830671</a> -
        Flags: review?(dveditz)</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="12012461" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73517418_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-26 02:44 PST" data-time="1485427473">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="12012461">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8830668" name="attach_8830668" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8830668</a> <a href="/attachment.cgi?id=8830668&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8830668&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830668'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8830668" name="attach_8830668" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8830668</a> <a href="/attachment.cgi?id=8830668&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8830668&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830668'>[review]</a>:
-----------------------------------------------------------------

Great, I like that way more. Thanks for updating!

::: caps/nsScriptSecurityManager.cpp
&#64;&#64; +318,5 &#64;&#64;
<span class="quote">&gt; +                  principalToInherit = loadInfo-&gt;TriggeringPrincipal();
&gt; +                }
&gt; +                nsCOMPtr&lt;nsIContentSecurityPolicy&gt; originalCsp;
&gt; +                principalToInherit-&gt;GetCsp(getter_AddRefs(originalCsp));
&gt; +                // if the principalToInherit had a CSP, we add it to the newly created NullPrincipal</span >

nit: 80 chars line</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830668&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830668</a> -
        Flags: review?(ckerschb) &rarr; review+</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="12015563" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a73517418_428608"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 00:57 PST" data-time="1485507440">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="12015563">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8830671" name="attach_8830671" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">attachment 8830671</a> <a href="/attachment.cgi?id=8830671&amp;action=edit" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[details]</a> <a href="/attachment.cgi?id=8830671&amp;action=diff" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830671'>[review]</a>
0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8830671" name="attach_8830671" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">attachment 8830671</a> <a href="/attachment.cgi?id=8830671&amp;action=edit" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[details]</a> <a href="/attachment.cgi?id=8830671&amp;action=diff" title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830671'>[review]</a>:
-----------------------------------------------------------------

r=dveditz</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830671&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8830671</a> -
        Flags: review?(dveditz) &rarr; review+</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="12015571" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a73517418_428608"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 01:01 PST" data-time="1485507681">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="12015571">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8830668" name="attach_8830668" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8830668</a> <a href="/attachment.cgi?id=8830668&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8830668&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830668'>[review]</a>
0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8830668" name="attach_8830668" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">attachment 8830668</a> <a href="/attachment.cgi?id=8830668&amp;action=edit" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[details]</a> <a href="/attachment.cgi?id=8830668&amp;action=diff" title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1073952&amp;attachment=8830668'>[review]</a>:
-----------------------------------------------------------------

r=dveditz</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830668&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830668</a> -
        Flags: review?(dveditz) &rarr; review+</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="12015580" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 01:04 PST" data-time="1485507853">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="12015580">Thanks for the speedy review!
Successful try run: 
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=7e6186b48b1d4cf9273e6ad365d9fd96249a1582&amp;selectedJob=72180732">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=7e6186b48b1d4cf9273e6ad365d9fd96249a1582&amp;selectedJob=72180732</a>

I'll only take ckerschb's nit for the 80 character then.</pre></div><div class="change-set" id="c51"><div class="comment" data-id="12015581" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 01:05 PST" data-time="1485507920">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8831069"
         class="attachment patch obsolete"
         data-id="8831069" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch">
      <meta itemprop="contentSize" content="12496">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8831069">
          <a class="link" href="attachment.cgi?id=8831069&amp;action=diff">
        <span id="att-8831069-description" itemprop="description">0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8831069&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8831069">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-51" data-comment-id="12015581">rebased, carrying over r+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830668&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8830668</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8831069&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8831069</a> -
        Flags: review+</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="12015583" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 01:05 PST" data-time="1485507947">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8831070"
         class="attachment patch obsolete"
         data-id="8831070" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch">
      <meta itemprop="contentSize" content="8304">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8831070">
          <a class="link" href="attachment.cgi?id=8831070&amp;action=diff">
        <span id="att-8831070-description" itemprop="description">0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8831070&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8831070">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-52" data-comment-id="12015583">rebased, carrying over r+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830670&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8830670</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8831070&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8831070</a> -
        Flags: review+</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="12015585" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 01:06 PST" data-time="1485507987">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8831072"
         class="attachment patch obsolete"
         data-id="8831072" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch">
      <meta itemprop="contentSize" content="6806">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8831072">
          <a class="link" href="attachment.cgi?id=8831072&amp;action=diff">
        <span id="att-8831072-description" itemprop="description">0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8831072&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1073952&attachment=8831072">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-53" data-comment-id="12015585">rebased, carrying over r+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8830671&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8830671</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8831072&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8831072</a> -
        Flags: review+</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="12015589" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 01:08 PST" data-time="1485508100">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="12015589">Please check in. Filenames denote the order they are in (0001, 0002 and then 0003).

Thank you!</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c55"><div class="comment" data-id="12015998" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_510726" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/4c5aee4c6938e29b1576314d2de9c6e7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_510726" id="a73517418_428608"><a class="email " href="/user_profile?user_id=510726" > <span class="fna">Pulsebot</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 05:15 PST" data-time="1485522951">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="12015998">Pushed by <a href="mailto:cbook&#64;mozilla.com">cbook&#64;mozilla.com</a>:
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/1e631015acc8">https://hg.mozilla.org/integration/mozilla-inbound/rev/1e631015acc8</a>
inherit CSP into iframe sandbox srcdoc r=ckerschb,dveditz
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/5534087efac3">https://hg.mozilla.org/integration/mozilla-inbound/rev/5534087efac3</a>
Part 2 -  tests for iframe sandbox srcdoc and data URIs with CSP r=ckerschb,dveditz
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/e63233859ee1">https://hg.mozilla.org/integration/mozilla-inbound/rev/e63233859ee1</a>
Part 3 -  proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal r=ckerschb,dveditz</pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="c56"><div class="comment" data-id="12017029" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a73517418_428608"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-27 10:37 PST" data-time="1485542261">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="12017029">I had to back this out for frequent but intermittent failures like <a rel="nofollow" href="https://treeherder.mozilla.org/logviewer.html#?job_id=72616140&amp;repo=mozilla-inbound">https://treeherder.mozilla.org/logviewer.html#?job_id=72616140&amp;repo=mozilla-inbound</a>

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/cabc87c3fa0a22f3650bde884e884ee4ea91046b">https://hg.mozilla.org/integration/mozilla-inbound/rev/cabc87c3fa0a22f3650bde884e884ee4ea91046b</a></pre><div class="activity"><div class="change">Flags: needinfo?(fbraun)</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="12018505" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a73517418_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-28 01:24 PST" data-time="1485595447">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="12018505">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c34">comment #34</a>)
<span class="quote">&gt; Can you verify that actually all of your tests run? Since we added back the
&gt; contentPolicy check within docshell I am worried that for a top_level loads
&gt; we get 'allowed' twice, once from within docshell and once from within the
&gt; contentSecuritymanager which would bring your counter out of order.</span >

Probably the intermittent is due do what I mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952#c34">comment 34</a> - the two content policy checks for loads of TYPE_SUBDOCUMENT might screw with your counter.</pre></div><div class="change-set" id="c58"><div class="comment" data-id="12146797" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-15 04:32 PDT" data-time="1489577572">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="12146797">Haven't had the time to look into this.
Repushed to try and looking other intermittent failures, I can still not reproduce on a Mac OS desktop, but only on try.
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=10be4e1e955af952b9f71de16808f64f2dde91a0&amp;selectedJob=83706303">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=10be4e1e955af952b9f71de16808f64f2dde91a0&amp;selectedJob=83706303</a>

Will debate next-steps with ckerschb.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(fbraun)</span></div></div></div><div class="change-set" id="c59"><div class="comment" data-id="12152419" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a73517418_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a73517418_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-16 14:06 PDT" data-time="1489698364">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="12152419">ckerschb had a hunch that the two tests would interact with each other - poorly.
I have indeed been able to push to try only one test enabled and it worked out.
I found some areas that were likely culprits and have pushed to try successfully.

I triggered a re-run for the previous failures (Mac OS X 10.10 opt), in case I just got lucky on this specific push. Will check results tomorrow.

Try run at <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=d3871d87accd6730299dee4fdcd8b236b3478e31&amp;selectedJob=84295977">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=d3871d87accd6730299dee4fdcd8b236b3478e31&amp;selectedJob=84295977</a></pre></div><div class="change-set" id="a77836309_428608"><div class="change" id="aa77836309_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836309_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a77836309_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a77836309_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a77836309_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a77836309_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 03:24 PDT" data-time="1489746248">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8831069&amp;action=edit"
           title="0001-Bug-1073952-inherit-CSP-into-iframe-sandbox-srcdoc-r.patch"
           class=""
        >Attachment #8831069</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a77836313_428608"><div class="change" id="aa77836313_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836313_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a77836313_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a77836313_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a77836313_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a77836313_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 03:24 PDT" data-time="1489746252">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8831070&amp;action=edit"
           title="0002-Bug-1073952-tests-for-iframe-sandbox-srcdoc-and-data.patch"
           class=""
        >Attachment #8831070</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a77836318_428608"><div class="change" id="aa77836318_428608">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a77836318_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a77836318_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a77836318_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 03:24 PDT" data-time="1489746257">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8831072&amp;action=edit"
           title="0003-Bug-1073952-proper-indentation-for-nsScriptSecurityM.patch"
           class=""
        >Attachment #8831072</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set ca-428608" id="c60"><div class="comment" data-id="12153929" data-no="60"
       data-tags="mozreview-request">
    
    <table class="layout-table change-head assignee" id="ch-60" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 03:59 PDT" data-time="1489748388">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-request</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-60"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (mozreview-request)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-60"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div id="att-8848471"
         class="attachment"
         data-id="8848471" itemscope itemtype="http://schema.org/MediaObject" style="display:none">
      <meta itemprop="name" content="reviewboard-121392-url.txt">
      <meta itemprop="contentSize" content="59">
      <meta itemprop="encodingFormat" content="text/x-review-board-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8848471" itemprop="contentUrl">
        <span id="att-8848471-description" itemprop="description">Bug 1073952: inherit CSP into iframe sandbox srcdoc</span></a>
        — <a href="attachment.cgi?id=8848471&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-60" data-comment-id="12153929" style="display:none">Review commit: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121392/diff/#index_header">https://reviewboard.mozilla.org/r/121392/diff/#index_header</a>
See other reviews: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121392/">https://reviewboard.mozilla.org/r/121392/</a></pre><div class="activity" style="display:none"><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: review?(ckerschb)</div><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: review?(ckerschb)</div><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: review?(dveditz)</div><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set ca-428608" id="c61"><div class="comment" data-id="12153930" data-no="61"
       data-tags="mozreview-request">
    
    <table class="layout-table change-head assignee" id="ch-61" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 03:59 PDT" data-time="1489748388">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-request</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-61"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (mozreview-request)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-61"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div id="att-8848472"
         class="attachment"
         data-id="8848472" itemscope itemtype="http://schema.org/MediaObject" style="display:none">
      <meta itemprop="name" content="reviewboard-121394-url.txt">
      <meta itemprop="contentSize" content="59">
      <meta itemprop="encodingFormat" content="text/x-review-board-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8848472" itemprop="contentUrl">
        <span id="att-8848472-description" itemprop="description">Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP</span></a>
        — <a href="attachment.cgi?id=8848472&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-61" data-comment-id="12153930" style="display:none">Review commit: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121394/diff/#index_header">https://reviewboard.mozilla.org/r/121394/diff/#index_header</a>
See other reviews: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121394/">https://reviewboard.mozilla.org/r/121394/</a></pre></div><div class="change-set ca-428608" id="c62"><div class="comment" data-id="12153931" data-no="62"
       data-tags="mozreview-request">
    
    <table class="layout-table change-head assignee" id="ch-62" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 03:59 PDT" data-time="1489748388">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-request</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-62"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (mozreview-request)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-62"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div id="att-8848473"
         class="attachment"
         data-id="8848473" itemscope itemtype="http://schema.org/MediaObject" style="display:none">
      <meta itemprop="name" content="reviewboard-121396-url.txt">
      <meta itemprop="contentSize" content="59">
      <meta itemprop="encodingFormat" content="text/x-review-board-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8848473" itemprop="contentUrl">
        <span id="att-8848473-description" itemprop="description">Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal</span></a>
        — <a href="attachment.cgi?id=8848473&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-62" data-comment-id="12153931" style="display:none">Review commit: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121396/diff/#index_header">https://reviewboard.mozilla.org/r/121396/diff/#index_header</a>
See other reviews: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121396/">https://reviewboard.mozilla.org/r/121396/</a></pre></div><div class="change-set" id="c63"><div class="comment" data-id="12155000" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 11:11 PDT" data-time="1489774271">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="12155000">Comment on <span class=""><a href="/attachment.cgi?id=8848471" name="attach_8848471" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">attachment 8848471</a> <a href="/attachment.cgi?id=8848471&amp;action=edit" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: inherit CSP into iframe sandbox srcdoc

Reuploaded test (now through mozreview instead of Bugzilla).
Carrying over review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: review+</div></div></div><div class="change-set" id="c64"><div class="comment" data-id="12155001" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 11:11 PDT" data-time="1489774284">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="12155001">Comment on <span class=""><a href="/attachment.cgi?id=8848472" name="attach_8848472" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">attachment 8848472</a> <a href="/attachment.cgi?id=8848472&amp;action=edit" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: tests for iframe sandbox srcdoc and data URIs with CSP

Reuploaded test (now through mozreview instead of Bugzilla).
Carrying over review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: review+</div></div></div><div class="change-set" id="c65"><div class="comment" data-id="12155005" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 11:11 PDT" data-time="1489774294">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="12155005">Comment on <span class=""><a href="/attachment.cgi?id=8848473" name="attach_8848473" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">attachment 8848473</a> <a href="/attachment.cgi?id=8848473&amp;action=edit" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal

Reuploaded patch (now through mozreview instead of Bugzilla).
Carrying over review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: <span class="activity-deleted">review?(dveditz)</span></div><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: <span class="activity-deleted">review?(ckerschb)</span></div><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: review+</div></div></div><div class="change-set" id="c66"><div class="comment" data-id="12155006" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 11:12 PDT" data-time="1489774330">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="12155006">Green on try, see mozreview. Please check in.</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c67"><div class="comment" data-id="12155557" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a77836318_428608"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-17 15:19 PDT" data-time="1489789192">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="12155557">Autoland can't push this because it doesn't have r+ set in MozReview.</pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="c68"><div class="comment" data-id="12156645" data-no="68"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head assignee" id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-18 11:46 PDT" data-time="1489862766">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="12156645">Comment on <span class=""><a href="/attachment.cgi?id=8848473" name="attach_8848473" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">attachment 8848473</a> <a href="/attachment.cgi?id=8848473&amp;action=edit" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121396/#review123676">https://reviewboard.mozilla.org/r/121396/#review123676</a></pre></div><div class="change-set" id="c69"><div class="comment" data-id="12158689" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 03:32 PDT" data-time="1490005950">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-69" data-comment-id="12158689">Ah, carrying over r+ from Bugzilla into MozReview doesn't work?</pre></div><div class="change-set" id="c70"><div class="comment" data-id="12158719" data-no="70"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a77836318_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 03:44 PDT" data-time="1490006667">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="12158719">Comment on <span class=""><a href="/attachment.cgi?id=8848472" name="attach_8848472" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">attachment 8848472</a> <a href="/attachment.cgi?id=8848472&amp;action=edit" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: tests for iframe sandbox srcdoc and data URIs with CSP

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121394/#review123832">https://reviewboard.mozilla.org/r/121394/#review123832</a>

r=me</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: review+</div></div></div><div class="change-set" id="c71"><div class="comment" data-id="12158722" data-no="71"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a77836318_428608"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 03:45 PDT" data-time="1490006756">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="12158722">Comment on <span class=""><a href="/attachment.cgi?id=8848471" name="attach_8848471" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">attachment 8848471</a> <a href="/attachment.cgi?id=8848471&amp;action=edit" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: inherit CSP into iframe sandbox srcdoc

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121392/#review123836">https://reviewboard.mozilla.org/r/121392/#review123836</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: review+</div></div></div><div class="change-set" id="c72"><div class="comment" data-id="12158766" data-no="72"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a77836318_428608"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:02 PDT" data-time="1490007737">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="12158766">Comment on <span class=""><a href="/attachment.cgi?id=8848473" name="attach_8848473" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">attachment 8848473</a> <a href="/attachment.cgi?id=8848473&amp;action=edit" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121396/#review123842">https://reviewboard.mozilla.org/r/121396/#review123842</a>

r=dveditz</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: review+</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="12158767" data-no="73"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a77836318_428608"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:02 PDT" data-time="1490007751">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="12158767">Comment on <span class=""><a href="/attachment.cgi?id=8848473" name="attach_8848473" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">attachment 8848473</a> <a href="/attachment.cgi?id=8848473&amp;action=edit" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121396/#review123846">https://reviewboard.mozilla.org/r/121396/#review123846</a></pre></div><div class="change-set" id="c74"><div class="comment" data-id="12158777" data-no="74"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a77836318_428608"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:04 PDT" data-time="1490007860">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="12158777">Comment on <span class=""><a href="/attachment.cgi?id=8848472" name="attach_8848472" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">attachment 8848472</a> <a href="/attachment.cgi?id=8848472&amp;action=edit" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: tests for iframe sandbox srcdoc and data URIs with CSP

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121394/#review123850">https://reviewboard.mozilla.org/r/121394/#review123850</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: review+</div></div></div><div class="change-set" id="c75"><div class="comment" data-id="12158778" data-no="75"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a77836318_428608"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:04 PDT" data-time="1490007887">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-75" data-comment-id="12158778">Comment on <span class=""><a href="/attachment.cgi?id=8848472" name="attach_8848472" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">attachment 8848472</a> <a href="/attachment.cgi?id=8848472&amp;action=edit" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: tests for iframe sandbox srcdoc and data URIs with CSP

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121394/#review123852">https://reviewboard.mozilla.org/r/121394/#review123852</a></pre></div><div class="change-set" id="c76"><div class="comment" data-id="12158780" data-no="76"
       data-tags="mozreview-review">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a77836318_428608"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:05 PDT" data-time="1490007904">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-review</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="12158780">Comment on <span class=""><a href="/attachment.cgi?id=8848471" name="attach_8848471" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">attachment 8848471</a> <a href="/attachment.cgi?id=8848471&amp;action=edit" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: inherit CSP into iframe sandbox srcdoc

<a rel="nofollow" href="https://reviewboard.mozilla.org/r/121392/#review123854">https://reviewboard.mozilla.org/r/121392/#review123854</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: review+</div></div></div><div class="change-set" id="c77"><div class="comment" data-id="12158783" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_523054" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/76607f7e05eabba5694eeabf7b12187c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_523054" id="a77836318_428608"><a class="email disabled" href="/user_profile?user_id=523054" > <span class="fna">Mozilla Autoland</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:06 PDT" data-time="1490007966">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="12158783">We're sorry, Autoland could not rebase your commits for you automatically. Please manually rebase your commits and try again.

hg error in cmd: hg rebase -s a8f304394417 -d f7541b903b15: rebasing 382824:a8f304394417 &quot;<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: inherit CSP into iframe sandbox srcdoc r=ckerschb,Tomcat&quot;
rebasing 382825:6f45e1f5c070 &quot;<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: tests for iframe sandbox srcdoc and data URIs with CSP r=ckerschb,Tomcat&quot;
merging dom/security/test/csp/mochitest.ini
warning: conflicts while merging dom/security/test/csp/mochitest.ini! (edit, then use 'hg resolve --mark')
unresolved conflicts (see hg resolve, then hg rebase --continue)</pre></div><div class="change-set ca-428608" id="c78"><div class="comment" data-id="12158812" data-no="78"
       data-tags="mozreview-request">
    
    <table class="layout-table change-head assignee" id="ch-78" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:17 PDT" data-time="1490008652">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-request</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-78"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (mozreview-request)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-78"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-78" data-comment-id="12158812" style="display:none">Comment on <span class=""><a href="/attachment.cgi?id=8848471" name="attach_8848471" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">attachment 8848471</a> <a href="/attachment.cgi?id=8848471&amp;action=edit" title="Bug 1073952: inherit CSP into iframe sandbox srcdoc">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: inherit CSP into iframe sandbox srcdoc

Review request updated; see interdiff: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121392/diff/1-2/">https://reviewboard.mozilla.org/r/121392/diff/1-2/</a></pre><div class="activity" style="display:none"><div class="change">
        <a href="/attachment.cgi?id=8848471&amp;action=edit"
           title="Bug 1073952: inherit CSP into iframe sandbox srcdoc"
           class=""
        >Attachment #8848471</a> -
        Flags: <span class="activity-deleted">review+</span></div><div class="change">
        <a href="/attachment.cgi?id=8848472&amp;action=edit"
           title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP"
           class=""
        >Attachment #8848472</a> -
        Flags: <span class="activity-deleted">review+</span></div><div class="change">
        <a href="/attachment.cgi?id=8848473&amp;action=edit"
           title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal"
           class=""
        >Attachment #8848473</a> -
        Flags: <span class="activity-deleted">review+</span></div></div></div><div class="change-set ca-428608" id="c79"><div class="comment" data-id="12158813" data-no="79"
       data-tags="mozreview-request">
    
    <table class="layout-table change-head assignee" id="ch-79" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:17 PDT" data-time="1490008652">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-request</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-79"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (mozreview-request)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-79"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-79" data-comment-id="12158813" style="display:none">Comment on <span class=""><a href="/attachment.cgi?id=8848472" name="attach_8848472" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">attachment 8848472</a> <a href="/attachment.cgi?id=8848472&amp;action=edit" title="Bug 1073952: tests for iframe sandbox srcdoc and data URIs with CSP">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: tests for iframe sandbox srcdoc and data URIs with CSP

Review request updated; see interdiff: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121394/diff/1-2/">https://reviewboard.mozilla.org/r/121394/diff/1-2/</a></pre></div><div class="change-set ca-428608" id="c80"><div class="comment" data-id="12158814" data-no="80"
       data-tags="mozreview-request">
    
    <table class="layout-table change-head assignee" id="ch-80" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a77836318_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:17 PDT" data-time="1490008652">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags"><span class="comment-tag">mozreview-request</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-80"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="freddy [5 years ago]">
            Comment hidden (mozreview-request)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-80"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-80" data-comment-id="12158814" style="display:none">Comment on <span class=""><a href="/attachment.cgi?id=8848473" name="attach_8848473" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">attachment 8848473</a> <a href="/attachment.cgi?id=8848473&amp;action=edit" title="Bug 1073952: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal">[details]</a></span>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP can be bypassed with &lt;iframe [sandbox] and [srcdoc]&gt;"
   href="/show_bug.cgi?id=1073952">Bug 1073952</a>: proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal

Review request updated; see interdiff: <a rel="nofollow" href="https://reviewboard.mozilla.org/r/121396/diff/1-2/">https://reviewboard.mozilla.org/r/121396/diff/1-2/</a></pre></div><div class="change-set" id="c81"><div class="comment" data-id="12158827" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_510726" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/4c5aee4c6938e29b1576314d2de9c6e7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_510726" id="a77836318_428608"><a class="email " href="/user_profile?user_id=510726" > <span class="fna">Pulsebot</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 04:23 PDT" data-time="1490008989">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-81" data-comment-id="12158827">Pushed by <a href="mailto:cbook&#64;mozilla.com">cbook&#64;mozilla.com</a>:
<a rel="nofollow" href="https://hg.mozilla.org/integration/autoland/rev/37d0954bf143">https://hg.mozilla.org/integration/autoland/rev/37d0954bf143</a>
inherit CSP into iframe sandbox srcdoc r=ckerschb,Tomcat
<a rel="nofollow" href="https://hg.mozilla.org/integration/autoland/rev/461141e9b3c9">https://hg.mozilla.org/integration/autoland/rev/461141e9b3c9</a>
tests for iframe sandbox srcdoc and data URIs with CSP r=ckerschb,Tomcat
<a rel="nofollow" href="https://hg.mozilla.org/integration/autoland/rev/bf127c7f5a9b">https://hg.mozilla.org/integration/autoland/rev/bf127c7f5a9b</a>
proper indentation for nsScriptSecurityManager::GetChannelResultPrincipal r=Tomcat</pre></div><div class="change-set" id="c82"><div class="comment" data-id="12162034" data-no="82"
       data-tags="bugherder">
    
    <table class="layout-table change-head " id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a77836318_428608"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a77836318_428608"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-20 17:51 PDT" data-time="1490057482">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-82" data-comment-id="12162034"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/37d0954bf143">https://hg.mozilla.org/mozilla-central/rev/37d0954bf143</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/461141e9b3c9">https://hg.mozilla.org/mozilla-central/rev/461141e9b3c9</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/bf127c7f5a9b">https://hg.mozilla.org/mozilla-central/rev/bf127c7f5a9b</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2017-03-20 17:51 PDT" data-time="1490057482">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla55</div></div></div><div class="change-set" id="a86693321_280903"><div class="change" id="aa86693321_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a86693321_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a86693321_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a86693321_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a86693321_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a86693321_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-27 15:41 PDT" data-time="1498603260">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external], [domsecurity-backlog] &rarr; [reporter-external], [domsecurity-backlog][adv-main55+]</div></div></div><div class="change-set" id="a86936609_280903"><div class="change" id="aa86936609_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a86936609_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a86936609_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a86936609_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a86936609_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a86936609_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-30 11:15 PDT" data-time="1498846548">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2017-7788</div></div></div><div class="change-set" id="a88664280_1689"><div class="change" id="aa88664280_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a88664280_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a88664280_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a88664280_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a88664280_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a88664280_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-20 11:10 PDT" data-time="1500574219">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Other CSP rules ignored when specifying sandbox 'allow-scripts'"
   href="/show_bug.cgi?id=1377426">CVE-2017-7803</a></div></div></div><div class="change-set" id="c83"><div class="comment" data-id="12492144" data-no="83"
       data-tags="bugherder uplift">
    
    <table class="layout-table change-head " id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a88664280_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a88664280_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-07-20 16:34 PDT" data-time="1500593641">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="12492144"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/06db7fb30689">https://hg.mozilla.org/releases/mozilla-esr52/rev/06db7fb30689</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/bdc731ce02c6">https://hg.mozilla.org/releases/mozilla-esr52/rev/bdc731ce02c6</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite+</div></div></div><div class="change-set" id="c84"><div class="comment" data-id="12812022" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a88664280_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a88664280_1689"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-02 07:58 PDT" data-time="1509634682">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-84" data-comment-id="12812022">Fwiw, the &quot;proper indentation&quot; changeset clearly mis-indented this code:

      if (loadInfo-&gt;GetLoadingSandboxed() &amp;&amp;
        loadInfo-&gt;GetForceInheritPrincipalDropped()) {
        forceInherit = true;
      }

in a really confusing way...</pre><div class="activity"><div class="change">Flags: needinfo?(cbook)</div></div></div><div class="change-set" id="a137454587_495955"><div class="change" id="aa137454587_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a137454587_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a137454587_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a137454587_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a137454587_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a137454587_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-05 03:02 PST" data-time="1549364526">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(cbook)</span></div></div></div><div class="change-set" id="a178459849_578488"><div class="change" id="aa178459849_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a178459849_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a178459849_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a178459849_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a178459849_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1073952#a178459849_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-24 18:23 PDT" data-time="1590369788">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty-hof+</div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1073952&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>