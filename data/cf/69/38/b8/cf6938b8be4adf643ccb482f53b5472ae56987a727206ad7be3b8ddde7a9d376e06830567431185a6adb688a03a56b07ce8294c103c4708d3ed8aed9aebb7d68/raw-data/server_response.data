<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
        <link rel='alternate' type='application/rss+xml' title='PHAR related Bug #61065 - RDF' href='rss/bug.php?id=61065'>
        <link rel='alternate' type='application/rss+xml' title='PHAR related Bug #61065 - RSS 2.0' href='rss/bug.php?id=61065&format=rss2'>
        <base href="https://bugs.php.net/">
    <title>PHP :: Sec Bug #61065 :: Secunia SA44335 - arbitrary code execution</title>
    <link rel="shortcut icon" href="https://bugs.php.net/images/favicon.ico">
    <link rel="stylesheet" href="https://bugs.php.net/css/style.css">
</head>

<body>

<table id="top" class="head" cellspacing="0" cellpadding="0">
    <tr>
        <td class="head-logo">
            <a href="/"><img src="images/logo.png" alt="Bugs" vspace="2" hspace="2"></a>
        </td>

        <td class="head-menu">
            <a href="https://php.net/">php.net</a>&nbsp;|&nbsp;
            <a href="https://php.net/support.php">support</a>&nbsp;|&nbsp;
            <a href="https://php.net/docs.php">documentation</a>&nbsp;|&nbsp;
            <a href="report.php">report a bug</a>&nbsp;|&nbsp;
            <a href="search.php">advanced search</a>&nbsp;|&nbsp;
            <a href="search-howto.php">search howto</a>&nbsp;|&nbsp;
            <a href="stats.php">statistics</a>&nbsp;|&nbsp;
            <a href="random">random bug</a>&nbsp;|&nbsp;
            <a href="login.php">login</a>
        </td>
    </tr>

    <tr>
        <td class="head-search" colspan="2">
            <form method="get" action="search.php">
                <p class="head-search">
                    <input type="hidden" name="cmd" value="display">
                    <small>go to bug id or search bugs for</small>
                    <input class="small" type="text" name="search_for" value="" size="30">
                    <input type="image" src="images/small_submit_white.gif" alt="search" style="vertical-align: middle;">
                </p>
            </form>
        </td>
    </tr>
</table>

<table class="middle" cellspacing="0" cellpadding="0">
    <tr>
        <td class="content">
<div id="bugheader">
    <table id="details">
        <tr id="title">
            <th class="details" id="number"><a href="bug.php?id=61065">Sec Bug</a>&nbsp;#61065</th>
            <td id="summary" colspan="5">Secunia SA44335 - arbitrary code execution</td>
        </tr>
        <tr id="submission">
            <th class="details">Submitted:</th>
            <td style="white-space: nowrap;">2012-02-12 21:43 UTC</td>
            <th class="details">Modified:</th>
            <td style="white-space: nowrap;">2014-06-19 16:31 UTC</td>
            <td rowspan="6">


            </td>
        </tr>

        <tr id="submitter">
            <th class="details">From:</th>
            <td>ty &#x61;&#116; sarna &#x64;&#111;&#x74; org</td>
            <th class="details">Assigned:</th>
            <td><a href="search.php?cmd=display&amp;assign=stas">stas</a> (<a href="https://people.php.net/stas">profile</a>)</td>
        </tr>

        <tr id="categorization">
            <th class="details">Status:</th>
            <td>Closed</td>
            <th class="details">Package:</th>
            <td><a href="search.php?cmd=display&amp;package_name[]=PHAR+related">PHAR related</a></td>
        </tr>

        <tr id="situation">
            <th class="details">PHP Version:</th>
            <td>5.3.10</td>
            <th class="details">OS:</th>
            <td>All</td>
        </tr>

        <tr id="private">
            <th class="details">Private report:</th>
            <td>No</td>
            <th class="details">CVE-ID:</th>
            <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2386" target="_blank">2012-2386</a></td>
        </tr>
    </table>
</div>

<div class="controls">
<span id='control_0' class='control active'>View</span>
<span id='control_3' class='control'><a href='bug.php?id=61065&amp;edit=3'>Add Comment</a></span>
<span id='control_1' class='control'><a href='bug.php?id=61065&amp;edit=1'>Developer</a></span>
<span id='control_2' class='control'><a href='bug.php?id=61065&amp;edit=2'>Edit</a></span>
</div>
<div class="clear"></div>



<div class='comment type_comment' ><a name="1329083004">&nbsp;</a><strong>[2012-02-12 21:43 UTC] ty &#x61;&#116; sarna &#x64;&#111;&#x74; org</strong>
<pre class='note'>Description:
------------
I see no evidence that php.net is aware of this issue, but it seems known 
elsewhere (NetBSD pkgsrc reports 5.3.10 as vulnerable due to this bug, and 
refuses to install without an override)


See:


<a href="http://secunia.com/advisories/44335" rel="nofollow">http://secunia.com/advisories/44335</a>
<a href="http://0x1byte.blogspot.com/2011/04/php-phar-extension-heap-overflow.html" rel="nofollow">http://0x1byte.blogspot.com/2011/04/php-phar-extension-heap-overflow.html</a>


&quot;The vulnerability is caused due to an integer overflow error within the phar 
extension in the &quot;phar_parse_tarfile()&quot; function (ext/phar/tar.c) and can be 
exploited to cause a heap-based buffer overflow via a specially crafted TAR 
file.

Successful exploitation may allow execution of arbitrary code.

The vulnerability is reported in version 5.3.6. Other versions may also be 
affected.&quot;





</pre>
</div><h2>Patches</h2>
<a href="patch-display.php?bug_id=61065&amp;patch=phar.diff&amp;revision=latest" >phar.diff</a>
(last revision 2012-05-13 02:20 UTC by rasmus@php.net)
<br><p><a href='patch-add.php?bug_id=61065'>Add a Patch</a></p><h2>Pull Requests</h2>
<p><a href='gh-pull-add.php?bug_id=61065'>Add a Pull Request</a></p><h2 style="border-bottom:2px solid #666;margin-bottom:0;padding:5px 0;">History</h2><div id='comment_filter' class='controls comments'><span id='type_all' class='control active' onclick='do_comment(this);'>All</span><span id='type_comment' class='control ' onclick='do_comment(this);'>Comments</span><span id='type_log' class='control ' onclick='do_comment(this);'>Changes</span><span id='type_svn' class='control ' onclick='do_comment(this);'>Git/SVN commits</span><span id='type_related' class='control ' onclick='do_comment(this);'>Related reports</span>            </div>
            <div id='comments_view' style='clear:both;'>
<div class='comment type_patch' ><a name="1336875629">&nbsp;</a><strong>[2012-05-13 02:20 UTC] <a href="//people.php.net/rasmus">rasmus@php.net</a></strong>
<pre class='note'>The following patch has been added/updated:

Patch Name: phar.diff
Revision:   1336875629
URL:        <a href="https://bugs.php.net/patch-display.php?bug=61065&amp;patch=phar.diff&amp;revision=1336875629" rel="nofollow">https://bugs.php.net/patch-display.php?bug=61065&amp;patch=phar.diff&amp;revision=1336875629</a>
</pre>
</div><div class='comment type_comment' ><a name="1336919078">&nbsp;</a><strong>[2012-05-13 14:24 UTC] <a href="//people.php.net/pajoye">pajoye@php.net</a></strong>
<pre class='note'>Patch looks good too and builds fine. Maybe add a comment to say that filename_len 
and uncompressed_filesize are uint32 as it may not be obvious (&lt; 0 or &gt;= checks 
instead :).
</pre>
</div><div class='comment type_comment' ><a name="1336925150">&nbsp;</a><strong>[2012-05-13 16:05 UTC] <a href="//people.php.net/pajoye">pajoye@php.net</a></strong>
<pre class='note'>We also need a CVE for that one, anyone can request one please?
</pre>
</div><div class='comment type_comment' ><a name="1337537370">&nbsp;</a><strong>[2012-05-20 18:09 UTC] <a href="//people.php.net/felipe">felipe@php.net</a></strong>
<pre class='note'>CVE id has been requested.
</pre>
</div><div class='comment type_log' ><a name="1337709085">&nbsp;</a><strong>[2012-05-22 17:51 UTC] <a href="//people.php.net/felipe">felipe@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-CVE-ID:</span>
<span class="added">+CVE-ID: 2012-2386</span>
</div></div></div><div class='comment type_comment' ><a name="1338362975">&nbsp;</a><strong>[2012-05-30 07:29 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>This bug has been fixed in SVN.

Snapshots of the sources are packaged every three hours; this change
will be in the next snapshot. You can grab the snapshot at
<a href="http://snaps.php.net/" rel="nofollow">http://snaps.php.net/</a>.

 For Windows:

<a href="http://windows.php.net/snapshots/" rel="nofollow">http://windows.php.net/snapshots/</a>
 
Thank you for the report, and for helping us make PHP better.


</pre>
</div><div class='comment type_log' ><a name="1338362975">&nbsp;</a><strong>[2012-05-30 07:29 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Status:      Open</span>
<span class="added">+Status:      Closed</span>
<span class="removed">-Assigned To:</span>
<span class="added">+Assigned To: stas</span>
</div></div></div><div class='comment type_comment' ><a name="1339710813">&nbsp;</a><strong>[2012-06-14 21:53 UTC] <a href="//people.php.net/vdanen">vdanen@php.net</a></strong>
<pre class='note'>Is there a particular reason why the CVE name wasn't mentioned in the changelog?
</pre>
</div><div class='comment type_comment' ><a name="1339717380">&nbsp;</a><strong>[2012-06-14 23:43 UTC] <a href="//people.php.net/felipe">felipe@php.net</a></strong>
<pre class='note'>I've added it to the changelog. (in some minutes it'll appears in the site)

Thanks.
</pre>
</div><div class='comment type_comment' ><a name="1341440617">&nbsp;</a><strong>[2012-07-04 22:23 UTC] <a href="//people.php.net/helly">helly@php.net</a></strong>
<pre class='note'>Why did we not simply use safe_pemalloc() here?
</pre>
</div><div class='comment type_svn' ><a name="1412724356">&nbsp;</a><strong>[2014-10-07 23:25 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src-security.git;a=commit;h=4eb802bb14b05b82573457bc0f528e61ca7ddc45" rel="nofollow">http://git.php.net/?p=php-src-security.git;a=commit;h=4eb802bb14b05b82573457bc0f528e61ca7ddc45</a>
Log: fix <a href='bug.php?id=61065'>bug #61065</a> (cherry picked from commit a10e778bfb7ce9caa1f91666ddf2705db7982d68)
</pre>
</div><div class='comment type_svn' ><a name="1412724359">&nbsp;</a><strong>[2014-10-07 23:25 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src-security.git;a=commit;h=a10e778bfb7ce9caa1f91666ddf2705db7982d68" rel="nofollow">http://git.php.net/?p=php-src-security.git;a=commit;h=a10e778bfb7ce9caa1f91666ddf2705db7982d68</a>
Log: fix <a href='bug.php?id=61065'>bug #61065</a>
</pre>
</div><div class='comment type_svn' ><a name="1412725008">&nbsp;</a><strong>[2014-10-07 23:36 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src-security.git;a=commit;h=4eb802bb14b05b82573457bc0f528e61ca7ddc45" rel="nofollow">http://git.php.net/?p=php-src-security.git;a=commit;h=4eb802bb14b05b82573457bc0f528e61ca7ddc45</a>
Log: fix <a href='bug.php?id=61065'>bug #61065</a> (cherry picked from commit a10e778bfb7ce9caa1f91666ddf2705db7982d68)
</pre>
</div><div class='comment type_svn' ><a name="1412725011">&nbsp;</a><strong>[2014-10-07 23:36 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src-security.git;a=commit;h=a10e778bfb7ce9caa1f91666ddf2705db7982d68" rel="nofollow">http://git.php.net/?p=php-src-security.git;a=commit;h=a10e778bfb7ce9caa1f91666ddf2705db7982d68</a>
Log: fix <a href='bug.php?id=61065'>bug #61065</a>
</pre>
</div></div>
        </td>
    </tr>
</table>

<script src='js/util.js'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>
<script src="js/jquery.cookie.js"></script>
<script>
function do_comment(nd)
{
    $('#comment_filter > .control.active').removeClass("active");
    $(nd).addClass("active");

    $.cookie('history_tab', nd.id, { expires: 365 });

    if (nd.id == 'type_all') {
        $('#comments_view > .comment:hidden').show('slow');
    } else {
        $('#comments_view > .comment').each(function(i) {
            if ($(this).hasClass(nd.id)) {
                $(this).show('slow');
            } else {
                $(this).hide('slow');
            }
        });
    }
    return false;
}
</script>
<table class="foot" cellspacing="0" cellpadding="0">
    <tr>
        <td class="foot-bar" colspan="2">&nbsp;</td>
    </tr>

    <tr>
        <td class="foot-copy">
            <small>
                <a href="https://php.net/"><img src="images/logo-small.gif" align="left" valign="middle" hspace="3" alt="PHP"></a>
                <a href="https://php.net/copyright.php">Copyright &copy; 2001-2021 The PHP Group</a><br>
                All rights reserved.
            </small>
        </td>
        <td class="foot-source">
            <small>Last updated: Sat Oct 30 19:03:34 2021 UTC</small>
        </td>
    </tr>
</table>
</body>
</html>
