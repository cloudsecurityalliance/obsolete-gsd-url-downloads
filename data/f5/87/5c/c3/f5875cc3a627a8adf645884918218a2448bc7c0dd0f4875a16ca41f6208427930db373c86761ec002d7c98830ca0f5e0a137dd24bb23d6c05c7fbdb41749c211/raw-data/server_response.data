diff -urp mcstrans-0.2.3.orig/src/mcstrans.c mcstrans-0.2.3/src/mcstrans.c
--- mcstrans-0.2.3.orig/src/mcstrans.c	2007-02-12 17:13:15.000000000 -0500
+++ mcstrans-0.2.3/src/mcstrans.c	2007-09-12 16:09:38.000000000 -0400
@@ -10,6 +10,8 @@
 #include <selinux/context.h>
 #include "dso.h"
 
+#define MAX_CATEGORIES 1023
+
 /* Define data structures */
 typedef struct selabel {
 	char* raw;
@@ -268,6 +270,11 @@ static char *substitute_range(const char
 			int begin = atoi(&tok[1]);
 			++r;
 			int end = atoi(&r[1]);
+			if (end < begin ||  end > MAX_CATEGORIES || end < 0 ||
+					begin > MAX_CATEGORIES || begin < 0) {
+				error = 1;
+				break;
+			}
 			for (;begin<end+1;begin++) {
 				tmp = sub;
 				if (asprintf(&sub,"%sc%d,", sub, begin) < 0) {
