<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">

      <meta name="referrer" content="origin">
<script type="text/javascript" src="page.cgi?1635509207&amp;id=bayotbase/fielddefs.js"></script>




<script type="text/javascript">var BB_CONFIG = ({"defaults":{"priority":"Unspecified","platform":"Unspecified","bugentry_fields":["summary","product","component","rh_sub_components","severity","priority","comment"],"op_sys":"Unspecified","severity":"Unspecified"},"user":{"enterable_products":[],"logged_in":false,"groups":[]}});</script><script type="text/javascript">
var classifications = '[ { "name": "Red Hat", "description": "Red Hat Products"},{ "name": "Workflows", "description": "User driven workflows"},{ "name": "JBoss", "description": "JBoss Products"},{ "name": "CentOS", "description": "CentOS Projects"},{ "name": "Fedora", "description": "Fedora Products"},{ "name": "Community", "description": "Community Projects"},{ "name": "oVirt", "description": "oVirt Virtualization Management Projects"},{ "name": "Internal", "description": "Internal Projects."},{ "name": "Other", "description": "Other Miscellaneous Products"},{ "name": "Unclassified", "description": "Not assigned to any classification"},{ "name": "Retired", "description": "Products that have reached end of life, or were never released."} ]';
var c_optgroups = JSON.parse(classifications);
</script>
    <title>833033 &ndash; (CVE-2012-3411) CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="js/yui/assets/skins/sam/autocomplete.css" rel="stylesheet" type="text/css"><link href="js/yui/assets/skins/sam/calendar.css" rel="stylesheet" type="text/css"><link href="skins/standard/global.css" rel="stylesheet" type="text/css"><link href="extensions/BayotBase/web/css/base.css" rel="stylesheet" type="text/css"><link href="extensions/BayotBase/web/jquery-ui-1.12.1.custom/jquery-ui.min.css" rel="stylesheet" type="text/css"><link href="skins/standard/bug.css" rel="stylesheet" type="text/css"><link href="extensions/Voting/web/style.css" rel="stylesheet" type="text/css"><link href="extensions/ExternalBugs/web/css/global.css" rel="stylesheet" type="text/css"><link href="extensions/FontAwesome/web/css/all.min.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/css/redhat.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/DataTables/datatables.min.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/alertify/css/alertify.min.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/alertify/css/themes/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="extensions/SelectizeJS/web/css/selectize.bootstrap3.css" rel="stylesheet" type="text/css"><link href="extensions/SelectizeJS/web/css/SelectizeJS.css" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/jquery-3.6.0.min.js"></script><script type="text/javascript" src="extensions/BayotBase/web/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/jquery.cookie.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/jquery.jsonrpc.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/Base.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/bayot.util.js"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js"></script><script type="text/javascript" src="js/yui/connection/connection-min.js"></script><script type="text/javascript" src="js/yui/json/json-min.js"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js"></script><script type="text/javascript" src="js/global.js"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 5,
                maxattachmentsize: 20000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug.",
                group_required:
                    "You must select at least one group for bugs in this product."
            }
            
              , api_token: ''
            
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "833033 – (CVE-2012-3411) CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks",
                             "show_bug.cgi?id=833033" );
        document.title = "833033 – (CVE-2012-3411) CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "833033 – (CVE-2012-3411) CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js"></script><script type="text/javascript" src="js/field.js"></script><script type="text/javascript" src="extensions/ExternalBugs/web/js/external_bugs.js"></script><script type="text/javascript" src="extensions/RedHat/web/DataTables/datatables.min.js"></script><script type="text/javascript" src="extensions/RedHat/web/alertify/alertify.min.js"></script><script type="text/javascript" src="extensions/RedHat/web/colResize/dataTables.colResize.js"></script><script type="text/javascript" src="extensions/RedHat/web/js/redhat.js"></script><script type="text/javascript" src="extensions/SelectizeJS/web/js/standalone/selectize.min.js"></script><script type="text/javascript" src="extensions/SelectizeJS/web/js/SelectizeJS.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Red Hat Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="/extensions/RedHat/web/css/favicons/production.ico?v=0">
  </head>

  <body 
        class="bugzilla-redhat-com status_colours_pastel
                 bz_bug
                 bz_status_CLOSED
                 bz_product_Security_Response
                 bz_component_vulnerability
                 bz_bug_833033 yui-skin-sam">

  <div id="header"><div id="banner">
   <ul id="loginin_launcher"><a href="#" onclick="$('#loginin_launcher').addClass('bz_default_hidden');$('#login_container').removeClass('bz_default_hidden');"><i class="fa fa-user" aria-hidden="true"></i>&nbsp;&nbsp;Login</a></ul>
   <ul id="login_container" class="bz_default_hidden">
    <a href="#" id="hide_mini_login" onclick="$('#login_container').addClass('bz_default_hidden');$('#loginin_launcher').removeClass('bz_default_hidden');">[x]</a>
     
    <li id="mini_login_container"><div id="saml2_container">
    Log in using an account from:
  <div id="saml2auth_login_Fedora Account System">
    <a href="saml2_login.cgi?idp=Fedora%20Account%20System&amp;target=show_bug.cgi%3Fid%3D833033"><i class="fa fa-cogs" aria-hidden="true"></i>&nbsp;&nbsp;Fedora Account System</a>
  </div>
  <div id="saml2auth_login_Red Hat Associate">
    <a href="saml2_login.cgi?idp=Red%20Hat%20Associate&amp;target=show_bug.cgi%3Fid%3D833033"><i class="fa fa-user-secret" aria-hidden="true"></i>&nbsp;&nbsp;Red Hat Associate</a>
  </div>
  <div id="saml2auth_login_Red Hat Customer">
    <a href="saml2_login.cgi?idp=Red%20Hat%20Customer&amp;target=show_bug.cgi%3Fid%3D833033"><i class="fa fa-user" aria-hidden="true"></i>&nbsp;&nbsp;Red Hat Customer</a>
  </div>
  Or login using a Red Hat Bugzilla account
  <div>

  <form action="show_bug.cgi?id=833033" method="POST"
        class="mini_login "
        id="mini_login">
    <input id="Bugzilla_login" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
  </form>
</li>
<li id="forgot_container">
  <a id="forgot_link" href="#forgot"
     onclick="return show_forgot_form('')"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>&nbsp;&nbsp;Forgot&nbsp;Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input name="loginname" size="20" id="login" required
        type="email" placeholder="Your Email Address">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token"
           value="1635628461-dpmAhO8S1s8pSOOJRvfF7Ulj_5d_VClwaW6vO6b9Br8">
    <p>
    <a href="#" onclick="return hide_forgot_form('')"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>&nbsp;&nbsp;Hide Forgot</a>
  </form>
</li>
<li>
  <a href="createaccount.cgi"><span><i class="fas fa-plus" aria-hidden="true"></i>&nbsp;&nbsp;Create an Account</span></a>
</li>
    
   </ul>
  </div>

    <div id="titles">
      <span id="title">Red Hat Bugzilla &ndash; Bug&nbsp;833033</span>


    </div>


    <div id="common_links"><ul class="links">
  <li class="form">
    
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>
  <li><a href="./" title="Home"><i class="fas fa-home"></i></a></li>
  <li><a href="enter_bug.cgi">New</a></li>
  <li class="submenu">
    <a href="#" title="Search"><i class="fas fa-search"></i> <span class="fa fa-caret-down"></span></a>
    <div>
      <ul>
        <li><a href="query.cgi?format=specific">Simple Search</a></li>
        <li><a href="query.cgi?format=advanced">Advanced Search</a></li>
      </ul>
    </div>
  </li>
  <li class="submenu">
   <a href="#">My Links <span class="fa fa-caret-down"></span></a>
   <div>
    <ul>
      <li><a href="describecomponents.cgi">Browse</a></li>
      <li>
            <a href="request.cgi">Requests</a></li>
      <li class="submenu">
        <a  href="report.cgi">Reports <span class="fa fa-caret-right"></span></a>
        <div>
          <ul>
            </li>
            <li class="submenu">
              <a  href="#">Current State <span class="fa fa-caret-right"></span></a>
              <div>
                <ul>
                  <li id="report_search">
                    <a href="query.cgi">Search</a>
                  </li>
                  <li id="report_tabular">
                      <a href="query.cgi?format=report-table">Tabular reports</a>
                  </li>
                    <li id="report_graphical">
                        <a href="query.cgi?format=report-graph">Graphical reports</a>
                    </li>
                  <li id="report_duplicates">
                    <a href="duplicates.cgi">Duplicates</a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="submenu">
              <a  href="#">Other Reports <span class="fa fa-caret-right"></span></a>
              <div>
                <ul>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=user_activity.html">User Changes</a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="submenu">
              <a  href="#">Plotly Reports <span class="fa fa-caret-right"></span></a>
              <div>
                <ul>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=bug_status.html">Bug Status</a>
                  </li>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=bug_severity.html">Bug Severity</a>
                  </li>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=non_defaults.html">Non-Defaults</a>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </li><li><span class="separator"> | </span><a href="page.cgi?id=productdashboard.html">Product Dashboard</a></li>
    </ul>
   </div>
  </li>

  <li class="submenu">
   <a href="#">Help <span class="fa fa-caret-down"></span></a>
   <div>
    <ul><li><a href="docs/en/html/using/understanding.html" >Page Help!</a></li>
      <li><a href="page.cgi?id=bug-writing.html">Bug Writing Guidelines</a></li> 
      <li><a href="page.cgi?id=whats-new.html">What's new</a></li>
      <li><a href="https://access.redhat.com/help/browsers">Browser Support Policy</a></li>
      <li><a href="page.cgi?id=release-notes.html">5.0.4.rh64 Release notes</a></li>
      <li><a href="page.cgi?id=faq.html">FAQ</a></li>
      <li><a href="docs/en/html/index.html">Guides index</a></li>
      <li><a href="docs/en/html/using/index.html">User guide</a></li>
      <li><a href="docs/en/html/integrating/api/Bugzilla/WebService/Bug.html">Web Services</a></li>
      <li><a href="page.cgi?id=redhat/contact.html" >Contact</a></li> 
      <li><a href="page.cgi?id=terms-conditions.html" >Legal</a></li> 
    </ul>
   </div>
  </li>



</ul>
    </div>
  </div>


  <div id="bugzilla-body">



<noscript>
      <div id="no-js-message">This site requires JavaScript to be enabled to function correctly, please enable it.</div>
</noscript>

<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=833033" title="Format For Printing"><i class="fa fa-print"></i></a></li>
    <li><a href="show_bug.cgi?ctype=xml&amp;id=833033" title="Export as XML"><i class="far fa-file-excel"></i></a></li>
    <li><a href="enter_bug.cgi?cloned_bug_id=833033" title="Clone This Bug"><i class="fa fa-clone"></i></a></li>
    <li>
      <a href="enter_bug.cgi?cloned_bug_id=833033&lite=1" title="Copy is a lite weight clone that only copies the summary &amp; description">
       <i class="far fa-clone"></i>
      </a>
    </li>


          
    <li>
      <a href="#c69" title="Last Comment">
         <i class="fas fa-arrow-down" aria-hidden="true"></i>
      </a>
    </li><li>
  <a href="buglist.cgi?bug_id=833033&amp;bug_id_type=anddependson&amp;format=tvp" title="TreeView+">
    <i class="fa fa-tree"></i>
  </a>
</li>
    </ul>
<script type="text/javascript">
<!--

//-->
</script>




<form name="changeform" id="changeform" method="post" action="process_bug.cgi">





  <input type="hidden" name="delta_ts" value="2021-02-23 14:31:02">
  <input type="hidden" name="id" value="833033">
  <input type="hidden" name="token" value="1635628461-vmcPnc9rGMyQKKPKYZPpciW5jL52musuH98tfQwuyzM">
<div class="bz_short_desc_container edit_form">
    
    

     <a href="show_bug.cgi?id=833033"><b>Bug&nbsp;833033</b></a> <span id="summary_container" class="bz_default_hidden">
        (<span id="alias_nonedit_display">CVE-2012-3411</span>)
      - <span id="short_desc_nonedit_display"><a href="https://access.redhat.com/security/cve/CVE-2012-3411">CVE-2012-3411</a> libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks</span>
     </span>

    
    

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

  
  
</span><span title="CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks">CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-...
        </span>
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
      <th class="field_label">
        <a href="describekeywords.cgi">Keywords</a>:
      </th>
      <td>
        <div class="keywords_select">
          <select id="keywords" name="keywords"  disabled="disabled" multiple="multiple">
              <option value="Security"
                      title="Bugs with the &quot;Security&quot; keyword are those that relate to a security vulnerability with a Red Hat product or service. For further information on how to report a security vulnerability to Red Hat please see the &quot;Security Contacts and Procedures&quot; page at http://www.redhat.com/security/team/contact/"
                      selected="selected"
              >Security
              </option>
          </select>
        </div>
      </td>
    </tr>

  <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CLOSED
          ERRATA
      </span>
    </td>
  </tr>

<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

  
  
</th>
    <td>CVE-2012-3411
    </td>
  </tr>

<tr>

<th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_product" >Security Response

</td>


    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_classification" >Other

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Security Response"
  >Component:</a>

  
  
</th>
      <td>
        

            <input type="hidden" id="component" name="component" value="vulnerability">vulnerability
        
        
        <span class="show_others">
          <a href="buglist.cgi?component=vulnerability&amp;product=Security%20Response"
            title="Show other bugs for this component"><i class="fas fa-th-list"></i></a>
        
        
          <a href="enter_bug.cgi?component=vulnerability&amp;product=Security%20Response&amp;version=unspecified"
            title="Create a new bug for this component"><i class="fas fa-plus-circle"></i></a>
        
        </span>
      </td>
    </tr>
    <tr>
        <th id="bz_rh_sub_component_input_th"
            class="field_label bz_default_hidden">
          <label for="rh_sub_component">
            <a class="field_help_link" href="page.cgi?id=fields.html#rh_sub_components" title="The sub component of a specific component">Sub Component:</a>
          </label>
        </th>
        <td id="bz_rh_sub_component_input_td" class="bz_default_hidden">
          <input type="hidden" name="defined_rh_sub_component" id="defined_rh_sub_component" value="0">
          <select name="rh_sub_component" id="rh_sub_component"  disabled="disabled" onchange="assign_to_default();" >
            <option value="">---</option>
          </select>
          <script>
            $(document).ready(function () {
              init_sub_components();
            });
          </script>
        
          <span class="show_others">
            <a href="buglist.cgi?component=vulnerability&amp;product=Security%20Response" title="Show other bugs for this sub-component"><i class="fas fa-th-list"></i></a>
          
          </span>
        </td>
      </tr>

<script>
  function rh_check_sub_components () {
    var ret = '';
      var sub_comp_obj = document.getElementById('rh_sub_component');
        if ($('#defined_rh_sub_component').val() == 1 && !$("#rh_sub_component").selectize()[0].selectize.getValue()) {
          if (!ret) ret = sub_comp_obj;
          _sub_comps_errorFor(
            sub_comp_obj,
            "You must specify the sub component"
          );
      }

    return ret;
  }

  function _sub_comps_errorFor(field, error_text) {
      var new_node = document.createElement('div');
      YAHOO.util.Dom.addClass(new_node, 'validation_error_text');
      new_node.innerHTML = error_text;
      YAHOO.util.Dom.insertAfter(new_node, field);
      YAHOO.util.Dom.addClass(field, 'validation_error_field');
      new_node.scrollIntoView();
  }
</script>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

  
  
</th>
<td>
      <span id="version">unspecified
      </span></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

  
  
</th>
      <td class="field_value">Unspecified
      </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_op_sys">


  <a 
      title="The operating system the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#op_sys"
  >OS:</a>

  
  
</th>
      <td class="field_value">
        Unspecified
      </td>
    </tr>
          
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#priority">Priority:</a></label>
      </th>
      <td>medium
      </td>
    </tr>
    <tr>
      <th class="field_label">
        <label ><a href="page.cgi?id=fields.html#bug_severity">Severity:</a>
        </label>
      </th>
      <td>
       medium
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

  
  
</th><td>
      <span id="target_milestone">---
      </span></td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

  
  
</th>
      <td><span class="vcard redhat_user"><span class="fn">Red Hat Product Security</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

  
  
</th>
      <td><span class="vcard ">
</span>
      </td>
    </tr>
    
    <tr><th class="field_label "
    id="field_label_docs_contact">

    <label for="docs_contact" accesskey="q">

  <a 
      title="The person responsible for documenting once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#docs_contact"
  >Docs Contact:</a>
</label>
  
  
</th>
      <td><span class="vcard ">
</span>
      </td>
    </tr>
    
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'security-response-team\x40redhat.com',
        '',
        '');
    </script>
          
          
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

  
  
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

  
  
</th><td>  
  </td>
    </tr>
          

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends On:</a>

  
  
</th>

  <td>
    <span id="dependson_input_area">
    </span>
<a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - CVE-2012-3411 dnsmasq: When run under libvirt open DNS proxy (reachable also out of the virtual network set for the guest domain) is created [fedora-all]"
   href="show_bug.cgi?id=838528">838528</a> <a class="bz_bug_link
          bz_secure
    "
   title=""
   href="show_bug.cgi?id=882251">882251</a> 
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

  
  
</th>

  <td>
    <span id="blocked_input_area">
    </span>
<a class="bz_bug_link
          bz_secure
    "
   title=""
   href="show_bug.cgi?id=838539">838539</a> 
  </td>
  </tr>

          <tr>
    <th class="field_label">TreeView+</th>
    <td>
        <a href="buglist.cgi?bug_id=833033&amp;bug_id_type=anddependson&amp;format=tvp">
        depends on</a> /
        <a href="buglist.cgi?bug_id=833033&amp;bug_id_type=andblocked&amp;format=tvp&amp;tvp_dir=blocked">
        blocked</a>
    </td>
    <td></td>
</tr>
          
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#reporter">Reported:</a>
    </th>
    <td>2012-06-18 12:31 UTC by <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#modified">Modified:</a>
    </th>
    <td>2021-02-23 14:31 UTC
      (<a href="show_activity.cgi?id=833033">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          <a href="page.cgi?id=fields.html#cclist">CC List:</a>
        </label>
      </th>
      <td>21 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="aquini">aquini</option>
                <option value="awilliam">awilliam</option>
                <option value="berrange">berrange</option>
                <option value="crobinso">crobinso</option>
                <option value="dougsland">dougsland</option>
                <option value="eblake">eblake</option>
                <option value="itamar">itamar</option>
                <option value="jlieskov">jlieskov</option>
                <option value="jreznik">jreznik</option>
                <option value="jscotka">jscotka</option>
                <option value="laine">laine</option>
                <option value="libvirt-maint">libvirt-maint</option>
                <option value="maurizio.antillon">maurizio.antillon</option>
                <option value="pwouters">pwouters</option>
                <option value="robatino">robatino</option>
                <option value="security-response-team">security-response-team</option>
                <option value="simon">simon</option>
                <option value="sokann">sokann</option>
                <option value="tflink">tflink</option>
                <option value="thozza">thozza</option>
                <option value="veillard">veillard</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>


 
<tr>
      <th class="field_label "
    id="field_label_cf_fixed_in">


  <a 
      title="The full package version. PGM uses to check if brew ..."
  >Fixed In Version:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_fixed_in"  colspan="2">

</td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_doc_type">


  <a 
      title="Click the information icon to the right to see the description"
  >Doc Type:</a>

  
  <i class="fas fa-info-circle pop-text" onclick="alertify.alert('Doc Type', BB_FIELDS['cf_doc_type'].long_desc)" title="Click to see full description"></i>

  
</th>
  <td class="field_value "
      id="field_container_cf_doc_type"  colspan="2">Bug Fix

<span id="cf_doc_warn"></span></td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_release_notes">


  <a 
      title="Click the information icon to the right to see the description"
  >Doc Text:</a>

  
  <i class="fas fa-info-circle pop-text" onclick="alertify.alert('Doc Text', BB_FIELDS['cf_release_notes'].long_desc)" title="Click to see full description"></i>

  
</th>
  <td class="field_value "
      id="field_container_cf_release_notes"  colspan="2">
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    
    

    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_clone_of">


  <a 
      title="The bug listed here was the bug cloned to create thi..."
  >Clone Of:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_clone_of"  colspan="2">

</td>
  </tr>
  <tr>
    <th class="field_label">
      <label for="clones">Clones</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="clones"><a class="bz_bug_link
          
          bz_status_ASSIGNED 
                              
    "
   title="ASSIGNED - CVE-2012-3411 libvirt needs to use new dnsmasq option to avoid open DNS proxy"
   href="show_bug.cgi?id=874702">874702</a> 
      </span>
      (<a href="buglist.cgi?bug_id=874702">view as bug list</a>)</td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_environment">


  <a 
      title="This field is used for unformatted text that helps t..."
  >Environment:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_environment"  colspan="2">
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_last_closed">


  <a 
      title="When this bug was last marked as closed. Used for st..."
  >Last Closed:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_last_closed"  colspan="2">2015-02-26 22:57:49 UTC
    

</td>
    </tr>




        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    
    <th align="left">
      Attachments
    </th>
    <th colspan="2" align="right">
      <a href="page.cgi?id=terms-conditions.html">(Terms of Use)</a>
    </th>
    
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=592634"
               title="View the content of the attachment">
          <b>Use SO_BINDTODEVICE in make_sock()</b></a>

          <span class="bz_attach_extra_info">
              (3.04 KB,
                patch)

            <br>
            <a href="#attach_592634"
               title="Go to the comment associated with the attachment">2012-06-18 12:59 UTC</a>,

            <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=592634&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=592634&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=640706"
               title="View the content of the attachment">
          <b>Commit from upstream git (tag v2.63test1) for reference</b></a>

          <span class="bz_attach_extra_info">
              (14.90 KB,
                patch)

            <br>
            <a href="#attach_640706"
               title="Go to the comment associated with the attachment">2012-11-08 10:05 UTC</a>,

            <span class="vcard redhat_user"><span class="fn">Tomáš Hozza</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=640706&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=640706&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=833033&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=833033&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

    

    <script>
  YAHOO.ExternalBugs.sUrlYUI = 'https://bugzilla.redhat.com/jsonrpc.cgi';
  YAHOO.ExternalBugs.sUrlRPC = 'https://bugzilla.redhat.com/xmlrpc.cgi';
  YAHOO.ExternalBugs.extRefreshList = [];
function _extbz_errorFor(field, error_text) {
    var new_node = document.createElement('div');
    YAHOO.util.Dom.addClass(new_node, 'validation_error_text');
    new_node.innerHTML = error_text;
    YAHOO.util.Dom.insertAfter(new_node, field);
    YAHOO.util.Dom.addClass(field, 'validation_error_field');
    return new_node;
}

function check_external_bugs (f) {
    var focus_me;
    var external_bugs = YAHOO.util.Dom.getElementsByClassName(
        'external_bug_id', null, f);
    for (var i = 0; i < external_bugs.length; i++) {
        var bug_id_key   = external_bugs[i].name;
        var bug_type_key = 'external_' + bug_id_key.substr(13);
        if($('#' + bug_id_key).length > 0) {
            var bug_id       = document.getElementById(bug_id_key).value;
            var bug_type     = document.getElementById(bug_type_key).value;
            if ((bug_type == '' || bug_type == '0') && bug_id != '') {
                focus_me = _extbz_errorFor(
                    document.getElementById(bug_type_key),
                    'You specified the external tracker id, but not the type'
                );
            }
            else if (bug_type != '' && bug_type != '0' && bug_id == '') {
                focus_me = _extbz_errorFor(
                    external_bugs[i],
                    'You specified the external tracker type, but not the id'
                );
            }
            else if (bug_type != '' && bug_id != '') {
            }
        }
    }

    return focus_me;
}

var bz_no_validate_enter_bug = false;
function validateChangeBug(changeform) {
    // This is for the "bookmarkable templates" button.
    if (bz_no_validate_enter_bug) {
        // Set it back to false for people who hit the "back" button
        bz_no_validate_enter_bug = false;
        return true;
    }

    var current_errors = YAHOO.util.Dom.getElementsByClassName(
        'validation_error_text', null, changeform);
    for (var i = 0; i < current_errors.length; i++) {
        current_errors[i].parentNode.removeChild(current_errors[i]);
    }
    var current_error_fields = YAHOO.util.Dom.getElementsByClassName(
        'validation_error_field', null, changeform);
    for (var i = 0; i < current_error_fields.length; i++) {
        var field = current_error_fields[i];
        YAHOO.util.Dom.removeClass(field, 'validation_error_field');
    }

    var focus_me;

    // REDHAT EXTENSION 1000743
    focus_me = check_external_bugs(changeform);

    if (focus_me) {
        focus_me.scrollIntoView(false);
        return false;
    }

    return true;
}

changeform.onsubmit = function() { return validateChangeBug(changeform)};
</script>

<br>
<table id="external_bugs_table" cellspacing="0" cellpadding="4">
  <caption name="et0" id="et0">Links</caption>
    <tr>
      <th>System</th>
      <th>ID</th>
      <th>Private</th>
      <th>Priority</th>
      <th>Status</th>
      <th>Summary</th>
      <th>Last Updated</th>
    </tr>

    
    <tr id="ext_row_699625" >
      <td>Red Hat Product Errata
      </td>
      <td>
        <a href="https://access.redhat.com/errata/RHSA-2013:0277">RHSA-2013:0277</a>
      </td>
      <td>
        <span id="ext_is_private_699625">0
        </span>
      </td>
      <td>
        <span id="ext_priority_699625">normal
        </span>
      </td>
      <td>
        <span id="ext_status_699625">SHIPPED_LIVE
        </span>
      </td>
      <td>
        <span id="ext_description_699625"
              title="Moderate: dnsmasq security, bug fix and enhancement update">Moderate: dnsmasq security, bug fix and enhancement update
        </span>
      </td>
      <td>
        <span id="ext_last_updated_699625">2013-02-20 21:28:47 UTC
        </span>
      </td>
    </tr>
    
    <tr id="ext_row_701451" >
      <td>Red Hat Product Errata
      </td>
      <td>
        <a href="https://access.redhat.com/errata/RHSA-2013:0579">RHSA-2013:0579</a>
      </td>
      <td>
        <span id="ext_is_private_701451">0
        </span>
      </td>
      <td>
        <span id="ext_priority_701451">normal
        </span>
      </td>
      <td>
        <span id="ext_status_701451">SHIPPED_LIVE
        </span>
      </td>
      <td>
        <span id="ext_description_701451"
              title="Important: rhev-hypervisor6 security, bug fix, and enhancement update">Important: rhev-hypervisor6 security, bug fix, and enhancement update
        </span>
      </td>
      <td>
        <span id="ext_last_updated_701451">2013-02-28 23:55:03 UTC
        </span>
      </td>
    </tr>

</table>

<br>
    

  </td>

  <td class="groups">
  </td>
  </tr></table>

  
  <div id="comments"><script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>






<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment
            "
    >

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 12:31:40 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I just found my home ADSL line under &quot;attack&quot; with a constant stream of spoofed DNS queries which produce large results, such as 'ANY' requests for 'ripe.net'.

I was surprised to find that my machine was actually *responding* to these queries.

I have libvirt configured to give a range of public IP addresses to its guests. The target of the attack was the host's IP address on that subnet, 81.187.2.161.

It seems that your dnsmasq instance is listening on that address, but *not* correctly discarding packets which come from a different interface. Even though the --bind-interface option is set.
This is the command line:

/sbin/dnsmasq --strict-order --bind-interfaces --pid-file=/var/run/libvirt/network/net3.pid --conf-file= --except-interface lo --listen-address 81.187.2.161 --dhcp-range 81.187.2.168,81.187.2.174 --dhcp-leasefile=/var/lib/libvirt/dnsmasq/net3.leases --dhcp-lease-max=7 --dhcp-no-override


I tried using '--interface virbr1' instead of '--except-interface lo', but it still seemed to answer external queries:

/sbin/dnsmasq --strict-order --bind-interfaces --pid-file=/var/run/libvirt/network/net3.pid --conf-file= --interface virbr1 --listen-address 81.187.2.161 --dhcp-range 81.187.2.168,81.187.2.174 --dhcp-leasefile=/var/lib/libvirt/dnsmasq/net3.leases --dhcp-lease-max=7 --dhcp-no-override

</pre>
    </div>

    <div id="c1" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Daniel Berrangé</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 12:50:21 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Can you provide a bit more information about your host/libvirt setup, so I can make sure I understand your scenario correctly:

 - The output of 'virsh net-dumpxml YOUR-GUEST-NET'
 - The output of 'brctl show'
 - The output of 'iptables -L -n -v'
 - The output of 'ip addr show'
 - The output of 'ip route show'

</pre>
    </div>

    <div id="c2" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Daniel Berrangé</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 12:51:48 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Making the BZ private to the reporter + Red Hat eng to avoid publicising reporter's network info

</pre>
    </div>

    <div id="c3" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Daniel Berrangé</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 12:57:34 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">We presume that the host has a firewall configured with a REJECT policy on the INPUT chain by default (eg the standard Fedora/RHEL iptables config, or an equivalent home-grown setup). We then allow access to port 53 for traffic originating on the bridge device associated with the libvirt network, eg 'virbr0' in this case:

Chain INPUT (policy REJECT 50 packets, 32325 bytes)
 pkts bytes target     prot opt in     out     source               destination         
  [snip]
    0     0 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:53
    0     0 ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            tcp dpt:53

since the physical ethernet device is not enslaved in this bridge, it ought not to be possible for traffic originating on the public ethernet device to reach the dnsmasq server.

</pre>
    </div>

    <div id="c4" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 12:59:10 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=592634&amp;action=diff" name="attach_592634" title="Use SO_BINDTODEVICE in make_sock()">attachment 592634</a> <a href="attachment.cgi?id=592634&amp;action=edit" title="Use SO_BINDTODEVICE in make_sock()">[details]</a></span>
Use SO_BINDTODEVICE in make_sock()

Turns out it wasn't the command line at fault; it's dnsmasq itself. This patch &quot;fixes&quot; it, although upon going to clean it up to make it more acceptable for upstream inclusion, I noticed there was *already* some attempt at using SO_BINDTODEVICE which apparently wasn't working.

</pre>
    </div>

    <div id="c5" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 13:04:43 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">No need to by coy about my IP addresses. The IP address on which your software was running an open DNS relay (☺) has already been discovered by the bad guys, and was being used as part of a DDoS attack. I've had the ISP block it at their end, for now.

The setup is really simple. I had a range of IP addresses which were unused, so I configured my local router to route them to my laptop (81.187.2.160/28 via 90.155.92.197 dev eth0, on the router). On the laptop, I then configured virbr1 to use those IP addresses:

# virsh net-dumpxml net3
&lt;network&gt;
  &lt;name&gt;net3&lt;/name&gt;
  &lt;uuid&gt;04a0a385-118d-d629-ead2-1c8d60ca9b99&lt;/uuid&gt;
  &lt;forward dev='wlan0' mode='route'&gt;
    &lt;interface dev='wlan0'/&gt;
  &lt;/forward&gt;
  &lt;bridge name='virbr1' stp='on' delay='0' /&gt;
  &lt;mac address='52:54:00:18:BE:1A'/&gt;
  &lt;ip address='81.187.2.161' netmask='255.255.255.240'&gt;
    &lt;dhcp&gt;
      &lt;range start='81.187.2.168' end='81.187.2.174' /&gt;
    &lt;/dhcp&gt;
  &lt;/ip&gt;
&lt;/network&gt;

# ip route
default via 90.155.92.214 dev wlan0  proto static 
81.187.2.160/28 dev virbr1  proto kernel  scope link  src 81.187.2.161 
90.155.92.192/26 dev wlan0  proto kernel  scope link  src 90.155.92.197 
192.168.100.0/24 dev virbr2  proto kernel  scope link  src 192.168.100.1 
192.168.122.0/24 dev virbr0  proto kernel  scope link  src 192.168.122.1 

# brctl show
bridge name	bridge id		STP enabled	interfaces
virbr0		8000.525400574759	yes		virbr0-nic
virbr1		8000.52540018be1a	yes		virbr1-nic
							vnet0
virbr2		8000.525400d0faf4	yes		virbr2-nic

# ip addr 
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether c8:2a:14:42:60:a8 brd ff:ff:ff:ff:ff:ff
3: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1001
    link/ether e4:ce:8f:1f:f2:c0 brd ff:ff:ff:ff:ff:ff
    inet 90.155.92.197/26 brd 90.155.92.255 scope global wlan0
    inet6 2001:8b0:10b:1:e6ce:8fff:fe1f:f2c0/64 scope global dynamic 
       valid_lft 294sec preferred_lft 114sec
    inet6 fe80::e6ce:8fff:fe1f:f2c0/64 scope link 
       valid_lft forever preferred_lft forever
4: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN 
    link/ether 52:54:00:57:47:59 brd ff:ff:ff:ff:ff:ff
    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0
5: virbr0-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop master virbr0 state DOWN qlen 500
    link/ether 52:54:00:57:47:59 brd ff:ff:ff:ff:ff:ff
6: virbr1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP 
    link/ether 52:54:00:18:be:1a brd ff:ff:ff:ff:ff:ff
    inet 81.187.2.161/28 brd 81.187.2.175 scope global virbr1
7: virbr1-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop master virbr1 state DOWN qlen 500
    link/ether 52:54:00:18:be:1a brd ff:ff:ff:ff:ff:ff
8: virbr2: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN 
    link/ether 52:54:00:d0:fa:f4 brd ff:ff:ff:ff:ff:ff
    inet 192.168.100.1/24 brd 192.168.100.255 scope global virbr2
9: virbr2-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop master virbr2 state DOWN qlen 500
    link/ether 52:54:00:d0:fa:f4 brd ff:ff:ff:ff:ff:ff
47: vnet0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master virbr1 state UNKNOWN qlen 500
    link/ether fe:54:00:6c:8d:51 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::fc54:ff:fe6c:8d51/64 scope link 
       valid_lft forever preferred_lft forever

</pre>
    </div>

    <div id="c6" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Daniel Berrangé</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 13:15:41 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Ah to the traffic to dnsmasq was arriving via wlan0 (90.155.92.197/26) and FORWARDED to virbr1 (81.187.2.161/28) so IIUC, it /would/ match the iptables rules we provided for port 53.

I wonder if we should add in an extra iptables rule to block traffic on port 53, with a physdev match against the NIC listed in  &lt;forward dev='wlan0' mode='route'&gt;. This ought to ensure only traffic coming from VMs can access the DNS server.

</pre>
    </div>

    <div id="c7" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 13:25:24 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c3">comment #3</a>)
<span class="quote">&gt; We presume that the host has a firewall configured with a REJECT policy on
&gt; the INPUT chain by default (eg the standard Fedora/RHEL iptables config, or
&gt; an equivalent home-grown setup)</span >

The assumption is not valid in the general case. The REJECT policy was not appropriate here, and was changed. 

The REJECT policy is just the *default* for Fedora; it's not *mandatory*, so we really mustn't ship packages which depend on it.

A firewall is a band-aid for broken software. In an ideal world, you should never need it; the software *itself* should behave correctly (as dnsmasq does after my patch). The firewall is an *extra* line of defence.

If you start to *depend* on the firewall, and use it as an excuse for not designing things to be secure in themselves, then the benefit effect is lost.

You no longer *have* a second line of defence; you're back down to *one* line of defence. And now it's not even closely tied to your software — it's outside your control and much harder to be sure of.

We block stuff with a firewall in *addition* to making it secure. Not *instead*.

</pre>
    </div>

    <div id="c8" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 13:26:16 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">$ sudo iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     udp  --  anywhere             anywhere             udp dpt:domain
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain
ACCEPT     udp  --  anywhere             anywhere             udp dpt:bootps
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:bootps
ACCEPT     udp  --  anywhere             anywhere             udp dpt:domain
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain
ACCEPT     udp  --  anywhere             anywhere             udp dpt:bootps
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:bootps
ACCEPT     udp  --  anywhere             anywhere             udp dpt:domain
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain
ACCEPT     udp  --  anywhere             anywhere             udp dpt:bootps
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:bootps

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  --  anywhere             192.168.100.0/24     state RELATED,ESTABLISHED
ACCEPT     all  --  192.168.100.0/24     anywhere            
ACCEPT     all  --  anywhere             anywhere            
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable
ACCEPT     all  --  anywhere             81.187.2.160/28     
ACCEPT     all  --  81.187.2.160/28      anywhere            
ACCEPT     all  --  anywhere             anywhere            
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable
ACCEPT     all  --  anywhere             192.168.122.0/24     state RELATED,ESTABLISHED
ACCEPT     all  --  192.168.122.0/24     anywhere            
ACCEPT     all  --  anywhere             anywhere            
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable
REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination

</pre>
    </div>

    <div id="c9" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Daniel Berrangé</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 13:35:42 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c7">comment #7</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=833033#c3">comment #3</a>)
&gt; &gt; We presume that the host has a firewall configured with a REJECT policy on
&gt; &gt; the INPUT chain by default (eg the standard Fedora/RHEL iptables config, or
&gt; &gt; an equivalent home-grown setup)
&gt; 
&gt; The assumption is not valid in the general case. The REJECT policy was not
&gt; appropriate here, and was changed. 
&gt; 
&gt; The REJECT policy is just the *default* for Fedora; it's not *mandatory*, so
&gt; we really mustn't ship packages which depend on it.
&gt; 
&gt; A firewall is a band-aid for broken software. In an ideal world, you should
&gt; never need it; the software *itself* should behave correctly (as dnsmasq
&gt; does after my patch). The firewall is an *extra* line of defence.
&gt; 
&gt; If you start to *depend* on the firewall, and use it as an excuse for not
&gt; designing things to be secure in themselves, then the benefit effect is lost.
&gt; 
&gt; You no longer *have* a second line of defence; you're back down to *one*
&gt; line of defence. And now it's not even closely tied to your software — it's
&gt; outside your control and much harder to be sure of.
&gt; 
&gt; We block stuff with a firewall in *addition* to making it secure. Not
&gt; *instead*.</span >

I didn't mean to imply that a firewall should be the only line of defense. I completely agree that dnsmasq should have not allowed this in the first place.

What I meant wrt firewall policy is that when libvirt adds rules to the firewall to open up access to certain traffic, the goal is that libvirt additions should not open the firewall up to unintended traffic. /If/ your firewall had been using a default REJECT policy, then our goals would not have been met, since we mistakenly are allowing DNS queries from the public net which was not our intent when adding the rules, loosing our first layer of defence. Given that your policy was ACCEPT in this case, the libvirt rules weren't allowing anything extra that wasn't already allowed, and clearly dnsmasq should have defended itself in this case.

</pre>
    </div>

    <div id="c10" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 13:56:45 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Yes, that makes perfect sense then.

Reassigning to dnsmasq....

</pre>
    </div>

    <div id="c11" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Simon Kelley</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 16:47:26 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Incoming packets are possibly being filtered on two different things here: destination address and arrival interface.

Running dnsmasq with --listen-address=81.187.2.161 means it will respond to packets sent to 81.187.2.161; which interface they arrived on makes no difference.

dnsmasq --bind-interfaces --interface=&lt;vibr&gt; uses just the classic BSD sockets API in the traditional way for a UDP server. --interface=&lt;vibr&gt; is completely equivalent to --listen-address=&lt;address(es) of vibr&gt; It doesn't say anything about the arrival interface of the packet, only the address to which it was sent. Hence the problem in this case when vibr has a routed, public IP address.

Interestingly _without_ --bind-interfaces, --interface _does_ filter on the arrival interface of the packet. Dnsmasq listens on the wildcard address and receives all packets,  it then queries both the destination address and arrival interface, and filters accordingly.  Doing this requires non-portable sockets API extensions, which is partly why --bind-interfaces exists: dnsmasq falls back to that mode when the relevant facilities don't exist on the platform.

David's patch makes dnsmasq with --bind-interfaces work in the same way as dnsmasq without --bind-interfaces, but only on Linux since it uses more non-portable API. There's a nasty choice between the current arrangement where the semantics of --interface varies depending on the presence or absence of --bind-interfaces, and taking David's patch which makes the semantics of --interface independent of --bind-interfaces on Linux, but makes the behaviour of dnsmasq vary over platforms. The incompatible change in behaviour from a decade of previous dnsmasq releases is an issue too.

In any case, it's likely that libvirt will have to use -interface and not --listen-address if it is desired to change the outcome in this situation.

As an aside, the name &quot;bind-interfaces&quot; is perhaps unfortunate. It doesn't do what it sounds like it should do in this context.

Cheers,

Simon.

</pre>
    </div>

    <div id="c12" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-18 16:58:42 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Simon, thanks for the analysis.

Please could you confirm my understanding: If we drop the --bind-interfaces option, dnsmasq will correctly drop the inappropriate requests rather than replying to them... but we won't be able to run more than one instance of dnsmasq?

If so, then I don't think we can get away with that change. Should we add a *new* option to actually make it, well, bind to the interfaces? (Rather than their IP addresses as --bind-interfaces does. I'll let you name it. ☺)

Failing that, what would you recommend is the best way to use dnsmasq from libvirt?

</pre>
    </div>

    <div id="c13" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Simon Kelley</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-20 19:23:37 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text"><span class="quote">&gt; Please could you confirm my understanding: If we drop the --bind-interfaces
&gt; option, dnsmasq will correctly drop the inappropriate requests rather than
&gt; replying to them... but we won't be able to run more than one instance of
&gt; dnsmasq?</span >

It's slighly worse than that: You won't be able to run _any_ DNS server that wants to bind port 53, not any DHCP server or tftp server, if appropriate.

There's no easy solution that works in every case. A single &quot;daemon&quot; dnsmasq that has a hand-crafted configuration will do everything that's necessary, but that's incompatible with any sort of package automation.

Starting a dnsmasq for each function (network DNS server, local DNS cache, DHCP server for libvirt virtual network.... ) solves the configuration problem but it's very difficult to get many instances to co-exist. Every single instance must set --bind-interfaces, and that has downsides, it stops dnsmasq coping with dynamically created interfaces and (as you've discovered) it has access-control implications.

Ubuntu are currently wrestling with this big-time because they're spawning a dnsmasq from networkmanager to do local resolving but that interferes with any concurrent use of dnsmasq as a DHCP and DNS server on the network. It can be made to work by setting --bind-interfaces on all the instances and listening on disjoint sets of addresses, but the &quot;server&quot; dnsmasq installation might break with --bind-interfaces, especially if it's assuming that dynamically created interfaces will work.

&gt;
<span class="quote">&gt; If so, then I don't think we can get away with that change. Should we add a
&gt; *new* option to actually make it, well, bind to the interfaces? (Rather than
&gt; their IP addresses as --bind-interfaces does. I'll let you name it. ☺)</span >

Prompted partly by the Ubuntu impasse and accelerated by this one, I've added a _third_ mode, which is has a desirable mixture of the properties of the current two. Essentially, dnsmasq binds the addresses of individual interfaces rather than the wildcard address, making it less of a bully for other dnsmasq instances or DNS servers, but it would uses netlink to track the creation of new interfaces or the addition  of new addresses to existing interfaces, and automatically bind them as required. This mode is inherently Linux-specific, since it needs netlink to work. The access-control works in the same way at NOT --bind-interfaces (ie it checks the arrival interface of packets) So using --bind-dynamic instead of --bind-interfaces will solve your problem.

Will solve, since this code is in the repo and release 2.63test1 but not yet in any stable release.

Cheers,

Simon.

</pre>
    </div>

    <div id="c14" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-06-20 20:04:30 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Thanks. Any particular reason for doing it that way instead of using SO_BINDTODEVICE? FreeBSD at least has an equivalent of SO_BINDTODEVICE, it seems:
<a href="http://lists.freebsd.org/pipermail/freebsd-net/2007-March/013510.html">http://lists.freebsd.org/pipermail/freebsd-net/2007-March/013510.html</a>

</pre>
    </div>

    <div id="c15" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-08 10:11:31 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Ping? And can we stop this bug from being private please? There's no reason for it to be so, and I can't seem to do it myself.

</pre>
    </div>

    <div id="c16" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Jan Lieskovsky</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-09 11:39:48 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Created dnsmasq tracking bugs for this issue

Affects: fedora-all [<a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - CVE-2012-3411 dnsmasq: When run under libvirt open DNS proxy (reachable also out of the virtual network set for the guest domain) is created [fedora-all]"
   href="show_bug.cgi?id=838528">bug 838528</a>]

</pre>
    </div>

    <div id="c17" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Jan Lieskovsky</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-09 12:08:23 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">CVE Request:
<a href="http://www.openwall.com/lists/oss-security/2012/07/09/1">http://www.openwall.com/lists/oss-security/2012/07/09/1</a>

</pre>
    </div>

    <div id="c18" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Douglas Schilling Landgraf</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-09 13:02:00 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Based on <a href="show_bug.cgi?id=833033#c13">comment#13</a> waiting release 2.63 be launched to provide a new fedora package.

</pre>
    </div>

    <div id="c19" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Kurt Seifried</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-12 17:12:28 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Added CVE as per <a href="http://www.openwall.com/lists/oss-security/2012/07/12/5">http://www.openwall.com/lists/oss-security/2012/07/12/5</a>

</pre>
    </div>

    <div id="c20" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-07-29 23:22:44 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">This security bug is now six weeks old. I've had the ISP reassign a new range of IP addresses to replace the range that was being used for my virtual machines, since the old address is *still* receiving a large number of queries.

I've reinstalled the VM host (for other reasons)... would I be right in thinking that six weeks later, this bug is *still* unfixed in Fedora and I'm going to need to fix it manually?

Is there an ETA for getting a fix into Fedora updates?

</pre>
    </div>

    <div id="c22" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-05 22:07:28 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I've had to retire the original IP address range and have the ISP assign me another to use for libvirt. I've updated this machine to F18 and this appears to *still* be broken. Are we not doing security updates any more?

</pre>
    </div>

    <div id="c28" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomáš Hozza</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 10:05:22 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=640706&amp;action=diff" name="attach_640706" title="Commit from upstream git (tag v2.63test1) for reference">attachment 640706</a> <a href="attachment.cgi?id=640706&amp;action=edit" title="Commit from upstream git (tag v2.63test1) for reference">[details]</a></span>
Commit from upstream git (tag v2.63test1) for reference

Adding upstream commit for reference.

</pre>
    </div>

    <div id="c31" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 10:14:46 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Thanks. I think this needs a corresponding patch to libvirt to use the new option? If you have that (or can tell me how to fake it), I can test locally.

</pre>
    </div>

    <div id="c32" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomáš Hozza</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 10:40:38 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c31">comment #31</a>)
<span class="quote">&gt; Thanks. I think this needs a corresponding patch to libvirt to use the new
&gt; option?</span >

Yes, I think libvirt needs to be patched to use the new &quot;--bind-dynamic&quot; option.

<span class="quote">&gt; If you have that (or can tell me how to fake it), I can test locally.</span >

Unfortunately I have no experiences with libvirt so I'm not able to prepare the patch for it.

Although it would be good to test if patched dnsmasq works also with current libvirt to test if the patch didn't break anything (I think it shouldn't).  

Here is scratch build for RHEL5:
<a href="https://brewweb.devel.redhat.com/taskinfo?taskID=5062119">https://brewweb.devel.redhat.com/taskinfo?taskID=5062119</a>
Here is scratch build for RHEL6:
<a href="https://brewweb.devel.redhat.com/taskinfo?taskID=5062147">https://brewweb.devel.redhat.com/taskinfo?taskID=5062147</a>

If you need scratch build for other versions, just let me know.

</pre>
    </div>

    <div id="c33" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 11:39:16 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">For Fedora 18 please. I did have a brief look but the patch didn't apply cleanly and I haven't got round to fixing it up yet so if you have one, that would be appreciated. Thanks.

</pre>
    </div>

    <div id="c34" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomáš Hozza</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 12:18:02 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c33">comment #33</a>)
<span class="quote">&gt; For Fedora 18 please. I did have a brief look but the patch didn't apply
&gt; cleanly and I haven't got round to fixing it up yet so if you have one, that
&gt; would be appreciated. Thanks.</span >

In fedora 18, there is already version 2.63 which fixes this problem. You can find Fedora 18 build here:
<a href="http://koji.fedoraproject.org/koji/buildinfo?buildID=361763">http://koji.fedoraproject.org/koji/buildinfo?buildID=361763</a>

</pre>
    </div>

    <div id="c35" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 12:56:59 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Ah, but that isn't in updates-testing? Installing it manually, and restarting libvirt's instance of it manually with --bind-dynamic instead of --bind-interfaces, it doesn't seem to fix the problem. It still answers queries received from external interfaces:

/sbin/dnsmasq --strict-order --bind-interfaces --local=// --domain-needed --pid-file=/var/run/libvirt/network/net3.pid --conf-file= --except-interface lo --listen-address 90.155.50.33 --dhcp-range 90.155.50.34,90.155.50.46 --dhcp-leasefile=/var/lib/libvirt/dnsmasq/net3.leases --dhcp-lease-max=13 --dhcp-no-override --dhcp-hostsfile=/var/lib/libvirt/dnsmasq/net3.hostsfile --addn-hosts=/var/lib/libvirt/dnsmasq/net3.addnhosts

I've configured the border router to reject *all* incoming packets for 90.155.50.33 to avoid it being 'discovered' again while it's vulnerable, but I can test from elsewhere on my internal network (just inside the border router, for example), and the Fedora 18 box is still answering queries directed at 90.155.50.33.

Did I do the test wrong? Can you show me how you did your *successful* test when building and testing this update?

</pre>
    </div>

    <div id="c36" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 13:03:14 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Aha, this works better:
/sbin/dnsmasq --strict-order --bind-dynamic --local=// --domain-needed --pid-file=/var/run/libvirt/network/net3.pid --conf-file= --interface virbr1 --dhcp-range 90.155.50.34,90.155.50.46 --dhcp-leasefile=/var/lib/libvirt/dnsmasq/net3.leases --dhcp-lease-max=13 --dhcp-no-override --dhcp-hostsfile=/var/lib/libvirt/dnsmasq/net3.hostsfile --addn-hosts=/var/lib/libvirt/dnsmasq/net3.addnhosts

That is, I have to use '--interface virbr1' instead of '--except-interface lo --listen-address 90.155.50.33'.

It still accepts requests received from lo, which confused me momentarily, but it *is* correctly dropping requests received from elsewhere. Although it would be better to reject them with UDP port unreachable errors, rather than reject. Dropping packets is always a bad thing.

</pre>
    </div>

    <div id="c37" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">David Woodhouse</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 13:03:51 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Should we open a separate bug, marked F18Blocker, for libvirt to make use of this?

</pre>
    </div>

    <div id="c38" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Eric Blake</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 17:02:11 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c37">comment #37</a>)
<span class="quote">&gt; Should we open a separate bug, marked F18Blocker, for libvirt to make use of
&gt; this?</span >

Yes - creating the clone now.

</pre>
    </div>

    <div id="c39" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Laine Stump</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-08 18:27:41 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">If libvirt changes its usage of dnsmasq to use --bind-dynamic , it *must* be done in a way that libvirt will continue to operate properly (including calling dnsmasq in an appropriate manner) even on systems that don't have a dnsmasq with --bind-dynamic.

So, what must be done is to do a preliminary run of &quot;dnsmasq --help&quot;, then parse the output to see if it contains --bind-dynamic, and *only then* change the behavior. Doing otherwise will adversely affect all the libvirt users who don't have a sufficiently modern dnsmasq (the vast majority of which will see no behavioral change from this commandline change anyway - see the next paragraph), and I don't see that as acceptable.


Note that this situation only arises when a network is defined with &lt;forward mode='route'&gt;, and that is arguably the *least* common method of setting up a libvirt network by far (it's much more common to use &lt;forward mode='nat'&gt;)

(Beyond that, in the general sense, I think this is actually how a listener on a publicly visible IP of a multihomed host for a port that has been opened for incoming connections &quot;on all interfaces&quot; is normally expected to operate (and remember that all the addresses in a libvirt network using &lt;forward mode='route' are considered to be public). Granted, this is a slightly different situation, since this second interface is really there for the benefit of the guests, but truthfully once I read through all the comments and fully understood what was happening, my thought was &quot;well of course it's responding.&quot; If it was the case that this dnsmasq instance was answering queries sent to the server's *external* IP address, or if queries from the external network to a truly private address (e.g. 192.168.122.1 of libvirt's &quot;default&quot; network which uses forward mode='nat') were responded to, that would be a more serious issue.) I'll happily cede that point though, and agree that we should make libvirt's DNS server instances only answer queries that originate from guests on that network's bridge.

</pre>
    </div>

    <div id="c45" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Laine Stump</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-22 02:57:53 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I've posted a series of 3 patches resolving the libvirt part of the bug to libvir-list. After it is pushed, I will backport to the various distros:

  <a href="https://www.redhat.com/archives/libvir-list/2012-November/msg00942.html">https://www.redhat.com/archives/libvir-list/2012-November/msg00942.html</a>

Please respond to the patch emails with specific comments/suggestions.

</pre>
    </div>

    <div id="c47" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c47">Comment 47</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Laine Stump</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-29 20:30:55 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Patches for libvirt to support the new dnsmasq --bind-dynamic option have been pushed upstream:

commit 719c2c7665e5826a8cf05531080fe20354b39de1
Author: Laine Stump &lt;<a href="mailto:laine&#64;laine.org">laine&#64;laine.org</a>&gt;
Date:   Tue Nov 20 12:22:15 2012 -0500

    util: capabilities detection for dnsmasq
    
    In order to optionally take advantage of new features in dnsmasq when
    the host's version of dnsmasq supports them, but still be able to run
    on hosts that don't support the new features, we need to be able to
    detect the version of dnsmasq running on the host, and possibly
    determine from the help output what options are in this dnsmasq.
    
    This patch implements a greatly simplified version of the capabilities
    code we already have for qemu. A dnsmasqCaps device can be created and
    populated either from running a program on disk, reading a file with
    the concatenated output of &quot;dnsmasq --version; dnsmasq --help&quot;, or
    examining a buffer in memory that contains the concatenated output of
    those two commands. Simple functions to retrieve capabilities flags,
    the version number, and the path of the binary are also included.
    
    bridge_driver.c creates a single dnsmasqCaps object at driver startup,
    and disposes of it at driver shutdown. Any time it must be used, the
    dnsmasqCapsRefresh method is called - it checks the mtime of the
    binary, and re-runs the checks if the binary has changed.
    
    networkxml2argvtest.c creates 2 &quot;artificial&quot; dnsmasqCaps objects at
    startup - one &quot;restricted&quot; (doesn't support --bind-dynamic) and one
    &quot;full&quot; (does support --bind-dynamic). Some of the test cases use one
    and some the other, to make sure both code pathes are tested.

commit bf402e77b6d53a4e569b3aa76aef9c7d589c0cf2
Author: Laine Stump &lt;<a href="mailto:laine&#64;laine.org">laine&#64;laine.org</a>&gt;
Date:   Wed Nov 21 21:17:30 2012 -0500

    util: new virSocketAddrIsPrivate function
    
    This new function returns true if the given address is in the range of
    any &quot;private&quot; or &quot;local&quot; networks as defined in RFC1918 (IPv4) or
    RFC3484/RFC4193 (IPv6), otherwise they return false.
    
    These ranges are:
    
       192.168.0.0/16
       172.16.0.0/16
       10.0.0.0/24
       FC00::/7
       FEC0::/10

commit 753ff83a50263d6975f88d6605d4b5ddfcc97560
Author: Laine Stump &lt;<a href="mailto:laine&#64;laine.org">laine&#64;laine.org</a>&gt;
Date:   Wed Nov 21 21:21:02 2012 -0500

    network: use dnsmasq --bind-dynamic when available
    
    This bug resolves <a href="https://access.redhat.com/security/cve/CVE-2012-3411">CVE-2012-3411</a>, which is described in the following
    bugzilla report:

</pre>
    </div>

    <div id="c51" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c51">Comment 51</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tim Flink</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-11-30 20:36:47 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">The impact of this is &quot;moderate&quot; which is less than &quot;important&quot; and thus this bug does not qualify as a release blocking bug for F18 final. The release criterion in question [1] is:

The release must contain no known security bugs of 'important' or higher impact according to the Red Hat severity classification scale which cannot be satisfactorily resolved by a package update (e.g. issues during installation)

-1 blocker, +1 NTH

</pre>
    </div>

    <div id="c52" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c52">Comment 52</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Adam Williamson</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-12-01 08:29:54 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">agreed with tflink, -1 blocker, +1 nth.

</pre>
    </div>

    <div id="c53" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c53">Comment 53</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Jaroslav Reznik</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-12-04 12:20:44 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Based on final release criterion (as mentioned above),
-1 blocker, +1 nth

</pre>
    </div>

    <div id="c55" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c55">Comment 55</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tim Flink</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-12-04 20:56:44 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I count -3 blocker, +3 NTH. Moving to rejected blocker, accepted NTH. A tested fix would be considered past freeze.

</pre>
    </div>

    <div id="c56" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c56">Comment 56</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomas Hoger</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-12-14 09:36:31 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">This bug is not against Fedora product, and AcceptedNTH in its whiteboard is causing issues elsewhere.  Ok to set that on <a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - CVE-2012-3411 libvirt needs to use new dnsmasq option to avoid open DNS proxy [fedora-all]"
   href="show_bug.cgi?id=882309">bug 882309</a>, along with Blocks F18-accepted ?

</pre>
    </div>

    <div id="c57" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c57">Comment 57</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Laine Stump</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-12-14 15:22:40 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">The confusion is probably due to the fact tha this BZ was originally filed against Fedora (although it was Fedora 17, not 18) and was later co-opted by the security team.

Somebody who knows the Fedora process better will need to comment on whether it's appropriate to set the flags on Buf 882309 instead (I notice that is has release set to Fedora 17, not 18, but don't know if that matters, once the proper flags are set).

</pre>
    </div>

    <div id="c58" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c58">Comment 58</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Adam Williamson</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-12-14 21:28:47 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">yeah, moving the NTH status there would work. I'm intrigued as to how our little whiteboard field is causing trouble for anything else, but hey.

</pre>
    </div>

    <div id="c59" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c59">Comment 59</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Yap Sok Ann</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-02-01 03:58:47 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">&#64;Laine Stump, I kinda agree with the point ceded in <a href="show_bug.cgi?id=833033#c39">comment 39</a>. Is there anyway to revert to the old behavior, i.e. allowing dnsmasq to be queried from outside? AT the moment, there doesn't seem to be any relevant setting in <a href="http://libvirt.org/formatnetwork.html">http://libvirt.org/formatnetwork.html</a>

</pre>
    </div>

    <div id="c60" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c60">Comment 60</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Laine Stump</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-02-05 04:26:04 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c59">comment #59</a>)
<span class="quote">&gt; &#64;Laine Stump, I kinda agree with the point ceded in <a href="show_bug.cgi?id=833033#c39">comment 39</a>. Is there
&gt; anyway to revert to the old behavior, i.e. allowing dnsmasq to be queried
&gt; from outside? AT the moment, there doesn't seem to be any relevant setting
&gt; in <a href="http://libvirt.org/formatnetwork.html">http://libvirt.org/formatnetwork.html</a></span >

No, there is currently no way to revert to the old behavior, although dnsmasq has just added back support for querying libvirt's dnsmasq instances directly from the host. See <a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - RFE: libvirt's dnsmasq instances should answer LOCAL DNS Queries"
   href="show_bug.cgi?id=904940">Bug 904940</a>.

</pre>
    </div>

    <div id="c61" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c61">Comment 61</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">errata-xmlrpc</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-02-21 10:44:44 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">This issue has been addressed in following products:

  Red Hat Enterprise Linux 6

Via RHSA-2013:0277 <a href="https://rhn.redhat.com/errata/RHSA-2013-0277.html">https://rhn.redhat.com/errata/RHSA-2013-0277.html</a>

</pre>
    </div>

    <div id="c63" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c63">Comment 63</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">errata-xmlrpc</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-02-28 18:57:54 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">This issue has been addressed in following products:

  RHEV-H and Agents for RHEL-6

Via RHSA-2013:0579 <a href="https://rhn.redhat.com/errata/RHSA-2013-0579.html">https://rhn.redhat.com/errata/RHSA-2013-0579.html</a>

</pre>
    </div>

    <div id="c64" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c64">Comment 64</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Paul Wouters</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-04-14 04:39:38 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I was hit by this now too. Worse, my dnsmasq was a participant in a DDOS attack being queried with fake source IPs doing ANY queries for isc.org, a well known amplifying query.

0:24:33.991446 IP 95.211.225.167.25345 &gt; 76.10.157.69.domain: 10809+ [1au] ANY? isc.org. (36)
00:24:33.992160 IP 76.10.157.69.domain &gt; 95.211.225.167.25345: 10809 27/0/9 SOA, RRSIG, NS ams.sns-pb.isc.org., NS sfba.sns-pb.isc.org., NS ord.sns-pb.isc.org., NS ns.isc.afilias-nst.info., RRSIG, A 149.20.64.42, RRSIG, MX mx.ams1.isc.org. 10, MX mx.pao1.isc.org. 10, RRSIG, TXT &quot;v=spf1 a mx ip4:204.152.184.0/21 ip4:149.20.0.0/16 ip6:2001:04F8::0/32 ip6:2001:500:60::65/128 ~all&quot;, TXT &quot;$Id: isc.org,v 1.1792 2013-04-02 00:33:44 bind Exp $&quot;, RRSIG, AAAA 2001:4f8:0:2::d, RRSIG[|domain]
00:24:34.513888 IP 23.29.113.102.25448 &gt; 76.10.157.69.domain: 7490+ [1au] ANY? isc.org. (36)
00:24:34.514594 IP 76.10.157.69.domain &gt; 23.29.113.102.25448: 7490 27/0/9 SOA, RRSIG, NS ams.sns-pb.isc.org., NS sfba.sns-pb.isc.org., NS ord.sns-pb.isc.org., NS ns.isc.afilias-nst.info., RRSIG, A 149.20.64.42, RRSIG, MX mx.ams1.isc.org. 10, MX mx.pao1.isc.org. 10, RRSIG, TXT &quot;v=spf1 a mx ip4:204.152.184.0/21 ip4:149.20.0.0/16 ip6:2001:04F8::0/32 ip6:2001:500:60::65/128 ~all&quot;, TXT &quot;$Id: isc.org,v 1.1792 2013-04-02 00:33:44 bind Exp $&quot;, RRSIG, AAAA 2001:4f8:0:2::d, RRSIG[|domain]
00:24:34.664537 IP 95.211.225.167.25345 &gt; 76.10.157.69.domain: 10809+ [1au] ANY? isc.org. (36)
00:24:34.665220 IP 76.10.157.69.domain &gt; 95.211.225.167.25345: 10809 27/0/9 SOA, RRSIG, NS ams.sns-pb.isc.org., NS sfba.sns-pb.isc.org., NS ord.sns-pb.isc.org., NS ns.isc.afilias-nst.info., RRSIG, A 149.20.64.42, RRSIG, MX mx.ams1.isc.org. 10, MX mx.pao1.isc.org. 10, RRSIG, TXT &quot;v=spf1 a mx ip4:204.152.184.0/21 ip4:149.20.0.0/16 ip6:2001:04F8::0/32 ip6:2001:500:60::65/128 ~all&quot;, TXT &quot;$Id: isc.org,v 1.1792 2013-04-02 00:33:44 bind Exp $&quot;, RRSIG, AAAA 2001:4f8:0:2::d, RRSIG[|domain]





This is using Fedora 18 with libvirt-0.10.2.4-1.fc18.x86_64

I'm changing this but to urgent

</pre>
    </div>

    <div id="c65" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c65">Comment 65</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Cole Robinson</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-04-14 15:33:25 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Hmm I thought this was supposed to be fixed in F18. Laine, thoughts on Paul's comment?

</pre>
    </div>

    <div id="c66" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c66">Comment 66</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Laine Stump</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-04-14 23:00:09 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Well, my first comment is that this BZ is the distro-agnostic CVE BZ; the appropriate BZ for Fedora-specific issues is <a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - CVE-2012-3411 dnsmasq: When run under libvirt open DNS proxy (reachable also out of the virtual network set for the guest domain) is created [fedora-all]"
   href="show_bug.cgi?id=838528">Bug 838528</a>. I have some questions for Paul which I will post in that BZ. (BTW, as far as I know, only people on the security team are supposed to change the priority of BZs with a product of &quot;Security Response&quot;.)

Now for my question wrt this BZ: I'm not sure why this BZ still shows as new - both the Fedora and the RHEL versions of the BZ are marked as CLOSED/ERRATA. Shouldn't this be automatically closed when all the platform-specific bugs are closed?

</pre>
    </div>

    <div id="c67" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c67">Comment 67</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomáš Hozza</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-04-15 07:21:00 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c65">comment #65</a>)
<span class="quote">&gt; Hmm I thought this was supposed to be fixed in F18. Laine, thoughts on
&gt; Paul's comment?</span >

It was dnsmasq issue and it has been already fixed in dnsmasq-2.65-2.

</pre>
    </div>

    <div id="c68" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c68">Comment 68</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Jan Lieskovsky</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-04-25 09:08:22 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=833033#c66">comment #66</a>)
<span class="quote">&gt; Well, my first comment is that this BZ is the distro-agnostic CVE BZ; the
&gt; appropriate BZ for Fedora-specific issues is <a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - CVE-2012-3411 dnsmasq: When run under libvirt open DNS proxy (reachable also out of the virtual network set for the guest domain) is created [fedora-all]"
   href="show_bug.cgi?id=838528">Bug 838528</a>. I have some
&gt; questions for Paul which I will post in that BZ. (BTW, as far as I know,
&gt; only people on the security team are supposed to change the priority of BZs
&gt; with a product of &quot;Security Response&quot;.)</span >

That is correct. Only Red Hat Security Response Team members are supposed to change the status of Security Response bugs.

<span class="quote">&gt; 
&gt; Now for my question wrt this BZ: I'm not sure why this BZ still shows as new
&gt; - both the Fedora and the RHEL versions of the BZ are marked as
&gt; CLOSED/ERRATA. Shouldn't this be automatically closed when all the
&gt; platform-specific bugs are closed?</span >

While the issue has been corrected in Red Hat Enterprise Linux 6 and Fedora products, it still is present in Red Hat Enterprise Linux 5:
  <a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED ERRATA - CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks"
   href="show_bug.cgi?id=833033#c62">https://bugzilla.redhat.com/show_bug.cgi?id=833033#c62</a>

That's the reason this bug is still in NEW state (will be closed only in moment issue has been resolved in all affected products). {Security Response product bugs have just two states: 1) NEW 2) CLOSED [ERRATA, NOTABUG] etc. - there isn't a way how to specify / note the issue has been already corrected in subset of affected versions}

Hope the above clarifies, Jan.

</pre>
    </div>

    <div id="c69" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=833033#c69">Comment 69</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Vincent Danen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-02-26 22:57:49 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Statement:

Red Hat Enterprise Linux 5 is now in Production 3 Phase of the support and maintenance life cycle. This has been rated as having Low security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: <a href="https://access.redhat.com/support/policy/updates/errata/">https://access.redhat.com/support/policy/updates/errata/</a>.

</pre>
    </div>


  <script>
$(document).ready(function() {
  var mysel = document.getElementsByClassName('flag_type-415')[0];
  var relnotes = document.getElementById('cf_release_notes');
  if ( mysel && relnotes &&
      relnotes.value != '' &&
      relnotes.value != cf_doc_type_text[document.getElementById('cf_doc_type').value] &&
      mysel.options[mysel.selectedIndex].value != '+'
    )
      document.getElementById('cf_doc_warn').innerHTML = '<div class="warning "><b>Warning: Doc Text is not yet verified as correct</b></div>';
});
</script>

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=833033&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=833033" title="Format For Printing"><i class="fa fa-print"></i></a></li>
    <li><a href="show_bug.cgi?ctype=xml&amp;id=833033" title="Export as XML"><i class="far fa-file-excel"></i></a></li>
    <li><a href="enter_bug.cgi?cloned_bug_id=833033" title="Clone This Bug"><i class="fa fa-clone"></i></a></li>
    <li>
      <a href="enter_bug.cgi?cloned_bug_id=833033&lite=1" title="Copy is a lite weight clone that only copies the summary &amp; description">
       <i class="far fa-clone"></i>
      </a>
    </li><li>
  <a href="buglist.cgi?bug_id=833033&amp;bug_id_type=anddependson&amp;format=tvp" title="TreeView+">
    <i class="fa fa-tree"></i>
  </a>
</li>
    <li>
      <a href="#" title="Top of page">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li class="form">
    
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>
<script type="text/javascript">
function dt_submit() {
  var tables = $.fn.dataTable.tables( { visible: true, api: true } );
  $.each(tables.context, function() {
    var $myform = this.nTable.closest('form');

    // Checked checkboxes
    $.each(this.oInstance.$('input:checked'), function() {
      add_hidden(this.name, this.value, $myform)
    });

    // Inputs in selected rows
    $.each(this.oInstance.$('tr.selected'), function() {
      $(this).find('input').each( function() {
        add_hidden(this.name, this.value, $myform)
      });
    });

    // select boxes
    $.each(this.oInstance.$('select'), function() {
      if(($(this).val()!=="") && ($(this).val() !== 0)) {
        add_hidden(this.name, this.value, $myform);
      }
    });
  });
}

function add_hidden(nm, val, $frm) {
        $('<input />').attr('type', 'hidden')
          .attr('name', nm)
          .attr('value', val)
          .appendTo($frm);
}

$(document).ready(function() {
    $('form').submit(function( event ) {
        dt_submit();
        if( $(this).attr('id') === 'changeform') {
          return(validateEnterBug(this));
        }
    });
});

if (window.self !== window.top) {
    $('#header').addClass('bz_default_hidden');
    $('#footer').addClass('bz_default_hidden');
    $('.navigation').addClass('bz_default_hidden');
    $('body').css('background-image', 'none');
}
</script><script type="text/javascript">
$(document).ready(function() {
    $('select').not('.custom_search_condition select, #member_template select, #available_columns, #p2_component, #select_user_verify_class, #inclusion_to_remove, #exclusion_to_remove, #cc, #hide, #ack_col_edit #show, .noselectize, #j_top').each(function() {
        if(! $(this).hasClass('selectized')) {
            $(this).selectize({
                plugins: ['remove_button', 'minimum_search_length', 'extra_keys_control', 'related_fields', 'load_from_js'],
                selectOnTab: true,
                maxOptions: 'nolimit',
                minimum_search_length: 2,
                render: {
                    option: function(item, escape) {
                        var classes = "option";
                        var selected = this.items.indexOf(item.value) !== -1;
                        if(item.disabled) {
                            classes = classes + " bz_default_hidden" ;
                        }

                        return '<div class="' +  classes  + '" title="' + escape(item.title) + '" id="' + escape(item.id) + '" data-value="' + escape(item.value) + '">' +
                                    '<span>' + escape(item.text) + '</span>' +
                                '</div>';
                    }
                },
            });
        }
    });
});
</script>
  </body>
</html>