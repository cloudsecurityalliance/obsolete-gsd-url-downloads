<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>0d9dfd649bae9c181e3afc5d571903f1eb5dc46f - platform/packages/apps/UnifiedEmail - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/packages/apps/UnifiedEmail/%2B/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/packages/">packages</a> / <a class="Breadcrumbs-crumb" href="/platform/packages/apps/">apps</a> / <a class="Breadcrumbs-crumb" href="/platform/packages/apps/UnifiedEmail/">UnifiedEmail</a> / <span class="Breadcrumbs-crumb">0d9dfd649bae9c181e3afc5d571903f1eb5dc46f</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>0d9dfd649bae9c181e3afc5d571903f1eb5dc46f</td><td><span>[<a href="/platform/packages/apps/UnifiedEmail/+log/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f">log</a>]</span> <span>[<a href="/platform/packages/apps/UnifiedEmail/+archive/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Régis Décamps &lt;regisd@google.com&gt;</td><td>Tue Feb 23 16:16:54 2016 +0100</td></tr><tr><th class="Metadata-title">committer</th><td>The Android Automerger &lt;android-build@google.com&gt;</td><td>Fri Feb 26 14:34:05 2016 -0800</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/">5fa360968d3e6dd0cd2de5f04d70875532e028bf</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f%5E">d7917089078210e30e5136822e63f530c9e66268</a> <span>[<a href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Don&#39;t allow file attachment from file:///data.

Commit 24ed2941ab132e4156bd38f0ab734c81dae8fc2e allows file://
attachment on the /data directory if they are from the same process.

This was done to work around applications that shared their internal
data file. However, this is bad practice, and other apps should share
content:// Uri instead.

With this change, Email doesn&#39;t allow this anymore. This fixes
security issue 199888.

Also, add Analytics for these errors
compose_errors &gt; send_intent_attachment &gt; data_dir

<a href="https://code.google.com/p/android/issues/detail?id=199888">https://code.google.com/p/android/issues/detail?id=199888</a>
b/26989185
Change-Id: <a href="https://android-review.googlesource.com/#/q/I7cae3389f4f7cf5f86600a58c6ccdffaf889d1c3">I7cae3389f4f7cf5f86600a58c6ccdffaf889d1c3</a>
</pre><ul class="DiffTree"><li><a href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/src/com/android/mail/compose/ComposeActivity.java">src/com/android/mail/compose/ComposeActivity.java</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f%5E%21/#F0">diff</a>]</span></li></ul><div class="DiffSummary">1 file changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 5fa360968d3e6dd0cd2de5f04d70875532e028bf</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - Android.mk"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/Android.mk">Android.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - AndroidManifest.xml"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/AndroidManifest.xml">AndroidManifest.xml</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - CleanSpec.mk"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/CleanSpec.mk">CleanSpec.mk</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - assets/"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/assets/">assets/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - proguard-test.flags"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/proguard-test.flags">proguard-test.flags</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - proguard.flags"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/proguard.flags">proguard.flags</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - res/"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/res/">res/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - src/"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/src/">src/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - tests/"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/tests/">tests/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - unified_src/"><a class="FileList-itemLink" href="/platform/packages/apps/UnifiedEmail/+/0d9dfd649bae9c181e3afc5d571903f1eb5dc46f/unified_src/">unified_src/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>