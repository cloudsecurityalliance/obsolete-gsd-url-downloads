<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1064636 - (CVE-2014-1568) RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1064636">
<meta property="og:description"
      content="RESOLVED (kaie) in NSS - Libraries. Last updated 2019-07-01.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1064636 - (CVE-2014-1568) RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1064636&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1064636">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1064636">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/yui.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/global.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/util.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr31\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox32\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox35\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox33\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox34\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"],\"flags\":{\"tracking\":{\"cf_tracking_firefox35\":\"+\",\"cf_tracking_firefox33\":\"+\",\"cf_status_firefox32\":\"verified\",\"cf_status_b2g_1_4\":\"fixed\",\"cf_status_b2g_2_2\":\"fixed\",\"cf_status_firefox34\":\"verified\",\"cf_status_b2g_2_0m\":\"fixed\",\"cf_tracking_firefox_esr31\":\"32+\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_b2g_2_0\":\"fixed\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox32\":\"+\",\"cf_status_firefox35\":\"verified\",\"cf_tracking_firefox34\":\"+\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox33\":\"verified\",\"cf_status_b2g_2_1\":\"fixed\",\"cf_status_firefox_esr31\":\"verified\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_relnote\":\"---\"},\"project\":{\"cf_root_cause\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1064636;
  BUGZILLA.bug_title = '1064636 - (CVE-2014-1568) RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing';
  BUGZILLA.bug_summary = 'RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1064636';
  BUGZILLA.bug_keywords = 'sec-critical',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/field.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/comments.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1064636">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1064636"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1064636 - (CVE-2014-1568) RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="Fmuy0nI4KZFVwyKvw37WAdL8qR6zkYgD7CJfaYEeyJnjOkCFeTYiIIAsU2uVqoxGqbptOJ19eQcpmSTI2zQ3if4h1tqvHRyFO4yag4wOBFaEanhj8N2mOH2BifenOTA1tMC9m4pfClywOelyajalP6bAf6aZsHT79DXIs2chJal3Z0loCGY63jxWyvr6kyOdle7oyeRxtZXyS5KhzUI8Hi5jlC3AAWCgZ1gmP5magZnmxt9ZmynI952kyw0FuFiC">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1064636" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622487-Jj1ILwNx4lOLB7USBGoxd6eS1K0KQoKR-j6qDxSisDw">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1064636" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1064636" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1064636">Bug 1064636</a>
          <span class="edit-hide">(CVE-2014-1568)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2014-09-08 17:34 PDT" data-time="1410222864">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2014-09-29 13:47 PDT" data-time="1412023661">7 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">RSA PKCS#1 signature verification forgery is possible due to too-permissive Signature<wbr>Algorithm parameter parsing</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (NSS :: Libraries, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">NSS
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">NSS</div>
            <div class="description">Network Security Services - a cross-platform
security library (<a href="http://www.mozilla.org/projects/security/pki/nss/">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=NSS"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS&component=Libraries#Libraries" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Libraries
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">NSS :: Libraries</div>
            <div class="description">Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=NSS&amp;component=Libraries"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS" data-component="Libraries"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            critical

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox32+ verified, firefox33+ verified, firefox34+ verified, firefox35+ verified, firefox-esr3132+ verified, b2g-v1.4 fixed, b2g-v2.0 fixed, b2g-v2.0M fixed, b2g-v2.1 fixed, b2g-v2.2 fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-target_milestone" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            ---

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox32</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox32&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox33</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox34</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox35</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr31</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=32%2B">32+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v1.4</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0M</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.2</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox32</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox32-dirty">
  <select id="cf_tracking_firefox32" name="cf_tracking_firefox32">
        <option value="+"
          id="v1633_cf_tracking_firefox32" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox32-dirty">
  <select id="cf_status_firefox32" name="cf_status_firefox32">
        <option value="verified"
          id="v1641_cf_status_firefox32" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox33</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox33-dirty">
  <select id="cf_tracking_firefox33" name="cf_tracking_firefox33">
        <option value="+"
          id="v1720_cf_tracking_firefox33" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox33-dirty">
  <select id="cf_status_firefox33" name="cf_status_firefox33">
        <option value="verified"
          id="v1715_cf_status_firefox33" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox34</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox34-dirty">
  <select id="cf_tracking_firefox34" name="cf_tracking_firefox34">
        <option value="+"
          id="v1778_cf_tracking_firefox34" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox34-dirty">
  <select id="cf_status_firefox34" name="cf_status_firefox34">
        <option value="verified"
          id="v1786_cf_status_firefox34" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox35</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox35-dirty">
  <select id="cf_tracking_firefox35" name="cf_tracking_firefox35">
        <option value="+"
          id="v1841_cf_tracking_firefox35" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox35-dirty">
  <select id="cf_status_firefox35" name="cf_status_firefox35">
        <option value="verified"
          id="v1849_cf_status_firefox35" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr31</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr31-dirty">
  <select id="cf_tracking_firefox_esr31" name="cf_tracking_firefox_esr31">
        <option value="32+"
          id="v1754_cf_tracking_firefox_esr31" selected
        >32+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr31-dirty">
  <select id="cf_status_firefox_esr31" name="cf_status_firefox_esr31">
        <option value="verified"
          id="v1767_cf_status_firefox_esr31" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v1.4</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_1_4-dirty">
  <select id="cf_status_b2g_1_4" name="cf_status_b2g_1_4">
        <option value="fixed"
          id="v1466_cf_status_b2g_1_4" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0-dirty">
  <select id="cf_status_b2g_2_0" name="cf_status_b2g_2_0">
        <option value="fixed"
          id="v1603_cf_status_b2g_2_0" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0M</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0m-dirty">
  <select id="cf_status_b2g_2_0m" name="cf_status_b2g_2_0m">
        <option value="fixed"
          id="v1914_cf_status_b2g_2_0m" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1-dirty">
  <select id="cf_status_b2g_2_1" name="cf_status_b2g_2_1">
        <option value="fixed"
          id="v1737_cf_status_b2g_2_1" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.2</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_2-dirty">
  <select id="cf_status_b2g_2_2" name="cf_status_b2g_2_2">
        <option value="fixed"
          id="v1878_cf_status_b2g_2_2" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: briansmith, Assigned: KaiE)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_36541" ><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=36541" > <span class="fna">KaiE</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=14661" > <span class="fna">briansmith</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=622637" > <span class="fna">beurdouche</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="52">52 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Blocks 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_REOPENED"
   title="REOPENED - Keep our nss.def in sync with nss's nss.def?"
   href="/show_bug.cgi?id=1072045">1072045</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disable parameter unsafeAllowMissingParameters in _SGN_VerifyPKCS1DigestInfo"
   href="/show_bug.cgi?id=1296986">1296986</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1064636&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1064636">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=1054659">1054659</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">CVE-2014-1569</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">CVE-2014-1570</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-critical, Whiteboard: [status-firefox-esr24:fixed][status-b2g-v1.3:fixed][status-b2g-v1.3t:fixed][adv-main32+][adv-esr31.1+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2014-1568

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[status-firefox-esr24:fixed][status-b2g-v1.3:fixed][status-b2g-v1.3t:fixed][adv-main32+][adv-esr31.1+]
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a1800470_280903"
            class="rel-time-title activity-ref"
            title="7 years ago"
        data-time="1411416997"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-984339">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-984339-dirty">
      <select id="flag-984339" name="flag-984339"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (11 files, 20 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8488057"
              title="Screen shot showing the accepted cert chain in Firefox 31"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Screen shot showing the accepted cert chain in Firefox 31
            </a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2014-09-11 10:37 PDT" data-time="1410457079">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">20.20 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8488057&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8488061">Cert chain of test server (in PEM format)</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2014-09-11 10:39 PDT" data-time="1410457140">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">5.21 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8488061&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490266">script to generate prefixes: python DottedOIDToCode.py --dii foo bar</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 12:12 PDT" data-time="1410894751">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.37 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490266&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490281">Part 1: Implement new PKCS#1 padding checking logic</a>
        </div>
        <div>
            <a href="#c29" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 12:38 PDT" data-time="1410896282">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">9.22 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490281&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490281&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490281">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490283">Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic</a>
        </div>
        <div>
            <a href="#c30" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 12:42 PDT" data-time="1410896521">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">9.11 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490283&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490283&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490283">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490288">Part 3: Change softoken to use the new PKCS#1 padding verification logic</a>
        </div>
        <div>
            <a href="#c31" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 12:47 PDT" data-time="1410896837">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.61 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c43"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1410902828"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490288&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490288&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490288">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490369">Part 1: Implement new PKCS#1 padding checking logic [v2]</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 14:17 PDT" data-time="1410902247">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">9.31 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490369&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490369&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490369">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490376">Part 1: Implement new PKCS#1 padding checking logic [v3]</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 14:21 PDT" data-time="1410902496">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">9.31 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c40"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1410902496"
            >
              review-</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c46"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1410912143"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490376&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490376&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490376">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490498">build_hash.c</a>
        </div>
        <div>
            <a href="#c48" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 18:28 PDT" data-time="1410917333">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_11099" ><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div></span>
        </div>
        <div class="attach-info">2.99 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490498&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490536">Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]</a>
        </div>
        <div>
            <a href="#c49" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 20:15 PDT" data-time="1410923726">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">9.14 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#a745426_11099"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1410968290"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490536&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490536&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490536">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8490537">Part 4: Add additional comments for the changes to VFY_*</a>
        </div>
        <div>
            <a href="#c50" class="attach-time activity-ref"><span class="rel-time" title="2014-09-16 20:19 PDT" data-time="1410923941">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.42 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c51"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1410968427"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8490537&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8490537&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490537">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8491627">part1 - v4 - work-in-progress</a>
        </div>
        <div>
            <a href="#c64" class="attach-time activity-ref"><span class="rel-time" title="2014-09-18 10:21 PDT" data-time="1411060871">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.24 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8491627&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8491627&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8491627">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8491708">part 1 - [v5] - with debug code</a>
        </div>
        <div>
            <a href="#c65" class="attach-time activity-ref"><span class="rel-time" title="2014-09-18 11:58 PDT" data-time="1411066717">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">11.06 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8491708&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8491708&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8491708">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8491709">part 1 - [v6]</a>
        </div>
        <div>
            <a href="#c66" class="attach-time activity-ref"><span class="rel-time" title="2014-09-18 11:59 PDT" data-time="1411066795">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.31 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c67"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411066795"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_381992" ><span class="fn">ryan.sleevi</span>
</div>:
              <a href="#c73"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411415658"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8491709&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8491709&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8491709">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8492326">Signature validation tests</a>
        </div>
        <div>
            <a href="#c68" class="attach-time activity-ref"><span class="rel-time" title="2014-09-19 12:26 PDT" data-time="1411154761">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_345904" ><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div></span>
        </div>
        <div class="attach-info">14.89 KB,
          application/x-gzip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8492326&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8492339">evp_pkcs1_padding_test.c</a>
        </div>
        <div>
            <a href="#c69" class="attach-time activity-ref"><span class="rel-time" title="2014-09-19 12:44 PDT" data-time="1411155862">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.48 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8492339&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8492355">Go script for generating test certs - tweaks to Go libraries needed.</a>
        </div>
        <div>
            <a href="#c70" class="attach-time activity-ref"><span class="rel-time" title="2014-09-19 13:05 PDT" data-time="1411157112">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_345904" ><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div></span>
        </div>
        <div class="attach-info">3.98 KB,
          text/x-go        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8492355&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8492383">Signature validation tests</a>
        </div>
        <div>
            <a href="#c72" class="attach-time activity-ref"><span class="rel-time" title="2014-09-19 13:56 PDT" data-time="1411160193">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_345904" ><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div></span>
        </div>
        <div class="attach-info">21.92 KB,
          application/x-gzip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8492383&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493339">part 1 - [v7]</a>
        </div>
        <div>
            <a href="#c79" class="attach-time activity-ref"><span class="rel-time" title="2014-09-22 14:15 PDT" data-time="1411420517">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.35 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493339&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493339&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493339">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493387">part 1 - [v8]</a>
        </div>
        <div>
            <a href="#c81" class="attach-time activity-ref"><span class="rel-time" title="2014-09-22 15:19 PDT" data-time="1411424381">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">10.77 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493387&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493387&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493387">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493419">part 2 - [v3]</a>
        </div>
        <div>
            <a href="#c84" class="attach-time activity-ref"><span class="rel-time" title="2014-09-22 16:09 PDT" data-time="1411427365">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.85 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493419&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493419&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493419">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493772">part1-v9 (will be replaced shortly)</a>
        </div>
        <div>
            <a href="#c103" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 07:40 PDT" data-time="1411483236">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.89 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493772&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493772&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493772">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493773">part2-v9</a>
        </div>
        <div>
            <a href="#c104" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 07:41 PDT" data-time="1411483316">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">10.37 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c110"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411483316"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493773&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493773&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493773">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493775">part3-v9</a>
        </div>
        <div>
            <a href="#c105" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 07:42 PDT" data-time="1411483338">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.33 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c112"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411483338"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493775&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493775&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493775">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493805">part1-v9c</a>
        </div>
        <div>
            <a href="#c108" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 08:24 PDT" data-time="1411485897">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.80 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c113"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411485897"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493805&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493805&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493805">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493845">part2-v10</a>
        </div>
        <div>
            <a href="#c114" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 09:50 PDT" data-time="1411491059">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">10.45 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#c114"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411491059"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493845&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493845&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493845">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493855">part2-v10b</a>
        </div>
        <div>
            <a href="#c115" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 10:12 PDT" data-time="1411492338">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">10.45 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#c115"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411492338"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493855&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493855&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493855">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493856">part3-v10</a>
        </div>
        <div>
            <a href="#c116" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 10:13 PDT" data-time="1411492417">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.59 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c118"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411492417"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493856&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493856&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493856">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493860">part1-v10</a>
        </div>
        <div>
            <a href="#c117" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 10:15 PDT" data-time="1411492525">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.81 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493860&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493860&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493860">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493874">part-bustage1</a>
        </div>
        <div>
            <a href="#c119" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 10:44 PDT" data-time="1411494261">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">668 bytes,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493874&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493874&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493874">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8493992">Alternative patch for discussion; reduces exposure of public APIs</a>
        </div>
        <div>
            <a href="#c129" class="attach-time activity-ref"><span class="rel-time" title="2014-09-23 13:41 PDT" data-time="1411504862">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_381992" ><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div></span>
        </div>
        <div class="attach-info">13.46 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c157"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1411504862"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8493992&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8493992&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493992">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="sLLlIQb1oDaMu8kTHwvQ3uoFUe1Ehi5kDoT7KFM3CRn6dTGF">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9285477" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 17:34 PDT" data-time="1410222864">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="9285477">In <a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=1054659#c20">bug 1054659 comment 20</a>, Antoine Delignat-Lavaud wrote:
<span class="quote">&gt; It is indeed possible to attack RSA-PKCS#1v1.5 in NSS.
&gt; Earlier you pointed me to the file nss/lib/cryptohi/secvfy.c for signature
&gt; verification. Near the top of the file there's a function with this
&gt; interesting comment:
&gt; 
&gt;     /* make sure the &quot;parameters&quot; are not too bogus. */
&gt;     if (di-&gt;digestAlgorithm.parameters.len &gt; 2) {
&gt; 	goto sigloser;
&gt;     }
&gt; 
&gt; This allows PKCS#1 signatures to include up to two arbitrary parameters in
&gt; the unpadded ASN.1 structure, instead of the required NULL. This is quite
&gt; bad, because it opens up a Beichenbacher-like attack: using the homomorphic
&gt; signature property of RSA, it is possible to build from one or more valid
&gt; signatures, more valid signatures for a different hash, or even for a
&gt; different hash function. Thus, the attack I described above is in fact
&gt; possible even against RSA-PKCS#1.
&gt; 
&gt; Even though we initially thought this was a new variant, it turns out that
&gt; it was in fact already described by Oiwa et al. in the GNUTLS-SA-2006-4
&gt; report. Instead of explaining how it works precisely, I urge you to read
&gt; section 5 of
&gt; <a rel="nofollow" href="https://www.cdc.informatik.tu-darmstadt.de/reports/reports/sigflaw.pdf">https://www.cdc.informatik.tu-darmstadt.de/reports/reports/sigflaw.pdf</a> which
&gt; provides an excellent description of a practical exploit against e=3
&gt; signatures. However, please note that we were able to create a proof of
&gt; concept even for a e=65537 signature. Let me know if you'd like me to attach
&gt; it for a test case - we confirmed that neither IE/schannel nor OpenSSL, nor
&gt; GnuTLS are vulnerable.</span >

Antoine, please attach it to this bug. Thanks!

When you say &quot;up to two arbitrary parameters,&quot; you actually mean one parameter of at most two arbitrary bytes, right?</pre></div><div class="change-set" id="c1"><div class="comment" data-id="9285530" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 17:55 PDT" data-time="1410224140">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9285530">* The related NSS bugs mentioned in the &quot;sigflaw.pdf&quot; paper were fixed in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - rsa signature verification ignores garbage bytes (CVE-2006-4340)"
   href="/show_bug.cgi?id=350640">bug 350640</a> and maybe others.

* The buggy parameters check that Antonio quoted above is present in both cryptohi/secvfy.c and softoken/pkcs11c.c.

* The buggy check was added in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a>, r=rrelyea, sr=wtc.

* In <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079#c12">bug 351079 comment 12</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079#c15">bug 351079 comment 15</a>, and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079#c29">bug 351079 comment 29</a>, Wan-Teh suggested that the check be strengthened to only allow the parameters to be the two-byte sequence { 0x05, 0x00 }, and maybe also allow empty. According to him, Microsoft's implementation allows/allowed both values, but { 0x05, 0x00 } is what is required by the PKCS#1.5 specification.

* The issue of the parameter validation being too weak is discussed extensively in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a>. We should consider this flaw to be well-known and likely to be exploited.</pre></div><div class="change-set" id="c2"><div class="comment" data-id="9285639" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" ><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" ><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 18:36 PDT" data-time="1410226604">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9285639">I'd suggest that, rather than parsing, the expected message is constructed and then compared (in constant-time) against the result for the decryption operation. The ASN.1 prefixed are constant for a given hash function (see <a rel="nofollow" href="https://boringssl.googlesource.com/boringssl/+/master/crypto/rsa/rsa.c#292">https://boringssl.googlesource.com/boringssl/+/master/crypto/rsa/rsa.c#292</a> for them).</pre></div><div class="change-set" id="c3"><div class="comment" data-id="9285651" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 18:46 PDT" data-time="1410227170">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9285651">(In reply to Adam Langley from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c2">comment #2</a>)
<span class="quote">&gt; I'd suggest that, rather than parsing, the expected message is constructed
&gt; and then compared (in constant-time) against the result for the decryption
&gt; operation. The ASN.1 prefixed are constant for a given hash function (see
&gt; <a rel="nofollow" href="https://boringssl.googlesource.com/boringssl/+/master/crypto/rsa/rsa.c#292">https://boringssl.googlesource.com/boringssl/+/master/crypto/rsa/rsa.c#292</a>
&gt; for them).</span >

I agree. I am currently doing some testing of the QuickDER DER parser, because I think I've found multiple issues within QuickDER that could potentially be exploited to similar effect. I will file separate bugs about those things, but for now, I recommend not relying on QuickDER for this.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="9285850" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 20:05 PDT" data-time="1410231943">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="9285850">I am going to make this bug specifically about being too permissive about the parameter value. I will clone this bug for the QuickDER issues.</pre><div class="activity"><div class="change">Summary: RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parsing &rarr; RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing</div></div></div><div class="change-set" id="a10266_14661"><div class="change" id="aa10266_14661">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a10266_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10266_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10266_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a10266_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 20:25 PDT" data-time="1410233130">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">CVE-2014-1569</a></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="9296432" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a10266_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-10 16:20 PDT" data-time="1410391214">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="9296432">[Tracking Requested - why for this release]: I'm assuming Antoine is correct when he says he has a working exploit for this. There is no way to patch this bug without making it obvious what the security problem is. That means as soon as the patch lands anywhere, it becomes zero-day-ish. I imagine that if this is exploitable, Chrome will be landing a fix for it pretty soon.

Adding NEEDINFO so that it is clear we're interested in getting Antoine's PoC for this when he has it ready.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=isnotempty">status-firefox32</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=isnotempty">status-firefox33</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=isnotempty">tracking-firefox33</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=isnotempty">tracking-firefox34</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=isnotempty">tracking-firefox35</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Flags: needinfo?(antoine)</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a></div></div></div><div class="change-set" id="c6"><div class="comment" data-id="9296606" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a10266_14661"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-10 16:54 PDT" data-time="1410393270">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="9296606">For my current PoC I cheated by using the private key of my own CA on the malformed PKCS#1 block to demonstrate the buggy behavior, but considering the nice freedom enabled by <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">Bug 1064670</a> for the length encoding (which is one of the annoying parts), I'll try to see if I can forge a real trusted malicious CA tomorrow. The paper I cited before explains precisely how to do it, but it's still a nice little crypto exercise. If you need a CA with public exponent 3 to give it a try you can search for &quot;WeakIntermediateRSAExponent&quot; on <a rel="nofollow" href="https://ca.ht.vc">https://ca.ht.vc</a></pre></div><div class="change-set" id="c7"><div class="comment" data-id="9299849" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a10266_14661"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 08:42 PDT" data-time="1410450126">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="9299849">Tracking for all channels including release. We are currently spinning a 32 chemspill. It would have been nice to have this fixed so that it could be included in 32.0.1. However, if we need to chemspill again, so be it.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox32&amp;o1=isnotempty">tracking-firefox32</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox32&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=isnotempty">tracking-firefox33</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=isnotempty">tracking-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=isnotempty">tracking-firefox35</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="9299887" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a10266_14661"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 08:49 PDT" data-time="1410450575">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="9299887">I don't think we need to chemspill for a non-public critical issue. This isn't a zero day. We should check a fix into everywhere late in the cycle (before last beta or two), like we often do.

I assume we need this on ESR31.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=33%2B">33+</a></div></div></div><div class="change-set" id="c9"><div class="comment" data-id="9300297" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a10266_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 10:08 PDT" data-time="1410455301">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="9300297">Note: I believe there 2 bytes were intentionally allowed because some software encoded a 2 byte '0' parameter instead of a NULL parameter. 2 bytes should not be enough to allow blechinbaucher. (the sited test was added specifically to prevent such an attach).

bob</pre></div><div class="change-set" id="c10"><div class="comment" data-id="9300313" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a10266_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 10:12 PDT" data-time="1410455528">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="9300313">Also note, blechinbaucher is only usable against rsa keys with an exponent of 3. I think we've flushed these from the public internet. If there is an exploit (which I doubt), it's still not a chemspill since it would only affect private CA systems with poorly constructed certs.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="9300355" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a10266_14661"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 10:20 PDT" data-time="1410456021">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="9300355">I wasn't able to forge a 2048 bit signature yet, but I was somewhat successful with 1024 bit.

I have a test server running on <a rel="nofollow" href="https://bad.ht.vc:666">https://bad.ht.vc:666</a> with the malicious CA certificate. Some notes:

- there's something PKIX doesn't like in this chain. I think it's a syntactic issue, if Brian can tell me what it is exactly I should be able to get it accepted on FF32. For now, I'm turning off security.use_mozillapkix_verification.

- There aren't that many 1024 bit CAs with e=3 that are still accepted. I picked a Starfield CA which I think got removed in FF32 (that proves the effort to get rid of old CAs is indeed very useful). You may have to re-import that root or downgrade to FF31 depending on your platform.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(antoine)</span></div></div></div><div class="change-set" id="c12"><div class="comment" data-id="9300366" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a10266_14661"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 10:22 PDT" data-time="1410456124">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="9300366">My coworker in Paris reported that on his OSX FF31 the certificate chain was accepted with no warning.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="9300464" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a10266_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 10:37 PDT" data-time="1410457079">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8488057"
         class="attachment"
         data-id="8488057" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="pmca.png">
      <meta itemprop="contentSize" content="20684">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8488057" itemprop="contentUrl">
        <span id="att-8488057-description" itemprop="description">Screen shot showing the accepted cert chain in Firefox 31</span></a>
        — <a href="attachment.cgi?id=8488057&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c14"><div class="comment" data-id="9300473" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a10266_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 10:39 PDT" data-time="1410457140">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8488061"
         class="attachment"
         data-id="8488061" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="antoine.delignat-lavaud.fr.pem">
      <meta itemprop="contentSize" content="5338">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8488061" itemprop="contentUrl">
        <span id="att-8488061-description" itemprop="description">Cert chain of test server (in PEM format)</span></a>
        — <a href="attachment.cgi?id=8488061&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c15"><div class="comment" data-id="9308435" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a10266_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-13 21:38 PDT" data-time="1410669497">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="9308435">(In reply to Antoine Delignat-Lavaud from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c11">comment #11</a>)
<span class="quote">&gt; I wasn't able to forge a 2048 bit signature yet, but I was somewhat
&gt; successful with 1024 bit.
&gt; 
&gt; I have a test server running on <a rel="nofollow" href="https://bad.ht.vc:666">https://bad.ht.vc:666</a> with the malicious CA
&gt; certificate. Some notes:
&gt; 
&gt; - there's something PKIX doesn't like in this chain. I think it's a
&gt; syntactic issue, if Brian can tell me what it is exactly I should be able to
&gt; get it accepted on FF32. For now, I'm turning off
&gt; security.use_mozillapkix_verification.</span >

mozilla::pkix doesn't like the fact that the root CA certificate is missing basicConstraints.cA == true. It is probably being too strict there and we should probably change that.

<span class="quote">&gt; - There aren't that many 1024 bit CAs with e=3 that are still accepted. I
&gt; picked a Starfield CA which I think got removed in FF32 (that proves the
&gt; effort to get rid of old CAs is indeed very useful). You may have to
&gt; re-import that root or downgrade to FF31 depending on your platform.</span >

In <a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=1054659">bug 1054659</a>, you mentioned that you also have a PoC for e=65537; is that correct?

Anyway, the test case is actually exploiting <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a>, not this bug (1064636). Still, it is much (!!!) appreciated!

(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c9">comment #9</a>)
<span class="quote">&gt; Note: I believe there 2 bytes were intentionally allowed because some
&gt; software encoded a 2 byte '0' parameter instead of a NULL parameter. 2 bytes
&gt; should not be enough to allow blechinbaucher. (the sited test was added
&gt; specifically to prevent such an attach).</span >

Antoine mentioned that he had a PoC that affects this bug, so if I understand his claim correctly, he was able to do it in two bytes (in fact, one byte, since the length byte has to be zero, I think).

(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c10">comment #10</a>)
<span class="quote">&gt; Also note, blechinbaucher is only usable against rsa keys with an exponent
&gt; of 3.</span >

Antoine said he had a PoC for e=65337 in the other bug.

I think we've flushed these from the public internet.

<span class="quote">&gt; If there is an
&gt; exploit (which I doubt), it's still not a chemspill since it would only
&gt; affect private CA systems with poorly constructed certs.</span >

See <a rel="nofollow" href="https://www.imperialviolet.org/2012/03/16/rsae.html">https://www.imperialviolet.org/2012/03/16/rsae.html</a>: &quot;Three should be fine, 2^16+1 saved some buggy software a couple of times and any larger is probably a mistake.&quot; In any case, the Mozilla packaged app system has a public key with e=3, and who knows how many sub-CA certificate and/or end-entity certificates have e=3 public keys?

Regardless of all that, and hopefully stating the obvious, we accept signatures with keys where e=3 so our implementation must be secure when e=3.</pre></div><div class="change-set" id="c16"><div class="comment" data-id="9309207" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a10266_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a10266_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-14 16:35 PDT" data-time="1410737759">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="9309207">(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c9">comment #9</a>)
<span class="quote">&gt; Note: I believe there 2 bytes were intentionally allowed because some
&gt; software encoded a 2 byte '0' parameter instead of a NULL parameter.</span >

With BoringSSL (which will be in Chrome for Android with Chrome 38 and Chrome on OS X with Chrome 39) I ripped out the ASN.1 parser in RSA signature verification and am matching exactly against the expected bytes. There are no reports of problems in the beta channel so far, at least.

Nearly a decade later this has become a very tiresome bug. I'm happy to spend a little of the breakage budget to ensure that we don't have to process ASN.1 in RSA verification.</pre></div><div class="change-set" id="a528285_14661"><div class="change" id="aa528285_14661">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a528285_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a528285_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a528285_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-14 20:19 PDT" data-time="1410751149">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">CVE-2014-1570</a></div></div></div><div class="change-set" id="c17"><div class="comment" data-id="9311823" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 09:37 PDT" data-time="1410799046">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="9311823"><span class="quote">&gt; Antoine mentioned that he had a PoC that affects this bug, so if I understand his claim correctly,
&gt; he was able to do it in two bytes (in fact, one byte, since the length byte has to be zero, I
&gt; think).</span >

That clearly changes how I would prioritize this bug.

<span class="quote">&gt; With BoringSSL (which will be in Chrome for Android with Chrome 38 and Chrome on OS X with Chrome
&gt; 39) I ripped out the ASN.1 parser in RSA signature verification and am matching exactly
&gt; against the expected bytes. There are no reports of problems in the beta channel so far, at least.</span >

That would work, but it requires hacking your RSA parser every time you add a new hash algorithm, though it does seem to indicate that our phantom empty versus null parameter issue may be fixed. Does the BoringSSL code process any other kinds of signatures than just certs and SSL client auth? I'm thinking S/MIME in particular.

bob</pre></div><div class="change-set" id="c18"><div class="comment" data-id="9312081" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a528285_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 10:19 PDT" data-time="1410801596">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="9312081">(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c17">comment #17</a>)
<span class="quote">&gt; That would work, but it requires hacking your RSA parser every time you add
&gt; a new hash algorithm</span >

That's probably true, but I think that's what PKCS#1 entails. (Alternatively you could thing of the ASN.1 prefix as the &quot;hash identifier&quot; and pass it into the RSA functions as an opaque lump of bytes. That might be a nicer design, but in practice I imagine that the APIs are pretty much nailed down and thus that's not possible.)

<span class="quote">&gt; though it does seem to indicate that our phantom empty
&gt; versus null parameter issue may be fixed. Does the BoringSSL code process
&gt; any other kinds of signatures than just certs and SSL client auth? I'm
&gt; thinking S/MIME in particular.</span >

Now that it's not the weekend I've remembered that we don't use that path in BoringSSL for certificate validation in Chrome on Android (we use the system certificate libraries so that the system-wide Android certificate UI applies to Chrome). Thus it's evidence that ServerKeyExchange signatures are safe to process strictly, but doesn't speak for certificates. For certificates, Go uses the same design and we've never received a report of a problem, but Go's usage is much more limited than a browser. None the less, I'm still very keen on solving this strictly. Anything less appears to be an invitation for more such problems in the future.

I've no evidence about S/MIME.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="9312193" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a528285_14661"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 10:34 PDT" data-time="1410802459">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="9312193">As Adam said, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a> should be considered two instances of the same bug, which is that a generale purpose ASN.1 parser is used with the template seq{seq{alg oid; params ANY;}; sig OSTR;}

The exploit for this bug that I considered doing (against the ANY params) was to use a zero-padded INT value, because for some reason the DER decoder will treat has having length 1. This is an existential forgery attack in the crypto sense, but to exploit, it requires a lot of cert hashes (but not a preimage!).

On the other hand, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a> is much nicer to exploit because it allows arbitrary byte injection instead of only zeros, and a 1024 bit CA can be produced with almost no effort as shown above. I think a very simple combination of 1064670 and 1064636 can be used to forge a 2048 bit CA at very little cost (no more than 2^40 cubings, but possibly less). If I feel like it, I may try to make one, as it allows for some nicer things (such as Extended Validation impersonation on the GoDaddy root). Or someone else can try it as an exercise.

Regardless, what matters is that you should avoid relying on the perfect DER adherence of your ASN.1 parser in particular if the template contains an ANY field. Thus, I urge you to follow Adam's suggestion of using static concatenation for signature blocks, even though you may need to consider 3 possible cases for the parameters field.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="9312484" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 11:29 PDT" data-time="1410805767">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="9312484"><span class="quote">&gt; That's probably true, but I think that's what PKCS#1 entails. 
&gt; (Alternatively you could thing of the ASN.1 prefix as the &quot;hash identifier&quot; and pass it into the
&gt; RSA functions as an opaque lump of bytes. That might be a nicer design, but in practice I imagine
&gt; that the APIs are pretty much nailed down and thus that's not possible.)</span >

Actually, NSS decodes the PKCS #1 value to determine what hash algorithm to use. There is an API to pass a value in. If no value is passed, NSS uses the hash value pulled from the signature. If a hash value is passed, it verifies that the hashes match, so we are unlikely to be able to blindly use the trick of not decoding the value.

<span class="quote">&gt; Regardless, what matters is that you should avoid relying on the perfect DER adherence of your
&gt; ASN.1 parser in particular if the template contains an ANY field. Thus, I urge you to follow 
&gt; Adam's suggestion of using static concatenation for signature blocks, even though you may need to
&gt; consider 3 possible cases for the parameters field.</span >

To make sure I understand what you are saying... It's the matching of the any field in the template for the parameter, not really the fact we are using a DER decoder. I'm fine with checking that field specifically. I don't think we can just handle hard-coded bytes for the pkcs #1 code without making a real hash of things (and making it harder to support in the future).

The critical thing for me is that we can handle parsing the hash oid without rewriting the code when we need to add, say SHA-3.

Clearly we do have to completely tighten up what the parameters look like, and only accept the minimum possible to maintain compatibility.

bob</pre></div><div class="change-set" id="c21"><div class="comment" data-id="9312560" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a528285_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 11:45 PDT" data-time="1410806701">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="9312560">(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c20">comment #20</a>)
<span class="quote">&gt; The critical thing for me is that we can handle parsing the hash oid without
&gt; rewriting the code when we need to add, say SHA-3.</span >

Given the constraints that you outline I think the following might be reasonable:

1) Parse the ASN.1 with anything, including the current code, to get the hash function used.

2) Reserialise the expected ASN.1 (not necessarily using a full ASN.1 stack - once you have the DER serialisation of the OID, the rest is very simple). Perhaps serialise two or three versions if you think that we need to cope with buggy signatures.

3) Compare the data against the serialised versions exactly.

Thankfully, since this is signature validation, constant-time considerations don't come into play.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="9312576" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 11:48 PDT" data-time="1410806904">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="9312576">(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c20">comment #20</a>)
<span class="quote">&gt; Actually, NSS decodes the PKCS #1 value to determine what hash algorithm to
&gt; use. There is an API to pass a value in. If no value is passed, NSS uses the
&gt; hash value pulled from the signature. If a hash value is passed, it verifies
&gt; that the hashes match, so we are unlikely to be able to blindly use the
&gt; trick of not decoding the value.</span >

Last night, I spent some time working on a patch for this issue, and I also discovered that (mis-)feature in secvfy.c. It seems the PKCS#1 specification also mandates that behavior when you don't pass in a mechanism that identifies the hash algorithm?

In any case, I intend to post a patch that fixes the issue for the case where the caller did supply the hash algorithm, because that is what the certificate verification and ServerKeyExchange processing code does. On top of that, we can build a patch that handles the unknown-hash-algorithm case.


<span class="quote">&gt; I don't think we can just handle hard-coded bytes for the pkcs #1 code without
&gt; making a real hash of things (and making it harder to support in the future).
&gt; 
&gt; The critical thing for me is that we can handle parsing the hash oid without
&gt; rewriting the code when we need to add, say SHA-3.</span >

The way I am doing things requires the addition of 5 lines of code for each new algorithm, in one function:

    static const PKCS1DigestInfoInfo SHA1_PREFIX = {
        SHA1_LENGTH, 15, { 0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2b, 0x0e,
                           0x03, 0x02, 0x1a, 0x05, 0x00, 0x04, 0x14 }
    }; 

    [...]

    case SEC_OID_SHA1: dii = &amp;SHA1_PREFIX; break;

I think this is a reasonable cost. Also, I don't think we should worry two much about future SHA-3 support now, given that this is quite a serious issue affecting us in the present.

<span class="quote">&gt; Clearly we do have to completely tighten up what the parameters look like,
&gt; and only accept the minimum possible to maintain compatibility.</span >

In the case of Firefox and Chrome, it seems like it will be difficult to get a good sense of the compatibility impact within the timeframe in which those two products should fix this bug. A conservative approach, in terms of compatibility risk, would be to allow the parameter field to be either exactly { 0x05, 0x00 } or empty, and then tighten that up later. Does anybody see that being problematic?</pre></div><div class="change-set" id="c23"><div class="comment" data-id="9312595" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 11:52 PDT" data-time="1410807120">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="9312595">(In reply to Adam Langley from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c21">comment #21</a>)
<span class="quote">&gt; 1) Parse the ASN.1 with anything, including the current code, to get the
&gt; hash function used.
&gt; 
&gt; 2) Reserialise the expected ASN.1 (not necessarily using a full ASN.1 stack
&gt; - once you have the DER serialisation of the OID, the rest is very simple).
&gt; Perhaps serialise two or three versions if you think that we need to cope
&gt; with buggy signatures.
&gt; 
&gt; 3) Compare the data against the serialised versions exactly.</span >

Once you do #1 to get the SECOidTag, the function can simply call itself recursively with that SECOidTag, which avoids needing to reserialize anything while still doing the bytewise comparison.

In contrast to the BoringSSL code, in order to support the &quot;no parameters&quot; and &quot;NULL parameters&quot; cases, you need to maintain two prefixes for each algorithm, and check for both, instead of just one. This isn't a significant complication, though.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="9312656" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 12:08 PDT" data-time="1410808119">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="9312656">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c23">comment #23</a>)
<span class="quote">&gt; (In reply to Adam Langley from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c21">comment #21</a>)
&gt; &gt; 1) Parse the ASN.1 with anything, including the current code, to get the
&gt; &gt; hash function used.
&gt; &gt; 
&gt; &gt; 2) Reserialise the expected ASN.1 (not necessarily using a full ASN.1 stack
&gt; &gt; - once you have the DER serialisation of the OID, the rest is very simple).
&gt; &gt; Perhaps serialise two or three versions if you think that we need to cope
&gt; &gt; with buggy signatures.
&gt; &gt; 
&gt; &gt; 3) Compare the data against the serialised versions exactly.
&gt; 
&gt; Once you do #1 to get the SECOidTag, the function can simply call itself
&gt; recursively with that SECOidTag, which avoids needing to reserialize
&gt; anything while still doing the bytewise comparison.</span >

Actually, one does not need to use the ASN.1 decoder at all, with the current set of supported digest algorithms, because the encoded length byte [the second byte in the prefix] is a unique selector.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="9314999" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-15 23:02 PDT" data-time="1410847352">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="9314999">In Firefox 33 and later, mozilla::pkix accepts a short whitelist of algorithm identifiers OIDs for the signatureAlgorithms field of certificates and for the similar field for OCSP responses. (mozilla::pkix doesn't even bother with CRLs at all.) Because this version hasn't hit the release channel yet, the compatibility impact of Firefox 33's short whitelist will have.

In contrast, NSS's certificate verification logic accepts a much wider set of OIDs in these fields, including in particular OIDS that identify only public key algorithms without identifying the digest algorithm. In those cases, NSS's CERT_VerifySignedDataWithPublicKey function (which is what is used to verify the signatures of certificates and OCSP responses in NSS) will trust the algorithm of the DigestInfo within the PKCS#1 signature.

I recommend that people closely study the current code for the CERT_VerifySignedDataWithPublicKey, NSS_GetAlgorithmPolicy and VFY_VerifyDataWithAlgorithmID (called by CERT_VerifySignedDataWithPublicKey), and sec_DecodeSigAlg (called by VFY_VerifyDataWithAlgorithmID), as all of that code affects non-mozilla::pkix certificate/OCSP/CRL signature verification. In particular, things that rely on NSS's built-in certificate stuff will be dependent on the SEC_OID_UNKNOWN logic mentioned in comments 21 through <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c24">comment 24</a> above. I have written a patch (that I still need to test) that tries to minimize the risk there.

You can see the short whitelist of AlgorithmIdentifier values that Firefox 33's mozilla::pkix accepts at:
<a rel="nofollow" href="https://mxr.mozilla.org/mozilla-central/source/security/pkix/include/pkix/pkixtypes.h?rev=a4a8b3b58191#42">https://mxr.mozilla.org/mozilla-central/source/security/pkix/include/pkix/pkixtypes.h?rev=a4a8b3b58191#42</a>. Also note that mozilla::pkix requires that the parameters field of the signatureAlgorithm field be exactly { 0x05, 00 } or empty, whereas sec_DecodeSigAlg does do quite a bit of parsing of other values of that field.

I recommend that people start evaluating the compatibility impact of adopting Firefox 33's mozilla::pkix's stricter approach by compiling statistics on the counts of the distinct values of signatureAlgorithm in certificates (e.g. using the various CT databases). If that shorter whitelist works, then NSS's certificate verification logic can (eventually) be changed to avoid the SEC_OID_UNKNOWN nastiness too.</pre></div><div class="change-set" id="c26"><div class="comment" data-id="9318490" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 11:39 PDT" data-time="1410892791">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="9318490">$ certutil -d .. -N
$ certutil -d .. -A -n valicert -t &quot;C,C,C&quot; -i /c/p/fr/cert3.der

Before patch:
$ vfychain -d .. -u 1 -pp cert0.der cert1.der cert2.der
Chain is good!

After patch:
$ vfychain -d .. -u 1 -pp cert0.der cert1.der cert2.der
Chain is bad!
PROBLEM WITH THE CERT CHAIN:
CERT 3. valicert [Certificate Authority]:
  ERROR -8182: Peer's certificate has an invalid signature.

Note that using vfychain's &quot;-t cert3.der&quot; argument to temporarily trust the valicert root does not work due to <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - libpkix (vfychain) enforces that basicConstraints.cA==true for trust anchors added using cert_pi_trustAnchors (-t), but not for other trust anchors"
   href="/show_bug.cgi?id=1068182">bug 1068182</a>.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="9318713" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 12:12 PDT" data-time="1410894751">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490266"
         class="attachment"
         data-id="8490266" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="DottedOIDToCode.py">
      <meta itemprop="contentSize" content="8571">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8490266" itemprop="contentUrl">
        <span id="att-8490266-description" itemprop="description">script to generate prefixes: python DottedOIDToCode.py --dii foo bar</span></a>
        — <a href="attachment.cgi?id=8490266&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-27" data-comment-id="9318713">I hacked together a code generator for the prefixes to make sure there would be no typos, based on the mozilla::pkix code generator for OIDs. You can run it like so:

$ python DottedOIDToCode.py --dii foo bar

(The &quot;foo&quot; and &quot;bar&quot; arguments are ignored; I just didn't feel like modifying the script's argument parsing.)

Note that I reformatted the code and removed the &quot;tag&quot; field after I generated it.</pre></div><div class="change-set" id="c28"><div class="comment" data-id="9318804" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a528285_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 12:27 PDT" data-time="1410895636">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="9318804">Here's the breakdown of the signature algorithm from the certificates in the CT log.

The first column is the hex encoded, DER of the signature algorithm. The second is what OpenSSL calls it (this is not unique - several DER strings may map to the same name) and the last column is the count.

There was no filtering for unexpired certificates, although I can do that if needed.

300d06092a864886f70d0101020500  :md2WithRSAEncryption           1
300b06092a864886f70d01010b      :sha256WithRSAEncryption        2
300b06092a864886f70d010105      :sha1WithRSAEncryption          1
300d06092a864886f70d01010c0500  :sha384WithRSAEncryption        20
300a06082a8648ce3d040303        :ecdsa-with-SHA384              20
300a06082a8648ce3d040302        :ecdsa-with-SHA256              97
300d06092a864886f70d0101040500  :md5WithRSAEncryption           6512
300d06092a864886f70d01010d0500  :sha512WithRSAEncryption        7715
300d06092a864886f70d01010b0500  :sha256WithRSAEncryption        483338
300d06092a864886f70d0101050500  :sha1WithRSAEncryption          4498605</pre></div><div class="change-set" id="c29"><div class="comment" data-id="9318857" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 12:38 PDT" data-time="1410896282">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490281"
         class="attachment patch obsolete"
         data-id="8490281" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-1.patch">
      <meta itemprop="contentSize" content="9442">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490281">
          <a class="link" href="attachment.cgi?id=8490281&amp;action=diff">
        <span id="att-8490281-description" itemprop="description">Part 1: Implement new PKCS#1 padding checking logic</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490281&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490281">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-29" data-comment-id="9318857">Note: I have not yet tested the unsafeAllowMissingParameters==true case, and in general I haven't tested this a lot. I'm posting it before I've written all the tests to expedite the feedback process.

This code lives in libnssutil3 instead of libnss3 because it needs to be shared by the VFY_* functions and softoken's PKCS#1 mechanism implementation.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490281&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490281</a> -
        Flags: review?(agl)</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="9318888" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 12:42 PDT" data-time="1410896521">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490283"
         class="attachment patch obsolete"
         data-id="8490283" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-2.patch">
      <meta itemprop="contentSize" content="9331">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490283">
          <a class="link" href="attachment.cgi?id=8490283&amp;action=diff">
        <span id="att-8490283-description" itemprop="description">Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490283&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490283">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-30" data-comment-id="9318888">This modifies the VFY_* functions to use the new padding checking logic.

Note in particular that when the caller supplies the digest algorithm (which is always the case for the verification of ServerKeyExchange signatures, and is usually the case for certificate signatures), we don't invoke SGN_DecodeDigestInfo (the DER decoder for the DigestInfo) at all. Originally, I was planning to replace the use of SGN_DecodeDigestInfo with much simpler logic like I mentioned in earlier comments. I've already written that logic, but in the interests of reducing the scope of the change to the minimum necssary, I decided not to do that. Also, a better strategy for dealing with that problem is to stop calling the VFY_* functions with SEC_OID_UNKNOWN as the digest algorithm.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490283&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490283</a> -
        Flags: review?(agl)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="9318918" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 12:47 PDT" data-time="1410896837">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490288"
         class="attachment patch obsolete"
         data-id="8490288" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-3.patch">
      <meta itemprop="contentSize" content="3695">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490288">
          <a class="link" href="attachment.cgi?id=8490288&amp;action=diff">
        <span id="att-8490288-description" itemprop="description">Part 3: Change softoken to use the new PKCS#1 padding verification logic</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490288&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490288">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-31" data-comment-id="9318918">Note that this patch is completely untested, AFAICT.

Note that certificate verification and ServerKeyExchange verification do not use this logic; instead, they use the VFY_* functions that were patched in part 2. So, for web browsers, part 3 is less critical than part 2.

It seems to be the case that all certificate-related signature verification goes through the function CERT_VerifySignedDataWithPublicKey, which calls VFY_VerifyDataWithAlgorithmID, which is affected by part 2. It seems all PKCS#1 ServerKeyExchange signature verification goes through ssl3_VerifySignedHashes, which uses VFY_VerifyDigestDirect. (Incidentally, the logic in ssl3_VerifySignedHashes is not as clear as I would like; I've also written some patches to clean it up, which I will attach to another bug. Those patches don't have any bearing on these security issues though.)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490288&amp;action=edit"
           title="Part 3: Change softoken to use the new PKCS#1 padding verification logic"
           class=""
        >Attachment #8490288</a> -
        Flags: review?(agl)</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="9319061" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 13:08 PDT" data-time="1410898132">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="9319061">I see that recently NSS integrated GTest so that we can write GTests within NSS's test suite. I will adapt my tests to work with NSS's test suite and post them as well.</pre></div><div class="change-set" id="c33"><div class="comment" data-id="9319345" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a528285_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 13:49 PDT" data-time="1410900565">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="9319345">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490281" name="attach_8490281" title="Part 1: Implement new PKCS#1 padding checking logic">attachment 8490281</a> <a href="/attachment.cgi?id=8490281&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490281&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490281'>[review]</a>
Part 1: Implement new PKCS#1 padding checking logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490281" name="attach_8490281" title="Part 1: Implement new PKCS#1 padding checking logic">attachment 8490281</a> <a href="/attachment.cgi?id=8490281&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490281&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490281'>[review]</a>:
-----------------------------------------------------------------

::: lib/util/manifest.mn
&#64;&#64; +58,5 &#64;&#64;
<span class="quote">&gt;  	nssb64e.c \
&gt;  	nssrwlk.c \
&gt;  	nssilock.c \
&gt;  	oidstring.c \
&gt; +  pkcs1sig.c \</span >

(nit: indentation.)

::: lib/util/pkcs1sig.c
&#64;&#64; +107,5 &#64;&#64;
<span class="quote">&gt; +  const PKCS1DigestInfoInfo* dii;
&gt; +  const Prefix* prefix;
&gt; +
&gt; +  if (!digest || !digest-&gt;data ||
&gt; +      !dataRecoveredFromSignature || !dataRecoveredFromSignature-&gt;data)</span >

Something is wrong here - missing if body?

&#64;&#64; +127,5 &#64;&#64;
<span class="quote">&gt; +    return SECFailure;
&gt; +  }
&gt; +
&gt; +  /* We don't attempt to avoid timing attacks on these comparisons because
&gt; +   * signature verification is a public key operation, not a private key=</span >

remove = from end.

::: lib/util/pkcs1sig.h
&#64;&#64; +38,5 &#64;&#64;
<span class="quote">&gt; +#define SGN_PKCS1_DIGESTINFO_LENGTH_MAX \
&gt; +        (SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX + HASH_LENGTH_MAX)
&gt; +
&gt; +/* dataRecoveredFromSignature must be the result of calling PK11_VerifyRecover
&gt; + * or equivalent. SECUTIL_VerifyPKCS1Digest verifies that the length of the</span >

The first sentence should probably not be first.

The comment mentions SECUTIL_VerifyPKCS1Digest, but the function is SGN_VerifyPKCS1DigestInfo.</pre></div><div class="change-set" id="c34"><div class="comment" data-id="9319428" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a528285_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 14:00 PDT" data-time="1410901247">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="9319428">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490283" name="attach_8490283" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">attachment 8490283</a> <a href="/attachment.cgi?id=8490283&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490283&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490283'>[review]</a>
Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490283" name="attach_8490283" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">attachment 8490283</a> <a href="/attachment.cgi?id=8490283&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490283&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490283'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/secvfy.c
&#64;&#64; +114,5 &#64;&#64;
<span class="quote">&gt; +static SECStatus
&gt; +verifyPKCS1DigestInfo(const VFYContext* cx, const SECItem* digest)
&gt; +{
&gt; +  SECItem pkcs1DigestInfo;
&gt; +  pkcs1DigestInfo.data = (PRUint8*) cx-&gt;u.buffer;</span >

why reference it as |buffer|? Wouldn't |pkcs1DigestInfo| be clearer here?

&#64;&#64; +385,5 &#64;&#64;
<span class="quote">&gt;      if (sig) {
&gt;  	switch (type) {
&gt;  	case rsaKey:
&gt; +	    rv = recoverPKCS1DigestInfo(hashAlg, &amp;cx-&gt;hashAlg,
&gt; +					cx-&gt;u.buffer,</span >

ditto here.

&#64;&#64; +559,5 &#64;&#64;
<span class="quote">&gt;  	if (sig) {
&gt; +	    PORT_Assert(cx-&gt;hashAlg != SEC_OID_UNKNOWN);
&gt; +	    SECOidTag hashid;
&gt; +	    rv = recoverPKCS1DigestInfo(cx-&gt;hashAlg, &amp;hashid,
&gt; +					cx-&gt;u.buffer,</span >

ditto.</pre></div><div class="change-set" id="c35"><div class="comment" data-id="9319456" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a528285_14661"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 14:05 PDT" data-time="1410901539">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="9319456">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490288" name="attach_8490288" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">attachment 8490288</a> <a href="/attachment.cgi?id=8490288&amp;action=edit" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[details]</a> <a href="/attachment.cgi?id=8490288&amp;action=diff" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490288'>[review]</a>
Part 3: Change softoken to use the new PKCS#1 padding verification logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490288" name="attach_8490288" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">attachment 8490288</a> <a href="/attachment.cgi?id=8490288&amp;action=edit" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[details]</a> <a href="/attachment.cgi?id=8490288&amp;action=diff" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490288'>[review]</a>:
-----------------------------------------------------------------

LGTM modulo &quot;XXX&quot; comment, which is not clearly intended for landing.</pre></div><div class="change-set" id="c36"><div class="comment" data-id="9319514" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 14:17 PDT" data-time="1410902247">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490369"
         class="attachment patch obsolete"
         data-id="8490369" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-1.patch">
      <meta itemprop="contentSize" content="9529">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490369">
          <a class="link" href="attachment.cgi?id=8490369&amp;action=diff">
        <span id="att-8490369-description" itemprop="description">Part 1: Implement new PKCS#1 padding checking logic [v2]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490369&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490369">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="9319514">Sorry; I didn't squash all the commits to that file together before exporting it.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490281&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490281</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8490281&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490281</a> -
        Flags: <span class="activity-deleted">review?(agl)</span></div><div class="change">
        <a href="/attachment.cgi?id=8490369&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v2]"
           class=""
        >Attachment #8490369</a> -
        Flags: review?(agl)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="9319534" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 14:21 PDT" data-time="1410902496">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490376"
         class="attachment patch obsolete"
         data-id="8490376" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-1.patch">
      <meta itemprop="contentSize" content="9537">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490376">
          <a class="link" href="attachment.cgi?id=8490376&amp;action=diff">
        <span id="att-8490376-description" itemprop="description">Part 1: Implement new PKCS#1 padding checking logic [v3]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490376&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490376">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490369&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v2]"
           class=""
        >Attachment #8490369</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8490369&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v2]"
           class=""
        >Attachment #8490369</a> -
        Flags: <span class="activity-deleted">review?(agl)</span></div><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: review?(rrelyea)</div><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: review?(agl)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="9319549" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 14:23 PDT" data-time="1410902632">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="9319549">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490283" name="attach_8490283" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">attachment 8490283</a> <a href="/attachment.cgi?id=8490283&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490283&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490283'>[review]</a>
Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490283" name="attach_8490283" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">attachment 8490283</a> <a href="/attachment.cgi?id=8490283&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490283&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490283'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/secvfy.c
&#64;&#64; +114,5 &#64;&#64;
<span class="quote">&gt; +static SECStatus
&gt; +verifyPKCS1DigestInfo(const VFYContext* cx, const SECItem* digest)
&gt; +{
&gt; +  SECItem pkcs1DigestInfo;
&gt; +  pkcs1DigestInfo.data = (PRUint8*) cx-&gt;u.buffer;</span >

I agree that referencing it as |buffer| is worse, but then it would be inconsistent with the rest of the code, and also there is this comment in the code:

    /*
     * This buffer holds either the digest or the full signature
     * depending on the type of the signature (key-&gt;keyType).  It is
     * defined as a union to make sure it always has enough space.
     *
     * Use the &quot;buffer&quot; union member to reference the buffer.
     * Note: do not take the size of the &quot;buffer&quot; union member.  Take
     * the size of the union or some other union member instead.
     */

I am happy to change it to pkcs1DigestInfo. Let's see what Bob says.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490283&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490283</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="9319561" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 14:27 PDT" data-time="1410902828">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="9319561">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490288" name="attach_8490288" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">attachment 8490288</a> <a href="/attachment.cgi?id=8490288&amp;action=edit" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[details]</a> <a href="/attachment.cgi?id=8490288&amp;action=diff" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490288'>[review]</a>
Part 3: Change softoken to use the new PKCS#1 padding verification logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490288" name="attach_8490288" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">attachment 8490288</a> <a href="/attachment.cgi?id=8490288&amp;action=edit" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[details]</a> <a href="/attachment.cgi?id=8490288&amp;action=diff" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490288'>[review]</a>:
-----------------------------------------------------------------

Adam, are you concerned that the /*XXX: unsafeAllowMissingParameters*/ comments will reveal too much what we are fixing? Do you want me to strip them out? Note that the same comment appears in part 2 (VFY_*) and &quot;unsafeAllowMissingParameters&quot; is also the name of the parameter in part 1. I can remove the comments if people think it is too revealing to people who are watching us check stuff in, but otherwise I think the comments are helpful.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490288&amp;action=edit"
           title="Part 3: Change softoken to use the new PKCS#1 padding verification logic"
           class=""
        >Attachment #8490288</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="9320105" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 16:24 PDT" data-time="1410909886">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="9320105">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490376" name="attach_8490376" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">attachment 8490376</a> <a href="/attachment.cgi?id=8490376&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[details]</a> <a href="/attachment.cgi?id=8490376&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490376'>[review]</a>
Part 1: Implement new PKCS#1 padding checking logic [v3]

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490376" name="attach_8490376" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">attachment 8490376</a> <a href="/attachment.cgi?id=8490376&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[details]</a> <a href="/attachment.cgi?id=8490376&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490376'>[review]</a>:
-----------------------------------------------------------------

This is pretty much what I said we shouldn't do.

I'm OK with not using the decoder, but this code should work on new hash oids without us having to hack it when we add new hash algorithms. NSS is carefully constructed to minimize the places you need to change to ad new hash oids.....

So there are two choices: 1) use the quick decoder with a very tight template, or 2) use the encoder (or hand encode if you want) to construct the expected header on the fly using the hash oid. (you may have to add hash_len to your verify function).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: review?(rrelyea) &rarr; review-</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="9320148" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 16:30 PDT" data-time="1410910245">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="9320148"><span class="quote">&gt; Last night, I spent some time working on a patch for this issue, and I also discovered that 
&gt; (mis-)feature in secvfy.c. It seems the PKCS#1 specification also mandates that behavior when you
&gt; don't pass in a mechanism that identifies the hash algorithm?</span >

Not only does it have this feature, much of the code and parts of mozilla depend on it. I actually pointed this out in my comments above. That's one reason you can't just compare the blobs.

<span class="quote">&gt; 3) Compare the data against the serialised versions exactly.</span >

I'm OK with this as long as the serialized versions are generated dynamically (that is the function doesn't have explicit knowledge of the various hash algorithms built in).</pre></div><div class="change-set" id="c42"><div class="comment" data-id="9320153" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 16:31 PDT" data-time="1410910272">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="9320153">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490283" name="attach_8490283" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">attachment 8490283</a> <a href="/attachment.cgi?id=8490283&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490283&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490283'>[review]</a>
Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490283" name="attach_8490283" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">attachment 8490283</a> <a href="/attachment.cgi?id=8490283&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490283&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490283'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/secvfy.c
&#64;&#64; +24,5 &#64;&#64;
<span class="quote">&gt; +** Otherwise, parse the DigestInfo structure and store the decoded digest
&gt; +** algorithm into digestAlgOut.
&gt; +**
&gt; +** Store the encoded DigestInfo into digestInfo.
&gt; +** Store the DigestInfo length into digestInfoLen.</span >

It seems to me a better semantic is to always parst the DigestInfo and if givenDigestAlg isn't SEC_OID_UNKNOWN and doesn't match we should fail immediately.

It's not a bug and I won't force this semantic, but it makes error correctness analysis simplier.

&#64;&#64; +48,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +    digestInfoItem.data = digestInfo;
&gt; +    digestInfoItem.len = maxDigestInfoLen;</span >

A comment here warning that maxDigestInfoLen is not the same as maxDigestLen

&#64;&#64; +59,4 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (givenDigestAlg != SEC_OID_UNKNOWN) {
&gt; +        *digestAlgOut = givenDigestAlg;
&gt; +        return SECSuccess;</span >

This obviously is where you would implement my suggestion.

&#64;&#64; +114,5 &#64;&#64;
<span class="quote">&gt; +static SECStatus
&gt; +verifyPKCS1DigestInfo(const VFYContext* cx, const SECItem* digest)
&gt; +{
&gt; +  SECItem pkcs1DigestInfo;
&gt; +  pkcs1DigestInfo.data = (PRUint8*) cx-&gt;u.buffer;</span >

In this case, we know we are dealing with and RSA signature (PKCS1 is only RSA), so referencing the RSA specific value is probably correct, independent of the rest of the code. (e.i. you don't have to make a global change to the file's use of buffer). Note below we are using the pkcs1DigestInfoLen field, not some generic length, so using pkcs1DigestInfo would be consistent.

&#64;&#64; +385,5 &#64;&#64;
<span class="quote">&gt;      if (sig) {
&gt;  	switch (type) {
&gt;  	case rsaKey:
&gt; +	    rv = recoverPKCS1DigestInfo(hashAlg, &amp;cx-&gt;hashAlg,
&gt; +					cx-&gt;u.buffer,</span >

This function isn't as clear cut. The function is key independent (though the code block is key dependent). I could go either way on this one.</pre></div><div class="change-set" id="c43"><div class="comment" data-id="9320157" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 16:32 PDT" data-time="1410910357">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="9320157">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490288" name="attach_8490288" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">attachment 8490288</a> <a href="/attachment.cgi?id=8490288&amp;action=edit" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[details]</a> <a href="/attachment.cgi?id=8490288&amp;action=diff" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490288'>[review]</a>
Part 3: Change softoken to use the new PKCS#1 padding verification logic

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490288" name="attach_8490288" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">attachment 8490288</a> <a href="/attachment.cgi?id=8490288&amp;action=edit" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[details]</a> <a href="/attachment.cgi?id=8490288&amp;action=diff" title="Part 3: Change softoken to use the new PKCS#1 padding verification logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490288'>[review]</a>:
-----------------------------------------------------------------

Assuming changes to the SGN_VerifyPKCS1 API isn't necessary do to my other review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490288&amp;action=edit"
           title="Part 3: Change softoken to use the new PKCS#1 padding verification logic"
           class=""
        >Attachment #8490288</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="9320251" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 17:02 PDT" data-time="1410912143">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="9320251">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490376" name="attach_8490376" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">attachment 8490376</a> <a href="/attachment.cgi?id=8490376&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[details]</a> <a href="/attachment.cgi?id=8490376&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490376'>[review]</a>
Part 1: Implement new PKCS#1 padding checking logic [v3]

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490376" name="attach_8490376" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">attachment 8490376</a> <a href="/attachment.cgi?id=8490376&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[details]</a> <a href="/attachment.cgi?id=8490376&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490376'>[review]</a>:
-----------------------------------------------------------------

Hi Bob. Thanks for the quick review turnaround time!

(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c40">comment #40</a>)
<span class="quote">&gt; I'm OK with not using the decoder, but this code should work on new hash
&gt; oids without us having to hack it when we add new hash algorithms. NSS is
&gt; carefully constructed to minimize the places you need to change to ad new
&gt; hash oids.....</span >

NSS requires several files to be changed to add a new hash algorithm. See this bug, which added SHA-224 support, and in particular notice how many files had to be changed and how many patches (not just in that bug, but in other bugs) were required:
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - SHA224 hash / hmac algorithm not supported"
   href="/show_bug.cgi?id=356713#c12">https://bugzilla.mozilla.org/show_bug.cgi?id=356713#c12</a>.

You are right that so far in NSS, the OID bytes are only encoded in secoid.c. But, it seems like maintaining that as an invariant is optimizing for the wrong thing. This issue is exploitable precisely because the DER decoder has a serious bug in it (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a>, and previously <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - rsa signature verification ignores garbage bytes (CVE-2006-4340)"
   href="/show_bug.cgi?id=350640">bug 350640</a>); I think it clear by now that using the DER decoder for this is not prudent.

<span class="quote">&gt; 2) use the encoder (or hand encode if you want) to construct
&gt; the expected header on the fly using the hash oid. (you may have to add
&gt; hash_len to your verify function).</span >

This would be more complicated and more error-prone, especially given the previously-stated requirement that we have to encoded the DigestInfo in two different ways, to account for implementations that omit the NULL parameter. Also, note that the data that this patch is based on *is* the result of a DER encoder.

I respectfully maintain that the way I've coded this is better than the alternatives suggested insofar in that it is an incredibly safe and low-risk approach. I think it would be a mistake to change to a different approach. And, I definitely don't think the code I've written is so terrible that it deserves to be rewritten, especially considering the circumstances. In particular, this is a time-sensitive matter for a huge vulnerability in many, many products. Mozilla and Google and Red Hat are going to need to invest a substantial amount of effort doing compatibility testing in the next few days/weeks as the fix for this bug gets rushed out. The more the fixing of this bug is delayed, the more risk it adds to all your products.

This bug was reported over a a week ago, and we've had the forged certificate PoC for almost a week already. I think that, even if my approach is not perfect in terms of future potential maintenance, it is good to at least fix it in this simple, clearly-correct way, low-risk manner, and *already-written* manner while we debate cleaner approaches to improve future maintainability for SHA-3 and other things in parallel.

So, I respectively request that you reconsider your review. Thanks!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: review?(wtc)</div><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="9320437" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 17:40 PDT" data-time="1410914418">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="9320437"><span class="quote">&gt; You are right that so far in NSS, the OID bytes are only encoded in secoid.c. But, it seems like
&gt;  maintaining that as an invariant is optimizing for the wrong thing.</span >

Nope, it's a basic requirement. I'm the one who has to deal with the fall out. I've been working to reduce the number of places we have to touch... not increase them. A patch that doesn't meet that requirement is a no go into NSS. period.

<span class="quote">&gt; This issue is exploitable precisely because the DER decoder has a serious bug in it 
&gt; (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a>, and previously <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - rsa signature verification ignores garbage bytes (CVE-2006-4340)"
   href="/show_bug.cgi?id=350640">bug 350640</a>); I think it clear by now that 
&gt; using the DER decoder for this is not prudent.</span >

You can still tighten the code up by doing what I suggest in option 2. It is not complicated, I'm even ok if you want to code it by hand (it's not difficult DER). The code should be simple enough to easily verify that it's correct, and you'll know it's wrong instantly. The multiple hardcoded values are a total hack, and not maintainable in the future.

I'm fine with the rest of the patch, please do not cut corners on this last piece.

bob</pre></div><div class="change-set" id="c46"><div class="comment" data-id="9320448" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 17:42 PDT" data-time="1410914556">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="9320448">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490376" name="attach_8490376" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">attachment 8490376</a> <a href="/attachment.cgi?id=8490376&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[details]</a> <a href="/attachment.cgi?id=8490376&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic [v3]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490376'>[review]</a>
Part 1: Implement new PKCS#1 padding checking logic [v3]

r- don't try to go around me on this either. What I've asked for is not difficult to code.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: <span class="activity-deleted">review?(rrelyea)</span></div><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: review-</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="9320452" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 17:44 PDT" data-time="1410914687">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="9320452">I think it would be good for somebody else to work on this bug.</pre></div><div class="change-set" id="c48"><div class="comment" data-id="9320588" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a528285_14661"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 18:28 PDT" data-time="1410917333">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490498"
         class="attachment"
         data-id="8490498" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="build_hash.c">
      <meta itemprop="contentSize" content="3059">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8490498" itemprop="contentUrl">
        <span id="att-8490498-description" itemprop="description">build_hash.c</span></a>
        — <a href="attachment.cgi?id=8490498&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-48" data-comment-id="9320588">here's what I was thinking.
(not tested, once you include it, you could probably optimize away a bunch of unnecessary structs).</pre></div><div class="change-set" id="c49"><div class="comment" data-id="9320861" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 20:15 PDT" data-time="1410923726">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490536"
         class="attachment patch obsolete"
         data-id="8490536" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-2.patch">
      <meta itemprop="contentSize" content="9358">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490536">
          <a class="link" href="attachment.cgi?id=8490536&amp;action=diff">
        <span id="att-8490536-description" itemprop="description">Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490536&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490536">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-49" data-comment-id="9320861">This addresses the review comments for part 2. I didn't add a comment about maxDigestInfoLen vs. maxDigestLen because there is nothing named maxDigestLen in the file.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490283&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490283</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8490283&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490283</a> -
        Flags: <span class="activity-deleted">review?(rrelyea)</span></div><div class="change">
        <a href="/attachment.cgi?id=8490283&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic"
           class=""
        >Attachment #8490283</a> -
        Flags: <span class="activity-deleted">review?(agl)</span></div></div></div><div class="change-set" id="c50"><div class="comment" data-id="9320869" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a528285_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a528285_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-16 20:19 PDT" data-time="1410923941">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8490537"
         class="attachment patch obsolete"
         data-id="8490537" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="padding-4.patch">
      <meta itemprop="contentSize" content="2476">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8490537">
          <a class="link" href="attachment.cgi?id=8490537&amp;action=diff">
        <span id="att-8490537-description" itemprop="description">Part 4: Add additional comments for the changes to VFY_*</span></a> (obsolete)
        — <a href="attachment.cgi?id=8490537&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8490537">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-50" data-comment-id="9320869">This patch adds some additional comments about why we don't check the encoded DigestInfo against the given digest OID at the time we recover the DigestInfo from the signature. Basically, it would be redundant and misleading to do that check in recoverPKCS1DigestInfo. I split this into a separate patch in case it is decided that the comments are too helpful for people trying to reverse-engineer the vulnerability from the patches. Part 4 can be checked in separately at a later date, if so desired.

As I mentioned in my previous comment, I don't have much more time to work on this, so I'm going to hand it off to others to finish.</pre></div><div class="change-set" id="a745426_11099"><div class="change" id="aa745426_11099">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_11099" id="a745426_11099"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a745426_11099"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a745426_11099">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a745426_11099">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 08:38 PDT" data-time="1410968290">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490536&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]"
           class=""
        >Attachment #8490536</a> -
        Flags: review+</div></div></div><div class="change-set" id="c51"><div class="comment" data-id="9323015" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a745426_11099"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 08:40 PDT" data-time="1410968427">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="9323015">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490537" name="attach_8490537" title="Part 4: Add additional comments for the changes to VFY_*">attachment 8490537</a> <a href="/attachment.cgi?id=8490537&amp;action=edit" title="Part 4: Add additional comments for the changes to VFY_*">[details]</a> <a href="/attachment.cgi?id=8490537&amp;action=diff" title="Part 4: Add additional comments for the changes to VFY_*">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490537'>[review]</a>
Part 4: Add additional comments for the changes to VFY_*

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490537" name="attach_8490537" title="Part 4: Add additional comments for the changes to VFY_*">attachment 8490537</a> <a href="/attachment.cgi?id=8490537&amp;action=edit" title="Part 4: Add additional comments for the changes to VFY_*">[details]</a> <a href="/attachment.cgi?id=8490537&amp;action=diff" title="Part 4: Add additional comments for the changes to VFY_*">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490537'>[review]</a>:
-----------------------------------------------------------------

Thanks for considering my suggestion. As I meantioned, I'm OK with what you did, comments will help future people looking in this code understand it's constraints.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490537&amp;action=edit"
           title="Part 4: Add additional comments for the changes to VFY_*"
           class=""
        >Attachment #8490537</a> -
        Flags: review+</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="9323083" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a745426_11099"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 08:51 PDT" data-time="1410969105">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="9323083">Thanks for jumping on this Brian, Kai says he'll look at finishing it up, since it's not a whole lot of work. I should hold back since wtc is out until at least Friday, possibly even Monday, so we'll still need an NSS reviewer on this.

bob</pre></div><div class="change-set" id="c53"><div class="comment" data-id="9323947" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a745426_11099"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 11:22 PDT" data-time="1410978162">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="9323947">We're very likely going to be releasing Firefox 32.0.2 this week. This bug can ride along in 32.0.2 if complete in time.</pre></div><div class="change-set" id="c54"><div class="comment" data-id="9325380" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a745426_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 15:09 PDT" data-time="1410991746">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="9325380">Can we get rid of the Apache license header in the new lib/util files?</pre></div><div class="change-set" id="c55"><div class="comment" data-id="9325398" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a745426_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 15:12 PDT" data-time="1410991933">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="9325398">(In reply to Lawrence Mandel [:lmandel] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c53">comment #53</a>)
<span class="quote">&gt; We're very likely going to be releasing Firefox 32.0.2 this week. This bug
&gt; can ride along in 32.0.2 if complete in time.</span >

Fixes in NSS, especially when introducing a new API as expected with this patch, require a new full NSS release. Afterwards, Mozilla needs to pick up the new NSS release.

Should we consider to release a NSS 3.17.1 update, with this bugfix only, based on NSS 3.17 - and renumber current NSS development trunk to 3.17.2 ?</pre></div><div class="change-set" id="c56"><div class="comment" data-id="9325433" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a745426_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 15:18 PDT" data-time="1410992327">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="9325433">(unrelated to fixing this bug, but related to getting this landed into stable branches, another heads up: 
In order to land this into the 24.x and 31.x branches, because they still use NSS 3.16.2, which doesn't yet remove the 1024-bit legacy roots, and because of the thinking to keep the set of root CA certs frozen on the 24/31 branches for now:
It will require that we'll have to produce a special release tag of 3.17.1 that still uses the root CA list from 3.16.2.
That special release tag could be created on a NSS mini branch and named NSS_3_17_1_WITH_CKBI_1_98_RTM.)</pre></div><div class="change-set" id="c57"><div class="comment" data-id="9328154" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a745426_11099"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 05:52 PDT" data-time="1411044765">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="9328154">I strongly suspect that Apple implementation is completely vulnerable to this bug.

I had a quick look over their code and after jumping around I reached the conclusion that the function that checks certificate signatures is &quot;SecCertificateIsSignedBy&quot; in sec/Security/SecCertificate.c

This function starts with the following lines:

    SecAsn1AlgId algId;
    algId.algorithm.Length = certificate-&gt;_tbsSigAlg.oid.length;
    algId.algorithm.Data = certificate-&gt;_tbsSigAlg.oid.data;
    algId.parameters.Length = certificate-&gt;_tbsSigAlg.params.length;
    algId.parameters.Data = certificate-&gt;_tbsSigAlg.params.data;

This seems to indicate that the parameters inside the PKCS#1 block are taken directly from the &quot;to be signed&quot; part of the certificate which is 100% under attacker control.

I have yet to check that this hunch is correct but considering that Apple takes ages to fix these things it may be a good idea to wait a bit more before rolling this update.</pre></div><div class="change-set" id="c58"><div class="comment" data-id="9328219" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a745426_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 06:08 PDT" data-time="1411045719">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="9328219">Comment on <span class=""><a href="/attachment.cgi?id=8490498" name="attach_8490498" title="build_hash.c">attachment 8490498</a> <a href="/attachment.cgi?id=8490498&amp;action=edit" title="build_hash.c">[details]</a></span>
build_hash.c

I'm trying to understand the inspiration that Bob intended to give with this patch, but are having trouble.

For example, this line:
    outerSequenceLengthValue = derOid-&gt;oid.len + hashOid-&gt;oid.len + 8

I understand taking the length of hashOid, but I don't understand what derOid is referring to?</pre></div><div class="change-set" id="c59"><div class="comment" data-id="9328497" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a745426_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 07:03 PDT" data-time="1411048983">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="9328497">(In reply to Kai Engert (:kaie) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c58">comment #58</a>)
<span class="quote">&gt; I understand taking the length of hashOid, but I don't understand what
&gt; derOid is referring to?</span >

Ok, it's referring to the length of the following digest (e.g. 16 for md5).</pre></div><div class="change-set" id="c60"><div class="comment" data-id="9328571" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a745426_11099"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 07:18 PDT" data-time="1411049932">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="9328571">(In reply to Antoine Delignat-Lavaud from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c57">comment #57</a>)
<span class="quote">&gt; I strongly suspect that Apple implementation is completely vulnerable to
&gt; this bug.</span >

OK, I took a closer look at SecKey.c and in fact, the DEREncodeDigestInfoPrefix function uses hard-coded NULL parameters (0500). There is still a bug that causes MD5 signatures to be accepted (by using the md5 oid instead of md5withRSA) but no signature forgery.</pre></div><div class="change-set" id="c61"><div class="comment" data-id="9328648" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a745426_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 07:38 PDT" data-time="1411051139">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="9328648">Bob:

In order to dynamically encode the prefix, we must dynamically look up the size (in bytes) of the hash, starting with SECOidTag digestAlg.

I think we shouldn't use the size that we can see in the signature we're trying to verify, right?

I searched NSS for tables that would allow me to perform the lookup. I found HASH_GetHashTypeByOidTag() and HASH_GetHashObject(), which contains the size. Unfortunately, they are within libnss3, and cannot be accessed from libnssutil3.

I also found something in libfreebl/rawhash.c but I think we cannot access libfreebl from nssutil either.

Unless you can point me to another place that's accessible from nssutil, we must add a mapping from hash type to hash size to nssutil.</pre></div><div class="change-set" id="c62"><div class="comment" data-id="9329203" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a745426_11099"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a745426_11099"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 09:24 PDT" data-time="1411057482">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="9329203">The hash that's passed in is not the hash from the signature, but the hash calculated by the caller over the data we just calculated. It should be correct because it comes from the underlying hash implementation.

If we aren't happy with that, then we need to have the caller pass the hash size in. There are implementations of the hasht interface in both softoken and in nss proper (one points to freebl, the other points to PK11wrap).

We could also just require the caller to check the length if we want. We should not be depending on the length inside the signature block, since that is something the attacker can fake. This code doesn't depend on that block because we don't actually decode it anywhere in the code. Instead the code takes the full der encoded signature and compares it to a hand created der encoded signature.

bob</pre></div><div class="change-set" id="a835361_14661"><div class="change" id="aa835361_14661">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a835361_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a835361_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a835361_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a835361_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a835361_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 09:37 PDT" data-time="1411058225">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a></div></div></div><div class="change-set" id="c63"><div class="comment" data-id="9329407" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a835361_14661"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a835361_14661"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 09:57 PDT" data-time="1411059429">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="9329407">Ok, so you're saying, I can simply trust the value digest-&gt;len passed to SGN_VerifyPKCS1DigestInfo().</pre></div><div class="change-set" id="c64"><div class="comment" data-id="9329552" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a835361_14661"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a835361_14661"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 10:21 PDT" data-time="1411060871">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8491627"
         class="attachment patch obsolete"
         data-id="8491627" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1064636-part1-v4.patch">
      <meta itemprop="contentSize" content="7418">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8491627">
          <a class="link" href="attachment.cgi?id=8491627&amp;action=diff">
        <span id="att-8491627-description" itemprop="description">part1 - v4 - work-in-progress</span></a> (obsolete)
        — <a href="attachment.cgi?id=8491627&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8491627">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-64" data-comment-id="9329552">This patch is on top of the other parts 2+3+4.

It builds, but fails during tests.

I will write test code that dumps the dynamically encoded prefixes to files, so I can compare them with the intended results...</pre></div><div class="change-set" id="a838027_36541"><div class="change" id="aa838027_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a838027_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a838027_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a838027_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a838027_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a838027_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 10:21 PDT" data-time="1411060891">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8490376&amp;action=edit"
           title="Part 1: Implement new PKCS#1 padding checking logic [v3]"
           class=""
        >Attachment #8490376</a> -
        Flags: <span class="activity-deleted">review?(agl)</span></div></div></div><div class="change-set" id="c65"><div class="comment" data-id="9330283" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a838027_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a838027_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 11:58 PDT" data-time="1411066717">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8491708"
         class="attachment patch obsolete"
         data-id="8491708" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1064636-part1-v5.patch">
      <meta itemprop="contentSize" content="11329">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8491708">
          <a class="link" href="attachment.cgi?id=8491708&amp;action=diff">
        <span id="att-8491708-description" itemprop="description">part 1 - [v5] - with debug code</span></a> (obsolete)
        — <a href="attachment.cgi?id=8491708&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8491708">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-65" data-comment-id="9330283">This one passes the &quot;cert&quot; part of our suite.
It contains some debug code, which I used to dump the encoded bytes.
I did a bytewise comparison of about half of the structs that bsmith had in his patch, and they matched.

I'll attach a clearner patch for review next...</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8491627&amp;action=edit"
           title="part1 - v4 - work-in-progress"
           class=""
        >Attachment #8491627</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c66"><div class="comment" data-id="9330285" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a838027_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a838027_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 11:59 PDT" data-time="1411066795">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8491709"
         class="attachment patch obsolete"
         data-id="8491709" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1064636-part1-v6.patch">
      <meta itemprop="contentSize" content="7484">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8491709">
          <a class="link" href="attachment.cgi?id=8491709&amp;action=diff">
        <span id="att-8491709-description" itemprop="description">part 1 - [v6]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8491709&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8491709">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-66" data-comment-id="9330285">Also, I removed the vim header, removed the apache license, and changed indendation to the usual 4-spaces.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8491709&amp;action=edit"
           title="part 1 - [v6]"
           class=""
        >Attachment #8491709</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c67"><div class="comment" data-id="9330747" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a838027_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a838027_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 13:30 PDT" data-time="1411072222">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="9330747">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8491709" name="attach_8491709" title="part 1 - [v6]">attachment 8491709</a> <a href="/attachment.cgi?id=8491709&amp;action=edit" title="part 1 - [v6]">[details]</a> <a href="/attachment.cgi?id=8491709&amp;action=diff" title="part 1 - [v6]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8491709'>[review]</a>
part 1 - [v6]

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8491709" name="attach_8491709" title="part 1 - [v6]">attachment 8491709</a> <a href="/attachment.cgi?id=8491709&amp;action=edit" title="part 1 - [v6]">[details]</a> <a href="/attachment.cgi?id=8491709&amp;action=diff" title="part 1 - [v6]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8491709'>[review]</a>:
-----------------------------------------------------------------

r+ rrelyea.

Thanks Kai.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8491709&amp;action=edit"
           title="part 1 - [v6]"
           class=""
        >Attachment #8491709</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="a931134_1689"><div class="change" id="aa931134_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a931134_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a931134_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a931134_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a931134_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a931134_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 12:13 PDT" data-time="1411153998">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a></div></div></div><div class="change-set" id="c68"><div class="comment" data-id="9335402" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a931134_1689"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a931134_1689"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 12:26 PDT" data-time="1411154761">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8492326"
         class="attachment obsolete"
         data-id="8492326" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="sigtests.tar.gz">
      <meta itemprop="contentSize" content="15251">
      <meta itemprop="encodingFormat" content="application/x-gzip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8492326" itemprop="contentUrl">
        <span id="att-8492326-description" itemprop="description">Signature validation tests</span></a> (obsolete)
        — <a href="attachment.cgi?id=8492326&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-68" data-comment-id="9335402">I've generated a number of test cases around this (attached) and tried it against OpenSSL and GnuTLS. Both accept the case where the NULL is missing but are otherwise ok.

I'll see if I can find an Apple device this afternoon to test that.</pre></div><div class="change-set" id="c69"><div class="comment" data-id="9335474" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a931134_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a931134_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 12:44 PDT" data-time="1411155862">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8492339"
         class="attachment"
         data-id="8492339" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="evp_pkcs1_padding_test.c">
      <meta itemprop="contentSize" content="8679">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8492339" itemprop="contentUrl">
        <span id="att-8492339-description" itemprop="description">evp_pkcs1_padding_test.c</span></a>
        — <a href="attachment.cgi?id=8492339&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-69" data-comment-id="9335474">Adam, it seems like you already have a convenient way of generating certificates with malformed DigestInfos. It would be great if you could share it so that I can add some more test cases.

Here is the test I made for OpenSSL. On the OpenSSL trunk, there is a patch to ignore leading zeros in the length field of TLV constructs. Also, OpenSSL trunk does accept the indefinite length encoding of lengths. Finally, OpenSSL trunk accepts the high tag number form even for low-numbered tags. Note that I only tested the OpenSSL trunk, not any previous releases, and not LibreSSL or BoringSSL.</pre></div><div class="change-set" id="c70"><div class="comment" data-id="9335578" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a931134_1689"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a931134_1689"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 13:05 PDT" data-time="1411157112">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8492355"
         class="attachment obsolete"
         data-id="8492355" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="generate.go">
      <meta itemprop="contentSize" content="4078">
      <meta itemprop="encodingFormat" content="text/x-go">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8492355" itemprop="contentUrl">
        <span id="att-8492355-description" itemprop="description">Go script for generating test certs - tweaks to Go libraries needed.</span></a> (obsolete)
        — <a href="attachment.cgi?id=8492355&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-70" data-comment-id="9335578">Brian: I'm tweaking the Go crypto/rsa library and using the attached script to generate certificates. I'll try adding high-valued tags and indefinite lengths as a test case. I think that bernull.crt tests leading zeros already (at least in the params) but I didn't test with OpenSSL trunk.</pre></div><div class="change-set" id="c71"><div class="comment" data-id="9335606" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a931134_1689"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a931134_1689"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 13:10 PDT" data-time="1411157420">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="9335606">(In reply to Adam Langley from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c68">comment #68</a>)
<span class="quote">&gt; I'll see if I can find an Apple device this afternoon to test that.</span >

I checked the source and they only accept NULL parameters and do not use any DER decoding (they use memcmp with hard-coded ASN.1)
Only thing dodgy is that they accept MD5 signatures but it's not clear whether it's a bug or a feature.</pre></div><div class="change-set" id="c72"><div class="comment" data-id="9335822" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345904" id="a931134_1689"><img src="https://secure.gravatar.com/avatar/bb86d80efaa70cc4865fd08fb33db875?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345904" id="a931134_1689"><a class="email " href="/user_profile?user_id=345904" > <span class="fna">Adam Langley</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 13:56 PDT" data-time="1411160193">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8492383"
         class="attachment"
         data-id="8492383" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="sigtests.tar.gz">
      <meta itemprop="contentSize" content="22448">
      <meta itemprop="encodingFormat" content="application/x-gzip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8492383" itemprop="contentUrl">
        <span id="att-8492383-description" itemprop="description">Signature validation tests</span></a>
        — <a href="attachment.cgi?id=8492383&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-72" data-comment-id="9335822">OpenSSL and GnuTLS both accept indefinite lengths or high valued tags. But in neither case do they have an overflow that allows lots of arbitrary data. Additionally, OpenSSL trunk accepts leading zeros on the length.

These are all things that should be fixed, but I don't see an exploit given that flexibility alone.

Updated test cases attached.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8492326&amp;action=edit"
           title="Signature validation tests"
           class=""
        >Attachment #8492326</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8492355&amp;action=edit"
           title="Go script for generating test certs - tweaks to Go libraries needed."
           class=""
        >Attachment #8492355</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a1189961_75935"><div class="change" id="aa1189961_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1189961_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1189961_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1189961_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1189961_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1189961_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 12:07 PDT" data-time="1411412825">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=isnotempty">status-b2g-v1.4</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">Whiteboard: [status-firefox-esr24:affected]</div></div></div><div class="change-set" id="a1190044_75935"><div class="change" id="aa1190044_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1190044_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1190044_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1190044_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1190044_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1190044_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 12:08 PDT" data-time="1411412908">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [status-firefox-esr24:affected] &rarr; [status-firefox-esr24:affected][status-b2g-v1.3t:affected]</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="9343332" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1190044_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1190044_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 12:54 PDT" data-time="1411415658">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="9343332">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8491709" name="attach_8491709" title="part 1 - [v6]">attachment 8491709</a> <a href="/attachment.cgi?id=8491709&amp;action=edit" title="part 1 - [v6]">[details]</a> <a href="/attachment.cgi?id=8491709&amp;action=diff" title="part 1 - [v6]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8491709'>[review]</a>
part 1 - [v6]

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8491709" name="attach_8491709" title="part 1 - [v6]">attachment 8491709</a> <a href="/attachment.cgi?id=8491709&amp;action=edit" title="part 1 - [v6]">[details]</a> <a href="/attachment.cgi?id=8491709&amp;action=diff" title="part 1 - [v6]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8491709'>[review]</a>:
-----------------------------------------------------------------

Adding some f- for style/future compat issues, but I think the actual _code_ is correct.

::: lib/util/pkcs1sig.c
&#64;&#64; +10,5 &#64;&#64;
<span class="quote">&gt; +#include &quot;secoid.h&quot;
&gt; +
&gt; +typedef struct
&gt; +{
&gt; +    size_t len;</span >

This type is
1) Missing the necessary includes (stddef.h)
2) Fairly inconsistent with respect to how size-types are handled (see, for example, line 20 as a prime example of this)

&#64;&#64; +12,5 &#64;&#64;
<span class="quote">&gt; +typedef struct
&gt; +{
&gt; +    size_t len;
&gt; +    PRUint8 data[SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX];
&gt; +} Prefix;</span >

naming-wise, this seems to violate the internal consistency of NSS.

Internal structures are leading lower-case, camel-capped, with a prefix indicating the module it belongs to, to avoid any ODR issues, with &quot;Str&quot; suffix for structs, with brace on the same line as typedef

typedef struct pkcs1PrefixStr pkcs1Prefix;
struct pkcs1PrefixStr {
  size_t len;
  PRUint8 data[...];
};

&#64;&#64; +19,5 &#64;&#64;
<span class="quote">&gt; +{
&gt; +    unsigned int digestLen;
&gt; +    Prefix prefixWithParams;
&gt; +    Prefix prefixWithoutParams;
&gt; +} PKCS1DigestInfoInfo;</span >

No better naming than the &quot;InfoInfo&quot; ?

&#64;&#64; +22,5 &#64;&#64;
<span class="quote">&gt; +    Prefix prefixWithoutParams;
&gt; +} PKCS1DigestInfoInfo;
&gt; +
&gt; +static SECStatus
&gt; +encodePrefix(const SECOidData *hashOid, unsigned int digestLen,</span >

naming wise, this is also inconsistent with respect to nss

pkcs1_encodePrefix()?

&#64;&#64; +29,5 &#64;&#64;
<span class="quote">&gt; +    /* with params coding is:
&gt; +     *  Sequence (2 bytes) { 
&gt; +     *      Sequence (2 bytes) { 
&gt; +     *               OID (2 bytes)  {
&gt; +     *                   Oid value (derOid-&gt;oid.len)</span >

inconsistent capitalization

&#64;&#64; +35,5 &#64;&#64;
<span class="quote">&gt; +     *               NULL (2 bytes)
&gt; +     *      }
&gt; +     *      OCTECT (2 bytes);
&gt; +     *
&gt; +     * without Params coding is:</span >

inconsistent capitalization (Params vs line 29, params - prefer 'params')

&#64;&#64; +39,5 &#64;&#64;
<span class="quote">&gt; +     * without Params coding is:
&gt; +     *  Sequence (2 bytes) { 
&gt; +     *      Sequence (2 bytes) { 
&gt; +     *               OID (2 bytes)  {
&gt; +     *                   Oid value (derOid-&gt;oid.len)</span >

inconsistent capitalization (OID -&gt; Oid)

&#64;&#64; +56,5 &#64;&#64;
<span class="quote">&gt; +        extra = 2;
&gt; +    }
&gt; +
&gt; +    if (outerSeqLen &gt;= 128 ||
&gt; +        (outerSeqLen +2 -digestLen) &gt; SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX) {</span >

Inconsistent spacing here makes it difficult to read

(outerSeqLen + 2 - digestLen) = readable.

Note, however, the need for digestLen to be trusted, otherwise overflow. But I think that's a reasonable assumption here.

&#64;&#64; +61,5 &#64;&#64;
<span class="quote">&gt; +        /* this is actually a library failure, It shouldn't happen */
&gt; +        PORT_SetError(SEC_ERROR_INVALID_ARGS); 
&gt; +        return SECFailure;
&gt; +    }
&gt; +    </span >

There's trailing whitespace on lines 30, 31, 40, 41, 62, and 65 - can you please fix this before committing.

&#64;&#64; +65,5 &#64;&#64;
<span class="quote">&gt; +    
&gt; +    prefix-&gt;data[0] = SEC_ASN1_SEQUENCE|SEC_ASN1_CONSTRUCTED;
&gt; +    prefix-&gt;data[1] = outerSeqLen;
&gt; +    prefix-&gt;data[2] = SEC_ASN1_SEQUENCE|SEC_ASN1_CONSTRUCTED;
&gt; +    prefix-&gt;data[3] = innerSeqLen;</span >

You make no check on innerSeqLen being &lt;= 127.

The only reason this is safe is because of the transitive properties of lines 59 (which checks outerSeqLen) and line 50 (which constructs outerSeqLen from innerSeqLen), and that hashOid-&gt;oid.len should be less than a boundary value (if it was untrusted data, one could cause mischief).

This is at least 'surprising', and might benefit from an unnecessary, but self-documenting, check on line 59 to also check innerSeqLen doesn't have the high-bit set (therefore making it suitable for direct length encoding here)

&#64;&#64; +76,5 &#64;&#64;
<span class="quote">&gt; +    }
&gt; +    prefix-&gt;data[6+hashOid-&gt;oid.len+extra] = SEC_ASN1_OCTET_STRING;
&gt; +    prefix-&gt;data[6+hashOid-&gt;oid.len+extra+1] = digestLen;
&gt; +
&gt; +    prefix-&gt;len = 6+hashOid-&gt;oid.len+extra+2;</span >

Inconsistent spaces between operators here (and really, throughout the file)

Specific remediation: Add spaces on lines 74, 75, 77, 78, and 80 (in addition to the remarks on line 60), which bring it to consistency with lines 49/50/54/55/56/59 and, in general, the direction we've been trying to push NSS.

&#64;&#64; +98,5 &#64;&#64;
<span class="quote">&gt; +    }
&gt; +
&gt; +    hashOid = SECOID_FindOIDByTag(digestAlg);
&gt; +    if (hashOid == NULL) {
&gt; +        PORT_SetError(SEC_ERROR_INVALID_ARGS); </span >

Trailing whitespace

&#64;&#64; +111,5 &#64;&#64;
<span class="quote">&gt; +            != SECSuccess) {
&gt; +        return SECFailure;
&gt; +    }
&gt; +
&gt; +    {</span >

Unnecessary block statement

&#64;&#64; +116,5 &#64;&#64;
<span class="quote">&gt; +        /* We don't attempt to avoid timing attacks on these comparisons because
&gt; +         * signature verification is a public key operation, not a private key
&gt; +         * operation.
&gt; +         */
&gt; +        const Prefix* comparingTo;</span >

Let's name this something more meaningful: expectedPrefix

::: lib/util/pkcs1sig.h
&#64;&#64; +16,5 &#64;&#64;
<span class="quote">&gt; +#define SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX 19
&gt; +
&gt; +/* The length of the longest valid DigestInfo. */
&gt; +#define SGN_PKCS1_DIGESTINFO_LENGTH_MAX \
&gt; +        (SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX + HASH_LENGTH_MAX)</span >

Are we sure we want to hardcode this in a public API?

I can see no reason to expose this via the header, and doing so makes it difficult to add new digest info support in future versions if the value expands (e.g. NSS 4 might expect this structure to be 23 bytes, but the caller compiled with the headers from NSS 3 and only got 19 bytes)

Since this is not used/needed as any part of the public API, I see no reason to expose it as such.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8491709&amp;action=edit"
           title="part 1 - [v6]"
           class=""
        >Attachment #8491709</a> -
        Flags: feedback-</div></div></div><div class="change-set" id="c74"><div class="comment" data-id="9343350" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1190044_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1190044_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 12:57 PDT" data-time="1411415879">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="9343350">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490536" name="attach_8490536" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">attachment 8490536</a> <a href="/attachment.cgi?id=8490536&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[details]</a> <a href="/attachment.cgi?id=8490536&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490536'>[review]</a>
Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490536" name="attach_8490536" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">attachment 8490536</a> <a href="/attachment.cgi?id=8490536&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[details]</a> <a href="/attachment.cgi?id=8490536&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490536'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/secvfy.c
&#64;&#64; +48,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +    digestInfoItem.data = digestInfo;
&gt; +    digestInfoItem.len = maxDigestInfoLen;</span >

Why this change from using SECKEY_PublicKeyStrength (which was forward compatible in source and binary) to using a hardcoded value - especially one that may be less than the strength of the given key.

Have I missed something here?</pre></div><div class="change-set" id="a1194133_1689"><div class="change" id="aa1194133_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1194133_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1194133_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1194133_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1194133_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 13:16 PDT" data-time="1411416997">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c75"><div class="comment" data-id="9343540" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1194133_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 13:31 PDT" data-time="1411417868">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-75" data-comment-id="9343540">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490536" name="attach_8490536" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">attachment 8490536</a> <a href="/attachment.cgi?id=8490536&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[details]</a> <a href="/attachment.cgi?id=8490536&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490536'>[review]</a>
Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490536" name="attach_8490536" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">attachment 8490536</a> <a href="/attachment.cgi?id=8490536&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[details]</a> <a href="/attachment.cgi?id=8490536&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490536'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/secvfy.c
&#64;&#64; +48,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +    digestInfoItem.data = digestInfo;
&gt; +    digestInfoItem.len = maxDigestInfoLen;</span >

If one were to change the code to allocate a buffer of SECKEY_PublicKeyStrength bytes, instead of using the statically-allocated buffer, that would be fine by me. The main advantage of that change is that nearly all malicious inputs would be caught by verifyPKCS1DigestInfo, instead of only a subset of them.

As far as we understand the possible attacks, nearly all of them require a DigestInfo structure that is larger than the largest one we accept, so PK11_VerifyRecover returning a &quot;output buffer too small&quot; error is actually what rejects basically all previously-working malicious inputs in this version of the patch.

However, dynamically allocating a buffer and then properly managing that buffer seemed more error-prone and unnecessarily complicated to me, so I did it this way.

Note that mixing and matching different versions of libnss and libnssutil is not supported anyway. And, also, even if you compile against one version of libnssutil and then link against a different version of libnssutil, you will still be safe (assuming PK11_VerifyRecover does its bounds-checking correctly); it's just that you may too strictly reject some valid signatures for new hash algorithms that have outputs that are either larger than SHA-512 and/or that have very long OIDs. But, mixing and matching libnssutil and libnss is likely to give you much more severe problems than that anyway.</pre></div><div class="change-set" id="c76"><div class="comment" data-id="9343612" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1194133_1689"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 13:45 PDT" data-time="1411418750">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="9343612">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c75">comment #75</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490536" name="attach_8490536" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">attachment 8490536</a> <a href="/attachment.cgi?id=8490536&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[details]</a> <a href="/attachment.cgi?id=8490536&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490536'>[review]</a>
&gt; Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking
&gt; logic [v2]
&gt; 
&gt; Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8490536" name="attach_8490536" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">attachment 8490536</a> <a href="/attachment.cgi?id=8490536&amp;action=edit" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[details]</a> <a href="/attachment.cgi?id=8490536&amp;action=diff" title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490536'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; ::: lib/cryptohi/secvfy.c
&gt; &#64;&#64; +48,3 &#64;&#64;
&gt; &gt;  
&gt; &gt; +    digestInfoItem.data = digestInfo;
&gt; &gt; +    digestInfoItem.len = maxDigestInfoLen;
&gt; 
&gt; If one were to change the code to allocate a buffer of
&gt; SECKEY_PublicKeyStrength bytes, instead of using the statically-allocated
&gt; buffer, that would be fine by me. The main advantage of that change is that
&gt; nearly all malicious inputs would be caught by verifyPKCS1DigestInfo,
&gt; instead of only a subset of them.</span >

Alternatively, it's one less place to be 'surprised' when you add a new algorithm (which is why I was surprised Bob R+'d this, given his earlier objections)

<span class="quote">&gt; 
&gt; As far as we understand the possible attacks, nearly all of them require a
&gt; DigestInfo structure that is larger than the largest one we accept, so
&gt; PK11_VerifyRecover returning a &quot;output buffer too small&quot; error is actually
&gt; what rejects basically all previously-working malicious inputs in this
&gt; version of the patch.
&gt; 
&gt; However, dynamically allocating a buffer and then properly managing that
&gt; buffer seemed more error-prone and unnecessarily complicated to me, so I did
&gt; it this way.
&gt; 
&gt; Note that mixing and matching different versions of libnss and libnssutil is
&gt; not supported anyway.</span >

Are you sure about that? I'd be surprised to hear this from Red Hat, given the FIPS-lications of this.

<span class="quote">&gt; And, also, even if you compile against one version of
&gt; libnssutil and then link against a different version of libnssutil, you will
&gt; still be safe (assuming PK11_VerifyRecover does its bounds-checking
&gt; correctly); </span >

Historically, that assumption - both for softoken AND for general tokens - has been wrong. softoken not doing proper bounds checking has been a particular source of Web Crypto bugs when implementing, so I no longer feel confident making this assumption.

<span class="quote">&gt; it's just that you may too strictly reject some valid signatures
&gt; for new hash algorithms that have outputs that are either larger than
&gt; SHA-512 and/or that have very long OIDs. But, mixing and matching libnssutil
&gt; and libnss is likely to give you much more severe problems than that anyway.</span >

Correct, that's the concern, and it's an echo of Bob's remarks in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c45">comment #45</a> that greatly surprised me. This is just a hardcoded constant by another name.</pre></div><div class="change-set" id="c77"><div class="comment" data-id="9343704" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1194133_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 14:05 PDT" data-time="1411419928">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="9343704"><span class="quote">&gt; &gt; +#define SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX 19
&gt; &gt; +
&gt; &gt; +/* The length of the longest valid DigestInfo. */
&gt; &gt; +#define SGN_PKCS1_DIGESTINFO_LENGTH_MAX \
&gt; &gt; +        (SGN_PKCS1_DIGESTINFO_PREFIX_LENGTH_MAX + HASH_LENGTH_MAX)
&gt; 
&gt; Are we sure we want to hardcode this in a public API?
&gt; 
&gt; I can see no reason to expose this via the header,</span >

It looks like the reason (as in motivation) was to find a fix with minimal effort, allowing to use the value in softoken and cryptohi, without calculating them again.


<span class="quote">&gt; and doing so makes it
&gt; difficult to add new digest info support in future versions if the value
&gt; expands (e.g. NSS 4 might expect this structure to be 23 bytes, but the
&gt; caller compiled with the headers from NSS 3 and only got 19 bytes)</span >

You raise a valid point, thanks for bringing this up.
I agree it would be good to do it differently.

The value depends on the maximum length of the assigned OID for allowed hash algorithms.

In pkcs1sig.c, the code wants to check the maximum reasonable length.
We could use dynamic code that looks at the length of all Oids of all allowed hash algorithms, and figure out the maximum?

What should be done in pkcs11c.c and secvfy.c?
We need compile time constants.
If I understand correctly, we simply require safe maximum sizes for buffers, not necessarily being the exact maximums?
What should we use? Should we figure out the maximum possible length for an Oid, and calculate a maximum possible encoding?
But this would involve HASH_LENGTH_MAX, which also seems to be hard coded to the largest currently supported hash (currently SHA512).
Are we at risk that other code in NSS might be using buffers designed for that size, and have issues like you described, when mixing future portions of NSS?</pre></div><div class="change-set" id="c78"><div class="comment" data-id="9343711" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1194133_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 14:06 PDT" data-time="1411419960">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-78" data-comment-id="9343711">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c73">comment #73</a>)
<span class="quote">&gt; Adding some f- for style/future compat issues, but I think the actual _code_
&gt; is correct.</span >

That's good, thanks for reviewing, and this was the priority.

I tried to minimize the number of changes after Brian's work...
Also I personally don't worry to much about consistency and think the patch is readable as is, but I'll try to address your comments.

<span class="quote">&gt; &#64;&#64; +10,5 &#64;&#64;
&gt; &gt; +#include &quot;secoid.h&quot;
&gt; &gt; +
&gt; &gt; +typedef struct
&gt; &gt; +{
&gt; &gt; +    size_t len;
&gt; 
&gt; This type is
&gt; 1) Missing the necessary includes (stddef.h)
&gt; 2) Fairly inconsistent with respect to how size-types are handled (see, for
&gt; example, line 20 as a prime example of this)</span >

For the sake of simplicity, I'll remove size_t (FYI there are other files in NSS that don't explicitly include stddef.h either), e.g. lib/util/secload.c


<span class="quote">&gt; typedef struct pkcs1PrefixStr pkcs1Prefix;
&gt; struct pkcs1PrefixStr {
&gt;   size_t len;
&gt;   PRUint8 data[...];
&gt; };</span >

ok. Will use unsigned int.


<span class="quote">&gt; &gt; +} PKCS1DigestInfoInfo;
&gt; 
&gt; No better naming than the &quot;InfoInfo&quot; ?</span >

pkcs1Prefixes


<span class="quote">&gt; &gt; +encodePrefix(const SECOidData *hashOid, unsigned int digestLen,
&gt; 
&gt; naming wise, this is also inconsistent with respect to nss
&gt; pkcs1_encodePrefix()?</span >

Is this really a problem? It's a static function, local to the file only.


<span class="quote">&gt; You make no check on innerSeqLen being &lt;= 127.</span >

will add


<span class="quote">&gt; Unnecessary block statement</span >

It was necessary, because I added a local variable to the scope. But since you don't seem to like it, I moved the variable to the global function scope and removed the block brackets.


<span class="quote">&gt; Let's name this something more meaningful: expectedPrefix</span >

ok</pre></div><div class="change-set" id="c79"><div class="comment" data-id="9343768" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1194133_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 14:15 PDT" data-time="1411420517">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493339"
         class="attachment patch obsolete"
         data-id="8493339" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1064636-part1-v7.patch">
      <meta itemprop="contentSize" content="7528">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493339">
          <a class="link" href="attachment.cgi?id=8493339&amp;action=diff">
        <span id="att-8493339-description" itemprop="description">part 1 - [v7]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493339&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493339">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-79" data-comment-id="9343768">This addresses most of Ryan's small requests for naming of types and variables and consistency.

The only code change from v6 is: Added the length check for innerSeqLen, which is kind of redundant, because innerSeqLen &lt; outerSeqLen, and outerSeqLen was already checked for being within limits.</pre></div><div class="change-set" id="c80"><div class="comment" data-id="9344188" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1194133_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 15:12 PDT" data-time="1411423925">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-80" data-comment-id="9344188">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c76">comment #76</a>)
<span class="quote">&gt; &gt; And, also, even if you compile against one version of
&gt; &gt; libnssutil and then link against a different version of libnssutil, you will
&gt; &gt; still be safe (assuming PK11_VerifyRecover does its bounds-checking
&gt; &gt; correctly); 
&gt; 
&gt; Historically, that assumption - both for softoken AND for general tokens -
&gt; has been wrong. softoken not doing proper bounds checking has been a
&gt; particular source of Web Crypto bugs when implementing, so I no longer feel
&gt; confident making this assumption.</span >

I think that is a fair concern. I agree with you that the person assigned to this bug should change that part of the patch.

<span class="quote">&gt; Correct, that's the concern, and it's an echo of Bob's remarks in comment
&gt; #45 that greatly surprised me. This is just a hardcoded constant by another
&gt; name.</span >

I agree that none of the patches in this bug in their current form seem to meet Bob's goal for this reason.</pre></div><div class="change-set" id="c81"><div class="comment" data-id="9344230" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1194133_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1194133_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 15:19 PDT" data-time="1411424381">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493387"
         class="attachment patch obsolete"
         data-id="8493387" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1064636-part1-v8.patch">
      <meta itemprop="contentSize" content="11032">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493387">
          <a class="link" href="attachment.cgi?id=8493387&amp;action=diff">
        <span id="att-8493387-description" itemprop="description">part 1 - [v8]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493387&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493387">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-81" data-comment-id="9344230">Ryan, this patch attempts to address the issues from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c77">comment 77</a>.
(I suggest to click &quot;diff&quot; on this patch, then diff it against &quot;part 1 - [v7]&quot;)

Does this look OK to you?
Do you have better ideas than using an arbitrary &quot;99&quot; for the maximum possible length for an encoded Oid?

Should we go much higher, or can we derive the maximum?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493387&amp;action=edit"
           title="part 1 - [v8]"
           class=""
        >Attachment #8493387</a> -
        Flags: feedback?(ryan.sleevi)</div></div></div><div class="change-set" id="a1202078_1689"><div class="change" id="aa1202078_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1202078_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1202078_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1202078_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1202078_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1202078_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 15:29 PDT" data-time="1411424942">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; kaie</div></div></div><div class="change-set" id="c82"><div class="comment" data-id="9344332" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1202078_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1202078_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 15:41 PDT" data-time="1411425711">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-82" data-comment-id="9344332">Ryan:

I will work on dynamically allocating. One issue, however, is the patch &quot;part 3&quot;, which contains a buffer for obtaining the digest, and which currently uses the constant.

It seems difficult to change this code to dynamic allocation!

Bob suggested, if we want to be safe, we can use 2048 bytes (RSA_MAX_MODULUS_BITS (16384) / 8).</pre></div><div class="change-set" id="c83"><div class="comment" data-id="9344417" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1202078_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1202078_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 16:04 PDT" data-time="1411427047">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="9344417">(In reply to Kai Engert (:kaie) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c82">comment #82</a>)
<span class="quote">&gt; Ryan:
&gt; 
&gt; I will work on dynamically allocating. One issue, however, is the patch
&gt; &quot;part 3&quot;, which contains a buffer for obtaining the digest, and which
&gt; currently uses the constant.</span >

Sorry, I mean part 2.

    union {
	unsigned char buffer[1];

	/* the encoded DigestInfo from a RSA PKCS#1 signature */
	unsigned char pkcs1DigestInfo[SGN_PKCS1_DIGESTINFO_LENGTH_MAX];

At this place, I want to use 

	unsigned char pkcs1DigestInfo[RSA_MAX_MODULUS_BITS / 8];

Ok?</pre></div><div class="change-set" id="c84"><div class="comment" data-id="9344444" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1202078_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1202078_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 16:09 PDT" data-time="1411427365">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493419"
         class="attachment patch obsolete"
         data-id="8493419" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part2-v3.patch">
      <meta itemprop="contentSize" content="9060">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493419">
          <a class="link" href="attachment.cgi?id=8493419&amp;action=diff">
        <span id="att-8493419-description" itemprop="description">part 2 - [v3]</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493419&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493419">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-84" data-comment-id="9344444">This changes part 2 to no longer use constant SGN_PKCS1_DIGESTINFO_LENGTH_MAX (because Ryan suggested to get rid of it), and replaces it with a safe maximum.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490536&amp;action=edit"
           title="Part 2: Change NSS's VFY_* functions to use the new PKCS#1 padding checking logic [v2]"
           class=""
        >Attachment #8490536</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c85"><div class="comment" data-id="9344508" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1202078_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1202078_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 16:28 PDT" data-time="1411428492">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-85" data-comment-id="9344508">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8493419" name="attach_8493419" title="part 2 - [v3]">attachment 8493419</a> <a href="/attachment.cgi?id=8493419&amp;action=edit" title="part 2 - [v3]">[details]</a> <a href="/attachment.cgi?id=8493419&amp;action=diff" title="part 2 - [v3]">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493419'>[review]</a>
part 2 - [v3]

this is obsolete, because more work is required to fix <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c74">comment 74</a> and following.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493419&amp;action=edit"
           title="part 2 - [v3]"
           class=""
        >Attachment #8493419</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a1205957_280903"><div class="change" id="aa1205957_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a1205957_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1205957_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1205957_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1205957_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 16:33 PDT" data-time="1411428821">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2014-1568</div></div></div><div class="change-set" id="c86"><div class="comment" data-id="9344844" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 18:04 PDT" data-time="1411434288">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-86" data-comment-id="9344844">OK, I apologize if it's simply due to lack of sleep or ignorance, but reviewing the patch sets again still seems to suggest there's a lot of unnecessary complexity that ALSO hides a lot of corners being cut and '64K should be enough for everyone' style assumptions, which seem unnecessary.

Working from first principles, the issue here is that we're decoding the entire message and trusting the outer wrapping to be well-formed. The fix, at least from this CL, is to also compare the encoding.

This 'seems' fairly simple to fix, re: RFC 3447 Section 8.2, and without any of the hardcoding complexities being demonstrated here.

I don't want to distract from this bug being fixed, and I think this patchset does so (which is the most pressing issue), but I also think we should clean-up. To be clear: I don't want to delay fix for cleanup.

I understand the need to handle verification where we don't know the hash algorithm (SEC_OID_UNKNOWN) and those when we do.

When verifying, and tag == SEC_OID_UNKNOWN
- Allocate a buffer = public modulus size
- RSA_CheckSignRecover &lt;-- guaranteeing that PKCS#1 padding is wellformed (mostly)
- Decode the DisgestInfo (QuickDER - bugs and all)
- Extract the algorithm tag

When verifying, and tag != SEC_OID_UNKNOWN (or after the above steps)
- Allocate a buffer = public modulus size
- RSA_CheckSignRecoverRaw (this recovers the full message, padding and all)
- Construct the two canonical DigestInfos
  - With NULL and (if allowing it to be ommitted) without NULL params
- Construct the FULL PKCS#1 SSA-EM (RFC 3447 9.2)
- PORT_Memcmp


As far as where this code lives
- &quot;Decode the DigestInfo&quot; is part of util
- RSA_CheckSignRecover is part of freebl
- PKCS#1 encoding/decoding is part of freebl (moved down from softoken)
- Verification happens in cryptohi (in order to handle the recovery case)


In order to support the above, the _only_ thing we seem to need to change/update/handle is having <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#19">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#19</a> JUST extract the digest (in the case of SEC_OID_UNKNOWN)

Then, update the stupid VFY functions to use the stupid PKCS#11 functions as they're intended - namely, CKM_RSA_PKCS, where the input buffer is the Digest Info. This will fix VFY from doing the stupid hashing itself.

This matches precisely what RFC 3447 says, and avoids any issues with the ASN.1 decoder EXCEPT for when using the SEC_OID_UNKNOWN for RSA keys, in which case, you're dependent on it to 'at least' get the algorithm right.</pre></div><div class="change-set" id="c87"><div class="comment" data-id="9344848" data-no="87"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-87" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-87"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-87" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c87">Comment 87</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 18:05 PDT" data-time="1411434347">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-87">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-87" data-comment-id="9344848">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c86">comment #86</a>)
<span class="quote">&gt; In order to support the above, the _only_ thing we seem to need to
&gt; change/update/handle is having
&gt; <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#19">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#19</a> JUST extract the
&gt; digest (in the case of SEC_OID_UNKNOWN)</span >

s/extract the digest/extract the digest ALGORITHM/</pre></div><div class="change-set" id="c88"><div class="comment" data-id="9344962" data-no="88"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-88" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-88"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-88" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c88">Comment 88</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 18:43 PDT" data-time="1411436615">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-88">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-88" data-comment-id="9344962">Actually, strike that. We're introducing a new public API that we'll have to support 'forever', when the existing VFY_ functions should be able to handle it just fine. 

vfy_VerifyDigest ( <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#612">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#612</a> ) and VFY_EndWithSignature ( <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#545">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#545</a> )are _already_ doing the right thing for !RSA keys, by calling PK11_Verify.
RSA keys are _already_ correctly mapped to CKM_RSA_PKCS in PK11_Verify ( <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/pk11wrap/pk11mech.c#1842">http://mxr.mozilla.org/nss/source/lib/pk11wrap/pk11mech.c#1842</a> )
CKM_RSA_PKCS is _already_ correctly mapped to sftk_RSACheckSign ( <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/softoken/pkcs11c.c#3023">http://mxr.mozilla.org/nss/source/lib/softoken/pkcs11c.c#3023</a> ) which maps to RSA_CheckSign ( <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/softoken/pkcs11c.c#2932">http://mxr.mozilla.org/nss/source/lib/softoken/pkcs11c.c#2932</a> )

RSA_CheckSign _already_ does the right thing of making sure ALL of the PKCS#11 padding is correct - AND that it's properly sized (minimum 8 octets of padding)

So the only thing that's 'missing' - which covers both cert verification and the ServerKeyExchange verification - is updating the vfy_ functions I mentioned above to _just_ grab the DigestInfo for the SEC_OID_UNKNOWN case (which bsmith&#64; asserts is never used for these two paths anyways, and I _think_ he's right)

That is, the _extent_ of changes nescessary SHOULD be at:
<a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#382">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#382</a>
<a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#550">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#550</a>
<a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#597">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#597</a>

Explicitly:
- <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#87">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#87</a> - do away with rsadigest, and instead store the full signature (same as DSA or ECDSA)
- In CreateContext, if and only iff hashAlg == SEC_OID_UNKNOWN do we decode the signature (and only if provided)
- in VFY_EndWithSignature, we KNOW hashAlg can not = SEC_OID_UNKNOWN (because VFY_Update needs the hash alg), so it's not even necessary to decode the signature
- in VFY_EndWIthSignature, for RSA, we encode as fresh DigestInfo
  - matching either our NULL params or missing params, using SGN_CreateDigestInfo (or a possibly extra structure) and SGN_EncodeDigestInfo
- Pass this to PK11_Verify
- Profit</pre></div><div class="change-set" id="c89"><div class="comment" data-id="9345039" data-no="89"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-89" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-89"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-89" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c89">Comment 89</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 19:04 PDT" data-time="1411437897">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-89">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-89" data-comment-id="9345039">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c88">comment #88</a>)
<span class="quote">&gt; - In CreateContext, if and only iff hashAlg == SEC_OID_UNKNOWN do we decode
&gt; the signature (and only if provided)</span >

The problem with this, which is minor to me, but might matter to some people, is that you end up doing the RSA calculation *twice* in the SEC_OID_UNKNOWN case.

<span class="quote">&gt; - Pass this to PK11_Verify</span >

The problem with this is similar to the problem you mentioned regarding my use of PK11_VerifyRecover with a buffer smaller than the RSA key strength: You don't know that the PKCS#11 module implemented PKCS#1 signature verification correctly. In fact we have good evidence that many (non-PKCS#11) implementations do not implement PKCS#1 signature verification correctly. Therefore, it is actually more conservative for libnss3 to use PK11_VerifyRecover and then do as much of the DigestInfo checking itself. My guess is that PKCS#11 tokens are probably less likely to have an output buffer overflow in the VerifyRecover than they are to get PKCS#1 wrong, based on the evidence we've gathered so far.

I've actually implemented exactly what you suggest here already, but I abandoned that work after running into the &quot;duplicate API / duplicate code path&quot; issue and the &quot;we can't really trust the PKCS#11 implementation to get it right&quot; issues. I'm happy to share one or two of those attempts, if it would be helpful.</pre></div><div class="change-set" id="c90"><div class="comment" data-id="9345044" data-no="90"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-90" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-90"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-90" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c90">Comment 90</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 19:08 PDT" data-time="1411438087">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-90">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-90" data-comment-id="9345044">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c88">comment #88</a>)
<span class="quote">&gt; vfy_VerifyDigest (
&gt; <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#612">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#612</a> ) and
&gt; VFY_EndWithSignature (
&gt; <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#545">http://mxr.mozilla.org/nss/source/lib/cryptohi/secvfy.c#545</a> )are _already_
&gt; doing the right thing for !RSA keys, by calling PK11_Verify.</span >

Yes, they are. But, additionally to the two reasons I cited in my previous comment, I was also concerned that it could be the case that some PKCS#11 tokens support C_VerifyRecover for RSA keys but might not support C_Verify for RSA keys. It is unlikely, but because this is being rushed into release, I decided to be conservative with the compatibility risk here. (Again, I think I have some patches that do this.)</pre></div><div class="change-set" id="c91"><div class="comment" data-id="9345075" data-no="91"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-91" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-91"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-91" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c91">Comment 91</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 19:18 PDT" data-time="1411438692">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-91">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-91" data-comment-id="9345075">But this only applies to public keys, which we always use softoken for.

I think hypothetical malformed tokens is a poor excuse for long term API debt. Even if we accepted the argument, it is still something we can handle entirely without exposing additional API surface.</pre></div><div class="change-set" id="c92"><div class="comment" data-id="9345133" data-no="92"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-92" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-92"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-92" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c92">Comment 92</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 19:32 PDT" data-time="1411439552">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-92">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-92" data-comment-id="9345133">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c91">comment #91</a>)
<span class="quote">&gt; But this only applies to public keys, which we always use softoken for.</span >

I did not know that that was guaranteed. It would be good to update the documentation for PK11_Verify to guarantee that it will never use anything other than softoken. My understanding is that, at least in theory, NSS can be configured to prefer another token even for public key operations, or that we should account for that possibility in the future.</pre></div><div class="change-set" id="c93"><div class="comment" data-id="9345159" data-no="93"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-93" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-93"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-93" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c93">Comment 93</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 19:40 PDT" data-time="1411440030">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-93">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-93" data-comment-id="9345159">PK11_Verify doesn't guarantee this, but the other functions that acquire the handle do (e.g. the SECKEY functions that setup the handles)

Either way, if your concern is that some PKCS implementation only supports part of the mechanism CKM_RSA_PKCS operations - something purely hypothetical and not affecting the 99.99% of users - we can still keep this entirely constrained in the vfy_ functions, without having to export some new function from until that is high impossible to use right / useful.

Specifically, if we need to (and I suspect Bob will readily say its unnecessary), we can do several things:
1) Import the public key (since it only applies to cert verification, and we ALWAYS have the cert)
2) Do the full (raw) verify recover and compare the encoded results.

Either solution avoids the hard coding fragility, while still maintaining correctness.

For discussion, I'm going to implement this tonight, as it will be a smaller change that has greater long term maintainability and correctness.</pre></div><div class="change-set" id="c94"><div class="comment" data-id="9345366" data-no="94"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-94" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-94"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-94" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c94">Comment 94</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 21:14 PDT" data-time="1411445695">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-94">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-94" data-comment-id="9345366">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c93">comment #93</a>)
<span class="quote">&gt; Either way, if your concern is that some PKCS implementation only supports
&gt; part of the mechanism CKM_RSA_PKCS operations - something purely
&gt; hypothetical and not affecting the 99.99% of users - we can still keep this
&gt; entirely constrained in the vfy_ functions, </span >

Like I said, I wrote my patch to minimize risk w.r.t. compatibility and safety. It isn't the patch I would write if it didn't need to be deployed into production with basically no testing. The whole point of pk11wrap is to make it possible to mix and match a bunch of different PKCS#11 modules in a wide variety of configurations, and I didn't (don't) want things to fail to work correctly in some some unusual configuration.

<span class="quote">&gt; Specifically, if we need to (and I suspect Bob will readily say its
&gt; unnecessary), we can do several things:
&gt; 1) Import the public key (since it only applies to cert verification, and we
&gt; ALWAYS have the cert)</span >

This function isn't specific to certificates, so you can't, in general, assume that there is some certificate to import the key from.

<span class="quote">&gt; 2) Do the full (raw) verify recover and compare the encoded results.</span >

I don't understand what you mean by this one.

<span class="quote">&gt; Either solution avoids the hard coding fragility, while still maintaining
&gt; correctness.</span >

Keep in mind that even for SHA-3, HASH_LENGTH_MAX doesn't change, and the OIDs for SHA-3 hash algorithms are the same length as the SHA-2 OIDs according to <a rel="nofollow" href="http://csrc.nist.gov/groups/ST/crypto_apps_infra/csor/algorithms.html">http://csrc.nist.gov/groups/ST/crypto_apps_infra/csor/algorithms.html</a>. And, even if the constants were out of sync as far as libnss and libnssutil perceive them, there would be no security failure. The only issue would be that some hypothetical non-SHA-1, non-SHA-2, non-SHA-3 hash algorithms wouldn't be accepted, which would be detected immediately during testing.

In contrast, relying on the PKCS#11 module to do the PKCS#1 verification correctly fails whenever the PKCS#11 module doesn't do PKCS#1 verification correctly. So, the flexibility of NSS works against us in this case. I don't see how we could confidently guarantee that VFY_* functions will only ever use softoken for RSA verification--not just now, but also in the future, due to that flexibility. I am happy to be proven wrong, though.</pre></div><div class="change-set" id="c95"><div class="comment" data-id="9345525" data-no="95"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-95" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-95"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-95" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c95">Comment 95</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 22:35 PDT" data-time="1411450533">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-95">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-95" data-comment-id="9345525">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c94">comment #94</a>)
<span class="quote">&gt; Like I said, I wrote my patch to minimize risk w.r.t. compatibility and
&gt; safety. It isn't the patch I would write if it didn't need to be deployed
&gt; into production with basically no testing. The whole point of pk11wrap is to
&gt; make it possible to mix and match a bunch of different PKCS#11 modules in a
&gt; wide variety of configurations, and I didn't (don't) want things to fail to
&gt; work correctly in some some unusual configuration.</span >

I agree, but at the same time, we shouldn't use the possibility of esoteria to prevent us from writing good patches. Again, I'm not trying to r- an emergency security fix, but I think we're unnecessarily cutting corners/making assumptions, and forcing a bad API to be maintained indefinitely.

If the answer is &quot;I can't be sure about the paths to this code&quot;, then we should answer &quot;What are the paths to this code&quot;

<span class="quote">&gt; This function isn't specific to certificates, so you can't, in general,
&gt; assume that there is some certificate to import the key from.</span >

All of the VFY functions work on SECKEYPublicKey

A SECKEYPublicKey is _always_ stored in it's data form. This is precisely the issue we were discussing two weeks ago when Richard Barnes was dealing with ECC import (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS hangs with 100% CPU on invalid EC key"
   href="/show_bug.cgi?id=1057161">Bug 1057161</a>)

So we know, for all paths using a SECKEYPublicKey, we have the full public key AND that it's imported to NSS softoken on-demand for the operation.

<span class="quote">&gt; 
&gt; &gt; 2) Do the full (raw) verify recover and compare the encoded results.
&gt; 
&gt; I don't understand what you mean by this one.</span >

VerifyRecoverRaw gives you the full PKCS#1 RSA-SSA-EM. That is, block type, padding string, etc. You can reconstruct this and compare. This guarantees, for example, that the padding is not hostile and is appropriate (e.g. 8 bytes)

<span class="quote">&gt; 
&gt; &gt; Either solution avoids the hard coding fragility, while still maintaining
&gt; &gt; correctness.
&gt; 
&gt; Keep in mind that even for SHA-3, HASH_LENGTH_MAX doesn't change, and the
&gt; OIDs for SHA-3 hash algorithms are the same length as the SHA-2 OIDs
&gt; according to
&gt; <a rel="nofollow" href="http://csrc.nist.gov/groups/ST/crypto_apps_infra/csor/algorithms.html">http://csrc.nist.gov/groups/ST/crypto_apps_infra/csor/algorithms.html</a>. And,
&gt; even if the constants were out of sync as far as libnss and libnssutil
&gt; perceive them, there would be no security failure. The only issue would be
&gt; that some hypothetical non-SHA-1, non-SHA-2, non-SHA-3 hash algorithms
&gt; wouldn't be accepted, which would be detected immediately during testing.</span >

So what? It's a bad public dependency that is virtually unchangable and creates source-compatibility if you compile with an old header, targeting a new API. It'd be a straight up buffer overflow, since they disagree on the size of the buffer they're writing into.

The solution, which is adding slop/padding, doesn't really strike as a clean solution.

<span class="quote">&gt; 
&gt; In contrast, relying on the PKCS#11 module to do the PKCS#1 verification
&gt; correctly fails whenever the PKCS#11 module doesn't do PKCS#1 verification
&gt; correctly. So, the flexibility of NSS works against us in this case. I don't
&gt; see how we could confidently guarantee that VFY_* functions will only ever
&gt; use softoken for RSA verification--not just now, but also in the future, due
&gt; to that flexibility. I am happy to be proven wrong, though.</span >

Yes. Security fails when a security module fails to be secure. I don't see that as an inherent argument against a cleaner API.</pre></div><div class="change-set" id="c96"><div class="comment" data-id="9345565" data-no="96"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-96" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-96"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-96" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c96">Comment 96</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 22:49 PDT" data-time="1411451367">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-96">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-96" data-comment-id="9345565">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c95">comment #95</a>)
<span class="quote">&gt; If the answer is &quot;I can't be sure about the paths to this code&quot;, then we
&gt; should answer &quot;What are the paths to this code&quot;
&gt; 
&gt; &gt; This function isn't specific to certificates, so you can't, in general,
&gt; &gt; assume that there is some certificate to import the key from.
&gt; 
&gt; All of the VFY functions work on SECKEYPublicKey
&gt; 
&gt; A SECKEYPublicKey is _always_ stored in it's data form. This is precisely
&gt; the issue we were discussing two weeks ago when Richard Barnes was dealing
&gt; with ECC import (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS hangs with 100% CPU on invalid EC key"
   href="/show_bug.cgi?id=1057161">Bug 1057161</a>)
&gt; 
&gt; So we know, for all paths using a SECKEYPublicKey, we have the full public
&gt; key AND that it's imported to NSS softoken on-demand for the operation.</span >

How do you know that? SECKEYPublicKeyStr contains these members:

    PK11SlotInfo *pkcs11Slot;
    CK_OBJECT_HANDLE pkcs11ID;

How do you know that the caller didn't already set pkcs11ID and/or pkcs11Slot to something that NSS wouldn't normally set, that isn't softoken? Keep in mind that the code might be some strange Firefox extension calling VFY_* directly using SECKEYPublicKey objects it constructed or obtained in some unusual (to us) way. 

<span class="quote">&gt; &gt; perceive them, there would be no security failure. The only issue would be
&gt; &gt; that some hypothetical non-SHA-1, non-SHA-2, non-SHA-3 hash algorithms
&gt; &gt; wouldn't be accepted, which would be detected immediately during testing.
&gt; 
&gt; So what? It's a bad public dependency that is virtually unchangable and
&gt; creates source-compatibility if you compile with an old header, targeting a
&gt; new API. It'd be a straight up buffer overflow, since they disagree on the
&gt; size of the buffer they're writing into.</span >

There is no possibility of buffer overflow in the patch I wrote, no matter how you screw up the headers and linking, AFAICT. If that was a possibility then of course I would agree with you. If there is the possibility of buffer overflow then please point out the buffer overflow.

<span class="quote">&gt; The solution, which is adding slop/padding, doesn't really strike as a clean
&gt; solution.</span >

I didn't suggest adding slop, and I don't think that is a good idea.

<span class="quote">&gt; Yes. Security fails when a security module fails to be secure.</span >

Then I misunderstand your argument about the buffer passed to PK11_VerifyRecover. Why it is good to assume that PK11_VerifyRecover got a trivial thing wrong, but it is OK to assume that PK11_Verify got a complicated thing correct?

<span class="quote">&gt; I don't see that as an inherent argument against a cleaner API.</span >

Nobody is arguing against a cleaner API.</pre></div><div class="change-set" id="c97"><div class="comment" data-id="9345752" data-no="97"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-97" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-97"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-97" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c97">Comment 97</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 23:57 PDT" data-time="1411455460">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-97">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-97" data-comment-id="9345752">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c96">comment #96</a>)
<span class="quote">&gt; How do you know that the caller didn't already set pkcs11ID and/or
&gt; pkcs11Slot to something that NSS wouldn't normally set, that isn't softoken?
&gt; Keep in mind that the code might be some strange Firefox extension calling
&gt; VFY_* directly using SECKEYPublicKey objects it constructed or obtained in
&gt; some unusual (to us) way. </span >

Because creating SECKEYPublicKey objects by hand is &quot;not a supported API&quot;?

<span class="quote">&gt; Then I misunderstand your argument about the buffer passed to
&gt; PK11_VerifyRecover. Why it is good to assume that PK11_VerifyRecover got a
&gt; trivial thing wrong, but it is OK to assume that PK11_Verify got a
&gt; complicated thing correct?</span >

PK11_Verify for CKM_RSA_PKCS works on encoded digest infos (or more aptly, raw data). It's sole responsibility - which hasn't changed at all with your patch (vis-a-vis VerifyRecover) is to do the post-padding comparisons of whatever data that remains. For an RSA signature, this is either the encoded DigestInfo (byte for byte) OR the SHA1/MD5 concatenation (&lt;TLS 1.2 SKX).

There's no &quot;complicated&quot; thing here. PK11_VerifyRecover returns you the bytes, and you're left to compare them. PK11_Verify just compares them for you.</pre></div><div class="change-set" id="c98"><div class="comment" data-id="9345874" data-no="98"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-98" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-98"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-98" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c98">Comment 98</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 00:38 PDT" data-time="1411457880">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-98">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-98" data-comment-id="9345874">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c97">comment #97</a>)
<span class="quote">&gt; (In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from comment
&gt; #96)
&gt; &gt; How do you know that the caller didn't already set pkcs11ID and/or
&gt; &gt; pkcs11Slot to something that NSS wouldn't normally set, that isn't softoken?
&gt; &gt; Keep in mind that the code might be some strange Firefox extension calling
&gt; &gt; VFY_* directly using SECKEYPublicKey objects it constructed or obtained in
&gt; &gt; some unusual (to us) way. 
&gt; 
&gt; Because creating SECKEYPublicKey objects by hand is &quot;not a supported API&quot;?</span >

OK. It isn't clear that one cannot construct a SECKEYPublicKey via supported APIs, that reference a token other than softoken, though.

<span class="quote">&gt; &gt; Then I misunderstand your argument about the buffer passed to
&gt; &gt; PK11_VerifyRecover. Why it is good to assume that PK11_VerifyRecover got a
&gt; &gt; trivial thing wrong, but it is OK to assume that PK11_Verify got a
&gt; &gt; complicated thing correct?
&gt; 
&gt; PK11_Verify for CKM_RSA_PKCS works on encoded digest infos (or more aptly,
&gt; raw data). It's sole responsibility - which hasn't changed at all with your
&gt; patch (vis-a-vis VerifyRecover) is to do the post-padding comparisons of
&gt; whatever data that remains. For an RSA signature, this is either the encoded
&gt; DigestInfo (byte for byte) OR the SHA1/MD5 concatenation (&lt;TLS 1.2 SKX).
&gt; 
&gt; There's no &quot;complicated&quot; thing here. PK11_VerifyRecover returns you the
&gt; bytes, and you're left to compare them. PK11_Verify just compares them for
&gt; you.</span >

OK, I now understand what you mean. I don't think it is great to assume, in the long term, that PK11_Verify gets the minimum padding length check right, because of the more theoretical &quot;it might not be softoken&quot; problem. But, also, nobody has fixed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">bug 1067214</a> yet, which is a concrete instance of getting the padding length check wrong for PK11_VerifyRecover, so even if it is softoken, it is wrong!

So, I agree with you that if libnss wants to guard against bad PKCS#11 modules, then it should use the VerifyRecoverRaw way you suggested above. But, doing that ultimately means you end up with something very much like pkcs1sig.c in libnssutil, because softoken and libnss both expose functions that need the same logic in that case. Like I mentioned above, I didn't switch to PK11_Verify or PK11_PubDecryptRaw like you suggested because I didn't want to change which PKCS#11 functionality the code depended on, in the name of minimizing compatibility risk. But, again, I think that is the best long-term approach. Note that even continuing to use PK11_VerifyRecover, you can add a check that the length of the returned DigestInfo is at least 11 bytes shorter than SECKEY_PublicKeyStrength(k), but you'd still be depending on the PKCS#11 module to check the padding bytes.

Speaking of which, I noticed this code in sslcon.c (the SSL 2.0 code), which looks very wrong for exactly that reason:

    rv = PK11_PubDecryptRaw(sc-&gt;SERVERKEY, kbuf, &amp;ddLen, modulusLen, ek, ekLen);
    if (rv != SECSuccess) 
	goto hide_loser;

    /* Is the length of the decrypted data (ddLen) the expected value? */
    if (modulusLen != ddLen) 
	goto hide_loser;

    /* Cheaply verify that PKCS#1 was used to format the encryption block */
    if ((kbuf[0] != 0x00) || (kbuf[1] != 0x02) || (dk[-1] != 0x00)) {
	SSL_DBG((&quot;%d: SSL[%d]: strange encryption block&quot;,
		 SSL_GETPID(), ss-&gt;fd));
	PORT_SetError(SSL_ERROR_BAD_CLIENT);
	goto hide_loser;
    }

Also, in case it wasn't clear, I also support removing the #defines in pkcs1sig.h. I don't think it is practically problematic if they stay (I don't think there is any buffer overflow to worry about, for example).</pre></div><div class="change-set" id="c99"><div class="comment" data-id="9345989" data-no="99"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-99" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1205957_280903"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-99"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-99" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c99">Comment 99</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 01:13 PDT" data-time="1411460035">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-99">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-99" data-comment-id="9345989">Ryan, would you mind helping us by rewriting the patch in the way you think is ideal?

It seems to me that would be much simpler than this discussion.

I honestly don't want to upset you, but it's complicated to follow this discussion and figure out how exactly you want this fixed, and you already seem to have a very clear understanding of how you want this done.

Given you're worried about introducing this new API, it seems you really prefer to get the cleanup done immediately, in the initial release of a fix.</pre></div><div class="change-set" id="c100"><div class="comment" data-id="9346040" data-no="100"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-100" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1205957_280903"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-100"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-100" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c100">Comment 100</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 01:31 PDT" data-time="1411461063">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-100">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-100" data-comment-id="9346040">See the end of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c93">comment #93</a> Kai.

Brian: w/r/t the buffer overflow, the concern is precisely the malformed modules that you're concerned about (re: a buffer of ModulusLen size vs the 'guesstimate based on header', even if it seems academic). Considering we've found and fixed several of those in softoken for Web Crypto and OAEP, I think it's reasonable to be paraboid.

I think you're right, having played more with it, that because we want to allow bad encodings in both the high and low layers, we likely end up either with a function in util to try both, or we duplicate the logic in both places. I'm still working through the deps there.

I really don't like the manual encoding - is there a reason you explicitly avoided SGN_EncodeDigestInfo? I'm concerned it may simply be a mozilla::pkix-ism of NIH/trust nothing, and while I understand why it is, I don't think it's good for NSS to not trust itself.

I've got two approaches to upload tomorrow - one that uses PK11_Verify twice (when necessary), using the valid and invalid digestinfo, and one that uses VerifyRecover approach that is (largely) functionally equivalent to this, but using SGN_EncodeDigestInfo to do the heavy lifting.</pre></div><div class="change-set" id="c101"><div class="comment" data-id="9346280" data-no="101"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-101" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1205957_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1205957_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-101"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-101" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c101">Comment 101</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 02:20 PDT" data-time="1411464013">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-101">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-101" data-comment-id="9346280">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c100">comment #100</a>)
<span class="quote">&gt; Brian: w/r/t the buffer overflow, the concern is precisely the malformed
&gt; modules that you're concerned about (re: a buffer of ModulusLen size vs the
&gt; 'guesstimate based on header', even if it seems academic). Considering we've
&gt; found and fixed several of those in softoken for Web Crypto and OAEP, I
&gt; think it's reasonable to be paraboid.</span >

Agreed.

<span class="quote">&gt; I really don't like the manual encoding - is there a reason you explicitly
&gt; avoided SGN_EncodeDigestInfo? I'm concerned it may simply be a
&gt; mozilla::pkix-ism of NIH/trust nothing, and while I understand why it is, I
&gt; don't think it's good for NSS to not trust itself.</span >

My original patch was <span class="bz_obsolete"><a href="/attachment.cgi?id=8490281" name="attach_8490281" title="Part 1: Implement new PKCS#1 padding checking logic">attachment 8490281</a> <a href="/attachment.cgi?id=8490281&amp;action=edit" title="Part 1: Implement new PKCS#1 padding checking logic">[details]</a> <a href="/attachment.cgi?id=8490281&amp;action=diff" title="Part 1: Implement new PKCS#1 padding checking logic">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490281'>[review]</a>, where the encoding was all done ahead of time, with a code generator that generates static const data. That wasn't due to any distrust of NSS, but rather a general distrust of executing code that is more complex than it must be, in favor of trusting static data when possible. Notice in particular that that patch was able to replace a lot of &quot;goto&quot; usage with clearer error handling logic, because it avoided malloc/free issues, because of its static approach. I personally think that is a very good approach, but I don't want to bikeshed about that any further. Almost any new approach is better than the current approach.</pre></div><div class="change-set" id="a1260096_1689"><div class="change" id="aa1260096_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1260096_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1260096_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1260096_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1260096_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1260096_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:36 PDT" data-time="1411482960">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">crypto-core-security</span></div></div></div><div class="change-set" id="c102"><div class="comment" data-id="9347780" data-no="102"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-102" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260096_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260096_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-102"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-102" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c102">Comment 102</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:38 PDT" data-time="1411483090">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-102">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-102" data-comment-id="9347780">Independently of the new discussion that Ryan and Brian have started, I have continued my task from yesterday, and have reworked the patch to rid of the fixed constants that Ryan disliked.

I removed the fixed size buffer in secvfy.c and replaced it with dynamic storage.

I changed pkcs1sig.c to more clearly document on which assumptions the constants are based. Since those constants are used locally, for verifying maximum expected lengths, not for static buffers, I think it should be OK.

(If you want, we can have a follow-up where we somehow dynamically iterate through the list of digest algorithsms and figure out the length of the largest involved digest Oid, but given this would be based on a fixed list of allowed digests, this would still be a hardcoded list... Unless you can tell me a dynamic mechanism to produce the list of allowed digests.)

In pkcs11c.c function RSA_HashCheckSign(), we need a maximum buffer size. I don't know of a way to know the correct maximum buffer here. However, this code passes the size of available space into the called RSA_CheckSignRecover, so I assume it doesn't matter to know the exact size.

I believe I have addressed Ryan's request from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c74">comment 74</a>, and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c77">comment 77</a> (from end of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c73">comment 73</a>).

I will attach the updated patches, for you to consider, whether they are be sufficient for the initial round of the emergency patching.


These patches in no way attempt to address the new discussion that Ryan has started in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c86">comment 86</a>.

I'll let Bob decide if we should wait for newer patches from Ryan/Brian, based on the arguments from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c86">comment 86</a> and later.</pre></div><div class="change-set" id="a1260315_36541"><div class="change" id="aa1260315_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260315_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a1260315_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1260315_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1260315_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1260315_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:39 PDT" data-time="1411483179">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493387&amp;action=edit"
           title="part 1 - [v8]"
           class=""
        >Attachment #8493387</a> -
        Flags: <span class="activity-deleted">feedback?(ryan.sleevi)</span></div></div></div><div class="change-set" id="c103"><div class="comment" data-id="9347788" data-no="103"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-103" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260315_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260315_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-103"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-103" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c103">Comment 103</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:40 PDT" data-time="1411483236">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-103">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493772"
         class="attachment patch obsolete"
         data-id="8493772" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part1-v9">
      <meta itemprop="contentSize" content="8076">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493772">
          <a class="link" href="attachment.cgi?id=8493772&amp;action=diff">
        <span id="att-8493772-description" itemprop="description">part1-v9 (will be replaced shortly)</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493772&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493772">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8491708&amp;action=edit"
           title="part 1 - [v5] - with debug code"
           class=""
        >Attachment #8491708</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493339&amp;action=edit"
           title="part 1 - [v7]"
           class=""
        >Attachment #8493339</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493387&amp;action=edit"
           title="part 1 - [v8]"
           class=""
        >Attachment #8493387</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493772&amp;action=edit"
           title="part1-v9 (will be replaced shortly)"
           class=""
        >Attachment #8493772</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c104"><div class="comment" data-id="9347793" data-no="104"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-104" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260315_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260315_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-104"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-104" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c104">Comment 104</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:41 PDT" data-time="1411483316">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-104">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493773"
         class="attachment patch obsolete"
         data-id="8493773" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part2-v9">
      <meta itemprop="contentSize" content="10616">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493773">
          <a class="link" href="attachment.cgi?id=8493773&amp;action=diff">
        <span id="att-8493773-description" itemprop="description">part2-v9</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493773&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493773">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493773&amp;action=edit"
           title="part2-v9"
           class=""
        >Attachment #8493773</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c105"><div class="comment" data-id="9347797" data-no="105"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-105" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260315_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260315_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-105"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-105" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c105">Comment 105</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:42 PDT" data-time="1411483338">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-105">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493775"
         class="attachment patch obsolete"
         data-id="8493775" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part3-v9">
      <meta itemprop="contentSize" content="3408">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493775">
          <a class="link" href="attachment.cgi?id=8493775&amp;action=diff">
        <span id="att-8493775-description" itemprop="description">part3-v9</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493775&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493775">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493775&amp;action=edit"
           title="part3-v9"
           class=""
        >Attachment #8493775</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="a1260511_36541"><div class="change" id="aa1260511_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260511_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a1260511_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1260511_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1260511_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1260511_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:42 PDT" data-time="1411483375">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490288&amp;action=edit"
           title="Part 3: Change softoken to use the new PKCS#1 padding verification logic"
           class=""
        >Attachment #8490288</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8490288&amp;action=edit"
           title="Part 3: Change softoken to use the new PKCS#1 padding verification logic"
           class=""
        >Attachment #8490288</a> -
        Flags: <span class="activity-deleted">review?(agl)</span></div></div></div><div class="change-set" id="c106"><div class="comment" data-id="9347805" data-no="106"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-106" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260511_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260511_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-106"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-106" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c106">Comment 106</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:43 PDT" data-time="1411483400">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-106">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-106" data-comment-id="9347805">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8490537" name="attach_8490537" title="Part 4: Add additional comments for the changes to VFY_*">attachment 8490537</a> <a href="/attachment.cgi?id=8490537&amp;action=edit" title="Part 4: Add additional comments for the changes to VFY_*">[details]</a> <a href="/attachment.cgi?id=8490537&amp;action=diff" title="Part 4: Add additional comments for the changes to VFY_*">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8490537'>[review]</a>
Part 4: Add additional comments for the changes to VFY_*

These comments have been merged into the other patches.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8490537&amp;action=edit"
           title="Part 4: Add additional comments for the changes to VFY_*"
           class=""
        >Attachment #8490537</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a1260552_36541"><div class="change" id="aa1260552_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1260552_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1260552_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1260552_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 07:43 PDT" data-time="1411483416">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8491709&amp;action=edit"
           title="part 1 - [v6]"
           class=""
        >Attachment #8491709</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c107"><div class="comment" data-id="9347888" data-no="107"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-107" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-107"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-107" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c107">Comment 107</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 08:02 PDT" data-time="1411484544">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-107">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-107" data-comment-id="9347888">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8493772" name="attach_8493772" title="part1-v9 (will be replaced shortly)">attachment 8493772</a> <a href="/attachment.cgi?id=8493772&amp;action=edit" title="part1-v9 (will be replaced shortly)">[details]</a> <a href="/attachment.cgi?id=8493772&amp;action=diff" title="part1-v9 (will be replaced shortly)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493772'>[review]</a>
part1-v9 (will be replaced shortly)

Ok, I'll rewrite this part to get rid of the constants, and allocate dynamically, too.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493772&amp;action=edit"
           title="part1-v9 (will be replaced shortly)"
           class=""
        >Attachment #8493772</a> -
        Attachment description: part1-v9 &rarr; part1-v9 (will be replaced shortly)</div><div class="change">
        <a href="/attachment.cgi?id=8493772&amp;action=edit"
           title="part1-v9 (will be replaced shortly)"
           class=""
        >Attachment #8493772</a> -
        Flags: <span class="activity-deleted">review?(rrelyea)</span></div></div></div><div class="change-set" id="c108"><div class="comment" data-id="9347997" data-no="108"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-108" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-108"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-108" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c108">Comment 108</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 08:24 PDT" data-time="1411485897">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-108">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493805"
         class="attachment patch obsolete"
         data-id="8493805" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part1-v9c">
      <meta itemprop="contentSize" content="7986">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493805">
          <a class="link" href="attachment.cgi?id=8493805&amp;action=diff">
        <span id="att-8493805-description" itemprop="description">part1-v9c</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493805&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493805">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-108" data-comment-id="9347997"><span class="quote">&gt; Ok, I'll rewrite this part to get rid of the constants, and allocate
&gt; dynamically, too.</span >

done</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493772&amp;action=edit"
           title="part1-v9 (will be replaced shortly)"
           class=""
        >Attachment #8493772</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493805&amp;action=edit"
           title="part1-v9c"
           class=""
        >Attachment #8493805</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c109"><div class="comment" data-id="9348117" data-no="109"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-109" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a1260552_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-109"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-109" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c109">Comment 109</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 08:47 PDT" data-time="1411487279">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-109">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-109" data-comment-id="9348117">There's a lot of thrashing here, so in the interest of getting something out, I'm going to review kai's existing patch. There is a cost in that it introduces a new API. I think we can add an under-bar to that API to limit exposure. The function is relatively small, and most of the issues Ryan is worried about isn't in this final helper function (which is only public because both softoken and nss proper use it).

I'm OK if Ryan wants to create a more optimized version of the patch to update later.</pre></div><div class="change-set" id="c110"><div class="comment" data-id="9348226" data-no="110"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-110" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a1260552_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-110"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-110" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c110">Comment 110</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 09:06 PDT" data-time="1411488411">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-110">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-110" data-comment-id="9348226">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8493773" name="attach_8493773" title="part2-v9">attachment 8493773</a> <a href="/attachment.cgi?id=8493773&amp;action=edit" title="part2-v9">[details]</a> <a href="/attachment.cgi?id=8493773&amp;action=diff" title="part2-v9">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493773'>[review]</a>
part2-v9

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8493773" name="attach_8493773" title="part2-v9">attachment 8493773</a> <a href="/attachment.cgi?id=8493773&amp;action=edit" title="part2-v9">[details]</a> <a href="/attachment.cgi?id=8493773&amp;action=diff" title="part2-v9">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493773'>[review]</a>:
-----------------------------------------------------------------

I have some style comments, no bugs or required changes.

I would like SGN_VerifyPKCS1DigestInfo changed to_SGN_VerifyPKCS1DigestInfo. That request affects one line of this patch.

::: lib/cryptohi/secvfy.c
&#64;&#64; +82,2 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (rv == SECSuccess) {</span >

This if is redundant with the previous one.

&#64;&#64; +99,1 &#64;&#64;
<span class="quote">&gt;      }</span >

NSS style is to use a goto to blow out on error rather than checking for rv == SECSuccess everywhere.

&#64;&#64; +157,5 &#64;&#64;
<span class="quote">&gt; +  pkcs1DigestInfo.data = cx-&gt;pkcs1RSADigestInfo;
&gt; +  pkcs1DigestInfo.len = cx-&gt;pkcs1RSADigestInfoLen;
&gt; +  return SGN_VerifyPKCS1DigestInfo(
&gt; +           cx-&gt;hashAlg, digest, &amp;pkcs1DigestInfo,
&gt; +           PR_TRUE /*XXX: unsafeAllowMissingParameters*/);</span >

Here is where my one global comment should change: SGN_VerifyPKCS1DigestInfo -&gt;
_SGN_VerifyPKCS1DigestInfo.

We'll warn that it's private.

&#64;&#64; +419,4 &#64;&#64;
<span class="quote">&gt;      cx-&gt;hasSignature = (sig != NULL);
&gt;      cx-&gt;encAlg = encAlg;
&gt;      cx-&gt;hashAlg = hashAlg;
&gt;      cx-&gt;key = SECKEY_CopyPublicKey(key);</span >

for my own paranoia, I would have explictly set cx-&gt;pkcs11RSADigestInfo to NULL, but cx is allocated with Zalloc, so it's not necessary.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493773&amp;action=edit"
           title="part2-v9"
           class=""
        >Attachment #8493773</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="c111"><div class="comment" data-id="9348235" data-no="111"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-111" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1260552_36541"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-111"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-111" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c111">Comment 111</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 09:10 PDT" data-time="1411488607">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-111">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-111" data-comment-id="9348235">Right, of course I missed the obvious solution of calling it 'private'.

Bob, that gives us the flexibility to remove it, say in the next release, right?</pre></div><div class="change-set" id="c112"><div class="comment" data-id="9348243" data-no="112"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-112" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a1260552_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-112"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-112" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c112">Comment 112</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 09:11 PDT" data-time="1411488669">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-112">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-112" data-comment-id="9348243">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8493775" name="attach_8493775" title="part3-v9">attachment 8493775</a> <a href="/attachment.cgi?id=8493775&amp;action=edit" title="part3-v9">[details]</a> <a href="/attachment.cgi?id=8493775&amp;action=diff" title="part3-v9">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493775'>[review]</a>
part3-v9

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8493775" name="attach_8493775" title="part3-v9">attachment 8493775</a> <a href="/attachment.cgi?id=8493775&amp;action=edit" title="part3-v9">[details]</a> <a href="/attachment.cgi?id=8493775&amp;action=diff" title="part3-v9">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493775'>[review]</a>:
-----------------------------------------------------------------

I would like SGN_VerifyPKCS1DigestInfo changed to_SGN_VerifyPKCS1DigestInfo. That request affects one line of this patch.

::: lib/softoken/pkcs11c.c
&#64;&#64; +2865,5 &#64;&#64;
<span class="quote">&gt; +    SECItem pkcs1DigestInfo;
&gt; +    SECItem digest;
&gt; +
&gt; +    pkcs1DigestInfo.data = pkcs1DigestInfoData;
&gt; +    pkcs1DigestInfo.len = sizeof(pkcs1DigestInfoData);</span >

We could make this allocated as well. pkcs1DigestInfoData.len must be less then key-&gt;u.rsa.modulus.len.

&#64;&#64; +2878,5 &#64;&#64;
<span class="quote">&gt; +    digest.data = (PRUint8*) digestData;
&gt; +    digest.len = digestLen;
&gt; +    return SGN_VerifyPKCS1DigestInfo(
&gt; +               digestOid, &amp;digest, &amp;pkcs1DigestInfo,
&gt; +               PR_TRUE /*XXX: unsafeAllowMissingParameters*/);</span >

SGN_VerifyPKCS1DigestInfo -&gt; _SGN_VerifyPKCS1DigestInfo.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493775&amp;action=edit"
           title="part3-v9"
           class=""
        >Attachment #8493775</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="c113"><div class="comment" data-id="9348324" data-no="113"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-113" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a1260552_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-113"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-113" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c113">Comment 113</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 09:22 PDT" data-time="1411489336">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-113">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-113" data-comment-id="9348324">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8493805" name="attach_8493805" title="part1-v9c">attachment 8493805</a> <a href="/attachment.cgi?id=8493805&amp;action=edit" title="part1-v9c">[details]</a> <a href="/attachment.cgi?id=8493805&amp;action=diff" title="part1-v9c">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493805'>[review]</a>
part1-v9c

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8493805" name="attach_8493805" title="part1-v9c">attachment 8493805</a> <a href="/attachment.cgi?id=8493805&amp;action=edit" title="part1-v9c">[details]</a> <a href="/attachment.cgi?id=8493805&amp;action=diff" title="part1-v9c">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493805'>[review]</a>:
-----------------------------------------------------------------

I have some style comments, no bugs or required changes.

I would like SGN_VerifyPKCS1DigestInfo changed to_SGN_VerifyPKCS1DigestInfo. That request affects three lines in three separeate files of this patch.

::: lib/util/nssutil.def
&#64;&#64; +272,5 &#64;&#64;
<span class="quote">&gt;  ;+       *;
&gt;  ;+};
&gt; +;+NSSUTIL_3.17.1 {         # NSS Utilities 3.17.1 release
&gt; +;+    global:
&gt; +SGN_VerifyPKCS1DigestInfo;</span >

Here one place in this patch where my one global comment should change: SGN_VerifyPKCS1DigestInfo -&gt;
_SGN_VerifyPKCS1DigestInfo.

We'll warn that it's private.

::: lib/util/pkcs1sig.c
&#64;&#64; +94,5 &#64;&#64;
<span class="quote">&gt; +    return SECSuccess;
&gt; +}
&gt; +
&gt; +SECStatus
&gt; +SGN_VerifyPKCS1DigestInfo(SECOidTag digestAlg,</span >

Here one place in this patch where my one global comment should change: SGN_VerifyPKCS1DigestInfo -&gt;
_SGN_VerifyPKCS1DigestInfo.

We'll warn that it's private.

&#64;&#64; +145,5 &#64;&#64;
<span class="quote">&gt; +        } else {
&gt; +            PORT_SetError(SEC_ERROR_BAD_SIGNATURE);
&gt; +            rv = SECFailure;
&gt; +        }
&gt; +    }</span >

Same comment as patch 2 wrt if rv == SECSuccess blocks versus goto loser;

::: lib/util/pkcs1sig.h
&#64;&#64; +21,5 &#64;&#64;
<span class="quote">&gt; + *
&gt; + * If unsafeAllowMissingParameters is true (not recommended), then a DigestInfo
&gt; + * without the mandatory ASN.1 NULL parameter will also be accepted.
&gt; + */
&gt; +SECStatus SGN_VerifyPKCS1DigestInfo(SECOidTag digestAlg,</span >

Here one place in this patch where my one global comment should change: SGN_VerifyPKCS1DigestInfo -&gt;
_SGN_VerifyPKCS1DigestInfo.

We'll warn that it's private.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493805&amp;action=edit"
           title="part1-v9c"
           class=""
        >Attachment #8493805</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="c114"><div class="comment" data-id="9348488" data-no="114"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-114" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-114"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-114" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c114">Comment 114</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 09:50 PDT" data-time="1411491059">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-114">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493845"
         class="attachment patch obsolete"
         data-id="8493845" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part2-v10">
      <meta itemprop="contentSize" content="10701">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493845">
          <a class="link" href="attachment.cgi?id=8493845&amp;action=diff">
        <span id="att-8493845-description" itemprop="description">part2-v10</span></a> (obsolete)
        — <a href="attachment.cgi?id=8493845&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493845">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-114" data-comment-id="9348488">- added paranoia NULL init for cx-&gt;pkcs11RSADigestInfo
- renamed function

carrying forward r+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493845&amp;action=edit"
           title="part2-v10"
           class=""
        >Attachment #8493845</a> -
        Flags: review+</div></div></div><div class="change-set" id="c115"><div class="comment" data-id="9348613" data-no="115"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-115" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-115"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-115" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c115">Comment 115</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 10:12 PDT" data-time="1411492338">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-115">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493855"
         class="attachment patch"
         data-id="8493855" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part2-v10b">
      <meta itemprop="contentSize" content="10700">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493855">
          <a class="link" href="attachment.cgi?id=8493855&amp;action=diff">
        <span id="att-8493855-description" itemprop="description">part2-v10b</span></a>
        — <a href="attachment.cgi?id=8493855&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493855">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-115" data-comment-id="9348613">fix typo</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493845&amp;action=edit"
           title="part2-v10"
           class=""
        >Attachment #8493845</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493855&amp;action=edit"
           title="part2-v10b"
           class=""
        >Attachment #8493855</a> -
        Flags: review+</div></div></div><div class="change-set" id="c116"><div class="comment" data-id="9348617" data-no="116"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-116" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-116"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-116" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c116">Comment 116</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 10:13 PDT" data-time="1411492417">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-116">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493856"
         class="attachment patch"
         data-id="8493856" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part3-v10">
      <meta itemprop="contentSize" content="3673">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493856">
          <a class="link" href="attachment.cgi?id=8493856&amp;action=diff">
        <span id="att-8493856-description" itemprop="description">part3-v10</span></a>
        — <a href="attachment.cgi?id=8493856&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493856">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-116" data-comment-id="9348617">(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c112">comment #112</a>)
<span class="quote">&gt; &gt; +    pkcs1DigestInfo.data = pkcs1DigestInfoData;
&gt; &gt; +    pkcs1DigestInfo.len = sizeof(pkcs1DigestInfoData);
&gt; 
&gt; We could make this allocated as well. pkcs1DigestInfoData.len must be less
&gt; then key-&gt;u.rsa.modulus.len.</span >

Bob, I changed it to allocate.
Did I do it right?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493775&amp;action=edit"
           title="part3-v9"
           class=""
        >Attachment #8493775</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493856&amp;action=edit"
           title="part3-v10"
           class=""
        >Attachment #8493856</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c117"><div class="comment" data-id="9348630" data-no="117"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-117" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-117"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-117" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c117">Comment 117</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 10:15 PDT" data-time="1411492525">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-117">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493860"
         class="attachment patch"
         data-id="8493860" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part1-v10">
      <meta itemprop="contentSize" content="7995">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493860">
          <a class="link" href="attachment.cgi?id=8493860&amp;action=diff">
        <span id="att-8493860-description" itemprop="description">part1-v10</span></a>
        — <a href="attachment.cgi?id=8493860&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493860">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-117" data-comment-id="9348630">renamed.

I didn't change to goto style, since we're under time pressure.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493773&amp;action=edit"
           title="part2-v9"
           class=""
        >Attachment #8493773</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8493805&amp;action=edit"
           title="part1-v9c"
           class=""
        >Attachment #8493805</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c118"><div class="comment" data-id="9348683" data-no="118"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-118" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a1260552_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-118"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-118" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c118">Comment 118</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 10:24 PDT" data-time="1411493061">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-118">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-118" data-comment-id="9348683">Comment on <span class=""><a href="/attachment.cgi?id=8493856" name="attach_8493856" title="part3-v10">attachment 8493856</a> <a href="/attachment.cgi?id=8493856&amp;action=edit" title="part3-v10">[details]</a> <a href="/attachment.cgi?id=8493856&amp;action=diff" title="part3-v10">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493856'>[review]</a>
part3-v10

r+ no more static buffers.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493856&amp;action=edit"
           title="part3-v10"
           class=""
        >Attachment #8493856</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="c119"><div class="comment" data-id="9348791" data-no="119"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-119" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-119"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-119" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c119">Comment 119</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 10:44 PDT" data-time="1411494261">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-119">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493874"
         class="attachment patch"
         data-id="8493874" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part-bustage1">
      <meta itemprop="contentSize" content="668">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493874">
          <a class="link" href="attachment.cgi?id=8493874&amp;action=diff">
        <span id="att-8493874-description" itemprop="description">part-bustage1</span></a>
        — <a href="attachment.cgi?id=8493874&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493874">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-119" data-comment-id="9348791">windows build bustage, the usual &quot;variable not declared at beginning of block&quot;, fix attached.

I've checked in the patches and the bustage fix to the NSS default branch.

<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/ad411fb64046">https://hg.mozilla.org/projects/nss/rev/ad411fb64046</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/4e90910ad2f9">https://hg.mozilla.org/projects/nss/rev/4e90910ad2f9</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/fb7208e91ae8">https://hg.mozilla.org/projects/nss/rev/fb7208e91ae8</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/8dd6c6ac977d">https://hg.mozilla.org/projects/nss/rev/8dd6c6ac977d</a></pre></div><div class="change-set" id="c120"><div class="comment" data-id="9348988" data-no="120"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-120" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-120"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-120" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c120">Comment 120</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 11:12 PDT" data-time="1411495966">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-120">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-120" data-comment-id="9348988">checked in to NSS on new NSS_3_16_2_BRANCH

<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/0d2b27cacd10">https://hg.mozilla.org/projects/nss/rev/0d2b27cacd10</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/2ec7e55a70e1">https://hg.mozilla.org/projects/nss/rev/2ec7e55a70e1</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/6e12be1fac98">https://hg.mozilla.org/projects/nss/rev/6e12be1fac98</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/4eb6c01a4f8f">https://hg.mozilla.org/projects/nss/rev/4eb6c01a4f8f</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/035ace99f704">https://hg.mozilla.org/projects/nss/rev/035ace99f704</a>

Tagged as NSS_3_16_2_1_RTM</pre></div><div class="change-set" id="c121"><div class="comment" data-id="9349123" data-no="121"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-121" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-121"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-121" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c121">Comment 121</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 11:30 PDT" data-time="1411497057">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-121">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-121" data-comment-id="9349123">checked in to NSS on existing NSS_3_16_3_PLUS_BRANCH

<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/1abef7d49647">https://hg.mozilla.org/projects/nss/rev/1abef7d49647</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/c59048189e21">https://hg.mozilla.org/projects/nss/rev/c59048189e21</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/364e66e7f083">https://hg.mozilla.org/projects/nss/rev/364e66e7f083</a>
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/a8f155ba285e">https://hg.mozilla.org/projects/nss/rev/a8f155ba285e</a>

Tagged as NSS_3_16_5_RTM</pre></div><div class="change-set" id="c122"><div class="comment" data-id="9349194" data-no="122"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-122" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-122"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-122" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c122">Comment 122</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 11:42 PDT" data-time="1411497723">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-122">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-122" data-comment-id="9349194"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-release/rev/f9ccc64ca17d">https://hg.mozilla.org/releases/mozilla-release/rev/f9ccc64ca17d</a></pre></div><div class="change-set" id="c123"><div class="comment" data-id="9349216" data-no="123"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-123" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-123"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-123" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c123">Comment 123</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 11:46 PDT" data-time="1411497962">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-123">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-123" data-comment-id="9349216"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr31/rev/4a510243669e">https://hg.mozilla.org/releases/mozilla-esr31/rev/4a510243669e</a></pre></div><div class="change-set" id="c124"><div class="comment" data-id="9349251" data-no="124"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-124" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-124"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-124" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c124">Comment 124</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 11:50 PDT" data-time="1411498257">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-124">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-124" data-comment-id="9349251"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr24/rev/1a4ef6655b21">https://hg.mozilla.org/releases/mozilla-esr24/rev/1a4ef6655b21</a></pre></div><div class="change-set" id="c125"><div class="comment" data-id="9349285" data-no="125"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-125" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1260552_36541"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-125"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-125" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c125">Comment 125</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 11:58 PDT" data-time="1411498699">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-125">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-125" data-comment-id="9349285"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g32_v2_0/rev/4edd7f40672b">https://hg.mozilla.org/releases/mozilla-b2g32_v2_0/rev/4edd7f40672b</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=isnotempty">status-b2g-v1.4</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=isnotempty">status-firefox32</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Whiteboard: [status-firefox-esr24:affected][status-b2g-v1.3t:affected] &rarr; [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix]</div></div></div><div class="change-set" id="c126"><div class="comment" data-id="9349397" data-no="126"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-126" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-126"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-126" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c126">Comment 126</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 12:19 PDT" data-time="1411499991">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-126">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-126" data-comment-id="9349397">33: <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/fb8ff9258d02">https://hg.mozilla.org/releases/mozilla-beta/rev/fb8ff9258d02</a></pre></div><div class="change-set" id="c127"><div class="comment" data-id="9349424" data-no="127"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-127" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-127"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-127" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c127">Comment 127</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 12:25 PDT" data-time="1411500316">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-127">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-127" data-comment-id="9349424">34: <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/ecf229495d43">https://hg.mozilla.org/releases/mozilla-aurora/rev/ecf229495d43</a></pre></div><div class="change-set" id="c128"><div class="comment" data-id="9349443" data-no="128"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-128" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1260552_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1260552_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-128"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-128" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c128">Comment 128</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 12:29 PDT" data-time="1411500560">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-128">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-128" data-comment-id="9349443">35: <a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/60b7d13cfb6f">https://hg.mozilla.org/mozilla-central/rev/60b7d13cfb6f</a></pre></div><div class="change-set" id="a1277770_75935"><div class="change" id="aa1277770_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1277770_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1277770_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1277770_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1277770_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1277770_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 12:30 PDT" data-time="1411500634">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=isnotempty">status-firefox33</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c129"><div class="comment" data-id="9349829" data-no="129"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-129" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1277770_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a1277770_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-129"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-129" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c129">Comment 129</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 13:41 PDT" data-time="1411504862">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-129">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8493992"
         class="attachment patch"
         data-id="8493992" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="alternative.patch">
      <meta itemprop="contentSize" content="13780">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8493992">
          <a class="link" href="attachment.cgi?id=8493992&amp;action=diff">
        <span id="att-8493992-description" itemprop="description">Alternative patch for discussion; reduces exposure of public APIs</span></a>
        — <a href="attachment.cgi?id=8493992&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064636&attachment=8493992">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-129" data-comment-id="9349829">The attached patch is against a pre-patched trunk, and shows an alternative approach. It simplifies the code-path for RSA signatures in the VFY_ functions and forces the caller to be explicit about allowing degenerate signatures.

The key difference from the approach here is what Brian highlighted early on - C_VerifyRecover vs C_Verify as the PKCS#11 entry point.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493992&amp;action=edit"
           title="Alternative patch for discussion; reduces exposure of public APIs"
           class=""
        >Attachment #8493992</a> -
        Flags: feedback?(rrelyea)</div></div></div><div class="change-set" id="a1282314_381992"><div class="change" id="aa1282314_381992">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a1282314_381992"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_381992" id="a1282314_381992"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1282314_381992"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1282314_381992">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1282314_381992">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 13:46 PDT" data-time="1411505178">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493992&amp;action=edit"
           title="Alternative patch for discussion; reduces exposure of public APIs"
           class=""
        >Attachment #8493992</a> -
        Flags: feedback?(brian)</div></div></div><div class="change-set" id="c130"><div class="comment" data-id="9350118" data-no="130"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-130" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_3881" id="a1282314_381992"><img src="https://secure.gravatar.com/avatar/0a32391d55cfa63276f87eb9819dfbd0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_3881" id="a1282314_381992"><a class="email " href="/user_profile?user_id=3881" > <span class="fna">David Baron :dbaron:</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-130"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-130" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c130">Comment 130</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 14:23 PDT" data-time="1411507381">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-130">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-130" data-comment-id="9350118">landed <a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/9472206fdd12">https://hg.mozilla.org/mozilla-central/rev/9472206fdd12</a> as a build bustage fix; RyanVM is merging it around</pre></div><div class="change-set" id="c131"><div class="comment" data-id="9350205" data-no="131"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-131" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1282314_381992"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1282314_381992"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-131"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-131" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c131">Comment 131</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 14:37 PDT" data-time="1411508252">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-131">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-131" data-comment-id="9350205">Bustage fix landed on Aurora and Beta. As best we can tell, the issue we hit only affects the branches <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - build nss when MOZ_FOLD_LIBS with minimal set of exported symbols"
   href="/show_bug.cgi?id=1025998">bug 1025998</a> landed on.
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/fab3c895bc89">https://hg.mozilla.org/releases/mozilla-aurora/rev/fab3c895bc89</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/2431af782661">https://hg.mozilla.org/releases/mozilla-beta/rev/2431af782661</a></pre></div><div class="change-set" id="a1295180_336670"><div class="change" id="aa1295180_336670">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_336670" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/d8bebbee32670ee5755ce1bc535cd251?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_336670" id="a1295180_336670"><a class="email " href="/user_profile?user_id=336670" > <span class="fna">Kyle Huey (Exited; not receiving bugmail, old account, do not use)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1295180_336670"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1295180_336670">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1295180_336670">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 17:20 PDT" data-time="1411518044">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_REOPENED"
   title="REOPENED - Keep our nss.def in sync with nss's nss.def?"
   href="/show_bug.cgi?id=1072045">1072045</a></div></div></div><div class="change-set" id="c132"><div class="comment" data-id="9351309" data-no="132"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-132" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1295180_336670"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-132"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-132" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c132">Comment 132</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-23 19:29 PDT" data-time="1411525776">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-132">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-132" data-comment-id="9351309"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g32_v2_0m/rev/4edd7f40672b">https://hg.mozilla.org/releases/mozilla-b2g32_v2_0m/rev/4edd7f40672b</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c133"><div class="comment" data-id="9352312" data-no="133"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-133" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1295180_336670"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-133"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-133" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c133">Comment 133</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-24 01:39 PDT" data-time="1411547970">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-133">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-133" data-comment-id="9352312">Comment on <span class=""><a href="/attachment.cgi?id=8493992" name="attach_8493992" title="Alternative patch for discussion; reduces exposure of public APIs">attachment 8493992</a> <a href="/attachment.cgi?id=8493992&amp;action=edit" title="Alternative patch for discussion; reduces exposure of public APIs">[details]</a> <a href="/attachment.cgi?id=8493992&amp;action=diff" title="Alternative patch for discussion; reduces exposure of public APIs">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493992'>[review]</a>
Alternative patch for discussion; reduces exposure of public APIs

Review of <span class=""><a href="/attachment.cgi?id=8493992" name="attach_8493992" title="Alternative patch for discussion; reduces exposure of public APIs">attachment 8493992</a> <a href="/attachment.cgi?id=8493992&amp;action=edit" title="Alternative patch for discussion; reduces exposure of public APIs">[details]</a> <a href="/attachment.cgi?id=8493992&amp;action=diff" title="Alternative patch for discussion; reduces exposure of public APIs">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493992'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/secvfy.c
&#64;&#64; +19,3 &#64;&#64;
<span class="quote">&gt;  static SECStatus
&gt; +GetAlgorithmForUnknownDigestInfo(SECKEYPublicKey* key, const SECItem* sig,
&gt; +                                 SECOidTag* algorithm, void* wincx)</span >

This is much clearer than before. There is a performance penalty in the case where the caller did not pass in a hash algorithm to use. However, that case should be rare enough (in mozilla::pkix and libssl, it never happens, for example) that we shouldn't have to care about the performance implications. In fact, I consider all such code to be wrong and need fixing.

&#64;&#64; +78,5 &#64;&#64;
<span class="quote">&gt;      union {
&gt;  	unsigned char buffer[1];
&gt;  
&gt; +	/* the full RSA signature */
&gt; +	unsigned char rsasig[RSA_MAX_MODULUS_BITS / 8];</span >

This is the same &quot;64K is enough for anybody&quot; issue you mentioned before, right? The PKCS#11 token (perhaps a newer version of Softoken) might have a larger RSA max modulus size and then you run into the issue again of buffer overflow of PK11_VerifyRecover is buffer-overflowy. (BTW, <a class="bz_bug_link
          bz_status_ASSIGNED"
   title="ASSIGNED - softoken does not properly implement CKR_BUFFER_TOO_SMALL"
   href="/show_bug.cgi?id=921687">bug 921687</a> is the bug that you are worried about here, right?)

&#64;&#64; +543,5 &#64;&#64;
<span class="quote">&gt; +                                                 digestInfo);
&gt; +        /* Try to verify with a properly encoded NULL params. */
&gt; +        if (encodedDigestInfo &amp;&amp; PK11_Verify(cx-&gt;key, sig, encodedDigestInfo,
&gt; +                                             cx-&gt;wincx) != SECSuccess) {
&gt; +            /* Fall back to improperly encoded, omitted params */</span >

It is better to avoid doing this fallback. Otherwise, you make every RSA signature verification failure twice as expensive in CPU time. Normally, the efficiency of failure is not so important, but in some unfortunate cases of PKIX path building (both libpkix and mozilla::pkix), you may end up later finding a valid path after signature verification failure, and you still want that to be efficient. For this reason, I don't think this new patch is a net improvement.

We can avoid doing this fallback after we verify that it is safe to reject signatures that don't have the parameters encoded as an explicit NULL. We should have data on this from BoringSSL soon, since it doesn't do the fallback.

&#64;&#64; +550,5 &#64;&#64;
<span class="quote">&gt; +            encodedDigestInfo = SGN_EncodeDigestInfo(digestInfo-&gt;arena, NULL,
&gt; +                                                     digestInfo);
&gt; +        }
&gt; +        if (encodedDigestInfo &amp;&amp; PK11_Verify(cx-&gt;key, sig, encodedDigestInfo,
&gt; +                                             cx-&gt;wincx) == SECSuccess) {</span >

I think you intended this second PK11_Verify call to be conditional on the first one failing, right? But, instead, the code always calls PK11_Verify twice.

&#64;&#64; +608,5 &#64;&#64;
<span class="quote">&gt;      rv = SECFailure;
&gt;  
&gt;      cx = vfy_CreateContext(key, sig, encAlg, hashAlg, NULL, wincx);
&gt;      if (cx != NULL) {
&gt; +        rv = vfy_VerifyDigestInternal(cx, digest, sig);</span >

In a similar way to the way we cleaned this up, a similar cleanup can/should be done in ssl3_VerifySignedHashes.

::: lib/softoken/pkcs11c.c
&#64;&#64; +2880,5 &#64;&#64;
<span class="quote">&gt; +        goto done; /* Success! */
&gt; +    }
&gt; +    /* Fall back to degenerate encoding where parameters was omitted, which
&gt; +     * is a violation of RFC 3447. This is only included for backwards
&gt; +     * compatability */</span >

Again, this ends up hurting performance in the case where signature verification fails, which could still be important for some applications, such as applications that try to use PKCS#11 directly instead of using VFY_* for certificate signature verification. Ultimately, it doesn't seem like a net improvement.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493992&amp;action=edit"
           title="Alternative patch for discussion; reduces exposure of public APIs"
           class=""
        >Attachment #8493992</a> -
        Flags: <span class="activity-deleted">feedback?(brian)</span></div></div></div><div class="change-set" id="c134"><div class="comment" data-id="9372575" data-no="134"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-134" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a1295180_336670"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-134"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-134" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c134">Comment 134</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 00:39 PDT" data-time="1411976351">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-134">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-134" data-comment-id="9372575">We are recommending to partners with 1.3 that they apply the fix from this bug. I don't see a 1.3 fix in this bug and I'm not sure if we are/can still land on this branch. 

However IIUC, the patch for b2g28 should be the same as b2g30 (1.4) since they share the same NSS version - is this correct? What should be advising partners to do in terms of actually applying the fix to this issue?</pre></div><div class="change-set" id="c135"><div class="comment" data-id="9372643" data-no="135"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-135" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488321" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/732c108f6a5b8ebad575695d434507f6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488321" id="a1295180_336670"><a class="email disabled" href="/user_profile?user_id=488321" > <span class="fna">Vance Chen [:vchen][skype:vance.lucida][vchen&#64;mozilla.com]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-135"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-135" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c135">Comment 135</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 01:11 PDT" data-time="1411978300">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-135">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-135" data-comment-id="9372643">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c134">comment #134</a>)
<span class="quote">&gt; We are recommending to partners with 1.3 that they apply the fix from this
&gt; bug. I don't see a 1.3 fix in this bug and I'm not sure if we are/can still
&gt; land on this branch. 
&gt; 
&gt; However IIUC, the patch for b2g28 should be the same as b2g30 (1.4) since
&gt; they share the same NSS version - is this correct? What should be advising
&gt; partners to do in terms of actually applying the fix to this issue?</span >

Hi Paul, if it is confirmed that the patch for 1.4 can be applied to 1.3/1.3T as well, then TAM can help to ask partners to cherry-pick the patch into thier future 1.3/1.3T release(as I know, at least TCL/ZTE will have 1.3 FOTA release)

Thanks</pre><div class="activity"><div class="change">Flags: needinfo?(ptheriault)</div></div></div><div class="change-set" id="c136"><div class="comment" data-id="9372761" data-no="136"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-136" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456012" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/b6cfa8a834e550a51c2f4dfa364ecab7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_456012" id="a1295180_336670"><a class="email disabled" href="/user_profile?user_id=456012" > <span class="fna">David Palomino [:dpalomino]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-136"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-136" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c136">Comment 136</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 01:47 PDT" data-time="1411980465">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-136">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-136" data-comment-id="9372761">Hi, 

Thanks Vance and all for the info. Just to highlight that we'd need 1.3/1.3T patches, as Vance stated, and I think also the patch for FxOS 1.1. 

Not all the partners that launched FxOS 1.1 devices are planning to do an OTA to 1.3 (unfortunately). I think OEMs should have the possibility to integrate the 1.1 patch without jumping to 1.3. 

Thanks!
David</pre></div><div class="change-set" id="c137"><div class="comment" data-id="9373491" data-no="137"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-137" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a1295180_336670"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a1295180_336670"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-137"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-137" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c137">Comment 137</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 05:06 PDT" data-time="1411992414">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-137">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-137" data-comment-id="9373491">(In reply to Vance Chen [:vchen][<a href="mailto:vchen&#64;mozilla.com">vchen&#64;mozilla.com</a>] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c135">comment #135</a>)
<span class="quote">&gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c134">comment #134</a>)
&gt; &gt; We are recommending to partners with 1.3 that they apply the fix from this
&gt; &gt; bug. I don't see a 1.3 fix in this bug and I'm not sure if we are/can still
&gt; &gt; land on this branch. 
&gt; &gt; 
&gt; &gt; However IIUC, the patch for b2g28 should be the same as b2g30 (1.4) since
&gt; &gt; they share the same NSS version - is this correct? What should be advising
&gt; &gt; partners to do in terms of actually applying the fix to this issue?
&gt; 
&gt; Hi Paul, if it is confirmed that the patch for 1.4 can be applied to
&gt; 1.3/1.3T as well, then TAM can help to ask partners to cherry-pick the patch
&gt; into thier future 1.3/1.3T release(as I know, at least TCL/ZTE will have 1.3
&gt; FOTA release)
&gt; 
&gt; Thanks</span >

Thanks Vance, this was the motivation behind my request. Can anyone help out?



(In reply to David Palomino [:dpalomino] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c136">comment #136</a>)
<span class="quote">&gt; Hi, 
&gt; 
&gt; Thanks Vance and all for the info. Just to highlight that we'd need 1.3/1.3T
&gt; patches, as Vance stated, and I think also the patch for FxOS 1.1. 
&gt; 
&gt; Not all the partners that launched FxOS 1.1 devices are planning to do an
&gt; OTA to 1.3 (unfortunately). I think OEMs should have the possibility to
&gt; integrate the 1.1 patch without jumping to 1.3. 
&gt; 
&gt; Thanks!
&gt; David</span >

I'm not sure there is a lot of value in taking just this one fix back to 1.1 - 1.1 only contains security fixes up to FF23, and as such contains a large number of security vulnerabilities and patching just one doesn't seem to me to make users any more safe. (in the order of 40 high or critical security fixes at rough guess). Even 1.3 is insecure at this point, but its a lot better than 1.1.

That said, if partners want this then maybe we could invest the effort into either updating the NSS version of 1.1 or backporting the fix (I don't know what is easier or less risky or how feasible this is.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ptheriault)</span></div></div></div><div class="change-set" id="a1783576_75935"><div class="change" id="aa1783576_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1783576_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1783576_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1783576_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1783576_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1783576_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 09:00 PDT" data-time="1412006440">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: <span class="activity-deleted">[status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix]</span></div></div></div><div class="change-set" id="a1783608_75935"><div class="change" id="aa1783608_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1783608_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1783608_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1783608_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1783608_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1783608_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 09:01 PDT" data-time="1412006472">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix]</div></div></div><div class="change-set" id="c138"><div class="comment" data-id="9375190" data-no="138"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-138" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_448925" id="a1783608_75935"><img src="https://secure.gravatar.com/avatar/ddad9dfd62bcea71c45271191f1e8141?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_448925" id="a1783608_75935"><a class="email " href="/user_profile?user_id=448925" > <span class="fna">bhavana bajaj [:bajaj]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-138"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-138" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c138">Comment 138</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 10:14 PDT" data-time="1412010861">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-138">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-138" data-comment-id="9375190">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c137">comment #137</a>)
<span class="quote">&gt; (In reply to Vance Chen [:vchen][<a href="mailto:vchen&#64;mozilla.com">vchen&#64;mozilla.com</a>] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c135">comment #135</a>)
&gt; &gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c134">comment #134</a>)
&gt; &gt; &gt; We are recommending to partners with 1.3 that they apply the fix from this
&gt; &gt; &gt; bug. I don't see a 1.3 fix in this bug and I'm not sure if we are/can still
&gt; &gt; &gt; land on this branch. 
&gt; &gt; &gt; 
&gt; &gt; &gt; However IIUC, the patch for b2g28 should be the same as b2g30 (1.4) since
&gt; &gt; &gt; they share the same NSS version - is this correct? What should be advising
&gt; &gt; &gt; partners to do in terms of actually applying the fix to this issue?
&gt; &gt; 
&gt; &gt; Hi Paul, if it is confirmed that the patch for 1.4 can be applied to
&gt; &gt; 1.3/1.3T as well, then TAM can help to ask partners to cherry-pick the patch
&gt; &gt; into thier future 1.3/1.3T release(as I know, at least TCL/ZTE will have 1.3
&gt; &gt; FOTA release)
&gt; &gt; 
&gt; &gt; Thanks
&gt; 
&gt; Thanks Vance, this was the motivation behind my request. Can anyone help out?</span >

Hey Vance/Paul,

Yep b2g28 (1.3 and 1.3t) were updated to nss 3.16.2 in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update Mozilla 32 to use NSS 3.16.2 (once it's ready)"
   href="/show_bug.cgi?id=1020695">https://bugzilla.mozilla.org/show_bug.cgi?id=1020695</a>. So we basically need to point partners to this commit <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a> on top on latest 1.3. These should apply cleanly to 1.3 and 1.3T per ryan.


Kaie/Ryan, 

Please comment if the above does not hold true.
<span class="quote">&gt; 
&gt; 
&gt; 
&gt; (In reply to David Palomino [:dpalomino] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c136">comment #136</a>)
&gt; &gt; Hi, 
&gt; &gt; 
&gt; &gt; Thanks Vance and all for the info. Just to highlight that we'd need 1.3/1.3T
&gt; &gt; patches, as Vance stated, and I think also the patch for FxOS 1.1. 
&gt; &gt; 
&gt; &gt; Not all the partners that launched FxOS 1.1 devices are planning to do an
&gt; &gt; OTA to 1.3 (unfortunately). I think OEMs should have the possibility to
&gt; &gt; integrate the 1.1 patch without jumping to 1.3. 
&gt; &gt; 
&gt; &gt; Thanks!
&gt; &gt; David
&gt; 
&gt; I'm not sure there is a lot of value in taking just this one fix back to 1.1
&gt; - 1.1 only contains security fixes up to FF23, and as such contains a large
&gt; number of security vulnerabilities and patching just one doesn't seem to me
&gt; to make users any more safe. (in the order of 40 high or critical security
&gt; fixes at rough guess). Even 1.3 is insecure at this point, but its a lot
&gt; better than 1.1.
&gt; 
&gt; That said, if partners want this then maybe we could invest the effort into
&gt; either updating the NSS version of 1.1 or backporting the fix (I don't know
&gt; what is easier or less risky or how feasible this is.</span >

David,

I agree to Paul's comment, given how old 1.1 is and the unknown effort/risk involved in backporting these patches. I'd highly recommend us to push partners to update to atleast 1.3 at this point.</pre></div><div class="change-set" id="c139"><div class="comment" data-id="9375225" data-no="139"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-139" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488321" id="a1783608_75935"><img src="https://secure.gravatar.com/avatar/732c108f6a5b8ebad575695d434507f6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488321" id="a1783608_75935"><a class="email disabled" href="/user_profile?user_id=488321" > <span class="fna">Vance Chen [:vchen][skype:vance.lucida][vchen&#64;mozilla.com]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-139"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-139" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c139">Comment 139</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 10:19 PDT" data-time="1412011191">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-139">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-139" data-comment-id="9375225">(In reply to bhavana bajaj [:bajaj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c138">comment #138</a>)
<span class="quote">&gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c137">comment #137</a>)
&gt; &gt; (In reply to Vance Chen [:vchen][<a href="mailto:vchen&#64;mozilla.com">vchen&#64;mozilla.com</a>] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c135">comment #135</a>)
&gt; &gt; &gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c134">comment #134</a>)
&gt; &gt; &gt; &gt; We are recommending to partners with 1.3 that they apply the fix from this
&gt; &gt; &gt; &gt; bug. I don't see a 1.3 fix in this bug and I'm not sure if we are/can still
&gt; &gt; &gt; &gt; land on this branch. 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; However IIUC, the patch for b2g28 should be the same as b2g30 (1.4) since
&gt; &gt; &gt; &gt; they share the same NSS version - is this correct? What should be advising
&gt; &gt; &gt; &gt; partners to do in terms of actually applying the fix to this issue?
&gt; &gt; &gt; 
&gt; &gt; &gt; Hi Paul, if it is confirmed that the patch for 1.4 can be applied to
&gt; &gt; &gt; 1.3/1.3T as well, then TAM can help to ask partners to cherry-pick the patch
&gt; &gt; &gt; into thier future 1.3/1.3T release(as I know, at least TCL/ZTE will have 1.3
&gt; &gt; &gt; FOTA release)
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks
&gt; &gt; 
&gt; &gt; Thanks Vance, this was the motivation behind my request. Can anyone help out?
&gt; 
&gt; Hey Vance/Paul,
&gt; 
&gt; Yep b2g28 (1.3 and 1.3t) were updated to nss 3.16.2 in
&gt; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update Mozilla 32 to use NSS 3.16.2 (once it's ready)"
   href="/show_bug.cgi?id=1020695">https://bugzilla.mozilla.org/show_bug.cgi?id=1020695</a>. So we basically need
&gt; to point partners to this commit
&gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a> on top
&gt; on latest 1.3. These should apply cleanly to 1.3 and 1.3T per ryan.
&gt; </span >
Thanks Bhavana, i will inform partners and ask them to apply the security patch on their 1.3/1.3T source tree</pre></div><div class="change-set" id="a1800470_280903"><div class="change" id="aa1800470_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1800470_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a1800470_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1800470_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1800470_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1800470_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 13:42 PDT" data-time="1412023334">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c140"><div class="comment" data-id="9376692" data-no="140"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-140" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_411311" id="a1800470_280903"><img src="https://secure.gravatar.com/avatar/c05fddac7f28cc31ba6cff141ca4787e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_411311" id="a1800470_280903"><a class="email disabled" href="/user_profile?user_id=411311" > <span class="fna">Raymond Forbes[:rforbes]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-140"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-140" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c140">Comment 140</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 13:47 PDT" data-time="1412023628">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-140">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8497069"
         class="attachment"
         data-id="8497069" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bugbounty.data">
      <meta itemprop="contentSize" content="7">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8497069" itemprop="contentUrl">
        <span id="att-8497069-description" itemprop="description">antoine&#64;delignat-lavaud.fr,3000,2014-08-16,2014-09-24,2014-09-29,true,,,</span></a>
        — <a href="attachment.cgi?id=8497069&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a1800797_280903"><div class="change" id="aa1800797_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a1800797_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1800797_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1800797_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a1800797_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 13:47 PDT" data-time="1412023661">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2014-09-29 13:47 PDT" data-time="1412023661">7 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c141"><div class="comment" data-id="9393999" data-no="141"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-141" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456012" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/b6cfa8a834e550a51c2f4dfa364ecab7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_456012" id="a1800797_280903"><a class="email disabled" href="/user_profile?user_id=456012" > <span class="fna">David Palomino [:dpalomino]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-141"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-141" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c141">Comment 141</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-02 07:19 PDT" data-time="1412259542">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-141">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-141" data-comment-id="9393999">(In reply to Vance Chen [:vchen][<a href="mailto:vchen&#64;mozilla.com">vchen&#64;mozilla.com</a>] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c139">comment #139</a>)

<span class="quote">&gt; Thanks Bhavana, i will inform partners and ask them to apply the security
&gt; patch on their 1.3/1.3T source tree</span >

Hi, 

Just to double check, for 1.3 then partners should first apply the patch related to: 
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update Mozilla 32 to use NSS 3.16.2 (once it's ready)"
   href="/show_bug.cgi?id=1020695">https://bugzilla.mozilla.org/show_bug.cgi?id=1020695</a>.

And after that, apply then this issue's patch. Is that right?

Then I guess we need to land this also in 1.3 (and probably in 1.3T). Please, take into account that there are still some partners running IOTs and probably taking the code from our 1.3 branch. Probably this will be safer than asking to the OEMs to apply this patch separately (as they can do it anyway if they're working on their own branch). 

Thanks, 
David</pre></div><div class="change-set" id="c142"><div class="comment" data-id="9394019" data-no="142"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-142" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1800797_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-142"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-142" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c142">Comment 142</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-02 07:22 PDT" data-time="1412259746">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-142">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-142" data-comment-id="9394019">(In reply to David Palomino [:dpalomino] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c141">comment #141</a>)
<span class="quote">&gt; Just to double check, for 1.3 then partners should first apply the patch
&gt; related to: 
&gt; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update Mozilla 32 to use NSS 3.16.2 (once it's ready)"
   href="/show_bug.cgi?id=1020695">https://bugzilla.mozilla.org/show_bug.cgi?id=1020695</a>.
&gt; 
&gt; And after that, apply then this issue's patch. Is that right?</span >

No, 1.3/1.3t are already on NSS 3.16.2. The patch that landed on 1.4 (<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>) should apply cleanly without any additional patches required.</pre></div><div class="change-set" id="c143"><div class="comment" data-id="9394634" data-no="143"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-143" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456012" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/b6cfa8a834e550a51c2f4dfa364ecab7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_456012" id="a1800797_280903"><a class="email disabled" href="/user_profile?user_id=456012" > <span class="fna">David Palomino [:dpalomino]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-143"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-143" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c143">Comment 143</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-02 09:19 PDT" data-time="1412266786">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-143">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-143" data-comment-id="9394634">(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c142">comment #142</a>)

<span class="quote">&gt; No, 1.3/1.3t are already on NSS 3.16.2. The patch that landed on 1.4
&gt; (<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>) should
&gt; apply cleanly without any additional patches required.</span >

Thanks Ryan!

Then I think we need to land the patch also in 1.3 and 1.3t. Can you confirm that this is going to be landed? Is it possible to have some STR to check with a 1.3 device that the patch is been applied, and working fine?

Please, take into account that 1.3 is not dead at all, and there are several 1.3 based devices being deployed right now. 

Cheers, 
David</pre></div><div class="change-set" id="c144"><div class="comment" data-id="9395150" data-no="144"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-144" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1800797_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-144"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-144" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c144">Comment 144</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-02 10:30 PDT" data-time="1412271027">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-144">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-144" data-comment-id="9395150">(In reply to David Palomino [:dpalomino] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c143">comment #143</a>)
<span class="quote">&gt; Then I think we need to land the patch also in 1.3 and 1.3t. Can you confirm
&gt; that this is going to be landed?</span >

That's a decision for B2G Release Management to make, not me.</pre></div><div class="change-set" id="c145"><div class="comment" data-id="9397946" data-no="145"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-145" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447055" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/75676c94d4b097e3c4eff1966388a7f3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447055" id="a1800797_280903"><a class="email disabled" href="/user_profile?user_id=447055" > <span class="fna">Beatriz Rodríguez [:brg]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-145"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-145" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c145">Comment 145</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 00:09 PDT" data-time="1412320146">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-145">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-145" data-comment-id="9397946">Bhavana, Could you please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c143">comment #143</a> and approve the uplift of the patch to 1.3 and 1.3T branches as they are affected now and being released by some partners?
Thanks in advance.</pre><div class="activity"><div class="change">Flags: needinfo?(bbajaj)</div></div></div><div class="change-set" id="c146"><div class="comment" data-id="9401028" data-no="146"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-146" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1800797_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-146"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-146" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c146">Comment 146</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 12:30 PDT" data-time="1412364644">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-146">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-146" data-comment-id="9401028">Antoine, is there any part of this bug report or the related ones that you don't want to be public at this time? I'd like to make it public now so people can learn from it.</pre><div class="activity"><div class="change">Flags: needinfo?(antoine)</div></div></div><div class="change-set" id="c147"><div class="comment" data-id="9401222" data-no="147"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-147" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a1800797_280903"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-147"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-147" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c147">Comment 147</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 13:12 PDT" data-time="1412367150">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-147">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-147" data-comment-id="9401222">Hi Brian, feel free to make it public.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(antoine)</span></div></div></div><div class="change-set" id="c148"><div class="comment" data-id="9401744" data-no="148"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-148" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_448925" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/ddad9dfd62bcea71c45271191f1e8141?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_448925" id="a1800797_280903"><a class="email " href="/user_profile?user_id=448925" > <span class="fna">bhavana bajaj [:bajaj]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-148"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-148" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c148">Comment 148</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 14:45 PDT" data-time="1412372733">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-148">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-148" data-comment-id="9401744">(In reply to Beatriz Rodríguez [:brg] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c145">comment #145</a>)
<span class="quote">&gt; Bhavana, Could you please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c143">comment #143</a> and approve the uplift of the
&gt; patch to 1.3 and 1.3T branches as they are affected now and being released
&gt; by some partners?
&gt; Thanks in advance.</span >

You should be able to apply this <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>  on the 1.3 the 1.3T codebase. It should apply cleanly.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bbajaj)</span></div></div></div><div class="change-set" id="c149"><div class="comment" data-id="9401756" data-no="149"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-149" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_448925" id="a1800797_280903"><img src="https://secure.gravatar.com/avatar/ddad9dfd62bcea71c45271191f1e8141?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_448925" id="a1800797_280903"><a class="email " href="/user_profile?user_id=448925" > <span class="fna">bhavana bajaj [:bajaj]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-149"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-149" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c149">Comment 149</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 14:49 PDT" data-time="1412372951">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-149">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-149" data-comment-id="9401756">(In reply to bhavana bajaj [:bajaj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c148">comment #148</a>)
<span class="quote">&gt; (In reply to Beatriz Rodríguez [:brg] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c145">comment #145</a>)
&gt; &gt; Bhavana, Could you please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c143">comment #143</a> and approve the uplift of the
&gt; &gt; patch to 1.3 and 1.3T branches as they are affected now and being released
&gt; &gt; by some partners?
&gt; &gt; Thanks in advance.
&gt; 
&gt; You should be able to apply this
&gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>  on the
&gt; 1.3 the 1.3T codebase. It should apply cleanly.</span >

We've technically killed the branch on our side, hence you will have to cherry-pick and land this on your branches. Alternatively, I will check with release engineering if there is a way they can apply this in someway and spawn a build.</pre></div><div class="change-set" id="a2415904_280903"><div class="change" id="aa2415904_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2415904_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a2415904_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2415904_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2415904_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a2415904_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-06 16:39 PDT" data-time="1412638768">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix] &rarr; [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix][adv-main32+]</div></div></div><div class="change-set" id="a2482702_452604"><div class="change" id="aa2482702_452604">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a2482702_452604"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_452604" id="a2482702_452604"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2482702_452604"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2482702_452604">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a2482702_452604">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-07 11:12 PDT" data-time="1412705566">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=isnotempty">status-firefox32</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=isnotempty">status-firefox33</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a2502401_280903"><div class="change" id="aa2502401_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2502401_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a2502401_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2502401_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2502401_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a2502401_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-07 16:41 PDT" data-time="1412725265">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix][adv-main32+] &rarr; [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix][adv-main32+][adv-esr31.1+]</div></div></div><div class="change-set" id="c150"><div class="comment" data-id="9418278" data-no="150"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-150" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488321" id="a2502401_280903"><img src="https://secure.gravatar.com/avatar/732c108f6a5b8ebad575695d434507f6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488321" id="a2502401_280903"><a class="email disabled" href="/user_profile?user_id=488321" > <span class="fna">Vance Chen [:vchen][skype:vance.lucida][vchen&#64;mozilla.com]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-150"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-150" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c150">Comment 150</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-08 02:00 PDT" data-time="1412758822">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-150">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-150" data-comment-id="9418278">(In reply to bhavana bajaj [:bajaj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c149">comment #149</a>)
<span class="quote">&gt; (In reply to bhavana bajaj [:bajaj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c148">comment #148</a>)
&gt; &gt; (In reply to Beatriz Rodríguez [:brg] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c145">comment #145</a>)
&gt; &gt; &gt; Bhavana, Could you please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c143">comment #143</a> and approve the uplift of the
&gt; &gt; &gt; patch to 1.3 and 1.3T branches as they are affected now and being released
&gt; &gt; &gt; by some partners?
&gt; &gt; &gt; Thanks in advance.
&gt; &gt; 
&gt; &gt; You should be able to apply this
&gt; &gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>  on the
&gt; &gt; 1.3 the 1.3T codebase. It should apply cleanly.
&gt; 
&gt; We've technically killed the branch on our side, hence you will have to
&gt; cherry-pick and land this on your branches. Alternatively, I will check with
&gt; release engineering if there is a way they can apply this in someway and
&gt; spawn a build.</span >

Hi Bhavana -

Since some partners ship 1.3 devices around May, they didn't get a chance to update to the NSS 3.16.2. Hence I ask these partners to update to NSS 3.16.2 by appplying <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update Mozilla 32 to use NSS 3.16.2 (once it's ready)"
   href="/show_bug.cgi?id=1020695">https://bugzilla.mozilla.org/show_bug.cgi?id=1020695</a> first, and then pick <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>. However, they got the following compile errors:

gecko/netwerk/base/src/BackgroundFileSaver.cpp:7:21: fatal error: pk11pub.h: No such file or directory
gecko/netwerk/protocol/http/nsHttpChannel.cpp:43:18: fatal error: sslt.h: No such file or directory
gecko/netwerk/protocol/http/nsHttpConnection.cpp:17:18: fatal error: sslt.h: No such file or directory
compilation terminated. 

Could you suggest is there anything I missed here?

Thanks</pre><div class="activity"><div class="change">Flags: needinfo?(bbajaj)</div></div></div><div class="change-set" id="c151"><div class="comment" data-id="9419268" data-no="151"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-151" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456012" id="a2502401_280903"><img src="https://secure.gravatar.com/avatar/b6cfa8a834e550a51c2f4dfa364ecab7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_456012" id="a2502401_280903"><a class="email disabled" href="/user_profile?user_id=456012" > <span class="fna">David Palomino [:dpalomino]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-151"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-151" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c151">Comment 151</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-08 06:37 PDT" data-time="1412775441">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-151">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-151" data-comment-id="9419268">(In reply to Vance Chen [:vchen][<a href="mailto:vchen&#64;mozilla.com">vchen&#64;mozilla.com</a>] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c150">comment #150</a>)
<span class="quote">&gt; Since some partners ship 1.3 devices around May, they didn't get a chance to
&gt; update to the NSS 3.16.2. Hence I ask these partners to update to NSS 3.16.2
&gt; by appplying <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update Mozilla 32 to use NSS 3.16.2 (once it's ready)"
   href="/show_bug.cgi?id=1020695">https://bugzilla.mozilla.org/show_bug.cgi?id=1020695</a> first, and
&gt; then pick
&gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1">https://hg.mozilla.org/releases/mozilla-b2g30_v1_4/rev/5f35498d4aa1</a>.
&gt; However, they got the following compile errors:</span >
[...]

Hi, 

I really think we should facilitate the integration of this to our OEM partners, if we want them to apply the patch. For doing this, I think it'd be important to land this in 1.3 and 1.3t branches. That will make things much easier to our partners. 

What do you think?

David</pre></div><div class="change-set" id="c152"><div class="comment" data-id="9420119" data-no="152"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-152" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2502401_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a2502401_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-152"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-152" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c152">Comment 152</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-08 08:58 PDT" data-time="1412783889">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-152">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-152" data-comment-id="9420119">Can we please take the B2G 1.3 backporting discussion out of the bug? It's adding a lot of noise unrelated to the actual fixing of this issue.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bbajaj)</span></div></div></div><div class="change-set" id="a2573336_280903"><div class="change" id="aa2573336_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2573336_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a2573336_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2573336_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2573336_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a2573336_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-08 12:23 PDT" data-time="1412796200">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=33%2B">33+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=32%2B">32+</a></div></div></div><div class="change-set" id="c153"><div class="comment" data-id="9423094" data-no="153"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-153" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2573336_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a2573336_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-153"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-153" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c153">Comment 153</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-08 17:44 PDT" data-time="1412815443">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-153">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-153" data-comment-id="9423094">Landed on v1.3/v1.3t at Bhavana's request.

<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g28_v1_3/rev/b606d95b4011">https://hg.mozilla.org/releases/mozilla-b2g28_v1_3/rev/b606d95b4011</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g28_v1_3t/rev/b606d95b4011">https://hg.mozilla.org/releases/mozilla-b2g28_v1_3t/rev/b606d95b4011</a></pre><div class="activity"><div class="change">Whiteboard: [status-firefox-esr24:fixed][status-b2g-v1.3t:wontfix][adv-main32+][adv-esr31.1+] &rarr; [status-firefox-esr24:fixed][status-b2g-v1.3:fixed][status-b2g-v1.3t:fixed][adv-main32+][adv-esr31.1+]</div></div></div><div class="change-set" id="c154"><div class="comment" data-id="9423925" data-no="154"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-154" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447055" id="a2573336_280903"><img src="https://secure.gravatar.com/avatar/75676c94d4b097e3c4eff1966388a7f3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_447055" id="a2573336_280903"><a class="email disabled" href="/user_profile?user_id=447055" > <span class="fna">Beatriz Rodríguez [:brg]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-154"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-154" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c154">Comment 154</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-09 00:11 PDT" data-time="1412838677">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-154">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-154" data-comment-id="9423925">Thanks a lot for the effort to include them in 1.3 branches.
Do you know an easy way to verify if a user build is including this fix?</pre></div><div class="change-set" id="c155"><div class="comment" data-id="9424336" data-no="155"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-155" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456012" id="a2573336_280903"><img src="https://secure.gravatar.com/avatar/b6cfa8a834e550a51c2f4dfa364ecab7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_456012" id="a2573336_280903"><a class="email disabled" href="/user_profile?user_id=456012" > <span class="fna">David Palomino [:dpalomino]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-155"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-155" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c155">Comment 155</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-09 02:06 PDT" data-time="1412845570">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-155">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-155" data-comment-id="9424336">(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c153">comment #153</a>)
<span class="quote">&gt; Landed on v1.3/v1.3t at Bhavana's request.
&gt; 
&gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g28_v1_3/rev/b606d95b4011">https://hg.mozilla.org/releases/mozilla-b2g28_v1_3/rev/b606d95b4011</a>
&gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-b2g28_v1_3t/rev/b606d95b4011">https://hg.mozilla.org/releases/mozilla-b2g28_v1_3t/rev/b606d95b4011</a></span >

Thanks a lot!!!
David</pre></div><div class="change-set" id="a3170885_1689"><div class="change" id="aa3170885_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3170885_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3170885_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3170885_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3170885_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a3170885_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-15 10:22 PDT" data-time="1413393749">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a> &rarr; </div></div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a></div></div></div><div class="change-set" id="a4494163_1689"><div class="change" id="aa4494163_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4494163_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a4494163_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4494163_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4494163_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a4494163_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-30 17:57 PDT" data-time="1414717027">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security</span></div></div></div><div class="change-set" id="c157"><div class="comment" data-id="10588572" data-no="157"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-157" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a4494163_1689"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a4494163_1689"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-157"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-157" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#c157">Comment 157</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-06 15:01 PDT" data-time="1438898472">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-157">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-157" data-comment-id="10588572">Comment on <span class=""><a href="/attachment.cgi?id=8493992" name="attach_8493992" title="Alternative patch for discussion; reduces exposure of public APIs">attachment 8493992</a> <a href="/attachment.cgi?id=8493992&amp;action=edit" title="Alternative patch for discussion; reduces exposure of public APIs">[details]</a> <a href="/attachment.cgi?id=8493992&amp;action=diff" title="Alternative patch for discussion; reduces exposure of public APIs">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493992'>[review]</a>
Alternative patch for discussion; reduces exposure of public APIs

Review of <span class=""><a href="/attachment.cgi?id=8493992" name="attach_8493992" title="Alternative patch for discussion; reduces exposure of public APIs">attachment 8493992</a> <a href="/attachment.cgi?id=8493992&amp;action=edit" title="Alternative patch for discussion; reduces exposure of public APIs">[details]</a> <a href="/attachment.cgi?id=8493992&amp;action=diff" title="Alternative patch for discussion; reduces exposure of public APIs">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064636&amp;attachment=8493992'>[review]</a>:
-----------------------------------------------------------------

Sorry I'm months late to the party. 

I think Brian's feedback is pretty good here. I'm actually happy with what got checked in.

bob</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493992&amp;action=edit"
           title="Alternative patch for discussion; reduces exposure of public APIs"
           class=""
        >Attachment #8493992</a> -
        Flags: feedback?(rrelyea) &rarr; feedback-</div></div></div><div class="change-set" id="a110038463_36541"><div class="change" id="aa110038463_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a110038463_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a110038463_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a110038463_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a110038463_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a110038463_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 06:48 PST" data-time="1520261327">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8493860&amp;action=edit"
           title="part1-v10"
           class=""
        >Attachment #8493860</a> -
        Attachment is patch: true</div><div class="change">
        <a href="/attachment.cgi?id=8493860&amp;action=edit"
           title="part1-v10"
           class=""
        >Attachment #8493860</a> -
        Attachment mime type: text/x-patch &rarr; text/plain</div></div></div><div class="change-set" id="a122385359_36541"><div class="change" id="aa122385359_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a122385359_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a122385359_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a122385359_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a122385359_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064636#a122385359_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-26 05:30 PDT" data-time="1532608223">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disable parameter unsafeAllowMissingParameters in _SGN_VerifyPKCS1DigestInfo"
   href="/show_bug.cgi?id=1296986">1296986</a></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1064636&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>