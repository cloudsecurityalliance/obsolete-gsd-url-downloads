--- mod_auth_kerb-5.0-rc6/spnegokrb5/der_get.c.vg	2006-09-19 11:16:43.000000000 -0400
+++ mod_auth_kerb-5.0-rc6/spnegokrb5/der_get.c	2006-09-19 11:14:49.000000000 -0400
@@ -151,7 +151,7 @@
     if (len < 1)
 	return ASN1_OVERRUN;
 
-    data->components = malloc(len * sizeof(*data->components));
+    data->components = malloc((len + 1) * sizeof(*data->components));
     if (data->components == NULL && len != 0)
 	return ENOMEM;
     data->components[0] = (*p) / 40;
