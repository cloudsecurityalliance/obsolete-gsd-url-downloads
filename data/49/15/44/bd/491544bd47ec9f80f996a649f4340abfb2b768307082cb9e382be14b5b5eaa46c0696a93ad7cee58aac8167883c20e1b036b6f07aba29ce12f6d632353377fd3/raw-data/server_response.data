<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - SSL_VERIFYSTATUS ignored - CVE-2017-2629</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="STYLESHEET" type="text/css" href="https://curl.se/manpage.css">
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">Web Site Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/hsts.html">HSTS</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http2.html">HTTP/2</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/changes.html">Changelog</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/security.html">Security Problems</a>
    <a href="/docs/versions.html">Version Nums</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/manual.html">Tutorial</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">Security Problems</a> / <b>SSL_VERIFYSTATUS ignored</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/changes.html">Changelog</a>
<br><a href="/donation.html">Donate</a>
<br><a href="faq.html">FAQ</a>
<br><a href="security.html">Security Problems</a>
<br><a href="/dev/secprocess.html">Security Process</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<h1 id="ssl_verifystatus-ignored">SSL_VERIFYSTATUS ignored</h1>
<p>Project curl Security Advisory, February 22, 2017 - <a href="https://curl.se/docs/CVE-2017-2629.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>curl and libcurl support &quot;OCSP stapling&quot;, also known as the TLS Certificate Status Request extension (using the <code><a href="https://curl.se/libcurl/c/CURLOPT_SSL_VERIFYSTATUS.html">CURLOPT_SSL_VERIFYSTATUS</a></code> option). When telling curl to use this feature, it uses that TLS extension to ask for a fresh proof of the server's certificate's validity. If the server doesn't support the extension, or fails to provide said proof, curl is expected to return an error.</p>
<p>Due to a coding mistake, the code that checks for a test success or failure, ends up always thinking there's valid proof, even when there is none or if the server doesn't support the TLS extension in question. Contrary to how it used to function and contrary to how this feature is documented to work.</p>
<p>This could lead to users not detecting when a server's certificate goes invalid or otherwise be mislead that the server is in a better shape than it is in reality.</p>
<p>This flaw also exists in the command line tool (<a href="https://curl.se/docs/manpage.html#--cert-status">--cert-status</a>).</p>
<p>We are not aware of any exploit of this flaw.</p>
<h2 id="info">INFO</h2>
<p>The mistake happened in a large code merge for the HTTPS proxy feature (commit cb4e2be7c6d42ca0780) and went unnoticed primarily because we have no automated tests for this feature!</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2017-2629 to this issue.</p>
<p>CWE-304: Missing Critical Step in Authentication</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<p>curl has supported this option since version <a href="vuln-7.41.0.html">7.41.0</a>.</p>
<p>This flaw exists in the following curl and libcurl versions.</p>
<ul>
<li>Affected versions: <a href="vuln-7.52.0.html">7.52.0</a> to and including <a href="vuln-7.52.1.html">7.52.1</a></li>
<li>Not affected versions: &lt; <a href="vuln-7.52.0.html">7.52.0</a> and &gt;= <a href="vuln-7.53.0.html">7.53.0</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as such!</p>
<h2 id="the-solution">THE SOLUTION</h2>
<p>In version <a href="vuln-7.53.0.html">7.53.0</a>, the actual result of the check is properly used.</p>
<p>A <a href="https://curl.se/CVE-2017-2629.patch">patch for CVE-2017-2629</a> is available.</p>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in order of preference:</p>
<p>A - Upgrade curl and libcurl to version <a href="vuln-7.53.0.html">7.53.0</a></p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Do not use the cert status feature</p>
<h2 id="time-line">TIME LINE</h2>
<p>It was first reported to the curl project on January 12.</p>
<p>We contacted distros@openwall on February 15.</p>
<p>curl <a href="vuln-7.53.0.html">7.53.0</a> was released on February 22 2017, coordinated with the publication of this advisory.</p>
<h2 id="credits">CREDITS</h2>
<p>Reported by Marcus Hoffmann</p>
</div>
</div>
<script defer src="https://www.fastly-insights.com/insights.js?k=8cb1247c-87c2-4af9-9229-768b1990f90b" type="text/javascript"></script>
</body> </html>
