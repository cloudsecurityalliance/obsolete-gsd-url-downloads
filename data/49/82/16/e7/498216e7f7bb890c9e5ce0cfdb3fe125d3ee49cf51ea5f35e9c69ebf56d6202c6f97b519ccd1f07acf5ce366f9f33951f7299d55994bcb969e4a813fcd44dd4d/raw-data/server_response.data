<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/horizon/+bug/1394370/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1394370 “[OSSA 2014-040] horizon login page is vulnerable t...” : Bugs : OpenStack Dashboard (Horizon)</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1394370" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1394370/bug.atom" title="Bug 1394370 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="We have horizon deployed with mysql sessions.   I believe this issue exists with all db backed sessions, and likely memchached too (but I am not sure).

Every request to the login page is generating a new session record in the db.  This is based upon this line of code:
https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L41
What happens is as soon as you access request.session['foo'] then you are going to get an entry in the db.

I have placed some debugging co..." />
      <meta property="og:description" content="We have horizon deployed with mysql sessions.   I believe this issue exists with all db backed sessions, and likely memchached too (but I am not sure).

Every request to the login page is generating a new session record in the db.  This is based upon this line of code:
https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L41
What happens is as soon as you access request.session['foo'] then you are going to get an entry in the db.

I have placed some debugging co..." />
    

    
    
      <meta property="og:title" content="Bug #1394370 “[OSSA 2014-040] horizon login page is vulnerable t...” : Bugs : OpenStack Dashboard (Horizon)" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1394370" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["accessibility", "angularjs", "branding", "ceilometer", "ceph", "cinder", "dashboard-core", "django-bug", "django22", "documentation", "error-reporting", "glance", "heat", "horizon-core", "i18n", "ie", "integration-tests", "keystone", "large-scale", "low-hanging-fruit", "material", "neutron", "nova", "ocata-backport-potential", "ops", "pagination", "performance", "pike-backport-potential", "python3", "queens-backport-potential", "rbac", "rocky-backport-potential", "security", "stein-backport-potential", "swift", "topology-view", "train-backport-potential", "train-rc-potential", "uncaught-403", "unittest", "ussuri-backport-potential", "ux", "victoria-backport-potential"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/horizon/+bug/1394370/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/horizon"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/62132867/os64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/horizon">OpenStack Dashboard (Horizon)</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/horizon">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/horizon">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/horizon">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/horizon">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/horizon">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/horizon">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1394370 reported by
      <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson</a>
      <time title="2014-11-19 21:58:06 UTC" datetime="2014-11-19T21:58:06.166172+00:00">on 2014-11-19</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">266</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 2 people</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary1719772">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/horizon/+bug/1394370/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1719772">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/horizon">OpenStack Dashboard (Horizon)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/horizon/+bug/1394370/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/horizon/+bug/1394370/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1719772">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~ericpeterson-l">Eric Peterson</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/horizon/+milestone/2015.1.0">OpenStack Dashboard (Horizon) 2015.1.0 "kilo"</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1719772">
     <td colspan="7"><form action="/horizon/+bug/1394370/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/horizon">OpenStack Dashboard (Horizon)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-11-19 21:58:06 UTC" datetime="2014-11-19T21:58:06.166172+00:00">2014-11-19</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-11-20 18:11:00 UTC" datetime="2014-11-20T18:11:00.384633+00:00">2014-11-20</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-12-09 15:00:11 UTC" datetime="2014-12-09T15:00:11.354530+00:00">2014-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-12-09 15:00:11 UTC" datetime="2014-12-09T15:00:11.430934+00:00">2014-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-12-18 16:20:19 UTC" datetime="2014-12-18T16:20:19.145820+00:00">2014-12-18</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="horizon.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="horizon.target.option.package" name="horizon.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="horizon.target.distribution" name="horizon.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="horizon.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="horizon.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="horizon.target.package"
                         name="horizon.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;horizon.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('horizon.target.package');
              var select_menu = Y.DOM.byId('horizon.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-horizon-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": null, "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "horizon.target.package", "show_widget_id": "show-widget-horizon-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-horizon-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="horizon.target.option.product" name="horizon.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="horizon" id="horizon.target.product"
                         name="horizon.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;horizon.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('horizon.target.product');
              var select_menu = Y.DOM.byId('horizon.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-horizon-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": "horizon", "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "horizon.target.product", "show_widget_id": "show-widget-horizon-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-horizon-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="horizon.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="horizon.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="horizon.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="horizon.status" name="horizon.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="horizon.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Dashboard (Horizon) 2015.1.0
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="horizon.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="horizon.assignee.assign_to_me" name="horizon.assignee.option" value="horizon.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="horizon.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="horizon.assignee.assigned_to" name="horizon.assignee.option" value="horizon.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="horizon.assignee.assigned_to">
              Eric Peterson (ericpeterson-l)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="horizon.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="horizon.comment_on_change" name="horizon.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1722159">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/horizon/icehouse/+bug/1394370/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/horizon/icehouse">Icehouse</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/horizon/icehouse/+bug/1394370/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/horizon/icehouse/+bug/1394370/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1722159">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~lin-hua-cheng">Lin Hua Cheng</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/horizon/+milestone/2014.1.4">OpenStack Dashboard (Horizon) 2014.1.4</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1722159">
     <td colspan="7"><form action="/horizon/icehouse/+bug/1394370/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/horizon/icehouse">OpenStack Dashboard (Horizon) icehouse</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-11-24 15:09:41 UTC" datetime="2014-11-24T15:09:41.622314+00:00">2014-11-24</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-12-04 13:45:27 UTC" datetime="2014-12-04T13:45:27.376974+00:00">2014-12-04</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-12-05 02:19:14 UTC" datetime="2014-12-05T02:19:14.344215+00:00">2014-12-05</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-12-09 15:01:12 UTC" datetime="2014-12-09T15:01:12.311303+00:00">2014-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2015-03-13 01:00:43 UTC" datetime="2015-03-13T01:00:43.585080+00:00">2015-03-13</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="horizon_icehouse.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="horizon_icehouse.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="horizon_icehouse.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="horizon_icehouse.status" name="horizon_icehouse.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="horizon_icehouse.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Dashboard (Horizon) 2014.1.4
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="horizon_icehouse.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="horizon_icehouse.assignee.assign_to_me" name="horizon_icehouse.assignee.option" value="horizon_icehouse.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="horizon_icehouse.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="horizon_icehouse.assignee.assigned_to" name="horizon_icehouse.assignee.option" value="horizon_icehouse.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="horizon_icehouse.assignee.assigned_to">
              Lin Hua Cheng (lin-hua-cheng)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="horizon_icehouse.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="horizon_icehouse.comment_on_change" name="horizon_icehouse.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1722160">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/horizon/juno/+bug/1394370/+editstatus">
        &#8203;
      </a>
    </td>
    <td style="padding: 0.3em 0em 0.3em 1.5em">
      <span class="sprite milestone"></span>
      
        <a href="https://bugs.launchpad.net/horizon/juno">Juno</a>
      
        
    </td>
    

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/horizon/juno/+bug/1394370/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/horizon/juno/+bug/1394370/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1722160">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~tristan-cacqueray">Tristan Cacqueray</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/horizon/+milestone/2014.2.2">OpenStack Dashboard (Horizon) 2014.2.2</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1722160">
     <td colspan="7"><form action="/horizon/juno/+bug/1394370/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/horizon/juno">OpenStack Dashboard (Horizon) juno</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-11-24 15:09:41 UTC" datetime="2014-11-24T15:09:41.622314+00:00">2014-11-24</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-12-08 15:02:34 UTC" datetime="2014-12-08T15:02:34.588446+00:00">2014-12-08</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-12-09 15:12:04 UTC" datetime="2014-12-09T15:12:04.588872+00:00">2014-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-12-09 15:12:04 UTC" datetime="2014-12-09T15:12:04.616897+00:00">2014-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2016-03-21 09:56:55 UTC" datetime="2016-03-21T09:56:55.211748+00:00">2016-03-21</time>
      </td>
    </tr>
  </table>
  <div class="field">
    
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="horizon_juno.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="horizon_juno.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="horizon_juno.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="horizon_juno.status" name="horizon_juno.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="horizon_juno.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Dashboard (Horizon) 2014.2.2
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="horizon_juno.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="horizon_juno.assignee.assign_to_me" name="horizon_juno.assignee.option" value="horizon_juno.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="horizon_juno.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="horizon_juno.assignee.assigned_to" name="horizon_juno.assignee.option" value="horizon_juno.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="horizon_juno.assignee.assigned_to">
              Tristan Cacqueray (tristan-cacqueray)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="horizon_juno.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="horizon_juno.comment_on_change" name="horizon_juno.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary1719839">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1394370/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1719839">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1394370/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1394370/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceHIGH">High</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1719839">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~tristan-cacqueray">Tristan Cacqueray</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1719839">
     <td colspan="7"><form action="/ossa/+bug/1394370/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-11-20 00:51:09 UTC" datetime="2014-11-20T00:51:09.947263+00:00">2014-11-20</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-11-21 13:55:37 UTC" datetime="2014-11-21T13:55:37.598297+00:00">2014-11-21</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-11-21 14:26:01 UTC" datetime="2014-11-21T14:26:01.822293+00:00">2014-11-21</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-12-01 21:35:09 UTC" datetime="2014-12-01T21:35:09.438894+00:00">2014-12-01</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-12-10 16:07:19 UTC" datetime="2014-12-10T16:07:19.752352+00:00">2014-12-10</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a package", "show_remove_button": false, "selected_value": null, "step_title": "Search by name", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "DistributionPackage", "input_element": "ossa.target.package", "show_widget_id": "show-widget-ossa-target-package", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_team_text": "Remove team", "header": "Select a project", "show_remove_button": false, "selected_value": "ossa", "step_title": "Search", "show_assign_me_button": false, "vocabulary_filters": [], "vocabulary_name": "Product", "input_element": "ossa.target.product", "show_widget_id": "show-widget-ossa-target-product", "assign_me_text": "Pick me", "show_create_team": false, "remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "selected_value_metadata": null};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceHIGH">High</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Tristan Cacqueray (tristan-cacqueray)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/horizon/+bug/1394370/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/horizon/+bug/1394370/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/horizon/+bug/1394370/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>We have horizon deployed with mysql sessions.   I believe this issue exists with all db backed sessions, and likely memchached too (but I am not sure).</p>
<p>Every request to the login page is generating a new session record in the db.  This is based upon this line of code:<br />
<a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L41">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />backends/<wbr />db.py#L41</a><br />
What happens is as soon as you access request.<wbr />session[<wbr />&#x27;foo&#x27;] then you are going to get an entry in the db.</p>
<p>I have placed some debugging code in a variety of locations where we are accessing the session store before we should be, which creates these records:</p>
<p><a rel="nofollow" href="https://github.com/openstack/horizon/blob/master/horizon/middleware.py#L94">https:/<wbr />/github.<wbr />com/openstack/<wbr />horizon/<wbr />blob/master/<wbr />horizon/<wbr />middleware.<wbr />py#L94</a><br />
The check for the timeout should never occur if there is no authenticated user.   So the check a few lines below needs to be moved higher.</p>
<p><a rel="nofollow" href="https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L50">https:/<wbr />/github.<wbr />com/openstack/<wbr />django_<wbr />openstack_<wbr />auth/blob/<wbr />master/<wbr />openstack_<wbr />auth/utils.<wbr />py#L50</a><br />
This check I am not sure how to work around.  We are accessing the session, which creates records, just trying to keep track if a user is logged in or not.   It seems like we are not using the django auth mechanisms correctly here, and I can&#x27;t see if there is a workaround.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2014-8124" title="OpenStack Dashboard (Horizon) before ...">2014-8124</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-19T22:26:45.121217+00:00" title="2014-11-19 22:26:45 UTC">on 2014-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><a rel="nofollow" href="https://github.com/openstack/horizon/blob/master/openstack_dashboard/views.py#L45">https:/<wbr />/github.<wbr />com/openstack/<wbr />horizon/<wbr />blob/master/<wbr />openstack_<wbr />dashboard/<wbr />views.py#<wbr />L45</a></p>
<p>Also contributes to this issue.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">https://github.com/openstack/horizon/blob/master/openstack_dashboard/views.py#L45

Also contributes to this issue.

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-19T22:36:21.996469+00:00" title="2014-11-19 22:36:21 UTC">on 2014-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>both the session clear and the set_test_cookie will cause a new session record to be created (fyi)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">both the session clear and the set_test_cookie will cause a new session record to be created (fyi)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-19T23:25:48.921587+00:00" title="2014-11-19 23:25:48 UTC">on 2014-11-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>A good overview / description is in this thread:<br />
<a rel="nofollow" href="http://stackoverflow.com/questions/4444758/huge-django-session-table-normal-behaviour-or-bug">http://<wbr />stackoverflow.<wbr />com/questions/<wbr />4444758/<wbr />huge-django-<wbr />session-<wbr />table-normal-<wbr />behaviour-<wbr />or-bug</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">A good overview / description is in this thread:
http://stackoverflow.com/questions/4444758/huge-django-session-table-normal-behaviour-or-bug
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-11-20 00:51:18 UTC" datetime="2014-11-20T00:51:18.080453+00:00">on 2014-11-20</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T01:09:01.272226+00:00" title="2014-11-20 01:09:01 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks for the report. This sounds like a bug with potencial security consequence, so I&#x27;ve added an incomplete security advisory task and subscribed Horizon&#x27;s core security reviewers to comment.</p>
<p>How many extraneous sessions are created that could have been avoided ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks for the report. This sounds like a bug with potencial security consequence, so I've added an incomplete security advisory task and subscribed Horizon's core security reviewers to comment.

How many extraneous sessions are created that could have been avoided ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T02:27:13.617906+00:00" title="2014-11-20 02:27:13 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>There is one session created for each request to horizon.   So if you created a script to perform a bunch of curl requests to horizon, each curl requests gets a record in the db.</p>
<p>I found this with load balancer health checks, which occur fairly frequently.  We had about 1,000 records within an hour for each instance of horizon for a conservative load balancer check.   If I wanted to, I would expect I could create many more than this.</p>
<p>If I add extra django settings to cap the cookie age and a cron job to clean up these records, it is possible to somewhat limit the severity of what impact such health checks have so that the number does not grow much past our 1,000 per horizon instance.   However, if a user wants to be malicious there is really a high ceiling of damage that can be done  (especially with default settings from horizon and django).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">There is one session created for each request to horizon.   So if you created a script to perform a bunch of curl requests to horizon, each curl requests gets a record in the db.

I found this with load balancer health checks, which occur fairly frequently.  We had about 1,000 records within an hour for each instance of horizon for a conservative load balancer check.   If I wanted to, I would expect I could create many more than this.

If I add extra django settings to cap the cookie age and a cron job to clean up these records, it is possible to somewhat limit the severity of what impact such health checks have so that the number does not grow much past our 1,000 per horizon instance.   However, if a user wants to be malicious there is really a high ceiling of damage that can be done  (especially with default settings from horizon and django).


</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lin-hua-cheng" class="sprite person">Lin Hua Cheng (lin-hua-cheng)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T15:31:04.595293+00:00" title="2014-11-20 15:31:04 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>For the service health check, it would probably be better to create a separate page that doesn&#x27;t call set_test_cookie() method as describe here: <a rel="nofollow" href="http://stackoverflow.com/questions/17098142/django-session-created-in-database-when-login-page-loaded?lq=1">http://<wbr />stackoverflow.<wbr />com/questions/<wbr />17098142/<wbr />django-<wbr />session-<wbr />created-<wbr />in-database-<wbr />when-login-<wbr />page-loaded?<wbr />lq=1</a></p>
<p>We can add that separate page in Horizon that is used just to check if Horizon is serving pages. Thoughts?</p>
<p>To summarize, seems there are three issue here that causes session to be created in the login page:<br />
1. setting user object in the request:<br />
<a rel="nofollow" href="https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L50">https:/<wbr />/github.<wbr />com/openstack/<wbr />django_<wbr />openstack_<wbr />auth/blob/<wbr />master/<wbr />openstack_<wbr />auth/utils.<wbr />py#L50</a></p>
<p>Once the request.user is accessed it will trigger a read on the SESSION for the session_key to get the user_id, then from the user_id fetch it in the backend. Seems like there is no way around checking if there is an authenticated user or not without hitting a read on the Session.</p>
<p>2. middleware that check session timeout: <a rel="nofollow" href="https://github.com/openstack/horizon/blob/master/horizon/middleware.py#L94">https:/<wbr />/github.<wbr />com/openstack/<wbr />horizon/<wbr />blob/master/<wbr />horizon/<wbr />middleware.<wbr />py#L94</a></p>
<p>Even if we moved the check for authenticated user before timeout checking, this will still create a session because the middleware is going to call request.<wbr />user.is_<wbr />authenticated(<wbr />)  - see #1.</p>
<p>3. set_test_cookie and session clear: <a rel="nofollow" href="https://github.com/openstack/horizon/blob/master/openstack_dashboard/views.py#L45">https:/<wbr />/github.<wbr />com/openstack/<wbr />horizon/<wbr />blob/master/<wbr />openstack_<wbr />dashboard/<wbr />views.py#<wbr />L45</a></p>
<p>set_test_cookie is getting deprecated in the Login form for Django 1.7. It is suggested to just use CSRF protected view. We have a CSRF middleware that does a blanket protection on all pages, perhaps we can just remove it?</p>
<p>Django 1.7 deprecation notes (<a rel="nofollow" href="https://docs.djangoproject.com/en/dev/internals/deprecation/">https:/<wbr />/docs.djangopro<wbr />ject.com/<wbr />en/dev/<wbr />internals/<wbr />deprecation/</a>):  &quot;The undocumented check_for_<wbr />test_cookie method in AuthenticationForm will be removed following an accelerated deprecation. Users subclassing this form should remove calls to this method, and instead ensure that their auth related views are CSRF protected, which ensures that cookies are enabled.&quot;</p>
<p>Even if we fix #3, we still have the same problem due to #1 and #2.  I think any application can be targetted with DOS attack by just sending too many requests from a malicious attacker. For example other services have rate limiting in place to prevent that, it would be up to the operator to put the security in place to detect the attack.</p>
<p>I am not sure if we can really do anything about it, other than providing a health check page that won&#x27;t create sessions everytime it is hit.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">For the service health check, it would probably be better to create a separate page that doesn't call set_test_cookie() method as describe here: http://stackoverflow.com/questions/17098142/django-session-created-in-database-when-login-page-loaded?lq=1

We can add that separate page in Horizon that is used just to check if Horizon is serving pages. Thoughts?

To summarize, seems there are three issue here that causes session to be created in the login page:
1. setting user object in the request:
https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L50

Once the request.user is accessed it will trigger a read on the SESSION for the session_key to get the user_id, then from the user_id fetch it in the backend. Seems like there is no way around checking if there is an authenticated user or not without hitting a read on the Session.

2. middleware that check session timeout: https://github.com/openstack/horizon/blob/master/horizon/middleware.py#L94

Even if we moved the check for authenticated user before timeout checking, this will still create a session because the middleware is going to call request.user.is_authenticated()  - see #1. 

3. set_test_cookie and session clear: https://github.com/openstack/horizon/blob/master/openstack_dashboard/views.py#L45

set_test_cookie is getting deprecated in the Login form for Django 1.7. It is suggested to just use CSRF protected view. We have a CSRF middleware that does a blanket protection on all pages, perhaps we can just remove it?

Django 1.7 deprecation notes (https://docs.djangoproject.com/en/dev/internals/deprecation/):  "The undocumented check_for_test_cookie method in AuthenticationForm will be removed following an accelerated deprecation. Users subclassing this form should remove calls to this method, and instead ensure that their auth related views are CSRF protected, which ensures that cookies are enabled."

Even if we fix #3, we still have the same problem due to #1 and #2.  I think any application can be targetted with DOS attack by just sending too many requests from a malicious attacker. For example other services have rate limiting in place to prevent that, it would be up to the operator to put the security in place to detect the attack. 

I am not sure if we can really do anything about it, other than providing a health check page that won't create sessions everytime it is hit.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T15:53:52.946648+00:00" title="2014-11-20 15:53:52 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264421/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">solution patch</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4264421">Edit</a>
        (3.3 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This patch resolves the issue, tested with MySQL backend.</p>
<p>It delays access to the session until a user has been authenticated.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This patch resolves the issue, tested with MySQL backend.

It delays access to the session until a user has been authenticated.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T16:23:40.308213+00:00" title="2014-11-20 16:23:40 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264456/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">patch with pep8 and unit test corrections - final patch</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4264456">Edit</a>
        (3.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This patch has minor corrections for unit tests and pep8 issues.</p>
<p>I believe this should be the final fix.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This patch has minor corrections for unit tests and pep8 issues.

I believe this should be the final fix.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T16:27:51.527432+00:00" title="2014-11-20 16:27:51 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264463/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">pydoc correction</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4264463">Edit</a>
        (3.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Correction to pydocs requested by Lin Hua Cheng.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Correction to pydocs requested by Lin Hua Cheng.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lin-hua-cheng" class="sprite person">Lin Hua Cheng (lin-hua-cheng)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T17:03:55.096735+00:00" title="2014-11-20 17:03:55 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>patch LGTM, will wait for other cores to review.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">patch LGTM, will wait for other cores to review.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~david-lyle" class="sprite person">David Lyle (david-lyle)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T18:13:42.203955+00:00" title="2014-11-20 18:13:42 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>There is no need to create the session for unauthenticated requests.</p>
<p>The patch looks good to me. I think there is a potential need for a health check URL, but that seems to be a greater OpenStack need to arrive at a consistent mechanism for doing health checks.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">There is no need to create the session for unauthenticated requests.

The patch looks good to me. I think there is a potential need for a health check URL, but that seems to be a greater OpenStack need to arrive at a consistent mechanism for doing health checks. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in horizon: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-20T21:18:31.170260+00:00" title="2014-11-20 21:18:31 UTC">on 2014-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks David for confirming the bug on Horizon project!</p>
<p>Now for the OSSA part, should we keep this under embargo and does this qualify as a DOS attack vector ?</p>
<p>Considering there is no amplification and that one connection results in one database entry I would triage this as class D bug (according to our new taxonomy described here: <a rel="nofollow" href="https://wiki.openstack.org/wiki/Vulnerability_Management#Incident_report_taxonomy">https:/<wbr />/wiki.openstack<wbr />.org/wiki/<wbr />Vulnerability_<wbr />Management#<wbr />Incident_<wbr />report_<wbr />taxonomy</a> )...</p>
<p>Thought ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks David for confirming the bug on Horizon project!

Now for the OSSA part, should we keep this under embargo and does this qualify as a DOS attack vector ?

Considering there is no amplification and that one connection results in one database entry I would triage this as class D bug (according to our new taxonomy described here: https://wiki.openstack.org/wiki/Vulnerability_Management#Incident_report_taxonomy )...

Thought ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~paul-mcmillan" class="sprite person">Paul McMillan (paul-mcmillan)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-21T00:02:52.295408+00:00" title="2014-11-21 00:02:52 UTC">on 2014-11-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug can be trivially used to knock over any existing production deployment of Horizon that doesn&#x27;t use cookie-based sessions.</p>
<p>There is no amplification, but I suspect I can break most production deployments to the point that fixing requires manual intervention in less than 30 minutes. I&#x27;d prefer not to make that public without also providing a fix.</p>
<p>I&#x27;d argue we should probably treat that as A or B1.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug can be trivially used to knock over any existing production deployment of Horizon that doesn't use cookie-based sessions.

There is no amplification, but I suspect I can break most production deployments to the point that fixing requires manual intervention in less than 30 minutes. I'd prefer not to make that public without also providing a fix.

I'd argue we should probably treat that as A or B1.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-11-21 13:55:37 UTC" datetime="2014-11-21T13:55:37.070879+00:00">on 2014-11-21</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; High
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-21T14:25:48.359095+00:00" title="2014-11-21 14:25:48 UTC">on 2014-11-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Apparently that bug lets you fill the DB much faster than expected. Thus we&#x27;ll threat this as a class A.</p>
<p>The proposed patch apply cleanly on master and juno branch but it requires a bit of rework for Icehouse. Can someone provide a patch for Icehouse ?</p>
<p>Here is the proposed impact description #1. Note that I&#x27;ve considered all backends as vulnerable:</p>
<p>Title: Horizon denial of service attack through login page<br />
Reporter: Eric Peterson (Time Warner Cable)<br />
Products: Horizon<br />
Versions: up to 2014.1.3 and 2014.2</p>
<p>Description:<br />
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By doing repeated requests to Horizon login page a remote attacker may generate unwanted session record resulting in a denial of service. All Horizon setups are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Apparently that bug lets you fill the DB much faster than expected. Thus we'll threat this as a class A.

The proposed patch apply cleanly on master and juno branch but it requires a bit of rework for Icehouse. Can someone provide a patch for Icehouse ?

Here is the proposed impact description #1. Note that I've considered all backends as vulnerable:

Title: Horizon denial of service attack through login page
Reporter: Eric Peterson (Time Warner Cable)
Products: Horizon
Versions: up to 2014.1.3 and 2014.2

Description:
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By doing repeated requests to Horizon login page a remote attacker may generate unwanted session record resulting in a denial of service. All Horizon setups are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Tristan Cacqueray (tristan-cacqueray)
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lin-hua-cheng" class="sprite person">Lin Hua Cheng (lin-hua-cheng)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-21T15:56:04.850566+00:00" title="2014-11-21 15:56:04 UTC">on 2014-11-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;ll work on backporting the patch for Icehouse</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'll work on backporting the patch for Icehouse</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttrifonov" class="sprite person">Tihomir Trifonov (ttrifonov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-21T16:48:27.895442+00:00" title="2014-11-21 16:48:27 UTC">on 2014-11-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>With the added check for:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;if settings.<wbr />SESSION_<wbr />COOKIE_<wbr />NAME in request.COOKIES:</p>
<p>an attacker can easily set some fake cookie with the specified name, and will go through the session.create() anyway.</p>
<p>Regarding the get_user monkey patch - since we use external auth system(Keystone), we can&#x27;t use the Django UserId, so we need to store Keystone User Id and SessionBackend in session, to create user from it.</p>
<p>One possible solution is to clean the session on line 59:</p>
<p><a rel="nofollow" href="https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L59">https:/<wbr />/github.<wbr />com/openstack/<wbr />django_<wbr />openstack_<wbr />auth/blob/<wbr />master/<wbr />openstack_<wbr />auth/utils.<wbr />py#L59</a></p>
<p>But this way - although we will keep clear the database, we might end up with DOS vulnerability for the CREATE-DELETE DB requests on each anonymous request.</p>
<p>Another way is to monkey patch the load() method of SessionStore to avoid creation of a  new session, since we do not use the session for anonymous requests.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">With the added check for:

    if settings.SESSION_COOKIE_NAME in request.COOKIES:

an attacker can easily set some fake cookie with the specified name, and will go through the session.create() anyway.

Regarding the get_user monkey patch - since we use external auth system(Keystone), we can't use the Django UserId, so we need to store Keystone User Id and SessionBackend in session, to create user from it.

One possible solution is to clean the session on line 59:

https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L59

But this way - although we will keep clear the database, we might end up with DOS vulnerability for the CREATE-DELETE DB requests on each anonymous request.

Another way is to monkey patch the load() method of SessionStore to avoid creation of a  new session, since we do not use the session for anonymous requests.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-21T17:32:53.331976+00:00" title="2014-11-21 17:32:53 UTC">on 2014-11-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>If you get into the auth layer of the code and are assigning users to the request, that will create a session record no matter what (from what I have seen).  In addition, I do not believe it is the responsibility of the auth package to perform maintenance on the session backend.</p>
<p>It is a very good point that the attacker could add a local cookie to try to fake out a valid session.  However, the attacker would need to know the name of the session cookie id (which we could change I suppose from the default) and they would also have to keep on generating new session ids for each request.   This is not a difficult task for an attacker, but it does become harder to attack with this approach.</p>
<p>The other part of this is that we need to add the config setting for:<br />
<a rel="nofollow" href="https://docs.djangoproject.com/en/dev/ref/settings/#std:setting-SESSION_COOKIE_AGE">https:/<wbr />/docs.djangopro<wbr />ject.com/<wbr />en/dev/<wbr />ref/settings/<wbr />#std:setting-<wbr />SESSION_<wbr />COOKIE_<wbr />AGE</a><br />
If we make this setting something more reasonably close to a typical keystone token lifespan, this issue becomes less severe.  This setting can be combined with a cron job to run:<br />
<a rel="nofollow" href="https://docs.djangoproject.com/en/dev/ref/django-admin/#django-admin-clearsessions">https:/<wbr />/docs.djangopro<wbr />ject.com/<wbr />en/dev/<wbr />ref/django-<wbr />admin/#<wbr />django-<wbr />admin-clearsess<wbr />ions</a></p>
<p>So if a keystone token is typically generated with a 1 hour lifespan, setting the cookie age to 1 hr and running the cron job every hour keeps the db as clean as possible.<br />
(something like the info above might need to be included in a bug disclosure)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">If you get into the auth layer of the code and are assigning users to the request, that will create a session record no matter what (from what I have seen).  In addition, I do not believe it is the responsibility of the auth package to perform maintenance on the session backend.

It is a very good point that the attacker could add a local cookie to try to fake out a valid session.  However, the attacker would need to know the name of the session cookie id (which we could change I suppose from the default) and they would also have to keep on generating new session ids for each request.   This is not a difficult task for an attacker, but it does become harder to attack with this approach. 

The other part of this is that we need to add the config setting for:
https://docs.djangoproject.com/en/dev/ref/settings/#std:setting-SESSION_COOKIE_AGE
If we make this setting something more reasonably close to a typical keystone token lifespan, this issue becomes less severe.  This setting can be combined with a cron job to run:
https://docs.djangoproject.com/en/dev/ref/django-admin/#django-admin-clearsessions

So if a keystone token is typically generated with a 1 hour lifespan, setting the cookie age to 1 hr and running the cron job every hour keeps the db as clean as possible.
(something like the info above might need to be included in a bug disclosure)






</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-24T15:07:40.369232+00:00" title="2014-11-24 15:07:40 UTC">on 2014-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Tihomir Trifonov and I have agreed that there are ways to improve DOA as well with this issue.</p>
<p>The horizon fix seems ok / good, but there is likely some DOA fixes to help improve this issue as well.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Tihomir Trifonov and I have agreed that there are ways to improve DOA as well with this issue.

The horizon fix seems ok / good, but there is likely some DOA fixes to help improve this issue as well.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-24T18:18:10.233326+00:00" title="2014-11-24 18:18:10 UTC">on 2014-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Eric Well the attack vector remains if adding a fake cookie trigger the extra session creation.<br />
And the one hour timeout proposed seems to big according to comment #13 assumption where only 1/2 hours is required to overwhelm the service...</p>
<p>How about the monkey patch of SessionStore.load method, wouldn&#x27;t it be easer to implement ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Eric Well the attack vector remains if adding a fake cookie trigger the extra session creation.
And the one hour timeout proposed seems to big according to comment #13 assumption where only 1/2 hours is required to overwhelm the service...

How about the monkey patch of SessionStore.load method, wouldn't it be easer to implement ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-24T19:58:46.660754+00:00" title="2014-11-24 19:58:46 UTC">on 2014-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tristan - I am a bit cautious to say that the SessionStore.load() method should be monkey patched.  The concerning part is that the session store can be customized during deployment.  Historically signed cookies have been used a lot, which do not suffer from this problem.  In addition, I am not confident how many session stores have this issue or not.  Finally, I think this issue is not new to Django, and they seem to have this behavior deliberately.  It could be that changing this behavior could cause an even worse side effect  (but honestly I do not know).</p>
<p>I think the patch thus far at least makes it so a simple curl script for the login page will not overwhelm the db.  This is a good first step.</p>
<p>What Tihomir and I discussed via IRC was that we could probably make changes to the django-<wbr />openstack-<wbr />auth repo that would further improve things and reduce the likelihood of creating new sessions.  Those changes are not complete at this point and will require some more work.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tristan - I am a bit cautious to say that the SessionStore.load() method should be monkey patched.  The concerning part is that the session store can be customized during deployment.  Historically signed cookies have been used a lot, which do not suffer from this problem.  In addition, I am not confident how many session stores have this issue or not.  Finally, I think this issue is not new to Django, and they seem to have this behavior deliberately.  It could be that changing this behavior could cause an even worse side effect  (but honestly I do not know).

I think the patch thus far at least makes it so a simple curl script for the login page will not overwhelm the db.  This is a good first step.

What Tihomir and I discussed via IRC was that we could probably make changes to the django-openstack-auth repo that would further improve things and reduce the likelihood of creating new sessions.  Those changes are not complete at this point and will require some more work.

</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-24T21:56:36.247335+00:00" title="2014-11-24 21:56:36 UTC">on 2014-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Eric alright, sadly I suspect Paul&#x27;s comment #13 to be still valid (considering the attack only need an extra crafted cookie).</p>
<p>In order to threat this as a Class A, we need a fix that really mitigate the attack for all supported release...</p>
<p>FYI, the other options are:<br />
* fix this publicly (might help to get a patch in).<br />
* threat this as a B2 class type of bug (which mean fix and/or security note).</p>
<p>How long do you think it will take to have such a fix covering django-<wbr />openstack-<wbr />auth ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Eric alright, sadly I suspect Paul's comment #13 to be still valid (considering the attack only need an extra crafted cookie).

In order to threat this as a Class A, we need a fix that really mitigate the attack for all supported release...

FYI, the other options are:
* fix this publicly (might help to get a patch in).
* threat this as a B2 class type of bug (which mean fix and/or security note).

How long do you think it will take to have such a fix covering django-openstack-auth ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T02:07:18.365181+00:00" title="2014-11-26 02:07:18 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I have not found a way to make changes in the auth package that prevent session creation.  As soon as a user is looked up (even an Anonymous user), a session record is created.</p>
<p>However, I have found an additional change in the horizon middleware can help.  This change is needed in process_response, at the end of the method.   This means it is one of the last things called.   The code to add is:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if not request.<wbr />user.is_<wbr />authenticated(<wbr />):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.<wbr />session.<wbr />delete(<wbr />request.<wbr />session.<wbr />session_<wbr />key)</p>
<p>For a db backed session, this calls:<br />
<a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L70">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />backends/<wbr />db.py#L70</a></p>
<p>I am not sure how this works with the signed cookie base sessions, or even in the memcached sessions.   Would this be an acceptable approach?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I have not found a way to make changes in the auth package that prevent session creation.  As soon as a user is looked up (even an Anonymous user), a session record is created.

However, I have found an additional change in the horizon middleware can help.  This change is needed in process_response, at the end of the method.   This means it is one of the last things called.   The code to add is:

        if not request.user.is_authenticated():
            request.session.delete(request.session.session_key)

For a db backed session, this calls:
https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L70

I am not sure how this works with the signed cookie base sessions, or even in the memcached sessions.   Would this be an acceptable approach?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T02:09:05.817712+00:00" title="2014-11-26 02:09:05 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I just looked at signed cookies, cached, and cached db session backends.  They all have a delete method with this signature.  I *think* this should technically work.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I just looked at signed cookies, cached, and cached db session backends.  They all have a delete method with this signature.  I *think* this should technically work.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttrifonov" class="sprite person">Tihomir Trifonov (ttrifonov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T08:43:42.451715+00:00" title="2014-11-26 08:43:42 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks Eric for looking at the code. I promised to try to prepare the Django Auth patch, but couldn&#x27;t manage to do it, sorry for that. Anyway - the proposed fix with process_response seems much more correct than the django-auth approach, as we might accidentally add some additional processing in another middleware, to check again for something in the session, and clearing the session at process_response seems to be the better way.</p>
<p>In Django, the persistence of SessionID in the Server(DB) is needed if we want to allow anonymous users to store some settings in session and not in cookie(e.g. when editing a comment under a blog - store drafts in the server session while the user is not yet logged in). Since Horizon doesn&#x27;t allow anonymous users to any action, I think clearing the session is actually recommended. Each time anonymous user logs in the site - they will have unique session id, which is perfectly fine - they don&#x27;t need anything else.</p>
<p>If someone can help with testing the proposed patch By Eric (<a rel="nofollow" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264463/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">https:/<wbr />/bugs.launchpad<wbr />.net/horizon/<wbr />+bug/1394370/<wbr />+attachment/<wbr />4264463/<wbr />+files/<wbr />0001-Horizon-<wbr />login-page-<wbr />contains-<wbr />DOS-attack-<wbr />mechanism.<wbr />patch</a>) + the last 2 lines with process_response - should be great. I&#x27;d try to run few tests, but I&#x27;m on a very tight schedule this week.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks Eric for looking at the code. I promised to try to prepare the Django Auth patch, but couldn't manage to do it, sorry for that. Anyway - the proposed fix with process_response seems much more correct than the django-auth approach, as we might accidentally add some additional processing in another middleware, to check again for something in the session, and clearing the session at process_response seems to be the better way.

In Django, the persistence of SessionID in the Server(DB) is needed if we want to allow anonymous users to store some settings in session and not in cookie(e.g. when editing a comment under a blog - store drafts in the server session while the user is not yet logged in). Since Horizon doesn't allow anonymous users to any action, I think clearing the session is actually recommended. Each time anonymous user logs in the site - they will have unique session id, which is perfectly fine - they don't need anything else.

If someone can help with testing the proposed patch By Eric (https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264463/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch) + the last 2 lines with process_response - should be great. I'd try to run few tests, but I'm on a very tight schedule this week.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttrifonov" class="sprite person">Tihomir Trifonov (ttrifonov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T16:01:20.427611+00:00" title="2014-11-26 16:01:20 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269055/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">0001-Horizon-login-page-contains-DOS-attack-mechanism.patch</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4269055">Edit</a>
        (5.0 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is the updated patch, containing the request.<wbr />session.<wbr />delete(<wbr />request.<wbr />session.<wbr />session_<wbr />key) code in process_response, but in a different middleware class.</p>
<p>Since we have this code in Django: <a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py#L49">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />middleware.<wbr />py#L49</a> the SessionMiddleware tries to save the session in case it is modified, and this is the case when logout is called for a logged in session. Since the user was logged in, then logged out, the session is marked as modified. The problem here is the order of execution of the middlewares - the SessionMiddleware is being executed after the HorizonMiddleware, so if we first try to clear/delete the session in HorizonMiddleware, then the SessionMiddleware processes the response, detects that is has been modified and tries to save it. This creates a new record in the DB with the sessionId of the logged-out user. So we need to process the response after the SessionMiddleware, so the proposed change is to add a CleanupMiddleware, that does the cleanup.</p>
<p>I&#x27;ve tested with signed_cookies and db - no visible drawbacks or problems. The tables seems clear after several logins, logouts, clean browser sessions.</p>
<p>A positive side-effect of the patch: no session cookie is being set in the response for anonymous users. In the current codebase - after an unsuccessful login, a cookie with the session_id is being returned to the users, thus exposing the SESSION_COOKIE_NAME to the user even if they don&#x27;t have a valid account for the system. Now - until the user logs in for first time - no session cookie is being returned. When the users logs out - the Session cookie is being removed from response, so browser seems clear.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is the updated patch, containing the request.session.delete(request.session.session_key) code in process_response, but in a different middleware class.

Since we have this code in Django: https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py#L49 the SessionMiddleware tries to save the session in case it is modified, and this is the case when logout is called for a logged in session. Since the user was logged in, then logged out, the session is marked as modified. The problem here is the order of execution of the middlewares - the SessionMiddleware is being executed after the HorizonMiddleware, so if we first try to clear/delete the session in HorizonMiddleware, then the SessionMiddleware processes the response, detects that is has been modified and tries to save it. This creates a new record in the DB with the sessionId of the logged-out user. So we need to process the response after the SessionMiddleware, so the proposed change is to add a CleanupMiddleware, that does the cleanup.

I've tested with signed_cookies and db - no visible drawbacks or problems. The tables seems clear after several logins, logouts, clean browser sessions. 

A positive side-effect of the patch: no session cookie is being set in the response for anonymous users. In the current codebase - after an unsuccessful login, a cookie with the session_id is being returned to the users, thus exposing the SESSION_COOKIE_NAME to the user even if they don't have a valid account for the system. Now - until the user logs in for first time - no session cookie is being returned. When the users logs out - the Session cookie is being removed from response, so browser seems clear.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~paul-mcmillan" class="sprite person">Paul McMillan (paul-mcmillan)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T19:47:40.229826+00:00" title="2014-11-26 19:47:40 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;d like to see input from Gabriel Hurley on this patch, since this is one of his areas of expertise.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'd like to see input from Gabriel Hurley on this patch, since this is one of his areas of expertise.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gabriel-hurley" class="sprite person">Gabriel Hurley (gabriel-hurley)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T20:46:02.043391+00:00" title="2014-11-26 20:46:02 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>So here&#x27;s my take:</p>
<p>1. A session is only saved if session.modified is true: <a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py#L18">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />middleware.<wbr />py#L18</a></p>
<p>2. django-<wbr />openstack-<wbr />auth is doing the same type of access in get_user as the default django database backend. Compare <a rel="nofollow" href="https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L51">https:/<wbr />/github.<wbr />com/openstack/<wbr />django_<wbr />openstack_<wbr />auth/blob/<wbr />master/<wbr />openstack_<wbr />auth/utils.<wbr />py#L51</a> and <a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/auth/__init__.py#L147">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />auth/__<wbr />init__.<wbr />py#L147</a></p>
<p>3. I agree that the session clear and set_test_cookie are no longer needed; that&#x27;s legacy code. I also agree that our call to _check_<wbr />has_timed_<wbr />timeout should be after checking if the user is authenticated.</p>
<p>What all this means is that simply *accessing* the session is not enough to write it to the DB; somewhere in these code paths we&#x27;re triggering the session.modified flag. We should instead focus on finding where that&#x27;s happening and ensure that we do not do anything to modify the session for anonymous sessions.</p>
<p>That would be a more appropriate fix for this as opposed to mucking with checking for a specific cookie name and/or deleting sessions if they&#x27;re &quot;unused&quot;.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">So here's my take:

1. A session is only saved if session.modified is true: https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py#L18

2. django-openstack-auth is doing the same type of access in get_user as the default django database backend. Compare https://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L51 and https://github.com/django/django/blob/master/django/contrib/auth/__init__.py#L147

3. I agree that the session clear and set_test_cookie are no longer needed; that's legacy code. I also agree that our call to _check_has_timed_timeout should be after checking if the user is authenticated.

What all this means is that simply *accessing* the session is not enough to write it to the DB; somewhere in these code paths we're triggering the session.modified flag. We should instead focus on finding where that's happening and ensure that we do not do anything to modify the session for anonymous sessions.

That would be a more appropriate fix for this as opposed to mucking with checking for a specific cookie name and/or deleting sessions if they're "unused".</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~paul-mcmillan" class="sprite person">Paul McMillan (paul-mcmillan)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T20:55:08.615927+00:00" title="2014-11-26 20:55:08 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m adding Donald who&#x27;s a member of the Django security team, he may be able to help track down what we&#x27;re doing wrong here.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm adding Donald who's a member of the Django security team, he may be able to help track down what we're doing wrong here.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dstufft" class="sprite person">Donald Stufft (dstufft)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T21:15:52.492309+00:00" title="2014-11-26 21:15:52 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I haven&#x27;t read the entire ticket, however if this is your login view: <a rel="nofollow" href="https://github.com/openstack/horizon/blob/master/openstack_dashboard/views.py#L38-L48">https:/<wbr />/github.<wbr />com/openstack/<wbr />horizon/<wbr />blob/master/<wbr />openstack_<wbr />dashboard/<wbr />views.py#<wbr />L38-L48</a> then that&#x27;s your problem right there.  The request.<wbr />session.<wbr />clear() deletes the session and sets modified=True so it will create a new session.</p>
<p>I would recommend just flat out deleting that session manipulation code there. The Django login code already will ensure that session keys are rotated on authentication boundaries without creating a new session on every page load so the clearing of the session doesn&#x27;t really do much of anything there. Setting the test cookie I don&#x27;t think will hurt anything but I don&#x27;t think you need it either TBH.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I haven't read the entire ticket, however if this is your login view: https://github.com/openstack/horizon/blob/master/openstack_dashboard/views.py#L38-L48 then that's your problem right there.  The request.session.clear() deletes the session and sets modified=True so it will create a new session.

I would recommend just flat out deleting that session manipulation code there. The Django login code already will ensure that session keys are rotated on authentication boundaries without creating a new session on every page load so the clearing of the session doesn't really do much of anything there. Setting the test cookie I don't think will hurt anything but I don't think you need it either TBH.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dstufft" class="sprite person">Donald Stufft (dstufft)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T21:26:35.488279+00:00" title="2014-11-26 21:26:35 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Note that accessing request.user does *not* create a session ever with Django. It will access the session yes, but it won&#x27;t modify it and you require a modification to save a session (and thus create one if one doesn&#x27;t already exist) unless you have SESSION_<wbr />SAVE_EVERY_<wbr />REQUEST set to True.</p>
<p>This is the clear code in Django -&gt; <a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/backends/base.py#L137-L143">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />backends/<wbr />base.py#<wbr />L137-L143</a></p>
<p>It makes sense for the clear code to mark the session as modified because what&#x27;s it&#x27;s doing is emptying the session of all data, but it keeps the same session id.</p>
<p>Here&#x27;s the login code in Django by the way as well -&gt; <a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/auth/__init__.py#L77-L105">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />auth/__<wbr />init__.<wbr />py#L77-<wbr />L105</a></p>
<p>It&#x27;s acutally careful not to clear the session data when going from anonymous -&gt; logged in, but to ensure that it does clear the session data when going from logged in (or thinks it&#x27;s logged in) -&gt; logged in with a different user.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Note that accessing request.user does *not* create a session ever with Django. It will access the session yes, but it won't modify it and you require a modification to save a session (and thus create one if one doesn't already exist) unless you have SESSION_SAVE_EVERY_REQUEST set to True.

This is the clear code in Django -&gt; https://github.com/django/django/blob/master/django/contrib/sessions/backends/base.py#L137-L143

It makes sense for the clear code to mark the session as modified because what's it's doing is emptying the session of all data, but it keeps the same session id.

Here's the login code in Django by the way as well -&gt; https://github.com/django/django/blob/master/django/contrib/auth/__init__.py#L77-L105

It's acutally careful not to clear the session data when going from anonymous -&gt; logged in, but to ensure that it does clear the session data when going from logged in (or thinks it's logged in) -&gt; logged in with a different user.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T22:16:39.053425+00:00" title="2014-11-26 22:16:39 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>A session record will get written to the DB if you:<br />
- Just access (read from) request.session<br />
- Just access request.user  (which underneath, is also accessing request.session)</p>
<p>A good general intro is at <a rel="nofollow" href="http://stackoverflow.com/questions/4444758/huge-django-session-table-normal-behaviour-or-bug">http://<wbr />stackoverflow.<wbr />com/questions/<wbr />4444758/<wbr />huge-django-<wbr />session-<wbr />table-normal-<wbr />behaviour-<wbr />or-bug</a></p>
<p>The db session backend is forcing a session row to be created at:<br />
<a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L29">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />backends/<wbr />db.py#L29</a><br />
This essentially is saying if we couldn&#x27;t find any session info, the db backend will generate a session ID for the user and write a row into the DB.</p>
<p>I agree that this in&#x27;t a great behavior, but it is what I observe in a lot of trial and error tests.</p>
<p>@dstufft - yes, I would think accessing request.user wouldn&#x27;t create a new session row, but that is not the case.  When this code happens:<br />
user_id = request.<wbr />session[<wbr />SESSION_<wbr />KEY]<br />
Then the session gets created in the db, even though that code will eventually bomb out with a key error for the SESSION_KEY.</p>
<p>I&#x27;d encourage others to set this stuff up and try it, how I would think things should work are not how things actually work  ;) within django&#x27;s session middleware.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">A session record will get written to the DB if you:
- Just access (read from) request.session
- Just access request.user  (which underneath, is also accessing request.session)

A good general intro is at http://stackoverflow.com/questions/4444758/huge-django-session-table-normal-behaviour-or-bug

The db session backend is forcing a session row to be created at:
https://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L29
This essentially is saying if we couldn't find any session info, the db backend will generate a session ID for the user and write a row into the DB.

I agree that this in't a great behavior, but it is what I observe in a lot of trial and error tests. 

@dstufft - yes, I would think accessing request.user wouldn't create a new session row, but that is not the case.  When this code happens:
user_id = request.session[SESSION_KEY]
Then the session gets created in the db, even though that code will eventually bomb out with a key error for the SESSION_KEY.

I'd encourage others to set this stuff up and try it, how I would think things should work are not how things actually work  ;) within django's session middleware.


</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T23:04:31.602509+00:00" title="2014-11-26 23:04:31 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I take back what I said above, I think I found another spot that was making session changes too.</p>
<p>I will have a simpler patch soon.  Thanks all for your input (and patience :)).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I take back what I said above, I think I found another spot that was making session changes too.

I will have a simpler patch soon.  Thanks all for your input (and patience :)).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dstufft" class="sprite person">Donald Stufft (dstufft)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T23:13:30.453690+00:00" title="2014-11-26 23:13:30 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Blugh. That should probably be changed in Django. There&#x27;s no reason to create a session until one is being saved.</p>
<p>The session.clear() should still be dropped because even if the fixes land in Django then that will still cause a session to be created on each page load.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Blugh. That should probably be changed in Django. There's no reason to create a session until one is being saved.

The session.clear() should still be dropped because even if the fixes land in Django then that will still cause a session to be created on each page load.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-26T23:25:05.408199+00:00" title="2014-11-26 23:25:05 UTC">on 2014-11-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269366/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">patch with pep8 and unit test corrections, and logout cookie corrected</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4269366">Edit</a>
        (3.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This patch is a simplified version of previous patches, and catches one more cookie modification we were making - which lead to extra session records.</p>
<p>I hope this is just about the last patch.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This patch is a simplified version of previous patches, and catches one more cookie modification we were making - which lead to extra session records.

I hope this is just about the last patch.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttrifonov" class="sprite person">Tihomir Trifonov (ttrifonov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-27T09:31:38.013591+00:00" title="2014-11-27 09:31:38 UTC">on 2014-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269568/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">0001-Horizon-login-page-contains-DOS-attack-mechanism.patch</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4269568">Edit</a>
        (1019 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The latest patch is still vulnerable, just make</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;csrf=$(curl <a rel="nofollow" href="https://dashboard">https:/<wbr />/dashboard</a> | grep csrfmiddlewaret<wbr />oken-match-<wbr />pattern)</p>
<p>Then run this request:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;curl -i <a rel="nofollow" href="https://dashboard/auth/login/">https:/<wbr />/dashboard/<wbr />auth/login/</a> -d &quot;csrfmiddleware<wbr />token=$<wbr />csrf&amp;region=<a rel="nofollow" href="http://dashboard:5000/v2.0&amp;username=fake&amp;password=fake">http://<wbr />dashboard:<wbr />5000/v2.<wbr />0&amp;username=<wbr />fake&amp;password=<wbr />fake</a>&quot; -b csrftoken=$csrf</p>
<p>You can repeat the request as many times as you want. Each run will add new row in DB.</p>
<p>But I think mystery is finally revealed:</p>
<p>First this:<br />
<a rel="nofollow" href="https://github.com/openstack/django_openstack_auth/blob/455aaeab8d16fbecebe9a088e10e0e532a3116cb/openstack_auth/forms.py#L101">https:/<wbr />/github.<wbr />com/openstack/<wbr />django_<wbr />openstack_<wbr />auth/blob/<wbr />455aaeab8d16fbe<wbr />cebe9a088e10e0e<wbr />532a3116cb/<wbr />openstack_<wbr />auth/forms.<wbr />py#L101</a></p>
<p>and then that:<br />
Django 1.7:<br />
<a rel="nofollow" href="https://github.com/django/django/blob/master/django/contrib/sessions/backends/base.py#L276">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/master/<wbr />django/<wbr />contrib/<wbr />sessions/<wbr />backends/<wbr />base.py#<wbr />L276</a></p>
<p>Django 1.6 (Ouch):<br />
<a rel="nofollow" href="https://github.com/django/django/blob/stable/1.6.x/django/contrib/sessions/backends/base.py">https:/<wbr />/github.<wbr />com/django/<wbr />django/<wbr />blob/stable/<wbr />1.6.x/django/<wbr />contrib/<wbr />sessions/<wbr />backends/<wbr />base.py</a></p>
<p>So .flush() should be replaced with .delete(<wbr />session_<wbr />key), as in 1.6 it calls .create() and in 1.7 .clear() sets self.modified = True, but we don&#x27;t have anything in session anyway.</p>
<p>My assumption is that Django wants to persist session, as by default websites might need to store user settings for anonymous users. Also, the sessionId is persisted for security reasons - since the session_key value is primary key in the Database, you cannot create duplicate sessionIds. Otherwise - if one user logs in and is assigned sessionId=123, then another user plays as anonymous, but for some reason the server assigns the same sessionId(possible in web farms) - they will be able to see the same as the logged-in user.</p>
<p>But Horizon doesn&#x27;t actually need that. It doesn&#x27;t offer anything to anonymous users. So Django should be probably able to handle the case with no anonymous sessions in DB as a general use case.</p>
<p>One minor drawback of the patch is that after a logout, a new session id is associated to the user, and it remains in the DB. But this should be generally OK for handling. To clear it - we still need the cleanup middleware.</p>
<p>The patch issues .delete() in django_<wbr />openstack_<wbr />auth, which works in 1.6 and 1.7 - no database rows added. And we can add the latest patch from Eric for horizon, as it makes things simple.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The latest patch is still vulnerable, just make 

    csrf=$(curl https://dashboard | grep csrfmiddlewaretoken-match-pattern)

Then run this request:

    curl -i https://dashboard/auth/login/ -d "csrfmiddlewaretoken=$csrf&amp;region=http://dashboard:5000/v2.0&amp;username=fake&amp;password=fake" -b csrftoken=$csrf

You can repeat the request as many times as you want. Each run will add new row in DB.

But I think mystery is finally revealed:

First this:
https://github.com/openstack/django_openstack_auth/blob/455aaeab8d16fbecebe9a088e10e0e532a3116cb/openstack_auth/forms.py#L101

and then that:
Django 1.7:
https://github.com/django/django/blob/master/django/contrib/sessions/backends/base.py#L276

Django 1.6 (Ouch):
https://github.com/django/django/blob/stable/1.6.x/django/contrib/sessions/backends/base.py

So .flush() should be replaced with .delete(session_key), as in 1.6 it calls .create() and in 1.7 .clear() sets self.modified = True, but we don't have anything in session anyway.

My assumption is that Django wants to persist session, as by default websites might need to store user settings for anonymous users. Also, the sessionId is persisted for security reasons - since the session_key value is primary key in the Database, you cannot create duplicate sessionIds. Otherwise - if one user logs in and is assigned sessionId=123, then another user plays as anonymous, but for some reason the server assigns the same sessionId(possible in web farms) - they will be able to see the same as the logged-in user.

But Horizon doesn't actually need that. It doesn't offer anything to anonymous users. So Django should be probably able to handle the case with no anonymous sessions in DB as a general use case.

One minor drawback of the patch is that after a logout, a new session id is associated to the user, and it remains in the DB. But this should be generally OK for handling. To clear it - we still need the cleanup middleware.

The patch issues .delete() in django_openstack_auth, which works in 1.6 and 1.7 - no database rows added. And we can add the latest patch from Eric for horizon, as it makes things simple.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttrifonov" class="sprite person">Tihomir Trifonov (ttrifonov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-27T09:35:06.172011+00:00" title="2014-11-27 09:35:06 UTC">on 2014-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ouch - Django master is 1.8 alpha, so the both 1.6 and 1.7 issue .create() at the end of flush(). But all versions call clear() which sets .modified = True.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ouch - Django master is 1.8 alpha, so the both 1.6 and 1.7 issue .create() at the end of flush(). But all versions call clear() which sets .modified = True.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-27T13:34:24.199495+00:00" title="2014-11-27 13:34:24 UTC">on 2014-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Awesome find Tihomir, I wonder if we just removed the flush altogether - if that would fix it perhaps?  I am not sure why it is there in the first place.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Awesome find Tihomir, I wonder if we just removed the flush altogether - if that would fix it perhaps?  I am not sure why it is there in the first place.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttrifonov" class="sprite person">Tihomir Trifonov (ttrifonov)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-11-27T14:18:41.510252+00:00" title="2014-11-27 14:18:41 UTC">on 2014-11-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269689/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">0001-Horizon-login-page-contains-DOS-attack-mechanism.patch</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4269689">Edit</a>
        (959 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Eric is right, no need to flush/delete the session. Tested - no rows in DB without the .flush() line.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Eric is right, no need to flush/delete the session. Tested - no rows in DB without the .flush() line.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T15:11:46.570079+00:00" title="2014-12-01 15:11:46 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Impact desc on comment #14:<br />
record resulting -&gt; records, potentially resulting</p>
<p>Otherwise looks good to me</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Impact desc on comment #14:
record resulting -&gt; records, potentially resulting

Otherwise looks good to me</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T16:08:43.233735+00:00" title="2014-12-01 16:08:43 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Paul McMillan   could you check if the proposed changes fix the issue ? ( openstack_auth in comment #38 and horizon in comment #34, assuming both are required.)</p>
<p>Here is the updated impact description draft #2 (thanks to Thierry review):</p>
<p>Title: Horizon denial of service attack through login page<br />
Reporter: Eric Peterson (Time Warner Cable)<br />
Products: Horizon<br />
Versions: up to 2014.1.3 and 2014.2</p>
<p>Description:<br />
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By doing repeated requests to Horizon login page a remote attacker may generate unwanted session record, potentially resulting in a denial of service. All Horizon setups are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Paul McMillan   could you check if the proposed changes fix the issue ? ( openstack_auth in comment #38 and horizon in comment #34, assuming both are required.)

Here is the updated impact description draft #2 (thanks to Thierry review):

Title: Horizon denial of service attack through login page
Reporter: Eric Peterson (Time Warner Cable)
Products: Horizon
Versions: up to 2014.1.3 and 2014.2

Description:
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By doing repeated requests to Horizon login page a remote attacker may generate unwanted session record, potentially resulting in a denial of service. All Horizon setups are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T16:29:58.534886+00:00" title="2014-12-01 16:29:58 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>(minor clarification)<br />
I am not sure all Horizon setups are affected - I would say that Horizon setups using a db or memcached session engine would be impacted.</p>
<p>The default Horizon setting has been signed cookies in many cases, which does not suffer from this issue.   (I am not sure which distros use signed cookies and which ones do not).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">(minor clarification)
I am not sure all Horizon setups are affected - I would say that Horizon setups using a db or memcached session engine would be impacted.

The default Horizon setting has been signed cookies in many cases, which does not suffer from this issue.   (I am not sure which distros use signed cookies and which ones do not).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T16:39:55.106633+00:00" title="2014-12-01 16:39:55 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Eric thanks for the clarification!</p>
<p>Here is the updated impact description draft #3 (including the session engine impact):</p>
<p>Title: Horizon denial of service attack through login page<br />
Reporter: Eric Peterson (Time Warner Cable)<br />
Products: Horizon<br />
Versions: up to 2014.1.3 and 2014.2</p>
<p>Description:<br />
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By doing repeated requests to Horizon login page a remote attacker may generate unwanted session record, potentially resulting in a denial of service. Only Horizon setups using a db or memcached session engine are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Eric thanks for the clarification!

Here is the updated impact description draft #3 (including the session engine impact):

Title: Horizon denial of service attack through login page
Reporter: Eric Peterson (Time Warner Cable)
Products: Horizon
Versions: up to 2014.1.3 and 2014.2

Description:
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By doing repeated requests to Horizon login page a remote attacker may generate unwanted session record, potentially resulting in a denial of service. Only Horizon setups using a db or memcached session engine are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T18:05:29.239969+00:00" title="2014-12-01 18:05:29 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The impact description looks great, aside from needing a handful of minor English grammar fixes in the second sentence:</p>
<p>By making repeated requests to the Horizon login page a remote attacker may generate unwanted session records, potentially resulting in a denial of service.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The impact description looks great, aside from needing a handful of minor English grammar fixes in the second sentence:

By making repeated requests to the Horizon login page a remote attacker may generate unwanted session records, potentially resulting in a denial of service.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ericpeterson-l" class="sprite person">Eric Peterson (ericpeterson-l)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T19:23:26.905554+00:00" title="2014-12-01 19:23:26 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4272357/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">final fixes for horizon repo</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4272357">Edit</a>
        (2.6 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This patch reverts a change previously made to the middle ware tests, which was never needed.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This patch reverts a change previously made to the middle ware tests, which was never needed.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lin-hua-cheng" class="sprite person">Lin Hua Cheng (lin-hua-cheng)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T19:47:57.558109+00:00" title="2014-12-01 19:47:57 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Patch from comment #44  (horizon) and #38(django_<wbr />openstack_<wbr />auth) looks good to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Patch from comment #44  (horizon) and #38(django_openstack_auth) looks good to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~paul-mcmillan" class="sprite person">Paul McMillan (paul-mcmillan)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T20:21:26.569992+00:00" title="2014-12-01 20:21:26 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Patches #38 and #44 also look good to me. The description as amended by Jeremy looks good to me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Patches #38 and #44 also look good to me. The description as amended by Jeremy looks good to me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/47" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-01T21:34:29.656435+00:00" title="2014-12-01 21:34:29 UTC">on 2014-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/47"> #47</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>CVE requested with this impact description:</p>
<p>Title: Horizon denial of service attack through login page<br />
Reporter: Eric Peterson (Time Warner Cable)<br />
Products: Horizon<br />
Versions: up to 2014.1.3 and 2014.2</p>
<p>Description:<br />
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By making repeated requests to the Horizon login page a remote attacker may generate unwanted session records, potentially resulting in a denial of service. Only Horizon setups using a db or memcached session engine are affected.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">CVE requested with this impact description:

Title: Horizon denial of service attack through login page
Reporter: Eric Peterson (Time Warner Cable)
Products: Horizon
Versions: up to 2014.1.3 and 2014.2

Description:
Eric Peterson from Time Warner Cable reported a vulnerability in Horizon. By making repeated requests to the Horizon login page a remote attacker may generate unwanted session records, potentially resulting in a denial of service. Only Horizon setups using a db or memcached session engine are affected.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-12-02 01:02:03 UTC" datetime="2014-12-02T01:02:03.548836+00:00">on 2014-12-02</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - horizon login page is vulnerable to DOS attack<br />+ horizon login page is vulnerable to DOS attack (CVE-2014-8124)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/48" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-02T01:19:23.764660+00:00" title="2014-12-02 01:19:23 UTC">on 2014-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/48">
                <strong>Re: horizon login page is vulnerable to DOS attack (CVE-2014-8124)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/48"> #48</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Eric the proposed fix conflict on stable/icehouse, can you please provide a backport ?</p>
<p>Also if we can send the advance notification by Thursday, we could do the disclosure at this date:<br />
2014-12-09, 1500UTC</p>
<p>Is this working for everyone ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Eric the proposed fix conflict on stable/icehouse, can you please provide a backport ?

Also if we can send the advance notification by Thursday, we could do the disclosure at this date:
2014-12-09, 1500UTC

Is this working for everyone ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/49" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lin-hua-cheng" class="sprite person">Lin Hua Cheng (lin-hua-cheng)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-02T02:25:36.489253+00:00" title="2014-12-02 02:25:36 UTC">on 2014-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/49"> #49</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4272560/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">icehouse patch for horizon</a>
        <a class="sprite edit action-icon" href="/horizon/+bug/1394370/+attachment/4272560">Edit</a>
        (2.4 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/50" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lin-hua-cheng" class="sprite person">Lin Hua Cheng (lin-hua-cheng)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-02T02:26:41.893304+00:00" title="2014-12-02 02:26:41 UTC">on 2014-12-02</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/50"> #50</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Tristan: Please find the icehouse version of the patch for horizon</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Tristan: Please find the icehouse version of the patch for horizon</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-12-04 13:45:24 UTC" datetime="2014-12-04T13:45:24.494822+00:00">on 2014-12-04</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in horizon: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-12-08 15:02:35 UTC" datetime="2014-12-08T15:02:35.817547+00:00">on 2014-12-08</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-12-09 14:59:20 UTC" datetime="2014-12-09T14:59:20.165498+00:00">on 2014-12-09</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/51" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T15:00:13.607480+00:00" title="2014-12-09 15:00:13 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/51">
                <strong>Fix proposed to horizon (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/51"> #51</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.openstack.org/140353">https:/<wbr />/review.<wbr />openstack.<wbr />org/140353</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: master
Review: https://review.openstack.org/140353</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in horizon: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Eric Peterson (ericpeterson-l)
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/52" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T15:01:14.017464+00:00" title="2014-12-09 15:01:14 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/52">
                <strong>Fix proposed to horizon (stable/icehouse)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/52"> #52</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/icehouse<br />
Review: <a rel="nofollow" href="https://review.openstack.org/140354">https:/<wbr />/review.<wbr />openstack.<wbr />org/140354</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/icehouse
Review: https://review.openstack.org/140354</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/53" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T15:06:57.643870+00:00" title="2014-12-09 15:06:57 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/53">
                <strong>Change abandoned on horizon (stable/icehouse)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/53"> #53</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Change abandoned by Lin Hua Cheng (&lt;email address hidden&gt;) on branch: stable/icehouse<br />
Review: <a rel="nofollow" href="https://review.openstack.org/140354">https:/<wbr />/review.<wbr />openstack.<wbr />org/140354</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Change abandoned by Lin Hua Cheng (os.lcheng@gmail.com) on branch: stable/icehouse
Review: https://review.openstack.org/140354</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/54" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T15:08:47.395143+00:00" title="2014-12-09 15:08:47 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/54">
                <strong>Fix proposed to horizon (stable/icehouse)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/54"> #54</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/icehouse<br />
Review: <a rel="nofollow" href="https://review.openstack.org/140356">https:/<wbr />/review.<wbr />openstack.<wbr />org/140356</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/icehouse
Review: https://review.openstack.org/140356</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/55" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T15:12:07.087147+00:00" title="2014-12-09 15:12:07 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/55">
                <strong>Fix proposed to horizon (stable/juno)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/55"> #55</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/juno<br />
Review: <a rel="nofollow" href="https://review.openstack.org/140358">https:/<wbr />/review.<wbr />openstack.<wbr />org/140358</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/juno
Review: https://review.openstack.org/140358</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/56" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T16:47:26.067643+00:00" title="2014-12-09 16:47:26 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/56">
                <strong>Fix merged to horizon (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/56"> #56</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/140353">https:/<wbr />/review.<wbr />openstack.<wbr />org/140353</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/horizon/commit/?id=43ba4fe19a2d0c0e6b3d51f8eb7c5e9ca5afcf86">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />horizon/<wbr />commit/<wbr />?id=43ba4fe19a2<wbr />d0c0e6b3d51f8eb<wbr />7c5e9ca5afcf86</a><br />
Submitter: Jenkins<br />
Branch:    master</p>
<p>commit 43ba4fe19a2d0c0<wbr />e6b3d51f8eb7c5e<wbr />9ca5afcf86<br />
Author: eric &lt;email address hidden&gt;<br />
Date:   Thu Nov 20 08:49:09 2014 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Horizon login page contains DOS attack mechanism</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;the horizon login page (really the middleware) accesses the session<br />
&nbsp;&nbsp;&nbsp;&nbsp;too early in the login process, which will create session records<br />
&nbsp;&nbsp;&nbsp;&nbsp;in the session backend.  This is especially problematic when non-cookie<br />
&nbsp;&nbsp;&nbsp;&nbsp;backends are used.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I9d2c40403fb9b0<wbr />cfb512f2ff45397<wbr />cbe0b050c71<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1394370</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/140353
Committed: https://git.openstack.org/cgit/openstack/horizon/commit/?id=43ba4fe19a2d0c0e6b3d51f8eb7c5e9ca5afcf86
Submitter: Jenkins
Branch:    master

commit 43ba4fe19a2d0c0e6b3d51f8eb7c5e9ca5afcf86
Author: eric &lt;eric.peterson1@twcable.com&gt;
Date:   Thu Nov 20 08:49:09 2014 -0700

    Horizon login page contains DOS attack mechanism
    
    the horizon login page (really the middleware) accesses the session
    too early in the login process, which will create session records
    in the session backend.  This is especially problematic when non-cookie
    backends are used.
    
    Change-Id: I9d2c40403fb9b0cfb512f2ff45397cbe0b050c71
    Closes-Bug: 1394370
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in horizon: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/57" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T18:54:35.068499+00:00" title="2014-12-09 18:54:35 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/57">
                <strong>Fix merged to horizon (stable/juno)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/57"> #57</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/140358">https:/<wbr />/review.<wbr />openstack.<wbr />org/140358</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/horizon/commit/?id=e8a66a4d92ae259a5ef004cafad1809942c66596">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />horizon/<wbr />commit/<wbr />?id=e8a66a4d92a<wbr />e259a5ef004cafa<wbr />d1809942c66596</a><br />
Submitter: Jenkins<br />
Branch:    stable/juno</p>
<p>commit e8a66a4d92ae259<wbr />a5ef004cafad180<wbr />9942c66596<br />
Author: eric &lt;email address hidden&gt;<br />
Date:   Thu Nov 20 08:49:09 2014 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Horizon login page contains DOS attack mechanism</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;the horizon login page (really the middleware) accesses the session<br />
&nbsp;&nbsp;&nbsp;&nbsp;too early in the login process, which will create session records<br />
&nbsp;&nbsp;&nbsp;&nbsp;in the session backend.  This is especially problematic when non-cookie<br />
&nbsp;&nbsp;&nbsp;&nbsp;backends are used.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I9d2c40403fb9b0<wbr />cfb512f2ff45397<wbr />cbe0b050c71<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1394370</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/140358
Committed: https://git.openstack.org/cgit/openstack/horizon/commit/?id=e8a66a4d92ae259a5ef004cafad1809942c66596
Submitter: Jenkins
Branch:    stable/juno

commit e8a66a4d92ae259a5ef004cafad1809942c66596
Author: eric &lt;eric.peterson1@twcable.com&gt;
Date:   Thu Nov 20 08:49:09 2014 -0700

    Horizon login page contains DOS attack mechanism
    
    the horizon login page (really the middleware) accesses the session
    too early in the login process, which will create session records
    in the session backend.  This is especially problematic when non-cookie
    backends are used.
    
    Change-Id: I9d2c40403fb9b0cfb512f2ff45397cbe0b050c71
    Closes-Bug: 1394370
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/58" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-09T18:56:27.747730+00:00" title="2014-12-09 18:56:27 UTC">on 2014-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/horizon/+bug/1394370/comments/58">
                <strong>Fix merged to horizon (stable/icehouse)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/58"> #58</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.openstack.org/140356">https:/<wbr />/review.<wbr />openstack.<wbr />org/140356</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/horizon/commit/?id=61d09f6f96a22cd6c0ade58f6486cdbd118c5e2a">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />horizon/<wbr />commit/<wbr />?id=61d09f6f96a<wbr />22cd6c0ade58f64<wbr />86cdbd118c5e2a</a><br />
Submitter: Jenkins<br />
Branch:    stable/icehouse</p>
<p>commit 61d09f6f96a22cd<wbr />6c0ade58f6486cd<wbr />bd118c5e2a<br />
Author: lin-hua-cheng &lt;email address hidden&gt;<br />
Date:   Mon Dec 1 18:16:15 2014 -0800</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Horizon login page contains DOS attack mechanism</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;the horizon login page (really the middleware) accesses the session<br />
&nbsp;&nbsp;&nbsp;&nbsp;too early in the login process, which will create session records<br />
&nbsp;&nbsp;&nbsp;&nbsp;in the session backend.  This is especially problematic when non-cookie<br />
&nbsp;&nbsp;&nbsp;&nbsp;backends are used.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I9d2c40403fb9b0<wbr />cfb512f2ff45397<wbr />cbe0b050c71<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1394370</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.openstack.org/140356
Committed: https://git.openstack.org/cgit/openstack/horizon/commit/?id=61d09f6f96a22cd6c0ade58f6486cdbd118c5e2a
Submitter: Jenkins
Branch:    stable/icehouse

commit 61d09f6f96a22cd6c0ade58f6486cdbd118c5e2a
Author: lin-hua-cheng &lt;os.lcheng@gmail.com&gt;
Date:   Mon Dec 1 18:16:15 2014 -0800

    Horizon login page contains DOS attack mechanism
    
    the horizon login page (really the middleware) accesses the session
    too early in the login process, which will create session records
    in the session backend.  This is especially problematic when non-cookie
    backends are used.
    
    Change-Id: I9d2c40403fb9b0cfb512f2ff45397cbe0b050c71
    Closes-Bug: 1394370
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-12-09 19:03:13 UTC" datetime="2014-12-09T19:03:13.555481+00:00">on 2014-12-09</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - horizon login page is vulnerable to DOS attack (CVE-2014-8124)<br />+ [OSSA 2014-040] horizon login page is vulnerable to DOS attack<br />+ (CVE-2014-8124)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/59" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jpichon" class="sprite person">Julie Pichon (jpichon)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-10T13:33:12.660479+00:00" title="2014-12-10 13:33:12 UTC">on 2014-12-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/59"> #59</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>For reference, django_<wbr />openstack_<wbr />auth review at <a rel="nofollow" href="https://review.openstack.org/#/c/140352/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />140352/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">For reference, django_openstack_auth review at https://review.openstack.org/#/c/140352/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-12-10 16:07:19 UTC" datetime="2014-12-10T16:07:19.175008+00:00">on 2014-12-10</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/horizon/+bug/1394370/comments/60" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~mrunge" class="sprite person">Matthias Runge (mrunge)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-12-18T11:59:57.770551+00:00" title="2014-12-18 11:59:57 UTC">on 2014-12-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/horizon/+bug/1394370/comments/60"> #60</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>as a follow-up here, sadly the fix introduced a regression, which I hope to fix with <a rel="nofollow" href="https://review.openstack.org/#/c/142737/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />142737/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">as a follow-up here, sadly the fix introduced a regression, which I hope to fix with https://review.openstack.org/#/c/142737/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-12-18 16:20:17 UTC" datetime="2014-12-18T16:20:17.497724+00:00">on 2014-12-18</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in horizon: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; kilo-1
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2015-04-30 08:22:15 UTC" datetime="2015-04-30T08:22:15.670137+00:00">on 2015-04-30</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in horizon: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        kilo-1 &#8594; 2015.1.0
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/horizon/+bug/1394370/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/horizon/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/horizon/+bug/1394370/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/horizon/+bug/1394370/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/horizon/+bug/1394370/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/horizon/+bug/1394370/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/horizon/+bug/1394370/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/horizon/+bug/1394370/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/horizon/+bug/1394370/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/horizon/+bug/1394370/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/horizon/+bug/1394370/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264421/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">solution patch</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4264421">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264456/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">patch with pep8 and unit test corrections - final patch</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4264456">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4264463/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">pydoc correction</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4264463">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269055/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">0001-Horizon-login-page-contains-DOS-attack-mechanism.patch</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4269055">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269366/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">patch with pep8 and unit test corrections, and logout cookie corrected</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4269366">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269568/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">0001-Horizon-login-page-contains-DOS-attack-mechanism.patch</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4269568">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4269689/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">0001-Horizon-login-page-contains-DOS-attack-mechanism.patch</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4269689">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4272357/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">final fixes for horizon repo</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4272357">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/horizon/+bug/1394370/+attachment/4272560/+files/0001-Horizon-login-page-contains-DOS-attack-mechanism.patch">icehouse patch for horizon</a>
        <small>
          (<a href="/horizon/+bug/1394370/+attachment/4272560">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/horizon/+bug/1394370/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"initial_comment_batch_offset": 41, "first visible_recent_comment": 20, "related_features": {}, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1394370", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1394370"}, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1394370", "web_link": "https://bugs.launchpad.net/bugs/1394370", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1394370, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)", "description": "We have horizon deployed with mysql sessions.   I believe this issue exists with all db backed sessions, and likely memchached too (but I am not sure).\n\nEvery request to the login page is generating a new session record in the db.  This is based upon this line of code:\nhttps://github.com/django/django/blob/master/django/contrib/sessions/backends/db.py#L41\nWhat happens is as soon as you access request.session['foo'] then you are going to get an entry in the db.\n\nI have placed some debugging code in a variety of locations where we are accessing the session store before we should be, which creates these records:\n\nhttps://github.com/openstack/horizon/blob/master/horizon/middleware.py#L94\nThe check for the timeout should never occur if there is no authenticated user.   So the check a few lines below needs to be moved higher.\n\nhttps://github.com/openstack/django_openstack_auth/blob/master/openstack_auth/utils.py#L50\nThis check I am not sure how to work around.  We are accessing the session, which creates records, just trying to keep track if a user is logged in or not.   It seems like we are not using the django auth mechanisms correctly here, and I can't see if there is a workaround.", "owner_link": "https://bugs.launchpad.net/api/devel/~ericpeterson-l", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/bug_tasks", "duplicate_of_link": null, "date_created": "2014-11-19T21:58:06.166172+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/subscriptions", "date_last_updated": "2016-03-21T09:56:57.769265+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 266, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/attachments", "security_related": true, "latest_patch_uploaded": "2014-12-02T02:25:36.489253+00:00", "tags": [], "date_last_message": "2014-12-18T11:59:57.770551+00:00", "number_of_duplicates": 0, "message_count": 61, "users_affected_count": 2, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/users_unaffected", "users_affected_count_with_dupes": 2, "other_users_affected_count_with_dupes": 2, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1394370/linked_merge_proposals", "http_etag": "\"9ec0e11103a76814f65bac613af3acae76485188-51c1724b0cde5b6dbfa024a67d2dc38516a85289\""}, "bugtask_data": {"1722160": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/horizon/juno/+bug/1394370/+delete", "user_can_edit_status": true, "bugtask_path": "/horizon/juno/+bug/1394370", "row_id": "tasksummary1722160", "importance_value": "Undecided", "importance_widget_items": "[]", "id": 1722160, "user_can_delete": false, "targetname": "OpenStack Dashboard (Horizon) juno", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)", "assignee_value": "tristan-cacqueray", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1722160", "target_is_product": false, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/horizon/+milestone/2014.2.2", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "horizon_juno"}, "1722159": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/horizon/icehouse/+bug/1394370/+delete", "user_can_edit_status": true, "bugtask_path": "/horizon/icehouse/+bug/1394370", "row_id": "tasksummary1722159", "importance_value": "Undecided", "importance_widget_items": "[]", "id": 1722159, "user_can_delete": false, "targetname": "OpenStack Dashboard (Horizon) icehouse", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)", "assignee_value": "lin-hua-cheng", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1722159", "target_is_product": false, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/horizon/+milestone/2014.1.4", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "horizon_icehouse"}, "1719772": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/horizon/+bug/1394370/+delete", "user_can_edit_status": true, "bugtask_path": "/horizon/+bug/1394370", "row_id": "tasksummary1719772", "importance_value": "High", "importance_widget_items": "[]", "id": 1719772, "user_can_delete": false, "targetname": "OpenStack Dashboard (Horizon)", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)", "assignee_value": "ericpeterson-l", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1719772", "target_is_product": true, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": "https://bugs.launchpad.net/api/devel/horizon/+milestone/2015.1.0", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "horizon"}, "1719839": {"milestone_widget_items": "[]", "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ossa/+bug/1394370/+delete", "user_can_edit_status": true, "bugtask_path": "/ossa/+bug/1394370", "row_id": "tasksummary1719839", "importance_value": "High", "importance_widget_items": "[]", "id": 1719839, "user_can_delete": false, "targetname": "OpenStack Security Advisory", "user_can_edit_importance": false, "assignee_vocabulary_filters": [], "bug_title": "[OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)", "assignee_value": "tristan-cacqueray", "hide_assignee_team_selection": true, "user_can_edit_assignee": false, "form_row_id": "task1719839", "target_is_product": true, "assignee_is_team": false, "status_value": "Fix Released", "user_can_unassign": false, "milestone_value": null, "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_milestone": false, "prefix": "ossa"}}, "bug_is_private": false, "context": {"self_link": "https://bugs.launchpad.net/api/devel/horizon/+bug/1394370", "web_link": "https://bugs.launchpad.net/horizon/+bug/1394370", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1394370", "milestone_link": "https://bugs.launchpad.net/api/devel/horizon/+milestone/2015.1.0", "status": "Fix Released", "importance": "High", "assignee_link": "https://bugs.launchpad.net/api/devel/~ericpeterson-l", "bug_target_display_name": "OpenStack Dashboard (Horizon)", "bug_target_name": "horizon", "bug_watch_link": null, "date_assigned": "2014-12-09T15:00:11.354530+00:00", "date_created": "2014-11-19T21:58:06.166172+00:00", "date_confirmed": "2014-11-20T18:11:00.384633+00:00", "date_incomplete": null, "date_in_progress": "2014-12-09T15:00:11.430934+00:00", "date_closed": "2014-12-18T16:20:19.145820+00:00", "date_left_new": "2014-11-20T18:11:00.384633+00:00", "date_triaged": "2014-12-04T13:45:25.031146+00:00", "date_fix_committed": "2014-12-09T16:47:24.883699+00:00", "date_fix_released": "2014-12-18T16:20:19.145820+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~ericpeterson-l", "target_link": "https://bugs.launchpad.net/api/devel/horizon", "title": "Bug #1394370 in OpenStack Dashboard (Horizon): \"[OSSA 2014-040] horizon login page is vulnerable to DOS attack (CVE-2014-8124)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/horizon/+bug/1394370/related_tasks", "is_complete": true, "http_etag": "\"90c1ec146cd725376c4cc652b287315c097f55e3-4d1e56883afc9cde75ad9ce77d63a6c81741eb0c\""}, "information_type_data": {"PUBLIC": {"value": "PUBLIC", "is_private": false, "order": 0, "name": "Public", "description": "Everyone can see this information.\n", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"value": "PRIVATESECURITY", "is_private": true, "order": 2, "name": "Private Security", "description": "Only the security group can see this information.\n ", "description_css_class": "choice-description"}, "USERDATA": {"value": "USERDATA", "is_private": true, "order": 3, "name": "Private", "description": "Only shared with users permitted to see private user information.\n", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"value": "PUBLICSECURITY", "is_private": false, "order": 1, "name": "Public Security", "description": "Everyone can see this security related information.\n", "description_css_class": "choice-description"}}, "total_comments_and_activity": 110};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 64 queries/external actions issued in 1.13 seconds

    Features: {'bugs.nominations.bug_supervisors_can_target': 'on', 'hard_timeout': '9000', 'visible_render_time': None, 'bugs.affected_count_includes_dupes.disabled': None, 'app.mainsite_only.canonical_url': None, 'app.maintenance_message': None, 'js.yui_version': None, 'disclosure.dsp_picker.enabled': 'on', 'profiling.enabled': None, 'baselayout.careers_link.disabled': None}

    r0d8de2b

    -->

</html>

