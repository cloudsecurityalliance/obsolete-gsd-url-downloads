<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Alpine Linux">
        <title>Docker Image Vulnerability - CVE-2019-5021 | Alpine Linux</title>

        <link rel="stylesheet" href="/css/pure-min.css" />
        <link rel="stylesheet" href="/css/grids-responsive-min.css" />
        <link rel="stylesheet" href="/css/font-awesome.min.css" />
        <link rel="stylesheet" href="/css/styles.css" />
        <link rel="shortcut icon" href="/alpine-logo.ico" />
    </head>
    <body>
        <div id="wrapper">
            <header class="pure-g" id="header">
                <div class="pure-u-1 pure-u-lg-4-24">
                    <div class="logo">
                        <a href="/"><img src="/alpinelinux-logo.svg" class="pure-img" alt="" /></a>
                    </div>
                </div>
                <input type="checkbox" id="menu-toggle-cb">
                <label id="menu-toggle" for="menu-toggle-cb" onclick><s class="bar"></s><s class="bar"></s><s class="bar"></s></label>
                <div class="pure-u-1 pure-u-lg-20-24 box-relative menu-wrapper">
                    <nav class="pure-menu pure-menu-horizontal menu-local">
                        <ul class="pure-menu-list">
                            <li class="pure-menu-item"><a href="/about" class="pure-menu-link">About</a></li>
                            <li class="pure-menu-item"><a href="/downloads" class="pure-menu-link">Downloads</a></li>
                            <li class="pure-menu-item"><a href="/releases" class="pure-menu-link">Releases</a></li>
                            <li class="pure-menu-item"><a href="/community" class="pure-menu-link">Community</a></li>
                            <li class="pure-menu-item"><a href="/sponsors" class="pure-menu-link">Sponsors</a></li>
                        </ul>
                    </nav>
                    <nav class="pure-menu pure-menu-horizontal menu-external">
                        <ul class="pure-menu-list">
                            <li class="pure-menu-item"><a href="https://docs.alpinelinux.org" class="pure-menu-link">docs</a></li>
                            <li class="pure-menu-item"><a href="https://wiki.alpinelinux.org" class="pure-menu-link">wiki</a></li>
                            <li class="pure-menu-item"><a href="https://git.alpinelinux.org" class="pure-menu-link">git</a></li>
                            <li class="pure-menu-item"><a href="https://gitlab.alpinelinux.org/alpine/aports/-/issues" class="pure-menu-link">issues</a></li>
                            <li class="pure-menu-item"><a href="https://pkgs.alpinelinux.org" class="pure-menu-link">packages</a></li>
                            <li class="pure-menu-item"><a href="https://mirrors.alpinelinux.org" class="pure-menu-link">mirrors</a></li>
                            <li class="pure-menu-item"><a href="https://security.alpinelinux.org" class="pure-menu-link">security</a></li>
                        </ul>
                    </nav>
                </div>
            </header>
            <div class="banner">
                <div class="banner-content">
                    <h1>Small. Simple. Secure.</h1>
                    <h3>Alpine Linux is a security-oriented, lightweight Linux distribution based on musl libc and busybox.</h3>
                </div>
            </div>
            <div id="content" class="posts">
                <h1>Docker Image Vulnerability (CVE-2019-5021)</h1>

<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5021">CVE-2019-5021</a></p>

<h2>What is the problem?</h2>

<p>If you have the <code>shadow</code> package installed in your Docker container and run
your service as non-root user, an attacker who compromised your system via an
unrelated security vulnerabillity, or a user with shell access, could elevate
their privileges to root within the container.</p>

<h2>Who is affected?</h2>

<p>The issue only affects Docker images. If you used the Alpine linux installer,
<code>setup-alpine</code>, you are not affected.</p>

<p>You are not affected unless you have <code>shadow</code> or <code>linux-pam</code> packages
installed.</p>

<p>The issue was
<a href="https://git.alpinelinux.org/aports/commit/?id=7a2566ec8260ceacae81088ebe2ffe6526c3809e">fixed</a>
in the following <a href="https://github.com/docker-library/official-images/pull/5516">Docker image releases</a>
(<a href="https://github.com/docker-library/official-images/pull/5516#event-2188593676">7 March 2019</a>):</p>

<ul>
<li>edge (20190228 snapshot)</li>
<li>v3.9.2</li>
<li>v3.8.4</li>
<li>v3.7.3</li>
<li>v3.6.5</li>
</ul>


<p>The following versions are EOL and still vulnerable:</p>

<ul>
<li>v3.5</li>
<li>v3.4</li>
<li>v3.3</li>
</ul>


<h2>How can I fix it?</h2>

<p>Make sure that you use one of the supported releases and update your image.</p>

<p>If you use any of older, unsupported releases, then you can fix it by adding
this line to your Dockerfile:</p>

<pre>
    # make sure root login is disabled
    RUN sed -i -e 's/^root::/root:!:/' /etc/shadow
</pre>


<p>Alternatively you could make sure that you don&rsquo;t have <code>linux-pam</code> installed.</p>

<h2>How could this happen?</h2>

<p>Alpine uses <code>busybox</code> as core tools. We have tested and made sure that root
logins without password are only allowed from TTYs that are listed as secure in
<code>/etc/securetty</code>. This makes it possible to boot Alpine on a machine and log in
as root without shipping any pregenerated, well known password for Alpine. We
consider a pregenerated, well known password worse than no password at all.</p>

<p>Services like <code>sshd</code> will not allow logins with blank passwords at all.</p>

<p>Unfortunately we missed the case when a user installs <code>shadow</code> and <code>linux-pam</code>
instead of using the default tools.</p>

<p><small>
EDIT: release date of fixed releases was added
</small></p>

            </div> <!-- end content -->
            <footer>&copy; Copyright 2021 Alpine Linux Development Team all rights reserved | <a href="/privacy-policy.html">Privacy Policy</a></footer>
        </div> <!-- end wrapper -->
    </body>
</html>
