<!DOCTYPE html>
<html lang="en">
  <head>
    <title>705 &ndash; OSPF LSA length not checked, resulting in abort in stream_getl with an assert</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/ffdcf901c2630eea0c8a01fbe65431a1.css?1468240387" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1468240387"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "705 – OSPF LSA length not checked, resulting in abort in stream_getl with an assert",
                             "show_bug.cgi?id=705" );
        document.title = "705 – OSPF LSA length not checked, resulting in abort in stream_getl with an assert";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "705 – OSPF LSA length not checked, resulting in abort in stream_getl with an assert", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1468240387"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugzilla-quagga-net
                 bz_bug
                 bz_status_REOPENED
                 bz_product_Quagga
                 bz_component_ospfd
                 bz_bug_705 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;705</span>

        <span id="subtitle" class="subheader">OSPF LSA length not checked, resulting in abort in stream_getl with an assert</span>

        <span id="information" class="header_addl_info">Last modified: 2018-08-21 08:41:13 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=705&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=705" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=705&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635624131--yL8_8icRH05WGykNFh4rFo40xw6ONxgv6WwBG7mhcE">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2018-08-21 08:41:13">
  <input type="hidden" name="id" value="705">
  <input type="hidden" name="token" value="1635624131-YEJ7YLpj0YqrfsNVUdwChsWCtLIaqG-NzkamfPILTvI">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=705"><b>Bug&nbsp;705</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">OSPF LSA length not checked, resulting in abort in stream_getl with an assert</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>OSPF LSA length not checked, resulting in abort in stream_getl with an assert
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'OSPF LSA length not checked, resulting in abort in stream_getl with an assert' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">REOPENED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Quagga

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Quagga"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >ospfd

  (<a href="buglist.cgi?component=ospfd&amp;product=Quagga&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>git tree
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P5 (lowest)
       major
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Quagga maintainers</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'maintainers\x40quagga.net',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >OSR

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2012-01-16 11:14 UTC by <span class="vcard"><span class="fn">Martin Winter</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2018-08-21 08:41 UTC
      (<a href="show_activity.cgi?id=705">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>5 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="castro8583bennett">castro8583bennett</option>
                <option value="denis">denis</option>
                <option value="me">me</option>
                <option value="mwinter">mwinter</option>
                <option value="tejblum">tejblum</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_octet-stream">
        <td>
            <a href="attachment.cgi?id=382"
               title="View the content of the attachment">
          <b>ospfd.log showing the crash (with Debug enabled)</b></a>

          <span class="bz_attach_extra_info">
              (10.30 KB,
                application/octet-stream)

            <br>
            <a href="#attach_382"
               title="Go to the comment associated with the attachment">2012-01-16 11:14 UTC</a>,

            <span class="vcard"><span class="fn">Martin Winter</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=382&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=383"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Proposed patch</span></b></a>

          <span class="bz_attach_extra_info">
              (1.14 KB,
                patch)

            <br>
            <a href="#attach_383"
               title="Go to the comment associated with the attachment">2012-01-16 11:17 UTC</a>,

            <span class="vcard"><span class="fn">Martin Winter</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=383&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=383&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=388"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">fix for 0.99.20</span></b></a>

          <span class="bz_attach_extra_info">
              (8.35 KB,
                patch)

            <br>
            <a href="#attach_388"
               title="Go to the comment associated with the attachment">2012-01-30 22:44 UTC</a>,

            <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=388&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=388&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=390"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">fix for 0.99.20, revision 2</span></b></a>

          <span class="bz_attach_extra_info">
              (18.12 KB,
                patch)

            <br>
            <a href="#attach_390"
               title="Go to the comment associated with the attachment">2012-02-17 06:48 UTC</a>,

            <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=390&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=390&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=395"
               title="View the content of the attachment">
          <b>ospfd.conf of Quagga1 (DUT) to show MD5 issues</b></a>

          <span class="bz_attach_extra_info">
              (490 bytes,
                text/plain)

            <br>
            <a href="#attach_395"
               title="Go to the comment associated with the attachment">2012-02-29 20:54 UTC</a>,

            <span class="vcard"><span class="fn">Martin Winter</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=395&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a6" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=396"
               title="View the content of the attachment">
          <b>ospfd.conf of Quagga2 (Tester) to show MD5 issues</b></a>

          <span class="bz_attach_extra_info">
              (490 bytes,
                text/plain)

            <br>
            <a href="#attach_396"
               title="Go to the comment associated with the attachment">2012-02-29 20:54 UTC</a>,

            <span class="vcard"><span class="fn">Martin Winter</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=396&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a7" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=397"
               title="View the content of the attachment">
          <b>ospfd.log with debug enabled showing the MD5 issue</b></a>

          <span class="bz_attach_extra_info">
              (27.18 KB,
                text/plain)

            <br>
            <a href="#attach_397"
               title="Go to the comment associated with the attachment">2012-02-29 20:55 UTC</a>,

            <span class="vcard"><span class="fn">Martin Winter</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=397&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a8" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=398"
               title="View the content of the attachment">
          <b>fix for 0.99.20, revision 3</b></a>

          <span class="bz_attach_extra_info">
              (27.23 KB,
                patch)

            <br>
            <a href="#attach_398"
               title="Go to the comment associated with the attachment">2012-03-01 01:54 UTC</a>,

            <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=398&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=398&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a9" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=417"
               title="View the content of the attachment">
          <b>Patch (Commit 2d3e4e3 from Quagga-RE) to fix edge case for virtual links</b></a>

          <span class="bz_attach_extra_info">
              (1.26 KB,
                patch)

            <br>
            <a href="#attach_417"
               title="Go to the comment associated with the attachment">2012-04-05 15:58 UTC</a>,

            <span class="vcard"><span class="fn">Martin Winter</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=417&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=417&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (3)
        </span>
        <a href="attachment.cgi?bugid=705&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=705&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1467653545" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        replytext = prefix;


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-16 11:14:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=382" name="attach_382" title="ospfd.log showing the crash (with Debug enabled)">attachment 382</a> <a href="attachment.cgi?id=382&amp;action=edit" title="ospfd.log showing the crash (with Debug enabled)">[details]</a></span>
ospfd.log showing the crash (with Debug enabled)

OSPF LS Update Message - Missing length check

(Test run with Quagga 0.99.20 and GIT Head as of Jan 8, 2012)

Testing OSPF with a protocol fuzzer, we found a crash in OSPF if the LS updates had an
invalid length (basically too short)
If a OSPF packet contains the type &quot;LS Update&quot; (code 4), but the length of the packet
is too short to actually contain a LS Update, then OSPF crashes. In our case we simulated
it with a packet (and packet length) which only consists of the OSPF header and no bytes
for the LS Update inside it - but still had the &quot;LS Update&quot; (code 4) in the OSPF header.

Here is the backtrace:

root&#64;quagga-bgp:~# gdb /usr/local/q20110108/sbin/ospfd 
GNU gdb (Ubuntu/Linaro 7.2-1ubuntu11) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;<a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-linux-gnu&quot;.
For bug reporting instructions, please see:
&lt;<a href="http://www.gnu.org/software/gdb/bugs/">http://www.gnu.org/software/gdb/bugs/</a>&gt;...
Reading symbols from /usr/local/q20110108/sbin/ospfd...done.
(gdb) r
Starting program: /usr/local/q20110108/sbin/ospfd 
[Thread debugging using libthread_db enabled]

Program received signal SIGABRT, Aborted.
0x00007ffff714ed05 in raise () from /lib/x86_64-linux-gnu/libc.so.6
(gdb) bt
#0  0x00007ffff714ed05 in raise () from /lib/x86_64-linux-gnu/libc.so.6
#1  0x00007ffff7152ab6 in abort () from /lib/x86_64-linux-gnu/libc.so.6
#2  0x00007ffff791cddb in _zlog_assert_failed (assertion=0x7ffff793a8e4 &quot;0&quot;, 
    file=0x7ffff793d5bc &quot;stream.c&quot;, line=370, function=&lt;value optimized out&gt;)
    at log.c:618
#3  0x00007ffff7919a63 in stream_getl (s=0x6976e0) at stream.c:366
#4  0x00007ffff7b84555 in ospf_ls_upd_list_lsa (iph=&lt;value optimized out&gt;, 
    ospfh=0x697724, s=0x6976e0, oi=0x6a81e0, size=&lt;value optimized out&gt;)
    at ospf_packet.c:1552
#5  ospf_ls_upd (iph=&lt;value optimized out&gt;, ospfh=0x697724, s=0x6976e0, 
    oi=0x6a81e0, size=&lt;value optimized out&gt;) at ospf_packet.c:1717
#6  0x00007ffff7b869f3 in ospf_read (thread=&lt;value optimized out&gt;)
    at ospf_packet.c:2606
#7  0x00007ffff7911cb6 in thread_call (thread=0x7fffffffe520) at thread.c:1177
#8  0x0000000000401849 in main (argc=1, argv=0x7fffffffe728) at ospf_main.c:340
(gdb) up
#1  0x00007ffff7152ab6 in abort () from /lib/x86_64-linux-gnu/libc.so.6
(gdb) up
#2  0x00007ffff791cddb in _zlog_assert_failed (assertion=0x7ffff793a8e4 &quot;0&quot;, 
    file=0x7ffff793d5bc &quot;stream.c&quot;, line=370, function=&lt;value optimized out&gt;)
    at log.c:618
618	  abort();
(gdb) up
(gdb) up
#1  0x00007ffff7152ab6 in abort () from /lib/x86_64-linux-gnu/libc.so.6
(gdb) up
#2  0x00007ffff791cddb in _zlog_assert_failed (assertion=0x7ffff793a8e4 &quot;0&quot;, 
    file=0x7ffff793d5bc &quot;stream.c&quot;, line=370, function=&lt;value optimized out&gt;)
    at log.c:618
618	  abort();
(gdb) up
#3  0x00007ffff7919a63 in stream_getl (s=0x6976e0) at stream.c:366
366	  STREAM_VERIFY_SANE(s);
(gdb) up
#4  0x00007ffff7b84555 in ospf_ls_upd_list_lsa (iph=&lt;value optimized out&gt;, 
    ospfh=0x697724, s=0x6976e0, oi=0x6a81e0, size=&lt;value optimized out&gt;)
    at ospf_packet.c:1552
1552	  count = stream_getl (s);
(gdb) list 
1547	  struct ospf_lsa *lsa;
1548	  struct list *lsas;
1549	
1550	  lsas = list_new ();
1551	
1552	  count = stream_getl (s);
1553	  size -= OSPF_LS_UPD_MIN_SIZE; /* # LSAs */
1554	
1555	  for (; size &gt;= OSPF_LSA_HEADER_SIZE &amp;&amp; count &gt; 0;
1556	       size -= length, stream_forward_getp (s, length), count--)
(gdb) p s
$1 = (struct stream *) 0x6976e0
(gdb) p *s
$2 = {next = 0x0, getp = 44, endp = 44, size = 65536, data = 0x697710 &quot;E\300,&quot;}
(gdb) q


The problem is in ospf_ls_upd_list_lsa function (in ospf_packet.c):
&lt;--- code snippet ---&gt;
static struct list *
ospf_ls_upd_list_lsa (struct ospf_neighbor *nbr, struct stream *s,
                      struct ospf_interface *oi, size_t size)
{
  u_int16_t count, sum;
  u_int32_t length;
  struct lsa_header *lsah;  struct ospf_lsa *lsa;
  struct list *lsas;

  lsas = list_new ();

  count = stream_getl (s);
  size -= OSPF_LS_UPD_MIN_SIZE; /* # LSAs */

  for (; size &gt;= OSPF_LSA_HEADER_SIZE &amp;&amp; count &gt; 0;
       size -= length, stream_forward_getp (s, length), count--)
    {
&lt;--- end of code snippet ---&gt;

At the entry of this function, the values are set to the following (in one of my crashes):
size = 0
s-&gt;next = 0
s-&gt;getp = 44
s-&gt;endp = 44
s-&gt;size = 0

this will trigger the assert inside stream_getl as s-&gt;size &lt; s-&gt;endp.

I believe the following patch will fix this (attached as patch_ospf_lsa_length.diff ):

######## Diff follows ######
    ospfd: LSA length not checked, resulting in abort in stream_getl with an assert

    * ospf_packet.c (ospf_ls_upd_list_lsa) The length field of the lsa is not checked.
      If the lsa length is shorter than the OSPF_LS_UPD_MIN_SIZE (4 bytes), then the
      ospfd will abort with a assert in stream_getl. Added check for the length and 
      ignore packets with a length below the minimum (and log the offending source)

--- a/ospfd/ospf_packet.c	2012-01-15 22:26:41.700021099 -0800
+++ b/ospfd/ospf_packet.c	2012-01-15 07:49:15.950003374 -0800
&#64;&#64; -1549,8 +1549,19 &#64;&#64;
 
   lsas = list_new ();
 
-  count = stream_getl (s);
-  size -= OSPF_LS_UPD_MIN_SIZE; /* # LSAs */
+  if (size &lt; OSPF_LS_UPD_MIN_SIZE)
+    {
+      zlog_warn (&quot;Link State Update: LSA length (%d) shorter than min update&quot;
+           &quot; size (%d) from nbr %s&quot;,
+           size, OSPF_LS_UPD_MIN_SIZE, inet_ntoa (nbr-&gt;src));
+      count = 0;
+      size = 0;
+    }
+  else
+    {
+      count = stream_getl (s);
+      size -= OSPF_LS_UPD_MIN_SIZE; /* # LSAs */
+    }
 
   for (; size &gt;= OSPF_LSA_HEADER_SIZE &amp;&amp; count &gt; 0;
        size -= length, stream_forward_getp (s, length), count--)
############ end diff ##########

basically check the size to make sure it is at least the min size BEFORE calling stream_getl()
It will log a message when this happens:
2012/01/15 07:50:22 OSPF: Link State Update: LSA length (0) shorter than min update size (4) from nbr 172.17.214.1



How to reproduce the problem:
=============================

Attached is a binary (produced by MU Dynamics tester) which will simulate the OSPF neighbor 
and create the issue. I've used Linux (Ubuntu 11.04 Server), but it shouldn't matter what OS 
was used. To reproduce the issue connect 2 Linux boxes together:
The DUT is running Quagga 0.99.20 or GIT head (Jan 8, 2012) (I assume any other version
 has same issue, but I didn't verify this.

(if you use another interface, then just substitute the correct if name in the config below. 
However, you can't change the router-id as this is hard-coded in the vet binary to reproduce. 
If Quagga is configured with a different router-id, then it won't get the OSPF neighbor)

(pic - look at it with fixed width font)
+---------------+                                   +----------------+
|   Tester      | eth1     172.17.214.0/24     eth1 |       DUT      |
| (evt binary)  |-----------------------------------|     Quagga     |
|               | 172.17.214.1     172.17.214.100   |                |
+---------------+                                   +----------------+
 OSPF router-id:                                     OSPF router-id:
   192.168.1.1                                        172.17.200.213

Quagga OSPF config:
   router ospf
    log-adjacency-changes
    ospf router-id 172.17.200.213
    network 172.17.214.0/24 area 0.0.0.0
(and configure eth1 for 172.17.214.100/24)

Tester config:
  configure eth1 for 172.17.214.1 

Theo run the tool with:
  evt_ospfv2-lsa.bin eth1 172.17.214.100 00:1c:42:c1:41:f1
     (substitute the mac address with the mac addr of the DUT eth1 interface)

This should cause the crash within a few seconds.


- Martin Winter
  OpenSourceRouting.org</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-16 11:17:18 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=383&amp;action=diff" name="attach_383" title="Proposed patch">attachment 383</a> <a href="attachment.cgi?id=383&amp;action=edit" title="Proposed patch">[details]</a></span>
Proposed patch</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-16 11:24:20 UTC
        </span>

      </div>




<pre class="bz_comment_text">evt binary as described in the comment is larger than bugzilla's file limit. I've placed it on
   <a href="http://users.isc.org/~mwinter/bugzilla-705/evt_ospfv2-lsa.bin">http://users.isc.org/~mwinter/bugzilla-705/evt_ospfv2-lsa.bin</a></pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-16 12:47:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">By a chance, I was working on this problem yesterday, it is a bigger patch, which should cover all packet types. I hope to finish it by the end of the month, it would be interesting to know if it completely stops the fuzzer or not.

I will handle this case.</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-16 13:00:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=705#c3">comment #3</a>)

Thank you. 
All the issues the fuzzer found at this time were related to this same length field (full run was done with 0.99.20 and only verified the failed ones against git head). I'm happy to run your patch through our testbed against all the tests with the fuzzer before you commit it.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-17 17:19:04 UTC
        </span>

      </div>




<pre class="bz_comment_text">I hope to provide the patch by the next week. Basically, it is an adaptation of the OSPFv3 fix you can see in commit 552563a1c443ec876edd92bf79f29ff3afe2c01e, and I have been working on it for the last week. It is complete in its most part, but still lacks a precise coupling of particular checks to become finished.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-24 12:54:19 UTC
        </span>

      </div>




<pre class="bz_comment_text">Still working on the patch.</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-30 22:44:48 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=388&amp;action=diff" name="attach_388" title="fix for 0.99.20">attachment 388</a> <a href="attachment.cgi?id=388&amp;action=edit" title="fix for 0.99.20">[details]</a></span>
fix for 0.99.20

The big work mentioned earlier is still not finished, but I am ready to deliver that specific part of it, which handles packet size checks. It covers the class of anomalies, to which this case belongs.

The described testbed setup has been reproduced against RE-testing-0.99 branch and confirmed to trigger the bug at commit c415562 (without the checks) and not to trigger at commit e4e3f3e (with checks). The attached patch adapts commits 95f09bb, dad9b68 and e4e3f3e for 0.99.20 release.

If you are interested in LSA-level fuzzing of OSPFv2 protocol, I can let you know, when respective checks are in place. Thank you for detailed report!</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-30 22:51:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">With the patch applied and &quot;debug ospf packet all&quot; configured, there will be an additional message in the log file about packet anomalies. For this specific case it is:

OSPF: ospf_packet_examin: undersized (24 B) Link State Update packet</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-31 05:54:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">I will be on a short leave soon. Please note any observations about the patch here and I will look for the best way to finalize this issue upon return. Thank you!</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-31 15:13:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=705#c9">comment #9</a>)

It seems there is one case which got missed. I ran the full fuzzer test suite against 0.99.20 with the patch applied and had a crash in  the test &quot;ospfv2.ls-update-mutated-1.packet.lsas.router-lsa.length.values&quot;

2012/01/30 20:02:28 OSPF: DR-Election[1st]: Backup 172.17.214.1
2012/01/30 20:02:28 OSPF: DR-Election[1st]: DR     172.17.214.100
2012/01/30 20:02:28 OSPF: Packet[DD]: Neighbor 192.168.1.1 Negotiation done (Slave).
2012/01/30 20:02:28 OSPF: Link State Update: LSA checksum error d808, c254.
OSPF: Received signal 11 at 1327982548 (si_addr 0x0); aborting...
Backtrace for 15 stack frames:
/usr/local/q9920-bz705/lib/libzebra.so.0(zlog_backtrace_sigsafe+0x3e)[0x7fdc29695cda]
/usr/local/q9920-bz705/lib/libzebra.so.0(zlog_signal+0x235)[0x7fdc29696259]
/usr/local/q9920-bz705/lib/libzebra.so.0(+0x34012)[0x7fdc2969e012]
/lib/x86_64-linux-gnu/libc.so.6(+0x33d80)[0x7fdc28ec8d80]
/usr/local/q9920-bz705/lib/libzebra.so.0(route_node_lookup+0x14)[0x7fdc2968df21]
/usr/local/q9920-bz705/lib/libospf.so.0(ospf_lsdb_lookup+0x39)[0x7fdc298fc9b0]
/usr/local/q9920-bz705/lib/libospf.so.0(+0x38aee)[0x7fdc298fbaee]
/usr/local/q9920-bz705/lib/libospf.so.0(ospf_flood_through_area+0x70)[0x7fdc298fbf0f]
/usr/local/q9920-bz705/lib/libospf.so.0(ospf_flood+0x17d)[0x7fdc298fc252]
/usr/local/q9920-bz705/lib/libospf.so.0(+0x2ac96)[0x7fdc298edc96]
/usr/local/q9920-bz705/lib/libospf.so.0(ospf_read+0x1b29)[0x7fdc298efaf6]
/usr/local/q9920-bz705/lib/libzebra.so.0(thread_call+0x5e)[0x7fdc2968b9ca]
/usr/local/q9920-bz705/sbin/ospfd[0x4017d6]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xff)[0x7fdc28eb3eff]
/usr/local/q9920-bz705/sbin/ospfd[0x401349]

This is just a heads up. I'll get you more details in a few hours and hope to have a way for you to reproduce the issue.</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-31 20:36:35 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ok. The patch works against the previous mentioned test binary, but it misses one case:
If the LSA is correct (ethernet frame correct, contains LSA), but has the Length field inside the LSA wrong.

Here is a example of the frame: (Be aware that wireshark falls over on the decoding as well)

Frame 24: 142 bytes on wire (1136 bits), 142 bytes captured (1136 bits)
Ethernet II, Src: Interfac_03:a1:ab (00:0c:bd:03:a1:ab), Dst: IPv4mcast_00:00:05 (01:00:5e:00:00:05)
Internet Protocol Version 4, Src: 172.17.214.1 (172.17.214.1), Dst: 224.0.0.5 (224.0.0.5)
Open Shortest Path First
    OSPF Header
    LS Update Packet
        Number of LSAs: 2
        LS Type: Router-LSA
            LS Age: 1 seconds
            Do Not Age: False
            Options: 0x02 (E)
            Link-State Advertisement Type: Router-LSA (1)
            Link State ID: 192.168.1.1
            Advertising Router: 192.168.1.1 (192.168.1.1)
            LS Sequence Number: 0x00000064
            LS Checksum: 0x08d8
            Length: 0
        LS Type: Network-LSA
            LS Age: 512 seconds
            Do Not Age: False
            Options: 0x00
            Link-State Advertisement Type: Network-LSA (2)
            Link State ID: 192.168.1.1
            Advertising Router: 255.255.255.255 (255.255.255.255)
            LS Sequence Number: 0x03000000
            LS Checksum: 0xc0a8
            Length: 256
            Netmask: 255.255.255.0
            Attached Router: 3.0.0.1
            Attached Router: 0.1.2.2
            Attached Router: 192.168.1.1
            Attached Router: 192.168.1.1
            Attached Router: 0.0.0.101
            Attached Router: 35.179.0.32
            Attached Router: 255.255.255.0
            Attached Router: 192.168.1.1
            Attached Router: 172.17.200.214
[Malformed Packet: OSPF]
    [Expert Info (Error/Malformed): Malformed Packet (Exception occurred)]
        [Message: Malformed Packet (Exception occurred)]
        [Severity level: Error]
        [Group: Malformed]

0000  01 00 5e 00 00 05 00 0c bd 03 a1 ab 08 00 45 c0   ..^...........E.
0010  00 80 00 00 40 00 01 59 16 4d ac 11 d6 01 e0 00   ....&#64;..Y.M......
0020  00 05 02 04 00 6c c0 a8 01 01 00 00 00 00 43 da   .....l........C.
0030  00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 01   ................
0040  02 01 c0 a8 01 01 c0 a8 01 01 00 00 00 64 08 d8   .............d..
0050  00 00 02 00 00 02 c0 a8 01 01 ff ff ff ff 03 00   ................
0060  00 00 c0 a8 01 00 ff ff ff 00 03 00 00 01 00 01   ................
0070  02 02 c0 a8 01 01 c0 a8 01 01 00 00 00 65 23 b3   .............e#.
0080  00 20 ff ff ff 00 c0 a8 01 01 ac 11 c8 d6         . ............

The frame is all correct up to the &quot;Length:0 &quot; in the Router-LSA (Bytes 0x50 &amp; 0x51)

Here is how the same frame would look like with correct length:

Frame 24: 142 bytes on wire (1136 bits), 142 bytes captured (1136 bits)
Ethernet II, Src: Interfac_03:a1:ab (00:0c:bd:03:a1:ab), Dst: IPv4mcast_00:00:05 (01:00:5e:00:00:05)
Internet Protocol Version 4, Src: 172.17.214.1 (172.17.214.1), Dst: 224.0.0.5 (224.0.0.5)
Open Shortest Path First
    OSPF Header
    LS Update Packet
        Number of LSAs: 2
        LS Type: Router-LSA
            LS Age: 1 seconds
            Do Not Age: False
            Options: 0x02 (E)
            Link-State Advertisement Type: Router-LSA (1)
            Link State ID: 192.168.1.1
            Advertising Router: 192.168.1.1 (192.168.1.1)
            LS Sequence Number: 0x00000064
            LS Checksum: 0x08d8
            Length: 48
            Flags: 0x02 (E)
            Number of Links: 2
            Type: Stub     ID: 192.168.1.1     Data: 255.255.255.255 Metric: 0
            Type: Stub     ID: 192.168.1.0     Data: 255.255.255.0   Metric: 1
        LS Type: Network-LSA
            LS Age: 1 seconds
            Do Not Age: False
            Options: 0x02 (E)
            Link-State Advertisement Type: Network-LSA (2)
            Link State ID: 192.168.1.1
            Advertising Router: 192.168.1.1 (192.168.1.1)
            LS Sequence Number: 0x00000065
            LS Checksum: 0x23b3
            Length: 32
            Netmask: 255.255.255.0
            Attached Router: 192.168.1.1
            Attached Router: 172.17.200.214

0000  01 00 5e 00 00 05 00 0c bd 03 a1 ab 08 00 45 c0   ..^...........E.
0010  00 80 00 00 40 00 01 59 16 4d ac 11 d6 01 e0 00   ....&#64;..Y.M......
0020  00 05 02 04 00 6c c0 a8 01 01 00 00 00 00 43 da   .....l........C.
0030  00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 01   ................
0040  02 01 c0 a8 01 01 c0 a8 01 01 00 00 00 64 08 d8   .............d..
0050  00 30 02 00 00 02 c0 a8 01 01 ff ff ff ff 03 00   .0..............
0060  00 00 c0 a8 01 00 ff ff ff 00 03 00 00 01 00 01   ................
0070  02 02 c0 a8 01 01 c0 a8 01 01 00 00 00 65 23 b3   .............e#.
0080  00 20 ff ff ff 00 c0 a8 01 01 ac 11 c8 d6         . ............

Running the OSPFd in debug shows the problem:
(This is 0.99.20 Release with the patch &quot;fix for 0.99.20&quot; applied to it. I've recompiled it with optimization turned off to be able to show the different variables - otherwise they are mostly &quot;optimized out&quot; by the compiler)

root&#64;quagga-ospf:~# gdb /usr/local/q9920-bz705/sbin/ospfd
GNU gdb (Ubuntu/Linaro 7.2-1ubuntu11) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;<a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-linux-gnu&quot;.
For bug reporting instructions, please see:
&lt;<a href="http://www.gnu.org/software/gdb/bugs/">http://www.gnu.org/software/gdb/bugs/</a>&gt;...
Reading symbols from /usr/local/q9920-bz705/sbin/ospfd...done.
(gdb) r
Starting program: /usr/local/q9920-bz705/sbin/ospfd 
[Thread debugging using libthread_db enabled]

Program received signal SIGSEGV, Segmentation fault.
route_node_lookup (table=0x0, p=0x7fffffffe040) at table.c:262
262	  node = table-&gt;top;
(gdb) bt
#0  route_node_lookup (table=0x0, p=0x7fffffffe040) at table.c:262
#1  0x00007ffff7b7f138 in ospf_lsdb_lookup (lsdb=0x6aa400, lsa=0x6ab070)
    at ospf_lsdb.c:222
#2  0x00007ffff7b7e2a0 in ospf_ls_request_lookup (nbr=0x6aa070, lsa=0x6ab070)
    at ospf_flood.c:823
#3  0x00007ffff7b7d8fd in ospf_flood_through_interface (oi=0x6a83c0, 
    inbr=0x6aa070, lsa=0x6ab070) at ospf_flood.c:397
#4  0x00007ffff7b7ddbf in ospf_flood_through_area (area=0x6a79d0, 
    inbr=0x6aa070, lsa=0x6ab070) at ospf_flood.c:592
#5  0x00007ffff7b7e09e in ospf_flood_through (ospf=0x696180, inbr=0x6aa070, 
    lsa=0x6ab070) at ospf_flood.c:752
#6  0x00007ffff7b7d651 in ospf_flood (ospf=0x696180, nbr=0x6aa070, 
    current=0x0, new=0x6ab070) at ospf_flood.c:282
#7  0x00007ffff7b65b01 in ospf_ls_upd (iph=0x697450, ospfh=0x697464, 
    s=0x697420, oi=0x6a83c0, size=84) at ospf_packet.c:1922
#8  0x00007ffff7b67687 in ospf_read (thread=0x7fffffffe530)
    at ospf_packet.c:2649
#9  0x00007ffff78fa9ca in thread_call (thread=0x7fffffffe530) at thread.c:1177
#10 0x00000000004017e3 in main (argc=1, argv=0x7fffffffe738) at ospf_main.c:334
(gdb) list
257	struct route_node *
258	route_node_lookup (struct route_table *table, struct prefix *p)
259	{
260	  struct route_node *node;
261	
262	  node = table-&gt;top;
263	
264	  while (node &amp;&amp; node-&gt;p.prefixlen &lt;= p-&gt;prefixlen &amp;&amp; 
265		 prefix_match (&amp;node-&gt;p, p))
266	    {
(gdb) p table
$1 = (struct route_table *) 0x0
(gdb) up
#1  0x00007ffff7b7f138 in ospf_lsdb_lookup (lsdb=0x6aa400, lsa=0x6ab070)
    at ospf_lsdb.c:222
222	  rn = route_node_lookup (table, (struct prefix *) &amp;lp);
(gdb) list
211	
212	struct ospf_lsa *
213	ospf_lsdb_lookup (struct ospf_lsdb *lsdb, struct ospf_lsa *lsa)
214	{
215	  struct route_table *table;
216	  struct prefix_ls lp;
217	  struct route_node *rn;
218	  struct ospf_lsa *find;
219	
220	  table = lsdb-&gt;type[lsa-&gt;data-&gt;type].db;
221	  lsdb_prefix_set (&amp;lp, lsa);
222	  rn = route_node_lookup (table, (struct prefix *) &amp;lp);
223	  if (rn)
224	    {
225	      find = rn-&gt;info;
(gdb) p lsdb
$2 = (struct ospf_lsdb *) 0x6aa400
(gdb) p * lsdb
$3 = {type = {{count = 0, count_self = 0, checksum = 0, db = 0x0}, {count = 1, 
      count_self = 0, checksum = 44262, db = 0x6aa660}, {count = 1, 
      count_self = 0, checksum = 26450, db = 0x6aa680}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa6a0}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa6c0}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa6e0}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa700}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa720}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa740}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa760}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa780}, {count = 0, 
      count_self = 0, checksum = 0, db = 0x6aa7a0}}, total = 2, 
  new_lsa_hook = 0, del_lsa_hook = 0}
(gdb) p lsa-&gt;data-&gt;type
$4 = 0 '\000'
(gdb) p lsa
$6 = (struct ospf_lsa *) 0x6ab070
(gdb) p *lsa
$7 = {flags = 0 '\000', data = 0x6aaf40, tv_recv = {tv_sec = 2469, 
    tv_usec = 695521}, tv_orig = {tv_sec = 2469, tv_usec = 695521}, lock = 1, 
  stat = 0, retransmit_counter = 0, area = 0x6a79d0, lsdb = 0x0, route = 0x0, 
  refresh_list = -1, oi = 0x0}
(gdb) p lsa-&gt;data
$8 = (struct lsa_header *) 0x6aaf40
(gdb) p *lsa-&gt;data
$9 = {ls_age = 0, options = 0 '\000', type = 0 '\000', id = {s_addr = 0}, 
  adv_router = {s_addr = 0}, ls_seqnum = 0, checksum = 0, length = 0}
(gdb) 


I've produced a new evt image to reproduce the issue. The new binary to reproduce the issue is at
  <a href="http://users.isc.org/~mwinter/bugzilla-705/evt_ospfv2-lsa-2.bin">http://users.isc.org/~mwinter/bugzilla-705/evt_ospfv2-lsa-2.bin</a>

Testbed, Configs etc are the same as on the original report.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-10 00:52:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">This fits the prediction made earlier. The next portion of the complete fix will be provided in several days.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-17 06:31:11 UTC
        </span>

      </div>




<pre class="bz_comment_text">If someone reading this bug decides to reproduce the second test case, note, that DUT's router-id must be set to 172.17.200.214, which is different from the first test case setup.</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-17 06:48:43 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=390&amp;action=diff" name="attach_390" title="fix for 0.99.20, revision 2">attachment 390</a> <a href="attachment.cgi?id=390&amp;action=edit" title="fix for 0.99.20, revision 2">[details]</a></span>
fix for 0.99.20, revision 2

Commit c2397dc improves the coverage of input filtering procedure, it addresses the class of anomalies, to which the second test case belongs. Attached patch contains it along with the previous fixes, it is made against 0.99.20 release.

I have checked, that the provided binary isn't able to crash ospfd any more. There may be other issues in OSPF implementation, which may be found by means of further fuzzing, but to my knowledge they would belong to a different class of defects, which is less likely to cause a process crash.

Thank you.</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-17 20:15:21 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thanks for the fix.
I'm doing a full run against the protocol fuzzer again and will update this ticket within 24hrs on the results.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-19 17:29:28 UTC
        </span>

      </div>




<pre class="bz_comment_text">All my tests are done and I can confirm that this new patch (revision 2) fixes all the issues in my tests in 0.99.20 (and doesn't break anything new)
Thanks</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-19 18:18:44 UTC
        </span>

      </div>




<pre class="bz_comment_text">Fine. I will allow for a couple of weeks under live traffic before marking this story as finished. Thanks for your work!</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dmitrij Tejblum</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-20 11:33:51 UTC
        </span>

      </div>




<pre class="bz_comment_text">It looks like commit c2397dc (which is supposed to fix this) breaks reception of packets with LLS data (see RFC5613). (At least some of Cisco routers ( ;-) ) do send OSPF packets with LLS blocks, so this is important.)</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-20 13:19:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">Yes, exactly. Commit 8c0ac03 should fix that.</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-27 12:00:54 UTC
        </span>

      </div>




<pre class="bz_comment_text">Martin, are there any fuzzing scenarios available with focus on authentication, LLS or large packet sizes?</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-29 20:53:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=705#c20">comment #20</a>)

I can confirm that the patch (rev2) breaks OSPF MD5. I don't think I have a good fuzzer/tester for LLS, but will look into it.
The patch revision 1 does NOT break ospf.

When a OSPF neighbor with MD5 tries to come up, the neighbor gets stuck in exstart phase. Enabling &quot;debug ospf events&quot; and &quot;debug ospf packets all&quot; shows the following issue:
OSPF: ospf_lsaseq_examin: undersized (16 B) trailing (#0) LSA header
OSPF: ospf_packet_examin: malformed Database Description packet

See attached ospfd.log for a full log.

The issue can be reproduced by connecting 2 Quagga boxes together with a single interface and trying to bring up OSPF with MD5 authentication:

+---------------+                                   +---------------+
|   Quagga1     | eth1     172.17.201.0/24     eth1 |    Quagga2    |
| (0.99.20 with |-----------------------------------|    (regular   |
|   patch)      | 172.17.201.1         172.17.201.2 |     0.99.20)  |
+---------------+                                   +---------------+
 OSPF router-id:                                     OSPF router-id:
   172.17.0.1                                         172.17.0.2
 (and loopback)                                      (and loopback)
 
Quagga1 is the DUT and has the attached quagga1_ospfd.conf configuration.
Quagga2 is just use as a tester and in my case was used with stock 0.99.20 release and attached quagga2_ospfd.conf configuration</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-29 20:54:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=395" name="attach_395" title="ospfd.conf of Quagga1 (DUT) to show MD5 issues">attachment 395</a> <a href="attachment.cgi?id=395&amp;action=edit" title="ospfd.conf of Quagga1 (DUT) to show MD5 issues">[details]</a></span>
ospfd.conf of Quagga1 (DUT) to show MD5 issues</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-29 20:54:49 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=396" name="attach_396" title="ospfd.conf of Quagga2 (Tester) to show MD5 issues">attachment 396</a> <a href="attachment.cgi?id=396&amp;action=edit" title="ospfd.conf of Quagga2 (Tester) to show MD5 issues">[details]</a></span>
ospfd.conf of Quagga2 (Tester) to show MD5 issues</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-02-29 20:55:29 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=397" name="attach_397" title="ospfd.log with debug enabled showing the MD5 issue">attachment 397</a> <a href="attachment.cgi?id=397&amp;action=edit" title="ospfd.log with debug enabled showing the MD5 issue">[details]</a></span>
ospfd.log with debug enabled showing the MD5 issue</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-01 01:54:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=398&amp;action=diff" name="attach_398" title="fix for 0.99.20, revision 3">attachment 398</a> <a href="attachment.cgi?id=398&amp;action=edit" title="fix for 0.99.20, revision 3">[details]</a></span>
fix for 0.99.20, revision 3

Ouch. I meat to ask only, not to retest right now. The authentication issue is also fixed by commit 8c0ac03. I used a setup similar to the one in <a href="show_bug.cgi?id=705#c20">comment#20</a> to test all 6 combinations of authentication modes and confirmed all behaving up to the spec. LLS data is now ignored by ospfd regardless of its payload (as defined by the spec). Commit 8824a0b fixes a questionable bug in MD5 processing (a packet with missing some or all MD5 digest bytes could be accepted as authentic). One particular thing, which is currently hard for me to test is very large (~64KB) OSPF packet sizes. I assume, that ospfd won't crash, but may erroneously discard valid packets, when pushed to this limit (this would be a pure edge case, real implementations avoid exchanging so large packets).

I am attaching the 3rd revision of the patch, which accumulates all 10 commits from this round of work. It is OK to retest. This code behaves normal under live traffic conditions, but if you can fuzz a crash out of it, I will work on it.</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-01 02:08:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ok. Will give this 3rd revision a try tomorrow. My fuzzer usually takes about 24hrs to go through all testcases, so expect some results in approx 2 days.
I'm not sure I have a tool to test large OSPF packet size, but I'll check my resources.
(Side note about the commits: code.quagga.net seems to be unreachable since last saturday - can't access git)</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-06 08:06:14 UTC
        </span>

      </div>




<pre class="bz_comment_text">Anything interesting fuzzed out so far?</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-06 12:02:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">Sorry.. forgot to comment the results.
The protocol fuzzer passed thru all the OSPF tests (incl MD5 tests) with no errors found.</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-03-07 01:58:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">There are no visible regressions under my traffic conditions either. The whole class of vulnerabilities, to which both of the demonstrated crashes belong, now has a solution. Any structure sizing anomalies violating appendices A (OSPF data formats) or D (Authentication) of RFC2328 now cause the packet to be discarded. Respective commit IDs in git://github.com/Quagga-RE/quagga-RE.git are:

[RE-stable-0.99] [RE-testing-0.99] [summary]
4ddd8f7 95f09bb ospfd: use LOOKUP() for ospf_packet_type_str
97ac75a dad9b68 ospfd: fix ospf_packet_add_top() to use LOOKUP()
2f67455 e4e3f3e ospfd: introduce ospf_packet_minlen[] (BZ#705)
22ce6f6 72ba2f5 ospfd: review ospf_check_auth()
b3ebd09 0dc0752 ospfd: review ospf_check_md5_digest()
83face4 c2397dc ospfd: introduce ospf_lsa_minlen[] (BZ#705)
ad101ea 8c0ac03 ospfd: fix packet length check for auth/LLS cases
311b7bc 0586be6 ospfd: introduce ospf_auth_type_str[]
72b24a8 8824a0b ospfd: bring ospf_check_auth() into focus
f262d1f f66557b ospfd: reduce ospf_verify_header()

I consider my work in the scope of this case completed. Thank you for collaboration!</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Denis Ovsienko</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-03 11:55:49 UTC
        </span>

      </div>




<pre class="bz_comment_text">Martin has spotted an edge case, where the implemented size checks could discard a valid packet and break adjacency setup. Commit 2d3e4e3 fixes this problem.</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-05 15:58:56 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=417&amp;action=diff" name="attach_417" title="Patch (Commit 2d3e4e3 from Quagga-RE) to fix edge case for virtual links">attachment 417</a> <a href="attachment.cgi?id=417&amp;action=edit" title="Patch (Commit 2d3e4e3 from Quagga-RE) to fix edge case for virtual links">[details]</a></span>
Patch (Commit 2d3e4e3 from Quagga-RE) to fix edge case for virtual links

Added the patch from Quagga-RE to bugzilla for reference</pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Winter</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-04-05 15:59:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=705#c30">comment #30</a>)

Verified this fix with protocol compliance test (on top of 0.99.20.1) and it fixes the issue with small LSAs as they may happen with virtual links where lsa's with 0  link descriptor blocks may appear.
Verified the same code against the protocol fuzzer (including the previous issues) and no issues were found.

(Verified Quagga-RE at this commit level as well against the fuzzer with no issues found)</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=705#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Castro B</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-21 08:41:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Martin Winter from <a href="show_bug.cgi?id=705#c32">comment #32</a>)
Hello Team, I was wondering if what is the current status of this bug issue? Seems that there are no updates anymore or does it migrated to other bug sites? Thank you


Castro B.
<a href="https://alternatives.co/">https://alternatives.co/</a></pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=705">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=705">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=705">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=705&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=705" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=705&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635624132-xFCvKlVPxBeugp2S3CLNN8StxFOrNg-JiYpR-NG_nXk">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>