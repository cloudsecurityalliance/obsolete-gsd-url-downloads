<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1395508 - (CVE-2018-5117) Firefox address bar spoof using RTL language and references">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1395508">
<meta property="og:description"
      content="VERIFIED (mak) in Firefox - Address Bar. Last updated 2018-10-10.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1395508 - (CVE-2018-5117) Firefox address bar spoof using RTL language and references</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1395508&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1395508">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1395508">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/yui.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/global.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/util.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox57\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr52\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox56\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"],\"flags\":{\"project\":{\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox_esr52\":\"fixed\",\"cf_status_firefox56\":\"wontfix\",\"cf_tracking_firefox_esr52\":\"58+\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox57\":\"+\",\"cf_status_firefox58\":\"verified\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_status_firefox59\":\"verified\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox55\":\"wontfix\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox57\":\"wontfix\",\"cf_tracking_firefox56\":\"-\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1395508;
  BUGZILLA.bug_title = '1395508 - (CVE-2018-5117) Firefox address bar spoof using RTL language and references';
  BUGZILLA.bug_summary = 'Firefox address bar spoof using RTL language and references';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1395508';
  BUGZILLA.bug_keywords = 'csectype-spoof, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/field.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/comments.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1395508">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1395508"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1395508 - (CVE-2018-5117) Firefox address bar spoof using RTL language and references">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="VnXVYpahZhD8QLfflFo7BTABM8KBc8WQGGbYPA8C6jdavrfTZXfnIxT2ohARBayUILPdXdz906JagEAVd5sSKdbGQZ0X6KkJho4edMMHenmwoarfp73IosHCbKLZMvzfQubf3ncyMmMLbAftT0AyQEpV8VMG1r8oYlMpDXtpuKqGi5l4pTn9w7XSXoF7kmH1G8pwM5Orj5o9pk85AnL2t6kRwNfOu5ghiy03zRyLleWFOo7ds1FjOBA5b4KcRlXG">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1395508" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623219-aQD2_QosuLQOpxWjSx7delgbBt0rXBQI7RLOjZRKyPk">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1395508" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1395508" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1395508">Bug 1395508</a>
          <span class="edit-hide">(CVE-2018-5117)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2017-08-31 03:07 PDT" data-time="1504174076">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2017-11-21 15:48 PST" data-time="1511308135">4 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Firefox address bar spoof using RTL language and references</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Firefox address bar spoof using RTL language and references

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Firefox :: Address Bar, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Firefox
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Firefox</div>
            <div class="description">For bugs in  Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Core">Core</a> product. Bugs for developer tools (F12) should be filed in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools">DevTools</a> product.  (<a href="https://wiki.mozilla.org/Modules/All#Firefox">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox&component=Address%20Bar#Address%20Bar" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Address Bar
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Firefox :: Address Bar</div>
            <div class="description">For bugs in the Firefox "Smart Location Bar" (aka Awesome Bar) UI element, including the bookmark and history autocomplete matching behavior.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Address%20Bar&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Address%20Bar&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox&amp;component=Address%20Bar"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox" data-component="Address Bar"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            55 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;}],&quot;target_milestone&quot;:&quot;Firefox 59&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_firefox_esr52&quot;:&quot;fixed&quot;,&quot;cf_tracking_firefox_esr52&quot;:&quot;58+&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;P1&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_status_firefox58&quot;:&quot;verified&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox59&quot;:&quot;verified&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_firefox56&quot;:&quot;-&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox57&quot;:&quot;wontfix&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox56&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;id&quot;:1395508,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_tracking_firefox57&quot;:&quot;+&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-spoof&quot;,&quot;sec-moderate&quot;],&quot;cf_status_firefox55&quot;:&quot;wontfix&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            Firefox 59

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=58%2B">58+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox55</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox56</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox56&amp;o1=equals&amp;v1=-">-</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox57</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox57&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox58</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox59</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr52-dirty">
  <select id="cf_tracking_firefox_esr52" name="cf_tracking_firefox_esr52">
        <option value="58+"
          id="v3541_cf_tracking_firefox_esr52" selected
        >58+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="fixed"
          id="v3137_cf_status_firefox_esr52" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox55</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox55-dirty">
  <select id="cf_status_firefox55" name="cf_status_firefox55">
        <option value="wontfix"
          id="v3184_cf_status_firefox55" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox56</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox56-dirty">
  <select id="cf_tracking_firefox56" name="cf_tracking_firefox56">
        <option value="-"
          id="v3274_cf_tracking_firefox56" selected
        >-
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox56-dirty">
  <select id="cf_status_firefox56" name="cf_status_firefox56">
        <option value="wontfix"
          id="v3282_cf_status_firefox56" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox57</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox57-dirty">
  <select id="cf_tracking_firefox57" name="cf_tracking_firefox57">
        <option value="+"
          id="v3288_cf_tracking_firefox57" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox57-dirty">
  <select id="cf_status_firefox57" name="cf_status_firefox57">
        <option value="wontfix"
          id="v3297_cf_status_firefox57" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox58</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox58-dirty">
  <select id="cf_status_firefox58" name="cf_status_firefox58">
        <option value="verified"
          id="v3448_cf_status_firefox58" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox59</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox59-dirty">
  <select id="cf_status_firefox59" name="cf_status_firefox59">
        <option value="verified"
          id="v3512_cf_status_firefox59" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: xisigr, Assigned: mak)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_240353" ><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=240353" > <span class="fna">mak</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_345314" ><img src="https://secure.gravatar.com/avatar/bb265988a0c3bdd22829a1b390a8364f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=345314" > <span class="fna">xisigr</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_334927" ><img src="https://secure.gravatar.com/avatar/fa60148022a230fe1bacc441549b1c66?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=334927" > <span class="fna">adw</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="23">23 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1419391">1419391</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1395508&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1395508">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE"
   href="/show_bug.cgi?id=1403812">1403812</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-spoof, sec-moderate, Whiteboard: [fxsearch][adv-main58+][adv-esr52.6+][post-critsmash-triage])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-5117

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[fxsearch][adv-main58+][adv-esr52.6+][post-critsmash-triage]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a16701007_1689"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1520506190"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1726767">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1726767-dirty">
      <select id="flag-1726767" name="flag-1726767"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug must be fixed for Firefox Sync 1.7" for="flag_type-708">blocking-fx-sync1.7</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-708-dirty">
      <select id="flag_type-708" name="flag_type-708"
        title="This bug must be fixed for Firefox Sync 1.7"
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (5 files, 12 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8903091"
              title="spoof.png"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">spoof.png
            </a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2017-08-31 03:07 PDT" data-time="1504174076">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_345314" ><a class="email " href="/user_profile?user_id=345314" > <span class="fna">xisigr</span></a>
</div></span>
        </div>
        <div class="attach-info">1.46 MB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8903091&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8903092">poc.html</a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2017-08-31 03:09 PDT" data-time="1504174149">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_345314" ><a class="email " href="/user_profile?user_id=345314" > <span class="fna">xisigr</span></a>
</div></span>
        </div>
        <div class="attach-info">427 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8903092&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8905279"
              title="Chrome screenshot"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Chrome screenshot
            </a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2017-09-06 15:21 PDT" data-time="1504736469">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_334927" ><a class="email " href="/user_profile?user_id=334927" > <span class="fna">Drew Willcoxon :adw</span></a>
</div></span>
        </div>
        <div class="attach-info">74.95 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8905279&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8917347">don't decode whitespaces</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2017-10-11 06:43 PDT" data-time="1507729410">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.57 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8917347&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8917347&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8917347">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8919079">patch v2</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2017-10-16 15:45 PDT" data-time="1508193943">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">14.04 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8919079&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8919079&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8919079">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8919293"
              title="screenshot (a), after pasting the long URL and pressing Enter to go to the site"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">screenshot (a), after pasting the long URL and pressing Enter to go to the site
            </a>
        </div>
        <div>
            <a href="#c41" class="attach-time activity-ref"><span class="rel-time" title="2017-10-17 06:43 PDT" data-time="1508247835">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_329583" ><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div></span>
        </div>
        <div class="attach-info">645.91 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8919293&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8919294"
              title="screenshot (b), after switching to a different tab and then back to the testcase tab"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">screenshot (b), after switching to a different tab and then back to the testcase tab
            </a>
        </div>
        <div>
            <a href="#c42" class="attach-time activity-ref"><span class="rel-time" title="2017-10-17 06:44 PDT" data-time="1508247874">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_329583" ><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div></span>
        </div>
        <div class="attach-info">646.54 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8919294&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8919810">patch v2.1</a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2017-10-18 08:36 PDT" data-time="1508341017">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.26 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8919810&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8919810&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8919810">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8920064">patch v2.2</a>
        </div>
        <div>
            <a href="#c49" class="attach-time activity-ref"><span class="rel-time" title="2017-10-19 02:29 PDT" data-time="1508405348">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.91 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8920064&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8920064&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8920064">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8920250">patch 2.3</a>
        </div>
        <div>
            <a href="#c52" class="attach-time activity-ref"><span class="rel-time" title="2017-10-19 09:01 PDT" data-time="1508428906">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">20.45 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8920250&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8920250&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8920250">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8921148">patch 2.4</a>
        </div>
        <div>
            <a href="#c56" class="attach-time activity-ref"><span class="rel-time" title="2017-10-23 10:43 PDT" data-time="1508780632">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">20.53 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8921148&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8921148&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8921148">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8921447">patch v2.5</a>
        </div>
        <div>
            <a href="#c58" class="attach-time activity-ref"><span class="rel-time" title="2017-10-24 06:28 PDT" data-time="1508851712">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">20.64 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8921447&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8921447&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8921447">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8926403">part 1 - Don't decode adjacent spaces</a>
        </div>
        <div>
            <a href="#c65" class="attach-time activity-ref"><span class="rel-time" title="2017-11-08 07:03 PST" data-time="1510153390">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.99 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_219124" ><span class="fn">dao</span>
</div>:
              <a href="#c66"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1510153390"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c72"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1510153390"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8926403&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8926403&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8926403">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8926654">Part 2 - Always show domain and scheme (ftp, https)</a>
        </div>
        <div>
            <a href="#c69" class="attach-time activity-ref"><span class="rel-time" title="2017-11-08 17:00 PST" data-time="1510189225">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">19.80 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8926654&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8926654&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8926654">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8927028">Part 2 - Always show domain and scheme (ftp, https)part2.diff</a>
        </div>
        <div>
            <a href="#c70" class="attach-time activity-ref"><span class="rel-time" title="2017-11-09 13:55 PST" data-time="1510264523">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">21.55 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8927028&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8927028&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8927028">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8930465">re-encode consecutive spaces</a>
        </div>
        <div>
            <a href="#c79" class="attach-time activity-ref"><span class="rel-time" title="2017-11-21 05:30 PST" data-time="1511271011">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.35 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_506302" ><span class="fn">gchang</span>
</div>:
              <a href="#c87"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1511335694"
            >
              approval-mozilla-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_506302" ><span class="fn">gchang</span>
</div>:
              <a href="#c87"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1511336521"
            >
              approval-mozilla-esr52+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8930465&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8930465&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8930465">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8939853">esr52 patch</a>
        </div>
        <div>
            <a href="#c90" class="attach-time activity-ref"><span class="rel-time" title="2018-01-04 07:01 PST" data-time="1515078086">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_240353" ><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.29 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8939853&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8939853&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8939853">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="IOrV3PfbYESoJW9a8VQ1tqW4jTsuc7TfZlzCJGn4h4HfIUS1">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12616485" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345314" ><img src="https://secure.gravatar.com/avatar/bb265988a0c3bdd22829a1b390a8364f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345314" ><a class="email " href="/user_profile?user_id=345314" > <span class="fna">xisigr</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-31 03:07 PDT" data-time="1504174076">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8903091"
         class="attachment"
         data-id="8903091" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="spoof.png">
      <meta itemprop="contentSize" content="1531685">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8903091" itemprop="contentUrl">
        <span id="att-8903091-description" itemprop="description">spoof.png</span></a>
        — <a href="attachment.cgi?id=8903091&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="12616485">Firefox address bar spoof using hebrew on Windows/macOS.

poc.html

&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;
&lt;script&gt;
    
    function aa(){
        var link = document.createElement('a');
        link.href = &quot;<a rel="nofollow" href="https://xn--ggbla1c4e.xn--ngbc5azd/">https://xn--ggbla1c4e.xn--ngbc5azd/</a>#&quot;+Array(0x200).join(&quot;%20&quot;)+&quot;סוֹ.סח&quot;;
        link.target=&quot;aaaa&quot;;
        document.body.appendChild(link);
        link.click();
    }
    
&lt;/script&gt;
    
&lt;a onclick=&quot;aa();&quot; href=&quot;javascript:void(0);&quot;&gt;CLICK ME&lt;/a&gt;
    
Expected Result:
<a rel="nofollow" href="https://اسماء.شبكة">https://اسماء.شبكة</a>

Rendered Results:
<a rel="nofollow" href="https://no.io">https://no.io</a></pre></div><div class="change-set" id="c1"><div class="comment" data-id="12616486" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_345314" ><img src="https://secure.gravatar.com/avatar/bb265988a0c3bdd22829a1b390a8364f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_345314" ><a class="email " href="/user_profile?user_id=345314" > <span class="fna">xisigr</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-31 03:09 PDT" data-time="1504174149">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8903092"
         class="attachment"
         data-id="8903092" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="poc.html">
      <meta itemprop="contentSize" content="427">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8903092" itemprop="contentUrl">
        <span id="att-8903092-description" itemprop="description">poc.html</span></a>
        — <a href="attachment.cgi?id=8903092&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a25856_1689"><div class="change" id="aa25856_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a25856_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a25856_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a25856_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a25856_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-31 10:18 PDT" data-time="1504199932">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          
            <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div><div class="change">Summary: Firefox address bar spoof using hebrew &rarr; Firefox address bar spoof using LTR language and references</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="12620257" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_9911" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_9911" id="a25856_1689"><a class="email disabled" href="/user_profile?user_id=9911" > <span class="fna">Gervase Markham [:gerv] (not reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-01 04:36 PDT" data-time="1504265783">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="12620257">Works on Linux too.

Dan: did you mean &quot;RTL language&quot; in the new title?

So the trick here is that the Arabic domain is RTL, so it appears on the right of the address bar, but then it gets pushed off by all the spaces and Hebrew text, because we are still left-justifying the contents? IOW, the fix is to make sure that the justification rules on the address bar are such that the actual domain is always visible?

Gerv</pre></div><div class="change-set" id="c3"><div class="comment" data-id="12621919" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a25856_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-01 13:51 PDT" data-time="1504299102">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12621919">Works on Windows too. Clever.</pre><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=isnotempty">status-firefox56</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=isnotempty">status-firefox57</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox56&amp;o1=isnotempty">tracking-firefox56</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox56&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox57&amp;o1=isnotempty">tracking-firefox57</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox57&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Ever confirmed: true</div><div class="change">OS: Unspecified &rarr; All</div><div class="change">Hardware: Unspecified &rarr; All</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="12631114" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a25856_1689"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-05 14:34 PDT" data-time="1504647242">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12631114">Since this issue has a sec-moderate rating right now I don't want to track it for 56. We're getting close to the 56 release. Happy to take a patch for 56 if we land one. 

mak, can you help find someone to work on this? 
Do you think it is urgent to fix for 56/57?</pre><div class="activity"><div class="change">Flags: needinfo?(mak77)</div></div></div><div class="change-set" id="c5"><div class="comment" data-id="12633350" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a25856_1689"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 06:40 PDT" data-time="1504705247">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12633350">Forwarding to Panos to evaluate the available resources.
It would be nice to fix it for sure, I don't know if it's as urgent to be in 56, the spoofed font is somehow recognizable and the identity panel points to the right domain. I can see it as a concern for a less expert user.

Surely the best thing would be to always scroll the locationbar to show the domain.</pre><div class="activity"><div class="change">Flags: needinfo?(mak77) &rarr; needinfo?(past)</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="12633357" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a25856_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 06:42 PDT" data-time="1504705335">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="12633357">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c5">comment #5</a>)
<span class="quote">&gt; Forwarding to Panos to evaluate the available resources.
&gt; It would be nice to fix it for sure, I don't know if it's as urgent to be in
&gt; 56, the spoofed font is somehow recognizable and the identity panel points
&gt; to the right domain. I can see it as a concern for a less expert user.
&gt; 
&gt; Surely the best thing would be to always scroll the locationbar to show the
&gt; domain.</span >

We already do that (force selectionStart + End to 0). It's not clear to me off-hand what part of it isn't working somehow.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="12633421" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a25856_1689"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a25856_1689"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 06:59 PDT" data-time="1504706355">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12633421">(In reply to :Gijs (queue backed up, slow) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c6">comment #6</a>)
<span class="quote">&gt; We already do that (force selectionStart + End to 0). It's not clear to me
&gt; off-hand what part of it isn't working somehow.</span >

The url is LTR aligned (https is on the left), but the RTL chars are RTL aligned. And looks like there can be mixed direction domains. The input field is LTR in an LTR build.
There's some background in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INACTIVE - URL Bar text alignment in RTL mode"
   href="/show_bug.cgi?id=993806">bug 993806</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INACTIVE - The location bar alignment should be LTR, even though the Firefox build is RTL (e.g. Hebrew, Arabic..) — Regression from Firefox 3.6"
   href="/show_bug.cgi?id=641238">bug 641238</a> for the braves.

Fwiw, Chrome puts the scheme in a static element, and scrolls all the rest of the string to the right. It may not be necessary to keep showing the scheme considered the identity panel? (they also don't decode the %20)</pre></div><div class="change-set" id="a534772_363318"><div class="change" id="aa534772_363318">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363318" id="a534772_363318"><img src="https://secure.gravatar.com/avatar/5910c2c56be9598a07535cc361b65a22?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363318" id="a534772_363318"><a class="email " href="/user_profile?user_id=363318" > <span class="fna">Panos Astithas (he/him) [:past] (please ni?)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a534772_363318"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a534772_363318">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a534772_363318">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 07:40 PDT" data-time="1504708848">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(past)</span></div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="a534957_363318"><div class="change" id="aa534957_363318">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363318" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/5910c2c56be9598a07535cc361b65a22?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363318" id="a534957_363318"><a class="email " href="/user_profile?user_id=363318" > <span class="fna">Panos Astithas (he/him) [:past] (please ni?)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a534957_363318"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a534957_363318">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a534957_363318">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 07:43 PDT" data-time="1504709033">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [fxsearch]</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="12634320" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334927" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/fa60148022a230fe1bacc441549b1c66?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334927" id="a534957_363318"><a class="email " href="/user_profile?user_id=334927" > <span class="fna">Drew Willcoxon :adw</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 10:32 PDT" data-time="1504719162">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12634320">Panos asked me to look at this, but with the understanding that it can wait until Sept. 15, the Photon soft code freeze.  So I'll assign myself now, but if anyone else wants to take it before then, please feel free.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; adw</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="12634516" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a534957_363318"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 11:13 PDT" data-time="1504721600">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="12634516">(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c6">comment #6</a>)
<span class="quote">&gt; (In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c5">comment #5</a>)</span >

<span class="quote">&gt; &gt; Surely the best thing would be to always scroll the locationbar to show the
&gt; &gt; domain.
&gt; 
&gt; We already do that (force selectionStart + End to 0). It's not clear to me
&gt; off-hand what part of it isn't working somehow.</span >

The trouble is, the domain is nowhere near the start (offset 0) of the urlbar content. Setting selectionStart/End to 0 ensures that the left-hand edge of the &quot;https://...&quot; scheme is visible; but then the domain is at the far right of the urlbar content, out of sight.

If I arbitrarily hack browser.js so that it sets selectionStart/End to 8 instead of 0 (i.e. placing the selection immediately after &quot;https://&quot;), then the testcase here behaves better, with the (Arabic-script) domain visible -- although not perfectly, because of the fade-out effect is still applied at the right-hand end, so the beginning of the domain name fades away. And of course now the scheme is no longer visible. So even if we did this (more correctly, by checking the actual offset of the domain rather than hard-coding &quot;8&quot;), it wouldn't be very satisfactory.

If we could avoid decoding the %20 characters, that would help quite a lot, although it could make some legitimate URLs look more ugly. (Note that the %20s in question are part of the fragment identifier here, not part of an actual domain label.) Offhand I'm not sure where to hack that, though.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="12634655" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a534957_363318"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 11:47 PDT" data-time="1504723666">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="12634655">(In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c9">comment #9</a>)
<span class="quote">&gt; And of
&gt; course now the scheme is no longer visible.</span >

That's why I'm wondering if, with the identity icon always visible, we still care about the scheme.
If we care, Chrome solution (sticky scheme) sounds feasible.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="12634998" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a534957_363318"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 13:12 PDT" data-time="1504728733">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="12634998">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c10">comment #10</a>)
<span class="quote">&gt; (In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c9">comment #9</a>)
&gt; &gt; And of
&gt; &gt; course now the scheme is no longer visible.
&gt; 
&gt; That's why I'm wondering if, with the identity icon always visible, we still
&gt; care about the scheme.
&gt; If we care, Chrome solution (sticky scheme) sounds feasible.</span >

There's also the issue that the fade-out truncation we apply at the (right-hand) end of the urlbar results in fading the beginning of the domain name.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="12635437" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334927" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/fa60148022a230fe1bacc441549b1c66?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334927" id="a534957_363318"><a class="email " href="/user_profile?user_id=334927" > <span class="fna">Drew Willcoxon :adw</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 15:18 PDT" data-time="1504736318">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="12635437">We could drop the fade out at the end and instead truncate in the middle with an ellipsis (…) so that the beginning and end of the URL are always visible.  Is that what you mean by a sticky scheme, Marco?

I agree with Jonathan that not decoding the spaces would help a lot.  I'd go further and say that by itself is an acceptable fix for this case.  But I think I like the truncation idea, too.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="12635443" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_334927" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/fa60148022a230fe1bacc441549b1c66?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_334927" id="a534957_363318"><a class="email " href="/user_profile?user_id=334927" > <span class="fna">Drew Willcoxon :adw</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-06 15:21 PDT" data-time="1504736469">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8905279"
         class="attachment obsolete"
         data-id="8905279" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Screen Shot 2017-09-06 at 3.19.24 PM.png">
      <meta itemprop="contentSize" content="76744">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8905279" itemprop="contentUrl">
        <span id="att-8905279-description" itemprop="description">Chrome screenshot</span></a> (obsolete)
        — <a href="attachment.cgi?id=8905279&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-13" data-comment-id="12635443">(In reply to Drew Willcoxon :adw from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c12">comment #12</a>)
<span class="quote">&gt; Is that what you mean by a sticky scheme, Marco?</span >

I guess so.  Here's a Chrome screenshot.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="12636824" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a534957_363318"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-07 02:28 PDT" data-time="1504776535">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12636824">(In reply to Drew Willcoxon :adw from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c13">comment #13</a>)
<span class="quote">&gt; Created <span class="bz_obsolete"><a href="/attachment.cgi?id=8905279" name="attach_8905279" title="Chrome screenshot">attachment 8905279</a> <a href="/attachment.cgi?id=8905279&amp;action=edit" title="Chrome screenshot">[details]</a></span>
&gt; Chrome screenshot
&gt; 
&gt; (In reply to Drew Willcoxon :adw from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c12">comment #12</a>)
&gt; &gt; Is that what you mean by a sticky scheme, Marco?
&gt; 
&gt; I guess so.  Here's a Chrome screenshot.</span >

yes, even if I'd not define that &quot;in the middle&quot;, it looks like they put ellipsis just after the scheme (so the scheme is &quot;sticky&quot; positioned and the rest of the url is just scrolled to the far right).
Putting ellipsis in the middle, with that many spaces could still be confusing, especially on 16:9 and ultrawide (21:9) screens, the real domain would still be at the far right, while the fake one would still appear just after the scheme.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="12637251" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a534957_363318"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a534957_363318"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-07 04:48 PDT" data-time="1504784888">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="12637251">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c14">comment #14</a>)
<span class="quote">&gt; (In reply to Drew Willcoxon :adw from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c13">comment #13</a>)
&gt; &gt; Created <span class="bz_obsolete"><a href="/attachment.cgi?id=8905279" name="attach_8905279" title="Chrome screenshot">attachment 8905279</a> <a href="/attachment.cgi?id=8905279&amp;action=edit" title="Chrome screenshot">[details]</a></span>
&gt; &gt; Chrome screenshot
&gt; &gt; 
&gt; &gt; (In reply to Drew Willcoxon :adw from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c12">comment #12</a>)
&gt; &gt; &gt; Is that what you mean by a sticky scheme, Marco?
&gt; &gt; 
&gt; &gt; I guess so.  Here's a Chrome screenshot.
&gt; 
&gt; yes, even if I'd not define that &quot;in the middle&quot;, it looks like they put
&gt; ellipsis just after the scheme (so the scheme is &quot;sticky&quot; positioned and the
&gt; rest of the url is just scrolled to the far right).</span >

My interpretation of Chrome's behavior is that the ellipsis is at the (logical) end of the text, which means it appears at the left-hand end of the (right-to-left) text.

Something like this could possibly be achieved by wrapping the URL (not including the scheme) in an inline-block element with dir=auto and styling it with text-overflow:ellipsis, overflow:hidden, and width:.... umm, not sure what. I don't think -moz-available works here, so it might have to be computed somehow.

(Applying text-overflow:ellipsis to the URL as a whole (including scheme) cannot give this result, AFAICT from the spec for text-overflow.)

I suspect forcing the spaces to be displayed as %20 is much easier to implement as a short-term fix, however. Reworking the elements within the urlbar to separate the scheme from the rest of the URL (and allow us to align/truncate them separately) sounds....risky and disruptive.</pre></div><div class="change-set" id="a721929_451704"><div class="change" id="aa721929_451704">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a721929_451704"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_451704" id="a721929_451704"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a721929_451704"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a721929_451704">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a721929_451704">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-09-08 11:40 PDT" data-time="1504896005">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=isnotempty">status-firefox56</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=equals&amp;v1=fix-optional">fix-optional</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox56&amp;o1=isnotempty">tracking-firefox56</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox56&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox56&amp;o1=equals&amp;v1=-">-</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox57&amp;o1=isnotempty">tracking-firefox57</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox57&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox57&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="a2818937_554394"><div class="change" id="aa2818937_554394">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_554394" id="a2818937_554394"><img src="https://secure.gravatar.com/avatar/0f294188ac85f7aabf296c44b524de1e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_554394" id="a2818937_554394"><a class="email " href="/user_profile?user_id=554394" > <span class="fna">Emma Humphries ☕️🎸🧞‍♀️✨ (she/they) [:emceeaich] (Pacific Time) use needinfo</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2818937_554394"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2818937_554394">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a2818937_554394">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-02 18:10 PDT" data-time="1506993013">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=stale-bug&amp;resolution=---">stale-bug</a></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="12745653" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a2818937_554394"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a2818937_554394"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-10 10:57 PDT" data-time="1507658260">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12745653">mak, anyone else who might work on this? 
We can still take a patch for 57, but I am dropping tracking on this bug since we are in mid-beta at this point.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=isnotempty">status-firefox57</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=fix-optional">fix-optional</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Flags: needinfo?(mak77)</div></div></div><div class="change-set" id="a3501328_240353"><div class="change" id="aa3501328_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3501328_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3501328_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a3501328_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-10 15:43 PDT" data-time="1507675404">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(mak77) &rarr; needinfo?(past)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="12746722" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-10 15:58 PDT" data-time="1507676334">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12746722">So, I think that in any case we should show the %20, the spaces are just too confusing.
The 2 proposed solutions:
1. ellipsis in the middle:
   - simpler and potentially upliftable
   - on overflow it may still look confusing
     scheme://fake.domain%20%20%20%20%20%20%20%20%20%20...%20%20%20%20%20%20%20%20%20%20%20%20real.domain
2. separate the scheme from the url, ellipsis at the end of the url
   - more complex to do
   - on overflow it's less confusing
     scheme://...e.domain%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20real.domain

if there's no overflow, the 2 solutions look the same, and the confusion may be solved by the domain hilight. Regardless the hilight helps if we always show the domain, so probably solution 1 has better cost/benefit balance.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="12747806" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a3501328_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 02:58 PDT" data-time="1507715888">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="12747806">Just ensuring the spaces are displayed as %20 goes a long way towards mitigating this, IMO. I think we should do that immediately (and uplift it to 57), and then look into further improvements (either (1) or (2) above) as a followup for 58 or later.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="12747954" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 03:34 PDT" data-time="1507718069">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="12747954">Another interesting POC is using %e30%80%80 instead of %20. Pretty much any recognized whitespace.
To avoid decoding these, it may be enough to fix losslessDecodeURI that currently skips whitespaces on purpose, probably for beautification reasons.
I can try to patch it and see if any tests are failing. It will also need a test for these 2 cases, at least.</pre><div class="activity"><div class="change">Assignee: adw &rarr; mak77</div><div class="change">Flags: <span class="activity-deleted">needinfo?(past)</span></div></div></div><div class="change-set" id="c20"><div class="comment" data-id="12747956" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 03:35 PDT" data-time="1507718113">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12747956">I actually meant %E3%80%80, not sure how a zero slipped into that :\</pre></div><div class="change-set" id="c21"><div class="comment" data-id="12748213" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 05:53 PDT" data-time="1507726391">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12748213">And here comes back <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Support cropping in the middle for text-overflow"
   href="/show_bug.cgi?id=740910">Bug 740910</a> that makes cropping in the middle a nightmare. It may be easier to actually split the scheme considered that bug is open from 6 years and the proposals got few interest in W3C.

At this point I agree with <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c18">comment 18</a>, let's just show the encoded whitespaces and I'll file a separate public bug about cropping the urls better.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="12748346" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 06:43 PDT" data-time="1507729410">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8917347"
         class="attachment patch obsolete"
         data-id="8917347" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="2635">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8917347">
          <a class="link" href="attachment.cgi?id=8917347&amp;action=diff">
        <span id="att-8917347-description" itemprop="description">don't decode whitespaces</span></a> (obsolete)
        — <a href="attachment.cgi?id=8917347&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8917347">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-22" data-comment-id="12748346">This just avoids decoding whitespaces, so they will stay % encoded.
Cropping is a more complex problem we'd better handle separately, I suggest a normal public bug in the Address Bar for that.
Does this sound sufficiently good to you?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8917347&amp;action=edit"
           title="don't decode whitespaces"
           class=""
        >Attachment #8917347</a> -
        Flags: review?(jfkthame)</div><div class="change">
        <a href="/attachment.cgi?id=8917347&amp;action=edit"
           title="don't decode whitespaces"
           class=""
        >Attachment #8917347</a> -
        Flags: feedback?(dveditz)</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="12748366" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_9911" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_9911" id="a3501328_240353"><a class="email disabled" href="/user_profile?user_id=9911" > <span class="fna">Gervase Markham [:gerv] (not reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 06:47 PDT" data-time="1507729638">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12748366">Decoding whitespaces is a nice UX win. Can we refuse to decode them only when there's more than N of them, or a run of more than N of them, or something?

Gerv</pre></div><div class="change-set" id="c24"><div class="comment" data-id="12748418" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:06 PDT" data-time="1507730773">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12748418">(In reply to Gervase Markham [:gerv] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c23">comment #23</a>)
<span class="quote">&gt; Decoding whitespaces is a nice UX win.</span >

We will keep decoding them for javascript or exotic urls, the change only affects http, https, file and ftp schemes. For these I'm not sure there's any UX win.
While your suggestion is technically feasible, it would make the behavior more unpredictable and maybe even surprising, imo.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="12748430" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_9911" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_9911" id="a3501328_240353"><a class="email disabled" href="/user_profile?user_id=9911" > <span class="fna">Gervase Markham [:gerv] (not reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:09 PDT" data-time="1507730952">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="12748430">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c24">comment #24</a>)
<span class="quote">&gt; We will keep decoding them for javascript or exotic urls, the change only
&gt; affects http, https, file and ftp schemes. For these I'm not sure there's
&gt; any UX win.</span >

Really? I'd say that:

<a rel="nofollow" href="https://wiki.mozilla.org/CA/CA">https://wiki.mozilla.org/CA/CA</a> Information Checklist

in the URL bar looks rather a lot nicer than:

<a rel="nofollow" href="https://wiki.mozilla.org/CA/CA%20Information%20Checklist">https://wiki.mozilla.org/CA/CA%20Information%20Checklist</a>

Gerv</pre></div><div class="change-set" id="c26"><div class="comment" data-id="12748473" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:20 PDT" data-time="1507731637">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="12748473">Fwiw, all the wikis I tried rewrite %20 to underscores, makes more sense imo, web devs should use underscores if they care about readability of their urls. Your example in reality would be <a rel="nofollow" href="https://wiki.mozilla.org/CA/CA_Information_Checklist">https://wiki.mozilla.org/CA/CA_Information_Checklist</a>
To look into the other browsers, and understand if we're breaking users expectations: Chrome doesn't decode %20, as well as Edge. I don't have Safari at hand atm.

How would you measure the right N? The window and, as a consequence, the Address Bar, can be small. To hide the smaller host possible you may not need a lot of spaces, indeed even if invalid per RFC, some dns may support single letter hostnames.
If we only care to mitigate the problem, we could maybe allow single isolated spaces.
Let's see what the others think.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="12748491" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a3501328_240353"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:24 PDT" data-time="1507731862">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="12748491">FWIW, I too think it would be preferable to find a way to keep decoding spaces in the &quot;non-spoofy&quot; cases for UX reasons, even if that makes the behaviour less predictable, because it'll keep the 'nice' behaviour for the common case while defeating spoofing attempts (if done right :-) ).</pre></div><div class="change-set" id="c28"><div class="comment" data-id="12748517" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:31 PDT" data-time="1507732313">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="12748517">The only &quot;right&quot; way I can think of currently is to decode only isolated whitespaces.</pre></div><div class="change-set" id="c29"><div class="comment" data-id="12748522" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:33 PDT" data-time="1507732411">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="12748522">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c28">comment #28</a>)
<span class="quote">&gt; The only &quot;right&quot; way I can think of currently is to decode only isolated
&gt; whitespaces.</span >

Even if, something like &quot;<a rel="nofollow" href="http://fake.domain">http://fake.domain</a> . . . . . . . . . . . . . . . . . . . . . . . . . real.domain&quot; (or some unicode glyph even more subtle than a dot) could still be quite confusing.</pre></div><div class="change-set" id="c30"><div class="comment" data-id="12748610" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_9911" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_9911" id="a3501328_240353"><a class="email disabled" href="/user_profile?user_id=9911" > <span class="fna">Gervase Markham [:gerv] (not reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 07:52 PDT" data-time="1507733548">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="12748610">The correct fix here is making sure that the real domain is always visible. Combine that with domain highlighting, and we are fine even if spaces are not decoded at all. Let's focus on that. If we want to stopgap by refusing to decode long runs of spaces, let's do it. But we are already at the edge case of edge cases. Phishers don't bother with this stuff for good reasons. It works fine without.

Gerv</pre></div><div class="change-set" id="c31"><div class="comment" data-id="12748656" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3501328_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 08:01 PDT" data-time="1507734116">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="12748656">(In reply to Gervase Markham [:gerv] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c30">comment #30</a>)
<span class="quote">&gt; The correct fix here is making sure that the real domain is always visible.</span >

If we want the fix in 57 the only way would be to hide the scheme, and I'm not sure we're comfortable with that.
If we can wait, then surely we could look into the static scheme solution (that off-hand looks easier than waiting for <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Support cropping in the middle for text-overflow"
   href="/show_bug.cgi?id=740910">Bug 740910</a>).</pre></div><div class="change-set" id="c32"><div class="comment" data-id="12748664" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_9911" id="a3501328_240353"><img src="https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_9911" id="a3501328_240353"><a class="email disabled" href="/user_profile?user_id=9911" > <span class="fna">Gervase Markham [:gerv] (not reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 08:02 PDT" data-time="1507734169">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="12748664">I think we can wait.

Gerv</pre></div><div class="change-set" id="a3560395_240353"><div class="change" id="aa3560395_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3560395_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a3560395_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3560395_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3560395_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a3560395_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 08:07 PDT" data-time="1507734471">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8917347&amp;action=edit"
           title="don't decode whitespaces"
           class=""
        >Attachment #8917347</a> -
        Flags: <span class="activity-deleted">review?(jfkthame)</span></div><div class="change">
        <a href="/attachment.cgi?id=8917347&amp;action=edit"
           title="don't decode whitespaces"
           class=""
        >Attachment #8917347</a> -
        Flags: <span class="activity-deleted">feedback?(dveditz)</span></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="12748697" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a3560395_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a3560395_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 08:10 PDT" data-time="1507734623">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="12748697">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c28">comment #28</a>)
<span class="quote">&gt; The only &quot;right&quot; way I can think of currently is to decode only isolated
&gt; whitespaces.</span >

How about a regex something like

  /%(?!3B|2F|3F|3A|40|26|3D|2B|24|2C|23)|\s(?=\s)|\s$/

This would mean we'll encode any whitespaces that are followed by a further whitespace, or that occur at the end of the URL. (I'd have liked to catch any whitespaces -preceded- by another whitespace, too, but that would have needed a lookbehind assertion, which AFAIK isn't available in JS regex.)

I agree the proper solution is to make sure the real domain is always visible and highlighted, but I don't think we're going to fix that for 57, so I'd suggest doing a whitespace fix like this as an interim fix that could be safely uplifted (also to ESR if desired).</pre></div><div class="change-set" id="c34"><div class="comment" data-id="12748849" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3560395_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3560395_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 08:43 PDT" data-time="1507736622">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12748849">(In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c33">comment #33</a>)
<span class="quote">&gt;   /%(?!3B|2F|3F|3A|40|26|3D|2B|24|2C|23)|\s(?=\s)|\s$/</span >

We should still always encode \r\t\n, even if they are not followed by another whitespace char. In my patch I just replaced them with \s because it was a catch-all solution. Surely it could be adapted, something like [\r\n\t]|\s(?=\s)|\s$

Though, gerv is right the only real solution is to show and hilight the real domain. I was looking for an &quot;almost whitespace char&quot; to see the effect. Replacing isolated spaces in this case doesn't help much, and I didn't search the whole unicode.
<a rel="nofollow" href="http://www.fake.domain/(%20%DC%82">http://www.fake.domain/(%20%DC%82</a> repeated many times)/real.domain</pre></div><div class="change-set" id="c35"><div class="comment" data-id="12749060" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a3560395_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a3560395_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 09:37 PDT" data-time="1507739822">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12749060">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c34">comment #34</a>)
<span class="quote">&gt; (In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c33">comment #33</a>)
&gt; &gt;   /%(?!3B|2F|3F|3A|40|26|3D|2B|24|2C|23)|\s(?=\s)|\s$/
&gt; 
&gt; We should still always encode \r\t\n, even if they are not followed by
&gt; another whitespace char.</span >

Ah, right; we should do those in all cases.

<span class="quote">&gt;  I was looking for an &quot;almost whitespace char&quot; to see the effect.
&gt; Replacing isolated spaces in this case doesn't help much, and I didn't
&gt; search the whole unicode.
&gt; <a rel="nofollow" href="http://www.fake.domain/(%20%DC%82">http://www.fake.domain/(%20%DC%82</a> repeated many times)/real.domain</span >

At that point, we're getting into territory that's more like the &quot;barely noticeable combining mark&quot; cases -- a glyph that is unambiguously visible (assuming non-broken fonts!), but nevertheless easily overlooked by users who aren't accustomed to noticing it.</pre></div><div class="change-set" id="c36"><div class="comment" data-id="12750020" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3560395_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3560395_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-11 13:00 PDT" data-time="1507752016">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="12750020">Considering the approvals for 57 were just made strict to the point of &quot;only if it may cause a chemspill release&quot;, I'd say we will just skip the stopgap solution.</pre></div><div class="change-set" id="c37"><div class="comment" data-id="12764399" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a3560395_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a3560395_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-16 15:45 PDT" data-time="1508193943">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8919079"
         class="attachment patch obsolete"
         data-id="8919079" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="14378">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8919079">
          <a class="link" href="attachment.cgi?id=8919079&amp;action=diff">
        <span id="att-8919079-description" itemprop="description">patch v2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8919079&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8919079">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-37" data-comment-id="12764399">This is a possible patch. It still lacks tests, but I'd first like to collect some feedback.
* multiple spaces are encoded as suggested by jfkthame, single spaces are not, so we retain ux advantage.
* the address bar gradient is on the left or on the right, depending on the overflow direction.
* there is an overlay label that always shows the scheme when it is overflowed and the url has a host.
* I didn't use ellipsis because it's impossible without proper text-overflow support. If we'd have a text-overflow where one could define at which char to put the ellipsis, it would be trivial.

I tested this with an ltr long url, and this rtl-host long url, in ltr, rtl and dark theme modes. In all the cases both the scheme and the host are visible and the gradient is on the right side. 

The code is not the cleanest, because while it's true we can set the selection to the end of the &quot;scheme://&quot;, that still creates situations where the url is overflowed on both sides when moving between states.
It would be much simpler if we'd strip the scheme, but that creates more risks of regressions when we have to put it back, and we'd only strip some schemes, that would make things even more foggy.

Another alternative I tried, was to create a special kind of selection like SELECTION_OMIT, that would not be drawn to the textrun. Then I could set that on the scheme, and always show the scheme in the separate label. It should be less regression prone, since the actual input value wouldn't change.
Unfortunately I'm not very good at layout code, I successfully introduced the selection type globally, but my changes to nsTextFrame.cpp didn't seem to work. Thus I don't know if it would properly align. Regardless, I'd need help implementing the omit selection type in the text frame, if we want to try that approach.

What do you think?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8917347&amp;action=edit"
           title="don't decode whitespaces"
           class=""
        >Attachment #8917347</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a4019924_240353"><div class="change" id="aa4019924_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a4019924_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4019924_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4019924_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a4019924_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-16 15:46 PDT" data-time="1508194000">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(jfkthame)</div><div class="change">Flags: needinfo?(dao+bmo)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="12764401" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4019924_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-16 15:47 PDT" data-time="1508194051">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="12764401">Since Gijs is away, I cc-ed Dao, who previously worked on formatting the urlbar text.</pre></div><div class="change-set" id="c39"><div class="comment" data-id="12765985" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363318" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/5910c2c56be9598a07535cc361b65a22?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363318" id="a4019924_240353"><a class="email " href="/user_profile?user_id=363318" > <span class="fna">Panos Astithas (he/him) [:past] (please ni?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 05:33 PDT" data-time="1508243607">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="12765985">From the comments above it sounds like we aren't going to create a low-risk patch for 56 and perhaps even 57.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=isnotempty">status-firefox56</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=equals&amp;v1=fix-optional">fix-optional</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox56&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=stale-bug&amp;resolution=---">stale-bug</a></span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="12766217" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4019924_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 06:42 PDT" data-time="1508247750">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="12766217">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c37">comment #37</a>)
<span class="quote">&gt; Created <span class="bz_obsolete"><a href="/attachment.cgi?id=8919079" name="attach_8919079" title="patch v2">attachment 8919079</a> <a href="/attachment.cgi?id=8919079&amp;action=edit" title="patch v2">[details]</a> <a href="/attachment.cgi?id=8919079&amp;action=diff" title="patch v2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8919079'>[review]</a>
&gt; patch v2
&gt; 
&gt; This is a possible patch. It still lacks tests, but I'd first like to
&gt; collect some feedback.
&gt; * multiple spaces are encoded as suggested by jfkthame, single spaces are
&gt; not, so we retain ux advantage.
&gt; * the address bar gradient is on the left or on the right, depending on the
&gt; overflow direction.
&gt; * there is an overlay label that always shows the scheme when it is
&gt; overflowed and the url has a host.
&gt; * I didn't use ellipsis because it's impossible without proper text-overflow
&gt; support. If we'd have a text-overflow where one could define at which char
&gt; to put the ellipsis, it would be trivial.
&gt; 
&gt; I tested this with an ltr long url, and this rtl-host long url, in ltr, rtl
&gt; and dark theme modes. In all the cases both the scheme and the host are
&gt; visible and the gradient is on the right side.</span >

I tried this patch in a local build (based on current m-c tip), and while it seems like a possible way forward, I observed a couple of glitches that will need further work. As a testcase, I took the URL generated by the PoC here (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c1">comment 1</a>).

(a) When I paste this URL into the address bar of a new tab and press Enter, it is displayed with the https:// scheme visible (as expected), but then the URL is left-aligned, meaning that the fake &quot;no.io&quot; domain (actually part of the fragment id) appears after the scheme, followed by the sequence of spaces (all but one %20-encoded). The same occurs if I navigate to the URL by choosing it from the History menu. Also, note that the fade-out gradient is missing at this point.

(b) If I switch to a different tab, and then return to my test tab with the long URL, it now displays right-aligned, so that the real domain (اسماء.شبكة) is visible. However, the sequence of %20-encoded spaces in the fragment identifier are overprinting the still-visible scheme.

I'll attach screenshots of (a) and (b) as seen on my system.</pre></div><div class="change-set" id="c41"><div class="comment" data-id="12766223" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4019924_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 06:43 PDT" data-time="1508247835">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8919293"
         class="attachment"
         data-id="8919293" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="pasted-url-a.png">
      <meta itemprop="contentSize" content="661407">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8919293" itemprop="contentUrl">
        <span id="att-8919293-description" itemprop="description">screenshot (a), after pasting the long URL and pressing Enter to go to the site</span></a>
        — <a href="attachment.cgi?id=8919293&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c42"><div class="comment" data-id="12766226" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4019924_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 06:44 PDT" data-time="1508247874">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8919294"
         class="attachment obsolete"
         data-id="8919294" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="pasted-long-url-b.png">
      <meta itemprop="contentSize" content="662052">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8919294" itemprop="contentUrl">
        <span id="att-8919294-description" itemprop="description">screenshot (b), after switching to a different tab and then back to the testcase tab</span></a> (obsolete)
        — <a href="attachment.cgi?id=8919294&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jfkthame)</span></div></div></div><div class="change-set" id="c43"><div class="comment" data-id="12766248" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4019924_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 06:52 PDT" data-time="1508248332">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="12766248">(In reply to Panos Astithas [:past] (please ni?) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c39">comment #39</a>)
<span class="quote">&gt; From the comments above it sounds like we aren't going to create a low-risk
&gt; patch for 56 and perhaps even 57.</span >

Personally, I'd still favor doing a minimal patch that %-encodes multiple spaces (i.e. just the regex change in function losslessDecodeURI) and trying to uplift that to 57, as I think it's a useful mitigation with minimal risk. Then all further improvements would go into a future release. But I recognize I'm not an owner/peer here, so it's not my call.</pre></div><div class="change-set" id="c44"><div class="comment" data-id="12766305" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4019924_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 07:06 PDT" data-time="1508249181">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="12766305">(In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c42">comment #42</a>)
<span class="quote">&gt; Created <span class="bz_obsolete"><a href="/attachment.cgi?id=8919294" name="attach_8919294" title="screenshot (b), after switching to a different tab and then back to the testcase tab">attachment 8919294</a> <a href="/attachment.cgi?id=8919294&amp;action=edit" title="screenshot (b), after switching to a different tab and then back to the testcase tab">[details]</a></span>
&gt; screenshot (b), after switching to a different tab and then back to the
&gt; testcase tab</span >

uh, this is strange, did you use --purgecaches? In particular it's strange that the label is missing the background since it's part of its css :\ I'll try to reproduce btw.</pre></div><div class="change-set" id="c45"><div class="comment" data-id="12766636" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4019924_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-17 08:42 PDT" data-time="1508254936">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="12766636">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c44">comment #44</a>)
<span class="quote">&gt; (In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c42">comment #42</a>)
&gt; &gt; Created <span class="bz_obsolete"><a href="/attachment.cgi?id=8919294" name="attach_8919294" title="screenshot (b), after switching to a different tab and then back to the testcase tab">attachment 8919294</a> <a href="/attachment.cgi?id=8919294&amp;action=edit" title="screenshot (b), after switching to a different tab and then back to the testcase tab">[details]</a></span>
&gt; &gt; screenshot (b), after switching to a different tab and then back to the
&gt; &gt; testcase tab
&gt; 
&gt; uh, this is strange, did you use --purgecaches?</span >

No, I wasn't aware of that. Just tried it, though, and I'm still seeing the issues. The exact result (a) seems to vary -- a couple of times, it's appeared with the gradient on the scheme at the left, though still showing the wrong part of the URL; case (b) with the overpainted scheme after switching tabs seems consistently reproducible.</pre></div><div class="change-set" id="c46"><div class="comment" data-id="12769328" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4019924_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-18 03:22 PDT" data-time="1508322153">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="12769328">Ah, problem b) is related to the fact I was testing using Dark Theme. The css needs some tweaks for the default theme.
Problem a) seems to depend on whether the text was already overflowed before pasting.</pre></div><div class="change-set" id="c47"><div class="comment" data-id="12770215" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4019924_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4019924_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-18 08:36 PDT" data-time="1508341017">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8919810"
         class="attachment patch obsolete"
         data-id="8919810" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="15628">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8919810">
          <a class="link" href="attachment.cgi?id=8919810&amp;action=diff">
        <span id="att-8919810-description" itemprop="description">patch v2.1</span></a> (obsolete)
        — <a href="attachment.cgi?id=8919810&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8919810">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-47" data-comment-id="12770215">This should fix the previous problems.
Though, I had some problems reproducing the issue a), so please check again and if you can provide me better STR I'd appreciate that.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8905279&amp;action=edit"
           title="Chrome screenshot"
           class=""
        >Attachment #8905279</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8919079&amp;action=edit"
           title="patch v2"
           class=""
        >Attachment #8919079</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8919294&amp;action=edit"
           title="screenshot (b), after switching to a different tab and then back to the testcase tab"
           class=""
        >Attachment #8919294</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a4166996_240353"><div class="change" id="aa4166996_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4166996_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4166996_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a4166996_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-18 08:37 PDT" data-time="1508341072">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(jfkthame)</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="12770446" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4166996_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-18 09:43 PDT" data-time="1508345007">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="12770446">This definitely looks better; I can no longer reproduce (b) at all, AFAICT.

I can still see some behavioral glitches, though, including a form of (a) in certain circumstances. I'll try to give STR that reliably misbehave for me:

(a) Visit the test URL from the PoC in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c1">comment 1</a>, so that it gets into History.
    Open a new browser window (NOT a new tab in the same window).
    Choose the test site's from the History menu.
    &gt;&gt; The URL is displayed left-aligned, so the wrong part of it (the fake &quot;no.io&quot;) is visible.
    Note that this only seems to happen for the first tab in a window.

(b) Visit the test URL from the PoC.
    Copy the entire long URL to the clipboard.
    Paste it back into the URL bar (overwriting the copy that's already there).
    Press Enter to confirm (&quot;navigating&quot; to the page we're already on).
    &gt;&gt; The URL is displayed left-aligned, with a fade applied to the left-hand end.
    &gt;&gt; Also, note that the https:// scheme label is missing.

(c) Visit the test URL from the PoC.
    Switch to a different tab, then return to the PoC tab.
    (In my experience, this fixes glitches such as (a) and (b) above, so the URL is now displayed as intended.)
    &gt;&gt; The scheme label (https://) is slightly misaligned, about a pixel or two higher than the text of the URL.

(d) Open a new tab.
    In the URL bar, start typing a really long URL. (Its content is irrelevant, just random text will do.)
    Observe what happens when the text reaches the end of the visible URL bar width.
    &gt;&gt; At the point where we'd expect it to start scrolling horizontally, instead the insertion point jumps back the beginning.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jfkthame)</span></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="12772729" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-19 02:29 PDT" data-time="1508405348">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8920064"
         class="attachment patch obsolete"
         data-id="8920064" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="16292">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8920064">
          <a class="link" href="attachment.cgi?id=8920064&amp;action=diff">
        <span id="att-8920064-description" itemprop="description">patch v2.2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8920064&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8920064">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-49" data-comment-id="12772729">Thank you, that was useful, all the reported issues should be fixed.
I'm not 100% sure about the text misalignment, since so far I only tested on Win, but I changed the alignment approach for a simple box centering.

I'll start looking into what I can add a test for.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8919810&amp;action=edit"
           title="patch v2.1"
           class=""
        >Attachment #8919810</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="12772830" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_219124" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_219124" id="a4166996_240353"><a class="email " href="/user_profile?user_id=219124" > <span class="fna">Dão Gottwald [::dao]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-19 02:59 PDT" data-time="1508407173">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="12772830">(In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c43">comment #43</a>)
<span class="quote">&gt; (In reply to Panos Astithas [:past] (please ni?) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c39">comment #39</a>)
&gt; &gt; From the comments above it sounds like we aren't going to create a low-risk
&gt; &gt; patch for 56 and perhaps even 57.
&gt; 
&gt; Personally, I'd still favor doing a minimal patch that %-encodes multiple
&gt; spaces (i.e. just the regex change in function losslessDecodeURI) and trying
&gt; to uplift that to 57, as I think it's a useful mitigation with minimal risk.
&gt; Then all further improvements would go into a future release. But I
&gt; recognize I'm not an owner/peer here, so it's not my call.</span >

I agree. This patch is a bit hard to evaluate since it tries to do different mostly unrelated things, there are many edge cases to consider, and the code isn't the cleanest, as Marco admitted. Can we just encode spaces here and move the other ideas to followups?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dao+bmo)</span></div></div></div><div class="change-set" id="c51"><div class="comment" data-id="12773003" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-19 04:34 PDT" data-time="1508412896">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="12773003">The newest patch is much cleaner, surely there are a few edge cases, but in practice it relies on the formatting code now, that is well tested. Have a look at it, I think it's a pretty good MVP.

We can surely land the fixed at different times, but there are 2 reasons I didn't:
1. uplifiting to 57 is very unlikely, per rel-eng decisions, so the benefit of splitting for 58 is minor
2. even with the whitespaces fix, the bug is not really fixed, since the host is still not visible. It would make the url less confusable just for more savvy users. And by landing the first part we'd practically expose the problem without having the final fix at hand.</pre></div><div class="change-set" id="c52"><div class="comment" data-id="12773859" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-19 09:01 PDT" data-time="1508428906">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8920250"
         class="attachment patch obsolete"
         data-id="8920250" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="20939">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8920250">
          <a class="link" href="attachment.cgi?id=8920250&amp;action=diff">
        <span id="att-8920250-description" itemprop="description">patch 2.3</span></a> (obsolete)
        — <a href="attachment.cgi?id=8920250&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8920250">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-52" data-comment-id="12773859">Added a test. Tomorrow I'll do some manual testing on Mac.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8920064&amp;action=edit"
           title="patch v2.2"
           class=""
        >Attachment #8920064</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="12776336" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4166996_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-20 05:20 PDT" data-time="1508502026">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="12776336">I tested briefly again with the new patch; this is definitely a lot more stable. At this point, I've only noticed a couple of relatively minor glitches (again, I'm testing on a Mac, in case this has any significance):

1. Open a new window.
2. Load the test URL from the PoC above (the &quot;fake no.io&quot;).
   &gt; It displays correctly, with the Arabic-script domain visible at the right, the scheme visible at the left, and the long URL truncated (with fade-out) before it hits the scheme
3. Now, assume we want to edit the URL. So click in it, let's say at the dot in the domain name.
   &gt; The focus goes to the URL bar, and the entire URL is selected
   &gt; HOWEVER, sometimes (maybe one in three or four times, the URL &quot;jumps&quot; horizontally so that the domain is no longer visible, and I'm looking at a run of encoded spaces (%20%20%20%20...)
4a. Click in the (now-selected) URL a second time, to place an insertion point for editing.
    &gt; If the URL didn't &quot;jump-scroll&quot; in the previous step, this behaves fine. If it did, the insertion point seems to be misplaced by a few characters from where I clicked.
4b. Instead of clicking in the selected URL to begin editing, I change my mind and click back in the content of the page.
    &gt; The URL bar loses focus, but in the process its content momentarily jumps to the wrong end of its scroll range, before reverting to the expected right-aligned scroll position. This produces a distracting visual flicker as the text skips back and forth.</pre></div><div class="change-set" id="c54"><div class="comment" data-id="12776400" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-20 05:50 PDT" data-time="1508503858">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="12776400">(In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c53">comment #53</a>)
<span class="quote">&gt; 3. Now, assume we want to edit the URL. So click in it, let's say at the dot
&gt; in the domain name.</span >

I fear the jumping issue is due to the underlying editor and I'd not have much control over that from the urlbar code.
If it just happens for overflowed urls with RTL domains, it sounds like an edge case, so we may ignore it for now. I'll have a look at it.

<span class="quote">&gt;     &gt; The URL bar loses focus, but in the process its content momentarily
&gt; jumps to the wrong end of its scroll range, before reverting to the expected
&gt; right-aligned scroll position. This produces a distracting visual flicker as
&gt; the text skips back and forth.</span >

This may be unavoidable unless we have a way to tell if the first char after the scheme is RTL. Do you know if we have something like that exposed to js?</pre></div><div class="change-set" id="c55"><div class="comment" data-id="12782804" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-23 10:02 PDT" data-time="1508778178">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="12782804">(In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c53">comment #53</a>)
<span class="quote">&gt; 3. Now, assume we want to edit the URL. So click in it, let's say at the dot
&gt; in the domain name.
&gt;    &gt; The focus goes to the URL bar, and the entire URL is selected
&gt;    &gt; HOWEVER, sometimes (maybe one in three or four times, the URL &quot;jumps&quot;
&gt; horizontally so that the domain is no longer visible, and I'm looking at a
&gt; run of encoded spaces (%20%20%20%20...)</span >

After some testing, I think this is a bug somewhere in the editor or the selection code, that is uncovered by the rtl selection. Indeed the only thing we do is a call to .selectAll(). I don't have much control over that, but it seems rare enough to not be a blocker.</pre></div><div class="change-set" id="c56"><div class="comment" data-id="12782947" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-23 10:43 PDT" data-time="1508780632">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8921148"
         class="attachment patch obsolete"
         data-id="8921148" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="21023">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8921148">
          <a class="link" href="attachment.cgi?id=8921148&amp;action=diff">
        <span id="att-8921148-description" itemprop="description">patch 2.4</span></a> (obsolete)
        — <a href="attachment.cgi?id=8921148&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8921148">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8920250&amp;action=edit"
           title="patch 2.3"
           class=""
        >Attachment #8920250</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="12784794" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a4166996_240353"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-24 01:52 PDT" data-time="1508835120">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="12784794">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c55">comment #55</a>)
<span class="quote">&gt; (In reply to Jonathan Kew (:jfkthame) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c53">comment #53</a>)
&gt; &gt; 3. Now, assume we want to edit the URL. So click in it, let's say at the dot
&gt; &gt; in the domain name.
&gt; &gt;    &gt; The focus goes to the URL bar, and the entire URL is selected
&gt; &gt;    &gt; HOWEVER, sometimes (maybe one in three or four times, the URL &quot;jumps&quot;
&gt; &gt; horizontally so that the domain is no longer visible, and I'm looking at a
&gt; &gt; run of encoded spaces (%20%20%20%20...)
&gt; 
&gt; After some testing, I think this is a bug somewhere in the editor or the
&gt; selection code, that is uncovered by the rtl selection. Indeed the only
&gt; thing we do is a call to .selectAll(). I don't have much control over that,
&gt; but it seems rare enough to not be a blocker.</span >

It's not limited to cases that involve RTL; I've also seen it with purely LTR long URLs. But on checking, I find that I can also reproduce it (intermittently) in a current nightly (i.e. without the patch here), in the existing URL bar. So as you say, it's not an issue with this patch; it seems to be a bug elsewhere in editor/selection handling.</pre></div><div class="change-set" id="c58"><div class="comment" data-id="12785415" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-24 06:28 PDT" data-time="1508851712">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8921447"
         class="attachment patch obsolete"
         data-id="8921447" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="21139">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8921447">
          <a class="link" href="attachment.cgi?id=8921447&amp;action=diff">
        <span id="att-8921447-description" itemprop="description">patch v2.5</span></a> (obsolete)
        — <a href="attachment.cgi?id=8921447&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8921447">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-58" data-comment-id="12785415">Ok, I did some more testing on Win and Mac and modulo the bug with SelectAll() unrelated to this specific change, it is working. Thus moving to review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8921148&amp;action=edit"
           title="patch 2.4"
           class=""
        >Attachment #8921148</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8921447&amp;action=edit"
           title="patch v2.5"
           class=""
        >Attachment #8921447</a> -
        Flags: review?(dao+bmo)</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="12811711" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363318" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/5910c2c56be9598a07535cc361b65a22?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363318" id="a4166996_240353"><a class="email " href="/user_profile?user_id=363318" > <span class="fna">Panos Astithas (he/him) [:past] (please ni?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-02 06:21 PDT" data-time="1509628902">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="12811711">Too late for 57, let's try to get this in 58.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=isnotempty">status-firefox57</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=fix-optional">fix-optional</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c60"><div class="comment" data-id="12820810" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a4166996_240353"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-06 05:37 PST" data-time="1509975431">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="12820810">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8921447" name="attach_8921447" title="patch v2.5">attachment 8921447</a> <a href="/attachment.cgi?id=8921447&amp;action=edit" title="patch v2.5">[details]</a> <a href="/attachment.cgi?id=8921447&amp;action=diff" title="patch v2.5">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8921447'>[review]</a>
patch v2.5

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8921447" name="attach_8921447" title="patch v2.5">attachment 8921447</a> <a href="/attachment.cgi?id=8921447&amp;action=edit" title="patch v2.5">[details]</a> <a href="/attachment.cgi?id=8921447&amp;action=diff" title="patch v2.5">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8921447'>[review]</a>:
-----------------------------------------------------------------

::: browser/base/content/urlbarBindings.xml
&#64;&#64; +482,5 &#64;&#64;
<span class="quote">&gt; +          // its beginning.
&gt; +          BrowserUtils.promiseLayoutFlushed(document, &quot;layout&quot;, () =&gt; {
&gt; +            requestAnimationFrame(() =&gt; {
&gt; +              if (!this.focused) {
&gt; +                this.selectionStart = this.selectionEnd = schemeWSlashes.length;</span >

Drive-by (sorry) - this should have a check against re-entrancy (ditto for the further-nested updates a bit further down).</pre></div><div class="change-set" id="c61"><div class="comment" data-id="12827180" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_219124" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_219124" id="a4166996_240353"><a class="email " href="/user_profile?user_id=219124" > <span class="fna">Dão Gottwald [::dao]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 03:04 PST" data-time="1510139047">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="12827180">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c51">comment #51</a>)
<span class="quote">&gt; The newest patch is much cleaner, surely there are a few edge cases, but in
&gt; practice it relies on the formatting code now, that is well tested. Have a
&gt; look at it, I think it's a pretty good MVP.</span >

I'm afraid the whole .urlbar-scheme-box[scheme][textoverflow=&quot;start&quot;] thing is an edge case. :/
It will be easy to regress and we won't necessarily catch that in nightly testing.

<span class="quote">&gt; We can surely land the fixed at different times, but there are 2 reasons I
&gt; didn't:
&gt; 1. uplifiting to 57 is very unlikely, per rel-eng decisions, so the benefit
&gt; of splitting for 58 is minor
&gt; 2. even with the whitespaces fix, the bug is not really fixed, since the
&gt; host is still not visible. It would make the url less confusable just for
&gt; more savvy users. And by landing the first part we'd practically expose the
&gt; problem without having the final fix at hand.</span >

With the whitespce fix, this bug doesn't seem severe enough to me to be concerned about that. But we can land without a commit message and keep this bug marked security-sensitive for as long as we want.</pre></div><div class="change-set" id="c62"><div class="comment" data-id="12827234" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_219124" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_219124" id="a4166996_240353"><a class="email " href="/user_profile?user_id=219124" > <span class="fna">Dão Gottwald [::dao]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 03:13 PST" data-time="1510139588">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="12827234">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8921447" name="attach_8921447" title="patch v2.5">attachment 8921447</a> <a href="/attachment.cgi?id=8921447&amp;action=edit" title="patch v2.5">[details]</a> <a href="/attachment.cgi?id=8921447&amp;action=diff" title="patch v2.5">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8921447'>[review]</a>
patch v2.5

I'm getting arbitrary results when repeatedly switching from/to the tab with the testcase loaded. Sometimes the scheme is displayed, sometimes it's missing. Also its horizontal alignment seems off by a pixel. Tested on Linux.

<span class="quote">&gt;+          this.schemeBox.firstChild.style.opacity = 0.5;</span >

Hmm, this isn't how SELECTION_URLSECONDARY works. It explicitly doesn't use the alpha channel since this might get us grayscale anti-aliasing:
<a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/ed212c79cfe86357e9a5740082b9364e7f6e526f/layout/generic/nsTextFrame.cpp#3972">http://searchfox.org/mozilla-central/rev/ed212c79cfe86357e9a5740082b9364e7f6e526f/layout/generic/nsTextFrame.cpp#3972</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8921447&amp;action=edit"
           title="patch v2.5"
           class=""
        >Attachment #8921447</a> -
        Flags: <span class="activity-deleted">review?(dao+bmo)</span></div></div></div><div class="change-set" id="c63"><div class="comment" data-id="12827256" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 03:27 PST" data-time="1510140441">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="12827256">(In reply to Dão Gottwald [::dao] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c61">comment #61</a>)
<span class="quote">&gt; I'm afraid the whole .urlbar-scheme-box[scheme][textoverflow=&quot;start&quot;] thing
&gt; is an edge case. :/
&gt; It will be easy to regress and we won't necessarily catch that in nightly
&gt; testing.</span >

It is sort-of an edge case, but this bug is about an edge case.
I agree it's something we may miss in Nightly, that's why I added a test, so we don't regress.

<span class="quote">&gt; With the whitespce fix, this bug doesn't seem severe enough to me to be
&gt; concerned about that. But we can land without a commit message and keep this
&gt; bug marked security-sensitive for as long as we want.</span >

If dveditz is fine with that, no problem on my side.
I still think not showing the domain doesn't really fix anything for the non-technical users, it will just be a weak indicator: &quot;something looks strange, but I see a host here&quot;.
But for the next version I will split the patch into the 2 parts.

(In reply to Dão Gottwald [::dao] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c62">comment #62</a>)
<span class="quote">&gt; I'm getting arbitrary results when repeatedly switching from/to the tab with
&gt; the testcase loaded. Sometimes the scheme is displayed, sometimes it's
&gt; missing. Also its horizontal alignment seems off by a pixel. Tested on Linux.</span >

I want to address the re-entrancy Gijs pointed out and re-test for this tab switching case, I didn't see it on Win/Mac.
I suppose the 1px offset is not a critical problem, considered as you said this is an edge case, and security comes first.

<span class="quote">&gt; &gt;+          this.schemeBox.firstChild.style.opacity = 0.5;
&gt; 
&gt; Hmm, this isn't how SELECTION_URLSECONDARY works. It explicitly doesn't use
&gt; the alpha channel since this might get us grayscale anti-aliasing:
&gt; <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/">http://searchfox.org/mozilla-central/rev/</a>
&gt; ed212c79cfe86357e9a5740082b9364e7f6e526f/layout/generic/nsTextFrame.cpp#3972</span >

I know, but I have no way to reproduce what the textframe is doing.
Is it critical to have subpixel AA in a small label shown in edge cases? Any alternative suggestion on how to achieve that?</pre></div><div class="change-set" id="c64"><div class="comment" data-id="12827444" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_219124" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_219124" id="a4166996_240353"><a class="email " href="/user_profile?user_id=219124" > <span class="fna">Dão Gottwald [::dao]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 05:38 PST" data-time="1510148310">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="12827444">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c63">comment #63</a>)
<span class="quote">&gt; (In reply to Dão Gottwald [::dao] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c62">comment #62</a>)
&gt; &gt; I'm getting arbitrary results when repeatedly switching from/to the tab with
&gt; &gt; the testcase loaded. Sometimes the scheme is displayed, sometimes it's
&gt; &gt; missing. Also its horizontal alignment seems off by a pixel. Tested on Linux.
&gt; 
&gt; I want to address the re-entrancy Gijs pointed out and re-test for this tab
&gt; switching case, I didn't see it on Win/Mac.
&gt; I suppose the 1px offset is not a critical problem, considered as you said
&gt; this is an edge case, and security comes first.</span >

If we want to commit to doing this, I'd rather do it right. These kind of glitches that aren't covered by the test and will only add up over time are exactly what concerns me.

<span class="quote">&gt; &gt; &gt;+          this.schemeBox.firstChild.style.opacity = 0.5;
&gt; &gt; 
&gt; &gt; Hmm, this isn't how SELECTION_URLSECONDARY works. It explicitly doesn't use
&gt; &gt; the alpha channel since this might get us grayscale anti-aliasing:
&gt; &gt; <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/">http://searchfox.org/mozilla-central/rev/</a>
&gt; &gt; ed212c79cfe86357e9a5740082b9364e7f6e526f/layout/generic/nsTextFrame.cpp#3972
&gt; 
&gt; I know, but I have no way to reproduce what the textframe is doing.
&gt; Is it critical to have subpixel AA in a small label shown in edge cases? Any
&gt; alternative suggestion on how to achieve that?</span >

Perhaps use a textframe with SELECTION_URLSECONDARY?</pre></div><div class="change-set" id="c65"><div class="comment" data-id="12827671" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 07:03 PST" data-time="1510153390">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8926403"
         class="attachment patch obsolete"
         data-id="8926403" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="spaces.diff">
      <meta itemprop="contentSize" content="3064">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8926403">
          <a class="link" href="attachment.cgi?id=8926403&amp;action=diff">
        <span id="att-8926403-description" itemprop="description">part 1 - Don't decode adjacent spaces</span></a> (obsolete)
        — <a href="attachment.cgi?id=8926403&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8926403">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-65" data-comment-id="12827671">This is the part we agree upon: don't decode consecutive spaces. It preserves UX for urls having single spaces to separate words, but makes long runs of spaces visible and likely warnings the user something may be wrong.

I'm still looking at the second part (always show the domain) to see if I can reproduce the reported intermittent issues.

Daniel, would you be fine with landing the first part for now, so that consecutive spaces are shown encoded, and keep the second part for later when we are more comfortable with it?
Do you think there's risk exposing a partial fix to the problem?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8926403&amp;action=edit"
           title="part 1 - Don't decode adjacent spaces"
           class=""
        >Attachment #8926403</a> -
        Flags: review?(dao+bmo)</div><div class="change">
        <a href="/attachment.cgi?id=8926403&amp;action=edit"
           title="part 1 - Don't decode adjacent spaces"
           class=""
        >Attachment #8926403</a> -
        Flags: feedback?(dveditz)</div></div></div><div class="change-set" id="c66"><div class="comment" data-id="12827745" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_219124" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_219124" id="a4166996_240353"><a class="email " href="/user_profile?user_id=219124" > <span class="fna">Dão Gottwald [::dao]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 07:26 PST" data-time="1510154814">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="12827745">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8926403" name="attach_8926403" title="part 1 - Don't decode adjacent spaces">attachment 8926403</a> <a href="/attachment.cgi?id=8926403&amp;action=edit" title="part 1 - Don't decode adjacent spaces">[details]</a> <a href="/attachment.cgi?id=8926403&amp;action=diff" title="part 1 - Don't decode adjacent spaces">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8926403'>[review]</a>
part 1 - Don't decode adjacent spaces

<span class="quote">&gt;--- a/browser/base/content/browser.js
&gt;+++ b/browser/base/content/browser.js
&gt;&#64;&#64; -2761,18 +2761,20 &#64;&#64; function losslessDecodeURI(aURI) {
&gt;       try {
&gt;         value = decodeURI(value)
&gt;                   // 1. decodeURI decodes %25 to %, which creates unintended
&gt;                   //    encoding sequences. Re-encode it, unless it's part of
&gt;                   //    a sequence that survived decodeURI, i.e. one for:
&gt;                   //    ';', '/', '?', ':', '&#64;', '&amp;', '=', '+', '$', ',', '#'
&gt;                   //    (RFC 3987 section 3.2)
&gt;                   // 2. Re-encode whitespace so that it doesn't get eaten away
&gt;-                  //    by the location bar (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - address bar eats escaped newlines"
   href="/show_bug.cgi?id=410726">bug 410726</a>).
&gt;-                  .replace(/%(?!3B|2F|3F|3A|40|26|3D|2B|24|2C|23)|[\r\n\t]/ig,
&gt;+                  //    by the location bar. We explicitly want to re-encode
&gt;+                  //    multiple whitespaces, because they make spoofing
&gt;+                  //    attempts easier.</span >

I'd leave the reference to that old bug and tweak the wording a bit:

&quot;Re-encode select whitespace so that it doesn't get eaten away by the location bar (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - address bar eats escaped newlines"
   href="/show_bug.cgi?id=410726">bug 410726</a>). Re-encode all adjacent whitespace to prevent spoofing attempts where invisible characters would push part of the URL to overflow the location bar.&quot;

Maybe also add a reference to this bug. Blame is a bit annoying here because these lines tend to get touched again and again.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8926403&amp;action=edit"
           title="part 1 - Don't decode adjacent spaces"
           class=""
        >Attachment #8926403</a> -
        Flags: review?(dao+bmo) &rarr; review+</div></div></div><div class="change-set" id="c67"><div class="comment" data-id="12827896" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 08:19 PST" data-time="1510157945">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="12827896">(In reply to Dão Gottwald [::dao] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c66">comment #66</a>)
<span class="quote">&gt; Maybe also add a reference to this bug. Blame is a bit annoying here because
&gt; these lines tend to get touched again and again.</span >

I've updated the comment locally, though now it's basically exposing what this bug is about and how to reproduce it.
Imo that forces us to move the remaining work to a separate bug. Let's see what Daniel thinks.</pre></div><div class="change-set" id="c68"><div class="comment" data-id="12828490" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_219124" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_219124" id="a4166996_240353"><a class="email " href="/user_profile?user_id=219124" > <span class="fna">Dão Gottwald [::dao]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 11:17 PST" data-time="1510168644">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="12828490">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c67">comment #67</a>)
<span class="quote">&gt; (In reply to Dão Gottwald [::dao] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c66">comment #66</a>)
&gt; &gt; Maybe also add a reference to this bug. Blame is a bit annoying here because
&gt; &gt; these lines tend to get touched again and again.
&gt; 
&gt; I've updated the comment locally, though now it's basically exposing what
&gt; this bug is about and how to reproduce it.</span >

Not quite, crucial details like the RTL stuff are missing.</pre><div class="activity"><div class="change">Summary: Firefox address bar spoof using LTR language and references &rarr; Firefox address bar spoof using RTL language and references</div></div></div><div class="change-set" id="c69"><div class="comment" data-id="12829399" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a4166996_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a4166996_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 17:00 PST" data-time="1510189225">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8926654"
         class="attachment patch obsolete"
         data-id="8926654" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part2.diff">
      <meta itemprop="contentSize" content="20272">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8926654">
          <a class="link" href="attachment.cgi?id=8926654&amp;action=diff">
        <span id="att-8926654-description" itemprop="description">Part 2 - Always show domain and scheme (ftp, https)</span></a> (obsolete)
        — <a href="attachment.cgi?id=8926654&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8926654">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-69" data-comment-id="12829399">This fixes the opacity AA, the alignment and the re-entrancy. I didn't have a chance to test the Linux intermittent problem. Testing is welcome.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8921447&amp;action=edit"
           title="patch v2.5"
           class=""
        >Attachment #8921447</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a6015167_240353"><div class="change" id="aa6015167_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a6015167_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6015167_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6015167_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a6015167_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 17:00 PST" data-time="1510189243">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8926654&amp;action=edit"
           title="Part 2 - Always show domain and scheme (ftp, https)"
           class=""
        >Attachment #8926654</a> -
        Attachment description: Part 2 - Alwaus show domain and scheme (ftp, https) &rarr; Part 2 - Always show domain and scheme (ftp, https)</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="12832269" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6015167_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-09 13:55 PST" data-time="1510264523">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8927028"
         class="attachment patch obsolete"
         data-id="8927028" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="part2.diff">
      <meta itemprop="contentSize" content="22072">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8927028">
          <a class="link" href="attachment.cgi?id=8927028&amp;action=diff">
        <span id="att-8927028-description" itemprop="description">Part 2 - Always show domain and scheme (ftp, https)part2.diff</span></a> (obsolete)
        — <a href="attachment.cgi?id=8927028&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8927028">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8926654&amp;action=edit"
           title="Part 2 - Always show domain and scheme (ftp, https)"
           class=""
        >Attachment #8926654</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c71"><div class="comment" data-id="12834240" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6015167_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-10 06:52 PST" data-time="1510325526">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="12834240">Dao, could you please give a quick test to the latest version? It fixes alignment, colors and LWTs.</pre><div class="activity"><div class="change">Flags: needinfo?(dao+bmo)</div></div></div><div class="change-set" id="c72"><div class="comment" data-id="12842642" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6015167_240353"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-14 08:22 PST" data-time="1510676558">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="12842642">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8926403" name="attach_8926403" title="part 1 - Don't decode adjacent spaces">attachment 8926403</a> <a href="/attachment.cgi?id=8926403&amp;action=edit" title="part 1 - Don't decode adjacent spaces">[details]</a> <a href="/attachment.cgi?id=8926403&amp;action=diff" title="part 1 - Don't decode adjacent spaces">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8926403'>[review]</a>
part 1 - Don't decode adjacent spaces

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8926403" name="attach_8926403" title="part 1 - Don't decode adjacent spaces">attachment 8926403</a> <a href="/attachment.cgi?id=8926403&amp;action=edit" title="part 1 - Don't decode adjacent spaces">[details]</a> <a href="/attachment.cgi?id=8926403&amp;action=diff" title="part 1 - Don't decode adjacent spaces">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8926403'>[review]</a>:
-----------------------------------------------------------------

::: browser/base/content/browser.js
&#64;&#64; +2768,5 &#64;&#64;
<span class="quote">&gt;                    // 2. Re-encode whitespace so that it doesn't get eaten away
&gt; +                  //    by the location bar. We explicitly want to re-encode
&gt; +                  //    multiple whitespaces, because they make spoofing
&gt; +                  //    attempts easier.
&gt; +                  .replace(/%(?!3B|2F|3F|3A|40|26|3D|2B|24|2C|23)|[\r\n\t]|\s(?=\s)|\s$/ig,</span >

I agree w/Dão that we shouldn't remove the old bug reference and should add a reference to this bug.

Should be fine to land just this part -- spaces are already known to be spoofy and nothing here references the RTL aspect.

::: browser/base/content/test/urlbar/browser_urlbarCopying.js
&#64;&#64; +166,5 &#64;&#64;
<span class="quote">&gt;    },
&gt;    {
&gt; +    loadURL: &quot;<a rel="nofollow" href="http://example.com/a%20test">http://example.com/a%20test</a>&quot;,
&gt; +    expectedURL: &quot;example.com/a test&quot;,
&gt; +    copyExpected: &quot;<a rel="nofollow" href="http://example.com/a%20test">http://example.com/a%20test</a>&quot;</span >

Can we add a test with two embedded spaces (possibly different ones, like %20%C2%A0) to show the expected &quot;%20 &quot; behavior and not &quot; %C2%A0&quot;?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8926403&amp;action=edit"
           title="part 1 - Don't decode adjacent spaces"
           class=""
        >Attachment #8926403</a> -
        Flags: feedback?(dveditz) &rarr; feedback+</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="12842671" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6015167_240353"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-14 08:36 PST" data-time="1510677415">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="12842671">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c65">comment #65</a>)
<span class="quote">&gt; Daniel, would you be fine with landing the first part for now</span >

Yep.

(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c67">comment #67</a>)
<span class="quote">&gt; I've updated the comment locally, though now it's basically exposing what
&gt; this bug is about and how to reproduce it.</span >

What did you update the comment to? If you take the comment I saw and just stick &quot;(<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508">bug 1395508</a>)&quot; on the end it's not revealing the key part of this. Even if it does I'd prefer keeping the work in this bug. Something like

<span class="quote">&gt;+                  //    by the location bar (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - address bar eats escaped newlines"
   href="/show_bug.cgi?id=410726">bug 410726</a>)). We explicitly
&gt;+                  //    want to re-encode multiple whitespaces, because
&gt;+                  //    they make spoofing attempts easier (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508">bug 1395508</a>).</span >

should be fine, and then keep the remaining work in this bug.</pre></div><div class="change-set" id="c74"><div class="comment" data-id="12842702" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6015167_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-14 08:49 PST" data-time="1510678149">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="12842702">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c73">comment #73</a>)
<span class="quote">&gt; (In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c67">comment #67</a>)
&gt; &gt; I've updated the comment locally, though now it's basically exposing what
&gt; &gt; this bug is about and how to reproduce it.
&gt; 
&gt; What did you update the comment to?</span >

The one suggested in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c66">comment 66</a>.</pre></div><div class="change-set" id="c75"><div class="comment" data-id="12845900" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6015167_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-15 09:15 PST" data-time="1510766123">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-75" data-comment-id="12845900">I should have set a needinfo. Please check the suggested text in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c66">comment 66</a> and let me know if it's ok to ship it or if you would like modifications.</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c76"><div class="comment" data-id="12858884" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6015167_240353"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-20 06:57 PST" data-time="1511189841">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="12858884">The proposed text in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c66">comment 66</a> looks fine.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c77"><div class="comment" data-id="12862033" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a6015167_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a6015167_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 04:56 PST" data-time="1511269001">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="12862033">To simplify tracking of this bug (likely we'd uplift part 1) I'm going to split part 2 to a separate cloned bug.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dao+bmo)</span></div></div></div><div class="change-set" id="a7095304_240353"><div class="change" id="aa7095304_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7095304_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a7095304_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7095304_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7095304_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a7095304_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 05:03 PST" data-time="1511269380">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1419391">1419391</a></div></div></div><div class="change-set" id="c78"><div class="comment" data-id="12862087" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7095304_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7095304_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 05:24 PST" data-time="1511270679">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-78" data-comment-id="12862087">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c72">comment #72</a>)
<span class="quote">&gt; Can we add a test with two embedded spaces (possibly different ones, like
&gt; %20%C2%A0) to show the expected &quot;%20 &quot; behavior and not &quot; %C2%A0&quot;?</span >

We will actually show &quot;%20%C2%A0&quot; and not &quot; %C2%A0&quot; because they are considered consecutive spaces and thus re-encoded by this patch. I still added the test, I hope it's ok, it should be from the point of view of this report.</pre></div><div class="change-set" id="a7096618_240353"><div class="change" id="aa7096618_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a7096618_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7096618_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7096618_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a7096618_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 05:24 PST" data-time="1511270694">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8927028&amp;action=edit"
           title="Part 2 - Always show domain and scheme (ftp, https)part2.diff"
           class=""
        >Attachment #8927028</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c79"><div class="comment" data-id="12862093" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7096618_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 05:30 PST" data-time="1511271011">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8930465"
         class="attachment patch"
         data-id="8930465" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1395508.diff">
      <meta itemprop="contentSize" content="3432">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8930465">
          <a class="link" href="attachment.cgi?id=8930465&amp;action=diff">
        <span id="att-8930465-description" itemprop="description">re-encode consecutive spaces</span></a>
        — <a href="attachment.cgi?id=8930465&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8930465">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8926403&amp;action=edit"
           title="part 1 - Don't decode adjacent spaces"
           class=""
        >Attachment #8926403</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c80"><div class="comment" data-id="12862200" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7096618_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 06:22 PST" data-time="1511274172">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-80" data-comment-id="12862200"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/a14cc3bd9643">https://hg.mozilla.org/integration/mozilla-inbound/rev/a14cc3bd9643</a></pre></div><div class="change-set" id="c81"><div class="comment" data-id="12863971" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a7096618_240353"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a7096618_240353"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 15:48 PST" data-time="1511308135">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-81" data-comment-id="12863971"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/a14cc3bd9643">https://hg.mozilla.org/mozilla-central/rev/a14cc3bd9643</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2017-11-21 15:48 PST" data-time="1511308135">4 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; Firefox 59</div></div></div><div class="change-set" id="c82"><div class="comment" data-id="12864610" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7096618_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 23:26 PST" data-time="1511335610">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-82" data-comment-id="12864610">Not sure why this has been marked as fixed on 58, likely a mistake.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c83"><div class="comment" data-id="12864611" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7096618_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 23:28 PST" data-time="1511335694">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="12864611">Comment on <span class=""><a href="/attachment.cgi?id=8930465" name="attach_8930465" title="re-encode consecutive spaces">attachment 8930465</a> <a href="/attachment.cgi?id=8930465&amp;action=edit" title="re-encode consecutive spaces">[details]</a> <a href="/attachment.cgi?id=8930465&amp;action=diff" title="re-encode consecutive spaces">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8930465'>[review]</a>
re-encode consecutive spaces

Approval Request Comment
[Feature/Bug causing the regression]: no regression
[User impact if declined]: Spoofing attempts using adjacent whitespaces in the Address Bar are easier
[Is this code covered by automated tests?]: yes
[Has the fix been verified in Nightly?]: not yet
[Needs manual test from QE? If yes, steps to reproduce]: no
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: no
[Why is the change risky/not risky?]: it's a regex change
[String changes made/needed]: none</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8930465&amp;action=edit"
           title="re-encode consecutive spaces"
           class=""
        >Attachment #8930465</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c84"><div class="comment" data-id="12864639" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7096618_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-21 23:42 PST" data-time="1511336521">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-84" data-comment-id="12864639">Comment on <span class=""><a href="/attachment.cgi?id=8930465" name="attach_8930465" title="re-encode consecutive spaces">attachment 8930465</a> <a href="/attachment.cgi?id=8930465&amp;action=edit" title="re-encode consecutive spaces">[details]</a> <a href="/attachment.cgi?id=8930465&amp;action=diff" title="re-encode consecutive spaces">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8930465'>[review]</a>
re-encode consecutive spaces

[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration: spoofing Address bar fix
User impact if declined: spoofing through spaces in the Address Bar is easier
Fix Landed on Version: 59
Risk to taking this patch (and alternatives if risky): should not be risky, simple regex change
String or UUID changes made by this patch: none

See <a rel="nofollow" href="https://wiki.mozilla.org/Release_Management/ESR_Landing_Process">https://wiki.mozilla.org/Release_Management/ESR_Landing_Process</a> for more info.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8930465&amp;action=edit"
           title="re-encode consecutive spaces"
           class=""
        >Attachment #8930465</a> -
        Flags: approval-mozilla-esr52?</div></div></div><div class="change-set" id="c85"><div class="comment" data-id="12867935" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_506302" id="a7096618_240353"><img src="https://secure.gravatar.com/avatar/58cce0c47d9c6efb7d83bc34b9d79816?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_506302" id="a7096618_240353"><a class="email disabled" href="/user_profile?user_id=506302" > <span class="fna">Gerry Chang [:gchang]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-22 23:08 PST" data-time="1511420889">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-85" data-comment-id="12867935">Hi dveditz,
Since this is sec-moderate, do you think we need to take this in Beta58 &amp; ESR52?</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a7269529_580382"><div class="change" id="aa7269529_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a7269529_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a7269529_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7269529_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7269529_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a7269529_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-23 05:26 PST" data-time="1511443605">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a7630074_1689"><div class="change" id="aa7630074_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7630074_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a7630074_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7630074_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7630074_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a7630074_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-27 09:35 PST" data-time="1511804150">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c86"><div class="comment" data-id="12882302" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7630074_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a7630074_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-28 23:09 PST" data-time="1511939345">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-86" data-comment-id="12882302">(In reply to Gerry Chang [:gchang] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c85">comment #85</a>)
<span class="quote">&gt; Since this is sec-moderate, do you think we need to take this in Beta58 &amp; ESR52?</span >

We should, because these spoofs are easy to construct once people think about it, and the patch is small and straightforward.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c87"><div class="comment" data-id="12885286" data-no="87"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-87" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_506302" id="a7630074_1689"><img src="https://secure.gravatar.com/avatar/58cce0c47d9c6efb7d83bc34b9d79816?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_506302" id="a7630074_1689"><a class="email disabled" href="/user_profile?user_id=506302" > <span class="fna">Gerry Chang [:gchang]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-87"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-87" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c87">Comment 87</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-29 18:19 PST" data-time="1512008378">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-87">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-87" data-comment-id="12885286">Comment on <span class=""><a href="/attachment.cgi?id=8930465" name="attach_8930465" title="re-encode consecutive spaces">attachment 8930465</a> <a href="/attachment.cgi?id=8930465&amp;action=edit" title="re-encode consecutive spaces">[details]</a> <a href="/attachment.cgi?id=8930465&amp;action=diff" title="re-encode consecutive spaces">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1395508&amp;attachment=8930465'>[review]</a>
re-encode consecutive spaces

Fix a sec-moderate. Beta58+ &amp; ESR52+.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8930465&amp;action=edit"
           title="re-encode consecutive spaces"
           class=""
        >Attachment #8930465</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr52?</span></div><div class="change">
        <a href="/attachment.cgi?id=8930465&amp;action=edit"
           title="re-encode consecutive spaces"
           class=""
        >Attachment #8930465</a> -
        Flags: approval-mozilla-esr52+</div><div class="change">
        <a href="/attachment.cgi?id=8930465&amp;action=edit"
           title="re-encode consecutive spaces"
           class=""
        >Attachment #8930465</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div><div class="change">
        <a href="/attachment.cgi?id=8930465&amp;action=edit"
           title="re-encode consecutive spaces"
           class=""
        >Attachment #8930465</a> -
        Flags: approval-mozilla-beta+</div></div></div><div class="change-set" id="a7834320_506302"><div class="change" id="aa7834320_506302">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_506302" id="a7834320_506302"><img src="https://secure.gravatar.com/avatar/58cce0c47d9c6efb7d83bc34b9d79816?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_506302" id="a7834320_506302"><a class="email disabled" href="/user_profile?user_id=506302" > <span class="fna">Gerry Chang [:gchang]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7834320_506302"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7834320_506302">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a7834320_506302">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-29 18:19 PST" data-time="1512008396">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=58%2B">58+</a></div></div></div><div class="change-set" id="c88"><div class="comment" data-id="12886438" data-no="88"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-88" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a7834320_506302"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a7834320_506302"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-88"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-88" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c88">Comment 88</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-30 05:40 PST" data-time="1512049206">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-88">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-88" data-comment-id="12886438"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/41372a007e11">https://hg.mozilla.org/releases/mozilla-beta/rev/41372a007e11</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c89"><div class="comment" data-id="12926589" data-no="89"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-89" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a7834320_506302"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a7834320_506302"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-89"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-89" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c89">Comment 89</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-19 06:32 PST" data-time="1513693927">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-89">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-89" data-comment-id="12926589">Looks like ESR52 needs rebasing around <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [regression] Spaces are folded when copying from urlbar"
   href="/show_bug.cgi?id=1402715">bug 1402715</a>.</pre><div class="activity"><div class="change">Flags: needinfo?(mak77)</div></div></div><div class="change-set" id="c90"><div class="comment" data-id="12944388" data-no="90"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-90" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a7834320_506302"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a7834320_506302"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-90"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-90" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c90">Comment 90</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-04 07:01 PST" data-time="1515078086">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-90">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8939853"
         class="attachment patch"
         data-id="8939853" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="esr.diff">
      <meta itemprop="contentSize" content="3373">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8939853">
          <a class="link" href="attachment.cgi?id=8939853&amp;action=diff">
        <span id="att-8939853-description" itemprop="description">esr52 patch</span></a>
        — <a href="attachment.cgi?id=8939853&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1395508&attachment=8939853">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-90" data-comment-id="12944388">This seems to pass tests on Try, the test is the same as in Nightly. It makes sense since <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [regression] Spaces are folded when copying from urlbar"
   href="/show_bug.cgi?id=1402715">bug 1402715</a> fixes a regression that happened in v53.
Ryan, could you please take care of landing it?</pre><div class="activity"><div class="change">Flags: needinfo?(mak77) &rarr; needinfo?(ryanvm)</div></div></div><div class="change-set" id="c91"><div class="comment" data-id="12947666" data-no="91"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-91" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a7834320_506302"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a7834320_506302"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-91"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-91" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c91">Comment 91</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-05 09:31 PST" data-time="1515173473">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-91">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-91" data-comment-id="12947666"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/263165eacc54">https://hg.mozilla.org/releases/mozilla-esr52/rev/263165eacc54</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: <span class="activity-deleted">needinfo?(ryanvm)</span></div></div></div><div class="change-set" id="a11958527_280903"><div class="change" id="aa11958527_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a11958527_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a11958527_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11958527_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11958527_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a11958527_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 11:56 PST" data-time="1516132603">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [fxsearch] &rarr; [fxsearch][adv-main58+][adv-esr52.6+]</div></div></div><div class="change-set" id="a11964322_280903"><div class="change" id="aa11964322_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a11964322_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a11964322_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11964322_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11964322_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a11964322_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 13:33 PST" data-time="1516138398">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-5117</div></div></div><div class="change-set" id="a12082759_452604"><div class="change" id="aa12082759_452604">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a12082759_452604"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_452604" id="a12082759_452604"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12082759_452604"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12082759_452604">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a12082759_452604">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 22:27 PST" data-time="1516256835">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [fxsearch][adv-main58+][adv-esr52.6+] &rarr; [fxsearch][adv-main58+][adv-esr52.6+][post-critsmash-triage]</div></div></div><div class="change-set" id="c92"><div class="comment" data-id="12986436" data-no="92"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-92" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_458188" id="a12082759_452604"><img src="https://secure.gravatar.com/avatar/8f3f8c3f93e13fdf486474e1382bf53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_458188" id="a12082759_452604"><a class="email " href="/user_profile?user_id=458188" > <span class="fna">PTO until 15th Nov [:bogdan_maris], Release Desktop QA</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-92"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-92" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c92">Comment 92</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-22 08:36 PST" data-time="1516639018">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-92">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-92" data-comment-id="12986436">I tried to reproduce and verify the fix of this issue. Based on <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c31">Comment 31</a>, I suppose that the fixed builds should displayed the real domain (سماء.شبكة). Compared with Chrome, where the real domain is always in focus, on Firefox the domain is displayed only at the end of the URL (can be seen only by using the horizontal scroll). Not sure what the fix should be here! Am I missing something?

Configuration used: 
- OS: Windows 10 x64, macOS 10.13.2
- Affected builds: 57.0a1 (2017-08-31), Release 57.0.4
- Fixed builds: Latest Nightly (2018-01-22), Beta 58.0b16</pre><div class="activity"><div class="change">Flags: needinfo?(mak77)</div></div></div><div class="change-set" id="c93"><div class="comment" data-id="12986502" data-no="93"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-93" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a12082759_452604"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_240353" id="a12082759_452604"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-93"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-93" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c93">Comment 93</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-22 08:49 PST" data-time="1516639745">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-93">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-93" data-comment-id="12986502">(In reply to Bogdan Maris, QA [:bogdan_maris] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c92">comment #92</a>)
<span class="quote">&gt; I tried to reproduce and verify the fix of this issue. Based on <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c31">Comment 31</a>,
&gt; I suppose that the fixed builds should displayed the real domain
&gt; (سماء.شبكة). Compared with Chrome, where the real domain is always in focus,
&gt; on Firefox the domain is displayed only at the end of the URL (can be seen
&gt; only by using the horizontal scroll). Not sure what the fix should be here!
&gt; Am I missing something?</span >

Yes, the &quot;always show domain&quot; fix didn't land here but has been moved to <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1419391">bug 1419391</a>, because the patch is fragile due to missing editor APIs and there's some discussion about a completely new approach for the Address Bar that would be less likely to suffer from spoofing attempts. That didn't happen yet.

What landed here is the patch that decodes multiple whitespaces when they are adjacent, that by itself makes the user less likely to fall for the spoofing attempt since there's no long empty space after the fake domain making it look good.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mak77)</span></div></div></div><div class="change-set" id="c94"><div class="comment" data-id="12988358" data-no="94"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-94" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_458188" id="a12082759_452604"><img src="https://secure.gravatar.com/avatar/8f3f8c3f93e13fdf486474e1382bf53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_458188" id="a12082759_452604"><a class="email " href="/user_profile?user_id=458188" > <span class="fna">PTO until 15th Nov [:bogdan_maris], Release Desktop QA</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-94"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-94" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#c94">Comment 94</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 02:30 PST" data-time="1516703437">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-94">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-94" data-comment-id="12988358">(In reply to Marco Bonardo [::mak] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox address bar spoof using RTL language and references"
   href="/show_bug.cgi?id=1395508#c93">comment #93</a>)
<span class="quote">&gt; What landed here is the patch that decodes multiple whitespaces when they
&gt; are adjacent, that by itself makes the user less likely to fall for the
&gt; spoofing attempt since there's no long empty space after the fake domain
&gt; making it look good.</span >

I retested this issue, by taking into account the information mentioned above, on latest Nightly 60.0a1 (2018-01-22) and on Release 58.06 - build 6 under Windows 10 x64, Ubuntu 12.04 x32 and macOS 10.13. I can mark this bug as verified fixed.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a16332114_434339"><div class="change" id="aa16332114_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a16332114_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a16332114_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a16332114_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a16332114_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a16332114_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-08 02:49 PST" data-time="1520506190">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="a16701007_1689"><div class="change" id="aa16701007_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a16701007_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a16701007_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a16701007_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a16701007_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a16701007_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-12 10:18 PDT" data-time="1520875083">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="a31347897_1689"><div class="change" id="aa31347897_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a31347897_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a31347897_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a31347897_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a31347897_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a31347897_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-28 22:52 PDT" data-time="1535521973">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="a35007058_240353"><div class="change" id="aa35007058_240353">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a35007058_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a35007058_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a35007058_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a35007058_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1395508#a35007058_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-10 07:18 PDT" data-time="1539181134">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE"
   href="/show_bug.cgi?id=1403812">1403812</a></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1395508&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>