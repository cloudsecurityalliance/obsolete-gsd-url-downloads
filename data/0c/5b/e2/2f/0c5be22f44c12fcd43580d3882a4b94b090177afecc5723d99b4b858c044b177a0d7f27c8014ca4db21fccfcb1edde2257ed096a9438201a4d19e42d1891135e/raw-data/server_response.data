<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>Cryptology ePrint Archive: Report 2017/806 - May the Fourth Be With You: A Microarchitectural Side Channel Attack on Several Real-World Applications of Curve25519</title>
<link rev="made" href="mailto:eprint-admin%40iacr.org" />
<meta content="Daniel Genkin" name="citation_author" />
<meta content="Luke Valenta" name="citation_author" />
<meta content="Yuval Yarom" name="citation_author" />
<meta viewport="initial-scale=1, width=device-width" />
<meta content="May the Fourth Be With You: A Microarchitectural Side Channel Attack on Several Real-World Applications of Curve25519" name="citation_title" />
<meta content="2017" name="citation_publication_date" />
<meta content="Cryptology ePrint Archive" name="citation_journal_title" />
<meta content="https://eprint.iacr.org/2017/806.pdf" name="citation_pdf_url" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body bgcolor="white">
<h2>Cryptology ePrint Archive: Report 2017/806</h2><p />
<p /><script type="text/javascript" 
src="/javascript/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">  
MathJax.Hub.Config({
extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"], 
jax: ["input/TeX", "output/HTML-CSS"], 
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ], 
displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
}, 
"HTML-CSS": { availableFonts: ["TeX"] }
}); 
</script>
<b>May  the  Fourth  Be  With  You:  A  Microarchitectural  Side  Channel  Attack  on  Several  Real-World  Applications  of  Curve25519</b><p />
<i>Daniel  Genkin   and  Luke  Valenta   and  Yuval  Yarom</i><p />
<b>Abstract: </b>In  recent  years,  applications  increasingly  adopt  security  primitives  designed  with  better  countermeasures  against  side  channel  attacks.  A  concrete  example  is  Libgcrypt's  implementation  of  ECDH  encryption  with  Curve25519.  The  implementation  employs  the  Montgomery  ladder  scalar-by-point  multiplication,  uses  the  unified,  branchless  Montgomery  double-and-add  formula   and  implements  a  constant-time  argument  swap  within  the  ladder.  However,  Libgcrypt's  field  arithmetic  operations  are  not  implemented  in  a  constant-time  side-channel-resistant  fashion.
<P>
Based  on  the  secure  design  of  Curve25519,  users  of  the  curve  are  advised  that  there  is  no  need  to  perform  validation  of  input  points.  In  this  work  we   demonstrate  that  when  this  recommendation  is  followed,  the  mathematical  structure  of  Curve25519  facilitates  the  exploitation  of  side-channel  weaknesses.
<P>
We  demonstrate  the  effect  of  this  vulnerability  on  three  software  applications---encrypted  git,  email   and  messaging---that  use  Libgcrypt.  In  each  case,  we  show  how  to  craft  malicious  OpenPGP  files  that  use  the  Curve25519  point  of  order 4  as  a  chosen  ciphertext  to  the  ECDH  encryption  scheme.  We  find  that  the  resulting  interactions  of  the  point  at  infinity,  order-2,   and  order-4  elements  in  the  Montgomery  ladder  scalar-by-point  multiplication  routine  create  side  channel  leakage  that  allows  us  to  recover  the  private  key  in  as  few  as 11  attempts  to  access  such  malicious  files.
<p />
<b>Category / Keywords: </b>implementation / Side Channel Attacks, Curve25519, Cache-Attacks, Flush+Reload, Order-4 Elements<p />
<b>Original Publication</b><b> (in the same form): </b>ACM Conference on Computer and Communications Security (CCS) 2017 
<b><BR>DOI: </b><a href="https://dx.doi.org/10.1145/3133956.3134029">10.1145/3133956.3134029<b></a></b>
<p />
<b>Date: </b>received 27 Aug 2017<p />
<b>Contact author: </b>danielg3 at cis upenn edu<p />
<b>Available format(s): </b><a href="/2017/806.pdf">PDF</a>  | <a href="/eprint-bin/cite.pl?entry=2017/806">BibTeX Citation</a>
<p />
<b>Version: </b><a href="/2017/806/20170828:151353">20170828:151353</a> (<a href="/eprint-bin/versions.pl?entry=2017/806">All versions of this report</a>)

<p />
<b>Short URL: </b><a href='https://ia.cr/2017/806'>ia.cr/2017/806</a>
<p /><hr />[ <a href="/">Cryptology ePrint archive</a> ]

</body>
</html>