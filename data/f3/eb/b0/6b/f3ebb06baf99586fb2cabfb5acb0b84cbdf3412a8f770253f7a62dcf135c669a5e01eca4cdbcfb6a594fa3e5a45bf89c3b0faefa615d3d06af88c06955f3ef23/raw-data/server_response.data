<!DOCTYPE html>
<html lang='en'>
<head>
<title>xorg/lib/libXrender - RENDER extension library  (mirrored from https://gitlab.freedesktop.org/xorg/lib/libxrender)</title>
<meta name='generator' content='cgit v1.2.1'/>
<meta name='robots' content='index, nofollow'/>
<link rel='stylesheet' type='text/css' href='https://cgit.freedesktop.org/cgit.css'/>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://cgit.freedesktop.org/xorg/lib/libXrender/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='https://gitlab.freedesktop.org/xorg/lib/libxrender' title='xorg/lib/libXrender Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='https://cgit.freedesktop.org/logo.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a title='xorg/lib/libXrender' href='/xorg/lib/libXrender/'>xorg/lib/libXrender</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='9362c7ddd1af3b168953d0737877bc52d79c94f4'/><select name='h' onchange='this.form.submit();'>
<option value='CYGWIN'>CYGWIN</option>
<option value='DAMAGE-XFIXES'>DAMAGE-XFIXES</option>
<option value='IPv6-REVIEW'>IPv6-REVIEW</option>
<option value='XACE-SELINUX'>XACE-SELINUX</option>
<option value='XORG-6_8-branch'>XORG-6_8-branch</option>
<option value='XORG-CURRENT'>XORG-CURRENT</option>
<option value='XORG-RELEASE-1'>XORG-RELEASE-1</option>
<option value='XORG-RELEASE-1-STSF'>XORG-RELEASE-1-STSF</option>
<option value='XORG-RELEASE-1-TM'>XORG-RELEASE-1-TM</option>
<option value='XORG-STABLE'>XORG-STABLE</option>
<option value='XPRINT'>XPRINT</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>RENDER extension library  (mirrored from https://gitlab.freedesktop.org/xorg/lib/libxrender)</td><td class='sub right'>keithp</td></tr></table>
<table class='tabs'><tr><td>
<a href='/xorg/lib/libXrender/'>summary</a><a href='/xorg/lib/libXrender/refs/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>refs</a><a href='/xorg/lib/libXrender/log/'>log</a><a href='/xorg/lib/libXrender/tree/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>tree</a><a class='active' href='/xorg/lib/libXrender/commit/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>commit</a><a href='/xorg/lib/libXrender/diff/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>diff</a></td><td class='form'><form class='right' method='get' action='/xorg/lib/libXrender/log/'>
<input type='hidden' name='id' value='9362c7ddd1af3b168953d0737877bc52d79c94f4'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='9362c7ddd1af3b168953d0737877bc52d79c94f4'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Tobias Stoeckmann &lt;tobias@stoeckmann.org&gt;</td><td class='right'>2016-09-25 21:43:09 +0200</td></tr>
<tr><th>committer</th><td>Matthieu Herrb &lt;matthieu@herrb.eu&gt;</td><td class='right'>2016-09-25 22:15:13 +0200</td></tr>
<tr><th>commit</th><td colspan='2' class='sha1'><a href='/xorg/lib/libXrender/commit/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>9362c7ddd1af3b168953d0737877bc52d79c94f4</a> (<a href='/xorg/lib/libXrender/patch/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='sha1'><a href='/xorg/lib/libXrender/tree/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>161248ef97b1095a96bb5e701b69f928a20d3bcc</a></td></tr>
<tr><th>parent</th><td colspan='2' class='sha1'><a href='/xorg/lib/libXrender/commit/?id=8fad00b0b647ee662ce4737ca15be033b7a21714'>8fad00b0b647ee662ce4737ca15be033b7a21714</a> (<a href='/xorg/lib/libXrender/diff/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4&amp;id2=8fad00b0b647ee662ce4737ca15be033b7a21714'>diff</a>)</td></tr></table>
<div class='commit-subject'>Validate lengths while parsing server data.</div><div class='commit-msg'>Individual lengths inside received server data can overflow
the previously reserved memory.

It is therefore important to validate every single length
field to not overflow the previously agreed sum of all invidual
length fields.

v2: consume remaining bytes in the reply buffer on error.

Signed-off-by: Tobias Stoeckmann &lt;tobias@stoeckmann.org&gt;
Reviewed-by: Matthieu Herrb@laas.fr
</div><div class='diffstat-header'><a href='/xorg/lib/libXrender/diff/?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/xorg/lib/libXrender/diff/src/Xrender.c?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>src/Xrender.c</a></td><td class='right'>18</td><td class='graph'><table summary='file diffstat' width='18%'><tr><td class='add' style='width: 100.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 18 insertions, 0 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/src/Xrender.c b/src/Xrender.c<br/>index 3102eb2..71cf3e6 100644<br/>--- a/<a href='/xorg/lib/libXrender/tree/src/Xrender.c?id=8fad00b0b647ee662ce4737ca15be033b7a21714'>src/Xrender.c</a><br/>+++ b/<a href='/xorg/lib/libXrender/tree/src/Xrender.c?id=9362c7ddd1af3b168953d0737877bc52d79c94f4'>src/Xrender.c</a></div><div class='hunk'>@@ -533,12 +533,30 @@ XRenderQueryFormats (Display *dpy)</div><div class='ctx'> 	screen-&gt;fallback = _XRenderFindFormat (xri, xScreen-&gt;fallback);</div><div class='ctx'> 	screen-&gt;subpixel = SubPixelUnknown;</div><div class='ctx'> 	xDepth = (xPictDepth *) (xScreen + 1);</div><div class='add'>+	if (screen-&gt;ndepths &gt; rep.numDepths) {</div><div class='add'>+	    Xfree (xri);</div><div class='add'>+	    Xfree (xData);</div><div class='add'>+	    _XEatDataWords (dpy, rep.length);</div><div class='add'>+	    UnlockDisplay (dpy);</div><div class='add'>+	    SyncHandle ();</div><div class='add'>+	    return 0;</div><div class='add'>+	}</div><div class='add'>+	rep.numDepths -= screen-&gt;ndepths;</div><div class='ctx'> 	for (nd = 0; nd &lt; screen-&gt;ndepths; nd++)</div><div class='ctx'> 	{</div><div class='ctx'> 	    depth-&gt;depth = xDepth-&gt;depth;</div><div class='ctx'> 	    depth-&gt;nvisuals = xDepth-&gt;nPictVisuals;</div><div class='ctx'> 	    depth-&gt;visuals = visual;</div><div class='ctx'> 	    xVisual = (xPictVisual *) (xDepth + 1);</div><div class='add'>+	    if (depth-&gt;nvisuals &gt; rep.numVisuals) {</div><div class='add'>+		Xfree (xri);</div><div class='add'>+		Xfree (xData);</div><div class='add'>+		_XEatDataWords (dpy, rep.length);</div><div class='add'>+		UnlockDisplay (dpy);</div><div class='add'>+		SyncHandle ();</div><div class='add'>+		return 0;</div><div class='add'>+	    }</div><div class='add'>+	    rep.numVisuals -= depth-&gt;nvisuals;</div><div class='ctx'> 	    for (nv = 0; nv &lt; depth-&gt;nvisuals; nv++)</div><div class='ctx'> 	    {</div><div class='ctx'> 		visual-&gt;visual = _XRenderFindVisual (dpy, xVisual-&gt;visual);</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit v1.2.1</a> (<a href='https://git-scm.com/'>git 2.18.0</a>) at 2021-10-30 22:00:20 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
