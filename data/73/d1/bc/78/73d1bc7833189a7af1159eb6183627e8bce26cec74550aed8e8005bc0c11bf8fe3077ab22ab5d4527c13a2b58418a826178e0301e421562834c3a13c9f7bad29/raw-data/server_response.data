<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#782450 - ppp: CVE-2015-3310: Buffer overflow in radius plugin - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=782450&quot;&gt;782450&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:782450@bugs.debian.org">#782450</a><br>
ppp: CVE-2015-3310: Buffer overflow in radius plugin</h1>
<div class="versiongraph"><a href="version.cgi?package=ppp;info=1;found=ppp%2F2.4.6-3;absolute=0;fixed=ppp%2F2.4.6-3.1;fixed=ppp%2F2.4.5-5.1%2Bdeb7u2;fixed=ppp%2F2.4.5-4%2Bdeb6u2;collapse=1"><img alt="version graph" src="version.cgi?package=ppp;found=ppp%2F2.4.6-3;absolute=0;height=2;fixed=ppp%2F2.4.6-3.1;fixed=ppp%2F2.4.5-5.1%2Bdeb7u2;fixed=ppp%2F2.4.5-4%2Bdeb6u2;width=2;collapse=1"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=ppp">ppp</a>;
Maintainer for <a href="pkgreport.cgi?package=ppp">ppp</a> is <a href="pkgreport.cgi?maint=bootc%40debian.org">Chris Boot &lt;bootc@debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=ppp">ppp</a> is <a href="pkgreport.cgi?src=ppp">src:ppp</a> (<a href="https://tracker.debian.org/pkg/ppp">PTS</a>, <a href="https://buildd.debian.org/ppp">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=ppp">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=ema%40linux.it">Emanuele Rocca &lt;ema@linux.it&gt;</a></p>
  <p>Date: Sun, 12 Apr 2015 12:21:07 UTC</p>

<p>Severity: important</p>
<p>Tags: patch, security</p>

<p>Found in version ppp/2.4.6-3</p>
<p>Fixed in versions ppp/2.4.6-3.1, ppp/2.4.5-5.1+deb7u2, ppp/2.4.5-4+deb6u2</p>

<p><strong>Done:</strong> Thorsten Alteholz &lt;debian@alteholz.de&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=782450;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1428841271 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Sun, 12 Apr 2015 12:21:11 GMT) (<a href="bugreport.cgi?bug=782450;msg=2">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1428841271 -->
<strong>Acknowledgement sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Sun, 12 Apr 2015 12:21:11 GMT) (<a href="bugreport.cgi?bug=782450;msg=4">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=5">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=5">mbox</a>, <a href="mailto:782450@bugs.debian.org?body=On%20Sun%2C%2012%20Apr%202015%2014%3A20%3A02%20%2B0200%20Emanuele%20Rocca%20%3Cema%40linux.it%3E%20wrote%3A%0A%3E%20Package%3A%20ppp%0A%3E%20Version%3A%202.4.6-3%0A%3E%20Severity%3A%20important%0A%3E%20Tags%3A%20patch%0A%3E%20%0A%3E%20On%20systems%20with%20more%20than%2065535%20processes%20running%2C%20pppd%20aborts%20when%0A%3E%20sending%20a%20%22start%22%20accounting%20message%20to%20the%20RADIUS%20server%20because%20of%20a%0A%3E%20buffer%20overflow%20in%20rc_mksid.%0A%3E%20%0A%3E%20The%20process%20id%20is%20used%20in%20rc_mksid%20to%20generate%20a%20pseudo-unique%20string%2C%0A%3E%20assuming%20that%20the%20hex%20representation%20of%20the%20pid%20will%20be%20at%20most%204%0A%3E%20characters%20%28FFFF%29.%20__sprintf_chk%28%29%2C%20used%20when%20compiling%20with%0A%3E%20optimization%20levels%20greater%20than%200%20and%20FORTIFY_SOURCE%2C%20detects%20the%0A%3E%20buffer%20overflow%20and%20makes%20pppd%20crash.%0A%3E%20%0A%3E%20The%20following%20patch%20fixes%20the%20problem.%0A%3E%20%0A%3E%20---%20ppp-2.4.6.orig%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%2B%2B%2B%20ppp-2.4.6%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%40%40%20-77%2C7%20%2B77%2C7%20%40%40%20rc_mksid%20%28void%29%0A%3E%20%20%20%20static%20unsigned%20short%20int%20cnt%20%3D%200%3B%0A%3E%20%20%20%20sprintf%20%28buf%2C%20%22%2508lX%2504X%2502hX%22%2C%0A%3E%20%20%09%20%20%20%28unsigned%20long%20int%29%20time%20%28NULL%29%2C%0A%3E%20-%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%2C%0A%3E%20%2B%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%20%25%2065535%2C%0A%3E%20%20%09%20%20%20cnt%20%26%200xFF%29%3B%0A%3E%20%20%20%20cnt%2B%2B%3B%0A%3E%20%20%20%20return%20buf%3B%0A%3E%20%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%208.0%0A%3E%20%20%20APT%20prefers%20testing%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27testing%27%29%0A%3E%20Architecture%3A%20amd64%20%28x86_64%29%0A%3E%20Foreign%20Architectures%3A%20i386%0A%3E%20%0A%3E%20Kernel%3A%20Linux%203.16.0-4-amd64%20%28SMP%20w%2F4%20CPU%20cores%29%0A%3E%20Locale%3A%20LANG%3Den_US.UTF-8%2C%20LC_CTYPE%3Den_US.UTF-8%20%28charmap%3DUTF-8%29%0A%3E%20Shell%3A%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fdash%0A%3E%20Init%3A%20systemd%20%28via%20%2Frun%2Fsystemd%2Fsystem%29%0A%3E%20%0A%3E%20Versions%20of%20packages%20ppp%20depends%20on%3A%0A%3E%20ii%20%20init-system-helpers%20%201.22%0A%3E%20ii%20%20libc6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.19-17%0A%3E%20ii%20%20libpam-modules%20%20%20%20%20%20%201.1.8-3.1%0A%3E%20ii%20%20libpam-runtime%20%20%20%20%20%20%201.1.8-3.1%0A%3E%20ii%20%20libpam0g%20%20%20%20%20%20%20%20%20%20%20%20%201.1.8-3.1%0A%3E%20ii%20%20libpcap0.8%20%20%20%20%20%20%20%20%20%20%201.6.2-2%0A%3E%20ii%20%20procps%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%3A3.3.9-9%0A%3E%20%0A%3E%20%0A&amp;References=%3C20150412122002.GA14475%40orion%3E&amp;In-Reply-To=%3C20150412122002.GA14475%40orion%3E&amp;subject=Re%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ema%40linux.it" alt="">
<div class="header"><span class="headerfield">From:</span> Emanuele Rocca &lt;ema@linux.it&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 12 Apr 2015 14:20:02 +0200</div>
</div>
<pre class="message">Package: ppp
Version: 2.4.6-3
Severity: important
Tags: patch

On systems with more than 65535 processes running, pppd aborts when
sending a &quot;start&quot; accounting message to the RADIUS server because of a
buffer overflow in rc_mksid.

The process id is used in rc_mksid to generate a pseudo-unique string,
assuming that the hex representation of the pid will be at most 4
characters (FFFF). __sprintf_chk(), used when compiling with
optimization levels greater than 0 and FORTIFY_SOURCE, detects the
buffer overflow and makes pppd crash.

The following patch fixes the problem.

--- ppp-2.4.6.orig/pppd/plugins/radius/util.c
+++ ppp-2.4.6/pppd/plugins/radius/util.c
@@ -77,7 +77,7 @@ rc_mksid (void)
   static unsigned short int cnt = 0;
   sprintf (buf, &quot;%08lX%04X%02hX&quot;,
 	   (unsigned long int) time (NULL),
-	   (unsigned int) getpid (),
+	   (unsigned int) getpid () % 65535,
 	   cnt &amp; 0xFF);
   cnt++;
   return buf;


-- System Information:
Debian Release: 8.0
  APT prefers testing
  APT policy: (500, &#39;testing&#39;)
Architecture: amd64 (x86_64)
Foreign Architectures: i386

Kernel: Linux 3.16.0-4-amd64 (SMP w/4 CPU cores)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)

Versions of packages ppp depends on:
ii  init-system-helpers  1.22
ii  libc6                2.19-17
ii  libpam-modules       1.1.8-3.1
ii  libpam-runtime       1.1.8-3.1
ii  libpam0g             1.1.8-3.1
ii  libpcap0.8           1.6.2-2
ii  procps               2:3.3.9-9


</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1428914524 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Mon, 13 Apr 2015 08:42:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=7">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1428914524 -->
<strong>Acknowledgement sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Mon, 13 Apr 2015 08:42:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=9">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=10">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=10">mbox</a>, <a href="mailto:782450@bugs.debian.org?References=%3CCAPxb4ZNhT8D_Geoy80RncT%2Bb4fG2Yu7tiKvW6Xr8rcf877oTXg%40mail.gmail.com%3E&amp;In-Reply-To=%3CCAPxb4ZNhT8D_Geoy80RncT%2Bb4fG2Yu7tiKvW6Xr8rcf877oTXg%40mail.gmail.com%3E&amp;subject=Re%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin&amp;body=On%20Mon%2C%2013%20Apr%202015%2010%3A38%3A42%20%2B0200%20Emanuele%20Rocca%20%3Cema%40linux.it%3E%20wrote%3A%0A%3E%20Correction%3A%20the%20bug%20occurs%20if%20pppd%27s%20pid%20is%20greater%20than%2065535.%20The%20number%0A%3E%20of%0A%3E%20running%20processes%20is%20irrelevant.%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ema%40linux.it" alt="">
<div class="header"><span class="headerfield">From:</span> Emanuele Rocca &lt;ema@linux.it&gt;</div>
<div class="header"><span class="headerfield">To:</span> 782450@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 13 Apr 2015 10:38:42 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=782450;msg=10">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Correction: the bug occurs if pppd&#39;s pid is greater than 65535. The number
of
running processes is irrelevant.
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=782450;msg=10">Message part 2</a> (text/html, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="11"></a>
<!-- command:tag -->
<!-- requester: Sebastien Delafond &lt;seb@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1428922988 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security patch&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;patch&#39;
            };
-->
<strong>Added tag(s) security.</strong>
Request was from <code>Sebastien Delafond &lt;seb@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Mon, 13 Apr 2015 11:03:08 GMT) (<a href="bugreport.cgi?bug=782450;msg=12">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1428994264 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 14 Apr 2015 06:51:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=14">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="15"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1428994264 -->
<strong>Acknowledgement sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Tue, 14 Apr 2015 06:51:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=16">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="17"></a><a name="msg17"></a><a href="#17">Message #17</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=17">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=17">mbox</a>, <a href="mailto:782450@bugs.debian.org?In-Reply-To=%3C20150414064815.GA28368%40orion%3E&amp;References=%3C20150412122002.GA14475%40orion%3E%0A%20%3C20150414064815.GA28368%40orion%3E&amp;subject=Re%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin&amp;body=On%20Tue%2C%2014%20Apr%202015%2008%3A48%3A15%20%2B0200%20Emanuele%20Rocca%20%3Cema%40linux.it%3E%20wrote%3A%0A%3E%20NMU%20diff%20attached.%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ema%40linux.it" alt="">
<div class="header"><span class="headerfield">From:</span> Emanuele Rocca &lt;ema@linux.it&gt;</div>
<div class="header"><span class="headerfield">To:</span> 782450@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 08:48:15 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=782450;msg=17">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message wrapping">NMU diff attached.
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=782450;filename=ppp_2.4.6-3.1-nmu.diff;msg=17">ppp_2.4.6-3.1-nmu.diff</a> (text/x-diff, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="18"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@debian.org&gt; -->
<!-- time:1428995169 -->
<strong>Reply sent</strong>
to <code>Emanuele Rocca &lt;ema@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Tue, 14 Apr 2015 07:06:09 GMT) (<a href="bugreport.cgi?bug=782450;msg=19">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="20"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1428995169 -->
<strong>Notification sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
Bug acknowledged by developer.
 (Tue, 14 Apr 2015 07:06:09 GMT) (<a href="bugreport.cgi?bug=782450;msg=21">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="22"></a><a name="msg22"></a><a href="#22">Message #22</a> received at 782450-close@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=22">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=22">mbox</a>, <a href="mailto:782450@bugs.debian.org?body=On%20Tue%2C%2014%20Apr%202015%2007%3A03%3A46%20%2B0000%20Emanuele%20Rocca%20%3Cema%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20ppp%0A%3E%20Source-Version%3A%202.4.6-3.1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20ppp%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20782450%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Emanuele%20Rocca%20%3Cema%40debian.org%3E%20%28supplier%20of%20updated%20ppp%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA256%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Tue%2C%2014%20Apr%202015%2008%3A18%3A06%20%2B0200%0A%3E%20Source%3A%20ppp%0A%3E%20Binary%3A%20ppp%20ppp-udeb%20ppp-dev%0A%3E%20Architecture%3A%20source%20amd64%20all%0A%3E%20Version%3A%202.4.6-3.1%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Marco%20d%27Itri%20%3Cmd%40linux.it%3E%0A%3E%20Changed-By%3A%20Emanuele%20Rocca%20%3Cema%40debian.org%3E%0A%3E%20Description%3A%0A%3E%20%20ppp%20%20%20%20%20%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20daemon%0A%3E%20%20ppp-dev%20%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20development%20files%0A%3E%20%20ppp-udeb%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20package%20for%20Debian%20Installer%20%28udeb%29%0A%3E%20Closes%3A%20782450%0A%3E%20Changes%3A%0A%3E%20%20ppp%20%282.4.6-3.1%29%20unstable%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Non-maintainer%20upload.%0A%3E%20%20%20%20%2A%20Urgency%20high%20due%20to%20fix%20for%20DoS%20vulnerability.%0A%3E%20%20%20%20%2A%20Fix%20buffer%20overflow%20in%20rc_mksid%28%29.%0A%3E%20%20%20%20%20%20The%20function%20converts%20the%20PID%20of%20pppd%20to%20hex%20to%20generate%20a%20pseudo-unique%0A%3E%20%20%20%20%20%20string.%20If%20the%20process%20id%20is%20bigger%20than%2065535%20%28FFFF%29%2C%20its%20hex%0A%3E%20%20%20%20%20%20representation%20will%20be%20longer%20than%204%20characters%2C%20resulting%20in%20a%20buffer%0A%3E%20%20%20%20%20%20overflow.%20This%20bug%20can%20be%20exploited%20to%20cause%20a%20remote%20DoS.%0A%3E%20%20%20%20%20%20%28Closes%3A%20%23782450%29%0A%3E%20Checksums-Sha1%3A%0A%3E%20%202b12c44afe616cee58c0c7dd1dab270b8d425b3a%201992%20ppp_2.4.6-3.1.dsc%0A%3E%20%20f723145993142936e88be3b14600f2e1092bba65%2092212%20ppp_2.4.6-3.1.debian.tar.xz%0A%3E%20%20faba372c7ae3306f15c947f165093efe37a70116%20337520%20ppp_2.4.6-3.1_amd64.deb%0A%3E%20%2072e35519b96e8ede48fa2e5706e578b2f5df63b9%20120564%20ppp-udeb_2.4.6-3.1_amd64.udeb%0A%3E%20%202f159bc6d8a86b1c91659252c4e1b93a105329ff%2055022%20ppp-dev_2.4.6-3.1_all.deb%0A%3E%20Checksums-Sha256%3A%0A%3E%20%20885c3aeae3fc9ef8bb3217f2fd623bd86596850d6d145d4ed30b1eba12c10cc8%201992%20ppp_2.4.6-3.1.dsc%0A%3E%20%20695095daa7efddff5332139d92d1514ca7e1079cfba146bb9e3c70feda52cd2d%2092212%20ppp_2.4.6-3.1.debian.tar.xz%0A&amp;subject=Re%3A%20Bug%23782450%3A%20fixed%20in%20ppp%202.4.6-3.1&amp;In-Reply-To=%3CE1Yhuss-0001du-6K%40franck.debian.org%3E&amp;References=%3CE1Yhuss-0001du-6K%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ema%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Emanuele Rocca &lt;ema@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 782450-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#782450: fixed in ppp 2.4.6-3.1</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 07:03:46 +0000</div>
</div>
<pre class="message">Source: ppp
Source-Version: 2.4.6-3.1

We believe that the bug you reported is fixed in the latest version of
ppp, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 782450@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Emanuele Rocca &lt;ema@debian.org&gt; (supplier of updated ppp package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Tue, 14 Apr 2015 08:18:06 +0200
Source: ppp
Binary: ppp ppp-udeb ppp-dev
Architecture: source amd64 all
Version: 2.4.6-3.1
Distribution: unstable
Urgency: high
Maintainer: Marco d&#39;Itri &lt;md@linux.it&gt;
Changed-By: Emanuele Rocca &lt;ema@debian.org&gt;
Description:
 ppp        - Point-to-Point Protocol (PPP) - daemon
 ppp-dev    - Point-to-Point Protocol (PPP) - development files
 ppp-udeb   - Point-to-Point Protocol (PPP) - package for Debian Installer (udeb)
Closes: <a href="bugreport.cgi?bug=782450">782450</a>
Changes:
 ppp (2.4.6-3.1) unstable; urgency=high
 .
   * Non-maintainer upload.
   * Urgency high due to fix for DoS vulnerability.
   * Fix buffer overflow in rc_mksid().
     The function converts the PID of pppd to hex to generate a pseudo-unique
     string. If the process id is bigger than 65535 (FFFF), its hex
     representation will be longer than 4 characters, resulting in a buffer
     overflow. This bug can be exploited to cause a remote DoS.
     (Closes: #<a href="bugreport.cgi?bug=782450">782450</a>)
Checksums-Sha1:
 2b12c44afe616cee58c0c7dd1dab270b8d425b3a 1992 ppp_2.4.6-3.1.dsc
 f723145993142936e88be3b14600f2e1092bba65 92212 ppp_2.4.6-3.1.debian.tar.xz
 faba372c7ae3306f15c947f165093efe37a70116 337520 ppp_2.4.6-3.1_amd64.deb
 72e35519b96e8ede48fa2e5706e578b2f5df63b9 120564 ppp-udeb_2.4.6-3.1_amd64.udeb
 2f159bc6d8a86b1c91659252c4e1b93a105329ff 55022 ppp-dev_2.4.6-3.1_all.deb
Checksums-Sha256:
 885c3aeae3fc9ef8bb3217f2fd623bd86596850d6d145d4ed30b1eba12c10cc8 1992 ppp_2.4.6-3.1.dsc
 695095daa7efddff5332139d92d1514ca7e1079cfba146bb9e3c70feda52cd2d 92212 ppp_2.4.6-3.1.debian.tar.xz
 37c6a39aaa897490e74114bbf12f0d2edcba804904df31e170a4fcb937ec7fcc 337520 ppp_2.4.6-3.1_amd64.deb
 bc3e6817dce2c34c8f59e7b48cd0dfb0476c9c2c68af4724accf9629d5205647 120564 ppp-udeb_2.4.6-3.1_amd64.udeb
 ed362defdc88f1ce66fd9c2ab4054f29cc121d42f7d04d31c604f997a23fd21d 55022 ppp-dev_2.4.6-3.1_all.deb
Files:
 deadef2597e0abf924b2755929a982ee 1992 admin optional ppp_2.4.6-3.1.dsc
 82f8a21b47900d7e8ce0ea95ae1d741d 92212 admin optional ppp_2.4.6-3.1.debian.tar.xz
 1fcbf02cea6381fd0e899a320a9d95a0 337520 admin optional ppp_2.4.6-3.1_amd64.deb
 7c62e225e99719e2fc96683667888e25 120564 debian-installer optional ppp-udeb_2.4.6-3.1_amd64.udeb
 03abea2a2bade9ab4da60c6ef69e96d2 55022 devel extra ppp-dev_2.4.6-3.1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJVLLalAAoJENUIWgdQ/bejaoIQAJIBTLNHeUmcXFm2dLyHEy44
KTSQQbzmN6k2OSdBxEEDwO2UC4KOCFNKtBlHc62aJhz8trykUkZlB/9x3uhRMxAM
0LgeMkvDe3Y16RboQHfZaH46W2EUBd0AF31BUMlW2/FRBZ2bdf/Wfl//1bPWYQxl
8969pcl6qXw9N5PKpQCFFZCPn0DVWoBLcgrmlyCCnRyfxkYhUVMFaHQE1j8pOFl/
yQY0afDvq9MOmhq9QZfexhdybRvLi8Rs8bpZlt9acKfMVD5gMf/1uhsM+W8VN02W
612qf3zO5grMKJq9AyuVQnuZZ/fdIHtTixK0Akq2YS5LcktqF4TnsGQgi12Ug/rd
og5EpPGZWNblzNxnHbVUEY/qBXyeOOWSgS7LgHe0ABpQY1yZOzDJboT4ODgChrL/
Prhd+Mz89tf/PnNeXEsufX346NQIjZ6g0wHiu7y4ilJpQbXzDOMEhUBH8n/gupf4
X1QKwWCAp1l81DIBoeV7pNnosMSS6aSsNuMHy78vFU/iBwOqmPwijO8pidWJaRzJ
a5W++2iQWYRNM0bB5ucWlD1BD+Nhs+2b0CrDjUk2zXuKzOKSSAshDZ2b9bAk5iE1
/OwsHHg7UGC1D9dhNhpNzvCVozfx6xe1dLEMLcgrnJGRqUVbDNgzrYRwHf4PJOi/
+lAaGJQoJWXjXY/z45B8
=gzqy
-----END PGP SIGNATURE-----



</pre>

<div class="infmessage"><hr><p>
<a name="23"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1429010104 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 14 Apr 2015 11:15:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=24">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="25"></a>
<!-- request_addr: Roger Lynn &lt;RLynn@fundamentalsltd.co.uk&gt; -->
<!-- time:1429010104 -->
<strong>Acknowledgement sent</strong>
to <code>Roger Lynn &lt;RLynn@fundamentalsltd.co.uk&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Tue, 14 Apr 2015 11:15:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=26">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="27"></a><a name="msg27"></a><a href="#27">Message #27</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=27">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=27">mbox</a>, <a href="mailto:782450@bugs.debian.org?In-Reply-To=%3C552CF653.5040406%40fundamentalsltd.co.uk%3E&amp;References=%3C20150412122002.GA14475%40orion%3E%20%3C20150414064815.GA28368%40orion%3E%0A%20%3C552CF653.5040406%40fundamentalsltd.co.uk%3E&amp;subject=Re%3A%20Bug%23782450%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin&amp;body=On%20Tue%2C%2014%20Apr%202015%2012%3A13%3A23%20%2B0100%20Roger%20Lynn%20%3CRLynn%40fundamentalsltd.co.uk%3E%20wrote%3A%0A%3E%20On%2014%2F04%2F2015%2007%3A48%2C%20Emanuele%20Rocca%20wrote%3A%0A%3E%20%3E%20NMU%20diff%20attached.%0A%3E%20%0A%3E%20%0A%3E%20%3E%20ppp_2.4.6-3.1-nmu.diff%0A%3E%20%0A%3E%20%3E%20diff%20-Nru%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%0A%3E%20%3E%20---%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%091970-01-01%2001%3A00%3A00.000000000%20%2B0100%0A%3E%20%3E%20%2B%2B%2B%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%092015-04-14%2008%3A27%3A53.000000000%20%2B0200%0A%3E%20%3E%20%40%40%20-0%2C0%20%2B1%2C23%20%40%40%0A%3E%20%3E%20%2BDescription%3A%20Fix%20buffer%20overflow%20in%20rc_mksid%28%29%0A%3E%20%3E%20%2B%20rc_mksid%20converts%20the%20PID%20of%20pppd%20to%20hex%20to%20generate%20a%20pseudo-unique%20string.%0A%3E%20%3E%20%2B%20.%0A%3E%20%3E%20%2B%20If%20the%20process%20id%20is%20bigger%20than%2065535%20%28FFFF%29%2C%20its%20hex%20representation%20will%20be%0A%3E%20%3E%20%2B%20longer%20than%204%20characters%2C%20resulting%20in%20a%20buffer%20overflow.%0A%3E%20%3E%20%2B%20.%0A%3E%20%3E%20%2B%20The%20bug%20can%20be%20exploited%20to%20cause%20a%20remote%20DoS.%0A%3E%20%3E%20%2B%20.%0A%3E%20%3E%20%2BAuthor%3A%20Emanuele%20Rocca%20%3Cema%40debian.org%3E%0A%3E%20%3E%20%2BBug-Debian%3A%20https%3A%2F%2Fbugs.debian.org%2F782450%0A%3E%20%3E%20%2BLast-Update%3A%20%3C2015-04-14%3E%0A%3E%20%3E%20%2B%0A%3E%20%3E%20%2B---%20ppp-2.4.6.orig%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%2B%2B%2B%2B%20ppp-2.4.6%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%2B%40%40%20-77%2C7%20%2B77%2C7%20%40%40%20rc_mksid%20%28void%29%0A%3E%20%3E%20%2B%20%20%20static%20unsigned%20short%20int%20cnt%20%3D%200%3B%0A%3E%20%3E%20%2B%20%20%20sprintf%20%28buf%2C%20%22%2508lX%2504X%2502hX%22%2C%0A%3E%20%3E%20%2B%20%09%20%20%20%28unsigned%20long%20int%29%20time%20%28NULL%29%2C%0A%3E%20%3E%20%2B-%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%2C%0A%3E%20%3E%20%2B%2B%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%20%25%2065535%2C%0A%3E%20%0A%3E%20Shouldn%27t%20this%20be%2065536%3F%20If%20you%27re%20trying%20to%20limit%20to%200xFFFF%20then%2065535%20%20too%0A%3E%20small.%20%22getpid%20%28%29%20%26%200xFFFF%22%20might%20be%20clearer%20than%20using%20the%20modulus%20operator%0A%3E%20and%20should%20have%20exactly%20the%20same%20effect.%0A%3E%20%0A%3E%20%3E%20%2B%20%09%20%20%20cnt%20%26%200xFF%29%3B%0A%3E%20%3E%20%2B%20%20%20cnt%2B%2B%3B%0A%3E%20%3E%20%2B%20%20%20return%20buf%3B%0A%3E%20%0A%3E%20%0A%3E%20Roger%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=RLynn%40fundamentalsltd.co.uk" alt="">
<div class="header"><span class="headerfield">From:</span> Roger Lynn &lt;RLynn@fundamentalsltd.co.uk&gt;</div>
<div class="header"><span class="headerfield">To:</span> Emanuele Rocca &lt;ema@linux.it&gt;, &lt;782450@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#782450: ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 12:13:23 +0100</div>
</div>
<pre class="message">On 14/04/2015 07:48, Emanuele Rocca wrote:
&gt; NMU diff attached.


&gt; ppp_2.4.6-3.1-nmu.diff

&gt; diff -Nru ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow
&gt; --- ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow	1970-01-01 01:00:00.000000000 +0100
&gt; +++ ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow	2015-04-14 08:27:53.000000000 +0200
&gt; @@ -0,0 +1,23 @@
&gt; +Description: Fix buffer overflow in rc_mksid()
&gt; + rc_mksid converts the PID of pppd to hex to generate a pseudo-unique string.
&gt; + .
&gt; + If the process id is bigger than 65535 (FFFF), its hex representation will be
&gt; + longer than 4 characters, resulting in a buffer overflow.
&gt; + .
&gt; + The bug can be exploited to cause a remote DoS.
&gt; + .
&gt; +Author: Emanuele Rocca &lt;ema@debian.org&gt;
&gt; +Bug-Debian: <a href="https://bugs.debian.org/782450">https://bugs.debian.org/782450</a>
&gt; +Last-Update: &lt;2015-04-14&gt;
&gt; +
&gt; +--- ppp-2.4.6.orig/pppd/plugins/radius/util.c
&gt; ++++ ppp-2.4.6/pppd/plugins/radius/util.c
&gt; +@@ -77,7 +77,7 @@ rc_mksid (void)
&gt; +   static unsigned short int cnt = 0;
&gt; +   sprintf (buf, &quot;%08lX%04X%02hX&quot;,
&gt; + 	   (unsigned long int) time (NULL),
&gt; +-	   (unsigned int) getpid (),
&gt; ++	   (unsigned int) getpid () % 65535,

Shouldn&#39;t this be 65536? If you&#39;re trying to limit to 0xFFFF then 65535  too
small. &quot;getpid () &amp; 0xFFFF&quot; might be clearer than using the modulus operator
and should have exactly the same effect.

&gt; + 	   cnt &amp; 0xFF);
&gt; +   cnt++;
&gt; +   return buf;


Roger


</pre>

<div class="infmessage"><hr><p>
<a name="28"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1429011556 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 14 Apr 2015 11:39:16 GMT) (<a href="bugreport.cgi?bug=782450;msg=29">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="30"></a>
<!-- request_addr: Roger Lynn &lt;Roger@rilynn.me.uk&gt; -->
<!-- time:1429011556 -->
<strong>Acknowledgement sent</strong>
to <code>Roger Lynn &lt;Roger@rilynn.me.uk&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Tue, 14 Apr 2015 11:39:16 GMT) (<a href="bugreport.cgi?bug=782450;msg=31">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="32"></a><a name="msg32"></a><a href="#32">Message #32</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=32">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=32">mbox</a>, <a href="mailto:782450@bugs.debian.org?In-Reply-To=%3C552CF65C.1040102%40rilynn.me.uk%3E&amp;References=%3C20150412122002.GA14475%40orion%3E%20%3C20150414064815.GA28368%40orion%3E%0A%20%3C552CF65C.1040102%40rilynn.me.uk%3E&amp;subject=Re%3A%20Bug%23782450%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin&amp;body=On%20Tue%2C%2014%20Apr%202015%2012%3A13%3A32%20%2B0100%20Roger%20Lynn%20%3CRoger%40rilynn.me.uk%3E%20wrote%3A%0A%3E%20On%2014%2F04%2F2015%2007%3A48%2C%20Emanuele%20Rocca%20wrote%3A%0A%3E%20%3E%20NMU%20diff%20attached.%0A%3E%20%0A%3E%20%0A%3E%20%3E%20ppp_2.4.6-3.1-nmu.diff%0A%3E%20%0A%3E%20%3E%20diff%20-Nru%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%0A%3E%20%3E%20---%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%091970-01-01%2001%3A00%3A00.000000000%20%2B0100%0A%3E%20%3E%20%2B%2B%2B%20ppp-2.4.6%2Fdebian%2Fpatches%2Frc_mksid-no-buffer-overflow%092015-04-14%2008%3A27%3A53.000000000%20%2B0200%0A%3E%20%3E%20%40%40%20-0%2C0%20%2B1%2C23%20%40%40%0A%3E%20%3E%20%2BDescription%3A%20Fix%20buffer%20overflow%20in%20rc_mksid%28%29%0A%3E%20%3E%20%2B%20rc_mksid%20converts%20the%20PID%20of%20pppd%20to%20hex%20to%20generate%20a%20pseudo-unique%20string.%0A%3E%20%3E%20%2B%20.%0A%3E%20%3E%20%2B%20If%20the%20process%20id%20is%20bigger%20than%2065535%20%28FFFF%29%2C%20its%20hex%20representation%20will%20be%0A%3E%20%3E%20%2B%20longer%20than%204%20characters%2C%20resulting%20in%20a%20buffer%20overflow.%0A%3E%20%3E%20%2B%20.%0A%3E%20%3E%20%2B%20The%20bug%20can%20be%20exploited%20to%20cause%20a%20remote%20DoS.%0A%3E%20%3E%20%2B%20.%0A%3E%20%3E%20%2BAuthor%3A%20Emanuele%20Rocca%20%3Cema%40debian.org%3E%0A%3E%20%3E%20%2BBug-Debian%3A%20https%3A%2F%2Fbugs.debian.org%2F782450%0A%3E%20%3E%20%2BLast-Update%3A%20%3C2015-04-14%3E%0A%3E%20%3E%20%2B%0A%3E%20%3E%20%2B---%20ppp-2.4.6.orig%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%2B%2B%2B%2B%20ppp-2.4.6%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%2B%40%40%20-77%2C7%20%2B77%2C7%20%40%40%20rc_mksid%20%28void%29%0A%3E%20%3E%20%2B%20%20%20static%20unsigned%20short%20int%20cnt%20%3D%200%3B%0A%3E%20%3E%20%2B%20%20%20sprintf%20%28buf%2C%20%22%2508lX%2504X%2502hX%22%2C%0A%3E%20%3E%20%2B%20%09%20%20%20%28unsigned%20long%20int%29%20time%20%28NULL%29%2C%0A%3E%20%3E%20%2B-%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%2C%0A%3E%20%3E%20%2B%2B%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%20%25%2065535%2C%0A%3E%20%0A%3E%20Shouldn%27t%20this%20be%2065536%3F%20If%20you%27re%20trying%20to%20limit%20to%200xFFFF%20then%2065535%20%20too%0A%3E%20small.%20%22getpid%20%28%29%20%26%200xFFFF%22%20might%20be%20clearer%20than%20using%20the%20modulus%20operator%0A%3E%20and%20should%20have%20exactly%20the%20same%20effect.%0A%3E%20%0A%3E%20%3E%20%2B%20%09%20%20%20cnt%20%26%200xFF%29%3B%0A%3E%20%3E%20%2B%20%20%20cnt%2B%2B%3B%0A%3E%20%3E%20%2B%20%20%20return%20buf%3B%0A%3E%20%0A%3E%20%0A%3E%20Roger%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=Roger%40rilynn.me.uk" alt="">
<div class="header"><span class="headerfield">From:</span> Roger Lynn &lt;Roger@rilynn.me.uk&gt;</div>
<div class="header"><span class="headerfield">To:</span> Emanuele Rocca &lt;ema@linux.it&gt;, 782450@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#782450: ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 12:13:32 +0100</div>
</div>
<pre class="message">On 14/04/2015 07:48, Emanuele Rocca wrote:
&gt; NMU diff attached.


&gt; ppp_2.4.6-3.1-nmu.diff

&gt; diff -Nru ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow
&gt; --- ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow	1970-01-01 01:00:00.000000000 +0100
&gt; +++ ppp-2.4.6/debian/patches/rc_mksid-no-buffer-overflow	2015-04-14 08:27:53.000000000 +0200
&gt; @@ -0,0 +1,23 @@
&gt; +Description: Fix buffer overflow in rc_mksid()
&gt; + rc_mksid converts the PID of pppd to hex to generate a pseudo-unique string.
&gt; + .
&gt; + If the process id is bigger than 65535 (FFFF), its hex representation will be
&gt; + longer than 4 characters, resulting in a buffer overflow.
&gt; + .
&gt; + The bug can be exploited to cause a remote DoS.
&gt; + .
&gt; +Author: Emanuele Rocca &lt;ema@debian.org&gt;
&gt; +Bug-Debian: <a href="https://bugs.debian.org/782450">https://bugs.debian.org/782450</a>
&gt; +Last-Update: &lt;2015-04-14&gt;
&gt; +
&gt; +--- ppp-2.4.6.orig/pppd/plugins/radius/util.c
&gt; ++++ ppp-2.4.6/pppd/plugins/radius/util.c
&gt; +@@ -77,7 +77,7 @@ rc_mksid (void)
&gt; +   static unsigned short int cnt = 0;
&gt; +   sprintf (buf, &quot;%08lX%04X%02hX&quot;,
&gt; + 	   (unsigned long int) time (NULL),
&gt; +-	   (unsigned int) getpid (),
&gt; ++	   (unsigned int) getpid () % 65535,

Shouldn&#39;t this be 65536? If you&#39;re trying to limit to 0xFFFF then 65535  too
small. &quot;getpid () &amp; 0xFFFF&quot; might be clearer than using the modulus operator
and should have exactly the same effect.

&gt; + 	   cnt &amp; 0xFF);
&gt; +   cnt++;
&gt; +   return buf;


Roger


</pre>

<div class="infmessage"><hr><p>
<a name="33"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1429019110 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 14 Apr 2015 13:45:10 GMT) (<a href="bugreport.cgi?bug=782450;msg=34">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=34">mbox</a>, <a href="#33">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="35"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1429019110 -->
<strong>Acknowledgement sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Tue, 14 Apr 2015 13:45:10 GMT) (<a href="bugreport.cgi?bug=782450;msg=36">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=36">mbox</a>, <a href="#35">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="37"></a><a name="msg37"></a><a href="#37">Message #37</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=37">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=37">mbox</a>, <a href="mailto:782450@bugs.debian.org?References=%3C20150412122002.GA14475%40orion%3E%0A%20%3C20150414064815.GA28368%40orion%3E%0A%20%3C552CF65C.1040102%40rilynn.me.uk%3E%0A%20%3C20150414134248.GA4865%40aspi%3E&amp;In-Reply-To=%3C20150414134248.GA4865%40aspi%3E&amp;subject=Re%3A%20Bug%23782450%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin&amp;body=On%20Tue%2C%2014%20Apr%202015%2015%3A42%3A48%20%2B0200%20Emanuele%20Rocca%20%3Cema%40linux.it%3E%20wrote%3A%0A%3E%20Hi%20Roger%2C%0A%3E%20%0A%3E%20On%2014%2F04%2012%3A13%2C%20Roger%20Lynn%20wrote%3A%0A%3E%20%3E%20On%2014%2F04%2F2015%2007%3A48%2C%20Emanuele%20Rocca%20wrote%3A%0A%3E%20%3E%20%3E%20%2B---%20ppp-2.4.6.orig%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%3E%20%2B%2B%2B%2B%20ppp-2.4.6%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%3E%20%2B%40%40%20-77%2C7%20%2B77%2C7%20%40%40%20rc_mksid%20%28void%29%0A%3E%20%3E%20%3E%20%2B%20%20%20static%20unsigned%20short%20int%20cnt%20%3D%200%3B%0A%3E%20%3E%20%3E%20%2B%20%20%20sprintf%20%28buf%2C%20%22%2508lX%2504X%2502hX%22%2C%0A%3E%20%3E%20%3E%20%2B%20%09%20%20%20%28unsigned%20long%20int%29%20time%20%28NULL%29%2C%0A%3E%20%3E%20%3E%20%2B-%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%2C%0A%3E%20%3E%20%3E%20%2B%2B%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%20%25%2065535%2C%0A%3E%20%3E%20%0A%3E%20%3E%20Shouldn%27t%20this%20be%2065536%3F%20If%20you%27re%20trying%20to%20limit%20to%200xFFFF%20then%2065535%20%20too%0A%3E%20%3E%20small.%20%22getpid%20%28%29%20%26%200xFFFF%22%20might%20be%20clearer%20than%20using%20the%20modulus%20operator%0A%3E%20%3E%20and%20should%20have%20exactly%20the%20same%20effect.%0A%3E%20%0A%3E%20Good%20catch%21%20You%20are%20right%2C%20the%20patch%20limits%20to%200xFFFE%20instead%20of%200xFFFF.%0A%3E%20%0A%3E%20However%20it%20does%20fix%20the%20vulnerability%2C%20so%20I%20don%27t%20think%20a%20new%20upload%20is%0A%3E%20required.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20%20ema%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ema%40linux.it" alt="">
<div class="header"><span class="headerfield">From:</span> Emanuele Rocca &lt;ema@linux.it&gt;</div>
<div class="header"><span class="headerfield">To:</span> Roger Lynn &lt;Roger@rilynn.me.uk&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 782450@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#782450: ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 15:42:48 +0200</div>
</div>
<pre class="message">Hi Roger,

On 14/04 12:13, Roger Lynn wrote:
&gt; On 14/04/2015 07:48, Emanuele Rocca wrote:
&gt; &gt; +--- ppp-2.4.6.orig/pppd/plugins/radius/util.c
&gt; &gt; ++++ ppp-2.4.6/pppd/plugins/radius/util.c
&gt; &gt; +@@ -77,7 +77,7 @@ rc_mksid (void)
&gt; &gt; +   static unsigned short int cnt = 0;
&gt; &gt; +   sprintf (buf, &quot;%08lX%04X%02hX&quot;,
&gt; &gt; + 	   (unsigned long int) time (NULL),
&gt; &gt; +-	   (unsigned int) getpid (),
&gt; &gt; ++	   (unsigned int) getpid () % 65535,
&gt; 
&gt; Shouldn&#39;t this be 65536? If you&#39;re trying to limit to 0xFFFF then 65535  too
&gt; small. &quot;getpid () &amp; 0xFFFF&quot; might be clearer than using the modulus operator
&gt; and should have exactly the same effect.

Good catch! You are right, the patch limits to 0xFFFE instead of 0xFFFF.

However it does fix the vulnerability, so I don&#39;t think a new upload is
required.

Cheers,
  ema


</pre>

<div class="infmessage"><hr><p>
<a name="38"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1429023068 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 14 Apr 2015 14:51:08 GMT) (<a href="bugreport.cgi?bug=782450;msg=39">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=39">mbox</a>, <a href="#38">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="40"></a>
<!-- request_addr: Raphael Hertzog &lt;hertzog@debian.org&gt; -->
<!-- time:1429023068 -->
<strong>Acknowledgement sent</strong>
to <code>Raphael Hertzog &lt;hertzog@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Tue, 14 Apr 2015 14:51:08 GMT) (<a href="bugreport.cgi?bug=782450;msg=41">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=41">mbox</a>, <a href="#40">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="42"></a><a name="msg42"></a><a href="#42">Message #42</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=42">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=42">mbox</a>, <a href="mailto:782450@bugs.debian.org?body=On%20Tue%2C%2014%20Apr%202015%2016%3A47%3A05%20%2B0200%20Raphael%20Hertzog%20%3Chertzog%40debian.org%3E%20wrote%3A%0A%3E%20Hello%20Marco%20%26%20Emanuele%2C%0A%3E%20%0A%3E%20the%20Debian%20LTS%20team%20would%20like%20to%20fix%20the%20security%20issues%20which%20are%0A%3E%20currently%20open%20in%20the%20Squeeze%20version%20of%20ppp%3A%0A%3E%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2Fsource-package%2Fppp%0A%3E%20%0A%3E%20Would%20you%20like%20to%20take%20care%20of%20this%20yourself%3F%20We%20are%20still%20understaffed%20so%0A%3E%20any%20help%20is%20always%20highly%20appreciated.%0A%3E%20%0A%3E%20If%20yes%2C%20please%20follow%20the%20workflow%20we%20have%20defined%20here%3A%0A%3E%20http%3A%2F%2Fwiki.debian.org%2FLTS%2FDevelopment%0A%3E%20%0A%3E%20If%20that%20workflow%20is%20a%20burden%20to%20you%2C%20feel%20free%20to%20just%20prepare%20an%0A%3E%20updated%20source%20package%20and%20send%20it%20to%20debian-lts%40lists.debian.org%0A%3E%20%28via%20a%20debdiff%2C%20or%20with%20an%20URL%20pointing%20to%20the%20the%20source%20package%2C%0A%3E%20or%20even%20with%20a%20pointer%20to%20your%20packaging%20repository%29%2C%20and%20the%20members%0A%3E%20of%20the%20LTS%20team%20will%20take%20care%20of%20the%20rest.%20Indicate%20clearly%20whether%20you%0A%3E%20have%20tested%20the%20updated%20package%20or%20not.%0A%3E%20%0A%3E%20If%20you%20don%27t%20want%20to%20take%20care%20of%20this%20update%2C%20it%27s%20not%20a%20problem%2C%20we%0A%3E%20will%20do%20our%20best%20with%20your%20package.%20Just%20let%20us%20know%20whether%20you%20would%0A%3E%20like%20to%20review%20and%2For%20test%20the%20updated%20package%20before%20it%20gets%20released.%0A%3E%20%0A%3E%20Thank%20you%20very%20much.%0A%3E%20%0A%3E%20Rapha%C3%ABl%20Hertzog%2C%0A%3E%20%20%20on%20behalf%20of%20the%20Debian%20LTS%20team.%0A%3E%20%0A%3E%20PS%3A%20A%20member%20of%20the%20LTS%20team%20might%20start%20working%20on%20this%20update%20at%0A%3E%20any%20point%20in%20time.%20You%20can%20verify%20whether%20someone%20is%20registered%0A%3E%20on%20this%20update%20in%20this%20file%3A%0A%3E%20https%3A%2F%2Fanonscm.debian.org%2Fviewvc%2Fsecure-testing%2Fdata%2Fdla-needed.txt%3Fview%3Dmarkup%0A%3E%20--%20%0A%3E%20Rapha%C3%ABl%20Hertzog%20%E2%97%88%20Debian%20Developer%0A%3E%20%0A%3E%20Support%20Debian%20LTS%3A%20http%3A%2F%2Fwww.freexian.com%2Fservices%2Fdebian-lts.html%0A%3E%20Learn%20to%20master%20Debian%3A%20http%3A%2F%2Fdebian-handbook.info%2Fget%2F%0A%3E%20%0A%3E%20%0A&amp;References=%3C20150414144705.GA17742%40home.ouaza.com%3E&amp;In-Reply-To=%3C20150414144705.GA17742%40home.ouaza.com%3E&amp;subject=Re%3A%20squeeze%20update%20of%20ppp%3F">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=hertzog%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Raphael Hertzog &lt;hertzog@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Marco d&#39;Itri &lt;md@linux.it&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> debian-lts@lists.debian.org, 782450@bugs.debian.org,
	Emanuele Rocca &lt;ema@debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> squeeze update of ppp?</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 16:47:05 +0200</div>
</div>
<pre class="message">Hello Marco &amp; Emanuele,

the Debian LTS team would like to fix the security issues which are
currently open in the Squeeze version of ppp:
<a href="https://security-tracker.debian.org/tracker/source-package/ppp">https://security-tracker.debian.org/tracker/source-package/ppp</a>

Would you like to take care of this yourself? We are still understaffed so
any help is always highly appreciated.

If yes, please follow the workflow we have defined here:
<a href="http://wiki.debian.org/LTS/Development">http://wiki.debian.org/LTS/Development</a>

If that workflow is a burden to you, feel free to just prepare an
updated source package and send it to debian-lts@lists.debian.org
(via a debdiff, or with an URL pointing to the the source package,
or even with a pointer to your packaging repository), and the members
of the LTS team will take care of the rest. Indicate clearly whether you
have tested the updated package or not.

If you don&#39;t want to take care of this update, it&#39;s not a problem, we
will do our best with your package. Just let us know whether you would
like to review and/or test the updated package before it gets released.

Thank you very much.

Raphaël Hertzog,
  on behalf of the Debian LTS team.

PS: A member of the LTS team might start working on this update at
any point in time. You can verify whether someone is registered
on this update in this file:
<a href="https://anonscm.debian.org/viewvc/secure-testing/data/dla-needed.txt?view=markup">https://anonscm.debian.org/viewvc/secure-testing/data/dla-needed.txt?view=markup</a>
-- 
Raphaël Hertzog ◈ Debian Developer

Support Debian LTS: <a href="http://www.freexian.com/services/debian-lts.html">http://www.freexian.com/services/debian-lts.html</a>
Learn to master Debian: <a href="http://debian-handbook.info/get/">http://debian-handbook.info/get/</a>


</pre>

<div class="infmessage"><hr><p>
<a name="43"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org -->
<!-- time:1429024144 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 14 Apr 2015 15:09:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=44">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="45"></a>
<!-- request_addr: Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1429024144 -->
<strong>Acknowledgement sent</strong>
to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
Extra info received and forwarded to list.
 (Tue, 14 Apr 2015 15:09:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=46">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=46">mbox</a>, <a href="#45">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="47"></a><a name="msg47"></a><a href="#47">Message #47</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=47">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=47">mbox</a>, <a href="mailto:782450@bugs.debian.org?References=%3C20150414144705.GA17742%40home.ouaza.com%3E%0A%20%3C20150414145849.GA28994%40bongo.bofh.it%3E&amp;In-Reply-To=%3C20150414145849.GA28994%40bongo.bofh.it%3E&amp;subject=Re%3A%20squeeze%20update%20of%20ppp%3F&amp;body=On%20Tue%2C%2014%20Apr%202015%2016%3A58%3A49%20%2B0200%20Marco%20d%27Itri%20%3Cmd%40linux.it%3E%20wrote%3A%0A%3E%20On%20Apr%2014%2C%20Raphael%20Hertzog%20%3Chertzog%40debian.org%3E%20wrote%3A%0A%3E%20%0A%3E%20%3E%20Would%20you%20like%20to%20take%20care%20of%20this%20yourself%3F%20We%20are%20still%20understaffed%20so%0A%3E%20No%2C%20I%20am%20not%20sure%20if%20we%20will%20fix%20it%20for%20stable%20either.%0A%3E%20It%20is%20not%20really%20such%20a%20big%20deal%2C%20so%20I%20am%20not%20concerned.%0A%3E%20%0A%3E%20--%20%0A%3E%20ciao%2C%0A%3E%20Marco%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=md%40linux.it" alt="">
<div class="header"><span class="headerfield">From:</span> Marco d&#39;Itri &lt;md@linux.it&gt;</div>
<div class="header"><span class="headerfield">To:</span> Raphael Hertzog &lt;hertzog@debian.org&gt;, debian-lts@lists.debian.org,
	782450@bugs.debian.org, Emanuele Rocca &lt;ema@debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: squeeze update of ppp?</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 14 Apr 2015 16:58:49 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=782450;msg=47">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Apr 14, Raphael Hertzog &lt;hertzog@debian.org&gt; wrote:

&gt; Would you like to take care of this yourself? We are still understaffed so
No, I am not sure if we will fix it for stable either.
It is not really such a big deal, so I am not concerned.

-- 
ciao,
Marco
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=782450;msg=47">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="48"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1429167424 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Thu, 16 Apr 2015 06:57:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=49">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=49">mbox</a>, <a href="#48">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="50"></a>
<!-- request_addr: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- time:1429167424 -->
<strong>Acknowledgement sent</strong>
to <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Thu, 16 Apr 2015 06:57:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=51">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=51">mbox</a>, <a href="#50">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="52"></a><a name="msg52"></a><a href="#52">Message #52</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=52">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=52">mbox</a>, <a href="mailto:782450@bugs.debian.org?body=On%20Thu%2C%2016%20Apr%202015%2008%3A55%3A50%20%2B0200%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%20wrote%3A%0A%3E%20Control%3A%20retitle%20-1%20ppp%3A%20CVE-2015-3310%3A%20Buffer%20overflow%20in%20radius%20plugin%0A%3E%20%0A%3E%20Hi%0A%3E%20%0A%3E%20This%20issue%20has%20been%20assigned%20CVE-2015-3310.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20Salvatore%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20150416065550.GA1668%40elende.valinor.li%3E&amp;References=%3C20150412122002.GA14475%40orion%3E%0A%20%3C20150416065550.GA1668%40elende.valinor.li%3E&amp;subject=Re%3A%20Bug%23782450%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=carnil%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Emanuele Rocca &lt;ema@linux.it&gt;, 782450@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#782450: ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 16 Apr 2015 08:55:50 +0200</div>
</div>
<pre class="message">Control: retitle -1 ppp: <a href="https://security-tracker.debian.org/tracker/CVE-2015-3310">CVE-2015-3310</a>: Buffer overflow in radius plugin

Hi

This issue has been assigned <a href="https://security-tracker.debian.org/tracker/CVE-2015-3310">CVE-2015-3310</a>.

Regards,
Salvatore


</pre>

<div class="msgreceived"><hr><p>
<a name="53"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: 782450-submit@bugs.debian.org -->
<!-- time:1429167424 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;ppp: CVE-2015-3310: Buffer overflow in radius plugin&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;ppp: Buffer overflow in radius plugin&#39;
            };
-->
<strong>Changed Bug title to &#39;ppp: CVE-2015-3310: Buffer overflow in radius plugin&#39; from &#39;ppp: Buffer overflow in radius plugin&#39;</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>782450-submit@bugs.debian.org</code>.
 (Thu, 16 Apr 2015 06:57:04 GMT) (<a href="bugreport.cgi?bug=782450;msg=54">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=54">mbox</a>, <a href="#53">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="55"></a>
<!-- request_addr: Sebastien Delafond &lt;seb@debian.org&gt; -->
<!-- time:1429288406 -->
<strong>Reply sent</strong>
to <code>Sebastien Delafond &lt;seb@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Fri, 17 Apr 2015 16:33:26 GMT) (<a href="bugreport.cgi?bug=782450;msg=56">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=56">mbox</a>, <a href="#55">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="57"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1429288406 -->
<strong>Notification sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
Bug acknowledged by developer.
 (Fri, 17 Apr 2015 16:33:26 GMT) (<a href="bugreport.cgi?bug=782450;msg=58">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=58">mbox</a>, <a href="#57">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="59"></a><a name="msg59"></a><a href="#59">Message #59</a> received at 782450-close@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=59">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=59">mbox</a>, <a href="mailto:782450@bugs.debian.org?body=On%20Fri%2C%2017%20Apr%202015%2016%3A32%3A05%20%2B0000%20Sebastien%20Delafond%20%3Cseb%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20ppp%0A%3E%20Source-Version%3A%202.4.5-5.1%2Bdeb7u2%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20ppp%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20782450%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Sebastien%20Delafond%20%3Cseb%40debian.org%3E%20%28supplier%20of%20updated%20ppp%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA256%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2016%20Apr%202015%2009%3A37%3A44%20%2B0200%0A%3E%20Source%3A%20ppp%0A%3E%20Binary%3A%20ppp%20ppp-udeb%20ppp-dev%0A%3E%20Architecture%3A%20source%20amd64%20all%0A%3E%20Version%3A%202.4.5-5.1%2Bdeb7u2%0A%3E%20Distribution%3A%20wheezy-security%0A%3E%20Urgency%3A%20medium%0A%3E%20Maintainer%3A%20Marco%20d%27Itri%20%3Cmd%40linux.it%3E%0A%3E%20Changed-By%3A%20Sebastien%20Delafond%20%3Cseb%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20ppp%20%20%20%20%20%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20daemon%0A%3E%20%20ppp-dev%20%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20development%20files%0A%3E%20%20ppp-udeb%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20package%20for%20Debian%20Installer%20%28udeb%29%0A%3E%20Closes%3A%20782450%0A%3E%20Changes%3A%20%0A%3E%20%20ppp%20%282.4.5-5.1%2Bdeb7u2%29%20wheezy-security%3B%20urgency%3Dmedium%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Non-maintainer%20upload%20by%20the%20Security%20Team%20%28thanks%20to%20Emanuele%20Rocca%0A%3E%20%20%20%20%20%20for%20the%20patch%29.%0A%3E%20%20%20%20%2A%20Fix%20CVE-2015-3310%3A%20buffer%20overflow%20which%20may%20lead%20to%20DoS%20%28Closes%3A%0A%3E%20%20%20%20%20%20%23782450%29.%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%20719ded51eb54e5fd05c7bb72bc59cba260ca7f54%201412%20ppp_2.4.5-5.1%2Bdeb7u2.dsc%0A%3E%20%2036bb7fc982cf558ed20eb18cc11125f2fefe1b32%2097247%20ppp_2.4.5-5.1%2Bdeb7u2.diff.gz%0A%3E%20%20f2f47a3724305a2d37cf17cb912b5269198dd0f5%20380948%20ppp_2.4.5-5.1%2Bdeb7u2_amd64.deb%0A%3E%20%208628f30f8f6bbfd6bf877d86c7e080e8db2a6647%20112662%20ppp-udeb_2.4.5-5.1%2Bdeb7u2_amd64.udeb%0A%3E%20%20648a608f5ef20ff5034c7f03be17429ed71ab19f%2057274%20ppp-dev_2.4.5-5.1%2Bdeb7u2_all.deb%0A%3E%20Checksums-Sha256%3A%20%0A%3E%20%20a0dd2c8ae992b86fc1da8f966aa3d3955faaee57bb59accb1579c4fef7cbea9e%201412%20ppp_2.4.5-5.1%2Bdeb7u2.dsc%0A%3E%20%206905ccb710a2cbf450d9e081b67ea6c9c39278c7e46e93d6f55b28da37077d95%2097247%20ppp_2.4.5-5.1%2Bdeb7u2.diff.gz%0A%3E%20%2000439340d1c3bc46282fe212d1f1ca96c7d840e414d7f375cab3e941e33fa5d6%20380948%20ppp_2.4.5-5.1%2Bdeb7u2_amd64.deb%0A%3E%20%20c2c4a637f7ec21385fa7921ae15119b925b9440f9dd7d0ea67b4c5ae7be70011%20112662%20ppp-udeb_2.4.5-5.1%2Bdeb7u2_amd64.udeb%0A%3E%20%200088ff5481d37aabfe5a83036edb54a97bafec8527fdcbb7a16240682d3c596c%2057274%20ppp-dev_2.4.5-5.1%2Bdeb7u2_all.deb%0A%3E%20Files%3A%20%0A&amp;subject=Re%3A%20Bug%23782450%3A%20fixed%20in%20ppp%202.4.5-5.1%2Bdeb7u2&amp;In-Reply-To=%3CE1Yj9BV-0001PQ-Bw%40franck.debian.org%3E&amp;References=%3CE1Yj9BV-0001PQ-Bw%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=seb%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Sebastien Delafond &lt;seb@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 782450-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#782450: fixed in ppp 2.4.5-5.1+deb7u2</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 17 Apr 2015 16:32:05 +0000</div>
</div>
<pre class="message">Source: ppp
Source-Version: 2.4.5-5.1+deb7u2

We believe that the bug you reported is fixed in the latest version of
ppp, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 782450@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sebastien Delafond &lt;seb@debian.org&gt; (supplier of updated ppp package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 16 Apr 2015 09:37:44 +0200
Source: ppp
Binary: ppp ppp-udeb ppp-dev
Architecture: source amd64 all
Version: 2.4.5-5.1+deb7u2
Distribution: wheezy-security
Urgency: medium
Maintainer: Marco d&#39;Itri &lt;md@linux.it&gt;
Changed-By: Sebastien Delafond &lt;seb@debian.org&gt;
Description: 
 ppp        - Point-to-Point Protocol (PPP) - daemon
 ppp-dev    - Point-to-Point Protocol (PPP) - development files
 ppp-udeb   - Point-to-Point Protocol (PPP) - package for Debian Installer (udeb)
Closes: <a href="bugreport.cgi?bug=782450">782450</a>
Changes: 
 ppp (2.4.5-5.1+deb7u2) wheezy-security; urgency=medium
 .
   * Non-maintainer upload by the Security Team (thanks to Emanuele Rocca
     for the patch).
   * Fix <a href="https://security-tracker.debian.org/tracker/CVE-2015-3310">CVE-2015-3310</a>: buffer overflow which may lead to DoS (Closes:
     #<a href="bugreport.cgi?bug=782450">782450</a>).
Checksums-Sha1: 
 719ded51eb54e5fd05c7bb72bc59cba260ca7f54 1412 ppp_2.4.5-5.1+deb7u2.dsc
 36bb7fc982cf558ed20eb18cc11125f2fefe1b32 97247 ppp_2.4.5-5.1+deb7u2.diff.gz
 f2f47a3724305a2d37cf17cb912b5269198dd0f5 380948 ppp_2.4.5-5.1+deb7u2_amd64.deb
 8628f30f8f6bbfd6bf877d86c7e080e8db2a6647 112662 ppp-udeb_2.4.5-5.1+deb7u2_amd64.udeb
 648a608f5ef20ff5034c7f03be17429ed71ab19f 57274 ppp-dev_2.4.5-5.1+deb7u2_all.deb
Checksums-Sha256: 
 a0dd2c8ae992b86fc1da8f966aa3d3955faaee57bb59accb1579c4fef7cbea9e 1412 ppp_2.4.5-5.1+deb7u2.dsc
 6905ccb710a2cbf450d9e081b67ea6c9c39278c7e46e93d6f55b28da37077d95 97247 ppp_2.4.5-5.1+deb7u2.diff.gz
 00439340d1c3bc46282fe212d1f1ca96c7d840e414d7f375cab3e941e33fa5d6 380948 ppp_2.4.5-5.1+deb7u2_amd64.deb
 c2c4a637f7ec21385fa7921ae15119b925b9440f9dd7d0ea67b4c5ae7be70011 112662 ppp-udeb_2.4.5-5.1+deb7u2_amd64.udeb
 0088ff5481d37aabfe5a83036edb54a97bafec8527fdcbb7a16240682d3c596c 57274 ppp-dev_2.4.5-5.1+deb7u2_all.deb
Files: 
 b5c4ac00e57b3e324d2af0a6f2bf7b06 1412 admin optional ppp_2.4.5-5.1+deb7u2.dsc
 9b71b9c832424e9069a91f93dd47c69e 97247 admin optional ppp_2.4.5-5.1+deb7u2.diff.gz
 221dd3b7508ce77a087ab7c4e464e27d 380948 admin optional ppp_2.4.5-5.1+deb7u2_amd64.deb
 55e1aae061a80fd6fb8327a088925133 112662 debian-installer optional ppp-udeb_2.4.5-5.1+deb7u2_amd64.udeb
 c5bb6f22c6301a9504851fc7eb964527 57274 devel extra ppp-dev_2.4.5-5.1+deb7u2_all.deb
Package-Type: udeb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJVL2eUAAoJEBC+iYPz1Z1khR8H/0JmVbhAer0GMZwrVi6uhT8+
Dt9FLjPNk9032KCh1+15HwnoaUhxUFdO6wMX7dB3D3mmsnN7ZLTuTcqIot9YgTi2
mQruFa2aKlA13Q/vX7AGhGaC5Y3uVZ30XaVYpWSsnS++XqWXhWc+Eh3sGZdJZSsD
nNONj+JjX0QUCNvifeNXISaWXiulXfTUJdXAF03d1ezLcyjNmXQrpmWCaqJeGMX5
vpRS8BoVx4ujEOou8PBfYYNazpZNFybMVGOQ14cSLiaDj+cNgMAtnPv9CMyKg1ET
WytPgwVUt9NC8ghXq6cB2hD1+gi9z4OZANFDjaOf3pnfrXPdbeDg3Tl7pHawjjs=
=cHka
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="60"></a>
<!-- request_addr: Thorsten Alteholz &lt;debian@alteholz.de&gt; -->
<!-- time:1429456891 -->
<strong>Reply sent</strong>
to <code>Thorsten Alteholz &lt;debian@alteholz.de&gt;</code>:<br>
You have taken responsibility.
 (Sun, 19 Apr 2015 15:21:31 GMT) (<a href="bugreport.cgi?bug=782450;msg=61">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=61">mbox</a>, <a href="#60">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="62"></a>
<!-- request_addr: Emanuele Rocca &lt;ema@linux.it&gt; -->
<!-- time:1429456891 -->
<strong>Notification sent</strong>
to <code>Emanuele Rocca &lt;ema@linux.it&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 19 Apr 2015 15:21:31 GMT) (<a href="bugreport.cgi?bug=782450;msg=63">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=63">mbox</a>, <a href="#62">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="64"></a><a name="msg64"></a><a href="#64">Message #64</a> received at 782450-close@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=64">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=64">mbox</a>, <a href="mailto:782450@bugs.debian.org?body=On%20Sun%2C%2019%20Apr%202015%2015%3A19%3A49%20%2B0000%20Thorsten%20Alteholz%20%3Cdebian%40alteholz.de%3E%20wrote%3A%0A%3E%20Source%3A%20ppp%0A%3E%20Source-Version%3A%202.4.5-4%2Bdeb6u2%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20ppp%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20782450%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Thorsten%20Alteholz%20%3Cdebian%40alteholz.de%3E%20%28supplier%20of%20updated%20ppp%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA512%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Sun%2C%2019%20Apr%202015%2016%3A00%3A47%20%2B0200%0A%3E%20Source%3A%20ppp%0A%3E%20Binary%3A%20ppp%20ppp-udeb%20ppp-dev%0A%3E%20Architecture%3A%20source%20i386%20all%0A%3E%20Version%3A%202.4.5-4%2Bdeb6u2%0A%3E%20Distribution%3A%20squeeze-lts%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Marco%20d%27Itri%20%3Cmd%40linux.it%3E%0A%3E%20Changed-By%3A%20Thorsten%20Alteholz%20%3Cdebian%40alteholz.de%3E%0A%3E%20Description%3A%20%0A%3E%20%20ppp%20%20%20%20%20%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20daemon%0A%3E%20%20ppp-dev%20%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20development%20files%0A%3E%20%20ppp-udeb%20%20%20-%20Point-to-Point%20Protocol%20%28PPP%29%20-%20package%20for%20Debian%20Installer%20%28udeb%29%0A%3E%20Closes%3A%20782450%0A%3E%20Changes%3A%20%0A%3E%20%20ppp%20%282.4.5-4%2Bdeb6u2%29%20squeeze-lts%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Non-maintainer%20upload%20by%20the%20Squeeze%20LTS%20Team.%0A%3E%20%20%20%20%2A%20Fix%20CVE-2015-3310%3A%20buffer%20overflow%20which%20may%20lead%20to%20DoS%20%28Closes%3A%20%23782450%29.%0A%3E%20%20%20%20%20%20%28thanks%20to%20Emanuele%20Rocca%20for%20the%20patch%29.%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%2033d28ab19c5b260a52b5887ba831f327de180c95%201765%20ppp_2.4.5-4%2Bdeb6u2.dsc%0A%3E%20%20cb977b31584e3488e08a643aaa672fdb229d2e78%20684342%20ppp_2.4.5.orig.tar.gz%0A%3E%20%20263138f23fd1ad778604e53dcd12dfa696886628%2098377%20ppp_2.4.5-4%2Bdeb6u2.diff.gz%0A%3E%20%203bcbcbdd7e95ddd44fe4f663fb18089f90da91bb%20351422%20ppp_2.4.5-4%2Bdeb6u2_i386.deb%0A%3E%20%209ef823345ef638a99ce0581811197ef0dd30eb5b%20117154%20ppp-udeb_2.4.5-4%2Bdeb6u2_i386.udeb%0A%3E%20%20f32c7f00d8a5ec7f8a6d03e097ac21a4325eab17%2057360%20ppp-dev_2.4.5-4%2Bdeb6u2_all.deb%0A%3E%20Checksums-Sha256%3A%20%0A%3E%20%2097751146fbc2e8a447ec456e5e64cfdaef787672370869dcf006c212ab969931%201765%20ppp_2.4.5-4%2Bdeb6u2.dsc%0A%3E%20%2043317afec9299f9920b96f840414c977f0385410202d48e56d2fdb8230003505%20684342%20ppp_2.4.5.orig.tar.gz%0A%3E%20%20821c9178d0c9e0d67d452b786cbf365d63237262b23d8cab51fd0eb9a1ef5ee9%2098377%20ppp_2.4.5-4%2Bdeb6u2.diff.gz%0A%3E%20%208a9e8f9b54c1588a882b7b3b4a93f7929f796ea56456e413f5e869487dfb864f%20351422%20ppp_2.4.5-4%2Bdeb6u2_i386.deb%0A%3E%20%20d75e8b373e662874c2b6c5ac83f689d09df39e03b2605c1f10670ebfa23d927f%20117154%20ppp-udeb_2.4.5-4%2Bdeb6u2_i386.udeb%0A%3E%20%20681efe1a7b1680ae501577b91a4d5c58c8fc913bfee03949c2ec0e71f4b602e6%2057360%20ppp-dev_2.4.5-4%2Bdeb6u2_all.deb%0A&amp;subject=Re%3A%20Bug%23782450%3A%20fixed%20in%20ppp%202.4.5-4%2Bdeb6u2&amp;In-Reply-To=%3CE1Yjr0f-0002lY-FK%40franck.debian.org%3E&amp;References=%3CE1Yjr0f-0002lY-FK%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=debian%40alteholz.de" alt="">
<div class="header"><span class="headerfield">From:</span> Thorsten Alteholz &lt;debian@alteholz.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> 782450-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#782450: fixed in ppp 2.4.5-4+deb6u2</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 19 Apr 2015 15:19:49 +0000</div>
</div>
<pre class="message">Source: ppp
Source-Version: 2.4.5-4+deb6u2

We believe that the bug you reported is fixed in the latest version of
ppp, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 782450@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Thorsten Alteholz &lt;debian@alteholz.de&gt; (supplier of updated ppp package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Sun, 19 Apr 2015 16:00:47 +0200
Source: ppp
Binary: ppp ppp-udeb ppp-dev
Architecture: source i386 all
Version: 2.4.5-4+deb6u2
Distribution: squeeze-lts
Urgency: high
Maintainer: Marco d&#39;Itri &lt;md@linux.it&gt;
Changed-By: Thorsten Alteholz &lt;debian@alteholz.de&gt;
Description: 
 ppp        - Point-to-Point Protocol (PPP) - daemon
 ppp-dev    - Point-to-Point Protocol (PPP) - development files
 ppp-udeb   - Point-to-Point Protocol (PPP) - package for Debian Installer (udeb)
Closes: <a href="bugreport.cgi?bug=782450">782450</a>
Changes: 
 ppp (2.4.5-4+deb6u2) squeeze-lts; urgency=high
 .
   * Non-maintainer upload by the Squeeze LTS Team.
   * Fix <a href="https://security-tracker.debian.org/tracker/CVE-2015-3310">CVE-2015-3310</a>: buffer overflow which may lead to DoS (Closes: #<a href="bugreport.cgi?bug=782450">782450</a>).
     (thanks to Emanuele Rocca for the patch).
Checksums-Sha1: 
 33d28ab19c5b260a52b5887ba831f327de180c95 1765 ppp_2.4.5-4+deb6u2.dsc
 cb977b31584e3488e08a643aaa672fdb229d2e78 684342 ppp_2.4.5.orig.tar.gz
 263138f23fd1ad778604e53dcd12dfa696886628 98377 ppp_2.4.5-4+deb6u2.diff.gz
 3bcbcbdd7e95ddd44fe4f663fb18089f90da91bb 351422 ppp_2.4.5-4+deb6u2_i386.deb
 9ef823345ef638a99ce0581811197ef0dd30eb5b 117154 ppp-udeb_2.4.5-4+deb6u2_i386.udeb
 f32c7f00d8a5ec7f8a6d03e097ac21a4325eab17 57360 ppp-dev_2.4.5-4+deb6u2_all.deb
Checksums-Sha256: 
 97751146fbc2e8a447ec456e5e64cfdaef787672370869dcf006c212ab969931 1765 ppp_2.4.5-4+deb6u2.dsc
 43317afec9299f9920b96f840414c977f0385410202d48e56d2fdb8230003505 684342 ppp_2.4.5.orig.tar.gz
 821c9178d0c9e0d67d452b786cbf365d63237262b23d8cab51fd0eb9a1ef5ee9 98377 ppp_2.4.5-4+deb6u2.diff.gz
 8a9e8f9b54c1588a882b7b3b4a93f7929f796ea56456e413f5e869487dfb864f 351422 ppp_2.4.5-4+deb6u2_i386.deb
 d75e8b373e662874c2b6c5ac83f689d09df39e03b2605c1f10670ebfa23d927f 117154 ppp-udeb_2.4.5-4+deb6u2_i386.udeb
 681efe1a7b1680ae501577b91a4d5c58c8fc913bfee03949c2ec0e71f4b602e6 57360 ppp-dev_2.4.5-4+deb6u2_all.deb
Files: 
 ae5f111f77d822582bbe4cf179f7134e 1765 admin optional ppp_2.4.5-4+deb6u2.dsc
 4621bc56167b6953ec4071043fe0ec57 684342 admin optional ppp_2.4.5.orig.tar.gz
 747a78dd7e4f17ddfabe555ffa335849 98377 admin optional ppp_2.4.5-4+deb6u2.diff.gz
 ea5854906186f06fdb50a21c5d68dda4 351422 admin optional ppp_2.4.5-4+deb6u2_i386.deb
 f21f2762bcdf12ba2db42405d2ae1d34 117154 debian-installer optional ppp-udeb_2.4.5-4+deb6u2_i386.udeb
 cd0e19ba39e698258a995b3373c6211e 57360 devel extra ppp-dev_2.4.5-4+deb6u2_all.deb
Package-Type: udeb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQJ8BAEBCgBmBQJVM8MGXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ2MjAxRkJGRkRCQkRFMDc4MjJFQUJCOTY5
NkZDQUMwRDM4N0I1ODQ3AAoJEJb8rA04e1hHirEQAKiFQb+fih1FOLQJUVV8Hpmv
gV2qPw2grtcpr3Em6PECcLkCaBewpudiLpDWbY9xrOkLTJUCkBYeBRaAzDi4DrXR
C3MfiIXeGZd/u9PGA/GJj3JfUpn4qPZXkA+rjLBke2eD6M1xQq1q+LbARStAu2Hh
YwWwzWUhAQ0icBHv+AXTyBwPUOhHUPqAn3iK4bQJkOY4WhT3dNob8GHRLTxvBd8C
XVaY8nvhOSb/Mooj6dwz94xRJwmvJHaW6R2G2qV1qTwHMR1+ux3H9rxirFZh/v0I
i+4LMUthmyCew4SJEG0H42XyKryTvDA6iMrAedQDrStMSzHVwixhEYUQJGYRbBCk
7giCd+lNka+O5A93XfxAN9jLoZhC2RnEIvP1gdPls5DHvK55MrluZJEcjL3P1Eim
FND1+oT7h50Gq0JswJ0VYkIptPm/n2UPtSv3l8WHSVExX2i0MUUqS0gRatjRswhD
w3qIOAHYU3nZcSJyN3OGtPE2OKmvrNMIVuebRKZBK5/uqJFNutdFXmhAM5uanBge
aHe3x12ADDFAyKsTlYHGZ6gIY0J/sKhhwOzgo4WTZFU/I0vVrY1OgEgMZbdQQL66
uDs8xf+gOu4vECVxZrbfFPbhbxir27jtebB6xMktLsJuIXEzUy0LxhJo9cUCVvGQ
pMDrBm0DV3c3OmeZXE0r
=skXJ
-----END PGP SIGNATURE-----



</pre>

<div class="infmessage"><hr><p>
<a name="65"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt; -->
<!-- time:1431460265 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Marco d&#39;Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#782450</code>; Package <code>ppp</code>.
 (Tue, 12 May 2015 19:51:05 GMT) (<a href="bugreport.cgi?bug=782450;msg=66">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=66">mbox</a>, <a href="#65">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="67"></a>
<!-- request_addr: Chris Boot &lt;debian@bootc.net&gt; -->
<!-- time:1431460265 -->
<strong>Acknowledgement sent</strong>
to <code>Chris Boot &lt;debian@bootc.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d&#39;Itri &lt;md@linux.it&gt;</code>.
 (Tue, 12 May 2015 19:51:05 GMT) (<a href="bugreport.cgi?bug=782450;msg=68">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=68">mbox</a>, <a href="#67">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="69"></a><a name="msg69"></a><a href="#69">Message #69</a> received at 782450@bugs.debian.org (<a href="bugreport.cgi?bug=782450;msg=69">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=69">mbox</a>, <a href="mailto:782450@bugs.debian.org?subject=Re%3A%20Bug%23782450%3A%20ppp%3A%20Buffer%20overflow%20in%20radius%20plugin&amp;In-Reply-To=%3C555257FD.3060505%40bootc.net%3E&amp;References=%3C20150412122002.GA14475%40orion%3E%0A%20%3C555257FD.3060505%40bootc.net%3E&amp;body=On%20Tue%2C%2012%20May%202015%2020%3A43%3A57%20%2B0100%20Chris%20Boot%20%3Cdebian%40bootc.net%3E%20wrote%3A%0A%3E%20On%2012%2F04%2F15%2013%3A20%2C%20Emanuele%20Rocca%20wrote%3A%0A%3E%20%3E%20On%20systems%20with%20more%20than%2065535%20processes%20running%2C%20pppd%20aborts%20when%0A%3E%20%3E%20sending%20a%20%22start%22%20accounting%20message%20to%20the%20RADIUS%20server%20because%20of%20a%0A%3E%20%3E%20buffer%20overflow%20in%20rc_mksid.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20process%20id%20is%20used%20in%20rc_mksid%20to%20generate%20a%20pseudo-unique%20string%2C%0A%3E%20%3E%20assuming%20that%20the%20hex%20representation%20of%20the%20pid%20will%20be%20at%20most%204%0A%3E%20%3E%20characters%20%28FFFF%29.%20__sprintf_chk%28%29%2C%20used%20when%20compiling%20with%0A%3E%20%3E%20optimization%20levels%20greater%20than%200%20and%20FORTIFY_SOURCE%2C%20detects%20the%0A%3E%20%3E%20buffer%20overflow%20and%20makes%20pppd%20crash.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20following%20patch%20fixes%20the%20problem.%0A%3E%20%3E%20%0A%3E%20%3E%20---%20ppp-2.4.6.orig%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%2B%2B%2B%20ppp-2.4.6%2Fpppd%2Fplugins%2Fradius%2Futil.c%0A%3E%20%3E%20%40%40%20-77%2C7%20%2B77%2C7%20%40%40%20rc_mksid%20%28void%29%0A%3E%20%3E%20%20%20%20static%20unsigned%20short%20int%20cnt%20%3D%200%3B%0A%3E%20%3E%20%20%20%20sprintf%20%28buf%2C%20%22%2508lX%2504X%2502hX%22%2C%0A%3E%20%3E%20%20%09%20%20%20%28unsigned%20long%20int%29%20time%20%28NULL%29%2C%0A%3E%20%3E%20-%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%2C%0A%3E%20%3E%20%2B%09%20%20%20%28unsigned%20int%29%20getpid%20%28%29%20%25%2065535%2C%0A%3E%20%3E%20%20%09%20%20%20cnt%20%26%200xFF%29%3B%0A%3E%20%3E%20%20%20%20cnt%2B%2B%3B%0A%3E%20%3E%20%20%20%20return%20buf%3B%0A%3E%20%0A%3E%20Hi%20Emanuele%2C%0A%3E%20%0A%3E%20Did%20you%20send%20your%20patch%20upstream%3F%20If%20not%2C%20would%20you%20mind%20if%20I%20did%20so%3F%0A%3E%20Would%20you%20be%20able%20to%20provide%20a%20%22Signed-off-by%22%20line%20as%20required%20by%20upstream%3F%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20Chris%0A%3E%20%0A%3E%20--%20%0A%3E%20Chris%20Boot%0A%3E%20debian%40bootc.net%0A%3E%20GPG%3A%208467%2053CB%201921%203142%20C56D%20%20C918%20F5C8%203C05%20D9CE%20EEEE%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=debian%40bootc.net" alt="">
<div class="header"><span class="headerfield">From:</span> Chris Boot &lt;debian@bootc.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Emanuele Rocca &lt;ema@linux.it&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 782450@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#782450: ppp: Buffer overflow in radius plugin</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 12 May 2015 20:43:57 +0100</div>
</div>
<pre class="message">On 12/04/15 13:20, Emanuele Rocca wrote:
&gt; On systems with more than 65535 processes running, pppd aborts when
&gt; sending a &quot;start&quot; accounting message to the RADIUS server because of a
&gt; buffer overflow in rc_mksid.
&gt; 
&gt; The process id is used in rc_mksid to generate a pseudo-unique string,
&gt; assuming that the hex representation of the pid will be at most 4
&gt; characters (FFFF). __sprintf_chk(), used when compiling with
&gt; optimization levels greater than 0 and FORTIFY_SOURCE, detects the
&gt; buffer overflow and makes pppd crash.
&gt; 
&gt; The following patch fixes the problem.
&gt; 
&gt; --- ppp-2.4.6.orig/pppd/plugins/radius/util.c
&gt; +++ ppp-2.4.6/pppd/plugins/radius/util.c
&gt; @@ -77,7 +77,7 @@ rc_mksid (void)
&gt;    static unsigned short int cnt = 0;
&gt;    sprintf (buf, &quot;%08lX%04X%02hX&quot;,
&gt;  	   (unsigned long int) time (NULL),
&gt; -	   (unsigned int) getpid (),
&gt; +	   (unsigned int) getpid () % 65535,
&gt;  	   cnt &amp; 0xFF);
&gt;    cnt++;
&gt;    return buf;

Hi Emanuele,

Did you send your patch upstream? If not, would you mind if I did so?
Would you be able to provide a &quot;Signed-off-by&quot; line as required by upstream?

Thanks,
Chris

-- 
Chris Boot
debian@bootc.net
GPG: 8467 53CB 1921 3142 C56D  C918 F5C8 3C05 D9CE EEEE


</pre>

<div class="msgreceived"><hr><p>
<a name="70"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1433921470 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Wed, 10 Jun 2015 07:31:10 GMT) (<a href="bugreport.cgi?bug=782450;msg=71">full text</a>, <a href="bugreport.cgi?bug=782450;mbox=yes;msg=71">mbox</a>, <a href="#70">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=782450">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:31:40 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
