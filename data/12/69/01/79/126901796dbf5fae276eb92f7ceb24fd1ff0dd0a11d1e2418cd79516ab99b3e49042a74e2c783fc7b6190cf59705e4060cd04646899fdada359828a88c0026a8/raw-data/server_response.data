<!DOCTYPE html>
<html lang="en">
  <head>
    <title>698965 &ndash; heap-use-after-free in fz_drop_imp</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/f8d5c9f7a0816126b79f46c4e0a6ddf5.css?1625059054" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1625059054"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "698965 – heap-use-after-free in fz_drop_imp",
                             "show_bug.cgi?id=698965" );
        document.title = "698965 – heap-use-after-free in fz_drop_imp";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "698965 – heap-use-after-free in fz_drop_imp", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1625059054"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-ghostscript-com
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_MuPDF
                 bz_component_mupdf
                 bz_bug_698965 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;698965</span>

        <span id="subtitle" class="subheader">heap-use-after-free in fz_drop_imp</span>

        <span id="information" class="header_addl_info">Last modified: 2018-01-29 15:38:45 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=698965&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=698965" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=698965&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619344-crrUny8ZZlJYHAp7sW2TKE-r2rptyyCy4p9vs1A8iaQ">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2018-01-29 15:38:45">
  <input type="hidden" name="id" value="698965">
  <input type="hidden" name="token" value="1635619344-Lqd_X9RTZxu5ZViIihCbtBwxHXXuDqLRvrpPWCvIHqM">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=698965"><b>Bug&nbsp;698965</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">heap-use-after-free in fz_drop_imp</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>heap-use-after-free in fz_drop_imp
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'heap-use-after-free in fz_drop_imp' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          DUPLICATE
            of <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - denial of service in seek_file"
   href="show_bug.cgi?id=698830">bug 698830</a>
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >MuPDF

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=MuPDF"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >mupdf

  (<a href="buglist.cgi?component=mupdf&amp;product=MuPDF&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P4
       normal
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">muPDF bugs</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard"><span class="fn">Bug traffic</span>
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'mupdf-bugs\x40artifex.com',
        'tech\x40artifex.com');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2018-01-29 15:03 UTC by <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2018-01-29 15:38 UTC
      (<a href="show_activity.cgi?id=698965">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>1 
          user
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="sebastian.rasmussen">sebastian.rasmussen</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_customer">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_customer"
  >Customer:</a>

</th>
  <td class="field_value "
      id="field_container_cf_customer" >

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_wordsize">


  <a 
      title="For example x86 would be 32 and x86_64 would be 64."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_wordsize"
  >Word Size:</a>

</th>
  <td class="field_value "
      id="field_container_cf_wordsize" >---

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_pdf">
        <td>
            <a href="attachment.cgi?id=14697"
               title="View the content of the attachment">
          <b>PoC</b></a>

          <span class="bz_attach_extra_info">
              (1.23 KB,
                application/pdf)

            <br>
            <a href="#attach_14697"
               title="Go to the comment associated with the attachment">2018-01-29 15:03 UTC</a>,

            <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=14697&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
        <a href="attachment.cgi?bugid=698965&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=698965&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1519155687" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=698965#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-01-29 15:03:44 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14697" name="attach_14697" title="PoC">attachment 14697</a> <a href="attachment.cgi?id=14697&amp;action=edit" title="PoC">[details]</a></span>
PoC

Hello.

I found a heap-use-after-free bug in MuPDF.

Please confirm.

Thanks.

OS: Ubuntu 17.10 64bit
Version: commit <a href="http://www.ghostscript.com/cgi-bin/findgit.cgi?148329c60f8ad07886b624b5e9e3d8dfdbbdb98f">148329c60f8ad07886b624b5e9e3d8dfdbbdb98f</a>
Steps to reproduce:
1.Download the .POC files.
2.Compile the source code with ASan.
3.Execute the following command
  : ./mutool info $PoC

```
=================================================================
==3312==ERROR: AddressSanitizer: heap-use-after-free on address 0x6080000000a0 at pc 0x0000007200ee bp 0x7ffecc4651e0 sp 0x7ffecc4651d8
READ of size 4 at 0x6080000000a0 thread T0
    #0 0x7200ed in fz_drop_imp /home/karas/mupdf/source/fitz/fitz-imp.h:191:7
    #1 0x7200ed in fz_drop_stream /home/karas/mupdf/source/fitz/stream-open.c:70
    #2 0x7dcbc9 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:327:3
    #3 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #4 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #5 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #6 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #7 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #8 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #9 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #10 0x7db728 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #11 0x7db728 in build_filter /home/karas/mupdf/source/pdf/pdf-stream.c:182
    #12 0x7dbe9e in build_filter_chain /home/karas/mupdf/source/pdf/pdf-stream.c:262:12
    #13 0x7dd147 in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:364:12
    #14 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #15 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #16 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #17 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #18 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #19 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #20 0x7dee9f in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #21 0x7dee9f in build_compression_params /home/karas/mupdf/source/pdf/pdf-stream.c:126
    #22 0x7db4cf in build_filter /home/karas/mupdf/source/pdf/pdf-stream.c:167:3
    #23 0x7dbe9e in build_filter_chain /home/karas/mupdf/source/pdf/pdf-stream.c:262:12
    #24 0x7dd147 in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:364:12
    #25 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #26 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #27 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #28 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #29 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #30 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #31 0x7dea6c in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #32 0x7dea6c in build_compression_params /home/karas/mupdf/source/pdf/pdf-stream.c:101
    #33 0x7db4cf in build_filter /home/karas/mupdf/source/pdf/pdf-stream.c:167:3
    #34 0x7dbe9e in build_filter_chain /home/karas/mupdf/source/pdf/pdf-stream.c:262:12
    #35 0x7dd147 in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:364:12
    #36 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #37 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #38 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #39 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #40 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #41 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #42 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #43 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #44 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #45 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #46 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #47 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #48 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #49 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #50 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #51 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #52 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #53 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #54 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #55 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #56 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #57 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #58 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #59 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #60 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #61 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #62 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #63 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #64 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #65 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #66 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #67 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #68 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #69 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #70 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #71 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #72 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #73 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #74 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #75 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #76 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #77 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #78 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #79 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #80 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #81 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #82 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #83 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #84 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #85 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #86 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #87 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #88 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #89 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #90 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #91 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #92 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #93 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #94 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #95 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #96 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #97 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #98 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #99 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #100 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #101 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #102 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #103 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #104 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #105 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #106 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #107 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #108 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #109 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #110 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #111 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #112 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #113 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #114 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #115 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #116 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #117 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #118 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #119 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #120 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #121 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #122 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #123 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #124 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #125 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #126 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #127 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #128 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #129 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #130 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #131 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #132 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #133 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #134 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #135 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #136 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #137 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #138 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #139 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #140 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #141 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #142 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #143 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #144 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #145 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #146 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #147 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #148 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #149 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #150 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #151 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #152 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #153 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #154 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #155 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #156 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #157 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #158 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #159 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #160 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #161 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #162 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #163 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #164 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #165 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #166 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #167 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #168 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #169 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #170 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #171 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #172 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #173 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #174 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #175 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #176 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #177 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #178 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #179 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #180 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #181 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #182 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #183 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #184 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #185 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #186 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #187 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #188 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #189 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #190 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #191 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #192 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #193 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #194 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #195 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #196 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #197 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #198 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #199 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #200 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #201 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #202 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #203 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #204 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #205 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #206 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #207 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #208 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #209 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #210 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #211 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #212 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #213 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #214 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #215 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #216 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #217 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #218 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #219 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #220 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #221 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #222 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #223 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #224 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #225 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #226 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #227 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #228 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #229 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #230 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #231 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #232 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #233 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #234 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #235 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #236 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #237 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #238 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #239 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #240 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #241 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #242 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #243 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #244 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #245 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #246 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #247 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #248 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #249 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #250 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #251 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #252 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #253 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #254 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #255 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #256 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #257 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #258 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #259 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #260 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #261 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #262 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #263 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #264 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #265 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #266 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #267 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #268 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #269 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #270 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #271 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #272 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #273 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #274 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #275 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #276 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #277 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #278 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #279 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #280 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #281 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #282 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #283 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #284 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #285 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #286 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #287 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #288 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #289 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #290 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #291 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #292 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #293 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #294 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #295 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #296 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #297 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #298 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #299 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12
    #300 0x80156a in pdf_resolve_indirect_chain /home/karas/mupdf/source/pdf/pdf-xref.c:2051:9
    #301 0x7b1e75 in pdf_objcmp_resolve /home/karas/mupdf/source/pdf/pdf-object.c:411:2
    #302 0x7dc9a2 in pdf_name_eq /home/karas/mupdf/include/mupdf/pdf/object.h:62:10
    #303 0x7dc9a2 in pdf_stream_has_crypt /home/karas/mupdf/source/pdf/pdf-stream.c:51
    #304 0x7dc9a2 in pdf_open_raw_filter /home/karas/mupdf/source/pdf/pdf-stream.c:317
    #305 0x7dcf4b in pdf_open_filter /home/karas/mupdf/source/pdf/pdf-stream.c:348:10
    #306 0x7dcd4a in pdf_open_image_stream /home/karas/mupdf/source/pdf/pdf-stream.c:467:9
    #307 0x7fff6a in pdf_load_obj_stm /home/karas/mupdf/source/pdf/pdf-xref.c:1590:9
    #308 0x7ff4f7 in pdf_cache_object /home/karas/mupdf/source/pdf/pdf-xref.c:1975:8
    #309 0x801437 in pdf_resolve_indirect /home/karas/mupdf/source/pdf/pdf-xref.c:2025:12

0x6080000000a0 is located 0 bytes inside of 88-byte region [0x6080000000a0,0x6080000000f8)
freed by thread T0 here:
    #0 0x4d8c80 in __interceptor_cfree.localalias.0 (/home/karas/mupdf/build/debug/mutool+0x4d8c80)
    #1 0x6a543b in fz_free /home/karas/mupdf/source/fitz/memory.c:201:2

previously allocated by thread T0 here:
    #0 0x4d8e48 in malloc (/home/karas/mupdf/build/debug/mutool+0x4d8e48)
    #1 0x6a3a30 in do_scavenging_malloc /home/karas/mupdf/source/fitz/memory.c:22:7
    #2 0x6a3a30 in fz_calloc /home/karas/mupdf/source/fitz/memory.c:124
    #3 0x71fbf6 in fz_new_stream /home/karas/mupdf/source/fitz/stream-open.c:34:9

SUMMARY: AddressSanitizer: heap-use-after-free /home/karas/mupdf/source/fitz/fitz-imp.h:191:7 in fz_drop_imp
Shadow bytes around the buggy address:
  0x0c107fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff8000: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
=&gt;0x0c107fff8010: fa fa fa fa[fd]fd fd fd fd fd fd fd fd fd fd fa
  0x0c107fff8020: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c107fff8030: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c107fff8040: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c107fff8050: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c107fff8060: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==3312==ABORTING
```

=================
[Acknowledgement]
This work was supported by ICT R&amp;D program of MSIP/IITP. [R7518-16-1001, Innovation hub for high Performance Computing]</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=698965#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rasmussen</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-01-29 15:38:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">A quick analysis shows that this is the same issue as in a previously reported bug for which I have a tentative commit awaiting review. That commit does not yet address the entire issue (it takes a HUGE amount of time), but it fixes the crash.

*** This bug has been marked as a duplicate of <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - denial of service in seek_file"
   href="show_bug.cgi?id=698830">bug 698830</a> ***</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=698965">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=698965">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=698965">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=698965&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=698965" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=698965&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619344-crrUny8ZZlJYHAp7sW2TKE-r2rptyyCy4p9vs1A8iaQ">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>