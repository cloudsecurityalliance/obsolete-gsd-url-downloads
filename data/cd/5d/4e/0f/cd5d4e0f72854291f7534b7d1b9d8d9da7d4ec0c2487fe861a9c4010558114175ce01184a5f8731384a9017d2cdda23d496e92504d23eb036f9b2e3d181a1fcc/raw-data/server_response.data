<!DOCTYPE html>
<html lang="en">
<head>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92665328-1"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'UA-92665328-1');
    </script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>[CVE-2017-5622] OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access</title>
<meta name="name" content="CVE-2017-5622">
<meta name="description" content="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access">
<meta name="image" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@alephsecurity">
<meta name="twitter:creator" content="@alephsecurity">
<meta name="twitter:title" content="CVE-2017-5622">
<meta name="twitter:url" content="https://alephsecurity.com/vulns/aleph-2017004">
<meta name="twitter:description" content="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access">
<meta name="twitter:image:src" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta property="og:site_name" content="">
<meta property="og:title" content="CVE-2017-5622">
<meta property="og:type" content="article">
<meta property="og:description" content="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access">
<meta property="og:url" content="https://alephsecurity.com/vulns/aleph-2017004">
<meta property="article:published_time" content="2017-03-26T00:00:00+00:00">
<meta property="article:author" content="https://alephsecurity.com">
<meta property="og:image" content="https://alephsecurity.com/assets/img/logo-black.png">
<link rel="icon" href="/favicon.png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
<link rel="stylesheet" type="text/css" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      messageStyle: "none",
      tex2jax: {preview: "none"},
      CommonHTML: { linebreaks: { automatic: true } },
      "HTML-CSS": { linebreaks: { automatic: true } },
      SVG: { linebreaks: { automatic: true } }
    });
    </script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
<div class="wrapper">
<div class="page__back">
<a href="/">&lt;-- <span class="smallogo">א</span></a>
</div>
<div class="page">
<div class="advisory">
<div class="advisory__title">
<h1>OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access</h1>
</div>
<div class="advisory__subtitle">
Aleph Research Advisory
</div>
<div class="advisory__meta">
<p></p>
</div>
<h2>Identifier</h2>
<div class="cve-critical"><span class="" title="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access"><a href="/vulns/aleph-2017004">CVE-2017-5622</a></span></div>
<h2>Severity</h2>
Critical
<h2>Products</h2>
<div class="numberedlistnoalternative">
<ol>
<li><p>OnePlus 3T</p>
</li>
<li><p>OnePlus 3</p>
</li>
</ol>
</div>
<h2>Vulnerable Version</h2>
<p>OxygenOS 4.0.2 and below.</p>
<h2>Mitigation</h2>
<p>Upgrade to OxygenOS 4.0.3 or later.</p>
<h2>Technical Details</h2>
<div class="advisory__content" ?>
<p>When a charger is connected to a powered off OnePlus 3/3T device, the platform starts <code class="language-plaintext highlighter-rouge">adbd</code> with <a href="https://android.googlesource.com/platform/system/core/+/master/adb/protocol.txt">ADB authorization</a> disabled. Therefore, a malicious charger or a physical attacker can open up, without authorization, an ADB session with the device, in order to further exploit other vulnerabilities and/or exfiltrate information from the device. For example, the malicious charger can reboot the device into the bootloader mode (<code class="language-plaintext highlighter-rouge">fastboot</code>) in order to exploit <code class="language-plaintext highlighter-rouge">fastboot</code> related vulnerabilities, as detailed in the <a href="/2017/03/26/oneplus3t-adb-charger/">blog post</a>.</p>
<p>The following video presents how a ‘charger’ can exploit <span class="cve-critical" title="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access"><a href="/vulns/aleph-2017004">CVE-2017-5622</a></span> &amp; <span class="cve-critical" title="OnePlus 3/3T OxygenOS 4F500301 Bootloader Locking Bypass"><a href="/vulns/aleph-2017003">CVE-2017-5626</a></span> for gaining a <strong>root shell, putting SELinux in <code class="language-plaintext highlighter-rouge">permissive</code> mode, and even executing kernel code</strong>:</p>
<div class="movie"><iframe width="560" height="315" src="https://www.youtube.com/embed/tDRPWvYJYfU?rel=0?ecver=1" frameborder="0" allowfullscreen=""></iframe></div>
<p>The following video shows how a ‘charger’ exploits <span class="cve-critical" title="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access"><a href="/vulns/aleph-2017004">CVE-2017-5622</a></span>, <span class="cve-moderate" title="OnePlus 3/3T OxygenOS dm-verity Security Bypass"><a href="/vulns/aleph-2017002">CVE-2017-5624</a></span> &amp; <span class="cve-critical" title="OnePlus 3/3T OxygenOS 4F500301 Bootloader Locking Bypass"><a href="/vulns/aleph-2017003">CVE-2017-5626</a></span> for replacing the <code class="language-plaintext highlighter-rouge">system</code> partition in order to <strong>install a privileged app</strong>. Please note that once the replacement is complete, the victim has no indication that the device has been tampered with:</p>
<div class="movie"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZqCzPua0RCA?rel=0?ecver=1" frameborder="0" allowfullscreen=""></iframe></div>
</div>
<h2>Timeline</h2>
<div class="list"><ul><li><div class="list__date"><span>26-Mar-17<span></div>: Public disclosure.</li><li><div class="list__date"><span>01-Mar-17<span></div>: Added as <span class="cve-critical" title="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access"><a href="/vulns/aleph-2017004">ALEPH-2017004</a></span>.</li><li><div class="list__date"><span>29-Jan-17<span></div>: <span class="cve-critical" title="OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access"><a href="/vulns/aleph-2017004">CVE-2017-5622</a></span> assigned.</li><li><div class="list__date"><span>25-Jan-17<span></div>: CVE ID requested.</li></ul></div>
<h2>Posts</h2>
<div class="pagelist__narrow"><ul>  <li onclick="javscript:document.location.href='/2017/03/26/oneplus3t-adb-charger/'"> <a href="/2017/03/26/oneplus3t-adb-charger/">Owning OnePlus 3/3T with a Malicious Charger: The Last Piece of the Puzzle </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a>, <div class="pagelist__date"><span>26-Mar 2017</span></div></div></li> </ul></div>
<h2>Credit</h2>
<div class="list">
<ul>
<li>
<a href="/authors/roeeh">Roee Hay</a> (<a href="https://twitter.com/roeehay">@roeehay</a>) of Aleph Research, HCL Technologies
</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
