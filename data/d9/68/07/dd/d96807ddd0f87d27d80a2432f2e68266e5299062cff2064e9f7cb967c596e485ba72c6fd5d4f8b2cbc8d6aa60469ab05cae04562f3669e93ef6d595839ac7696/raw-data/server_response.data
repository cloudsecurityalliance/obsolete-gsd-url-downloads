<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/keystone/+bug/1872737/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1872737 “[OSSA-2020-003] Keystone doesn't check signature T...” : Bugs : OpenStack Identity (keystone)</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1872737" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1872737/bug.atom" title="Bug 1872737 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="AWS Signature V4 has a limited TTL for a token signature, used to perform an authenticated request, usually it is 5 minutes. If there is a MITM possible, then an attacker can use a sniffed header only within 5 minutes.

Keystone doesn't have a signature TTL check, and if an attacker can sniff an auth header, this header can be used an unlimited number of times to reissue an openstack token.

I have an https://github.com/kayrus/ec2auth tool to auth against keystone using ec2 credentials. If yo..." />
      <meta property="og:description" content="AWS Signature V4 has a limited TTL for a token signature, used to perform an authenticated request, usually it is 5 minutes. If there is a MITM possible, then an attacker can use a sniffed header only within 5 minutes.

Keystone doesn't have a signature TTL check, and if an attacker can sniff an auth header, this header can be used an unlimited number of times to reissue an openstack token.

I have an https://github.com/kayrus/ec2auth tool to auth against keystone using ec2 credentials. If yo..." />
    

    
    
      <meta property="og:title" content="Bug #1872737 “[OSSA-2020-003] Keystone doesn't check signature T...” : Bugs : OpenStack Identity (keystone)" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1872737" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["api-ref", "caching", "configuration", "default-roles", "documentation", "federation", "fernet", "fix-requires-microversion", "hierarchical-multitenancy", "i18n", "jwt", "ldap", "limits", "logging", "low-hanging-fruit", "meeting-topic", "notifications", "ocata-backport-potential", "office-hours", "ops", "password", "pci", "performance", "pike-backport-potential", "pki", "policy", "python3", "queens-backport-potential", "rc-potential", "revoke", "rfe", "rocky-backport-potential", "security", "sql", "system-scope", "test-improvement", "trusts", "upgrades", "user-experience", "x509"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/keystone/+bug/1872737/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/keystone"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/keystone">OpenStack Identity (keystone)</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/keystone">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/keystone">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/keystone">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/keystone">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/keystone">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/keystone">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA-2020-003] Keystone doesn't check signature TTL of the EC2 credential auth method (CVE-2020-12692)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1872737 reported by
      <a href="https://launchpad.net/~kay-diam" class="sprite person">kay</a>
      <time title="2020-04-14 15:07:01 UTC" datetime="2020-04-14T15:07:01.303464+00:00">on 2020-04-14</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">260</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary2591947">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/keystone/+bug/1872737/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2591947">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/keystone">OpenStack Identity (keystone)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/keystone/+bug/1872737/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/keystone/+bug/1872737/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceMEDIUM">Medium</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2591947">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~krinkle">Colleen Murphy</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/keystone/+milestone/ussuri-rc1">OpenStack Identity (keystone) ussuri-rc1</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2591947">
     <td colspan="7"><form action="/keystone/+bug/1872737/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/keystone">OpenStack Identity (keystone)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~kay-diam" class="sprite person">kay</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2020-04-14 15:07:01 UTC" datetime="2020-04-14T15:07:01.303464+00:00">2020-04-14</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2020-04-17 17:35:44 UTC" datetime="2020-04-17T17:35:44.661213+00:00">2020-04-17</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2020-04-17 17:35:52 UTC" datetime="2020-04-17T17:35:52.426626+00:00">2020-04-17</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2020-04-17 17:35:44 UTC" datetime="2020-04-17T17:35:44.661213+00:00">2020-04-17</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-04-30 20:22:27 UTC" datetime="2020-04-30T20:22:27.738099+00:00">2020-04-30</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="keystone.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="keystone.target.option.package" name="keystone.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="keystone.target.distribution" name="keystone.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="keystone.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="keystone.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="keystone.target.package"
                         name="keystone.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;keystone.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('keystone.target.package');
              var select_menu = Y.DOM.byId('keystone.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-keystone-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "keystone.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-keystone-target-package", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-keystone-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="keystone.target.option.product" name="keystone.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="keystone" id="keystone.target.product"
                         name="keystone.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;keystone.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('keystone.target.product');
              var select_menu = Y.DOM.byId('keystone.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-keystone-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "keystone.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-keystone-target-product", "selected_value": "keystone", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-keystone-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="keystone.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="keystone.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="keystone.status" name="keystone.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="keystone.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceMEDIUM">Medium</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          OpenStack Identity (keystone) ussuri-rc1
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="keystone.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="keystone.assignee.assign_to_me" name="keystone.assignee.option" value="keystone.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="keystone.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="keystone.assignee.assigned_to" name="keystone.assignee.option" value="keystone.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="keystone.assignee.assigned_to">
              Colleen Murphy (krinkle)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="keystone.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="keystone.comment_on_change" name="keystone.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary2591967">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1872737/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2591967">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1872737/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1872737/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2591967">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~gagehugo">Gage Hugo</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2591967">
     <td colspan="7"><form action="/ossa/+bug/1872737/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2020-04-14 15:45:38 UTC" datetime="2020-04-14T15:45:38.747203+00:00">2020-04-14</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2020-05-06 18:07:16 UTC" datetime="2020-05-06T18:07:16.894666+00:00">2020-05-06</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2020-05-06 14:58:41 UTC" datetime="2020-05-06T14:58:41.925710+00:00">2020-05-06</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2020-05-06 18:07:16 UTC" datetime="2020-05-06T18:07:16.894666+00:00">2020-05-06</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-08-17 14:27:08 UTC" datetime="2020-08-17T14:27:08.920078+00:00">2020-08-17</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "ossa.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-ossa-target-package", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "ossa.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-ossa-target-product", "selected_value": "ossa", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Gage Hugo (gagehugo)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/keystone/+bug/1872737/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/keystone/+bug/1872737/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/keystone/+bug/1872737/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>AWS Signature V4 has a limited TTL for a token signature, used to perform an authenticated request, usually it is 5 minutes. If there is a MITM possible, then an attacker can use a sniffed header only within 5 minutes.</p>
<p>Keystone doesn&#x27;t have a signature TTL check, and if an attacker can sniff an auth header, this header can be used an unlimited number of times to reissue an openstack token.</p>
<p>I have an <a rel="nofollow" href="https://github.com/kayrus/ec2auth">https:/<wbr />/github.<wbr />com/kayrus/<wbr />ec2auth</a> tool to auth against keystone using ec2 credentials. If you set a timestamp (<a rel="nofollow" href="https://godoc.org/github.com/gophercloud/gophercloud/openstack/identity/v3/extensions/ec2tokens#AuthOptions">https:/<wbr />/godoc.<wbr />org/github.<wbr />com/gophercloud<wbr />/gophercloud/<wbr />openstack/<wbr />identity/<wbr />v3/extensions/<wbr />ec2tokens#<wbr />AuthOptions</a>) to &quot;time.Time{}&quot; here: <a rel="nofollow" href="https://github.com/kayrus/ec2auth/blob/master/pkg/main.go#L40">https:/<wbr />/github.<wbr />com/kayrus/<wbr />ec2auth/<wbr />blob/master/<wbr />pkg/main.<wbr />go#L40</a>, keystone will identify this token as a valid one and return a valid openstack token.</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          <span>See <a href="comments/0">original description</a></span>
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            Tags:
          </span>
          <span id="tag-list">
            <a class="unofficial-tag" href="/keystone/+bugs?field.tag=in-stable-pike">in-stable-pike</a>
            <a class="unofficial-tag" href="/keystone/+bugs?field.tag=in-stable-queens">in-stable-queens</a>
            <a class="unofficial-tag" href="/keystone/+bugs?field.tag=in-stable-rocky">in-stable-rocky</a>
            <a class="unofficial-tag" href="/keystone/+bugs?field.tag=in-stable-stein">in-stable-stein</a>
            <a class="unofficial-tag" href="/keystone/+bugs?field.tag=in-stable-train">in-stable-train</a>
            <a class="unofficial-tag" href="/keystone/+bugs?field.tag=in-stable-ussuri">in-stable-ussuri</a>
          </span>
          
          <a href="+edit" title="Edit tags" id="tags-trigger" class="sprite edit action-icon">Edit</a>
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-12692" title="An issue was discovered in OpenStack ...">2020-12692</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~kay-diam" class="sprite person">kay (kay-diam)</a>
    
    <time title="2020-04-14 15:14:48 UTC" datetime="2020-04-14T15:14:48.595443+00:00">on 2020-04-14</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-14T15:47:51.285166+00:00" title="2020-04-14 15:47:51 UTC">on 2020-04-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Since this report concerns a possible security risk, an incomplete<br />
security advisory task has been added while the core security<br />
reviewers for the affected project or projects confirm the bug and<br />
discuss the scope of any vulnerability along with potential<br />
solutions.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Since this report concerns a possible security risk, an incomplete
security advisory task has been added while the core security
reviewers for the affected project or projects confirm the bug and
discuss the scope of any vulnerability along with potential
solutions.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-14T21:15:35.201139+00:00" title="2020-04-14 21:15:35 UTC">on 2020-04-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Confirmed that keystone does not verify the Timestamp attribute of a /v3/ec2tokens request. Can you add a link to the AWS documentation explaining the TTL? <a rel="nofollow" href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/AmazonS3/<wbr />latest/<wbr />API/sig-<wbr />v4-authenticati<wbr />ng-requests.<wbr />html</a> seems to indicate it&#x27;s 15 minutes but I am not sure if that is consistent or configurable.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Confirmed that keystone does not verify the Timestamp attribute of a /v3/ec2tokens request. Can you add a link to the AWS documentation explaining the TTL? https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html seems to indicate it's 15 minutes but I am not sure if that is consistent or configurable.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kay-diam" class="sprite person">kay (kay-diam)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-15T06:28:17.528754+00:00" title="2020-04-15 06:28:17 UTC">on 2020-04-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Colleen. Thanks for looking into this issue. The link you provided is correct. The &quot;requests are valid within 15 minutes of the timestamp in the request&quot; statement is also correct for Amazon API. The purpose of this bugreport is to introduce a configuration option in keystone with a default value, e.g. 15 minutes. Keystone should use this configuration option to validate EC2 signature TTL.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Colleen. Thanks for looking into this issue. The link you provided is correct. The "requests are valid within 15 minutes of the timestamp in the request" statement is also correct for Amazon API. The purpose of this bugreport is to introduce a configuration option in keystone with a default value, e.g. 15 minutes. Keystone should use this configuration option to validate EC2 signature TTL.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-17T00:12:37.594602+00:00" title="2020-04-17 00:12:37 UTC">on 2020-04-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5355816/+files/0001-Check-timestamp-of-signed-EC2-token-request.patch">0001-Check-timestamp-of-signed-EC2-token-request.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1872737/+attachment/5355816">Edit</a>
        (8.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Attaching patch to add an auth_ttl config option to validate against.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Attaching patch to add an auth_ttl config option to validate against.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kay-diam" class="sprite person">kay (kay-diam)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-17T08:17:15.147671+00:00" title="2020-04-17 08:17:15 UTC">on 2020-04-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Colleen, thanks for a patch.</p>
<p>I noticed that you&#x27;re referencing to &quot;timestamp = credentials[<wbr />&#x27;params&#x27;<wbr />].get(&#x27;<wbr />Timestamp&#x27;<wbr />)&quot;, which is not correct.</p>
<p>Currently timestamp is fetched from the headers&#x27; &quot;X-Amz-Date&quot;: <a rel="nofollow" href="https://github.com/openstack/python-keystoneclient/blob/a9d01eef93eef576bcecabf54e86c3a7a49651c8/keystoneclient/contrib/ec2/utils.py#L197">https:/<wbr />/github.<wbr />com/openstack/<wbr />python-<wbr />keystoneclient/<wbr />blob/a9d01eef93<wbr />eef576bcecabf54<wbr />e86c3a7a49651c8<wbr />/keystoneclient<wbr />/contrib/<wbr />ec2/utils.<wbr />py#L197</a><br />
If there is no headers &quot;X-Amz-Date&quot; element, logic should fallback to params[<wbr />&quot;X-Amz-<wbr />Date&quot;].</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Colleen, thanks for a patch.

I noticed that you're referencing to "timestamp = credentials['params'].get('Timestamp')", which is not correct.

Currently timestamp is fetched from the headers' "X-Amz-Date": https://github.com/openstack/python-keystoneclient/blob/a9d01eef93eef576bcecabf54e86c3a7a49651c8/keystoneclient/contrib/ec2/utils.py#L197
If there is no headers "X-Amz-Date" element, logic should fallback to params["X-Amz-Date"].</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-17T17:34:29.383254+00:00" title="2020-04-17 17:34:29 UTC">on 2020-04-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5356255/+files/0001-Check-timestamp-of-signed-EC2-token-request.patch">0001-Check-timestamp-of-signed-EC2-token-request.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1872737/+attachment/5356255">Edit</a>
        (12.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks for the review. It looks like our unit tests and API examples were designed for AWS Signature v2:</p>
<p><a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
<a rel="nofollow" href="https://opendev.org/openstack/keystone/src/branch/master/api-ref/source/v2-ext/samples/OS-KSEC2/authenticate-request.json">https:/<wbr />/opendev.<wbr />org/openstack/<wbr />keystone/<wbr />src/branch/<wbr />master/<wbr />api-ref/<wbr />source/<wbr />v2-ext/<wbr />samples/<wbr />OS-KSEC2/<wbr />authenticate-<wbr />request.<wbr />json</a></p>
<p>I&#x27;ve updated the patch to check for both v2 and v4 versions.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks for the review. It looks like our unit tests and API examples were designed for AWS Signature v2:

https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
https://opendev.org/openstack/keystone/src/branch/master/api-ref/source/v2-ext/samples/OS-KSEC2/authenticate-request.json

I've updated the patch to check for both v2 and v4 versions.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; In Progress
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Medium
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Colleen Murphy (krinkle)
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
    
    <time title="2020-04-21 17:06:24 UTC" datetime="2020-04-21T17:06:24.744054+00:00">on 2020-04-21</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; ussuri-rc1
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gagehugo" class="sprite person">Gage Hugo (gagehugo)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-21T19:48:20.326337+00:00" title="2020-04-21 19:48:20 UTC">on 2020-04-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The revised ps looks fine, thanks cmurphy.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The revised ps looks fine, thanks cmurphy.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~lbragstad" class="sprite person">Lance Bragstad (lbragstad)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-21T21:48:11.965431+00:00" title="2020-04-21 21:48:11 UTC">on 2020-04-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+2 to the patch set proposed in comment #6.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+2 to the patch set proposed in comment #6.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-22T03:56:00.185535+00:00" title="2020-04-22 03:56:00 UTC">on 2020-04-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5357807/+files/0001-Check-timestamp-of-signed-EC2-token-request.patch">0001-Check-timestamp-of-signed-EC2-token-request.patch</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1872737/+attachment/5357807">Edit</a>
        (12.7 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Please re-review the newly attached patch. Running the unit tests locally revealed an error in the handling of the timestamp parameter in the request body. Will attach a diff to show what I changed. This now passes the unit tests for me.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Please re-review the newly attached patch. Running the unit tests locally revealed an error in the handling of the timestamp parameter in the request body. Will attach a diff to show what I changed. This now passes the unit tests for me.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-22T03:56:26.976791+00:00" title="2020-04-22 03:56:26 UTC">on 2020-04-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5357808/+files/bug-1872737.2.diff">bug-1872737.2.diff</a>
        <a class="sprite edit action-icon" href="/keystone/+bug/1872737/+attachment/5357808">Edit</a>
        (1.0 KiB,
        text/plain)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Added diff</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Added diff</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-27T16:51:02.394056+00:00" title="2020-04-27 16:51:02 UTC">on 2020-04-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Is a CVE being requested for this? How can we move this forward?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Is a CVE being requested for this? How can we move this forward?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~gagehugo" class="sprite person">Gage Hugo (gagehugo)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-27T20:48:34.747354+00:00" title="2020-04-27 20:48:34 UTC">on 2020-04-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks for the diff, looks good to me.</p>
<p>With the attack vector here being sniffing the auth header/no TTL, then using the header to reissue openstack tokens, this appears to be a Class A.[0]  If this is agreed to be the case, I can work on drafting up an impact description here.</p>
<p>[0] <a rel="nofollow" href="https://security.openstack.org/vmt-process.html#incident-report-taxonomy">https:/<wbr />/security.<wbr />openstack.<wbr />org/vmt-<wbr />process.<wbr />html#incident-<wbr />report-<wbr />taxonomy</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks for the diff, looks good to me.

With the attack vector here being sniffing the auth header/no TTL, then using the header to reissue openstack tokens, this appears to be a Class A.[0]  If this is agreed to be the case, I can work on drafting up an impact description here.

[0] https://security.openstack.org/vmt-process.html#incident-report-taxonomy</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-27T21:47:42.137725+00:00" title="2020-04-27 21:47:42 UTC">on 2020-04-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I agree that the failure to check the TTL qualifies this as a class AS report for a vulnerability and we should go ahead with an impact description and requesting a CVE assignment (basically Keystone&#x27;s not following through on one of the security measures it claims to implement). The requirement that the attacker be able to obtain a copy of the victim&#x27;s token, however, seems like it presents a significant mitigating factor which reduces the risk of dealing with this report in public. How do folks feel about switching this report to a public workflow? Are tokens generally &quot;easy&quot; to steal in a typical deployment/<wbr />environment?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I agree that the failure to check the TTL qualifies this as a class AS report for a vulnerability and we should go ahead with an impact description and requesting a CVE assignment (basically Keystone's not following through on one of the security measures it claims to implement). The requirement that the attacker be able to obtain a copy of the victim's token, however, seems like it presents a significant mitigating factor which reduces the risk of dealing with this report in public. How do folks feel about switching this report to a public workflow? Are tokens generally "easy" to steal in a typical deployment/environment?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-27T21:48:50.940319+00:00" title="2020-04-27 21:48:50 UTC">on 2020-04-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sorry, that should read &quot;...as a class A report for a vulnerability...&quot; (we don&#x27;t have any &quot;AS&quot; classification).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sorry, that should read "...as a class A report for a vulnerability..." (we don't have any "AS" classification).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~krinkle" class="sprite person">Colleen Murphy (krinkle)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-27T23:14:12.296939+00:00" title="2020-04-27 23:14:12 UTC">on 2020-04-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; The requirement that the attacker be able to obtain a copy of the victim&#x27;s token, however, seems like it presents a significant mitigating factor which reduces the risk of dealing with this report in public. How do folks feel about switching this report to a public workflow? Are tokens generally &quot;easy&quot; to steal in a typical deployment/<wbr />environment?
</span></p>
<p>In a typical production environment, all traffic should use HTTPS between all involved services and I would not expect there to be any reason to write the AWS token to disk, so I would tend to agree that the bar for stealing this token is high. kay may be able to give more insight about the typical workflow for this feature.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; The requirement that the attacker be able to obtain a copy of the victim's token, however, seems like it presents a significant mitigating factor which reduces the risk of dealing with this report in public. How do folks feel about switching this report to a public workflow? Are tokens generally "easy" to steal in a typical deployment/environment?

In a typical production environment, all traffic should use HTTPS between all involved services and I would not expect there to be any reason to write the AWS token to disk, so I would tend to agree that the bar for stealing this token is high. kay may be able to give more insight about the typical workflow for this feature.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kay-diam" class="sprite person">kay (kay-diam)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-28T04:48:03.437144+00:00" title="2020-04-28 04:48:03 UTC">on 2020-04-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Agree. Signature can be reused only within a MITM attack, or when someone shared a screen with a debug log.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Agree. Signature can be reused only within a MITM attack, or when someone shared a screen with a debug log.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-28T18:35:16.372318+00:00" title="2020-04-28 18:35:16 UTC">on 2020-04-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks for the feedback, I&#x27;ve switched this to our public workflow effectively ending the embargo. The fixes/backports and advisory for it can be handled publicly in code review.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks for the feedback, I've switched this to our public workflow effectively ending the embargo. The fixes/backports and advisory for it can be handled publicly in code review.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>description</b>:
      </td>
      <td>
        updated
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-28T18:45:52.488313+00:00" title="2020-04-28 18:45:52 UTC">on 2020-04-28</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/18">
                <strong>Fix proposed to keystone (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: master<br />
Review: <a rel="nofollow" href="https://review.opendev.org/724124">https:/<wbr />/review.<wbr />opendev.<wbr />org/724124</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: master
Review: https://review.opendev.org/724124</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-30T20:22:29.721493+00:00" title="2020-04-30 20:22:29 UTC">on 2020-04-30</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/19">
                <strong>Fix merged to keystone (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/724124">https:/<wbr />/review.<wbr />opendev.<wbr />org/724124</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=ab89ea749013e7f2c46260f68504f5687763e019">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=ab89ea74901<wbr />3e7f2c46260f685<wbr />04f5687763e019</a><br />
Submitter: Zuul<br />
Branch:    master</p>
<p>commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/724124
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=ab89ea749013e7f2c46260f68504f5687763e019
Submitter: Zuul
Branch:    master

commit ab89ea749013e7f2c46260f68504f5687763e019
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in keystone: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-04-30T20:25:22.958084+00:00" title="2020-04-30 20:25:22 UTC">on 2020-04-30</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/20">
                <strong>Fix proposed to keystone (stable/ussuri)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/ussuri<br />
Review: <a rel="nofollow" href="https://review.opendev.org/724746">https:/<wbr />/review.<wbr />opendev.<wbr />org/724746</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/ussuri
Review: https://review.opendev.org/724746</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-02T02:46:10.241285+00:00" title="2020-05-02 02:46:10 UTC">on 2020-05-02</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/21">
                <strong>Fix merged to keystone (stable/ussuri)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/724746">https:/<wbr />/review.<wbr />opendev.<wbr />org/724746</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=8d5becbe4b463f6a5a24a1929dd0f48dab6ae027">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=8d5becbe4b4<wbr />63f6a5a24a1929d<wbr />d0f48dab6ae027</a><br />
Submitter: Zuul<br />
Branch:    stable/ussuri</p>
<p>commit 8d5becbe4b463f6<wbr />a5a24a1929dd0f4<wbr />8dab6ae027<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/724746
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=8d5becbe4b463f6a5a24a1929dd0f48dab6ae027
Submitter: Zuul
Branch:    stable/ussuri

commit 8d5becbe4b463f6a5a24a1929dd0f48dab6ae027
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
    (cherry picked from commit ab89ea749013e7f2c46260f68504f5687763e019)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-ussuri
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-02T03:51:43.714051+00:00" title="2020-05-02 03:51:43 UTC">on 2020-05-02</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/22">
                <strong>Fix proposed to keystone (stable/train)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/train<br />
Review: <a rel="nofollow" href="https://review.opendev.org/724954">https:/<wbr />/review.<wbr />opendev.<wbr />org/724954</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/train
Review: https://review.opendev.org/724954</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-03T04:37:20.290500+00:00" title="2020-05-03 04:37:20 UTC">on 2020-05-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/23">
                <strong>Fix proposed to keystone (stable/stein)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/stein<br />
Review: <a rel="nofollow" href="https://review.opendev.org/725069">https:/<wbr />/review.<wbr />opendev.<wbr />org/725069</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/stein
Review: https://review.opendev.org/725069</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-03T07:54:57.070758+00:00" title="2020-05-03 07:54:57 UTC">on 2020-05-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/24">
                <strong>Fix merged to keystone (stable/train)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/724954">https:/<wbr />/review.<wbr />opendev.<wbr />org/724954</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=e3f65d6fbcd18032a8ad3dfa3aaded264a282158">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=e3f65d6fbcd<wbr />18032a8ad3dfa3a<wbr />aded264a282158</a><br />
Submitter: Zuul<br />
Branch:    stable/train</p>
<p>commit e3f65d6fbcd1803<wbr />2a8ad3dfa3aaded<wbr />264a282158<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to six removal in e2d83ae9:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 8d5becbe4b463f6<wbr />a5a24a1929dd0f4<wbr />8dab6ae027)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/724954
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=e3f65d6fbcd18032a8ad3dfa3aaded264a282158
Submitter: Zuul
Branch:    stable/train

commit e3f65d6fbcd18032a8ad3dfa3aaded264a282158
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Conflicts due to six removal in e2d83ae9:
            keystone/api/_shared/EC2_S3_Resource.py
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
    (cherry picked from commit ab89ea749013e7f2c46260f68504f5687763e019)
    (cherry picked from commit 8d5becbe4b463f6a5a24a1929dd0f48dab6ae027)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-train
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-04T06:14:41.762714+00:00" title="2020-05-04 06:14:41 UTC">on 2020-05-04</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/25">
                <strong>Fix merged to keystone (stable/stein)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/725069">https:/<wbr />/review.<wbr />opendev.<wbr />org/725069</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=1ef3828516c1b87a8ca84acca73ec593b0b8591d">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=1ef3828516c<wbr />1b87a8ca84acca7<wbr />3ec593b0b8591d</a><br />
Submitter: Zuul<br />
Branch:    stable/stein</p>
<p>commit 1ef3828516c1b87<wbr />a8ca84acca73ec5<wbr />93b0b8591d<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to six removal in e2d83ae9:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 8d5becbe4b463f6<wbr />a5a24a1929dd0f4<wbr />8dab6ae027)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3f65d6fbcd1803<wbr />2a8ad3dfa3aaded<wbr />264a282158)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/725069
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=1ef3828516c1b87a8ca84acca73ec593b0b8591d
Submitter: Zuul
Branch:    stable/stein

commit 1ef3828516c1b87a8ca84acca73ec593b0b8591d
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Conflicts due to six removal in e2d83ae9:
            keystone/api/_shared/EC2_S3_Resource.py
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
    (cherry picked from commit ab89ea749013e7f2c46260f68504f5687763e019)
    (cherry picked from commit 8d5becbe4b463f6a5a24a1929dd0f48dab6ae027)
    (cherry picked from commit e3f65d6fbcd18032a8ad3dfa3aaded264a282158)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-stein
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-04T20:12:44.746684+00:00" title="2020-05-04 20:12:44 UTC">on 2020-05-04</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/26">
                <strong>Fix proposed to keystone (stable/rocky)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/rocky<br />
Review: <a rel="nofollow" href="https://review.opendev.org/725385">https:/<wbr />/review.<wbr />opendev.<wbr />org/725385</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/rocky
Review: https://review.opendev.org/725385</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gagehugo" class="sprite person">Gage Hugo (gagehugo)</a>
    
    <time title="2020-05-06 14:58:41 UTC" datetime="2020-05-06T14:58:41.274588+00:00">on 2020-05-06</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Gage Hugo (gagehugo)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gagehugo" class="sprite person">Gage Hugo (gagehugo)</a>
    
    <time title="2020-05-06 15:17:27 UTC" datetime="2020-05-06T15:17:27.008196+00:00">on 2020-05-06</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Keystone doesn&#x27;t check signature TTL of the EC2 credential auth method<br />+ [OSSA-2020-003] Keystone doesn&#x27;t check signature TTL of the EC2<br />+ credential auth method
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
          [OSSA-2020-003] Keystone doesn&#x27;t check signature TTL of the EC2<br />- credential auth method<br />+ credential auth method (CVE PENDING)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
    
    <time title="2020-05-06 18:07:15 UTC" datetime="2020-05-06T18:07:15.973924+00:00">on 2020-05-06</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-06T18:48:30.034196+00:00" title="2020-05-06 18:48:30 UTC">on 2020-05-06</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/27">
                <strong>Related fix merged to ossa (master)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/725879">https:/<wbr />/review.<wbr />opendev.<wbr />org/725879</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/ossa/commit/?id=e084cbd224faadb97bc9e1e5e131466416a295aa">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />ossa/commit/<wbr />?id=e084cbd224f<wbr />aadb97bc9e1e5e1<wbr />31466416a295aa</a><br />
Submitter: Zuul<br />
Branch:    master</p>
<p>commit e084cbd224faadb<wbr />97bc9e1e5e13146<wbr />6416a295aa<br />
Author: Gage Hugo &lt;email address hidden&gt;<br />
Date:   Wed May 6 09:46:08 2020 -0500</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Add OSSA-2020-003 (CVE Pending)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Related-Bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: I51b2199d573d0a<wbr />bf088befa8eb504<wbr />486708f8e70</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/725879
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=e084cbd224faadb97bc9e1e5e131466416a295aa
Submitter: Zuul
Branch:    master

commit e084cbd224faadb97bc9e1e5e131466416a295aa
Author: Gage Hugo &lt;gagehugo@gmail.com&gt;
Date:   Wed May 6 09:46:08 2020 -0500

    Add OSSA-2020-003 (CVE Pending)
    
    Related-Bug: #1872737
    Change-Id: I51b2199d573d0abf088befa8eb504486708f8e70
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-06T23:30:42.411277+00:00" title="2020-05-06 23:30:42 UTC">on 2020-05-06</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/28">
                <strong>Fix proposed to keystone (stable/pike)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/pike<br />
Review: <a rel="nofollow" href="https://review.opendev.org/726025">https:/<wbr />/review.<wbr />opendev.<wbr />org/726025</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/pike
Review: https://review.opendev.org/726025</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-08T14:16:56.433259+00:00" title="2020-05-08 14:16:56 UTC">on 2020-05-08</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/29">
                <strong>Fix proposed to keystone (stable/queens)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Fix proposed to branch: stable/queens<br />
Review: <a rel="nofollow" href="https://review.opendev.org/726400">https:/<wbr />/review.<wbr />opendev.<wbr />org/726400</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Fix proposed to branch: stable/queens
Review: https://review.opendev.org/726400</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-12T04:59:01.758490+00:00" title="2020-05-12 04:59:01 UTC">on 2020-05-12</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/30">
                <strong>Fix merged to keystone (stable/rocky)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/725385">https:/<wbr />/review.<wbr />opendev.<wbr />org/725385</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=35f09e2b7c00e03cd1d52a2337b51be38dd79480">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=35f09e2b7c0<wbr />0e03cd1d52a2337<wbr />b51be38dd79480</a><br />
Submitter: Zuul<br />
Branch:    stable/rocky</p>
<p>commit 35f09e2b7c00e03<wbr />cd1d52a2337b51b<wbr />e38dd79480<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to six removal in e2d83ae9:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to flask reorg:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 8d5becbe4b463f6<wbr />a5a24a1929dd0f4<wbr />8dab6ae027)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3f65d6fbcd1803<wbr />2a8ad3dfa3aaded<wbr />264a282158)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 1ef3828516c1b87<wbr />a8ca84acca73ec5<wbr />93b0b8591d)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/725385
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=35f09e2b7c00e03cd1d52a2337b51be38dd79480
Submitter: Zuul
Branch:    stable/rocky

commit 35f09e2b7c00e03cd1d52a2337b51be38dd79480
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Conflicts due to six removal in e2d83ae9:
            keystone/api/_shared/EC2_S3_Resource.py
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Conflicts due to flask reorg:
            keystone/api/_shared/EC2_S3_Resource.py
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
    (cherry picked from commit ab89ea749013e7f2c46260f68504f5687763e019)
    (cherry picked from commit 8d5becbe4b463f6a5a24a1929dd0f48dab6ae027)
    (cherry picked from commit e3f65d6fbcd18032a8ad3dfa3aaded264a282158)
    (cherry picked from commit 1ef3828516c1b87a8ca84acca73ec593b0b8591d)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-rocky
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~gagehugo" class="sprite person">Gage Hugo (gagehugo)</a>
    
    <time title="2020-05-12 05:09:13 UTC" datetime="2020-05-12T05:09:13.113624+00:00">on 2020-05-12</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
          [OSSA-2020-003] Keystone doesn&#x27;t check signature TTL of the EC2<br />- credential auth method (CVE PENDING)<br />+ credential auth method (CVE-2020-12692)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-05-14T00:56:33.755570+00:00" title="2020-05-14 00:56:33 UTC">on 2020-05-14</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/31">
                <strong>Fix merged to keystone (stable/queens)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/726400">https:/<wbr />/review.<wbr />opendev.<wbr />org/726400</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=b25739fa9605cc54bc98325c2a92360ba702e8d8">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=b25739fa960<wbr />5cc54bc98325c2a<wbr />92360ba702e8d8</a><br />
Submitter: Zuul<br />
Branch:    stable/queens</p>
<p>commit b25739fa9605cc5<wbr />4bc98325c2a9236<wbr />0ba702e8d8<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to six removal in e2d83ae9:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to v2.0 API testing in stable/queens. The v2.0 tests were<br />
&nbsp;&nbsp;&nbsp;&nbsp;removed in Rocky but in earlier releases we tested similar functionality<br />
&nbsp;&nbsp;&nbsp;&nbsp;between v3 and v2.0. This conflict was resolved by porting the timestamp<br />
&nbsp;&nbsp;&nbsp;&nbsp;to the v2.0 API test:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to flask reorg:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 8d5becbe4b463f6<wbr />a5a24a1929dd0f4<wbr />8dab6ae027)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3f65d6fbcd1803<wbr />2a8ad3dfa3aaded<wbr />264a282158)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 1ef3828516c1b87<wbr />a8ca84acca73ec5<wbr />93b0b8591d)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 35f09e2b7c00e03<wbr />cd1d52a2337b51b<wbr />e38dd79480)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/726400
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=b25739fa9605cc54bc98325c2a92360ba702e8d8
Submitter: Zuul
Branch:    stable/queens

commit b25739fa9605cc54bc98325c2a92360ba702e8d8
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Conflicts due to six removal in e2d83ae9:
            keystone/api/_shared/EC2_S3_Resource.py
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Conflicts due to v2.0 API testing in stable/queens. The v2.0 tests were
    removed in Rocky but in earlier releases we tested similar functionality
    between v3 and v2.0. This conflict was resolved by porting the timestamp
    to the v2.0 API test:
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Conflicts due to flask reorg:
            keystone/api/_shared/EC2_S3_Resource.py
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
    (cherry picked from commit ab89ea749013e7f2c46260f68504f5687763e019)
    (cherry picked from commit 8d5becbe4b463f6a5a24a1929dd0f48dab6ae027)
    (cherry picked from commit e3f65d6fbcd18032a8ad3dfa3aaded264a282158)
    (cherry picked from commit 1ef3828516c1b87a8ca84acca73ec593b0b8591d)
    (cherry picked from commit 35f09e2b7c00e03cd1d52a2337b51be38dd79480)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-queens
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/keystone/+bug/1872737/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~hudson-openstack" class="sprite person">OpenStack Infra (hudson-openstack)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-06-02T20:26:25.001009+00:00" title="2020-06-02 20:26:25 UTC">on 2020-06-02</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/keystone/+bug/1872737/comments/32">
                <strong>Fix merged to keystone (stable/pike)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/keystone/+bug/1872737/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed:  <a rel="nofollow" href="https://review.opendev.org/726025">https:/<wbr />/review.<wbr />opendev.<wbr />org/726025</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/keystone/commit/?id=1c1cf556f81058a63ea0bd5138540b0e6795f7a0">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />keystone/<wbr />commit/<wbr />?id=1c1cf556f81<wbr />058a63ea0bd5138<wbr />540b0e6795f7a0</a><br />
Submitter: Zuul<br />
Branch:    stable/pike</p>
<p>commit 1c1cf556f81058a<wbr />63ea0bd5138540b<wbr />0e6795f7a0<br />
Author: Colleen Murphy &lt;email address hidden&gt;<br />
Date:   Thu Apr 16 17:05:43 2020 -0700</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Check timestamp of signed EC2 token request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;EC2 token requests contain a signature that signs the entire request,<br />
&nbsp;&nbsp;&nbsp;&nbsp;including the access timestamp. While the signature is checked, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;timestamp is not, and so these signed requests remain valid<br />
&nbsp;&nbsp;&nbsp;&nbsp;indefinitely, leaving the token API vulnerable to replay attacks. This<br />
&nbsp;&nbsp;&nbsp;&nbsp;change introduces a configurable TTL for signed token requests and<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensures that the timestamp is actually validated against it.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;The check will work for either an AWS Signature v1/v2 &#x27;Timestamp&#x27;<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[1] or the AWS Signature v4 &#x27;X-Aws-Date&#x27; header or<br />
&nbsp;&nbsp;&nbsp;&nbsp;parameter[2].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Although this technically adds a new feature and the default value of<br />
&nbsp;&nbsp;&nbsp;&nbsp;the feature changes behavior, this change is required to protect<br />
&nbsp;&nbsp;&nbsp;&nbsp;credential holders and therefore must be backported to all supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;branches.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[1] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/signature-<wbr />version-<wbr />2.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;[2] <a rel="nofollow" href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html">https:/<wbr />/docs.aws.<wbr />amazon.<wbr />com/general/<wbr />latest/<wbr />gr/sigv4-<wbr />date-handling.<wbr />html</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to six removal in e2d83ae9:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to v2.0 API testing in stable/queens. The v2.0 tests were<br />
&nbsp;&nbsp;&nbsp;&nbsp;removed in Rocky but in earlier releases we tested similar functionality<br />
&nbsp;&nbsp;&nbsp;&nbsp;between v3 and v2.0. This conflict was resolved by porting the timestamp<br />
&nbsp;&nbsp;&nbsp;&nbsp;to the v2.0 API test:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />tests/unit/<wbr />test_contrib_<wbr />ec2_core.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Conflicts due to flask reorg:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keystone/<wbr />api/_shared/<wbr />EC2_S3_<wbr />Resource.<wbr />py</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Idb10267338b420<wbr />4b435df233c6360<wbr />46a1ce5711f<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-bug: #1872737<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit ab89ea749013e7f<wbr />2c46260f68504f5<wbr />687763e019)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 8d5becbe4b463f6<wbr />a5a24a1929dd0f4<wbr />8dab6ae027)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit e3f65d6fbcd1803<wbr />2a8ad3dfa3aaded<wbr />264a282158)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 1ef3828516c1b87<wbr />a8ca84acca73ec5<wbr />93b0b8591d)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit 35f09e2b7c00e03<wbr />cd1d52a2337b51b<wbr />e38dd79480)<br />
&nbsp;&nbsp;&nbsp;&nbsp;(cherry picked from commit d6f1006dd0ca8f7<wbr />999f32133d348fc<wbr />ec8f2299d3)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed:  https://review.opendev.org/726025
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=1c1cf556f81058a63ea0bd5138540b0e6795f7a0
Submitter: Zuul
Branch:    stable/pike

commit 1c1cf556f81058a63ea0bd5138540b0e6795f7a0
Author: Colleen Murphy &lt;colleen.murphy@suse.com&gt;
Date:   Thu Apr 16 17:05:43 2020 -0700

    Check timestamp of signed EC2 token request
    
    EC2 token requests contain a signature that signs the entire request,
    including the access timestamp. While the signature is checked, the
    timestamp is not, and so these signed requests remain valid
    indefinitely, leaving the token API vulnerable to replay attacks. This
    change introduces a configurable TTL for signed token requests and
    ensures that the timestamp is actually validated against it.
    
    The check will work for either an AWS Signature v1/v2 'Timestamp'
    parameter[1] or the AWS Signature v4 'X-Aws-Date' header or
    parameter[2].
    
    Although this technically adds a new feature and the default value of
    the feature changes behavior, this change is required to protect
    credential holders and therefore must be backported to all supported
    branches.
    
    [1] https://docs.aws.amazon.com/general/latest/gr/signature-version-2.html
    [2] https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html
    
    Conflicts due to six removal in e2d83ae9:
            keystone/api/_shared/EC2_S3_Resource.py
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Conflicts due to v2.0 API testing in stable/queens. The v2.0 tests were
    removed in Rocky but in earlier releases we tested similar functionality
    between v3 and v2.0. This conflict was resolved by porting the timestamp
    to the v2.0 API test:
            keystone/tests/unit/test_contrib_ec2_core.py
    
    Conflicts due to flask reorg:
            keystone/api/_shared/EC2_S3_Resource.py
    
    Change-Id: Idb10267338b4204b435df233c636046a1ce5711f
    Closes-bug: #1872737
    (cherry picked from commit ab89ea749013e7f2c46260f68504f5687763e019)
    (cherry picked from commit 8d5becbe4b463f6a5a24a1929dd0f48dab6ae027)
    (cherry picked from commit e3f65d6fbcd18032a8ad3dfa3aaded264a282158)
    (cherry picked from commit 1ef3828516c1b87a8ca84acca73ec593b0b8591d)
    (cherry picked from commit 35f09e2b7c00e03cd1d52a2337b51be38dd79480)
    (cherry picked from commit d6f1006dd0ca8f7999f32133d348fcec8f2299d3)
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>tags</b>:
      </td>
      <td>
        added: in-stable-pike
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~fungi" class="sprite person">Jeremy Stanley (fungi)</a>
    
    <time title="2020-08-17 14:27:08 UTC" datetime="2020-08-17T14:27:08.369506+00:00">on 2020-08-17</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/keystone/+bug/1872737/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/keystone/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/keystone/+bug/1872737/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/keystone/+bug/1872737/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/keystone/+bug/1872737/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/keystone/+bug/1872737/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/keystone/+bug/1872737/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/keystone/+bug/1872737/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/keystone/+bug/1872737/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/keystone/+bug/1872737/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/keystone/+bug/1872737/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5355816/+files/0001-Check-timestamp-of-signed-EC2-token-request.patch">0001-Check-timestamp-of-signed-EC2-token-request.patch</a>
        <small>
          (<a href="/keystone/+bug/1872737/+attachment/5355816">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5356255/+files/0001-Check-timestamp-of-signed-EC2-token-request.patch">0001-Check-timestamp-of-signed-EC2-token-request.patch</a>
        <small>
          (<a href="/keystone/+bug/1872737/+attachment/5356255">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5357807/+files/0001-Check-timestamp-of-signed-EC2-token-request.patch">0001-Check-timestamp-of-signed-EC2-token-request.patch</a>
        <small>
          (<a href="/keystone/+bug/1872737/+attachment/5357807">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/keystone/+bug/1872737/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/keystone/+bug/1872737/+attachment/5357808/+files/bug-1872737.2.diff">bug-1872737.2.diff</a>
        <small>
          (<a href="/keystone/+bug/1872737/+attachment/5357808">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/keystone/+bug/1872737/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "information_type_data": {"PUBLICSECURITY": {"name": "Public Security", "description_css_class": "choice-description", "is_private": false, "value": "PUBLICSECURITY", "description": "Everyone can see this security related information.\n", "order": 1}, "PRIVATESECURITY": {"name": "Private Security", "description_css_class": "choice-description", "is_private": true, "value": "PRIVATESECURITY", "description": "Only the security group can see this information.\n ", "order": 2}, "PUBLIC": {"name": "Public", "description_css_class": "choice-description", "is_private": false, "value": "PUBLIC", "description": "Everyone can see this information.\n", "order": 0}, "USERDATA": {"name": "Private", "description_css_class": "choice-description", "is_private": true, "value": "USERDATA", "description": "Only shared with users permitted to see private user information.\n", "order": 3}}, "initial_comment_batch_offset": 41, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1872737", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1872737"}, "first visible_recent_comment": -8, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1872737", "web_link": "https://bugs.launchpad.net/bugs/1872737", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1872737, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA-2020-003] Keystone doesn't check signature TTL of the EC2 credential auth method (CVE-2020-12692)", "description": "AWS Signature V4 has a limited TTL for a token signature, used to perform an authenticated request, usually it is 5 minutes. If there is a MITM possible, then an attacker can use a sniffed header only within 5 minutes.\n\nKeystone doesn't have a signature TTL check, and if an attacker can sniff an auth header, this header can be used an unlimited number of times to reissue an openstack token.\n\nI have an https://github.com/kayrus/ec2auth tool to auth against keystone using ec2 credentials. If you set a timestamp (https://godoc.org/github.com/gophercloud/gophercloud/openstack/identity/v3/extensions/ec2tokens#AuthOptions) to \"time.Time{}\" here: https://github.com/kayrus/ec2auth/blob/master/pkg/main.go#L40, keystone will identify this token as a valid one and return a valid openstack token.", "owner_link": "https://bugs.launchpad.net/api/devel/~kay-diam", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/bug_tasks", "duplicate_of_link": null, "date_created": "2020-04-14T15:07:01.303464+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/subscriptions", "date_last_updated": "2020-08-17T14:27:10.327293+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 260, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/attachments", "security_related": true, "latest_patch_uploaded": "2020-04-22T03:56:00.185535+00:00", "tags": ["in-stable-pike", "in-stable-queens", "in-stable-rocky", "in-stable-stein", "in-stable-train", "in-stable-ussuri"], "date_last_message": "2020-06-02T20:26:25.001009+00:00", "number_of_duplicates": 0, "message_count": 33, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1872737/linked_merge_proposals", "http_etag": "\"0ec04bf07a6c6fb819068616d1738a292432214b-b9f69f95d46782e699655267ea844e39bac8ebef\""}, "total_comments_and_activity": 63, "related_features": {}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/keystone/+bug/1872737", "web_link": "https://bugs.launchpad.net/keystone/+bug/1872737", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1872737", "milestone_link": "https://bugs.launchpad.net/api/devel/keystone/+milestone/ussuri-rc1", "status": "Fix Released", "importance": "Medium", "assignee_link": "https://bugs.launchpad.net/api/devel/~krinkle", "bug_target_display_name": "OpenStack Identity (keystone)", "bug_target_name": "keystone", "bug_watch_link": null, "date_assigned": "2020-04-17T17:35:52.426626+00:00", "date_created": "2020-04-14T15:07:01.303464+00:00", "date_confirmed": "2020-04-17T17:35:44.661213+00:00", "date_incomplete": null, "date_in_progress": "2020-04-17T17:35:44.661213+00:00", "date_closed": "2020-04-30T20:22:27.738099+00:00", "date_left_new": "2020-04-17T17:35:44.661213+00:00", "date_triaged": "2020-04-17T17:35:44.661213+00:00", "date_fix_committed": "2020-04-30T20:22:27.738099+00:00", "date_fix_released": "2020-04-30T20:22:27.738099+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~kay-diam", "target_link": "https://bugs.launchpad.net/api/devel/keystone", "title": "Bug #1872737 in OpenStack Identity (keystone): \"[OSSA-2020-003] Keystone doesn't check signature TTL of the EC2 credential auth method (CVE-2020-12692)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/keystone/+bug/1872737/related_tasks", "is_complete": true, "http_etag": "\"55c3a33a4fe1806227754466519ab6e8c8a6cc3b-8f8a921c73dfaafffb8aa020cc22b9fbda1d37e7\""}, "bugtask_data": {"2591947": {"bugtask_path": "/keystone/+bug/1872737", "bug_title": "[OSSA-2020-003] Keystone doesn't check signature TTL of the EC2 credential auth method (CVE-2020-12692)", "user_can_delete": false, "milestone_value": "https://bugs.launchpad.net/api/devel/keystone/+milestone/ussuri-rc1", "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "OpenStack Identity (keystone)", "hide_assignee_team_selection": true, "assignee_is_team": false, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/keystone/+bug/1872737/+delete", "row_id": "tasksummary2591947", "target_is_product": true, "id": 2591947, "form_row_id": "task2591947", "assignee_vocabulary_filters": [], "prefix": "keystone", "importance_value": "Medium", "status_value": "Fix Released", "assignee_value": "krinkle", "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}, "2591967": {"bugtask_path": "/ossa/+bug/1872737", "bug_title": "[OSSA-2020-003] Keystone doesn't check signature TTL of the EC2 credential auth method (CVE-2020-12692)", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "OpenStack Security Advisory", "hide_assignee_team_selection": true, "assignee_is_team": false, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ossa/+bug/1872737/+delete", "row_id": "tasksummary2591967", "target_is_product": true, "id": 2591967, "form_row_id": "task2591967", "assignee_vocabulary_filters": [], "prefix": "ossa", "importance_value": "Undecided", "status_value": "Fix Released", "assignee_value": "gagehugo", "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}}};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 58 queries/external actions issued in 0.75 seconds

    Features: {'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'bugs.affected_count_includes_dupes.disabled': None, 'baselayout.careers_link.disabled': None, 'js.yui_version': None, 'profiling.enabled': None, 'visible_render_time': None, 'hard_timeout': '9000', 'bugs.nominations.bug_supervisors_can_target': 'on', 'app.maintenance_message': None}

    r0d8de2b

    -->

</html>

