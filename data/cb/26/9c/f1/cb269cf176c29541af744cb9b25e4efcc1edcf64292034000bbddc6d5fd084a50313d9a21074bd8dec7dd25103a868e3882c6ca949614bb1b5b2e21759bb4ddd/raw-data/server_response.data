<!DOCTYPE html>
<html lang="en">
  <head>
    <title>10978 &ndash; Buildbot crash output: fuzz-2015-02-17-560.pcap</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link href="data/assets/64b49332a92937374625c24ed9a89c85.css?1635022386" rel="stylesheet" type="text/css">

<link href="data/assets/f6911ed8e5a97f108734d9324cb6bd67.css?1635022386" rel="stylesheet" type="text/css">

    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1635022386"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "10978 – Buildbot crash output: fuzz-2015-02-17-560.pcap",
                             "show_bug.cgi?id=10978" );
        document.title = "10978 – Buildbot crash output: fuzz-2015-02-17-560.pcap";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "10978 – Buildbot crash output: fuzz-2015-02-17-560.pcap", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1635022386"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-wireshark-org-bugzilla
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Wireshark
                 bz_component_Dissection_engine_&#X28;libwireshark&#X29;
                 bz_bug_10978 yui-skin-sam">

  <div id="header"><div id="banner">
      <a href="/bugzilla/"><img id="badge" src="/image/wsbadge-bug@186x57.png"></a>
      <span id="banner-text">
        Wireshark Bug Database &ndash; Bug&nbsp;10978
      </span>
      <div id="subtitle">
        <p class="subheader">Buildbot crash output: fuzz-2015-02-17-560.pcap</p>
      </div>

       <div id="motd_yellow">

<p>
This Bugzilla instance was migrated to <a href="https://gitlab.com/wireshark/wireshark">GitLab</a> on Sunday, August 23.
</p>


<p>
This bug has been migrated to <a href="https://gitlab.com/wireshark/wireshark/-/issues/10978">issue 10978</a> in the <a href="https://gitlab.com/wireshark/wireshark/-/issues">GitLab issue tracker</a>.
It can be viewed and updated there.
</p>


</p>

<p>
See the <a href="https://gitlab.com/wireshark/gitlab-migration/wikis/home">migration wiki</a> for more details.
</p>

       </div>


    </div>

<!-- WS: Title info is in the banner
    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;10978</span>
  
        <span id="subtitle" class="subheader">Buildbot crash output: fuzz-2015-02-17-560.pcap</span>

        <span id="information" class="header_addl_info">Last modified: 2015-05-31 19:02:25 UTC</span>
    </div>
  -->


    <div id="common_links"><ul class="links">
  <li><a href="https://www.wireshark.org/">Wireshark Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=10978&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=10978" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=10978&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635620902-DOBJp73XYB-God-zVWwfhMEAgTuugh-xZimKCy9-Qmk">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2015-05-31 19:02:25">
  <input type="hidden" name="id" value="10978">
  <input type="hidden" name="token" value="1635620902-4JX0iOxvMVs_JCS3BBQmP9oE73sveX6sNK9bILxIK1U">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=10978"><b>Bug&nbsp;10978</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">Buildbot crash output: fuzz-2015-02-17-560.pcap</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>Buildbot crash output: fuzz-2015-02-17-560.pcap
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'Buildbot crash output: fuzz-2015-02-17-560.pcap' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Wireshark

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Wireshark"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Dissection engine (libwireshark)

  (<a href="buglist.cgi?component=Dissection%20engine%20(libwireshark)&amp;product=Wireshark&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">x86-64
        Ubuntu
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>High
       Major<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=10978#vote_10978">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th><td>---
  </td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Bugzilla Administrator</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'bugzilla-admin\x40wireshark.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
          <a href="https://www.wireshark.org/download/automated/captures/fuzz-2015-02-17-560.pcap"
             rel="noreferrer"><span title="https://www.wireshark.org/download/automated/captures/fuzz-2015-02-17-560.pcap">https://www.wireshark.org/download/au...
        </span></a>
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label>Duplicates (4)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-01-19967.pcap"
   href="show_bug.cgi?id=11026">11026</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-07-15343.pcap"
   href="show_bug.cgi?id=11041">11041</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-16-14974.pcap"
   href="show_bug.cgi?id=11064">11064</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-22-3793.pcap"
   href="show_bug.cgi?id=11075">11075</a> 
      </span>
      (<a href="buglist.cgi?bug_id=11026,11041,11064,11075">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2015-02-19 11:20 UTC by <span class="vcard"><span class="fn">Buildbot Builder</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2015-05-31 19:02 UTC
      (<a href="show_activity.cgi?id=10978">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>3 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="eapache">eapache</option>
                <option value="gharris">gharris</option>
                <option value="mmann78">mmann78</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>



  <tr class="bz_attach_footer">
    <td colspan="2">
        <a href="attachment.cgi?bugid=10978&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=10978&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1490378926" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Buildbot Builder</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-02-19 11:20:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">Problems have been found with the following capture file:

<a href="https://www.wireshark.org/download/automated/captures/fuzz-2015-02-17-560.pcap">https://www.wireshark.org/download/automated/captures/fuzz-2015-02-17-560.pcap</a>

stderr:
Input file: /home/wireshark/menagerie/menagerie/frame_comp.enc

Build host information:
Linux wsbb04 3.13.0-45-generic #74-Ubuntu SMP Tue Jan 13 19:36:28 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
Distributor ID:	Ubuntu
Description:	Ubuntu 14.04.1 LTS
Release:	14.04
Codename:	trusty

Buildbot information:
BUILDBOT_REPOSITORY=ssh://<a href="/cdn-cgi/l/email-protection#56213f2433253e37243d7b34233f3a32343922707560626d3539323378213f2433253e37243d78392431">wireshark-buildbot&#64;code.wireshark.org</a>:29418/wireshark
BUILDBOT_BUILDNUMBER=3146
BUILDBOT_URL=<a href="http://buildbot.wireshark.org/trunk/">http://buildbot.wireshark.org/trunk/</a>
BUILDBOT_BUILDERNAME=Clang Code Analysis
BUILDBOT_SLAVENAME=clang-code-analysis
BUILDBOT_GOT_REVISION=e56f34e2005885dfe56834c11f1ff2b698d6d7e4

Return value:  0

Dissector bug:  0

Valgrind error count:  1



Git commit
<a href="https://code.wireshark.org/review/gitweb?p=wireshark.git;a=commit;h=e56f34e2005885dfe56834c11f1ff2b698d6d7e4">commit e56f34e2005885dfe56834c11f1ff2b698d6d7e4</a>
Author: Gerald Combs &lt;<a href="/cdn-cgi/l/email-protection#e88f8d9a89848ccecbdedcd39f819a8d9b80899a83c6879a8f">gerald&#64;wireshark.org</a>&gt;
Date:   Sun Feb 15 19:25:05 2015 -0800

    Suppress more pedantic warnings.
    
    Suppress
    
        warning: initialization of a flexible array member [-Wpedantic]
    
    Change-Id: <a href="https://code.wireshark.org/review/#/q/I49c2cf8b97539660742ef1b19752a0f56404d78a">I49c2cf8b97539660742ef1b19752a0f56404d78a</a>
    Reviewed-on: <a href="https://code.wireshark.org/review/7155">https://code.wireshark.org/review/7155</a>
    Reviewed-by: Gerald Combs &lt;<a href="/cdn-cgi/l/email-protection#05626077646961232633313e726c7760766d64776e2b6a7762">gerald&#64;wireshark.org</a>&gt;


Command and args: ./tools/valgrind-wireshark.sh 

==10171== Memcheck, a memory error detector
==10171== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.
==10171== Using Valgrind-3.10.0.SVN and LibVEX; rerun with -h for copyright info
==10171== Command: /home/wireshark/builders/wireshark-master-fuzz/clangcodeanalysis/install/bin/tshark -nr /fuzz/buildbot/clangcodeanalysis/valgrind-fuzz/fuzz-2015-02-17-560.pcap
==10171== 
==10171== Conditional jump or move depends on uninitialised value(s)
==10171==    at 0x6A89F5F: dissect_icmp (packet-icmp.c:1305)
==10171==    by 0x67119AE: call_dissector_through_handle (packet.c:612)
==10171==    by 0x6712344: call_dissector_work (packet.c:700)
==10171==    by 0x6712A8B: dissector_try_uint_new (packet.c:1132)
==10171==    by 0x6AD755C: dissect_ip (packet-ip.c:2427)
==10171==    by 0x6711973: call_dissector_through_handle (packet.c:614)
==10171==    by 0x6712344: call_dissector_work (packet.c:700)
==10171==    by 0x6712A8B: dissector_try_uint_new (packet.c:1132)
==10171==    by 0x6712AD6: dissector_try_uint (packet.c:1158)
==10171==    by 0x69D3308: dissect_fr_nlpid (packet-fr.c:759)
==10171==    by 0x69D33C5: dissect_fr_uncompressed (packet-fr.c:650)
==10171==    by 0x6711973: call_dissector_through_handle (packet.c:614)
==10171== 
==10171== 
==10171== HEAP SUMMARY:
==10171==     in use at exit: 1,221,145 bytes in 29,808 blocks
==10171==   total heap usage: 231,377 allocs, 201,569 frees, 29,070,718 bytes allocated
==10171== 
==10171== LEAK SUMMARY:
==10171==    definitely lost: 3,672 bytes in 157 blocks
==10171==    indirectly lost: 20,584 bytes in 50 blocks
==10171==      possibly lost: 16,384 bytes in 1 blocks
==10171==    still reachable: 1,180,505 bytes in 29,600 blocks
==10171==         suppressed: 0 bytes in 0 blocks
==10171== Rerun with --leak-check=full to see details of leaked memory
==10171== 
==10171== For counts of detected and suppressed errors, rerun with: -v
==10171== Use --track-origins=yes to see where uninitialised values come from
==10171== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)

[ no debug trace ]</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-02-20 01:09:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">==26238==  Uninitialised value was created by a heap allocation
==26238==    at 0x4C2ABA0: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==26238==    by 0xB8317C9: g_malloc (in /lib/x86_64-linux-gnu/libglib-2.0.so.0.4200.1)
==26238==    by 0x6B15564: wmem_simple_alloc (wmem_allocator_simple.c:55)
==26238==    by 0x74A61B1: get_wcp_window_ptr (packet-wcp.c:445)
==26238==    by 0x74A7002: wcp_save_data (packet-wcp.c:283)
==26238==    by 0x74A7002: dissect_wcp (packet-wcp.c:373)
==26238==    by 0x6A669E9: call_dissector_through_handle (packet.c:614)
==26238==    by 0x6A67BE0: call_dissector_work (packet.c:700)
==26238==    by 0x6A68852: dissector_try_uint_new (packet.c:1132)
==26238==    by 0x6A688F0: dissector_try_uint (packet.c:1158)
==26238==    by 0x6E77B17: dissect_fr_nlpid (packet-fr.c:759)
==26238==    by 0x6E7830F: dissect_fr_common (packet-fr.c:561)
==26238==    by 0x6A669E9: call_dissector_through_handle (packet.c:614)</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-02-20 01:16:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">So it looks like the problem must be in the wcp decompression logic somewhere, but I did a quick walk through it and didn't see any obvious problems.

The easy &quot;fix&quot; is to 0 the memory to begin with, but that doesn't really solve the root issue.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-03 21:25:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-01-19967.pcap"
   href="show_bug.cgi?id=11026">Bug 11026</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-11 16:32:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-07-15343.pcap"
   href="show_bug.cgi?id=11041">Bug 11041</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-17 22:47:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-16-14974.pcap"
   href="show_bug.cgi?id=11064">Bug 11064</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-17 23:07:17 UTC
        </span>

      </div>




<pre class="bz_comment_text">The issue is the decompression of frame 28, specifically around decompressed byte 38.</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Mann</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-21 16:51:56 UTC
        </span>

      </div>




<pre class="bz_comment_text">I agree that the problem can be seen in frame 28, but I think it's with byte 49 of frame (start of long compression).  I initialized the buffer memory to garbage (used memset(..., 0xCD, ...) for both buffers in get_wcp_window_ptr and the problem was much easier to see.  During the decompressed_entry() call, the first if statement (src &lt; buf_start) is true so the src pointer is incremented by MAX_WIN_BUF_LEN.  This makes no sense to me because MAX_WIN_BUF_LEN is the total size of a buffer, so what exactly is src pointing to after it's been incremented?  It seems to be copying from &quot;uninitialized memory&quot; (the 0xCD values I fake initialized it to)</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-21 17:00:43 UTC
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; but I think it's with byte 49 of frame</span >

I calculated byte 38 by putting a print statement in for every byte index, and then seeing after which byte the valgrind errors occurred, but I'm inclined to trust your method more.

<span class="quote">&gt; so the src pointer is incremented by MAX_WIN_BUF_LEN</span >

This whole code is really weird, but as far as I can tell it decompresses in-place (the decompressed bytes are written in the same buffer as the compressed bytes are read) and this is handled by treating it as a circular buffer. If my understanding is correct, then the increment makes some sense, as it is just &quot;we walked backwards past the front of the buffer, so wrap around&quot;.

If it is true that &quot;src &lt; buf_start&quot; at this point, and buf_start points to a buffer of length MAX_WIN_BUF_LEN, then &quot;src + MAX_WIN_BUF_LEN&quot; should result in a pointer into the buffer somewhere, shouldn't it?</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-21 17:09:41 UTC
        </span>

      </div>




<pre class="bz_comment_text">Oh, I think I understand what's going on. The compression format is basically saying &quot;these n bytes are the same as these other n bytes you've already seen at offset X&quot; except we haven't processed X bytes yet so we're not validating that offset and are getting uninitialized bytes (instead of out-of-bounds access) because of the circular buffer thing.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-21 17:20:35 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 7783 had a related patch set uploaded by Evan Huus:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/7783">https://code.wireshark.org/review/7783</a></pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Mann</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-21 18:07:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Evan Huus from <a href="show_bug.cgi?id=10978#c9">comment #9</a>)
<span class="quote">&gt; Oh, I think I understand what's going on. The compression format is
&gt; basically saying &quot;these n bytes are the same as these other n bytes you've
&gt; already seen at offset X&quot; except we haven't processed X bytes yet so we're
&gt; not validating that offset and are getting uninitialized bytes (instead of
&gt; out-of-bounds access) because of the circular buffer thing.</span >

I was trying to possibly find justifcation for your &quot;easy&quot; fix of just zeroing out the bytes, but didn't have any luck.  Based on your anaylsis does it make sense to wait until we've seen offset X for decompression?  Almost like this needs 2 passes to work?</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-24 02:01:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 7783 merged by Evan Huus:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/7783">https://code.wireshark.org/review/7783</a></pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-24 02:05:49 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 7800 had a related patch set uploaded by Evan Huus:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/7800">https://code.wireshark.org/review/7800</a></pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-24 02:10:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 7801 had a related patch set uploaded by Evan Huus:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/7801">https://code.wireshark.org/review/7801</a></pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Evan Huus</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-24 14:16:52 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Buildbot crash output: fuzz-2015-03-22-3793.pcap"
   href="show_bug.cgi?id=11075">Bug 11075</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-26 21:58:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 7800 merged by Evan Huus:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/7800">https://code.wireshark.org/review/7800</a></pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-26 21:58:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 7801 merged by Evan Huus:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/7801">https://code.wireshark.org/review/7801</a></pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-25 14:54:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 8624 had a related patch set uploaded by Balint Reczey:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/8624">https://code.wireshark.org/review/8624</a></pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-25 14:58:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 8624 merged by Balint Reczey:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/8624">https://code.wireshark.org/review/8624</a></pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-25 20:56:03 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 8636 had a related patch set uploaded by Balint Reczey:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/8636">https://code.wireshark.org/review/8636</a></pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=10978#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gerrit Code Review</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-05-31 19:02:25 UTC
        </span>

      </div>




<pre class="bz_comment_text">Change 8636 merged by Balint Reczey:
wcp: add validations to decompressed_entry

<a href="https://code.wireshark.org/review/8636">https://code.wireshark.org/review/8636</a></pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=10978">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=10978">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=10978">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="https://www.wireshark.org/">Wireshark Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=10978&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=10978" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=10978&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635620903-p7RvvQdcAg5aDnLhmu1BJlj4rQ5i8LKYzqIcsrZq7Y0">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>