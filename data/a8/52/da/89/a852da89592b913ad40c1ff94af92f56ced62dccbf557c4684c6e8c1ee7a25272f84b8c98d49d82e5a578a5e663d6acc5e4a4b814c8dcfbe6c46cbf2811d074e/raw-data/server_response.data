<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#278748 - mailx: unquoted recipient&#39;s name causes sending to fail - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=278748&quot;&gt;278748&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:278748@bugs.debian.org">#278748</a><br>
mailx: unquoted recipient&#39;s name causes sending to fail</h1>
<div class="versiongraph"><a href="version.cgi?package=mailx;absolute=0;fixed=mailx%2F1%3A8.1.2-0.20040524cvs-2;info=1;found=1%3A8.1.2-0.20040524cvs-1;collapse=1"><img alt="version graph" src="version.cgi?found=1%3A8.1.2-0.20040524cvs-1;package=mailx;fixed=mailx%2F1%3A8.1.2-0.20040524cvs-2;absolute=0;collapse=1;height=2;width=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=mailx">mailx</a>;
Maintainer for <a href="pkgreport.cgi?package=mailx">mailx</a> is <a href="pkgreport.cgi?maint=">(unknown)</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=musiphil%40bawi.org">Seungbeom Kim &lt;musiphil@bawi.org&gt;</a></p>
  <p>Date: Fri, 29 Oct 2004 04:18:03 UTC</p>

<p>Severity: important</p>
<p>Tags: patch, security</p>

<p>Found in version 1:8.1.2-0.20040524cvs-1</p>
<p>Fixed in version mailx/1:8.1.2-0.20040524cvs-2</p>

<p><strong>Done:</strong> Robert Luberda &lt;robert@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p><p>Forwarded to millert@openbsd.org, deraadt@openbsd.org</p>
</div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=278748;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<strong>Report forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Robert Luberda &lt;robert@debian.org&gt;</code>:<br>
<code>Bug#278748</code>; Package <code>mailx</code>.
(<a href="bugreport.cgi?bug=278748;msg=2">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<strong>Acknowledgement sent</strong> to <code>Seungbeom Kim &lt;musiphil@bawi.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Robert Luberda &lt;robert@debian.org&gt;</code>.
(<a href="bugreport.cgi?bug=278748;msg=4">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=5">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=5">mbox</a>, <a href="mailto:278748@bugs.debian.org?subject=Re%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;References=%3CE1CNO3D-0007el-00%40blue.bawi.org%3E&amp;body=On%20Fri%2C%2029%20Oct%202004%2013%3A07%3A43%20%2B0900%20Seungbeom%20Kim%20%3Cmusiphil%40bawi.org%3E%20wrote%3A%0A%3E%20Package%3A%20mailx%0A%3E%20Version%3A%201%3A8.1.2-0.20040524cvs-1%0A%3E%20Severity%3A%20important%0A%3E%20Tags%3A%20security%20l10n%20patch%0A%3E%20%0A%3E%20The%20MIME%20standards%20require%20mail%20headers%20be%20encoded%20unless%20they%27re%0A%3E%20in%20the%20US-ASCII%20charset%2C%20which%20notably%20results%20in%20the%20recipient%27s%0A%3E%20address%20having%20symbols%20such%20as%20%27%3F%27%20and%20%27%2F%27.%20For%20example%2C%20the%20following%0A%3E%20is%20a%20MIME-compliant%20header%3A%0A%3E%20%0A%3E%20%3E%20To%3A%20%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%0A%3E%20%0A%3E%20However%2C%20this%20version%20of%20mailx%20chokes%20on%20such%20an%20input%2C%20because%20it%0A%3E%20supplies%20the%20address%20to%20%22%2Fbin%2Fsh%20-c%20echo%20%25s%22%20without%20any%20quoting%2C%0A%3E%20causing%20a%20shell%20pattern%20matching%20failure%20with%20names%20that%20have%20%27%2F%27%20and%0A%3E%20%27%3F%27%20above.%0A%3E%20%0A%3E%20%3E%20bash%24%20%2Fusr%2Fbin%2Fmail%20%27%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%27%0A%3E%20%3E%20Subject%3A%20blah%20blah%0A%3E%20%3E%20blah%20blah%0A%3E%20%3E%20Cc%3A%0A%3E%20%3E%20%2Fbin%2Fbash%3A%20-c%3A%20line%201%3A%20syntax%20error%20near%20unexpected%20token%20%60newline%27%0A%3E%20%3E%20%2Fbin%2Fbash%3A%20-c%3A%20line%201%3A%20%60echo%20%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%27%0A%3E%20%3E%20%22%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%22%3A%20No%20match.%0A%3E%20%3E%20mail%3A%20%28null%29%3A%20Bad%20address%0A%3E%20%0A%3E%20Here%2C%20%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20is%20incorrectly%20interpreted%20as%20a%20shell%0A%3E%20pattern.%20It%20should%20be%20quoted%20in%20%27%27%20to%20prevent%20expansion.%0A%3E%20%0A%3E%20This%20could%20also%20be%20a%20security%20problem%20if%20a%20malicious%20user%20put%20shell%0A%3E%20metacharacters%20such%20as%20%27%3B%27%20or%20%27%3E%27%20to%20execute%20arbitrary%20commands%20or%0A%3E%20overwrite%20arbitrary%20files.%0A%3E%20%0A%3E%20A%20very%20quick%20patch%20would%20be%3A%0A%3E%20%0A%3E%20---%20fio.c.orig%092004-10-29%2012%3A22%3A37.000000000%20%2B0900%0A%3E%20%2B%2B%2B%20fio.c%092004-10-29%2012%3A51%3A16.000000000%20%2B0900%0A%3E%20%40%40%20-480%2C7%20%2B480%2C7%20%40%40%0A%3E%20%20%09%09warn%28%22pipe%22%29%3B%0A%3E%20%20%09%09return%28name%29%3B%0A%3E%20%20%09%7D%0A%3E%20-%09%28void%29snprintf%28cmdbuf%2C%20sizeof%28cmdbuf%29%2C%20%22echo%20%25s%22%2C%20name%29%3B%0A%3E%20%2B%09%28void%29snprintf%28cmdbuf%2C%20sizeof%28cmdbuf%29%2C%20%22echo%20%27%25s%27%22%2C%20name%29%3B%0A%3E%20%20%09shell%20%3D%20value%28%22SHELL%22%29%3B%0A%3E%20%20%09pid%20%3D%20start_command%28shell%2C%200%2C%20-1%2C%20pivec%5B1%5D%2C%20%22-c%22%2C%20cmdbuf%2C%20NULL%29%3B%0A%3E%20%20%09if%20%28pid%20%3C%200%29%20%7B%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%203.1%0A%3E%20%20%20APT%20prefers%20testing%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27testing%27%29%0A%3E%20Architecture%3A%20i386%20%28i686%29%0A%3E%20Kernel%3A%20Linux%202.4.20%0A%3E%20Locale%3A%20LANG%3Dko_KR.EUC-KR%2C%20LC_CTYPE%3Dko_KR.EUC-KR%0A%3E%20%0A%3E%20Versions%20of%20packages%20mailx%20depends%20on%3A%0A%3E%20ii%20%20base-files%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203.1%20%20%20%20%20%20%20%20%20%20Debian%20base%20system%20miscellaneous%20f%0A%3E%20ii%20%20exim%20%5Bmail-transport-agent%5D%203.36-11%20%20%20%20%20%20An%20MTA%20%28Mail%20Transport%20Agent%29%0A%3E%20ii%20%20libc6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.3.2.ds1-18%20GNU%20C%20Library%3A%20Shared%20libraries%20an%0A%3E%20ii%20%20liblockfile1%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.06%20%20%20%20%20%20%20%20%20NFS-safe%20locking%20library%2C%20includes%0A&amp;In-Reply-To=%3CE1CNO3D-0007el-00%40blue.bawi.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=musiphil%40bawi.org" alt="">
<div class="header"><span class="headerfield">From:</span> Seungbeom Kim &lt;musiphil@bawi.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> mailx: unquoted recipient&#39;s name causes sending to fail</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 29 Oct 2004 13:07:43 +0900</div>
</div>
<pre class="message">Package: mailx
Version: 1:8.1.2-0.20040524cvs-1
Severity: important
Tags: security l10n patch

The MIME standards require mail headers be encoded unless they&#39;re
in the US-ASCII charset, which notably results in the recipient&#39;s
address having symbols such as &#39;?&#39; and &#39;/&#39;. For example, the following
is a MIME-compliant header:

&gt; To: =?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;

However, this version of mailx chokes on such an input, because it
supplies the address to &quot;/bin/sh -c echo %s&quot; without any quoting,
causing a shell pattern matching failure with names that have &#39;/&#39; and
&#39;?&#39; above.

&gt; bash$ /usr/bin/mail &#39;=?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;&#39;
&gt; Subject: blah blah
&gt; blah blah
&gt; Cc:
&gt; /bin/bash: -c: line 1: syntax error near unexpected token `newline&#39;
&gt; /bin/bash: -c: line 1: `echo =?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;&#39;
&gt; &quot;=?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;&quot;: No match.
&gt; mail: (null): Bad address

Here, =?EUC-KR?B?sei8vL/4?= is incorrectly interpreted as a shell
pattern. It should be quoted in &#39;&#39; to prevent expansion.

This could also be a security problem if a malicious user put shell
metacharacters such as &#39;;&#39; or &#39;&gt;&#39; to execute arbitrary commands or
overwrite arbitrary files.

A very quick patch would be:

--- fio.c.orig	2004-10-29 12:22:37.000000000 +0900
+++ fio.c	2004-10-29 12:51:16.000000000 +0900
@@ -480,7 +480,7 @@
 		warn(&quot;pipe&quot;);
 		return(name);
 	}
-	(void)snprintf(cmdbuf, sizeof(cmdbuf), &quot;echo %s&quot;, name);
+	(void)snprintf(cmdbuf, sizeof(cmdbuf), &quot;echo &#39;%s&#39;&quot;, name);
 	shell = value(&quot;SHELL&quot;);
 	pid = start_command(shell, 0, -1, pivec[1], &quot;-c&quot;, cmdbuf, NULL);
 	if (pid &lt; 0) {

-- System Information:
Debian Release: 3.1
  APT prefers testing
  APT policy: (500, &#39;testing&#39;)
Architecture: i386 (i686)
Kernel: Linux 2.4.20
Locale: LANG=ko_KR.EUC-KR, LC_CTYPE=ko_KR.EUC-KR

Versions of packages mailx depends on:
ii  base-files                  3.1          Debian base system miscellaneous f
ii  exim [mail-transport-agent] 3.36-11      An MTA (Mail Transport Agent)
ii  libc6                       2.3.2.ds1-18 GNU C Library: Shared libraries an
ii  liblockfile1                1.06         NFS-safe locking library, includes

-- no debconf information


</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Robert Luberda &lt;robert@debian.org&gt;</code>:<br>
<code>Bug#278748</code>; Package <code>mailx</code>.
(<a href="bugreport.cgi?bug=278748;msg=7">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<strong>Acknowledgement sent</strong> to <code>Matt Zimmerman &lt;mdz@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Robert Luberda &lt;robert@debian.org&gt;</code>.
(<a href="bugreport.cgi?bug=278748;msg=9">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 278748@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=10">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=10">mbox</a>, <a href="mailto:278748@bugs.debian.org?In-Reply-To=%3C20041029045715.GI5602%40alcor.net%3E&amp;body=On%20Thu%2C%2028%20Oct%202004%2021%3A57%3A15%20-0700%20Matt%20Zimmerman%20%3Cmdz%40debian.org%3E%20wrote%3A%0A%3E%20On%20Fri%2C%20Oct%2029%2C%202004%20at%2001%3A07%3A43PM%20%2B0900%2C%20Seungbeom%20Kim%20wrote%3A%0A%3E%20%0A%3E%20%3E%20A%20very%20quick%20patch%20would%20be%3A%0A%3E%20%3E%20%0A%3E%20%3E%20---%20fio.c.orig%092004-10-29%2012%3A22%3A37.000000000%20%2B0900%0A%3E%20%3E%20%2B%2B%2B%20fio.c%092004-10-29%2012%3A51%3A16.000000000%20%2B0900%0A%3E%20%3E%20%40%40%20-480%2C7%20%2B480%2C7%20%40%40%0A%3E%20%3E%20%20%09%09warn%28%22pipe%22%29%3B%0A%3E%20%3E%20%20%09%09return%28name%29%3B%0A%3E%20%3E%20%20%09%7D%0A%3E%20%3E%20-%09%28void%29snprintf%28cmdbuf%2C%20sizeof%28cmdbuf%29%2C%20%22echo%20%25s%22%2C%20name%29%3B%0A%3E%20%3E%20%2B%09%28void%29snprintf%28cmdbuf%2C%20sizeof%28cmdbuf%29%2C%20%22echo%20%27%25s%27%22%2C%20name%29%3B%0A%3E%20%3E%20%20%09shell%20%3D%20value%28%22SHELL%22%29%3B%0A%3E%20%3E%20%20%09pid%20%3D%20start_command%28shell%2C%200%2C%20-1%2C%20pivec%5B1%5D%2C%20%22-c%22%2C%20cmdbuf%2C%20NULL%29%3B%0A%3E%20%3E%20%20%09if%20%28pid%20%3C%200%29%20%7B%0A%3E%20%0A%3E%20Unless%20the%20%22%27%22%20character%20is%20filtered%20from%20%27name%27%20elsewhere%20in%20the%20code%2C%20this%0A%3E%20doesn%27t%20close%20the%20hole.%0A%3E%20%0A%3E%20--%20%0A%3E%20%20-%20mdz%0A%3E%20%0A%3E%20%0A&amp;References=%3CE1CNO3D-0007el-00%40blue.bawi.org%3E%0A%20%3C20041029045715.GI5602%40alcor.net%3E&amp;subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mdz%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Matt Zimmerman &lt;mdz@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Seungbeom Kim &lt;musiphil@bawi.org&gt;, 278748@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 28 Oct 2004 21:57:15 -0700</div>
</div>
<pre class="message">On Fri, Oct 29, 2004 at 01:07:43PM +0900, Seungbeom Kim wrote:

&gt; A very quick patch would be:
&gt; 
&gt; --- fio.c.orig	2004-10-29 12:22:37.000000000 +0900
&gt; +++ fio.c	2004-10-29 12:51:16.000000000 +0900
&gt; @@ -480,7 +480,7 @@
&gt;  		warn(&quot;pipe&quot;);
&gt;  		return(name);
&gt;  	}
&gt; -	(void)snprintf(cmdbuf, sizeof(cmdbuf), &quot;echo %s&quot;, name);
&gt; +	(void)snprintf(cmdbuf, sizeof(cmdbuf), &quot;echo &#39;%s&#39;&quot;, name);
&gt;  	shell = value(&quot;SHELL&quot;);
&gt;  	pid = start_command(shell, 0, -1, pivec[1], &quot;-c&quot;, cmdbuf, NULL);
&gt;  	if (pid &lt; 0) {

Unless the &quot;&#39;&quot; character is filtered from &#39;name&#39; elsewhere in the code, this
doesn&#39;t close the hole.

-- 
 - mdz


</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Robert Luberda &lt;robert@debian.org&gt;</code>:<br>
<code>Bug#278748</code>; Package <code>mailx</code>.
(<a href="bugreport.cgi?bug=278748;msg=12">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<strong>Acknowledgement sent</strong> to <code>Seungbeom Kim &lt;musiphil@bawi.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Robert Luberda &lt;robert@debian.org&gt;</code>.
(<a href="bugreport.cgi?bug=278748;msg=14">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 278748@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=15">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=15">mbox</a>, <a href="mailto:278748@bugs.debian.org?References=%3CE1CNO3D-0007el-00%40blue.bawi.org%3E%20%3C20041029045715.GI5602%40alcor.net%3E%0A%20%3C4181E63C.6030103%40bawi.org%3E&amp;subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%0A%20fail&amp;In-Reply-To=%3C4181E63C.6030103%40bawi.org%3E&amp;body=On%20Thu%2C%2028%20Oct%202004%2023%3A42%3A04%20-0700%20Seungbeom%20Kim%20%3Cmusiphil%40bawi.org%3E%20wrote%3A%0A%3E%20Matt%20Zimmerman%20wrote%3A%0A%3E%20%0A%3E%20%3E%20On%20Fri%2C%20Oct%2029%2C%202004%20at%2001%3A07%3A43PM%20%2B0900%2C%20Seungbeom%20Kim%20wrote%3A%0A%3E%20%3E%20%0A%3E%20%3E%3EA%20very%20quick%20patch%20would%20be%3A%0A%3E%20%3E%3E%0A%3E%20%3E%3E---%20fio.c.orig%092004-10-29%2012%3A22%3A37.000000000%20%2B0900%0A%3E%20%3E%3E%2B%2B%2B%20fio.c%092004-10-29%2012%3A51%3A16.000000000%20%2B0900%0A%3E%20%3E%3E%40%40%20-480%2C7%20%2B480%2C7%20%40%40%0A%3E%20%3E%3E%20%09%09warn%28%22pipe%22%29%3B%0A%3E%20%3E%3E%20%09%09return%28name%29%3B%0A%3E%20%3E%3E%20%09%7D%0A%3E%20%3E%3E-%09%28void%29snprintf%28cmdbuf%2C%20sizeof%28cmdbuf%29%2C%20%22echo%20%25s%22%2C%20name%29%3B%0A%3E%20%3E%3E%2B%09%28void%29snprintf%28cmdbuf%2C%20sizeof%28cmdbuf%29%2C%20%22echo%20%27%25s%27%22%2C%20name%29%3B%0A%3E%20%3E%3E%20%09shell%20%3D%20value%28%22SHELL%22%29%3B%0A%3E%20%3E%3E%20%09pid%20%3D%20start_command%28shell%2C%200%2C%20-1%2C%20pivec%5B1%5D%2C%20%22-c%22%2C%20cmdbuf%2C%20NULL%29%3B%0A%3E%20%3E%3E%20%09if%20%28pid%20%3C%200%29%20%7B%0A%3E%20%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20Unless%20the%20%22%27%22%20character%20is%20filtered%20from%20%27name%27%20elsewhere%20in%20the%20code%2C%20this%0A%3E%20%3E%20doesn%27t%20close%20the%20hole.%0A%3E%20%0A%3E%20You%27re%20right.%20It%20needs%20further%20refinements%20to%20be%20perfect.%0A%3E%20But%20it%20does%20solve%20the%20problem%20in%20case%20of%20valid%20encoded-words%0A%3E%20which%20do%20not%20contain%20the%20%22%27%22%20character.%0A%3E%20%0A%3E%20On%20the%20other%20hand%2C%20I%20wonder%20why%20the%20code%20uses%20%22%2Fbin%2Fsh%20-c%20echo%20%25s%22%0A%3E%20just%20to%20print%20a%20string%3B%20couldn%27t%20it%20have%20printed%20it%20directly%3F%0A%3E%20%0A%3E%20%20%20%20%20%20%2F%2A%20just%20a%20rough%20idea%20%2A%2F%0A%3E%20%20%20%20%20%20strcat%28name%2C%20%22%5Cn%22%29%3B%0A%3E%20%20%20%20%20%20%28void%29write%28pivec%5B1%5D%2C%20name%2C%20strlen%28name%29%29%3B%0A%3E%20%0A%3E%20If%20it%20could%20do%20that%2C%20it%20would%20solve%20the%20problem%20completely.%0A%3E%20%0A%3E%20--%20%0A%3E%20Seungbeom%20Kim%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=musiphil%40bawi.org" alt="">
<div class="header"><span class="headerfield">From:</span> Seungbeom Kim &lt;musiphil@bawi.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Matt Zimmerman &lt;mdz@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 278748@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to
 fail</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 28 Oct 2004 23:42:04 -0700</div>
</div>
<pre class="message flowed">Matt Zimmerman wrote:

&gt; On Fri, Oct 29, 2004 at 01:07:43PM +0900, Seungbeom Kim wrote:
&gt; 
&gt;&gt;A very quick patch would be:
&gt;&gt;
&gt;&gt;--- fio.c.orig	2004-10-29 12:22:37.000000000 +0900
&gt;&gt;+++ fio.c	2004-10-29 12:51:16.000000000 +0900
&gt;&gt;@@ -480,7 +480,7 @@
&gt;&gt; 		warn(&quot;pipe&quot;);
&gt;&gt; 		return(name);
&gt;&gt; 	}
&gt;&gt;-	(void)snprintf(cmdbuf, sizeof(cmdbuf), &quot;echo %s&quot;, name);
&gt;&gt;+	(void)snprintf(cmdbuf, sizeof(cmdbuf), &quot;echo &#39;%s&#39;&quot;, name);
&gt;&gt; 	shell = value(&quot;SHELL&quot;);
&gt;&gt; 	pid = start_command(shell, 0, -1, pivec[1], &quot;-c&quot;, cmdbuf, NULL);
&gt;&gt; 	if (pid &lt; 0) {
&gt; 
&gt; 
&gt; Unless the &quot;&#39;&quot; character is filtered from &#39;name&#39; elsewhere in the code, this
&gt; doesn&#39;t close the hole.

You&#39;re right. It needs further refinements to be perfect.
But it does solve the problem in case of valid encoded-words
which do not contain the &quot;&#39;&quot; character.

On the other hand, I wonder why the code uses &quot;/bin/sh -c echo %s&quot;
just to print a string; couldn&#39;t it have printed it directly?

    /* just a rough idea */
    strcat(name, &quot;\n&quot;);
    (void)write(pivec[1], name, strlen(name));

If it could do that, it would solve the problem completely.

-- 
Seungbeom Kim


</pre>

<div class="infmessage"><hr><p>
<a name="16"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org</code>:<br>
<code>Bug#278748</code>; Package <code>mailx</code>.
(<a href="bugreport.cgi?bug=278748;msg=17">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="18"></a>
<strong>Acknowledgement sent</strong> to <code>Robert Luberda &lt;robert@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.
(<a href="bugreport.cgi?bug=278748;msg=19">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="20"></a><a name="msg20"></a><a href="#20">Message #20</a> received at 278748@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=20">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=20">mbox</a>, <a href="mailto:278748@bugs.debian.org?References=%3CE1CNO3D-0007el-00%40blue.bawi.org%3E%20%3C20041029045715.GI5602%40alcor.net%3E%20%3C4181E63C.6030103%40bawi.org%3E%0A%20%3C20041030130616.A25031%40sawan.com.pl%3E&amp;subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;In-Reply-To=%3C20041030130616.A25031%40sawan.com.pl%3E&amp;body=On%20Sat%2C%2030%20Oct%202004%2013%3A06%3A16%20%2B0200%20Robert%20Luberda%20%3Crobert%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%2028%20Oct%202004%2C%20Seungbeom%20Kim%20wrote%3A%0A%3E%20%0A%3E%20Hi%2C%20%0A%3E%20%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20Unless%20the%20%22%27%22%20character%20is%20filtered%20from%20%27name%27%20elsewhere%20in%20the%20code%2C%20this%0A%3E%20%3E%20%3E%20doesn%27t%20close%20the%20hole.%0A%3E%20%3E%20%0A%3E%20%3E%20You%27re%20right.%20It%20needs%20further%20refinements%20to%20be%20perfect.%0A%3E%20%3E%20But%20it%20does%20solve%20the%20problem%20in%20case%20of%20valid%20encoded-words%0A%3E%20%3E%20which%20do%20not%20contain%20the%20%22%27%22%20character.%0A%3E%20%3E%20%0A%3E%20%3E%20On%20the%20other%20hand%2C%20I%20wonder%20why%20the%20code%20uses%20%22%2Fbin%2Fsh%20-c%20echo%20%25s%22%0A%3E%20%3E%20just%20to%20print%20a%20string%3B%20couldn%27t%20it%20have%20printed%20it%20directly%3F%0A%3E%20%0A%3E%20%0A%3E%20AFAIK%2C%20in%20this%20%28broken%29%20way%20mailx%20does%20wildcards%20and%20environment%0A%3E%20variables%20expansion.%20Please%20note%2C%20that%20%22%2Fbin%2Fsh%20-c%20echo%20%25s%22%20is%20part%20of%0A%3E%20expand%20function%2C%20which%20is%20called%20in%20various%20places%20in%20mailx%27s%20source%20code.%0A%3E%20And%20mailx%20tries%20such%20an%20expansion%20on%20recipients%20names%20because%20it%20allows%20files%0A%3E%20to%20be%20special%20recipients.%20Please%20see%20section%204.3%20of%20The%20Mailx%20Reference%20Manual%0A%3E%20%28%2Fusr%2Fshare%2Fdoc%2Fmailx%2Fmanual%2A%27%29.%20Any%20recipient%2C%20which%20contains%20%27%2F%27%2C%20but%0A%3E%20not%20%27%40%27%2C%20%27%25%27%20nor%20%27%21%27%20is%20treated%20as%20a%20possible%20file%20name%2C%20and%20the%20expand%0A%3E%20funcion%20is%20called.%0A%3E%20%0A%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20%20%2F%2A%20just%20a%20rough%20idea%20%2A%2F%0A%3E%20%3E%20%20%20%20%20%20strcat%28name%2C%20%22%5Cn%22%29%3B%0A%3E%20%3E%20%20%20%20%20%20%28void%29write%28pivec%5B1%5D%2C%20name%2C%20strlen%28name%29%29%3B%0A%3E%20%3E%20%0A%3E%20%3E%20If%20it%20could%20do%20that%2C%20it%20would%20solve%20the%20problem%20completely.%0A%3E%20%0A%3E%20No%2C%20as%20I%20said%20before%2C%20it%20would%20break%20expansions%20%20of%20shell%20wildcards%20in%0A%3E%20mailx.%0A%3E%20%0A%3E%20I%20agree%20that%20this%20is%20a%20potential%20security%20hole%2C%20but%20I%20have%20no%20idea%20how%0A%3E%20to%20solve%20it%20now.%20Maybe%20changing%20the%20isfileaddr%20function%20to%20return%20false%0A%3E%20on%20names%20containing%20%60%20or%20%24%28%20will%20do%3F%20%20Unfortunetally%2C%20I%20can%27t%20deal%20%0A%3E%20with%20the%20bug%20properly%20until%20Wendsday%2C%20because%20I%27m%20out%20of%20my%20%0A%3E%20home%20%26%20computer%20for%20a%20few%20days.%0A%3E%20%0A%3E%20%0A%3E%20Best%20regards%2C%0A%3E%20%0A%3E%20Robert%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=robert%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Robert Luberda &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Seungbeom Kim &lt;musiphil@bawi.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> Matt Zimmerman &lt;mdz@debian.org&gt;, 278748@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 30 Oct 2004 13:06:16 +0200</div>
</div>
<pre class="message">On Thu, 28 Oct 2004, Seungbeom Kim wrote:

Hi, 

&gt; &gt; 
&gt; &gt; Unless the &quot;&#39;&quot; character is filtered from &#39;name&#39; elsewhere in the code, this
&gt; &gt; doesn&#39;t close the hole.
&gt; 
&gt; You&#39;re right. It needs further refinements to be perfect.
&gt; But it does solve the problem in case of valid encoded-words
&gt; which do not contain the &quot;&#39;&quot; character.
&gt; 
&gt; On the other hand, I wonder why the code uses &quot;/bin/sh -c echo %s&quot;
&gt; just to print a string; couldn&#39;t it have printed it directly?


AFAIK, in this (broken) way mailx does wildcards and environment
variables expansion. Please note, that &quot;/bin/sh -c echo %s&quot; is part of
expand function, which is called in various places in mailx&#39;s source code.
And mailx tries such an expansion on recipients names because it allows files
to be special recipients. Please see section 4.3 of The Mailx Reference Manual
(/usr/share/doc/mailx/manual*&#39;). Any recipient, which contains &#39;/&#39;, but
not &#39;@&#39;, &#39;%&#39; nor &#39;!&#39; is treated as a possible file name, and the expand
funcion is called.


&gt; 
&gt;      /* just a rough idea */
&gt;      strcat(name, &quot;\n&quot;);
&gt;      (void)write(pivec[1], name, strlen(name));
&gt; 
&gt; If it could do that, it would solve the problem completely.

No, as I said before, it would break expansions  of shell wildcards in
mailx.

I agree that this is a potential security hole, but I have no idea how
to solve it now. Maybe changing the isfileaddr function to return false
on names containing ` or $( will do?  Unfortunetally, I can&#39;t deal 
with the bug properly until Wendsday, because I&#39;m out of my 
home &amp; computer for a few days.


Best regards,

Robert


</pre>

<div class="msgreceived"><hr><p>
<a name="21"></a>
<strong>Reply sent</strong> to <code>Robert Luberda &lt;robert@debian.org&gt;</code>:<br>
You have marked Bug as forwarded.
(<a href="bugreport.cgi?bug=278748;msg=22">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="23"></a><a name="msg23"></a><a href="#23">Message #23</a> received at 278748-forwarded@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=23">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=23">mbox</a>, <a href="mailto:278748@bugs.debian.org?subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;References=%3C20041030132128.A25513%40sawan.com.pl%3E&amp;body=On%20Sat%2C%2030%20Oct%202004%2013%3A21%3A28%20%2B0200%20Robert%20Luberda%20%3Crobert%40debian.org%3E%20wrote%3A%0A%3E%20Hi%2C%20%0A%3E%20%0A%3E%20I%27m%20the%20maintainer%20of%20Debian%20mailx%20package%2C%20which%20is%20based%20on%20OpenBSD%20%0A%3E%20version.%20Lately%20I%20got%20a%20bug%20report%2C%20whose%20submitter%20says%3A%0A%3E%20%0A%3E%20%20%20The%20MIME%20standards%20require%20mail%20headers%20be%20encoded%20unless%20they%27re%0A%3E%20%20%20in%20the%20US-ASCII%20charset%2C%20which%20notably%20results%20in%20the%20recipient%27s%0A%3E%20%20%20address%20having%20symbols%20such%20as%20%27%3F%27%20and%20%27%2F%27.%20For%20example%2C%20the%20following%0A%3E%20%20%20is%20a%20MIME-compliant%20header%3A%0A%3E%20%0A%3E%20%20%20%3E%20To%3A%20%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%0A%3E%20%20%20%0A%3E%20%20%20However%2C%20this%20version%20of%20mailx%20chokes%20on%20such%20an%20input%2C%20because%20it%0A%3E%20%20%20supplies%20the%20address%20to%20%22%2Fbin%2Fsh%20-c%20echo%20%25s%22%20without%20any%20quoting%2C%0A%3E%20%20%20causing%20a%20shell%20pattern%20matching%20failure%20with%20names%20that%20have%20%27%2F%27%20and%0A%3E%20%20%20%27%3F%27%20above.%0A%3E%20%20%20%0A%3E%20%20%20%3E%20bash%24%20%2Fusr%2Fbin%2Fmail%20%27%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%27%0A%3E%20%20%20%3E%20Subject%3A%20blah%20blah%0A%3E%20%20%20%3E%20blah%20blah%0A%3E%20%20%20%3E%20Cc%3A%0A%3E%20%20%20%3E%20%2Fbin%2Fbash%3A%20-c%3A%20line%201%3A%20syntax%20error%20near%20unexpected%20token%20%60newline%27%0A%3E%20%20%20%3E%20%2Fbin%2Fbash%3A%20-c%3A%20line%201%3A%20%60echo%20%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%0A%3E%20%20%20%3E%20%3Cmusiphil%40bawi.org%3E%27%0A%3E%20%20%20%3E%20%22%3D%3FEUC-KR%3FB%3Fsei8vL%2F4%3F%3D%20%3Cmusiphil%40bawi.org%3E%22%3A%20No%20match.%0A%3E%20%20%20%3E%20mail%3A%20%28null%29%3A%20Bad%20address%0A%3E%20%0A%3E%20%0A%3E%20After%20checking%20the%20source%20code%2C%20I%20found%20that%20this%20bug%20is%20caused%20by%20%0A%3E%20expansion%20of%20%20wildcards%20and%20environment%20variables%20when%20mailx%20tries%20to%0A%3E%20handle%20special%20file%20recipients.%20%0A%3E%20%0A%3E%20I%20agree%20with%20the%20bug%20submitter%2C%20this%20is%20a%20potential%20security%20hole%2C%0A%3E%20but%20I%20have%20no%20idea%20how%20to%20solve%20it%20not%20breaking%20anything.%0A%3E%20Maybe%20changing%20isfileaddr%20function%20to%20ignore%20names%20with%20%60%20or%20%24%28%0A%3E%20substrings%20will%20solve%20the%20problem%2C%20but%20I%27m%20not%20sure%20if%20this%20is%0A%3E%20sufficient.%20Of%20course%20the%20best%20solution%20is%20not%20to%20call%20echo%20%2C%0A%3E%20but%20do%20wildcards%20and%20enviroment%20internally.%0A%3E%20%0A%3E%20Please%20see%20http%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fbugreport.cgi%3Fbug%3D278748%0A%3E%20for%20the%20full%20report.%0A%3E%20%0A%3E%20Best%20regards%2C%0A%3E%20%0A%3E%20robert%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20041030132128.A25513%40sawan.com.pl%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=robert%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Robert Luberda &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> millert@openbsd.org, deraadt@openbsd.org</div>
<div class="header"><span class="headerfield">Cc:</span> 278748-forwarded@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 30 Oct 2004 13:21:28 +0200</div>
</div>
<pre class="message">Hi, 

I&#39;m the maintainer of Debian mailx package, which is based on OpenBSD 
version. Lately I got a bug report, whose submitter says:

  The MIME standards require mail headers be encoded unless they&#39;re
  in the US-ASCII charset, which notably results in the recipient&#39;s
  address having symbols such as &#39;?&#39; and &#39;/&#39;. For example, the following
  is a MIME-compliant header:

  &gt; To: =?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;
  
  However, this version of mailx chokes on such an input, because it
  supplies the address to &quot;/bin/sh -c echo %s&quot; without any quoting,
  causing a shell pattern matching failure with names that have &#39;/&#39; and
  &#39;?&#39; above.
  
  &gt; bash$ /usr/bin/mail &#39;=?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;&#39;
  &gt; Subject: blah blah
  &gt; blah blah
  &gt; Cc:
  &gt; /bin/bash: -c: line 1: syntax error near unexpected token `newline&#39;
  &gt; /bin/bash: -c: line 1: `echo =?EUC-KR?B?sei8vL/4?=
  &gt; &lt;musiphil@bawi.org&gt;&#39;
  &gt; &quot;=?EUC-KR?B?sei8vL/4?= &lt;musiphil@bawi.org&gt;&quot;: No match.
  &gt; mail: (null): Bad address


After checking the source code, I found that this bug is caused by 
expansion of  wildcards and environment variables when mailx tries to
handle special file recipients. 

I agree with the bug submitter, this is a potential security hole,
but I have no idea how to solve it not breaking anything.
Maybe changing isfileaddr function to ignore names with ` or $(
substrings will solve the problem, but I&#39;m not sure if this is
sufficient. Of course the best solution is not to call echo ,
but do wildcards and enviroment internally.

Please see <a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=278748">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=278748</a>
for the full report.

Best regards,

robert


</pre>

<hr><p class="msgreceived"><a name="24"></a><a name="msg24"></a><a href="#24">Message #24</a> received at 278748-forwarded@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=24">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=24">mbox</a>, <a href="mailto:278748@bugs.debian.org?References=%3C20041030132128.A25513%40sawan.com.pl%3E%20%0A%20%3C200410301656.i9UGuG4o031837%40xerxes.courtesan.com%3E&amp;subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;In-Reply-To=%3C200410301656.i9UGuG4o031837%40xerxes.courtesan.com%3E&amp;body=On%20Sat%2C%2030%20Oct%202004%2010%3A56%3A15%20-0600%20%22Todd%20C.%20Miller%22%20%3CTodd.Miller%40courtesan.com%3E%20wrote%3A%0A%3E%20If%20your%20libc%20has%20wordexp%28%29%20I%20suggest%20using%20that%20instead.%0A%3E%20OpenBSD%20current%20lacks%20wordexp%28%29%20but%20I%20may%20add%20it%20sometime...%0A%3E%20%0A%3E%20%20-%20todd%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=Todd.Miller%40courtesan.com" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Todd C. Miller&quot; &lt;Todd.Miller@courtesan.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Robert Luberda &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> deraadt@openbsd.org, 278748-forwarded@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail </div>
<div class="header"><span class="headerfield">Date:</span> Sat, 30 Oct 2004 10:56:15 -0600</div>
</div>
<pre class="message">If your libc has wordexp() I suggest using that instead.
OpenBSD current lacks wordexp() but I may add it sometime...

 - todd


</pre>

<div class="msgreceived"><hr><p>
<a name="25"></a>
<strong>Tags removed: l10n</strong>
Request was from <code>&quot;Robert Luberda&quot; &lt;robert@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=278748;msg=26">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="27"></a><a name="msg27"></a><a href="#27">Message #27</a> received at 278748-forwarded@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=27">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=27">mbox</a>, <a href="mailto:278748@bugs.debian.org?body=On%20Thu%2C%2004%20Nov%202004%2011%3A28%3A22%20%2B0100%20%22Robert%20Luberda%22%20%3Crobert%40debian.org%3E%20wrote%3A%0A%3E%20On%2030%20Oct%202004%20at%2010%3A56%2C%20Todd%20C.%20Miller%20wrote%3A%0A%3E%20%0A%3E%20Hi%2C%20%0A%3E%20%0A%3E%20%3E%20If%20your%20libc%20has%20wordexp%28%29%20I%20suggest%20using%20that%20instead.%0A%3E%20%3E%20OpenBSD%20current%20lacks%20wordexp%28%29%20but%20I%20may%20add%20it%20sometime...%0A%3E%20%0A%3E%20Thanks%20a%20lot%20for%20a%20hint.%0A%3E%20I%20managed%20to%20rewrite%20expand%20using%20wordexp%28%29.%20I%20can%20send%20you%20a%20patch%20if%20%0A%3E%20you%27re%20interested.%0A%3E%20%0A%3E%20Best%20Regards%2C%0A%3E%20robert%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C418A1256.21842.6A3A24421c%40robbo%3E&amp;subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;References=Your%20message%20of%20%22Sat%2C%2030%20Oct%202004%2013%3A21%3A28%20%2B0200.%22%20%3C20041030132128.A25513%40sawan.com.pl%3E%20%0A%20%3C418A1256.21842.6A3A24421c%40robbo%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=robert%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Robert Luberda&quot; &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Todd C. Miller&quot; &lt;Todd.Miller@courtesan.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 278748-forwarded@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail </div>
<div class="header"><span class="headerfield">Date:</span> Thu, 04 Nov 2004 11:28:22 +0100</div>
</div>
<pre class="message">On 30 Oct 2004 at 10:56, Todd C. Miller wrote:

Hi, 

&gt; If your libc has wordexp() I suggest using that instead.
&gt; OpenBSD current lacks wordexp() but I may add it sometime...

Thanks a lot for a hint.
I managed to rewrite expand using wordexp(). I can send you a patch if 
you&#39;re interested.

Best Regards,
robert



</pre>

<div class="msgreceived"><hr><p>
<a name="28"></a>
<strong>Reply sent</strong> to <code>Robert Luberda &lt;robert@debian.org&gt;</code>:<br>
You have taken responsibility.
(<a href="bugreport.cgi?bug=278748;msg=29">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="30"></a>
<strong>Notification sent</strong> to <code>Seungbeom Kim &lt;musiphil@bawi.org&gt;</code>:<br>
Bug acknowledged by developer.
(<a href="bugreport.cgi?bug=278748;msg=31">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="32"></a><a name="msg32"></a><a href="#32">Message #32</a> received at 278748-close@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=32">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=32">mbox</a>, <a href="mailto:278748@bugs.debian.org?subject=Re%3A%20Bug%23278748%3A%20fixed%20in%20mailx%201%3A8.1.2-0.20040524cvs-2&amp;References=%3CE1CPeuT-0005Dq-00%40newraff.debian.org%3E&amp;body=On%20Thu%2C%2004%20Nov%202004%2005%3A32%3A05%20-0500%20Robert%20Luberda%20%3Crobert%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20mailx%0A%3E%20Source-Version%3A%201%3A8.1.2-0.20040524cvs-2%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20mailx%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive%3A%0A%3E%20%0A%3E%20mailx_8.1.2-0.20040524cvs-2.diff.gz%0A%3E%20%20%20to%20pool%2Fmain%2Fm%2Fmailx%2Fmailx_8.1.2-0.20040524cvs-2.diff.gz%0A%3E%20mailx_8.1.2-0.20040524cvs-2.dsc%0A%3E%20%20%20to%20pool%2Fmain%2Fm%2Fmailx%2Fmailx_8.1.2-0.20040524cvs-2.dsc%0A%3E%20mailx_8.1.2-0.20040524cvs-2_i386.deb%0A%3E%20%20%20to%20pool%2Fmain%2Fm%2Fmailx%2Fmailx_8.1.2-0.20040524cvs-2_i386.deb%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20278748%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Robert%20Luberda%20%3Crobert%40debian.org%3E%20%28supplier%20of%20updated%20mailx%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.7%0A%3E%20Date%3A%20Wed%2C%20%203%20Nov%202004%2020%3A46%3A39%20%2B0100%0A%3E%20Source%3A%20mailx%0A%3E%20Binary%3A%20mailx%0A%3E%20Architecture%3A%20source%20i386%0A%3E%20Version%3A%201%3A8.1.2-0.20040524cvs-2%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20medium%0A%3E%20Maintainer%3A%20Robert%20Luberda%20%3Crobert%40debian.org%3E%0A%3E%20Changed-By%3A%20Robert%20Luberda%20%3Crobert%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20mailx%20%20%20%20%20%20-%20A%20simple%20mail%20user%20agent%0A%3E%20Closes%3A%20278748%0A%3E%20Changes%3A%20%0A%3E%20%20mailx%20%281%3A8.1.2-0.20040524cvs-2%29%20unstable%3B%20urgency%3Dmedium%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Bugfix%20release%20%28closes%3A%20%23278748%29%3A%0A%3E%20%20%20%20%20%20%2B%20fio.c%3A%20Use%20wordexpr%28%29%20instead%20of%20calling%20%2Fbin%2Fecho%20not%20to%20allow%0A%3E%20%20%20%20%20%20%20%20executing%20external%20commands%20while%20expanding%20shell%20variables%0A%3E%20%20%20%20%20%20%20%20and%20wildcards.%0A%3E%20%20%20%20%20%20%2B%20names.c%3A%20isfileaddr%20function%20return%20false%20if%20%27%40%27%2C%20%27%21%27%20or%20%27%25%27%20i%0A%3E%20%20%20%20%20%20%20%20characters%20occur%20anywhere%20%28e.g%20not%20only%20before%20the%20slash%29%20in%20the%0A%3E%20%20%20%20%20%20%20%20recipient%20name.%0A%3E%20Files%3A%20%0A%3E%20%2056b12bf8ebab81a47cb2107b153d0edf%20633%20mail%20important%20mailx_8.1.2-0.20040524cvs-2.dsc%0A%3E%20%2089cb0dc7a91ffe092f29dd301ac43bf5%2037516%20mail%20important%20mailx_8.1.2-0.20040524cvs-2.diff.gz%0A&amp;In-Reply-To=%3CE1CPeuT-0005Dq-00%40newraff.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=robert%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Robert Luberda &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 278748-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#278748: fixed in mailx 1:8.1.2-0.20040524cvs-2</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 04 Nov 2004 05:32:05 -0500</div>
</div>
<pre class="message">Source: mailx
Source-Version: 1:8.1.2-0.20040524cvs-2

We believe that the bug you reported is fixed in the latest version of
mailx, which is due to be installed in the Debian FTP archive:

mailx_8.1.2-0.20040524cvs-2.diff.gz
  to pool/main/m/mailx/mailx_8.1.2-0.20040524cvs-2.diff.gz
mailx_8.1.2-0.20040524cvs-2.dsc
  to pool/main/m/mailx/mailx_8.1.2-0.20040524cvs-2.dsc
mailx_8.1.2-0.20040524cvs-2_i386.deb
  to pool/main/m/mailx/mailx_8.1.2-0.20040524cvs-2_i386.deb



A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 278748@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Robert Luberda &lt;robert@debian.org&gt; (supplier of updated mailx package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Wed,  3 Nov 2004 20:46:39 +0100
Source: mailx
Binary: mailx
Architecture: source i386
Version: 1:8.1.2-0.20040524cvs-2
Distribution: unstable
Urgency: medium
Maintainer: Robert Luberda &lt;robert@debian.org&gt;
Changed-By: Robert Luberda &lt;robert@debian.org&gt;
Description: 
 mailx      - A simple mail user agent
Closes: <a href="bugreport.cgi?bug=278748">278748</a>
Changes: 
 mailx (1:8.1.2-0.20040524cvs-2) unstable; urgency=medium
 .
   * Bugfix release (closes: #<a href="bugreport.cgi?bug=278748">278748</a>):
     + fio.c: Use wordexpr() instead of calling /bin/echo not to allow
       executing external commands while expanding shell variables
       and wildcards.
     + names.c: isfileaddr function return false if &#39;@&#39;, &#39;!&#39; or &#39;%&#39; i
       characters occur anywhere (e.g not only before the slash) in the
       recipient name.
Files: 
 56b12bf8ebab81a47cb2107b153d0edf 633 mail important mailx_8.1.2-0.20040524cvs-2.dsc
 89cb0dc7a91ffe092f29dd301ac43bf5 37516 mail important mailx_8.1.2-0.20040524cvs-2.diff.gz
 aebe5356f4170499e4370047ae12c104 151390 mail important mailx_8.1.2-0.20040524cvs-2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFBiWvcThh1cJ0wnDsRApcuAJ0dD8QUKpFHgrFV2SMzJGfqBAthBwCdFB3x
+OcUB8/VYQpuxw7KbnvKjvE=
=jmZ2
-----END PGP SIGNATURE-----



</pre>

<hr><p class="msgreceived"><a name="33"></a><a name="msg33"></a><a href="#33">Message #33</a> received at 278748-forwarded@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=33">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=33">mbox</a>, <a href="mailto:278748@bugs.debian.org?subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;References=Your%20message%20of%20%22Sat%2C%2030%20Oct%202004%2013%3A21%3A28%20%2B0200.%22%20%3C20041030132128.A25513%40sawan.com.pl%3E%20%3C418A1256.21842.6A3A24421c%40robbo%3E%20%0A%20%3C200411041521.iA4FLVVu026211%40xerxes.courtesan.com%3E&amp;body=On%20Thu%2C%2004%20Nov%202004%2008%3A21%3A31%20-0700%20%22Todd%20C.%20Miller%22%20%3CTodd.Miller%40courtesan.com%3E%20wrote%3A%0A%3E%20In%20message%20%3C418A1256.21842.6A3A24421c%40robbo%3E%0A%3E%20%09so%20spake%20%22Robert%20Luberda%22%20%28robert%29%3A%0A%3E%20%0A%3E%20%3E%20I%20managed%20to%20rewrite%20expand%20using%20wordexp%28%29.%20I%20can%20send%20you%20a%20patch%20if%20%0A%3E%20%3E%20you%27re%20interested.%0A%3E%20%0A%3E%20Sure%2C%20I%27ll%20take%20a%20look%20at%20it.%0A%3E%20%0A%3E%20%20-%20todd%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C200411041521.iA4FLVVu026211%40xerxes.courtesan.com%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=Todd.Miller%40courtesan.com" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Todd C. Miller&quot; &lt;Todd.Miller@courtesan.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Robert Luberda&quot; &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 278748-forwarded@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail </div>
<div class="header"><span class="headerfield">Date:</span> Thu, 04 Nov 2004 08:21:31 -0700</div>
</div>
<pre class="message">In message &lt;418A1256.21842.6A3A24421c@robbo&gt;
	so spake &quot;Robert Luberda&quot; (robert):

&gt; I managed to rewrite expand using wordexp(). I can send you a patch if 
&gt; you&#39;re interested.

Sure, I&#39;ll take a look at it.

 - todd


</pre>

<hr><p class="msgreceived"><a name="34"></a><a name="msg34"></a><a href="#34">Message #34</a> received at 278748-forwarded@bugs.debian.org (<a href="bugreport.cgi?bug=278748;msg=34">full text</a>, <a href="bugreport.cgi?bug=278748;mbox=yes;msg=34">mbox</a>, <a href="mailto:278748@bugs.debian.org?body=On%20Wed%2C%2010%20Nov%202004%2015%3A16%3A43%20%2B0100%20%22Robert%20Luberda%22%20%3Crobert%40debian.org%3E%20wrote%3A%0A%3E%20On%204%20Nov%202004%20at%208%3A21%2C%20Todd%20C.%20Miller%20wrote%3A%0A%3E%20%0A%3E%20Hi%2C%20%0A%3E%20%3E%20%0A%3E%20%3E%20Sure%2C%20I%27ll%20take%20a%20look%20at%20it.%0A%3E%20%0A%3E%20Attached.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20%0A%3E%20Robert%0A%3E%20%0A&amp;In-Reply-To=%3C419230DB.4062.1271A2B421c%40robbo%3E&amp;subject=Re%3A%20Bug%23278748%3A%20mailx%3A%20unquoted%20recipient%27s%20name%20causes%20sending%20to%20fail&amp;References=Your%20message%20of%20%22Thu%2C%2004%20Nov%202004%2011%3A28%3A22%20%2B0100.%22%20%3C418A1256.21842.6A3A24421c%40robbo%3E%20%0A%20%3C419230DB.4062.1271A2B421c%40robbo%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=robert%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Robert Luberda&quot; &lt;robert@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Todd C. Miller&quot; &lt;Todd.Miller@courtesan.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 278748-forwarded@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#278748: mailx: unquoted recipient&#39;s name causes sending to fail </div>
<div class="header"><span class="headerfield">Date:</span> Wed, 10 Nov 2004 15:16:43 +0100</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=278748;msg=34">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On 4 Nov 2004 at 8:21, Todd C. Miller wrote:

Hi, 
&gt; 
&gt; Sure, I&#39;ll take a look at it.

Attached.

Regards,

Robert

</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=278748;filename=mailx.patch.gz;msg=34">mailx.patch.gz</a> (application/octet-stream, attachment)]</pre>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=278748">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:22:38 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
