<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#311296 - mutt: less random temp file creation allows DOS - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=311296&quot;&gt;311296&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:311296@bugs.debian.org">#311296</a><br>
mutt: less random temp file creation allows DOS</h1>
<div class="versiongraph"><a href="version.cgi?absolute=0;fixed=mutt%2F1.5.20-7;collapse=1;info=1;found=1.5.9-2;found=mutt%2F1.5.11%2Bcvs20060330-1;found=mutt%2F1.5.19-1;package=mutt"><img alt="version graph" src="version.cgi?fixed=mutt%2F1.5.20-7;collapse=1;width=2;absolute=0;found=1.5.9-2;found=mutt%2F1.5.11%2Bcvs20060330-1;found=mutt%2F1.5.19-1;height=2;package=mutt"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=mutt">mutt</a>;
Maintainer for <a href="pkgreport.cgi?package=mutt">mutt</a> is <a href="pkgreport.cgi?maint=mutt%40packages.debian.org">Mutt maintainers &lt;mutt@packages.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=mutt">mutt</a> is <a href="pkgreport.cgi?src=mutt">src:mutt</a> (<a href="https://tracker.debian.org/pkg/mutt">PTS</a>, <a href="https://buildd.debian.org/mutt">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=mutt">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=roberto%40connexer.com">&quot;Roberto C. Sanchez&quot; &lt;roberto@connexer.com&gt;</a></p>
  <p>Date: Mon, 30 May 2005 19:03:02 UTC</p>

<p>Severity: normal</p>
<p>Tags: patch, security, upstream</p>

<p>Found in versions 1.5.9-2, mutt/1.5.11+cvs20060330-1, mutt/1.5.19-1</p>
<p>Fixed in version mutt/1.5.20-7</p>

<p><strong>Done:</strong> Antonio Radici &lt;antonio@dyne.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p><p>Forwarded to <a href="http://bugs.mutt.org/3158">http://bugs.mutt.org/3158</a></p>
</div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=311296;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<strong>Report forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, debian@ngolde.de, mutt-ng@lxtec.de, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=2">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<strong>Acknowledgement sent</strong> to <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>debian@ngolde.de, mutt-ng@lxtec.de, Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=4">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=5">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=5">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Mon%2C%2030%20May%202005%2014%3A58%3A08%20-0400%20%22Roberto%20C.%20Sanchez%22%20%3Croberto%40familiasanchez.net%3E%20wrote%3A%0A%3E%20Package%3A%20mutt%0A%3E%20Version%3A%201.5.9-2%0A%3E%20Severity%3A%20important%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20I%20am%20only%20making%20this%20important%20becuase%20after%20discussing%20it%20on%0A%3E%20%23debian-devel%2C%20the%20consensus%20was%20the%20this%20was%20annoying%20but%20not%20RC.%20%20I%20am%0A%3E%20CC%27ing%20Nico%20and%20Elimar%20since%20this%20also%20applies%20to%20the%20unnofficial%0A%3E%20mutt-ng%20pacakges.%20%20mutt%20creates%20temporary%20files%20in%20a%20very%20predictable%0A%3E%20and%20unsecure%20way.%20%20There%20is%20no%20threat%20of%20overwriting%20an%20existing%20file%20or%0A%3E%20creating%20a%20file%20somewhere%20where%20the%20user%20lacks%20appropriate%20permissions%2C%0A%3E%20but%20there%20is%20a%20trivial%20way%20to%20DoS%20the%20users%20in%20mutt.%0A%3E%20%0A%3E%20Steps%20to%20replicate%3A%0A%3E%20%0A%3E%20Log%20into%20a%20shared%20machine%20and%20run%20%27ps%20aux%7Cgrep%20mutt%27.%20%20Choose%20a%20user%0A%3E%20running%20mutt.%20%20Note%20the%20pid%20of%20the%20mutt%20process%20you%20want%20to%20DOS.%20%20Note%0A%3E%20the%20username%20and%20run%20%27id%20%3Cuser%3E%27%20to%20get%20the%20uid.%20%20Then%20run%20%27for%20i%20in%0A%3E%20%60seq%200%201000%60%20%3B%20do%20touch%20%2Ftmp%2Fmutt-%3Chostname%3E-%3Cuid%3E-%3Cpid%3E-%24i%20%3B%20done%27%20and%0A%3E%20watch%20the%20user%20not%20be%20able%20to%201%29%20compose%20mail%2C%202%29%20change%20mailboxes%2C%203%29%0A%3E%20reply%20to%20mail%2C%204%29%20or%20view%20help%20until%20mutt%20is%20restarted.%20%20For%20added%20fun%2C%0A%3E%20wrap%20in%20another%20for%20loop%20that%20iterates%20from%200%20to%2032767%20and%20hit%20all%20the%0A%3E%20PIDs%20and%20prevent%20the%20user%20from%20using%20mutt%20unil%20%2Ftmp%20is%20cleaned%20or%20the%0A%3E%20machine%20is%20rebooted.%0A%3E%20%0A%3E%20-%20-Roberto%0A%3E%20%0A%3E%20-%20--%0A%3E%20Roberto%20C.%20Sanchez%0A%3E%20http%3A%2F%2Ffamiliasanchez.net%2F~sanchezr%0A%3E%20%0A%3E%20-%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%203.1%0A%3E%20%20%20APT%20prefers%20testing%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27testing%27%29%0A%3E%20Architecture%3A%20i386%20%28i686%29%0A%3E%20Kernel%3A%20Linux%202.6.8-miami-15.3%0A%3E%20Locale%3A%20LANG%3Des_ES%2C%20LC_CTYPE%3Des_ES%20%28charmap%3DISO-8859-1%29%0A%3E%20%0A%3E%20Versions%20of%20packages%20mutt%20depends%20on%3A%0A%3E%20ii%20%20exim4%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204.50-6%20%20%20%20%20%20%20metapackage%20to%20ease%20exim%20MTA%20%28v4%29%20%0A%3E%20ii%20%20exim4-daemon-light%20%5Bmail-tr%204.50-6%20%20%20%20%20%20%20lightweight%20exim%20MTA%20%28v4%29%20daemon%0A%3E%20ii%20%20libc6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.3.2.ds1-22%20GNU%20C%20Library%3A%20Shared%20libraries%20an%0A%3E%20ii%20%20libdb4.3%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204.3.27-2%20%20%20%20%20Berkeley%20v4.3%20Database%20Libraries%20%5B%0A%3E%20ii%20%20libgnutls11%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.0.16-9%20%20%20%20%20GNU%20TLS%20library%20-%20runtime%20library%0A%3E%20ii%20%20libidn11%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200.5.13-1.0%20%20%20GNU%20libidn%20library%2C%20implementation%0A%3E%20ii%20%20libncursesw5%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%205.4-4%20%20%20%20%20%20%20%20Shared%20libraries%20for%20terminal%20hand%0A%3E%20ii%20%20libsasl2%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.1.19-1.5%20%20%20Authentication%20abstraction%20library%0A%3E%20%0A%3E%20-%20--%20no%20debconf%20information%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNATURE-----%0A%3E%20Version%3A%20GnuPG%20v1.4.1%20%28GNU%2FLinux%29%0A%3E%20%0A%3E%20iD8DBQFCm2JATfhoonTOp2oRApT5AKCQ9U6Wh9YlgZxz9BTDMkflunb2EwCg4g9I%0A%3E%20%2FgLq4ITlC%2BXqBYjYffH636M%3D%0A%3E%20%3Dgvk5%0A%3E%20-----END%20PGP%20SIGNATURE-----%0A&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E&amp;subject=Re%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=roberto%40familiasanchez.net" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 30 May 2005 14:58:08 -0400</div>
</div>
<pre class="message">Package: mutt
Version: 1.5.9-2
Severity: important

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I am only making this important becuase after discussing it on
#debian-devel, the consensus was the this was annoying but not RC.  I am
CC&#39;ing Nico and Elimar since this also applies to the unnofficial
mutt-ng pacakges.  mutt creates temporary files in a very predictable
and unsecure way.  There is no threat of overwriting an existing file or
creating a file somewhere where the user lacks appropriate permissions,
but there is a trivial way to DoS the users in mutt.

Steps to replicate:

Log into a shared machine and run &#39;ps aux|grep mutt&#39;.  Choose a user
running mutt.  Note the pid of the mutt process you want to DOS.  Note
the username and run &#39;id &lt;user&gt;&#39; to get the uid.  Then run &#39;for i in
`seq 0 1000` ; do touch /tmp/mutt-&lt;hostname&gt;-&lt;uid&gt;-&lt;pid&gt;-$i ; done&#39; and
watch the user not be able to 1) compose mail, 2) change mailboxes, 3)
reply to mail, 4) or view help until mutt is restarted.  For added fun,
wrap in another for loop that iterates from 0 to 32767 and hit all the
PIDs and prevent the user from using mutt unil /tmp is cleaned or the
machine is rebooted.

- -Roberto

- --
Roberto C. Sanchez
<a href="http://familiasanchez.net/~sanchezr">http://familiasanchez.net/~sanchezr</a>

- -- System Information:
Debian Release: 3.1
  APT prefers testing
  APT policy: (500, &#39;testing&#39;)
Architecture: i386 (i686)
Kernel: Linux 2.6.8-miami-15.3
Locale: LANG=es_ES, LC_CTYPE=es_ES (charmap=ISO-8859-1)

Versions of packages mutt depends on:
ii  exim4                       4.50-6       metapackage to ease exim MTA (v4) 
ii  exim4-daemon-light [mail-tr 4.50-6       lightweight exim MTA (v4) daemon
ii  libc6                       2.3.2.ds1-22 GNU C Library: Shared libraries an
ii  libdb4.3                    4.3.27-2     Berkeley v4.3 Database Libraries [
ii  libgnutls11                 1.0.16-9     GNU TLS library - runtime library
ii  libidn11                    0.5.13-1.0   GNU libidn library, implementation
ii  libncursesw5                5.4-4        Shared libraries for terminal hand
ii  libsasl2                    2.1.19-1.5   Authentication abstraction library

- -- no debconf information

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iD8DBQFCm2JATfhoonTOp2oRApT5AKCQ9U6Wh9YlgZxz9BTDMkflunb2EwCg4g9I
/gLq4ITlC+XqBYjYffH636M=
=gvk5
-----END PGP SIGNATURE-----


</pre>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<strong>Severity set to `minor'.</strong>
Request was from <code>Marco d'Itri &lt;md@linux.it&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=311296;msg=7">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=9">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="10"></a>
<strong>Acknowledgement sent</strong> to <code>Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=11">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=11">mbox</a>, <a href="#10">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="12"></a><a name="msg12"></a><a href="#12">Message #12</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=12">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=12">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2013%3A05%3A45%20%2B1000%20Mark%20Suter%20%3Csuter%40zwitterion.humbug.org.au%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Roberto%2C%0A%3E%20%0A%3E%20This%20problem%20is%20a%20symptom%20of%20the%20larger%20%22shared%20%2Ftmp%22%20issue.%20%20A%0A%3E%20solution%20is%20to%20use%20the%20TMPDIR%20environment%20variable%20as%20discussed%0A%3E%20in%20the%20Secure%20Programming%20for%20Linux%20and%20Unix%20HOWTO.%0A%3E%20%0A%3E%20%20%20%20%20http%3A%2F%2Fwww.dwheeler.com%2Fsecure-programs%2FSecure-Programs-HOWTO%2Favoid-race.html%23TEMPORARY-FILES%0A%3E%20%0A%3E%20Mutt%20honours%20the%20TMPDIR%20environment%20variable%2C%20so%20something%20like%0A%3E%20the%20following%20in%20your%20~%2F.bashrc%20%28or%20equivalent%29%20will%20avoid%20this%0A%3E%20issue%20completely%20%28and%20cover%20a%20few%20alternate%20variables%29.%0A%3E%20%0A%3E%20%20%20%20%20%23%23%20Safe%2C%20local%20temporary%20directory%0A%3E%20%20%20%20%20mkdir%20-p%20%24HOME%2Ftmp%20%26%26%20for%20var%20in%20TMPDIR%20TMP%20TEMP%20TEMPDIR%20%3B%20do%20export%20%24var%3D%24HOME%2Ftmp%3B%20done%0A%3E%20%20%20%20%20test%20-d%20%24TMPDIR%20%7C%7C%20echo%20Warning%3A%20TMPDIR%20is%20not%20set%20correctly.%0A%3E%20%0A%3E%20Yours%20sincerely%2C%0A%3E%20%0A%3E%20-%20--%20Mark%20John%20Suter%20%20%7C%20I%20know%20that%20you%20%20believe%20%20you%20understand%0A%3E%20suter%40humbug.org.au%20%7C%20what%20you%20think%20I%20said%2C%20but%20I%20am%20not%20sure%0A%3E%20gpg%20key%20id%202C71D63D%20%7C%20you%20realise%20that%20what%20you%20%20heard%20%20is%20not%0A%3E%20mobile%200411%20262%20316%20%7C%20what%20I%20meant.%20%20%20%20%20%20%20%20Robert%20J.%20McCloskey%0A%3E%20-----BEGIN%20PGP%20SIGNATURE-----%0A%3E%20Version%3A%20GnuPG%20v1.4.1%20%28GNU%2FLinux%29%0A%3E%20Comment%3A%20Check%20Keyservers%20or%20http%3A%2F%2Fzwitterion.org%2Fkeys%2F%0A%3E%20%0A%3E%20iD8DBQFCm9SJRYso2ixx1j0RAiR7AJ9YSegKhqIQAr98AiqeCbIfaoxXmwCfRD6S%0A%3E%20xMArJ5%2FaC7xflptghcLd40A%3D%0A%3E%20%3D3m%2BX%0A%3E%20-----END%20PGP%20SIGNATURE-----%0A%3E%20%0A%3E%20%0A&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%0A%20%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=suter%40zwitterion.humbug.org.au" alt="">
<div class="header"><span class="headerfield">From:</span> Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 13:05:45 +1000</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Roberto,

This problem is a symptom of the larger &quot;shared /tmp&quot; issue.  A
solution is to use the TMPDIR environment variable as discussed
in the Secure Programming for Linux and Unix HOWTO.

    <a href="http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/avoid-race.html#TEMPORARY-FILES">http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/avoid-race.html#TEMPORARY-FILES</a>

Mutt honours the TMPDIR environment variable, so something like
the following in your ~/.bashrc (or equivalent) will avoid this
issue completely (and cover a few alternate variables).

    ## Safe, local temporary directory
    mkdir -p $HOME/tmp &amp;&amp; for var in TMPDIR TMP TEMP TEMPDIR ; do export $var=$HOME/tmp; done
    test -d $TMPDIR || echo Warning: TMPDIR is not set correctly.

Yours sincerely,

- -- Mark John Suter  | I know that you  believe  you understand
suter@humbug.org.au | what you think I said, but I am not sure
gpg key id 2C71D63D | you realise that what you  heard  is not
mobile 0411 262 316 | what I meant.        Robert J. McCloskey
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)
Comment: Check Keyservers or <a href="http://zwitterion.org/keys/">http://zwitterion.org/keys/</a>

iD8DBQFCm9SJRYso2ixx1j0RAiR7AJ9YSegKhqIQAr98AiqeCbIfaoxXmwCfRD6S
xMArJ5/aC7xflptghcLd40A=
=3m+X
-----END PGP SIGNATURE-----


</pre>

<div class="infmessage"><hr><p>
<a name="13"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=14">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="15"></a>
<strong>Acknowledgement sent</strong> to <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=16">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="17"></a><a name="msg17"></a><a href="#17">Message #17</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=17">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=17">mbox</a>, <a href="mailto:311296@bugs.debian.org?subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E%0A%20%3C20050531032440.GE18799%40miami.familiasanchez.net%3E&amp;In-Reply-To=%3C20050531032440.GE18799%40miami.familiasanchez.net%3E&amp;body=On%20Mon%2C%2030%20May%202005%2023%3A24%3A40%20-0400%20%22Roberto%20C.%20Sanchez%22%20%3Croberto%40familiasanchez.net%3E%20wrote%3A%0A%3E%20On%20Tue%2C%20May%2031%2C%202005%20at%2001%3A05%3A45PM%20%2B1000%2C%20Mark%20Suter%20wrote%3A%0A%3E%20%3E%20Roberto%2C%0A%3E%20%3E%20%0A%3E%20%3E%20This%20problem%20is%20a%20symptom%20of%20the%20larger%20%22shared%20%2Ftmp%22%20issue.%20%20A%0A%3E%20%3E%20solution%20is%20to%20use%20the%20TMPDIR%20environment%20variable%20as%20discussed%0A%3E%20%3E%20in%20the%20Secure%20Programming%20for%20Linux%20and%20Unix%20HOWTO.%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20http%3A%2F%2Fwww.dwheeler.com%2Fsecure-programs%2FSecure-Programs-HOWTO%2Favoid-race.html%23TEMPORARY-FILES%0A%3E%20%3E%20%0A%3E%20%3E%20Mutt%20honours%20the%20TMPDIR%20environment%20variable%2C%20so%20something%20like%0A%3E%20%3E%20the%20following%20in%20your%20~%2F.bashrc%20%28or%20equivalent%29%20will%20avoid%20this%0A%3E%20%3E%20issue%20completely%20%28and%20cover%20a%20few%20alternate%20variables%29.%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20%23%23%20Safe%2C%20local%20temporary%20directory%0A%3E%20%3E%20%20%20%20%20mkdir%20-p%20%24HOME%2Ftmp%20%26%26%20for%20var%20in%20TMPDIR%20TMP%20TEMP%20TEMPDIR%20%3B%20do%20export%20%24var%3D%24HOME%2Ftmp%3B%20done%0A%3E%20%3E%20%20%20%20%20test%20-d%20%24TMPDIR%20%7C%7C%20echo%20Warning%3A%20TMPDIR%20is%20not%20set%20correctly.%0A%3E%20%3E%20%0A%3E%20That%20is%20fine.%20%20However%2C%20given%20the%20existence%20of%20the%20tmpfile%283%29%20function%2C%0A%3E%20there%20is%20really%20no%20excuse%20for%20any%20program%20to%20employ%20a%201-up%20numbering%20of%0A%3E%20temporary%20files.%20%20Sepcifically%2C%20in%20the%20same%20section%20of%20the%20Secure-%0A%3E%20Programs-HOWTO%20you%20cite%3A%0A%3E%20%0A%3E%20%20%20%20According%20to%20the%201997%20%60%60Single%20Unix%20Specification%27%27%2C%20the%20preferred%0A%3E%20%20%20%20method%20for%20creating%20an%20arbitrary%20temporary%20file%20%28using%20the%20C%20interface%29%0A%3E%20%20%20%20is%20tmpfile%283%29.%20%0A%3E%20%0A%3E%20The%20paragraph%20after%20that%20goes%20on%20to%20talk%20about%20why%20mkstemp%283%29%20is%20an%20even%0A%3E%20better%20idea.%20%20So%2C%20there%20are%20options.%20%20Besides%2C%20given%20the%20choice%20between%0A%3E%20the%20following%20two%20options%3A%0A%3E%20%0A%3E%201%29%20One-time%20fix%20applied%20by%20upstream%20developer%3B%20by%20extenension%2C%20present%0A%3E%20in%20all%20future%20releases.%0A%3E%202%29%20Work%20around%20in%20~%2F.bashrc%20%28or%20equivalent%29%20that%20must%20be%20applied%20to%0A%3E%20every%20system%20accessed.%20%20%28Think%20a%20year%20or%20two%20down%20the%20road%20when%20you%20get%0A%3E%20an%20account%20on%20a%20new%20machine%29.%0A%3E%20%0A%3E%20I%20would%20say%20that%20that%20option%201%20has%20major%20advantages%3A%0A%3E%20%0A%3E%201%29%20Requires%20one%20person%20to%20do%20one%20thing%20to%20fix.%0A%3E%202%29%20Less%20error%20prone%2Fopen%20to%20peer%20review.%0A%3E%203%29%20Is%20not%20dependent%20on%20a%20specific%20user%20action.%0A%3E%20%0A%3E%20-Roberto%0A%3E%20%0A%3E%20--%20%0A%3E%20Roberto%20C.%20Sanchez%0A%3E%20http%3A%2F%2Ffamiliasanchez.net%2F~sanchezr%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=roberto%40familiasanchez.net" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 30 May 2005 23:24:40 -0400</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=17">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Tue, May 31, 2005 at 01:05:45PM +1000, Mark Suter wrote:
&gt; Roberto,
&gt; 
&gt; This problem is a symptom of the larger &quot;shared /tmp&quot; issue.  A
&gt; solution is to use the TMPDIR environment variable as discussed
&gt; in the Secure Programming for Linux and Unix HOWTO.
&gt; 
&gt;     <a href="http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/avoid-race.html#TEMPORARY-FILES">http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/avoid-race.html#TEMPORARY-FILES</a>
&gt; 
&gt; Mutt honours the TMPDIR environment variable, so something like
&gt; the following in your ~/.bashrc (or equivalent) will avoid this
&gt; issue completely (and cover a few alternate variables).
&gt; 
&gt;     ## Safe, local temporary directory
&gt;     mkdir -p $HOME/tmp &amp;&amp; for var in TMPDIR TMP TEMP TEMPDIR ; do export $var=$HOME/tmp; done
&gt;     test -d $TMPDIR || echo Warning: TMPDIR is not set correctly.
&gt; 
That is fine.  However, given the existence of the tmpfile(3) function,
there is really no excuse for any program to employ a 1-up numbering of
temporary files.  Sepcifically, in the same section of the Secure-
Programs-HOWTO you cite:

   According to the 1997 ``Single Unix Specification&#39;&#39;, the preferred
   method for creating an arbitrary temporary file (using the C interface)
   is tmpfile(3). 

The paragraph after that goes on to talk about why mkstemp(3) is an even
better idea.  So, there are options.  Besides, given the choice between
the following two options:

1) One-time fix applied by upstream developer; by extenension, present
in all future releases.
2) Work around in ~/.bashrc (or equivalent) that must be applied to
every system accessed.  (Think a year or two down the road when you get
an account on a new machine).

I would say that that option 1 has major advantages:

1) Requires one person to do one thing to fix.
2) Less error prone/open to peer review.
3) Is not dependent on a specific user action.

-Roberto

-- 
Roberto C. Sanchez
<a href="http://familiasanchez.net/~sanchezr">http://familiasanchez.net/~sanchezr</a>
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=17">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="18"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=19">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="20"></a>
<strong>Acknowledgement sent</strong> to <code>Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=21">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="22"></a><a name="msg22"></a><a href="#22">Message #22</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=22">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=22">mbox</a>, <a href="mailto:311296@bugs.debian.org?References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E%20%3C20050531032440.GE18799%40miami.familiasanchez.net%3E%0A%20%3C20050531035411.GA8897%40zwitterion.humbug.org.au%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3C20050531035411.GA8897%40zwitterion.humbug.org.au%3E&amp;body=On%20Tue%2C%2031%20May%202005%2013%3A54%3A11%20%2B1000%20Mark%20Suter%20%3Csuter%40zwitterion.humbug.org.au%3E%20wrote%3A%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Robert%2C%0A%3E%20%0A%3E%20I%20agree%20Mutt%20should%20be%20fixed%20to%20create%20its%20temporary%20files%20in%0A%3E%20non-predictable%20fashion.%20%20That%20mutt%20honours%20TMPDIR%20provides%20a%0A%3E%20work-around%2C%20not%20the%20solution%20for%20Mutt.%0A%3E%20%0A%3E%20%3E%20Besides%2C%20given%20the%20choice%20between%20the%20following%20two%20options%3A%0A%3E%20%3E%20%0A%3E%20%3E%201%29%20One-time%20fix%20applied%20by%20upstream%20developer%3B%20by%20extenension%2C%20present%0A%3E%20%3E%20in%20all%20future%20releases.%0A%3E%20%0A%3E%20For%20this%20package%20only...%0A%3E%20%0A%3E%20%3E%202%29%20Work%20around%20in%20~%2F.bashrc%20%28or%20equivalent%29%20that%20must%20be%20applied%20to%0A%3E%20%3E%20every%20system%20accessed.%20%20%28Think%20a%20year%20or%20two%20down%20the%20road%20when%20you%20get%0A%3E%20%3E%20an%20account%20on%20a%20new%20machine%29.%0A%3E%20%0A%3E%20The%20flip-side%20of%20%282%29%20is%20that%20the%20user%20avoids%20this%20class%20of%20problem%20for%0A%3E%20many%20different%20packages%2C%20present%20and%20future.%20%20Setting%20TMPDIR%20is%20a%20good%0A%3E%20solution%20for%20the%20user%20-%20all%20software%20honouring%20this%20variable%20will%20nwo%0A%3E%20avoid%20all%20the%20issues%20of%20the%20shared%20%2Ftmp.%0A%3E%20%0A%3E%20%3E%20I%20would%20say%20that%20that%20option%201%20has%20major%20advantages%3A%0A%3E%20%3E%20%0A%3E%20%3E%201%29%20Requires%20one%20person%20to%20do%20one%20thing%20to%20fix.%0A%3E%20%3E%202%29%20Less%20error%20prone%2Fopen%20to%20peer%20review.%0A%3E%20%3E%203%29%20Is%20not%20dependent%20on%20a%20specific%20user%20action.%0A%3E%20%0A%3E%20I%20like%20doing%20both%20-%20defence%20in%20depth%2C%20you%20know%20%3B%29%0A%3E%20%0A%3E%20I%20largely%20agree%20with%20you%3B%20however%2C%20I%20felt%20that%20as%20TMPDIR%20is%20a%20solution%0A%3E%20to%20the%20entire%20class%20of%20shared%20%2Ftmp%20problems%2C%20it%27s%20worth%20mentioning.%0A%3E%20%0A%3E%20Yours%20sincerely%2C%0A%3E%20%0A%3E%20-%20--%20Mark%20John%20Suter%20%20%7C%20I%20know%20that%20you%20%20believe%20%20you%20understand%0A%3E%20suter%40humbug.org.au%20%7C%20what%20you%20think%20I%20said%2C%20but%20I%20am%20not%20sure%0A%3E%20gpg%20key%20id%202C71D63D%20%7C%20you%20realise%20that%20what%20you%20%20heard%20%20is%20not%0A%3E%20mobile%200411%20262%20316%20%7C%20what%20I%20meant.%20%20%20%20%20%20%20%20Robert%20J.%20McCloskey%0A%3E%20-----BEGIN%20PGP%20SIGNATURE-----%0A%3E%20Version%3A%20GnuPG%20v1.4.1%20%28GNU%2FLinux%29%0A%3E%20Comment%3A%20Check%20Keyservers%20or%20http%3A%2F%2Fzwitterion.org%2Fkeys%2F%0A%3E%20%0A%3E%20iD8DBQFCm9%2FjRYso2ixx1j0RApPkAJ0fhNl0oI9pXn6AGceJY6%2BxceyhIQCfUapn%0A%3E%20z%2B44G3LzGLrsp0DDAZ4oi7Q%3D%0A%3E%20%3DUjHJ%0A%3E%20-----END%20PGP%20SIGNATURE-----%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=suter%40zwitterion.humbug.org.au" alt="">
<div class="header"><span class="headerfield">From:</span> Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 13:54:11 +1000</div>
</div>
<pre class="message">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Robert,

I agree Mutt should be fixed to create its temporary files in
non-predictable fashion.  That mutt honours TMPDIR provides a
work-around, not the solution for Mutt.

&gt; Besides, given the choice between the following two options:
&gt; 
&gt; 1) One-time fix applied by upstream developer; by extenension, present
&gt; in all future releases.

For this package only...

&gt; 2) Work around in ~/.bashrc (or equivalent) that must be applied to
&gt; every system accessed.  (Think a year or two down the road when you get
&gt; an account on a new machine).

The flip-side of (2) is that the user avoids this class of problem for
many different packages, present and future.  Setting TMPDIR is a good
solution for the user - all software honouring this variable will nwo
avoid all the issues of the shared /tmp.

&gt; I would say that that option 1 has major advantages:
&gt; 
&gt; 1) Requires one person to do one thing to fix.
&gt; 2) Less error prone/open to peer review.
&gt; 3) Is not dependent on a specific user action.

I like doing both - defence in depth, you know ;)

I largely agree with you; however, I felt that as TMPDIR is a solution
to the entire class of shared /tmp problems, it&#39;s worth mentioning.

Yours sincerely,

- -- Mark John Suter  | I know that you  believe  you understand
suter@humbug.org.au | what you think I said, but I am not sure
gpg key id 2C71D63D | you realise that what you  heard  is not
mobile 0411 262 316 | what I meant.        Robert J. McCloskey
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)
Comment: Check Keyservers or <a href="http://zwitterion.org/keys/">http://zwitterion.org/keys/</a>

iD8DBQFCm9/jRYso2ixx1j0RApPkAJ0fhNl0oI9pXn6AGceJY6+xceyhIQCfUapn
z+44G3LzGLrsp0DDAZ4oi7Q=
=UjHJ
-----END PGP SIGNATURE-----


</pre>

<div class="infmessage"><hr><p>
<a name="23"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=24">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="25"></a>
<strong>Acknowledgement sent</strong> to <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=26">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="27"></a><a name="msg27"></a><a href="#27">Message #27</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=27">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=27">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3C20050531064356.GF18799%40miami.familiasanchez.net%3E&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E%20%3C20050531032440.GE18799%40miami.familiasanchez.net%3E%20%3C20050531035411.GA8897%40zwitterion.humbug.org.au%3E%0A%20%3C20050531064356.GF18799%40miami.familiasanchez.net%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;body=On%20Tue%2C%2031%20May%202005%2002%3A43%3A56%20-0400%20%22Roberto%20C.%20Sanchez%22%20%3Croberto%40familiasanchez.net%3E%20wrote%3A%0A%3E%20On%20Tue%2C%20May%2031%2C%202005%20at%2001%3A54%3A11PM%20%2B1000%2C%20Mark%20Suter%20wrote%3A%0A%3E%20%3E%20Robert%2C%0A%3E%20%3E%20%0A%3E%20%3E%20I%20agree%20Mutt%20should%20be%20fixed%20to%20create%20its%20temporary%20files%20in%0A%3E%20%3E%20non-predictable%20fashion.%20%20That%20mutt%20honours%20TMPDIR%20provides%20a%0A%3E%20%3E%20work-around%2C%20not%20the%20solution%20for%20Mutt.%0A%3E%20OK.%20%20I%20took%20what%20you%20initially%20said%20as%20you%20presenting%20TMPDIR%20as%20the%0A%3E%20canonical%20solution.%20%20That%20was%20my%20fault.%0A%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20%3E%20Besides%2C%20given%20the%20choice%20between%20the%20following%20two%20options%3A%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%201%29%20One-time%20fix%20applied%20by%20upstream%20developer%3B%20by%20extenension%2C%20present%0A%3E%20%3E%20%3E%20in%20all%20future%20releases.%0A%3E%20%3E%20%0A%3E%20%3E%20For%20this%20package%20only...%0A%3E%20%3E%20%0A%3E%20Not%20sure%20what%20this%20means.%20%20If%20the%20fix%20is%20only%20applied%20to%20the%20Debian%0A%3E%20package%2C%20then%20at%20least%20future%20releases%20of%20the%20Debian%20package.%20%20If%20it%20is%0A%3E%20applied%20upstream%2C%20then%20future%20upstream%20releases%20will%20have%20it%20as%20well.%0A%3E%20Either%20way%2C%20a%20larger%20group%20of%20users%20benefits.%0A%3E%20%0A%3E%20%3E%20%3E%202%29%20Work%20around%20in%20~%2F.bashrc%20%28or%20equivalent%29%20that%20must%20be%20applied%20to%0A%3E%20%3E%20%3E%20every%20system%20accessed.%20%20%28Think%20a%20year%20or%20two%20down%20the%20road%20when%20you%20get%0A%3E%20%3E%20%3E%20an%20account%20on%20a%20new%20machine%29.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20flip-side%20of%20%282%29%20is%20that%20the%20user%20avoids%20this%20class%20of%20problem%20for%0A%3E%20%3E%20many%20different%20packages%2C%20present%20and%20future.%20%20Setting%20TMPDIR%20is%20a%20good%0A%3E%20%3E%20solution%20for%20the%20user%20-%20all%20software%20honouring%20this%20variable%20will%20nwo%0A%3E%20%3E%20avoid%20all%20the%20issues%20of%20the%20shared%20%2Ftmp.%0A%3E%20%3E%20%0A%3E%20True.%20%20Of%20course%2C%20the%20user%20must%20not%20fall%20into%20thinking%20that%20setting%0A%3E%20TMPDIR%20is%20a%20silver%20bullet.%20%20Of%20course%2C%20mutt%20honors%20the%20setting%2C%20but%20not%0A%3E%20all%20programs%20do.%0A%3E%20%0A%3E%20%3E%20%3E%20I%20would%20say%20that%20that%20option%201%20has%20major%20advantages%3A%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%201%29%20Requires%20one%20person%20to%20do%20one%20thing%20to%20fix.%0A%3E%20%3E%20%3E%202%29%20Less%20error%20prone%2Fopen%20to%20peer%20review.%0A%3E%20%3E%20%3E%203%29%20Is%20not%20dependent%20on%20a%20specific%20user%20action.%0A%3E%20%3E%20%0A%3E%20%3E%20I%20like%20doing%20both%20-%20defence%20in%20depth%2C%20you%20know%20%3B%29%0A%3E%20%3E%20%0A%3E%20True.%20%20It%27s%20all%20about%20layering.%20%20Defense%2C%20security%2C%20keeping%20warm%20in%0A%3E%20winter%20and%20onions.%20%20There%20is%20a%20pattern%20there%20%3A-%29%0A%3E%20%0A%3E%20%3E%20I%20largely%20agree%20with%20you%3B%20however%2C%20I%20felt%20that%20as%20TMPDIR%20is%20a%20solution%0A%3E%20%3E%20to%20the%20entire%20class%20of%20shared%20%2Ftmp%20problems%2C%20it%27s%20worth%20mentioning.%0A%3E%20%3E%20%0A%3E%20If%20only%20all%20programs%20obeyed%20it.%20%20What%20would%20be%20really%20need%20would%20be%20if%0A%3E%20we%20turned%20%2Ftmp%20into%20a%20device%20node%20or%20something%20in%20proc.%20%20Then%20the%20system%0A%3E%20could%20redirect%20based%20on%20UID.%20%20That%20is%2C%20you%20run%20foo%20as%20yourself%20and%20it%0A%3E%20creates%20a%20temporary%20file%20under%20%2Ftmp%2C%20and%20I%20also%20run%20foo%20and%20create%20a%0A%3E%20temporary%20file%20under%20%2Ftmp%2C%20but%20they%20are%20both%20in%20different%20places.%20%20Just%0A%3E%20an%20idea.%0A%3E%20%0A%3E%20-Roberto%0A%3E%20%0A%3E%20--%20%0A%3E%20Roberto%20C.%20Sanchez%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=roberto%40familiasanchez.net" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 02:43:56 -0400</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=27">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Tue, May 31, 2005 at 01:54:11PM +1000, Mark Suter wrote:
&gt; Robert,
&gt; 
&gt; I agree Mutt should be fixed to create its temporary files in
&gt; non-predictable fashion.  That mutt honours TMPDIR provides a
&gt; work-around, not the solution for Mutt.
OK.  I took what you initially said as you presenting TMPDIR as the
canonical solution.  That was my fault.

&gt; 
&gt; &gt; Besides, given the choice between the following two options:
&gt; &gt; 
&gt; &gt; 1) One-time fix applied by upstream developer; by extenension, present
&gt; &gt; in all future releases.
&gt; 
&gt; For this package only...
&gt; 
Not sure what this means.  If the fix is only applied to the Debian
package, then at least future releases of the Debian package.  If it is
applied upstream, then future upstream releases will have it as well.
Either way, a larger group of users benefits.

&gt; &gt; 2) Work around in ~/.bashrc (or equivalent) that must be applied to
&gt; &gt; every system accessed.  (Think a year or two down the road when you get
&gt; &gt; an account on a new machine).
&gt; 
&gt; The flip-side of (2) is that the user avoids this class of problem for
&gt; many different packages, present and future.  Setting TMPDIR is a good
&gt; solution for the user - all software honouring this variable will nwo
&gt; avoid all the issues of the shared /tmp.
&gt; 
True.  Of course, the user must not fall into thinking that setting
TMPDIR is a silver bullet.  Of course, mutt honors the setting, but not
all programs do.

&gt; &gt; I would say that that option 1 has major advantages:
&gt; &gt; 
&gt; &gt; 1) Requires one person to do one thing to fix.
&gt; &gt; 2) Less error prone/open to peer review.
&gt; &gt; 3) Is not dependent on a specific user action.
&gt; 
&gt; I like doing both - defence in depth, you know ;)
&gt; 
True.  It&#39;s all about layering.  Defense, security, keeping warm in
winter and onions.  There is a pattern there :-)

&gt; I largely agree with you; however, I felt that as TMPDIR is a solution
&gt; to the entire class of shared /tmp problems, it&#39;s worth mentioning.
&gt; 
If only all programs obeyed it.  What would be really need would be if
we turned /tmp into a device node or something in proc.  Then the system
could redirect based on UID.  That is, you run foo as yourself and it
creates a temporary file under /tmp, and I also run foo and create a
temporary file under /tmp, but they are both in different places.  Just
an idea.

-Roberto

-- 
Roberto C. Sanchez
<a href="http://familiasanchez.net/~sanchezr">http://familiasanchez.net/~sanchezr</a>
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=27">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="28"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=29">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="30"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nico@ngolde.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=31">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="32"></a><a name="msg32"></a><a href="#32">Message #32</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=32">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=32">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2010%3A50%3A44%20%2B0200%20Nico%20Golde%20%3Cnico%40ngolde.de%3E%20wrote%3A%0A%3E%20Hello%20Roberto%2C%0A%3E%20%0A%3E%20%2A%20Roberto%20C.%20Sanchez%20%3Croberto%40familiasanchez.net%3E%20%5B2005-05-31%2010%3A45%5D%3A%0A%3E%20%5B...%5D%20%0A%3E%20%3E%20I%20am%20only%20making%20this%20important%20becuase%20after%20discussing%20it%20on%0A%3E%20%3E%20%23debian-devel%2C%20the%20consensus%20was%20the%20this%20was%20annoying%20but%20not%20RC.%20%20I%20am%0A%3E%20%3E%20CC%27ing%20Nico%20and%20Elimar%20since%20this%20also%20applies%20to%20the%20unnofficial%0A%3E%20%3E%20mutt-ng%20pacakges.%20%20mutt%20creates%20temporary%20files%20in%20a%20very%20predictable%0A%3E%20%3E%20and%20unsecure%20way.%20%20There%20is%20no%20threat%20of%20overwriting%20an%20existing%20file%20or%0A%3E%20%3E%20creating%20a%20file%20somewhere%20where%20the%20user%20lacks%20appropriate%20permissions%2C%0A%3E%20%3E%20but%20there%20is%20a%20trivial%20way%20to%20DoS%20the%20users%20in%20mutt.%0A%3E%20%3E%20%0A%3E%20%3E%20Steps%20to%20replicate%3A%0A%3E%20%3E%20%0A%3E%20%3E%20Log%20into%20a%20shared%20machine%20and%20run%20%27ps%20aux%7Cgrep%20mutt%27.%20%20Choose%20a%20user%0A%3E%20%3E%20running%20mutt.%20%20Note%20the%20pid%20of%20the%20mutt%20process%20you%20want%20to%20DOS.%20%20Note%0A%3E%20%3E%20the%20username%20and%20run%20%27id%20%3Cuser%3E%27%20to%20get%20the%20uid.%20%20Then%20run%20%27for%20i%20in%0A%3E%20%3E%20%60seq%200%201000%60%20%3B%20do%20touch%20%2Ftmp%2Fmutt-%3Chostname%3E-%3Cuid%3E-%3Cpid%3E-%24i%20%3B%20done%27%20and%0A%3E%20%3E%20watch%20the%20user%20not%20be%20able%20to%201%29%20compose%20mail%2C%202%29%20change%20mailboxes%2C%203%29%0A%3E%20%3E%20reply%20to%20mail%2C%204%29%20or%20view%20help%20until%20mutt%20is%20restarted.%20%20For%20added%20fun%2C%0A%3E%20%3E%20wrap%20in%20another%20for%20loop%20that%20iterates%20from%200%20to%2032767%20and%20hit%20all%20the%0A%3E%20%3E%20PIDs%20and%20prevent%20the%20user%20from%20using%20mutt%20unil%20%2Ftmp%20is%20cleaned%20or%20the%0A%3E%20%3E%20machine%20is%20rebooted.%0A%3E%20%0A%3E%20Thanks%2C%20its%20on%20our%20todo%20list.%20Patches%20are%20welcome%21%0A%3E%20Regards%20Nico%0A%3E%20--%20%0A%3E%20Nico%20Golde%20-%20310777820%40ICQ%20%7C%20GPG%3A%201024D%2F73647CFF%0A%3E%20http%3A%2F%2Fwww.ngolde.de%20%7C%20http%3A%2F%2Fwww.muttng.org%20%7C%20http%3A%2F%2Fgrml.org%20%0A%3E%20VIM%20has%20two%20modes%20-%20the%20one%20in%20which%20it%20beeps%20%0A%3E%20and%20the%20one%20in%20which%20it%20doesn%27t%20--%20encrypted%20mail%20preferred%0A&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%0A%20%3C20050531085044.GA6001%40ngolde.de%3E&amp;In-Reply-To=%3C20050531085044.GA6001%40ngolde.de%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nico%40ngolde.de" alt="">
<div class="header"><span class="headerfield">From:</span> Nico Golde &lt;nico@ngolde.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 10:50:44 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=32">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hello Roberto,

* Roberto C. Sanchez &lt;roberto@familiasanchez.net&gt; [2005-05-31 10:45]:
[...] 
&gt; I am only making this important becuase after discussing it on
&gt; #debian-devel, the consensus was the this was annoying but not RC.  I am
&gt; CC&#39;ing Nico and Elimar since this also applies to the unnofficial
&gt; mutt-ng pacakges.  mutt creates temporary files in a very predictable
&gt; and unsecure way.  There is no threat of overwriting an existing file or
&gt; creating a file somewhere where the user lacks appropriate permissions,
&gt; but there is a trivial way to DoS the users in mutt.
&gt; 
&gt; Steps to replicate:
&gt; 
&gt; Log into a shared machine and run &#39;ps aux|grep mutt&#39;.  Choose a user
&gt; running mutt.  Note the pid of the mutt process you want to DOS.  Note
&gt; the username and run &#39;id &lt;user&gt;&#39; to get the uid.  Then run &#39;for i in
&gt; `seq 0 1000` ; do touch /tmp/mutt-&lt;hostname&gt;-&lt;uid&gt;-&lt;pid&gt;-$i ; done&#39; and
&gt; watch the user not be able to 1) compose mail, 2) change mailboxes, 3)
&gt; reply to mail, 4) or view help until mutt is restarted.  For added fun,
&gt; wrap in another for loop that iterates from 0 to 32767 and hit all the
&gt; PIDs and prevent the user from using mutt unil /tmp is cleaned or the
&gt; machine is rebooted.

Thanks, its on our todo list. Patches are welcome!
Regards Nico
-- 
Nico Golde - 310777820@ICQ | GPG: 1024D/73647CFF
<a href="http://www.ngolde.de">http://www.ngolde.de</a> | <a href="http://www.muttng.org">http://www.muttng.org</a> | <a href="http://grml.org">http://grml.org</a> 
VIM has two modes - the one in which it beeps 
and the one in which it doesn&#39;t -- encrypted mail preferred
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=32">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="33"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=34">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=34">mbox</a>, <a href="#33">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="35"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nico@ngolde.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=36">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=36">mbox</a>, <a href="#35">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="38"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=39">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=39">mbox</a>, <a href="#38">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="40"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nico@ngolde.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=41">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=41">mbox</a>, <a href="#40">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="42"></a><a name="msg42"></a><a href="#42">Message #42</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=42">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=42">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2016%3A22%3A08%20%2B0200%20Nico%20Golde%20%3Cnico%40ngolde.de%3E%20wrote%3A%0A%3E%20Hello%20Roberto%2C%0A%3E%20%0A%3E%20%2A%20Roberto%20C.%20Sanchez%20%3Croberto%40familiasanchez.net%3E%20%5B2005-05-31%2010%3A45%5D%3A%0A%3E%20%3E%20Package%3A%20mutt%0A%3E%20%3E%20Version%3A%201.5.9-2%0A%3E%20%3E%20Severity%3A%20important%0A%3E%20%3E%20%0A%3E%20%3E%20I%20am%20only%20making%20this%20important%20becuase%20after%20discussing%20it%20on%0A%3E%20%3E%20%23debian-devel%2C%20the%20consensus%20was%20the%20this%20was%20annoying%20but%20not%20RC.%20%20I%20am%0A%3E%20%3E%20CC%27ing%20Nico%20and%20Elimar%20since%20this%20also%20applies%20to%20the%20unnofficial%0A%3E%20%3E%20mutt-ng%20pacakges.%20%20mutt%20creates%20temporary%20files%20in%20a%20very%20predictable%0A%3E%20%3E%20and%20unsecure%20way.%20%20There%20is%20no%20threat%20of%20overwriting%20an%20existing%20file%20or%0A%3E%20%3E%20creating%20a%20file%20somewhere%20where%20the%20user%20lacks%20appropriate%20permissions%2C%0A%3E%20%3E%20but%20there%20is%20a%20trivial%20way%20to%20DoS%20the%20users%20in%20mutt.%0A%3E%20%3E%20%0A%3E%20%3E%20Steps%20to%20replicate%3A%0A%3E%20%3E%20%0A%3E%20%3E%20Log%20into%20a%20shared%20machine%20and%20run%20%27ps%20aux%7Cgrep%20mutt%27.%20%20Choose%20a%20user%0A%3E%20%3E%20running%20mutt.%20%20Note%20the%20pid%20of%20the%20mutt%20process%20you%20want%20to%20DOS.%20%20Note%0A%3E%20%3E%20the%20username%20and%20run%20%27id%20%3Cuser%3E%27%20to%20get%20the%20uid.%20%20Then%20run%20%27for%20i%20in%0A%3E%20%3E%20%60seq%200%201000%60%20%3B%20do%20touch%20%2Ftmp%2Fmutt-%3Chostname%3E-%3Cuid%3E-%3Cpid%3E-%24i%20%3B%20done%27%20and%0A%3E%20%3E%20watch%20the%20user%20not%20be%20able%20to%201%29%20compose%20mail%2C%202%29%20change%20mailboxes%2C%203%29%0A%3E%20%3E%20reply%20to%20mail%2C%204%29%20or%20view%20help%20until%20mutt%20is%20restarted.%20%20For%20added%20fun%2C%0A%3E%20%3E%20wrap%20in%20another%20for%20loop%20that%20iterates%20from%200%20to%2032767%20and%20hit%20all%20the%0A%3E%20%3E%20PIDs%20and%20prevent%20the%20user%20from%20using%20mutt%20unil%20%2Ftmp%20is%20cleaned%20or%20the%0A%3E%20%3E%20machine%20is%20rebooted.%0A%3E%20%0A%3E%20I%20fixed%20this%20bug%20for%20mutt-ng.%0A%3E%20I%20attached%20a%2064%20bit%20hex%20string%20to%20the%20temporary%20file%20name.%0A%3E%20In%20my%20opinion%20the%20TMPDIR%20solution%20is%20not%20very%20good.%0A%3E%20Please%20CC%20me.%0A%3E%20Index%3A%20trunk%2Fmuttlib.c%0A%3E%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%3E%20---%20trunk%2Fmuttlib.c%20%20%20%20%20%28Revision%20306%29%0A%3E%20%2B%2B%2B%20trunk%2Fmuttlib.c%20%20%20%20%20%28Revision%20308%29%0A%3E%20%40%40%20-647%2C8%20%2B647%2C10%20%40%40%0A%3E%20%20%0A%3E%20%20void%20_mutt_mktemp%20%28char%20%2As%2C%20const%20char%20%2Asrc%2C%20int%20line%29%0A%3E%20%20%7B%0A%3E%20-%20%20snprintf%20%28s%2C%20_POSIX_PATH_MAX%2C%20%22%25s%2Fmuttng-%25s-%25d-%25d-%25d%22%2C%20NONULL%20%28Tempdir%29%2C%0A%3E%20-%20%20%20%20%20%20%20%20%20%20%20%20NONULL%20%28Hostname%29%2C%20%28int%29%20getuid%20%28%29%2C%20%28int%29%20getpid%20%28%29%2C%20Counter%2B%2B%29%3B%0A%3E%20%2B%0A%3E%20%2B%20%20snprintf%20%28s%2C%20_POSIX_PATH_MAX%2C%20%22%25s%2Fmuttng-%25s-%25d-%25d-%25d-%25x%25x%22%2C%20NONULL%20%28Tempdir%29%2C%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20NONULL%20%28Hostname%29%2C%20%28int%29%20getuid%20%28%29%2C%20%28int%29%20getpid%20%28%29%2C%20Counter%2B%2B%2C%20%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20%28unsigned%20int%29%20rand%28%29%2C%20%28unsigned%20int%29%20rand%28%29%29%3B%0A%3E%20Regards%20Nico%20Golde%0A%3E%20%0A%3E%20--%20%0A%3E%20Nico%20Golde%20-%20310777820%40ICQ%20%7C%20GPG%3A%201024D%2F73647CFF%0A%3E%20http%3A%2F%2Fwww.ngolde.de%20%7C%20http%3A%2F%2Fwww.muttng.org%20%7C%20http%3A%2F%2Fgrml.org%20%0A%3E%20VIM%20has%20two%20modes%20-%20the%20one%20in%20which%20it%20beeps%20%0A%3E%20and%20the%20one%20in%20which%20it%20doesn%27t%20--%20encrypted%20mail%20preferred%0A&amp;In-Reply-To=%3C20050531142208.GA7360%40ngolde.de%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%0A%20%3C20050531142208.GA7360%40ngolde.de%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nico%40ngolde.de" alt="">
<div class="header"><span class="headerfield">From:</span> Nico Golde &lt;nico@ngolde.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 16:22:08 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=42">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hello Roberto,

* Roberto C. Sanchez &lt;roberto@familiasanchez.net&gt; [2005-05-31 10:45]:
&gt; Package: mutt
&gt; Version: 1.5.9-2
&gt; Severity: important
&gt; 
&gt; I am only making this important becuase after discussing it on
&gt; #debian-devel, the consensus was the this was annoying but not RC.  I am
&gt; CC&#39;ing Nico and Elimar since this also applies to the unnofficial
&gt; mutt-ng pacakges.  mutt creates temporary files in a very predictable
&gt; and unsecure way.  There is no threat of overwriting an existing file or
&gt; creating a file somewhere where the user lacks appropriate permissions,
&gt; but there is a trivial way to DoS the users in mutt.
&gt; 
&gt; Steps to replicate:
&gt; 
&gt; Log into a shared machine and run &#39;ps aux|grep mutt&#39;.  Choose a user
&gt; running mutt.  Note the pid of the mutt process you want to DOS.  Note
&gt; the username and run &#39;id &lt;user&gt;&#39; to get the uid.  Then run &#39;for i in
&gt; `seq 0 1000` ; do touch /tmp/mutt-&lt;hostname&gt;-&lt;uid&gt;-&lt;pid&gt;-$i ; done&#39; and
&gt; watch the user not be able to 1) compose mail, 2) change mailboxes, 3)
&gt; reply to mail, 4) or view help until mutt is restarted.  For added fun,
&gt; wrap in another for loop that iterates from 0 to 32767 and hit all the
&gt; PIDs and prevent the user from using mutt unil /tmp is cleaned or the
&gt; machine is rebooted.

I fixed this bug for mutt-ng.
I attached a 64 bit hex string to the temporary file name.
In my opinion the TMPDIR solution is not very good.
Please CC me.
Index: trunk/muttlib.c
===================================================================
--- trunk/muttlib.c     (Revision 306)
+++ trunk/muttlib.c     (Revision 308)
@@ -647,8 +647,10 @@
 
 void _mutt_mktemp (char *s, const char *src, int line)
 {
-  snprintf (s, _POSIX_PATH_MAX, &quot;%s/muttng-%s-%d-%d-%d&quot;, NONULL (Tempdir),
-            NONULL (Hostname), (int) getuid (), (int) getpid (), Counter++);
+
+  snprintf (s, _POSIX_PATH_MAX, &quot;%s/muttng-%s-%d-%d-%d-%x%x&quot;, NONULL (Tempdir),
+            NONULL (Hostname), (int) getuid (), (int) getpid (), Counter++, 
+            (unsigned int) rand(), (unsigned int) rand());
Regards Nico Golde

-- 
Nico Golde - 310777820@ICQ | GPG: 1024D/73647CFF
<a href="http://www.ngolde.de">http://www.ngolde.de</a> | <a href="http://www.muttng.org">http://www.muttng.org</a> | <a href="http://grml.org">http://grml.org</a> 
VIM has two modes - the one in which it beeps 
and the one in which it doesn&#39;t -- encrypted mail preferred
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=42">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="43"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=44">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="45"></a>
<strong>Acknowledgement sent</strong> to <code>Vincent Lefevre &lt;vincent@vinc17.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=46">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=46">mbox</a>, <a href="#45">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="47"></a><a name="msg47"></a><a href="#47">Message #47</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=47">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=47">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2016%3A16%3A44%20%2B0200%20Vincent%20Lefevre%20%3Cvincent%40vinc17.org%3E%20wrote%3A%0A%3E%20%3E%20From%3A%20%22Roberto%20C.%20Sanchez%22%20%3Croberto%40familiasanchez.net%3E%0A%3E%20%0A%3E%20%3E%20%5B...%5D%20There%20is%20no%20threat%20of%20overwriting%20an%20existing%20file%20or%20creating%0A%3E%20%3E%20a%20file%20somewhere%20where%20the%20user%20lacks%20appropriate%20permissions%2C%20but%0A%3E%20%3E%20there%20is%20a%20trivial%20way%20to%20DoS%20the%20users%20in%20mutt.%0A%3E%20%0A%3E%20The%20user%20can%20still%20change%20%24tmpdir%20in%20his%20muttrc%20to%20avoid%20this%20problem%0A%3E%20%28and%20also%20avoid%20losing%20data%20if%20the%20machine%20is%20rebooted%29.%20So%2C%20it%20would%0A%3E%20be%20even%20more%20trivial%20by%20filling%20up%20the%20disk%2C%20but%20this%20would%20not%20be%20a%0A%3E%20bug%20in%20Mutt.%0A%3E%20%0A%3E%20IMHO%2C%20this%20is%20just%20a%20minor%20problem.%0A%3E%20%0A%3E%20--%20%0A%3E%20Vincent%20Lef%C3%A8vre%20%3Cvincent%40vinc17.org%3E%20-%20Web%3A%20%3Chttp%3A%2F%2Fwww.vinc17.org%2F%3E%0A%3E%20100%25%20accessible%20validated%20%28X%29HTML%20-%20Blog%3A%20%3Chttp%3A%2F%2Fwww.vinc17.org%2Fblog%2F%3E%0A%3E%20Work%3A%20CR%20INRIA%20-%20computer%20arithmetic%20%2F%20SPACES%20project%20at%20LORIA%0A%3E%20%0A%3E%20%0A&amp;References=%3C20050530192420.GA9513%40wonderland.linux.it%3E%0A%20%3C20050531141644.GX3541%40ay.vinc17.org%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3C20050531141644.GX3541%40ay.vinc17.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=vincent%40vinc17.org" alt="">
<div class="header"><span class="headerfield">From:</span> Vincent Lefevre &lt;vincent@vinc17.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 311296@bugs.debian.org, mutt-dev@mutt.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 16:16:44 +0200</div>
</div>
<pre class="message">&gt; From: &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;

&gt; [...] There is no threat of overwriting an existing file or creating
&gt; a file somewhere where the user lacks appropriate permissions, but
&gt; there is a trivial way to DoS the users in mutt.

The user can still change $tmpdir in his muttrc to avoid this problem
(and also avoid losing data if the machine is rebooted). So, it would
be even more trivial by filling up the disk, but this would not be a
bug in Mutt.

IMHO, this is just a minor problem.

-- 
Vincent Lefèvre &lt;vincent@vinc17.org&gt; - Web: &lt;<a href="http://www.vinc17.org/">http://www.vinc17.org/</a>&gt;
100% accessible validated (X)HTML - Blog: &lt;<a href="http://www.vinc17.org/blog/">http://www.vinc17.org/blog/</a>&gt;
Work: CR INRIA - computer arithmetic / SPACES project at LORIA


</pre>

<div class="infmessage"><hr><p>
<a name="48"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=49">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=49">mbox</a>, <a href="#48">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="50"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nico@ngolde.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=51">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=51">mbox</a>, <a href="#50">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="53"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=54">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=54">mbox</a>, <a href="#53">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="55"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nion@muttng.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=56">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=56">mbox</a>, <a href="#55">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="57"></a><a name="msg57"></a><a href="#57">Message #57</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=57">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=57">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2012%3A18%3A25%20%2B0200%20Nico%20Golde%20%3Cnion%40muttng.org%3E%20wrote%3A%0A%3E%20Hello%20Roberto%2C%0A%3E%20%0A%3E%20%2A%20Roberto%20C.%20Sanchez%20%3Croberto%40familiasanchez.net%3E%20%5B2005-05-31%2010%3A45%5D%3A%0A%3E%20%0A%3E%20%5B...%5D%20%0A%3E%20%3E%20Steps%20to%20replicate%3A%0A%3E%20%3E%20%0A%3E%20%3E%20Log%20into%20a%20shared%20machine%20and%20run%20%27ps%20aux%7Cgrep%20mutt%27.%20%20Choose%20a%20user%0A%3E%20%3E%20running%20mutt.%20%20Note%20the%20pid%20of%20the%20mutt%20process%20you%20want%20to%20DOS.%20%20Note%0A%3E%20%3E%20the%20username%20and%20run%20%27id%20%3Cuser%3E%27%20to%20get%20the%20uid.%20%20Then%20run%20%27for%20i%20in%0A%3E%20%3E%20%60seq%200%201000%60%20%3B%20do%20touch%20%2Ftmp%2Fmutt-%3Chostname%3E-%3Cuid%3E-%3Cpid%3E-%24i%20%3B%20done%27%20and%0A%3E%20%3E%20watch%20the%20user%20not%20be%20able%20to%201%29%20compose%20mail%2C%202%29%20change%20mailboxes%2C%203%29%0A%3E%20%3E%20reply%20to%20mail%2C%204%29%20or%20view%20help%20until%20mutt%20is%20restarted.%20%20For%20added%20fun%2C%0A%3E%20%3E%20wrap%20in%20another%20for%20loop%20that%20iterates%20from%200%20to%2032767%20and%20hit%20all%20the%0A%3E%20%3E%20PIDs%20and%20prevent%20the%20user%20from%20using%20mutt%20unil%20%2Ftmp%20is%20cleaned%20or%20the%0A%3E%20%3E%20machine%20is%20rebooted.%0A%3E%20%0A%3E%20I%20have%20problems%20with%20reproducing%20this.%20I%20tried%20it%20with%0A%3E%20mutt-ng%20but%20it%20seems%20that%20mutt-ng%20is%20simply%20overwriting%20this%0A%3E%20files%20so%20mutt-ng%20is%20runiing%20well%20with%20it.%0A%3E%20But%20anyway%2C%20the%20tmp%20file%20generation%20is%20not%20very%20good%20so%20I%0A%3E%20will%20add%20an%20aditional%20more%20random%20string%20to%20the%20file%20name.%0A%3E%20Regards%20Nico%0A%3E%20--%20%0A%3E%20Nico%20Golde%20-%20310777820%40ICQ%20%7C%20GPG%3A%201024D%2F73647CFF%0A%3E%20http%3A%2F%2Fwww.ngolde.de%20%7C%20http%3A%2F%2Fwww.muttng.org%20%7C%20http%3A%2F%2Fgrml.org%20%0A%3E%20VIM%20has%20two%20modes%20-%20the%20one%20in%20which%20it%20beeps%20%0A%3E%20and%20the%20one%20in%20which%20it%20doesn%27t%20--%20encrypted%20mail%20preferred%0A&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%0A%20%3C20050531101824.GH6001%40ngolde.de%3E&amp;In-Reply-To=%3C20050531101824.GH6001%40ngolde.de%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nion%40muttng.org" alt="">
<div class="header"><span class="headerfield">From:</span> Nico Golde &lt;nion@muttng.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 12:18:25 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=57">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hello Roberto,

* Roberto C. Sanchez &lt;roberto@familiasanchez.net&gt; [2005-05-31 10:45]:

[...] 
&gt; Steps to replicate:
&gt; 
&gt; Log into a shared machine and run &#39;ps aux|grep mutt&#39;.  Choose a user
&gt; running mutt.  Note the pid of the mutt process you want to DOS.  Note
&gt; the username and run &#39;id &lt;user&gt;&#39; to get the uid.  Then run &#39;for i in
&gt; `seq 0 1000` ; do touch /tmp/mutt-&lt;hostname&gt;-&lt;uid&gt;-&lt;pid&gt;-$i ; done&#39; and
&gt; watch the user not be able to 1) compose mail, 2) change mailboxes, 3)
&gt; reply to mail, 4) or view help until mutt is restarted.  For added fun,
&gt; wrap in another for loop that iterates from 0 to 32767 and hit all the
&gt; PIDs and prevent the user from using mutt unil /tmp is cleaned or the
&gt; machine is rebooted.

I have problems with reproducing this. I tried it with
mutt-ng but it seems that mutt-ng is simply overwriting this
files so mutt-ng is runiing well with it.
But anyway, the tmp file generation is not very good so I
will add an aditional more random string to the file name.
Regards Nico
-- 
Nico Golde - 310777820@ICQ | GPG: 1024D/73647CFF
<a href="http://www.ngolde.de">http://www.ngolde.de</a> | <a href="http://www.muttng.org">http://www.muttng.org</a> | <a href="http://grml.org">http://grml.org</a> 
VIM has two modes - the one in which it beeps 
and the one in which it doesn&#39;t -- encrypted mail preferred
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=57">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="58"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=59">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=59">mbox</a>, <a href="#58">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="60"></a>
<strong>Acknowledgement sent</strong> to <code>311296@bugs.debian.org, Adeodato Simó &lt;asp16@alu.ua.es&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=61">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=61">mbox</a>, <a href="#60">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="62"></a><a name="msg62"></a><a href="#62">Message #62</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=62">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=62">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2016%3A58%3A34%20%2B0200%20Adeodato%20%3D%3Futf-8%3FB%3FU2ltw7M%3D%3F%3D%20%3Casp16%40alu.ua.es%3E%20wrote%3A%0A%3E%20%20%20Hello%20Nico%2C%20could%20you%20please%20avoid%20CC%27ing%20submit%40bugs.debian.org%20on%0A%3E%20%20%20your%20mails.%20PTS%20subscribers%20get%20duplicated%20e-mails.%0A%3E%20%0A%3E%20%20%20Thanks.%0A%3E%20%0A%3E%20--%20%0A%3E%20Adeodato%20Sim%C3%B3%0A%3E%20%20%20%20%20EM%3A%20asp16%20%5Bykwim%5D%20alu.ua.es%20%7C%20PK%3A%20DA6AE621%0A%3E%20%20%0A%3E%20One%20way%20to%20make%20your%20old%20car%20run%20better%20is%20to%20look%20up%20the%20price%20of%20a%20new%20model.%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531142208.GA7360%40ngolde.de%3E%0A%20%3C20050531145834.GA3836%40chistera.yi.org%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3C20050531145834.GA3836%40chistera.yi.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=asp16%40alu.ua.es" alt="">
<div class="header"><span class="headerfield">From:</span> Adeodato Simó &lt;asp16@alu.ua.es&gt;</div>
<div class="header"><span class="headerfield">To:</span> Nico Golde &lt;nico@ngolde.de&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 16:58:34 +0200</div>
</div>
<pre class="message">  Hello Nico, could you please avoid CC&#39;ing submit@bugs.debian.org on
  your mails. PTS subscribers get duplicated e-mails.

  Thanks.

-- 
Adeodato Simó
    EM: asp16 [ykwim] alu.ua.es | PK: DA6AE621
 
One way to make your old car run better is to look up the price of a new model.



</pre>

<div class="infmessage"><hr><p>
<a name="63"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=64">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=64">mbox</a>, <a href="#63">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="65"></a>
<strong>Acknowledgement sent</strong> to <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=66">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=66">mbox</a>, <a href="#65">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="67"></a><a name="msg67"></a><a href="#67">Message #67</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=67">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=67">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3C20050531163745.GA29787%40miami.familiasanchez.net%3E&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531142208.GA7360%40ngolde.de%3E%0A%20%3C20050531163745.GA29787%40miami.familiasanchez.net%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;body=On%20Tue%2C%2031%20May%202005%2012%3A37%3A45%20-0400%20%22Roberto%20C.%20Sanchez%22%20%3Croberto%40familiasanchez.net%3E%20wrote%3A%0A%3E%20On%20Tue%2C%20May%2031%2C%202005%20at%2004%3A22%3A08PM%20%2B0200%2C%20Nico%20Golde%20wrote%3A%0A%3E%20%3E%20Hello%20Roberto%2C%0A%3E%20%3E%20%0A%3E%20%3E%20%2A%20Roberto%20C.%20Sanchez%20%3Croberto%40familiasanchez.net%3E%20%5B2005-05-31%2010%3A45%5D%3A%0A%3E%20%3E%20%3E%20Package%3A%20mutt%0A%3E%20%3E%20%3E%20Version%3A%201.5.9-2%0A%3E%20%3E%20%3E%20Severity%3A%20important%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20I%20am%20only%20making%20this%20important%20becuase%20after%20discussing%20it%20on%0A%3E%20%3E%20%3E%20%23debian-devel%2C%20the%20consensus%20was%20the%20this%20was%20annoying%20but%20not%20RC.%20%20I%20am%0A%3E%20%3E%20%3E%20CC%27ing%20Nico%20and%20Elimar%20since%20this%20also%20applies%20to%20the%20unnofficial%0A%3E%20%3E%20%3E%20mutt-ng%20pacakges.%20%20mutt%20creates%20temporary%20files%20in%20a%20very%20predictable%0A%3E%20%3E%20%3E%20and%20unsecure%20way.%20%20There%20is%20no%20threat%20of%20overwriting%20an%20existing%20file%20or%0A%3E%20%3E%20%3E%20creating%20a%20file%20somewhere%20where%20the%20user%20lacks%20appropriate%20permissions%2C%0A%3E%20%3E%20%3E%20but%20there%20is%20a%20trivial%20way%20to%20DoS%20the%20users%20in%20mutt.%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20Steps%20to%20replicate%3A%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20Log%20into%20a%20shared%20machine%20and%20run%20%27ps%20aux%7Cgrep%20mutt%27.%20%20Choose%20a%20user%0A%3E%20%3E%20%3E%20running%20mutt.%20%20Note%20the%20pid%20of%20the%20mutt%20process%20you%20want%20to%20DOS.%20%20Note%0A%3E%20%3E%20%3E%20the%20username%20and%20run%20%27id%20%3Cuser%3E%27%20to%20get%20the%20uid.%20%20Then%20run%20%27for%20i%20in%0A%3E%20%3E%20%3E%20%60seq%200%201000%60%20%3B%20do%20touch%20%2Ftmp%2Fmutt-%3Chostname%3E-%3Cuid%3E-%3Cpid%3E-%24i%20%3B%20done%27%20and%0A%3E%20%3E%20%3E%20watch%20the%20user%20not%20be%20able%20to%201%29%20compose%20mail%2C%202%29%20change%20mailboxes%2C%203%29%0A%3E%20%3E%20%3E%20reply%20to%20mail%2C%204%29%20or%20view%20help%20until%20mutt%20is%20restarted.%20%20For%20added%20fun%2C%0A%3E%20%3E%20%3E%20wrap%20in%20another%20for%20loop%20that%20iterates%20from%200%20to%2032767%20and%20hit%20all%20the%0A%3E%20%3E%20%3E%20PIDs%20and%20prevent%20the%20user%20from%20using%20mutt%20unil%20%2Ftmp%20is%20cleaned%20or%20the%0A%3E%20%3E%20%3E%20machine%20is%20rebooted.%0A%3E%20%3E%20%0A%3E%20%3E%20I%20fixed%20this%20bug%20for%20mutt-ng.%0A%3E%20%3E%20I%20attached%20a%2064%20bit%20hex%20string%20to%20the%20temporary%20file%20name.%0A%3E%20%3E%20In%20my%20opinion%20the%20TMPDIR%20solution%20is%20not%20very%20good.%0A%3E%20%3E%20Please%20CC%20me.%0A%3E%20%3E%20Index%3A%20trunk%2Fmuttlib.c%0A%3E%20%3E%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%3E%20%3E%20---%20trunk%2Fmuttlib.c%20%20%20%20%20%28Revision%20306%29%0A%3E%20%3E%20%2B%2B%2B%20trunk%2Fmuttlib.c%20%20%20%20%20%28Revision%20308%29%0A%3E%20%3E%20%40%40%20-647%2C8%20%2B647%2C10%20%40%40%0A%3E%20%3E%20%20%0A%3E%20%3E%20%20void%20_mutt_mktemp%20%28char%20%2As%2C%20const%20char%20%2Asrc%2C%20int%20line%29%0A%3E%20%3E%20%20%7B%0A%3E%20%3E%20-%20%20snprintf%20%28s%2C%20_POSIX_PATH_MAX%2C%20%22%25s%2Fmuttng-%25s-%25d-%25d-%25d%22%2C%20NONULL%20%28Tempdir%29%2C%0A%3E%20%3E%20-%20%20%20%20%20%20%20%20%20%20%20%20NONULL%20%28Hostname%29%2C%20%28int%29%20getuid%20%28%29%2C%20%28int%29%20getpid%20%28%29%2C%20Counter%2B%2B%29%3B%0A%3E%20%3E%20%2B%0A%3E%20%3E%20%2B%20%20snprintf%20%28s%2C%20_POSIX_PATH_MAX%2C%20%22%25s%2Fmuttng-%25s-%25d-%25d-%25d-%25x%25x%22%2C%20NONULL%20%28Tempdir%29%2C%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20NONULL%20%28Hostname%29%2C%20%28int%29%20getuid%20%28%29%2C%20%28int%29%20getpid%20%28%29%2C%20Counter%2B%2B%2C%20%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20%28unsigned%20int%29%20rand%28%29%2C%20%28unsigned%20int%29%20rand%28%29%29%3B%0A%3E%20%3E%20Regards%20Nico%20Golde%0A%3E%20%3E%20%0A%3E%20%0A%3E%20Thanks.%20%20Another%20possible%20solution%20is%20the%20use%20of%20the%20tmpfile%283%29%20or%0A%3E%20mkstemp%283%29%20functions.%20%20But%20yours%20appears%20sound%20as%20well.%0A%3E%20%0A%3E%20-Roberto%0A%3E%20%0A%3E%20--%20%0A%3E%20Roberto%20C.%20Sanchez%0A%3E%20http%3A%2F%2Ffamiliasanchez.net%2F~sanchezr%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=roberto%40familiasanchez.net" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> Nico Golde &lt;nico@ngolde.de&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 311296@bugs.debian.org,
	Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 12:37:45 -0400</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=67">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Tue, May 31, 2005 at 04:22:08PM +0200, Nico Golde wrote:
&gt; Hello Roberto,
&gt; 
&gt; * Roberto C. Sanchez &lt;roberto@familiasanchez.net&gt; [2005-05-31 10:45]:
&gt; &gt; Package: mutt
&gt; &gt; Version: 1.5.9-2
&gt; &gt; Severity: important
&gt; &gt; 
&gt; &gt; I am only making this important becuase after discussing it on
&gt; &gt; #debian-devel, the consensus was the this was annoying but not RC.  I am
&gt; &gt; CC&#39;ing Nico and Elimar since this also applies to the unnofficial
&gt; &gt; mutt-ng pacakges.  mutt creates temporary files in a very predictable
&gt; &gt; and unsecure way.  There is no threat of overwriting an existing file or
&gt; &gt; creating a file somewhere where the user lacks appropriate permissions,
&gt; &gt; but there is a trivial way to DoS the users in mutt.
&gt; &gt; 
&gt; &gt; Steps to replicate:
&gt; &gt; 
&gt; &gt; Log into a shared machine and run &#39;ps aux|grep mutt&#39;.  Choose a user
&gt; &gt; running mutt.  Note the pid of the mutt process you want to DOS.  Note
&gt; &gt; the username and run &#39;id &lt;user&gt;&#39; to get the uid.  Then run &#39;for i in
&gt; &gt; `seq 0 1000` ; do touch /tmp/mutt-&lt;hostname&gt;-&lt;uid&gt;-&lt;pid&gt;-$i ; done&#39; and
&gt; &gt; watch the user not be able to 1) compose mail, 2) change mailboxes, 3)
&gt; &gt; reply to mail, 4) or view help until mutt is restarted.  For added fun,
&gt; &gt; wrap in another for loop that iterates from 0 to 32767 and hit all the
&gt; &gt; PIDs and prevent the user from using mutt unil /tmp is cleaned or the
&gt; &gt; machine is rebooted.
&gt; 
&gt; I fixed this bug for mutt-ng.
&gt; I attached a 64 bit hex string to the temporary file name.
&gt; In my opinion the TMPDIR solution is not very good.
&gt; Please CC me.
&gt; Index: trunk/muttlib.c
&gt; ===================================================================
&gt; --- trunk/muttlib.c     (Revision 306)
&gt; +++ trunk/muttlib.c     (Revision 308)
&gt; @@ -647,8 +647,10 @@
&gt;  
&gt;  void _mutt_mktemp (char *s, const char *src, int line)
&gt;  {
&gt; -  snprintf (s, _POSIX_PATH_MAX, &quot;%s/muttng-%s-%d-%d-%d&quot;, NONULL (Tempdir),
&gt; -            NONULL (Hostname), (int) getuid (), (int) getpid (), Counter++);
&gt; +
&gt; +  snprintf (s, _POSIX_PATH_MAX, &quot;%s/muttng-%s-%d-%d-%d-%x%x&quot;, NONULL (Tempdir),
&gt; +            NONULL (Hostname), (int) getuid (), (int) getpid (), Counter++, 
&gt; +            (unsigned int) rand(), (unsigned int) rand());
&gt; Regards Nico Golde
&gt; 

Thanks.  Another possible solution is the use of the tmpfile(3) or
mkstemp(3) functions.  But yours appears sound as well.

-Roberto

-- 
Roberto C. Sanchez
<a href="http://familiasanchez.net/~sanchezr">http://familiasanchez.net/~sanchezr</a>
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=67">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="68"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=69">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=69">mbox</a>, <a href="#68">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="70"></a>
<strong>Acknowledgement sent</strong> to <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=71">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=71">mbox</a>, <a href="#70">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="73"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=74">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=74">mbox</a>, <a href="#73">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="75"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nico@ngolde.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=76">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=76">mbox</a>, <a href="#75">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="77"></a><a name="msg77"></a><a href="#77">Message #77</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=77">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=77">mbox</a>, <a href="mailto:311296@bugs.debian.org?References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531142208.GA7360%40ngolde.de%3E%20%3C20050531145834.GA3836%40chistera.yi.org%3E%0A%20%3C20050531200751.GA8854%40ngolde.de%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3C20050531200751.GA8854%40ngolde.de%3E&amp;body=On%20Tue%2C%2031%20May%202005%2022%3A07%3A51%20%2B0200%20Nico%20Golde%20%3Cnico%40ngolde.de%3E%20wrote%3A%0A%3E%20Hallo%20Adeodato%2C%0A%3E%20%0A%3E%20%2A%20Adeodato%20Sim%C3%B3%20%3Casp16%40alu.ua.es%3E%20%5B2005-05-31%2022%3A05%5D%3A%0A%3E%20%3E%20Hello%20Nico%2C%20could%20you%20please%20avoid%20CC%27ing%20submit%40bugs.debian.org%20on%0A%3E%20%3E%20your%20mails.%20PTS%20subscribers%20get%20duplicated%20e-mails.%0A%3E%20%0A%3E%20oh%20sorry...%0A%3E%20thanks%0A%3E%20nico%0A%3E%20--%20%0A%3E%20Nico%20Golde%20-%20310777820%40ICQ%20%7C%20GPG%3A%201024D%2F73647CFF%0A%3E%20http%3A%2F%2Fwww.ngolde.de%20%7C%20http%3A%2F%2Fwww.muttng.org%20%7C%20http%3A%2F%2Fgrml.org%20%0A%3E%20VIM%20has%20two%20modes%20-%20the%20one%20in%20which%20it%20beeps%20%0A%3E%20and%20the%20one%20in%20which%20it%20doesn%27t%20--%20encrypted%20mail%20preferred%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nico%40ngolde.de" alt="">
<div class="header"><span class="headerfield">From:</span> Nico Golde &lt;nico@ngolde.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> 311296@bugs.debian.org, Adeodato Simó &lt;asp16@alu.ua.es&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 22:07:51 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=77">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hallo Adeodato,

* Adeodato Simó &lt;asp16@alu.ua.es&gt; [2005-05-31 22:05]:
&gt; Hello Nico, could you please avoid CC&#39;ing submit@bugs.debian.org on
&gt; your mails. PTS subscribers get duplicated e-mails.

oh sorry...
thanks
nico
-- 
Nico Golde - 310777820@ICQ | GPG: 1024D/73647CFF
<a href="http://www.ngolde.de">http://www.ngolde.de</a> | <a href="http://www.muttng.org">http://www.muttng.org</a> | <a href="http://grml.org">http://grml.org</a> 
VIM has two modes - the one in which it beeps 
and the one in which it doesn&#39;t -- encrypted mail preferred
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=77">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="78"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=79">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=79">mbox</a>, <a href="#78">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="80"></a>
<strong>Acknowledgement sent</strong> to <code>Nico Golde &lt;nico@ngolde.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=81">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=81">mbox</a>, <a href="#80">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="82"></a><a name="msg82"></a><a href="#82">Message #82</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=82">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=82">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Tue%2C%2031%20May%202005%2023%3A13%3A00%20%2B0200%20Nico%20Golde%20%3Cnico%40ngolde.de%3E%20wrote%3A%0A%3E%20Hi%2C%0A%3E%20it%20seems%20like%20mutt%20doesn%27t%20initialize%20the%20rand%20like%20mutt-ng%0A%3E%20does%20so%20this%20would%20be%20the%20right%3A%0A%3E%20%0A%3E%20---%20mutt-1.5.8%2Fmuttlib.c%20%20%20%20%20%20%20%202005-02-12%2020%3A30%3A16.000000000%20%2B0100%0A%3E%20%2B%2B%2B%20muttlib.c%20%20%202005-05-31%2023%3A06%3A15.000000000%20%2B0200%0A%3E%20%40%40%20-668%2C7%20%2B668%2C10%20%40%40%0A%3E%20%0A%3E%20%20void%20_mutt_mktemp%20%28char%20%2As%2C%20const%20char%20%2Asrc%2C%20int%20line%29%0A%3E%20%20%7B%0A%3E%20-%20%20snprintf%20%28s%2C%20_POSIX_PATH_MAX%2C%20%22%25s%2Fmutt-%25s-%25d-%25d-%25d%22%2C%20NONULL%20%28Tempdir%29%2C%20NONULL%28Hostname%29%0A%3E%20%2C%20%28int%29%20getuid%28%29%2C%20%28int%29%20getpid%20%28%29%2C%20Counter%2B%2B%29%3B%0A%3E%20%2B%20long%20sek%3B%0A%3E%20%2B%20time%28%26sek%29%3B%0A%3E%20%2B%20srand%28sek%29%3B%0A%3E%20%2B%20%20snprintf%20%28s%2C%20_POSIX_PATH_MAX%2C%20%22%25s%2Fmutt-%25s-%25d-%25d-%25d%25x%25x%22%2C%20NONULL%20%28Tempdir%29%2C%20NONULL%28Hostn%0A%3E%20ame%29%2C%20%28int%29%20getuid%28%29%2C%20%28int%29%20getpid%20%28%29%2C%20Counter%2B%2B%2C%20%28unsigned%20int%29%20rand%28%29%2C%20%28unsigned%20int%29%20ra%0A%3E%20nd%28%29%29%3B%0A%3E%20%20%20%20dprint%20%281%2C%20%28debugfile%2C%20%22%25s%3A%25d%3A%20mutt_mktemp%20returns%20%5C%22%25s%5C%22.%5Cn%22%2C%20src%2C%20line%2C%20s%29%29%3B%0A%3E%20%20%20%20unlink%20%28s%29%3B%0A%3E%20%20%7D%0A%3E%20%0A%3E%20Regards%20Nico%0A%3E%20--%20%0A%3E%20Nico%20Golde%20-%20310777820%40ICQ%20%7C%20GPG%3A%201024D%2F73647CFF%0A%3E%20http%3A%2F%2Fwww.ngolde.de%20%7C%20http%3A%2F%2Fwww.muttng.org%20%7C%20http%3A%2F%2Fgrml.org%20%0A%3E%20VIM%20has%20two%20modes%20-%20the%20one%20in%20which%20it%20beeps%20%0A%3E%20and%20the%20one%20in%20which%20it%20doesn%27t%20--%20encrypted%20mail%20preferred%0A&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531142208.GA7360%40ngolde.de%3E%20%3C20050531145834.GA3836%40chistera.yi.org%3E%0A%20%3C20050531211300.GB21946%40ngolde.de%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;In-Reply-To=%3C20050531211300.GB21946%40ngolde.de%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=nico%40ngolde.de" alt="">
<div class="header"><span class="headerfield">From:</span> Nico Golde &lt;nico@ngolde.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 31 May 2005 23:13:00 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=82">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hi,
it seems like mutt doesn&#39;t initialize the rand like mutt-ng
does so this would be the right:

--- mutt-1.5.8/muttlib.c        2005-02-12 20:30:16.000000000 +0100
+++ muttlib.c   2005-05-31 23:06:15.000000000 +0200
@@ -668,7 +668,10 @@

 void _mutt_mktemp (char *s, const char *src, int line)
 {
-  snprintf (s, _POSIX_PATH_MAX, &quot;%s/mutt-%s-%d-%d-%d&quot;, NONULL (Tempdir), NONULL(Hostname)
, (int) getuid(), (int) getpid (), Counter++);
+ long sek;
+ time(&amp;sek);
+ srand(sek);
+  snprintf (s, _POSIX_PATH_MAX, &quot;%s/mutt-%s-%d-%d-%d%x%x&quot;, NONULL (Tempdir), NONULL(Hostn
ame), (int) getuid(), (int) getpid (), Counter++, (unsigned int) rand(), (unsigned int) ra
nd());
   dprint (1, (debugfile, &quot;%s:%d: mutt_mktemp returns \&quot;%s\&quot;.\n&quot;, src, line, s));
   unlink (s);
 }

Regards Nico
-- 
Nico Golde - 310777820@ICQ | GPG: 1024D/73647CFF
<a href="http://www.ngolde.de">http://www.ngolde.de</a> | <a href="http://www.muttng.org">http://www.muttng.org</a> | <a href="http://grml.org">http://grml.org</a> 
VIM has two modes - the one in which it beeps 
and the one in which it doesn&#39;t -- encrypted mail preferred
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;msg=82">Message part 2</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="83"></a>
<strong>Tags added: patch</strong>
Request was from <code>Joey Hess &lt;joeyh@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=311296;msg=84">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=84">mbox</a>, <a href="#83">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="85"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Marco d'Itri &lt;md@linux.it&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=86">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=86">mbox</a>, <a href="#85">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="87"></a>
<strong>Acknowledgement sent</strong> to <code>Joey Hess &lt;joeyh@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Marco d'Itri &lt;md@linux.it&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=88">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=88">mbox</a>, <a href="#87">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="89"></a><a name="msg89"></a><a href="#89">Message #89</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=89">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=89">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3C20050722141120.GA29910%40kitenet.net%3E&amp;subject=Re%3A%20CVE%20assignment&amp;References=%3C20050722141120.GA29910%40kitenet.net%3E&amp;body=On%20Fri%2C%2022%20Jul%202005%2010%3A11%3A20%20-0400%20Joey%20Hess%20%3Cjoeyh%40debian.org%3E%20wrote%3A%0A%3E%20This%20bug%20has%20been%20assigned%20CVE%20id%20Use%20CAN-2005-2351%2C%20so%20please%20mention%0A%3E%20it%20in%20the%20changelog%20when%20fixing%20it.%0A%3E%20%0A%3E%20--%20%0A%3E%20see%20shy%20jo%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=joeyh%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Joey Hess &lt;joeyh@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> CVE assignment</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 22 Jul 2005 10:11:20 -0400</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=311296;msg=89">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">This bug has been assigned CVE id Use CAN-2005-2351, so please mention
it in the changelog when fixing it.

-- 
see shy jo
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=311296;filename=signature.asc;msg=89">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="90"></a>
<strong>Tags added: security</strong>
Request was from <code>micah@riseup.net (micah)</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=311296;msg=91">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=91">mbox</a>, <a href="#90">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="92"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Adeodato Simó &lt;dato@net.com.org.es&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=93">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=93">mbox</a>, <a href="#92">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="94"></a>
<strong>Acknowledgement sent</strong> to <code>&quot;Pascal A. Dupuis&quot; &lt;Pascal.Dupuis@esat.kuleuven.be&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Adeodato Simó &lt;dato@net.com.org.es&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=95">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=95">mbox</a>, <a href="#94">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="96"></a><a name="msg96"></a><a href="#96">Message #96</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=96">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=96">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3C20060405135523.9821.62719.reportbug%40localhost.%3E&amp;References=%3C20060405135523.9821.62719.reportbug%40localhost.%3E&amp;subject=Re%3A%20mutt%3A%20Bug%20still%20present%20if%20using%20nametemplate&amp;body=On%20Wed%2C%2005%20Apr%202006%2015%3A55%3A23%20%2B0200%20%22Pascal%20A.%20Dupuis%22%20%3CPascal.Dupuis%40esat.kuleuven.be%3E%20wrote%3A%0A%3E%20Package%3A%20mutt%0A%3E%20Version%3A%201.5.11%2Bcvs20060330-1%0A%3E%20Followup-For%3A%20Bug%20%23311296%0A%3E%20%0A%3E%20Hello%2C%0A%3E%20%0A%3E%20While%20trying%20to%20debug%20another%20problem%20with%20galeon%2C%20I%20found%20that%20the%0A%3E%20bug%20is%20still%20present%20when%20using%20this%20kind%20of%20entry%20in%20the%20.mailcap%3A%0A%3E%20%0A%3E%20text%2Fhtml%3B%20galeon%20-x%20-w%20%25s%3B%20needsterminal%3B%20%5C%0A%3E%20%20%20test%3Dps%20ax%7Cegrep%20-q%20%22%5B0-9%5D%20%2Agaleon%22%3B%5C%0A%3E%20%20%20nametemplate%3D%20%25s.html%0A%3E%20%0A%3E%20In%20this%20case%2C%20the%20temporary%20file%20is%20still%20mutt.html%2C%20and%20not%20%0A%3E%20%3Csomething-random%3E.html.%20Commenting%20the%20%22nametemplate%22%20option%2C%20the%20name%20is%20%0A%3E%20correctly%20randomised.%20CAN-2005-2351%20is%20still%20not%20entirelly%20solved...%0A%3E%20%0A%3E%20Best%20regards%0A%3E%20%0A%3E%20Pascal%20Dupuis%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%20testing%2Funstable%0A%3E%20%20%20APT%20prefers%20testing%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27testing%27%29%2C%20%28500%2C%20%27stable%27%29%0A%3E%20Architecture%3A%20i386%20%28i686%29%0A%3E%20Shell%3A%20%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fbash%0A%3E%20Kernel%3A%20Linux%202.6.16.1%0A%3E%20Locale%3A%20LANG%3Dfr_BE.UTF-8%2C%20LC_CTYPE%3Dfr_BE.UTF-8%20%28charmap%3DUTF-8%29%0A%3E%20%0A%3E%20Versions%20of%20packages%20mutt%20depends%20on%3A%0A%3E%20ii%20%20libc6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.3.6-4%20%20%20%20%20%20%20GNU%20C%20Library%3A%20Shared%20libraries%20an%0A%3E%20ii%20%20libdb4.4%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204.4.20-4%20%20%20%20%20%20Berkeley%20v4.4%20Database%20Libraries%20%5B%0A%3E%20ii%20%20libgnutls12%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.2.9-2%20%20%20%20%20%20%20the%20GNU%20TLS%20library%20-%20runtime%20libr%0A%3E%20ii%20%20libidn11%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200.5.18-2%20%20%20%20%20%20GNU%20libidn%20library%2C%20implementation%0A%3E%20ii%20%20libncursesw5%20%20%20%20%20%20%20%20%20%20%20%20%20%20%205.5-1%20%20%20%20%20%20%20%20%20Shared%20libraries%20for%20terminal%20hand%0A%3E%20ii%20%20libsasl2%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.1.19-1.9%2Bb1%20Authentication%20abstraction%20library%0A%3E%20ii%20%20postfix%20%5Bmail-transport-ag%202.2.9-1%2Bb1%20%20%20%20A%20high-performance%20mail%20transport%20%0A%3E%20%0A%3E%20Versions%20of%20packages%20mutt%20recommends%3A%0A%3E%20ii%20%20locales%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.3.6-4%20%20%20%20GNU%20C%20Library%3A%20National%20Language%20%28%0A%3E%20ii%20%20mime-support%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203.36-1%20%20%20%20%20MIME%20files%20%27mime.types%27%20%26%20%27mailcap%0A%3E%20%0A%3E%20--%20no%20debconf%20information%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=Pascal.Dupuis%40esat.kuleuven.be" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Pascal A. Dupuis&quot; &lt;Pascal.Dupuis@esat.kuleuven.be&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;311296@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> mutt: Bug still present if using nametemplate</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 05 Apr 2006 15:55:23 +0200</div>
</div>
<pre class="message">Package: mutt
Version: 1.5.11+cvs20060330-1
Followup-For: Bug #311296

Hello,

While trying to debug another problem with galeon, I found that the
bug is still present when using this kind of entry in the .mailcap:

text/html; galeon -x -w %s; needsterminal; \
  test=ps ax|egrep -q &quot;[0-9] *galeon&quot;;\
  nametemplate= %s.html

In this case, the temporary file is still mutt.html, and not 
&lt;something-random&gt;.html. Commenting the &quot;nametemplate&quot; option, the name is 
correctly randomised. CAN-2005-2351 is still not entirelly solved...

Best regards

Pascal Dupuis

-- System Information:
Debian Release: testing/unstable
  APT prefers testing
  APT policy: (500, &#39;testing&#39;), (500, &#39;stable&#39;)
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.16.1
Locale: LANG=fr_BE.UTF-8, LC_CTYPE=fr_BE.UTF-8 (charmap=UTF-8)

Versions of packages mutt depends on:
ii  libc6                      2.3.6-4       GNU C Library: Shared libraries an
ii  libdb4.4                   4.4.20-4      Berkeley v4.4 Database Libraries [
ii  libgnutls12                1.2.9-2       the GNU TLS library - runtime libr
ii  libidn11                   0.5.18-2      GNU libidn library, implementation
ii  libncursesw5               5.5-1         Shared libraries for terminal hand
ii  libsasl2                   2.1.19-1.9+b1 Authentication abstraction library
ii  postfix [mail-transport-ag 2.2.9-1+b1    A high-performance mail transport 

Versions of packages mutt recommends:
ii  locales                       2.3.6-4    GNU C Library: National Language (
ii  mime-support                  3.36-1     MIME files &#39;mime.types&#39; &amp; &#39;mailcap

-- no debconf information


</pre>

<div class="infmessage"><hr><p>
<a name="97"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Adeodato Simó &lt;dato@net.com.org.es&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=98">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=98">mbox</a>, <a href="#97">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="99"></a>
<strong>Acknowledgement sent</strong> to <code>Michelle Konzack &lt;linux4michelle@freenet.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Adeodato Simó &lt;dato@net.com.org.es&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=100">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=100">mbox</a>, <a href="#99">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="101"></a><a name="msg101"></a><a href="#101">Message #101</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=101">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=101">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3CiBY3aD.A.zeC.Y5qNEB%40mobilix.private%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E%20%3C20050531032440.GE18799%40miami.familiasanchez.net%3E%20%3C20050531035411.GA8897%40zwitterion.humbug.org.au%3E%0A%20%3CiBY3aD.A.zeC.Y5qNEB%40mobilix.private%3E&amp;body=On%20Thu%2C%2006%20Apr%202006%2020%3A38%3A08%20%2B0200%20Michelle%20Konzack%20%3Clinux4michelle%40freenet.de%3E%20wrote%3A%0A%3E%20Am%202005-05-31%2013%3A54%3A11%2C%20schrieb%20Mark%20Suter%3A%0A%3E%20%0A%3E%20%3E%20The%20flip-side%20of%20%282%29%20is%20that%20the%20user%20avoids%20this%20class%20of%20problem%20for%0A%3E%20%3E%20many%20different%20packages%2C%20present%20and%20future.%20%20Setting%20TMPDIR%20is%20a%20good%0A%3E%20%3E%20solution%20for%20the%20user%20-%20all%20software%20honouring%20this%20variable%20will%20nwo%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ssh-agent%20does%20not%20%20%3A-%28%0A%3E%20%0A%3E%20I%20set%20TMPDIR%2C%20TEMPDIR%2C%20TMP%20and%20TEMP%20from%20%2Fetc%2Fprofile%20to%20%22%2Ftmp%2F%24USER%22%0A%3E%20%0A%3E%20Greetings%0A%3E%20%20%20%20%20Michelle%20Konzack%0A%3E%20%0A%3E%20%0A%3E%20--%20%0A%3E%20Linux-User%20%23280138%20with%20the%20Linux%20Counter%2C%20http%3A%2F%2Fcounter.li.org%2F%0A%3E%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20Debian%20GNU%2FLinux%20Consultant%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%3E%20Michelle%20Konzack%20%20%20Apt.%20917%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ICQ%20%23328449886%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2050%2C%20rue%20de%20Soultz%20%20%20%20%20%20%20%20%20MSM%20LinuxMichi%0A%3E%200033%2F3%2F88452356%20%20%20%2067100%20Strasbourg%2FFrance%20%20%20IRC%20%23Debian%20%28irc.icq.com%29%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=linux4michelle%40freenet.de" alt="">
<div class="header"><span class="headerfield">From:</span> Michelle Konzack &lt;linux4michelle@freenet.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 06 Apr 2006 20:38:08 +0200</div>
</div>
<pre class="message">Am 2005-05-31 13:54:11, schrieb Mark Suter:

&gt; The flip-side of (2) is that the user avoids this class of problem for
&gt; many different packages, present and future.  Setting TMPDIR is a good
&gt; solution for the user - all software honouring this variable will nwo
                          ^^^^^^^^^^^^
                      ssh-agent does not  :-(

I set TMPDIR, TEMPDIR, TMP and TEMP from /etc/profile to &quot;/tmp/$USER&quot;

Greetings
    Michelle Konzack


-- 
Linux-User #280138 with the Linux Counter, <a href="http://counter.li.org/">http://counter.li.org/</a>
##################### Debian GNU/Linux Consultant #####################
Michelle Konzack   Apt. 917                  ICQ #328449886
                   50, rue de Soultz         MSM LinuxMichi
0033/3/88452356    67100 Strasbourg/France   IRC #Debian (irc.icq.com)



</pre>

<div class="infmessage"><hr><p>
<a name="102"></a>
<strong>Information forwarded</strong> to <code>debian-bugs-dist@lists.debian.org, Adeodato Simó &lt;dato@net.com.org.es&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
(<a href="bugreport.cgi?bug=311296;msg=103">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=103">mbox</a>, <a href="#102">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="104"></a>
<strong>Acknowledgement sent</strong> to <code>Michelle Konzack &lt;linux4michelle@freenet.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Adeodato Simó &lt;dato@net.com.org.es&gt;</code>.
(<a href="bugreport.cgi?bug=311296;msg=105">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=105">mbox</a>, <a href="#104">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="106"></a><a name="msg106"></a><a href="#106">Message #106</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=106">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=106">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3CiBY3aD.A.ij.cZQQEB%40mobilix.private%3E&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%20%3C20050531030545.GF10701%40zwitterion.humbug.org.au%3E%20%3C20050531032440.GE18799%40miami.familiasanchez.net%3E%20%3C20050531035411.GA8897%40zwitterion.humbug.org.au%3E%0A%20%3CiBY3aD.A.ij.cZQQEB%40mobilix.private%3E&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;body=On%20Thu%2C%2006%20Apr%202006%2020%3A38%3A08%20%2B0200%20Michelle%20Konzack%20%3Clinux4michelle%40freenet.de%3E%20wrote%3A%0A%3E%20Am%202005-05-31%2013%3A54%3A11%2C%20schrieb%20Mark%20Suter%3A%0A%3E%20%0A%3E%20%3E%20The%20flip-side%20of%20%282%29%20is%20that%20the%20user%20avoids%20this%20class%20of%20problem%20for%0A%3E%20%3E%20many%20different%20packages%2C%20present%20and%20future.%20%20Setting%20TMPDIR%20is%20a%20good%0A%3E%20%3E%20solution%20for%20the%20user%20-%20all%20software%20honouring%20this%20variable%20will%20nwo%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ssh-agent%20does%20not%20%20%3A-%28%0A%3E%20%0A%3E%20I%20set%20TMPDIR%2C%20TEMPDIR%2C%20TMP%20and%20TEMP%20from%20%2Fetc%2Fprofile%20to%20%22%2Ftmp%2F%24USER%22%0A%3E%20%0A%3E%20Greetings%0A%3E%20%20%20%20%20Michelle%20Konzack%0A%3E%20%0A%3E%20%0A%3E%20--%20%0A%3E%20Linux-User%20%23280138%20with%20the%20Linux%20Counter%2C%20http%3A%2F%2Fcounter.li.org%2F%0A%3E%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20Debian%20GNU%2FLinux%20Consultant%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%3E%20Michelle%20Konzack%20%20%20Apt.%20917%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ICQ%20%23328449886%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2050%2C%20rue%20de%20Soultz%20%20%20%20%20%20%20%20%20MSM%20LinuxMichi%0A%3E%200033%2F3%2F88452356%20%20%20%2067100%20Strasbourg%2FFrance%20%20%20IRC%20%23Debian%20%28irc.icq.com%29%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=linux4michelle%40freenet.de" alt="">
<div class="header"><span class="headerfield">From:</span> Michelle Konzack &lt;linux4michelle@freenet.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> Mark Suter &lt;suter@zwitterion.humbug.org.au&gt;, 311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 06 Apr 2006 20:38:08 +0200</div>
</div>
<pre class="message">Am 2005-05-31 13:54:11, schrieb Mark Suter:

&gt; The flip-side of (2) is that the user avoids this class of problem for
&gt; many different packages, present and future.  Setting TMPDIR is a good
&gt; solution for the user - all software honouring this variable will nwo
                          ^^^^^^^^^^^^
                      ssh-agent does not  :-(

I set TMPDIR, TEMPDIR, TMP and TEMP from /etc/profile to &quot;/tmp/$USER&quot;

Greetings
    Michelle Konzack


-- 
Linux-User #280138 with the Linux Counter, <a href="http://counter.li.org/">http://counter.li.org/</a>
##################### Debian GNU/Linux Consultant #####################
Michelle Konzack   Apt. 917                  ICQ #328449886
                   50, rue de Soultz         MSM LinuxMichi
0033/3/88452356    67100 Strasbourg/France   IRC #Debian (irc.icq.com)



</pre>

<div class="msgreceived"><hr><p>
<a name="107"></a>
<strong>Changed Bug submitter from &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt; to &quot;Roberto C. Sanchez&quot; &lt;roberto@connexer.com&gt;.</strong>
Request was from <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@connexer.com&gt;</code>
to <code>control@bugs.debian.org</code>. 
(<a href="bugreport.cgi?bug=311296;msg=108">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=108">mbox</a>, <a href="#107">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="109"></a>
<!-- time:1178463784 -->
<strong>Changed Bug title to mutt: less random temp file creation allows DOS from mutt: Temporary file creation is unsafe.</strong>
Request was from <code>Justin Pryzby &lt;justinpryzby@users.sourceforge.net&gt;</code>
to <code>control@bugs.debian.org</code>. 
 (Sun, 06 May 2007 15:03:04 GMT) (<a href="bugreport.cgi?bug=311296;msg=110">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=110">mbox</a>, <a href="#109">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="111"></a>
<!-- time:1232920085 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Christoph Berg &lt;myon@debian.org&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
 (Sun, 25 Jan 2009 21:48:05 GMT) (<a href="bugreport.cgi?bug=311296;msg=112">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=112">mbox</a>, <a href="#111">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="113"></a>
<!-- time:1232920085 -->
<strong>Acknowledgement sent</strong>
to <code>antonio@dyne.org</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Christoph Berg &lt;myon@debian.org&gt;</code>.
 (Sun, 25 Jan 2009 21:48:05 GMT) (<a href="bugreport.cgi?bug=311296;msg=114">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=114">mbox</a>, <a href="#113">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="115"></a><a name="msg115"></a><a href="#115">Message #115</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=115">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=115">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Sun%2C%2025%20Jan%202009%2021%3A45%3A52%20%2B0000%20Antonio%20Radici%20%3Cantonio%40dyne.org%3E%20wrote%3A%0A%3E%20tag%20311296%20%2Bupstream%0A%3E%20forwarded%20311296%20http%3A%2F%2Fbugs.mutt.org%2F3158%0A%3E%20severity%20311296%20normal%0A%3E%20thanks%0A%3E%20%0A%3E%20Surprisingly%20the%20problem%20is%20still%20there.%0A%3E%20I%27ve%20forwarded%20the%20problem%20upstream.%0A%3E%20%0A%3E%20Cheers%0A%3E%20Antonio%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20mutt%3A%20less%20random%20temp%20file%20creation%20allows%20DOS&amp;References=%3C497CDD90.2050907%40dyne.org%3E&amp;In-Reply-To=%3C497CDD90.2050907%40dyne.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=antonio%40dyne.org" alt="">
<div class="header"><span class="headerfield">From:</span> Antonio Radici &lt;antonio@dyne.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 311296@bugs.debian.org, control@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> mutt: less random temp file creation allows DOS</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 25 Jan 2009 21:45:52 +0000</div>
</div>
<pre class="message flowed">tag 311296 +upstream
forwarded 311296 <a href="http://bugs.mutt.org/3158">http://bugs.mutt.org/3158</a>
severity 311296 normal
thanks

Surprisingly the problem is still there.
I&#39;ve forwarded the problem upstream.

Cheers
Antonio



</pre>

<div class="msgreceived"><hr><p>
<a name="116"></a>
<!-- time:1232920087 -->
<strong>Tags added: upstream</strong>
Request was from <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 25 Jan 2009 21:48:07 GMT) (<a href="bugreport.cgi?bug=311296;msg=117">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=117">mbox</a>, <a href="#116">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="118"></a>
<!-- time:1232920087 -->
<strong>Noted your statement that Bug has been forwarded to <a href="http://bugs.mutt.org/3158">http://bugs.mutt.org/3158</a>.</strong>
Request was from <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 25 Jan 2009 21:48:07 GMT) (<a href="bugreport.cgi?bug=311296;msg=119">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=119">mbox</a>, <a href="#118">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="120"></a>
<!-- time:1232920088 -->
<strong>Severity set to `normal&#39; from `minor&#39;</strong>
Request was from <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 25 Jan 2009 21:48:08 GMT) (<a href="bugreport.cgi?bug=311296;msg=121">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=121">mbox</a>, <a href="#120">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="122"></a>
<!-- time:1232920092 -->
<strong>Bug marked as found in version 1.5.19-1.</strong>
Request was from <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 25 Jan 2009 21:48:12 GMT) (<a href="bugreport.cgi?bug=311296;msg=123">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=123">mbox</a>, <a href="#122">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="124"></a>
<!-- time:1245448982 -->
<strong>Tags added: pending</strong>
Request was from <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Fri, 19 Jun 2009 22:03:02 GMT) (<a href="bugreport.cgi?bug=311296;msg=125">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=125">mbox</a>, <a href="#124">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="126"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Christoph Berg &lt;myon@debian.org&gt; -->
<!-- time:1265570823 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Christoph Berg &lt;myon@debian.org&gt;</code>:<br>
<code>Bug#311296</code>; Package <code>mutt</code>.
 (Sun, 07 Feb 2010 19:27:03 GMT) (<a href="bugreport.cgi?bug=311296;msg=127">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=127">mbox</a>, <a href="#126">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="128"></a>
<!-- request_addr: Antonio Radici &lt;antonio@dyne.org&gt; -->
<!-- time:1265570823 -->
<strong>Acknowledgement sent</strong>
to <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Christoph Berg &lt;myon@debian.org&gt;</code>.
 (Sun, 07 Feb 2010 19:27:03 GMT) (<a href="bugreport.cgi?bug=311296;msg=129">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=129">mbox</a>, <a href="#128">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="130"></a><a name="msg130"></a><a href="#130">Message #130</a> received at 311296@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=130">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=130">mbox</a>, <a href="mailto:311296@bugs.debian.org?body=On%20Sun%2C%207%20Feb%202010%2019%3A23%3A32%20%2B0000%20Antonio%20Radici%20%3Cantonio%40dyne.org%3E%20wrote%3A%0A%3E%20Hi%2C%0A%3E%20this%20is%20fixed%20in%20our%20internal%20git%20repo%20with%20the%20patch%20written%20by%20Nico%20Golde%2C%0A%3E%20I%27ve%20also%20forwarded%20the%20patch%20upstream.%0A%3E%20%0A%3E%20The%20next%20Debian%20version%20of%20mutt%20will%20include%20this%20patch%0A%3E%20%0A%3E%20Cheers%0A%3E%20Antonio%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23311296%3A%20mutt%3A%20Temporary%20file%20creation%20is%20unsafe&amp;References=%3CE1DcpSi-0004t8-TQ%40miami.familiasanchez.net%3E%0A%20%3C20100207192331.GA12127%40debian%3E&amp;In-Reply-To=%3C20100207192331.GA12127%40debian%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=antonio%40dyne.org" alt="">
<div class="header"><span class="headerfield">From:</span> Antonio Radici &lt;antonio@dyne.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Roberto C. Sanchez&quot; &lt;roberto@familiasanchez.net&gt;,
	311296@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> nico@ngolde.de</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#311296: mutt: Temporary file creation is unsafe</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 7 Feb 2010 19:23:32 +0000</div>
</div>
<pre class="message">Hi,
this is fixed in our internal git repo with the patch written by Nico Golde,
I&#39;ve also forwarded the patch upstream.

The next Debian version of mutt will include this patch

Cheers
Antonio



</pre>

<div class="msgreceived"><hr><p>
<a name="131"></a>
<!-- request_addr: Antonio Radici &lt;antonio@dyne.org&gt; -->
<!-- time:1265592065 -->
<strong>Reply sent</strong>
to <code>Antonio Radici &lt;antonio@dyne.org&gt;</code>:<br>
You have taken responsibility.
 (Mon, 08 Feb 2010 01:21:05 GMT) (<a href="bugreport.cgi?bug=311296;msg=132">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=132">mbox</a>, <a href="#131">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="133"></a>
<!-- request_addr: &quot;Roberto C. Sanchez&quot; &lt;roberto@connexer.com&gt; -->
<!-- time:1265592065 -->
<strong>Notification sent</strong>
to <code>&quot;Roberto C. Sanchez&quot; &lt;roberto@connexer.com&gt;</code>:<br>
Bug acknowledged by developer.
 (Mon, 08 Feb 2010 01:21:05 GMT) (<a href="bugreport.cgi?bug=311296;msg=134">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=134">mbox</a>, <a href="#133">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="135"></a><a name="msg135"></a><a href="#135">Message #135</a> received at 311296-close@bugs.debian.org (<a href="bugreport.cgi?bug=311296;msg=135">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=135">mbox</a>, <a href="mailto:311296@bugs.debian.org?In-Reply-To=%3CE1NeIGB-000162-GV%40ries.debian.org%3E&amp;References=%3CE1NeIGB-000162-GV%40ries.debian.org%3E&amp;subject=Re%3A%20Bug%23311296%3A%20fixed%20in%20mutt%201.5.20-7&amp;body=On%20Mon%2C%2008%20Feb%202010%2001%3A17%3A55%20%2B0000%20Antonio%20Radici%20%3Cantonio%40dyne.org%3E%20wrote%3A%0A%3E%20Source%3A%20mutt%0A%3E%20Source-Version%3A%201.5.20-7%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20mutt%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive%3A%0A%3E%20%0A%3E%20mutt-dbg_1.5.20-7_i386.deb%0A%3E%20%20%20to%20main%2Fm%2Fmutt%2Fmutt-dbg_1.5.20-7_i386.deb%0A%3E%20mutt-patched_1.5.20-7_i386.deb%0A%3E%20%20%20to%20main%2Fm%2Fmutt%2Fmutt-patched_1.5.20-7_i386.deb%0A%3E%20mutt_1.5.20-7.diff.gz%0A%3E%20%20%20to%20main%2Fm%2Fmutt%2Fmutt_1.5.20-7.diff.gz%0A%3E%20mutt_1.5.20-7.dsc%0A%3E%20%20%20to%20main%2Fm%2Fmutt%2Fmutt_1.5.20-7.dsc%0A%3E%20mutt_1.5.20-7_i386.deb%0A%3E%20%20%20to%20main%2Fm%2Fmutt%2Fmutt_1.5.20-7_i386.deb%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20311296%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Antonio%20Radici%20%3Cantonio%40dyne.org%3E%20%28supplier%20of%20updated%20mutt%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Mon%2C%2008%20Feb%202010%2000%3A27%3A55%20%2B0000%0A%3E%20Source%3A%20mutt%0A%3E%20Binary%3A%20mutt%20mutt-patched%20mutt-dbg%0A%3E%20Architecture%3A%20source%20i386%0A%3E%20Version%3A%201.5.20-7%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20low%0A%3E%20Maintainer%3A%20Christoph%20Berg%20%3Cmyon%40debian.org%3E%0A%3E%20Changed-By%3A%20Antonio%20Radici%20%3Cantonio%40dyne.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20mutt%20%20%20%20%20%20%20-%20text-based%20mailreader%20supporting%20MIME%2C%20GPG%2C%20PGP%20and%20threading%0A%3E%20%20mutt-dbg%20%20%20-%20debugging%20symbols%20for%20mutt%0A%3E%20%20mutt-patched%20-%20the%20Mutt%20Mail%20User%20Agent%20with%20extra%20patches%0A%3E%20Closes%3A%20228671%20311296%20383769%20528233%20537746%20539276%20545316%20547739%20547980%20548494%20549006%20553238%20553321%20557395%20568295%0A%3E%20Changes%3A%20%0A%3E%20%20mutt%20%281.5.20-7%29%20unstable%3B%20urgency%3Dlow%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20debian%2FNEWS%3A%20backported%20a%20note%20about%20the%20new%20behavior%20with%20attachments%0A%3E%20%20%20%20%20%20on%20the%20command%20line%20%28Closes%3A%20539276%29%0A%3E%20%20%20%20%2A%20debian%2Fpatches%3A%0A%3E%20%20%20%20%20%20%2B%20upstream%2F548494-swedish-intl.patch%3A%20fixes%20to%20Swedish%20translation%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=antonio%40dyne.org" alt="">
<div class="header"><span class="headerfield">From:</span> Antonio Radici &lt;antonio@dyne.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 311296-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#311296: fixed in mutt 1.5.20-7</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 08 Feb 2010 01:17:55 +0000</div>
</div>
<pre class="message">Source: mutt
Source-Version: 1.5.20-7

We believe that the bug you reported is fixed in the latest version of
mutt, which is due to be installed in the Debian FTP archive:

mutt-dbg_1.5.20-7_i386.deb
  to main/m/mutt/mutt-dbg_1.5.20-7_i386.deb
mutt-patched_1.5.20-7_i386.deb
  to main/m/mutt/mutt-patched_1.5.20-7_i386.deb
mutt_1.5.20-7.diff.gz
  to main/m/mutt/mutt_1.5.20-7.diff.gz
mutt_1.5.20-7.dsc
  to main/m/mutt/mutt_1.5.20-7.dsc
mutt_1.5.20-7_i386.deb
  to main/m/mutt/mutt_1.5.20-7_i386.deb



A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 311296@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Antonio Radici &lt;antonio@dyne.org&gt; (supplier of updated mutt package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Mon, 08 Feb 2010 00:27:55 +0000
Source: mutt
Binary: mutt mutt-patched mutt-dbg
Architecture: source i386
Version: 1.5.20-7
Distribution: unstable
Urgency: low
Maintainer: Christoph Berg &lt;myon@debian.org&gt;
Changed-By: Antonio Radici &lt;antonio@dyne.org&gt;
Description: 
 mutt       - text-based mailreader supporting MIME, GPG, PGP and threading
 mutt-dbg   - debugging symbols for mutt
 mutt-patched - the Mutt Mail User Agent with extra patches
Closes: <a href="bugreport.cgi?bug=228671">228671</a> <a href="bugreport.cgi?bug=311296">311296</a> <a href="bugreport.cgi?bug=383769">383769</a> <a href="bugreport.cgi?bug=528233">528233</a> <a href="bugreport.cgi?bug=537746">537746</a> <a href="bugreport.cgi?bug=539276">539276</a> <a href="bugreport.cgi?bug=545316">545316</a> <a href="bugreport.cgi?bug=547739">547739</a> <a href="bugreport.cgi?bug=547980">547980</a> <a href="bugreport.cgi?bug=548494">548494</a> <a href="bugreport.cgi?bug=549006">549006</a> <a href="bugreport.cgi?bug=553238">553238</a> <a href="bugreport.cgi?bug=553321">553321</a> <a href="bugreport.cgi?bug=557395">557395</a> <a href="bugreport.cgi?bug=568295">568295</a>
Changes: 
 mutt (1.5.20-7) unstable; urgency=low
 .
   * debian/NEWS: backported a note about the new behavior with attachments
     on the command line (Closes: <a href="bugreport.cgi?bug=539276">539276</a>)
   * debian/patches:
     + upstream/548494-swedish-intl.patch: fixes to Swedish translation
       (Closes: <a href="bugreport.cgi?bug=548494">548494</a>)
     + upstream/553238-german-intl.patch: small fix to the German translation
       (Closes: <a href="bugreport.cgi?bug=553238">553238</a>)
     + upstream/553321-ansi-escape-segfault.patch: prevent mutt from segfaulting
       with large ASCII escape sequences (Closes: <a href="bugreport.cgi?bug=553321">553321</a>)
     + upstream/557395-muttrc-crypto.patch: small fix to the muttrc man
       (Closes: <a href="bugreport.cgi?bug=557395">557395</a>)
     + upstream/545316-header-color.patch: do not store the color in header cache
       (Closes: <a href="bugreport.cgi?bug=545316">545316</a>)
     + upstream/568295-references.patch: preserve the References header if the
       In-Reply-To is not initially present (Closes: <a href="bugreport.cgi?bug=568295">568295</a>)
     + upstream/547980-smime_keys-chaining.patch: support certificate chaining in
       smime_keys (Closes: <a href="bugreport.cgi?bug=547980">547980</a>, <a href="bugreport.cgi?bug=549006">549006</a>)
     + upstream/528233-readonly-open.patch: open attachments in read-only
       (Closes: <a href="bugreport.cgi?bug=528233">528233</a>)
     + upstream/228671-pipe-mime.patch: don&#39;t mess up the terminal while piping
       attachments (Closes: <a href="bugreport.cgi?bug=228671">228671</a>)
     + upstream/383769-score-match.patch: match full name with ~f, same as
       mutt-ng (Closes: <a href="bugreport.cgi?bug=383769">383769</a>)
     + upstream/547739-manual-typos.patch: typos in manual.txt (Closes: <a href="bugreport.cgi?bug=547739">547739</a>)
     + upstream/311296-rand-mktemp.patch: more random file creation in /tmp, see
       CVE CAN-2005-2351 (Closes: <a href="bugreport.cgi?bug=311296">311296</a>)
     + debian-specific/Muttrc: set time_inc to be 250ms (Closes: <a href="bugreport.cgi?bug=537746">537746</a>)
   * debian/control:
     + bumping Standards-Version to 3.8.4, nothing to be done
     + adding ${misc:Depends} to make lintian happy
   * debian/rules: adding a commented rule to enable tokyocabinet if we want
Checksums-Sha1: 
 4fd90e2b0dd199977631b37f9396710a9f84ad34 1398 mutt_1.5.20-7.dsc
 905d9c2c2172a20ef764f1b7d83b2e2dfc45fe1c 162089 mutt_1.5.20-7.diff.gz
 ba7865ab37da229906a15a057967f316e4c22cf6 2031574 mutt_1.5.20-7_i386.deb
 a69a987f4ba4d770ac09232e3d38e20dbb64ef3e 388024 mutt-patched_1.5.20-7_i386.deb
 25073b1a89f14c34a26c75f9a8383ad90f71319a 1369022 mutt-dbg_1.5.20-7_i386.deb
Checksums-Sha256: 
 73e6e3403bb937264c178cb36a6f97178d33ab9c889a0797288cce920ea0b6d5 1398 mutt_1.5.20-7.dsc
 dd5fe2bb449835eefa342eb0e91acfd66bbcb9f9783a8e3cf5075fcd8ec34898 162089 mutt_1.5.20-7.diff.gz
 6891e911447b480629714e174d697e733454574701a134308d3e09ae3508242d 2031574 mutt_1.5.20-7_i386.deb
 f05f54d8665cf003e12e3f8fe80d7fd297291fc016c62b8a134b74b6e29301dd 388024 mutt-patched_1.5.20-7_i386.deb
 132791480fb1ed9486f3ac13402dfda421a6ef16dfdbaf90a166442db9342d41 1369022 mutt-dbg_1.5.20-7_i386.deb
Files: 
 a8daca02247216d0dbcfefb4f32b0ebf 1398 mail standard mutt_1.5.20-7.dsc
 e56915d38406a91fd72c607340fa5963 162089 mail standard mutt_1.5.20-7.diff.gz
 4061b1e43be3805b9d18333247d808ec 2031574 mail standard mutt_1.5.20-7_i386.deb
 3024edeb3a2db1abc5060b59e7eb9166 388024 mail extra mutt-patched_1.5.20-7_i386.deb
 780c8559d51815bd663df60f8b7dcc9b 1369022 debug extra mutt-dbg_1.5.20-7_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAktvYeYACgkQ6Tq8aae+WrDtXgCgvIHXQrqjrW/GtXOnbkM2C5c4
CcwAnRlZ1foUZgDu2Y9fqF6QhnZrgA2H
=THas
-----END PGP SIGNATURE-----




</pre>

<div class="msgreceived"><hr><p>
<a name="136"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1276414694 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Sun, 13 Jun 2010 07:38:14 GMT) (<a href="bugreport.cgi?bug=311296;msg=137">full text</a>, <a href="bugreport.cgi?bug=311296;mbox=yes;msg=137">mbox</a>, <a href="#136">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=311296">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:22:55 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
