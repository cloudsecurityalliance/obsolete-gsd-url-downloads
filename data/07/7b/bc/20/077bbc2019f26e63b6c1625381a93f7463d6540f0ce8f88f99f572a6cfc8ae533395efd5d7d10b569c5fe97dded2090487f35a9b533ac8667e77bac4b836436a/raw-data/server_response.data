<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>The CybrBlog</title>
<meta name="description" content="CVE 2019-11489 SimplyBook.me Management Portal Privilege Escalation Exploit">
<meta name="keywords" content="Our CVE Disclosures">

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@cybrgrade">
<meta name="twitter:creator" content="@cybrgrade">

<meta property="og:locale" content="en_GB">
<meta property="og:type" content="article">
<meta property="og:title" content="SimplyBook.me Management Portal Privilege Escalation Exploit">
<meta property="og:description" content="CVE 2019-11489 SimplyBook.me Management Portal Privilege Escalation Exploit">
<meta property="og:url" content="/CVE-2019-11489-SimplyBook.me-privesc/">
<meta property="og:site_name" content="The CybrBlog">
<meta property="og:image" content="/images/images/logo.png">
<script src="/cdn-cgi/apps/head/OIDpBFlviuL5YmmPTpx6DNMrVB0.js"></script><link rel="canonical" href="/CVE-2019-11489-SimplyBook.me-privesc/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="The CybrBlog Feed">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="/assets/css/jquery.floating-social-share.min.css">

<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">
<meta http-equiv="cleartype" content="on">

<script type="text/javascript" src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>


<link rel="shortcut icon" href="/favicon.ico">

<link rel="shortcut icon" href="/favicon.png">

<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">

<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png?v=gAdQR6YrpJ">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png?v=gAdQR6YrpJ">
<link rel="icon" type="image/png" sizes="192x192" href="/assets/favicons/android-chrome-192x192.png?v=gAdQR6YrpJ">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png?v=gAdQR6YrpJ">
<link rel="manifest" href="/assets/favicons/site.webmanifest?v=gAdQR6YrpJ">
<link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg?v=gAdQR6YrpJ" color="#a60d0d">
<link rel="shortcut icon" href="/assets/favicons/favicon.ico?v=gAdQR6YrpJ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="/assets/favicons/mstile-144x144.png?v=gAdQR6YrpJ">
<meta name="msapplication-config" content="/assets/favicons/browserconfig.xml?v=gAdQR6YrpJ">
<meta name="theme-color" content="#a60d0d">
<style type="text/css">body {background-image:url(/images/cybrblog-bg-logo.png);}</style>
</head>
<body id="post">
<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<div class="header-menu header-menu-top">
<ul class="header-item-container">
<li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
<li class="header-item-title">
<a href="/">
<img class="logo" src="/images/logo.png" alt="The CybrBlog">
<a href="/" class="title"> The CybrBlog</a>
</a>
</li>
<li class="header-item "><a href="https://cybrgrade.com" target="_blank"><h3>CybrGrade UK Ltd</h3></a></li>
<li class="header-item "><a href="#"><h3>Posts Archive</h3></a>
<ul class="header-submenu">
<li class="sub-item"><a href="/tags/">By Tag</a></li>
<li class="sub-item"><a href="/categories/">By Category</a></li>
</ul>
</li>
<li class="header-item "><a href="/search/"><h3>Search</h3></a></li>
<li class="header-item"><a href="/search"><h3><i class="fa fa-search"></i></h3></a></li>
</ul>
</div>
<div class="entry-header">
<div class="header-title">
<div class="header-title-wrap">
<h1>SimplyBook.me Management Portal Privilege Escalation Exploit</h1>
<h2><span class="entry-date date published updated"><time datetime="2019-04-24T00:00:00+01:00">April 24, 2019</time></span></h2>
<p class="entry-reading-time">
<i class="fa fa-clock-o"></i>
Reading time ~3 minutes
</p>
</div>
</div>
</div>
<nav id="menu" style="display: none">
<ul>
<li><a href="/search/"><h3>Search</h3></a></li>
<li><a href="#"><h3>Posts Archive</h3></a>
<ul>
<li><a href="/tags/">By Tag</a></li>
<li><a href="/categories/">By Category</a></li>
</ul>
</li>
<li><a href="https://cybrgrade.com"><h3>CybrGrade UK Ltd</h3></a></li>
</ul>
</nav>
<a href="https://twitter.com/cybrgrade" class="btn btn-info button-twitter" data-show-count="false" data-size="large"><i class="fa fa-twitter"></i> <span> | Follow @cybrgrade</span></a>
<div id="main" role="main">
<article class="hentry">
<div class="entry-content">
<p><a name="CVE-2019-11489"></a></p>
<h1 id="cve-2019-11489"><a href="#CVE-2019-11489">CVE-2019-11489</a></h1>
<blockquote>
<h3>Incorrect Access Control in the Administrative Management Interface in SimplyBook.me Enterprise before 2019-04-23 allows Authenticated Low-Priv Users to Elevate Privileges to Full Admin Rights via a crafted HTTP PUT Request, as demonstrated by modified JSON data to a /v2/rest/ URI</h3>
</blockquote>
<p><a name="Vuln"></a></p>
<h2 id="the-vulnerability"><a href="#Vuln"><u>The Vulnerability</u></a></h2>
<p>A <strong><a href="https://simplybook.me">SimplyBook.it/SimplyBook.me</a></strong> management portal user with a low privileged account (such as Viewer Group read-only access) is able to send crafted JSON data in a PUT request via the REST API and reconfigure their account settings to grant themselves top level Administrative rights over the whole application, it’s users and the data belonging to all the clients of the booking system. In addition they would be able to reconfigure 3rd party payment account settings (e.g PayPal, Stripe, etc…)and hijack client payments intended for the owner of the service.</p>
<p><a name="Context"></a></p>
<h3 id="context"><a href="#Context"><u>Context</u></a></h3>
<p>The <strong><a href="https://simplybook.me">SimplyBook.it/SimplyBook.me</a></strong> site management portal software allows site owners to create very limited user accounts for the purpose of granting <strong>read-only access</strong> to users or entities that require <strong>basic data access</strong> only.</p>
<p>This can allow <strong>untrusted partner agents</strong> or <strong>low-level employees</strong> to have <strong>read-only access</strong> to booking/appointment calendars and service status messages. They <strong><u>should never be able to alter any configuration data or affect any other areas of the site, services, users, clients, financial service credentials</u></strong>.</p>
<p><img src="/images/CVE-2019-11489/1.png" alt="Image Error!" /></p>
<p><a name="Rec"></a></p>
<h3 id="observations--recommendations"><a href="#Rec"><u>Observations &amp; Recommendations</u></a></h3>
<p>User session tokens must also be validated when configuration changes are being made by an authenticated user. It is not enough to just rely on them having a valid X-CSRF Token. An authenticated low-priv read-only account could represent an untrusted basic employee with bad intentions or an account that has been more easily compromised by a criminal attacker due to a user’s belief that it cannot do any harm so there is no need to protect the credentials well.</p>
<p><a name="Sploit"></a></p>
<h2 id="exploit-example"><a href="#Sploit"><u>Exploit Example</u></a></h2>
<p>Here I will demonstrate how a <strong>Low-Priv Viewer Account</strong> attacker is able to grant themselves full <strong>Admin Privileges</strong>.</p>
<p>I was able to consistently reproduce and confirm the vulnerability using the following steps.</p>
<p><a name="1."></a></p>
<h3 id="step-1"><a href="#1."><u>Step 1</u></a></h3>
<p>First create a restricted <strong>Viewer</strong> account with read-only access.</p>
<p><img src="/images/CVE-2019-11489/2.png" alt="[Image Error!]" /></p>
<p><a name="2."></a></p>
<h3 id="step-2"><a href="#2."><u>Step 2</u></a></h3>
<p>Log in as the <strong>just_a_viewer</strong> account. Then access the <strong>Welcome</strong> page.</p>
<p><img src="/images/CVE-2019-11489/3.png" alt="[Image Error!]" /></p>
<p><a name="3."></a></p>
<h3 id="step-3"><a href="#3."><u>Step 3</u></a></h3>
<p>Proxy the web traffic using a proxy tool such as <strong><a href="https://portswigger.net/burp">Burp Suite</a></strong> and then click on the <strong>Services &amp; Providers</strong> pane.</p>
<p><img src="/images/CVE-2019-11489/4.png" alt="[Image Error!]" /></p>
<p><a name="4."></a></p>
<h3 id="step-4"><a href="#4."><u>Step 4</u></a></h3>
<p>Notice the <strong>Access Denied</strong> message…</p>
<p><img src="/images/CVE-2019-11489/5.png" alt="[Image Error!]" /></p>
<p><a name="5."></a></p>
<h3 id="step-5"><a href="#5."><u>Step 5</u></a></h3>
<p>Select the last request to <strong><code class="highlighter-rouge">/v2/rest/plugin</code></strong> in <strong><a href="https://portswigger.net/burp">Burp Suite</a></strong> and ensure it contains a valid <strong><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">X-CSRF Token</a></strong> and send it to the <strong>Repeater tool in Burp</strong>.</p>
<p><img src="/images/CVE-2019-11489/6.png" alt="[Image Error!]" /></p>
<p><img src="/images/CVE-2019-11489/7.png" alt="[Image Error!]" /></p>
<p><a name="6.."></a></p>
<h3 id="step-6"><a href="#6.."><u>Step 6</u></a></h3>
<p>Next, select to <strong>Change password</strong> from the <strong>Welcome Screen</strong> and then cancel it. Then return to <strong>burp</strong> to get your <strong><code class="highlighter-rouge">user_id</code></strong> for the next step.</p>
<p><img src="/images/CVE-2019-11489/8.png" alt="[Image Error!]" /></p>
<p><a name="7.."></a></p>
<h3 id="step-7"><a href="#7.."><u>Step 7</u></a></h3>
<p>Then alter the request to contain a <strong><code class="highlighter-rouge">PUT /v2/rest/user/item/id/5</code></strong> with <strong>JSON data</strong> structured in the following way making sure to set <strong><code class="highlighter-rouge">"group":"admin"</code></strong>:
<img src="/images/CVE-2019-11489/9.png" alt="[Image Error!]" /></p>
<p><img src="/images/CVE-2019-11489/10.png" alt="[Image Error!]" /></p>
<p><a name="8.."></a></p>
<h3 id="step-8"><a href="#8.."><u>Step 8</u></a></h3>
<p>If all was successful, you should see the same <strong>JSON data</strong> returned in a <strong><code class="highlighter-rouge">HTTP 200 OK</code></strong> response.</p>
<p><img src="/images/CVE-2019-11489/11.png" alt="[Image Error!]" /></p>
<p><a name="9.."></a></p>
<h3 id="step-9"><a href="#9.."><u>Step 9</u></a></h3>
<p>And finally, we are able to refresh the browser and see that we now have <strong>full administrative privileges</strong> in the management portal and can now do anything we want.</p>
<p><img src="/images/CVE-2019-11489/12.png" alt="[Image Error!]" /></p>
<hr />
<p><a name="Response"></a></p>
<h2 id="vendor-response"><a href="#Response"><u>Vendor Response</u></a></h2>
<p><em>(covers CVE-2019-11488 &amp; CVE-2019-11489)</em><br />
<strong>13-April-2019: Vendor is first sent the details of the vulnerabilities.<br />
23-April-2019: Notified of fix and bounty award by the vendor.</strong></p>
<blockquote>
<p>Hello,</p>
<p>Thank you.</p>
<p>As a reward for accepted vulnerabilities we will pay you 600USD, since we consider them as average seriousness:</p>
<p>(1) with admin access issue, the attacker, employee of same company as he would already need access, can only affect the system internally (not cross-system) and</p>
<p>(2) with hash issue the attacker needs to have access to user’s browser data.</p>
<p>Obviously both issues that should absolutely not be there, and have been fixed already, and we are thankful for you pointing them out to us.</p>
<p>. . .</p>
<p>Additionally we will give you 2 years of premium access to our system.</p>
<p>Best regards,
Elina - Security Manager</p>
</blockquote>
<p>Overall it was a positive experience communicating with the <strong><a href="https://simplybook.me">SimplyBook.me</a></strong> team, and I was glad to see the devs work to apply a fix within 10 days.</p>
<p>Thanks for reading,<br />
Please Comment Below.</p>
<p>The CybrGrade UK Team<br />
<img src="/images/cybrgrade-sig.png" alt="Image Error!" /></p>
<p><a name="refs"></a></p>
<h2 id="references"><a href="#refs"><u>References</u></a></h2>
<h4 id="owasp-authentication-cheat-sheet-github-link-owasp-rest-security-cheat-sheet-github-link-cve-details-mitreorg-link">OWASP Authentication Cheat Sheet: <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Authentication_Cheat_Sheet.md">Github Link</a> <br />OWASP REST Security Cheat Sheet: <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/REST_Security_Cheat_Sheet.md">Github Link</a> <br />CVE Details: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11489">Mitre.org Link</a></h4>
<footer class="entry-meta">
<span class="entry-tags"><a href="/tags#Our CVE Disclosures" title="Pages tagged Our CVE Disclosures" class="tag"><span class="term">Our CVE Disclosures</span></a></span>
<span class="author vcard"><span class="fn">CybrGrade UK</span></span>
<div class="social-share">
<ul class="socialcount socialcount-small inline-list">
<li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/CVE-2019-11489-SimplyBook.me-privesc/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
<li class="twitter"><a href="https://twitter.com/intent/tweet?text=/CVE-2019-11489-SimplyBook.me-privesc/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
<li class="googleplus"><a href="https://plus.google.com/share?url=/CVE-2019-11489-SimplyBook.me-privesc/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
</ul>
</div>
</footer>
</div>
<div class="read-more">
<div class="read-more-header">
<a href="https://cybrgrade.com" class="read-more-btn">About CybrGrade UK</a>
</div>
<div class="read-more-content main">
<h2 id="just-who-exactly-are-cybrgrade-uk-i-hear-you-ask">Just who exactly are CybrGrade UK? I hear you ask…</h2>
<p>Read our opening post on <strong><a href="/Welcome_To_The_CybrBlog/">here</a></strong> or checkout some background on how and <strong><a href="https://cybrgrade.com/?about">why our company was founded</a></strong>.</p>
</div>
</div>
<section id="disqus_thread"></section>
<div class="read-more">
<div class="read-more-header">
<a href="/CVE-2019-11488-SimplyBook.me-hash-replay-attack/" class="read-more-btn">Read More</a>
</div>
<div class="read-more-content">
<h3><a href="/CVE-2019-11488-SimplyBook.me-hash-replay-attack/" title="Exploiting SimplyBook.me Account Access Hash Replay Attack">Exploiting SimplyBook.me Account Access Hash Replay Attack</a></h3>
<p>CVE-2019-11488 SimplyBook.me Account Access Hash Replay Attack <a href="/CVE-2019-11488-SimplyBook.me-hash-replay-attack/">Continue reading</a></p>
</div>
<div class="read-more-list">
<div class="list-item">
<h4><a href="/SimplyBook.me_Disclosures/" title="Keep Your Eyes Peeled For Our Upcoming CVE Disclosures Right Here!">Keep Your Eyes Peeled For Our Upcoming CVE Disclosures Right Here!</a></h4>
<span>Published on April 20, 2019</span>
</div>
<div class="list-item">
<h4><a href="/Password_problems/" title="Just How Secure Is That Company VPN Password You've Been Using For The Last Two Years?">Just How Secure Is That Company VPN Password You've Been Using For The Last Two Years?</a></h4>
<span>Published on April 19, 2019</span>
</div>
</div>
</div>
</article>
</div>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'cybrgrade'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<div class="footer-wrapper">
<footer role="contentinfo">
<span>&copy; 2019 CYBRGRADE UK LTD</span>
</footer>
</div>
</body>
</html>
